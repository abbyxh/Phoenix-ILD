(self.webpackChunkphoenix_for_ild=self.webpackChunkphoenix_for_ild||[]).push([[792],{2869:(Ur,vt,Ee)=>{"use strict";var ve=Ee(467);let z=null,ke=!1,xe=1;const et=Symbol("SIGNAL");function Je(n){const e=z;return z=n,e}const He={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Ie(n){if(ke)throw new Error("");if(null===z)return;z.consumerOnSignalRead(n);const e=z.nextProducerIndex++;x(z),e<z.producerNode.length&&z.producerNode[e]!==n&&P(z)&&w(z.producerNode[e],z.producerIndexOfThis[e]),z.producerNode[e]!==n&&(z.producerNode[e]=n,z.producerIndexOfThis[e]=P(z)?D(n,z,e):0),z.producerLastReadVersion[e]=n.version}function ce(n){if((!P(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==xe)){if(!n.producerMustRecompute(n)&&!Y(n))return n.dirty=!1,void(n.lastCleanEpoch=xe);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=xe}}function ie(n){if(void 0===n.liveConsumerNode)return;const e=ke;ke=!0;try{for(const t of n.liveConsumerNode)t.dirty||ue(t)}finally{ke=e}}function he(){return!1!==z?.consumerAllowSignalWrites}function ue(n){n.dirty=!0,ie(n),n.consumerMarkedDirty?.(n)}function fe(n){return n&&(n.nextProducerIndex=0),Je(n)}function le(n,e){if(Je(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(P(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)w(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Y(n){x(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(ce(t),i!==t.version))return!0}return!1}function V(n){if(x(n),P(n))for(let e=0;e<n.producerNode.length;e++)w(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function D(n,e,t){if(v(n),x(n),0===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=D(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function w(n,e){if(v(n),x(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)w(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];x(r),r.producerIndexOfThis[i]=e}}function P(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function x(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function v(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}let te=function j(){throw new Error};function N(){te()}let I=null;function J(n,e){he()||N(),n.equal(n.value,e)||(n.value=e,function Te(n){n.version++,function O(){xe++}(),ie(n),I?.()}(n))}const be={...He,equal:function b(n,e){return Object.is(n,e)},value:void 0};const We=()=>{},dt={...He,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{null!==n.schedule&&n.schedule(n.ref)},hasRun:!1,cleanupFn:We};function Ke(n){return"function"==typeof n}function Ze(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Ue=Ze(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Oe(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class lt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Ke(i))try{i()}catch(s){e=s instanceof Ue?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{st(s)}catch(o){e=e??[],o instanceof Ue?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Ue(e)}}add(e){var t;if(e&&e!==this)if(this.closed)st(e);else{if(e instanceof lt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Oe(t,e)}remove(e){const{_finalizers:t}=this;t&&Oe(t,e),e instanceof lt&&e._removeParent(this)}}lt.EMPTY=(()=>{const n=new lt;return n.closed=!0,n})();const gt=lt.EMPTY;function ht(n){return n instanceof lt||n&&"closed"in n&&Ke(n.remove)&&Ke(n.add)&&Ke(n.unsubscribe)}function st(n){Ke(n)?n():n.unsubscribe()}const yt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Kt={setTimeout(n,e,...t){const{delegate:i}=Kt;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Kt;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ot(n){Kt.setTimeout(()=>{const{onUnhandledError:e}=yt;if(!e)throw n;e(n)})}function It(){}const An=Qt("C",void 0,void 0);function Qt(n,e,t){return{kind:n,value:e,error:t}}let Bn=null;function dn(n){if(yt.useDeprecatedSynchronousErrorHandling){const e=!Bn;if(e&&(Bn={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Bn;if(Bn=null,t)throw i}}else n()}class Tn extends lt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ht(e)&&e.add(this)):this.destination=ys}static create(e,t,i){return new ai(e,t,i)}next(e){this.isStopped?Tr(function pn(n){return Qt("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Tr(function on(n){return Qt("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Tr(An,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Hn=Function.prototype.bind;function ti(n,e){return Hn.call(n,e)}class hi{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Xi(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Xi(i)}else Xi(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Xi(t)}}}class ai extends Tn{constructor(e,t,i){let r;if(super(),Ke(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&yt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&ti(e.next,s),error:e.error&&ti(e.error,s),complete:e.complete&&ti(e.complete,s)}):r=e}this.destination=new hi(r)}}function Xi(n){yt.useDeprecatedSynchronousErrorHandling?function yn(n){yt.useDeprecatedSynchronousErrorHandling&&Bn&&(Bn.errorThrown=!0,Bn.error=n)}(n):Ot(n)}function Tr(n,e){const{onStoppedNotification:t}=yt;t&&Kt.setTimeout(()=>t(n,e))}const ys={closed:!0,next:It,error:function Or(n){throw n},complete:It},ds="function"==typeof Symbol&&Symbol.observable||"@@observable";function wt(n){return n}function pe(n){return 0===n.length?wt:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let me=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Et(n){return n&&n instanceof Tn||function At(n){return n&&Ke(n.next)&&Ke(n.error)&&Ke(n.complete)}(n)&&ht(n)}(t)?t:new ai(t,i,r);return dn(()=>{const{operator:o,source:l}=this;s.add(o?o.call(s,l):l?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Fe(i))((r,s)=>{const o=new ai({next:l=>{try{t(l)}catch(d){s(d),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[ds](){return this}pipe(...t){return pe(t)(this)}toPromise(t){return new(t=Fe(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Fe(n){var e;return null!==(e=n??yt.Promise)&&void 0!==e?e:Promise}const St=Ze(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let xt=(()=>{class n extends me{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new En(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new St}next(t){dn(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){dn(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){dn(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?gt:(this.currentObservers=null,s.push(t),new lt(()=>{this.currentObservers=null,Oe(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new me;return t.source=this,t}}return n.create=(e,t)=>new En(e,t),n})();class En extends xt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:gt}}class jt extends xt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Cn(n){return Ke(n?.lift)}function ln(n){return e=>{if(Cn(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Un(n,e,t,i,r){return new Ci(n,e,t,i,r)}class Ci extends Tn{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(l){try{t(l)}catch(d){e.error(d)}}:super._next,this._error=r?function(l){try{r(l)}catch(d){e.error(d)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Rn(n,e){return ln((t,i)=>{let r=0;t.subscribe(Un(i,s=>{i.next(n.call(e,s,r++))}))})}const Fn="https://g.co/ng/security#xss";class Zt extends Error{constructor(e,t){super(function tr(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Ce(n){return{toString:n}.toString()}const nt="__parameters__";function at(n,e,t){return Ce(()=>{const i=function zt(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return l.annotation=o,l;function l(d,u,f){const g=d.hasOwnProperty(nt)?d[nt]:Object.defineProperty(d,nt,{value:[]})[nt];for(;g.length<=f;)g.push(null);return(g[f]=g[f]||[]).push(o),d}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const Wt=globalThis;function Qe(n){for(let e in n)if(n[e]===Qe)return e;throw Error("Could not find renamed property on target object.")}function ut(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function _t(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(_t).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Lt(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const rn=Qe({__forward_ref__:Qe});function Xt(n){return n.__forward_ref__=Xt,n.toString=function(){return _t(this())},n}function cn(n){return Pn(n)?n():n}function Pn(n){return"function"==typeof n&&n.hasOwnProperty(rn)&&n.__forward_ref__===Xt}function ci(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function os(n){return{providers:n.providers||[],imports:n.imports||[]}}function Sa(n){return hu(n,aa)||hu(n,ic)}function hu(n,e){return n.hasOwnProperty(e)?n[e]:null}function da(n){return n&&(n.hasOwnProperty(Sd)||n.hasOwnProperty(Wd))?n[Sd]:null}const aa=Qe({\u0275prov:Qe}),Sd=Qe({\u0275inj:Qe}),ic=Qe({ngInjectableDef:Qe}),Wd=Qe({ngInjectorDef:Qe});class Mi{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=ci({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function g1(n){return n&&!!n.\u0275providers}const Mg=Qe({\u0275cmp:Qe}),_1=Qe({\u0275dir:Qe}),Mm=Qe({\u0275pipe:Qe}),Sg=Qe({\u0275mod:Qe}),tf=Qe({\u0275fac:Qe}),Eg=Qe({__NG_ELEMENT_ID__:Qe}),Qf=Qe({__NG_ENV_ID__:Qe});function ao(n){return"string"==typeof n?n:null==n?"":String(n)}function Tg(n,e){throw new Zt(-201,!1)}var ua=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ua||{});let CA;function v1(){return CA}function jd(n){const e=CA;return CA=n,e}function b1(n,e,t){const i=Sa(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ua.Optional?null:void 0!==e?e:void Tg()}const Dg={},x1="__NG_DI_FLAG__",j0="ngTempTokenPath",Nx=/\n/gm,dv="__source";let SA;function xh(n){const e=SA;return SA=n,e}function Ig(n,e=ua.Default){if(void 0===SA)throw new Zt(-203,!1);return null===SA?b1(n,void 0,e):SA.get(n,e&ua.Optional?null:void 0,e)}function pi(n,e=ua.Default){return(v1()||Ig)(cn(n),e)}function li(n,e=ua.Default){return pi(n,Cc(e))}function Cc(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Sm(n){const e=[];for(let t=0;t<n.length;t++){const i=cn(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Zt(900,!1);let r,s=ua.Default;for(let o=0;o<i.length;o++){const l=i[o],d=Bu(l);"number"==typeof d?-1===d?r=l.token:s|=d:r=l}e.push(pi(r,s))}else e.push(pi(i))}return e}function fu(n,e){return n[x1]=e,n.prototype[x1]=e,n}function Bu(n){return n[x1]}const fl=fu(at("Optional"),8),bl=fu(at("SkipSelf"),4);function dd(n,e){return n.hasOwnProperty(tf)?n[tf]:null}function Wf(n,e){n.forEach(t=>Array.isArray(t)?Wf(t,e):e(t))}function Pg(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function jf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ll(n,e,t){let i=Zo(n,e);return i>=0?n[1|i]=t:(i=~i,function Zu(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function eh(n,e){const t=Zo(n,e);if(t>=0)return n[1|t]}function Zo(n,e){return function EA(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const th={},Si=[],vo=new Mi(""),$f=new Mi("",-1),Ch=new Mi("");class Zc{get(e,t=Dg){if(t===Dg){const i=new Error(`NullInjectorError: No provider for ${_t(e)}!`);throw i.name="NullInjectorError",i}return t}}var nf=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(nf||{}),Ed=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ed||{}),mi=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(mi||{});function TA(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Rg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],l=t[i++];n.setAttribute(e,o,l,s)}else{const s=r,o=t[++i];pu(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function X0(n){return 3===n||4===n||6===n}function pu(n){return 64===n.charCodeAt(0)}function rf(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||M1(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function M1(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const l=n[s++];if("number"==typeof l){if(l===e){o=-1;break}if(l>e){o=s-1;break}}}for(;s<n.length;){const l=n[s];if("number"==typeof l)break;if(l===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const va="ng-template";function sf(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==TA(e[r+1].toLowerCase(),t,0))return!0}else if(Dp(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===t)return!0}return!1}function Dp(n){return 4===n.type&&n.value!==va}function Ip(n,e,t){return e===(4!==n.type||t?n.value:va)}function kg(n,e,t){let i=4;const r=n.attrs,s=null!==r?function $d(n){for(let e=0;e<n.length;e++)if(X0(n[e]))return e;return n.length}(r):0;let o=!1;for(let l=0;l<e.length;l++){const d=e[l];if("number"!=typeof d){if(!o)if(4&i){if(i=2|1&i,""!==d&&!Ip(n,d,t)||""===d&&1===e.length){if(Ru(i))return!1;o=!0}}else if(8&i){if(null===r||!sf(n,r,d,t)){if(Ru(i))return!1;o=!0}}else{const u=e[++l],f=Tm(d,r,Dp(n),t);if(-1===f){if(Ru(i))return!1;o=!0;continue}if(""!==u){let g;if(g=f>s?"":r[f+1].toLowerCase(),2&i&&u!==g){if(Ru(i))return!1;o=!0}}}}else{if(!o&&!Ru(i)&&!Ru(d))return!1;if(o&&Ru(d))continue;o=!1,i=d|1&i}}return Ru(i)||o}function Ru(n){return!(1&n)}function Tm(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let l=e[++r];for(;"string"==typeof l;)l=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Za(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function DA(n,e,t=!1){for(let i=0;i<e.length;i++)if(kg(n,e[i],t))return!0;return!1}function uv(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function ku(n,e){return n?":not("+e.trim()+")":e}function S1(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const l=n[++t];r+="["+o+(l.length>0?'="'+l+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ru(o)&&(e+=ku(s,r),r=""),i=o,s=s||!Ru(i);t++}return""!==r&&(e+=ku(s,r)),e}function Qr(n){return Ce(()=>{const e=Pp(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===nf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ed.Emulated,styles:n.styles||Si,_:null,schemas:n.schemas||null,tView:null,id:""};Rp(t);const i=n.dependencies;return t.directiveDefs=Kl(i,!1),t.pipeDefs=Kl(i,!0),t.id=function Yf(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function to(n){return Ys(n)||ul(n)}function ud(n){return null!==n}function Lo(n){return Ce(()=>({type:n.type,bootstrap:n.bootstrap||Si,declarations:n.declarations||Si,imports:n.imports||Si,exports:n.exports||Si,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Dn(n,e){if(null==n)return th;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,o,l=mi.None;Array.isArray(r)?(l=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=l!==mi.None?[i,l]:i,e[s]=o):t[s]=i}return t}function Sr(n){return Ce(()=>{const e=Pp(n);return Rp(e),e})}function Vc(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ys(n){return n[Mg]||null}function ul(n){return n[_1]||null}function hl(n){return n[Mm]||null}function rc(n,e){const t=n[Sg]||null;if(!t&&!0===e)throw new Error(`Type ${_t(n)} does not have '\u0275mod' property.`);return t}function Pp(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||th,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Si,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Dn(n.inputs,e),outputs:Dn(n.outputs),debugInfo:null}}function Rp(n){n.features?.forEach(e=>e(n))}function Kl(n,e){if(!n)return null;const t=e?hl:to;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(ud)}function IA(...n){return{\u0275providers:kp(0,n),\u0275fromNgModule:!0}}function kp(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Wf(e,o=>{const l=o;Kf(l,s,[],i)&&(r||=[],r.push(l))}),void 0!==r&&Sh(r,s),t}function Sh(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];Fp(r,s=>{e(s,i)})}}function Kf(n,e,t,i){if(!(n=cn(n)))return!1;let r=null,s=da(n);const o=!s&&Ys(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const d=n.ngModule;if(s=da(d),!s)return!1;r=d}const l=i.has(r);if(o){if(l)return!1;if(i.add(r),o.dependencies){const d="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const u of d)Kf(u,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!l){let u;i.add(r);try{Wf(s.imports,f=>{Kf(f,e,t,i)&&(u||=[],u.push(f))})}finally{}void 0!==u&&Sh(u,e)}if(!l){const u=dd(r)||(()=>new r);e({provide:r,useFactory:u,deps:Si},r),e({provide:Ch,useValue:r,multi:!0},r),e({provide:vo,useValue:()=>pi(r),multi:!0},r)}const d=s.providers;if(null!=d&&!l){const u=n;Fp(d,f=>{e(f,u)})}}}return r!==n&&void 0!==n.providers}function Fp(n,e){for(let t of n)g1(t)&&(t=t.\u0275providers),Array.isArray(t)?Fp(t,e):e(t)}const Y0=Qe({provide:String,useValue:Qe});function sc(n){return null!==n&&"object"==typeof n&&Y0 in n}function Lp(n){return"function"==typeof n}const af=new Mi(""),Jc={},BA={};let lo;function nh(){return void 0===lo&&(lo=new Zc),lo}class xl{}class Jf extends xl{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,ed(e,o=>this.processProvider(o)),this.records.set($f,lf(void 0,this)),r.has("environment")&&this.records.set(xl,lf(void 0,this));const s=this.records.get(af);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Ch,Si,ua.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=Je(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Je(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=xh(this),i=jd(void 0);try{return e()}finally{xh(t),jd(i)}}get(e,t=Dg,i=ua.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Qf))return e[Qf](this);i=Cc(i);const s=xh(this),o=jd(void 0);try{if(!(i&ua.SkipSelf)){let d=this.records.get(e);if(void 0===d){const u=function hv(n){return"function"==typeof n||"object"==typeof n&&n instanceof Mi}(e)&&Sa(e);d=u&&this.injectableDefInScope(u)?lf(Fg(e),Jc):null,this.records.set(e,d)}if(null!=d)return this.hydrate(e,d)}return(i&ua.Self?nh():this.parent).get(e,t=i&ua.Optional&&t===Dg?null:t)}catch(l){if("NullInjectorError"===l.name){if((l[j0]=l[j0]||[]).unshift(_t(e)),s)throw l;return function Yl(n,e,t,i){const r=n[j0];throw e[dv]&&r.unshift(e[dv]),n.message=function Gl(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=_t(e);if(Array.isArray(e))r=e.map(_t).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let l=e[o];s.push(o+":"+("string"==typeof l?JSON.stringify(l):_t(l)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Nx,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[j0]=null,n}(l,e,"R3InjectorError",this.source)}throw l}finally{jd(o),xh(s)}}resolveInjectorInitializers(){const e=Je(null),t=xh(this),i=jd(void 0);try{const s=this.get(vo,Si,ua.Self);for(const o of s)o()}finally{xh(t),jd(i),Je(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(_t(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Zt(205,!1)}processProvider(e){let t=Lp(e=cn(e))?e:cn(e&&e.provide);const i=function Np(n){return sc(n)?lf(void 0,n.useValue):lf(Td(n),Jc)}(e);if(!Lp(e)&&!0===e.multi){let r=this.records.get(t);r||(r=lf(void 0,Jc,!0),r.factory=()=>Sm(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){const i=Je(null);try{return t.value===Jc&&(t.value=BA,t.value=t.factory()),"object"==typeof t.value&&t.value&&function Dd(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Je(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=cn(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Fg(n){const e=Sa(n),t=null!==e?e.factory:dd(n);if(null!==t)return t;if(n instanceof Mi)throw new Zt(204,!1);if(n instanceof Function)return function mu(n){if(n.length>0)throw new Zt(204,!1);const t=function Yu(n){return n&&(n[aa]||n[ic])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Zt(204,!1)}function Td(n,e,t){let i;if(Lp(n)){const r=cn(n);return dd(r)||Fg(r)}if(sc(n))i=()=>cn(n.useValue);else if(function E1(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Sm(n.deps||[]));else if(function Op(n){return!(!n||!n.useExisting)}(n))i=()=>pi(cn(n.useExisting));else{const r=cn(n&&(n.useClass||n.provide));if(!function Og(n){return!!n.deps}(n))return dd(r)||Fg(r);i=()=>new r(...Sm(n.deps))}return i}function lf(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function ed(n,e){for(const t of n)Array.isArray(t)?ed(t,e):t&&g1(t)?ed(t.\u0275providers,e):e(t)}function hd(n,e){n instanceof Jf&&n.assertNotDestroyed();const i=xh(n),r=jd(void 0);try{return e()}finally{xh(i),jd(r)}}function fv(){return void 0!==v1()||null!=function w1(){return SA}()}function K0(n){if(!fv())throw new Zt(-203,!1)}const wl=0,Rr=1,Ks=2,Na=3,oc=4,Tc=5,Dc=6,Bm=7,ml=8,Zl=9,Au=10,Ao=11,Pm=12,B1=13,ih=14,ko=15,Nl=16,Rm=17,Ac=18,Hp=19,Vp=20,ac=21,Bd=22,Bl=23,us=25,Eh=1,rh=7,Xr=9,Ea=10;var J0=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(J0||{});function Bc(n){return Array.isArray(n)&&"object"==typeof n[Eh]}function Al(n){return Array.isArray(n)&&!0===n[Eh]}function PA(n){return!!(4&n.flags)}function cf(n){return n.componentOffset>-1}function Pc(n){return!(1&~n.flags)}function ql(n){return!!n.template}function Gp(n){return!!(512&n[Ks])}class Fu{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function tp(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}function Pl(){return np}function np(n){return n.type.prototype.ngOnChanges&&(n.setInput=ip),Wp}function Wp(){const n=Fm(this),e=n?.current;if(e){const t=n.previous;if(t===th)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function ip(n,e,t,i,r){const s=this.declaredInputs[i],o=Fm(n)||function Bh(n,e){return n[jp]=e}(n,{previous:th,current:null}),l=o.current||(o.current={}),d=o.previous,u=d[s];l[s]=new Fu(u&&u.currentValue,t,d===th),tp(n,e,r,t)}Pl.ngInherit=!0;const jp="__ngSimpleChanges__";function Fm(n){return n[jp]||null}const gl=function(n,e,t){},e_="svg";let P1=!1;function Go(n){for(;Array.isArray(n);)n=n[wl];return n}function OA(n,e){return Go(e[n])}function Pd(n,e){return Go(e[n.index])}function LA(n,e){return n.data[e]}function Nm(n,e){return n[e]}function Rd(n,e){const t=e[n];return Bc(t)?t:t[wl]}function ah(n){return!(128&~n[Ks])}function Lu(n,e){return null==e?null:n[e]}function R1(n){n[Rm]=0}function n_(n){1024&n[Ks]||(n[Ks]|=1024,ah(n)&&$p(n))}function Rc(n){return!!(9216&n[Ks]||n[Bl]?.dirty)}function pf(n){n[Au].changeDetectionScheduler?.notify(1),Rc(n)?$p(n):64&n[Ks]&&(function mv(){return P1}()?(n[Ks]|=1024,$p(n)):n[Au].changeDetectionScheduler?.notify())}function $p(n){n[Au].changeDetectionScheduler?.notify();let e=Rh(n);for(;null!==e&&!(8192&e[Ks])&&(e[Ks]|=8192,ah(e));)e=Rh(e)}function op(n,e){if(!(256&~n[Ks]))throw new Zt(911,!1);null===n[ac]&&(n[ac]=[]),n[ac].push(e)}function Rh(n){const e=n[Na];return Al(e)?e[Na]:e}const Ts={lFrame:$g(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Um(){return Ts.bindingsEnabled}function zm(){return null!==Ts.skipHydrationRootTNode}function qi(){return Ts.lFrame.lView}function ma(){return Ts.lFrame.tView}function vi(n){return Ts.lFrame.contextLView=n,n[ml]}function bi(n){return Ts.lFrame.contextLView=null,n}function Ua(){let n=UA();for(;null!==n&&64===n.type;)n=n.parent;return n}function UA(){return Ts.lFrame.currentTNode}function lh(n,e){const t=Ts.lFrame;t.currentTNode=n,t.isParent=e}function zA(){return Ts.lFrame.isParent}function qg(){Ts.lFrame.isParent=!1}function qc(){const n=Ts.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function dh(){return Ts.lFrame.bindingIndex++}function mf(n){const e=Ts.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function o_(n,e){const t=Ts.lFrame;t.bindingIndex=t.bindingRootIndex=n,a_(e)}function a_(n){Ts.lFrame.currentDirectiveIndex=n}function c_(){return Ts.lFrame.currentQueryIndex}function HA(n){Ts.lFrame.currentQueryIndex=n}function H1(n){const e=n[Rr];return 2===e.type?e.declTNode:1===e.type?n[Tc]:null}function Wg(n,e,t){if(t&ua.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ua.Host||(r=H1(s),null===r||(s=s[ih],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ts.lFrame=d_();return i.currentTNode=e,i.lView=n,!0}function jg(n){const e=d_(),t=n[Rr];Ts.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function d_(){const n=Ts.lFrame,e=null===n?null:n.child;return null===e?$g(n):e}function $g(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function u_(){const n=Ts.lFrame;return Ts.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const h_=u_;function f_(){const n=u_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function kc(){return Ts.lFrame.selectedIndex}function ap(n){Ts.lFrame.selectedIndex=n}function _l(){const n=Ts.lFrame;return LA(n.tView,n.selectedIndex)}function Ul(){Ts.lFrame.currentNamespace=e_}function kh(){!function _v(){Ts.lFrame.currentNamespace=null}()}let Yp=!0;function Vm(){return Yp}function Ja(n){Yp=n}function Af(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:l,ngAfterViewInit:d,ngAfterViewChecked:u,ngOnDestroy:f}=s;o&&(n.contentHooks??=[]).push(-t,o),l&&((n.contentHooks??=[]).push(t,l),(n.contentCheckHooks??=[]).push(t,l)),d&&(n.viewHooks??=[]).push(-t,d),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),null!=f&&(n.destroyHooks??=[]).push(t,f)}}function uh(n,e,t){Fh(n,e,3,t)}function hh(n,e,t,i){(3&n[Ks])===t&&Fh(n,e,t,i)}function Zp(n,e){let t=n[Ks];(3&t)===e&&(t&=16383,t+=1,n[Ks]=t)}function Fh(n,e,t,i){const s=i??-1,o=e.length-1;let l=0;for(let d=void 0!==i?65535&n[Rm]:0;d<o;d++)if("number"==typeof e[d+1]){if(l=e[d],null!=i&&l>=i)break}else e[d]<0&&(n[Rm]+=65536),(l<s||-1==s)&&(q1(n,t,e,d),n[Rm]=(4294901760&n[Rm])+d+2),d++}function p_(n,e){gl(4,n,e);const t=Je(null);try{e.call(n)}finally{Je(t),gl(5,n,e)}}function q1(n,e,t,i){const r=t[i]<0,s=t[i+1],l=n[r?-t[i]:t[i]];r?n[Ks]>>14<n[Rm]>>16&&(3&n[Ks])===e&&(n[Ks]+=16384,p_(l,s)):p_(l,s)}const lp=-1;class cp{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Zg(n){return n!==lp}function GA(n){return 32767&n}function Jg(n,e){let t=function Q1(n){return n>>16}(n),i=e;for(;t>0;)i=i[ih],t--;return i}let m_=!0;function A_(n){const e=m_;return m_=n,e}const W1=255,g_=5;let e0=0;const Oh={};function qm(n,e){const t=vv(n,e);if(-1!==t)return t;const i=e[Rr];i.firstCreatePass&&(n.injectorIndex=e.length,Lh(i.data,n),Lh(e,null),Lh(i.blueprint,null));const r=__(n,e),s=n.injectorIndex;if(Zg(r)){const o=GA(r),l=Jg(r,e),d=l[Rr].data;for(let u=0;u<8;u++)e[s+u]=l[o+u]|d[o+u]}return e[s+8]=r,s}function Lh(n,e){n.push(0,0,0,0,0,0,0,0,e)}function vv(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function __(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=qA(r),null===i)return lp;if(t++,r=r[ih],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return lp}function j1(n,e,t){!function oM(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Eg)&&(i=t[Eg]),null==i&&(i=t[Eg]=e0++);const r=i&W1;e.data[n+(r>>g_)]|=1<<r}(n,e,t)}function qx(n,e,t){if(t&ua.Optional||void 0!==n)return n;Tg()}function y_(n,e,t,i){if(t&ua.Optional&&void 0===i&&(i=null),!(t&(ua.Self|ua.Host))){const r=n[Zl],s=jd(void 0);try{return r?r.get(e,i,t&ua.Optional):b1(e,i,t&ua.Optional)}finally{jd(s)}}return qx(i,0,t)}function t0(n,e,t,i=ua.Default,r){if(null!==n){if(2048&e[Ks]&&!(i&ua.Self)){const o=function pd(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ks]&&!(512&o[Ks]);){const l=v_(s,o,t,i|ua.Self,Oh);if(l!==Oh)return l;let d=s.parent;if(!d){const u=o[Vp];if(u){const f=u.get(t,Oh,i);if(f!==Oh)return f}d=qA(o),o=o[ih]}s=d}return r}(n,e,t,i,Oh);if(o!==Oh)return o}const s=v_(n,e,t,i,Oh);if(s!==Oh)return s}return y_(e,t,i,r)}function v_(n,e,t,i,r){const s=function $1(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Eg)?n[Eg]:void 0;return"number"==typeof e?e>=0?e&W1:Y1:e}(t);if("function"==typeof s){if(!Wg(e,n,i))return i&ua.Host?qx(r,0,i):y_(e,t,i,r);try{let o;if(o=s(i),null!=o||i&ua.Optional)return o;Tg()}finally{h_()}}else if("number"==typeof s){let o=null,l=vv(n,e),d=lp,u=i&ua.Host?e[ko][Tc]:null;for((-1===l||i&ua.SkipSelf)&&(d=-1===l?__(n,e):e[l+8],d!==lp&&X1(i,!1)?(o=e[Rr],l=GA(d),e=Jg(d,e)):l=-1);-1!==l;){const f=e[Rr];if(Fc(s,l,f.data)){const g=Qx(l,e,t,o,i,u);if(g!==Oh)return g}d=e[l+8],d!==lp&&X1(i,e[Rr].data[l+8]===u)&&Fc(s,l,e)?(o=f,l=GA(d),e=Jg(d,e)):l=-1}}return r}function Qx(n,e,t,i,r,s){const o=e[Rr],l=o.data[n+8],f=as(l,o,t,null==i?cf(l)&&m_:i!=o&&!!(3&l.type),r&ua.Host&&s===l);return null!==f?Nu(e,o,f,l):Oh}function as(n,e,t,i,r){const s=n.providerIndexes,o=e.data,l=1048575&s,d=n.directiveStart,f=s>>20,T=r?l+f:n.directiveEnd;for(let B=i?l:l+f;B<T;B++){const q=o[B];if(B<d&&t===q||B>=d&&q.type===t)return B}if(r){const B=o[d];if(B&&ql(B)&&B.type===t)return d}return null}function Nu(n,e,t,i){let r=n[t];const s=e.data;if(function Gm(n){return n instanceof cp}(r)){const o=r;o.resolving&&function Fx(n,e){throw e&&e.join(" > "),new Zt(-200,n)}(function ja(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():ao(n)}(s[t]));const l=A_(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?jd(o.injectImpl):null;Wg(n,i,ua.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function Kp(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=np(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==u&&jd(u),A_(l),o.resolving=!1,h_()}}return r}function Fc(n,e,t){return!!(t[e+(n>>g_)]&1<<n)}function X1(n,e){return!(n&ua.Self||n&ua.Host&&e)}class lc{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return t0(this._tNode,this._lView,e,Cc(i),t)}}function Y1(){return new lc(Ua(),qi())}function Aa(n){return Ce(()=>{const e=n.prototype.constructor,t=e[tf]||Jp(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[tf]||Jp(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Jp(n){return Pn(n)?()=>{const e=Jp(cn(n));return e&&e()}:dd(n)}function qA(n){const e=n[Rr],t=e.type;return 2===t?e.declTNode:1===t?n[Tc]:null}function _u(n){return function bv(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(X0(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Ua(),n)}function td(n,e=null,t=null,i){const r=r0(n,e,t,i);return r.resolveInjectorInitializers(),r}function r0(n,e=null,t=null,i,r=new Set){const s=[t||Si,IA(n)];return i=i||("object"==typeof n?void 0:_t(n)),new Jf(s,e||nh(),i||null,r)}let sl=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Dg;static#t=this.NULL=new Zc;static create(t,i){if(Array.isArray(t))return td({name:""},i,t,"");{const r=t.name??"";return td({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=ci({token:n,providedIn:"any",factory:()=>pi($f)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function yl(n){return n.ngOriginalError}class Cl{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&yl(e);for(;t&&yl(t);)t=yl(t);return t||null}}const up=new Mi("",{providedIn:"root",factory:()=>li(Cl).handleError.bind(void 0)});let yu=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=o0;static#t=this.__NG_ENV_ID__=t=>t}return n})();class s0 extends yu{constructor(e){super(),this._lView=e}onDestroy(e){return op(this._lView,e),()=>function Vg(n,e){if(null===n[ac])return;const t=n[ac].indexOf(e);-1!==t&&n[ac].splice(t,1)}(this._lView,e)}}function o0(){return new s0(qi())}function w_(){return hp(Ua(),qi())}function hp(n,e){return new Ws(Pd(n,e))}let Ws=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=w_}return n})();function jA(n){return n instanceof Ws?n.nativeElement:n}function Nh(n){return e=>{setTimeout(n,void 0,e)}}const xs=class yf extends xt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,fv()&&(this.destroyRef=li(yu,{optional:!0})??void 0)}emit(e){const t=Je(null);try{super.next(e)}finally{Je(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const d=e;r=d.next?.bind(d),s=d.error?.bind(d),o=d.complete?.bind(d)}this.__isAsync&&(s=Nh(s),r&&(r=Nh(r)),o&&(o=Nh(o)));const l=super.subscribe({next:r,error:s,complete:o});return e instanceof lt&&e.add(l),l}};function C_(){return this._results[Symbol.iterator]()}class vf{static#e=Symbol.iterator;get changes(){return this._changes??=new xs}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=vf.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=C_)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function Ko(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Em(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function ae(n){return!(128&~n.flags)}const Ve=new Map;let ft=0;const Pr="__ngContext__";function Dr(n,e){Bc(e)?(n[Pr]=e[Hp],function an(n){Ve.set(n[Hp],n)}(e)):n[Pr]=e}function Ya(n){return xf(n[Pm])}function Qc(n){return xf(n[oc])}function xf(n){for(;null!==n&&!Al(n);)n=n[oc];return n}let Sv;const M_=new Mi("",{providedIn:"root",factory:()=>dM}),dM="ng",$x=new Mi(""),om=new Mi("",{providedIn:"platform",factory:()=>"unknown"}),Fd=new Mi(""),Ev=new Mi("",{providedIn:"root",factory:()=>function Xm(){if(void 0!==Sv)return Sv;if(typeof document<"u")return document;throw new Zt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let $t=()=>null;function Kn(n,e,t=!1){return $t(n,e,t)}const vu=new Mi("",{providedIn:"root",factory:()=>!1});let Ym;function h0(n){return function Km(){if(void 0===Ym&&(Ym=null,Wt.trustedTypes))try{Ym=Wt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Ym}()?.createScriptURL(n)||n}class Sf{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Fn})`}}function ha(n){return n instanceof Sf?n.changingThisBreaksApplicationSecurity:n}function dc(n,e){const t=function gh(n){return n instanceof Sf&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Fn})`)}return t===e}const VB=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Zd=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Zd||{});function ry(n){const e=D_();return e?e.sanitize(Zd.URL,n)||"":dc(n,"URL")?ha(n):function Kx(n){return(n=String(n)).match(VB)?n:"unsafe:"+n}(ao(n))}function _M(n){const e=D_();if(e)return h0(e.sanitize(Zd.RESOURCE_URL,n)||"");if(dc(n,"ResourceURL"))return h0(ha(n));throw new Zt(904,!1)}function D_(){const n=qi();return n&&n[Au].sanitizer}const QB=/^>|^->|<!--|-->|--!>|<!-$/g,bM=/(<|>)/g,nw="\u200b$1\u200b";function zu(n){return n instanceof Function?n():n}var Ef=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Ef||{});let IM;function uw(n,e){return IM(n,e)}function Zm(n,e,t,i,r){if(null!=i){let s,o=!1;Al(i)?s=i:Bc(i)&&(o=!0,i=i[wl]);const l=Go(i);0===n&&null!==t?null==r?Hv(e,t,l):Jm(e,t,l,r||null,!0):1===n&&null!==t?Jm(e,t,l,r||null,!0):2===n?function P_(n,e,t){const i=Gv(n,e);i&&function Vv(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,l,o):3===n&&e.destroyNode(l),null!=s&&function OM(n,e,t,i,r){const s=t[rh];s!==Go(t)&&Zm(e,n,i,s,r);for(let l=Ea;l<t.length;l++){const d=t[l];ly(d[Rr],d,n,e,i,s)}}(e,n,s,t,r)}}function PM(n,e){return n.createComment(function iw(n){return n.replace(QB,e=>e.replace(bM,nw))}(e))}function hw(n,e,t){return n.createElement(e,t)}function OT(n,e){e[Au].changeDetectionScheduler?.notify(1),ly(n,e,e[Ao],2,null,null)}function LT(n,e){const t=n[Xr],i=t.indexOf(e);t.splice(i,1)}function B_(n,e){if(n.length<=Ea)return;const t=Ea+e,i=n[t];if(i){const r=i[Nl];null!==r&&r!==n&&LT(r,i),e>0&&(n[t-1][oc]=i[oc]);const s=jf(n,Ea+e);!function KB(n,e){OT(n,e),e[wl]=null,e[Tc]=null}(i[Rr],i);const o=s[Ac];null!==o&&o.detachView(s[Rr]),i[Na]=null,i[oc]=null,i[Ks]&=-129}return i}function fw(n,e){if(!(256&e[Ks])){const t=e[Ao];t.destroyNode&&ly(n,e,t,3,null,null),function JB(n){let e=n[Pm];if(!e)return m0(n[Rr],n);for(;e;){let t=null;if(Bc(e))t=e[Pm];else{const i=e[Ea];i&&(t=i)}if(!t){for(;e&&!e[oc]&&e!==n;)Bc(e)&&m0(e[Rr],e),e=e[Na];null===e&&(e=n),Bc(e)&&m0(e[Rr],e),t=e&&e[oc]}e=t}}(e)}}function m0(n,e){if(256&e[Ks])return;const t=Je(null);try{e[Ks]&=-129,e[Ks]|=256,e[Bl]&&V(e[Bl]),function Oc(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof cp)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const l=r[s[o]],d=s[o+1];gl(4,l,d);try{d.call(l)}finally{gl(5,l,d)}}else{gl(4,r,s);try{s.call(r)}finally{gl(5,r,s)}}}}}(n,e),function nP(n,e){const t=n.cleanup,i=e[Bm];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Bm]=null);const r=e[ac];if(null!==r){e[ac]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Rr].type&&e[Ao].destroy();const i=e[Nl];if(null!==i&&Al(e[Na])){i!==e[Na]&&LT(i,e);const r=e[Ac];null!==r&&r.detachView(n)}!function Yn(n){Ve.delete(n[Hp])}(e)}finally{Je(t)}}function oy(n,e,t){return function RM(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[wl];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Ed.None||s===Ed.Emulated)return null}return Pd(i,t)}}(n,e.parent,t)}function Jm(n,e,t,i,r){n.insertBefore(e,t,i,r)}function Hv(n,e,t){n.appendChild(e,t)}function NT(n,e,t,i,r){null!==i?Jm(n,e,t,i,r):Hv(n,e,t)}function Gv(n,e){return n.parentNode(e)}function ay(n,e,t){return zT(n,e,t)}let mp,zT=function pw(n,e,t){return 40&n.type?Pd(n,t):null};function qv(n,e,t,i){const r=oy(n,i,e),s=e[Ao],l=ay(i.parent||e[Tc],i,e);if(null!=r)if(Array.isArray(t))for(let d=0;d<t.length;d++)NT(s,r,t[d],l,!1);else NT(s,r,t,l,!1);void 0!==mp&&mp(s,i,e,t,r)}function A0(n,e){if(null!==e){const t=e.type;if(3&t)return Pd(e,n);if(4&t)return FM(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return A0(n,i);{const r=n[e.index];return Al(r)?FM(-1,r):Go(r)}}if(32&t)return uw(e,n)()||Go(n[e.index]);{const i=HT(n,e);return null!==i?Array.isArray(i)?i[0]:A0(Rh(n[ko]),i):A0(n,e.next)}}return null}function HT(n,e){return null!==e?n[ko][Tc].projection[e.projection]:null}function FM(n,e){const t=Ea+n+1;if(t<e.length){const i=e[t],r=i[Rr].firstChild;if(null!==r)return A0(i,r)}return e[rh]}function Qv(n,e,t,i,r,s,o){for(;null!=t;){const l=i[t.index],d=t.type;if(o&&0===e&&(l&&Dr(Go(l),i),t.flags|=2),32&~t.flags)if(8&d)Qv(n,e,t.child,i,r,s,!1),Zm(e,n,r,l,s);else if(32&d){const u=uw(t,i);let f;for(;f=u();)Zm(e,n,r,f,s);Zm(e,n,r,l,s)}else 16&d?Wv(n,e,i,t,r,s):Zm(e,n,r,l,s);t=o?t.projectionNext:t.next}}function ly(n,e,t,i,r,s){Qv(t,i,n.firstChild,e,r,s,!1)}function Wv(n,e,t,i,r,s){const o=t[ko],d=o[Tc].projection[i.projection];if(Array.isArray(d))for(let u=0;u<d.length;u++)Zm(e,n,r,d[u],s);else{let u=d;const f=o[Na];ae(i)&&(u.flags|=128),Qv(n,e,u,f,r,s,!0)}}function Aw(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function VT(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Rg(n,e,i),null!==r&&Aw(n,e,r),null!==s&&function NM(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}const Xo={};function qn(n=1){GT(ma(),qi(),kc()+n,!1)}function GT(n,e,t,i){if(!i)if(3&~e[Ks]){const s=n.preOrderHooks;null!==s&&hh(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&uh(e,s,t)}ap(t)}function Vt(n,e=ua.Default){const t=qi();return null===t?pi(n,e):t0(Ua(),t,cn(n),e)}function UM(){throw new Error("invalid")}function gw(n,e,t,i,r,s){const o=Je(null);try{let l=null;r&mi.SignalBased&&(l=e[i][et]),null!==l&&void 0!==l.transformFn&&(s=l.transformFn(s)),r&mi.HasDecoratorInputTransform&&(s=n.inputTransforms[i].call(e,s)),null!==n.setInput?n.setInput(e,l,s,t,i):tp(e,l,i,s)}finally{Je(o)}}function jv(n,e,t,i,r,s,o,l,d,u,f){const g=e.blueprint.slice();return g[wl]=r,g[Ks]=204|i,(null!==u||n&&2048&n[Ks])&&(g[Ks]|=2048),R1(g),g[Na]=g[ih]=n,g[ml]=t,g[Au]=o||n&&n[Au],g[Ao]=l||n&&n[Ao],g[Zl]=d||n&&n[Zl]||null,g[Tc]=s,g[Hp]=function kt(){return ft++}(),g[Dc]=f,g[Vp]=u,g[ko]=2==e.type?n[ko]:g,g}function R_(n,e,t,i,r){let s=n.data[e];if(null===s)s=function _w(n,e,t,i,r){const s=UA(),o=zA(),d=n.data[e]=function aN(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,l=0;return zm()&&(l|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=d),null!==s&&(o?null==s.child&&null!==d.parent&&(s.child=d):null===s.next&&(s.next=d,d.prev=s)),d}(n,e,t,i,r),function s_(){return Ts.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Hm(){const n=Ts.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return lh(s,!0),s}function cy(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function zM(n,e,t,i,r){const s=kc(),o=2&i;try{ap(-1),o&&e.length>us&&GT(n,e,us,!1),gl(o?2:0,r),t(i,r)}finally{ap(s),gl(o?3:1,r)}}function yw(n,e,t){if(PA(e)){const i=Je(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const l=n.data[o];l.contentQueries&&l.contentQueries(1,t[o],o)}}finally{Je(i)}}}function eA(n,e,t){Um()&&(function $v(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;cf(t)&&function uy(n,e,t){const i=Pd(e,n),r=QT(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const l=O_(n,jv(n,r,null,o,i,e,null,n[Au].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=l}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||qm(t,e),Dr(i,e);const o=t.initialInputs;for(let l=r;l<s;l++){const d=n.data[l],u=Nu(e,n,l,t);Dr(u,e),null!==o&&hy(0,l-r,u,d,0,o),ql(d)&&(Rd(t.index,e)[ml]=Nu(e,n,l,t))}}(n,e,t,Pd(t,e)),!(64&~t.flags)&&Mw(n,e,t))}function vw(n,e,t=Pd){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],l=-1===o?t(e,n):n[o];n[r++]=l}}}function QT(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Tf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Tf(n,e,t,i,r,s,o,l,d,u,f){const g=us+i,T=g+r,B=function ZA(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Xo);return t}(g,T),q="function"==typeof u?u():u;return B[Rr]={type:n,blueprint:B,template:t,queries:null,viewQuery:l,declTNode:e,data:B.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:T,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:d,consts:q,incompleteFirstPass:!1,ssrId:f}}let WT=()=>null;function jT(n,e,t,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;i??={};let l,d=mi.None;Array.isArray(o)?(l=o[0],d=o[1]):l=o;let u=s;if(null!==r){if(!r.hasOwnProperty(s))continue;u=r[s]}0===n?$T(i,t,u,l,d):$T(i,t,u,l)}return i}function $T(n,e,t,i,r){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,i):s=n[t]=[e,i],void 0!==r&&s.push(r)}function Ld(n,e,t,i,r,s,o,l){const d=Pd(e,t);let f,u=e.inputs;!l&&null!=u&&(f=u[i])?(my(n,t,f,i,r),cf(e)&&function g0(n,e){const t=Rd(e,n);16&t[Ks]||(t[Ks]|=64)}(t,e.index)):3&e.type&&(i=function oP(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(d,i,r))}function xw(n,e,t,i){if(Um()){const r=null===i?null:{"":-1},s=function Sw(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(DA(e,o.selectors,!1))if(i||(i=[]),ql(o))if(null!==o.findHostDirectiveDefs){const l=[];r=r||new Map,o.findHostDirectiveDefs(o,l,r),i.unshift(...l,o),HM(n,e,l.length)}else i.unshift(o),HM(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,l;null===s?o=l=null:[o,l]=s,null!==o&&ww(n,e,t,o,r,l),r&&function aP(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Zt(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=rf(t.mergedAttrs,t.attrs)}function ww(n,e,t,i,r,s){for(let u=0;u<i.length;u++)j1(qm(t,e),n,i[u].type);!function _h(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let u=0;u<i.length;u++){const f=i[u];f.providersResolver&&f.providersResolver(f)}let o=!1,l=!1,d=cy(n,e,i.length,null);for(let u=0;u<i.length;u++){const f=i[u];t.mergedAttrs=rf(t.mergedAttrs,f.hostAttrs),dy(n,t,e,d,f),VM(d,f,r),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const g=f.type.prototype;!o&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!l&&(g.ngOnChanges||g.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),l=!0),d++}!function sP(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,l=[];let d=null,u=null;for(let f=e.directiveStart;f<r;f++){const g=s[f],T=t?t.get(g):null,q=T?T.outputs:null;d=jT(0,g.inputs,f,d,T?T.inputs:null),u=jT(1,g.outputs,f,u,q);const re=null===d||null===o||Dp(e)?null:fy(d,f,o);l.push(re)}null!==d&&(d.hasOwnProperty("class")&&(e.flags|=8),d.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=l,e.inputs=d,e.outputs=u}(n,t,s)}function Mw(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function Qg(){return Ts.lFrame.currentDirectiveIndex}();try{ap(s);for(let l=i;l<r;l++){const d=n.data[l],u=e[l];a_(l),(null!==d.hostBindings||0!==d.hostVars||null!==d.hostAttrs)&&Hu(d,u)}}finally{ap(-1),a_(o)}}function Hu(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function HM(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function VM(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ql(e)&&(t[""]=n)}}function dy(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=dd(r.type)),o=new cp(s,ql(r),Vt);n.blueprint[i]=o,t[i]=o,function Cw(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const l=~e.index;(function F_(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=l&&o.push(l),o.push(t,i,s)}}(n,e,i,cy(n,t,r.hostVars,Xo),r)}function Hh(n,e,t,i,r,s){const o=Pd(n,e);!function _0(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const l=null==o?ao(s):o(s,i||"",r);n.setAttribute(e,r,l,t)}}(e[Ao],o,s,n.value,t,i,r)}function hy(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let l=0;l<o.length;)gw(i,t,o[l++],o[l++],o[l++],o[l++])}function fy(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let l=0;l<o.length;l+=3)if(o[l]===e){i.push(s,o[l+1],o[l+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function py(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function GM(n,e){const t=n.contentQueries;if(null!==t){const i=Je(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const l=n.data[o];HA(t[r]),l.contentQueries(2,e[o],o)}}}finally{Je(i)}}}function O_(n,e){return n[Pm]?n[B1][oc]=e:n[Pm]=e,n[B1]=e,e}function L_(n,e,t){HA(0);const i=Je(null);try{e(n,t)}finally{Je(i)}}function QM(n){return n[Bm]||(n[Bm]=[])}function Ew(n){return n.cleanup||(n.cleanup=[])}function Tw(n,e){const t=n[Zl],i=t?t.get(Cl,null):null;i&&i.handleError(e)}function my(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],l=t[s++],d=t[s++];gw(n.data[o],e[o],i,l,d,r)}}function YT(n,e){const t=Rd(e,n),i=t[Rr];!function lP(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[wl];null!==r&&null===t[Dc]&&(t[Dc]=Kn(r,t[Zl])),Dw(i,t,t[ml])}function Dw(n,e,t){jg(e);try{const i=n.viewQuery;null!==i&&L_(1,i,t);const r=n.template;null!==r&&zM(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ac]?.finishViewCreation(n),n.staticContentQueries&&GM(n,e),n.staticViewQueries&&L_(2,n.viewQuery,t);const s=n.components;null!==s&&function KT(n,e){for(let t=0;t<e.length;t++)YT(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ks]&=-5,f_()}}function Ay(n,e,t,i){const r=Je(null);try{const s=e.tView,d=jv(n,s,t,4096&n[Ks]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);d[Nl]=n[e.index];const f=n[Ac];return null!==f&&(d[Ac]=f.createEmbeddedView(s)),Dw(s,d,t),d}finally{Je(r)}}function ZT(n,e){const t=Ea+e;if(t<n.length)return n[t]}function N_(n,e){return!e||null===e.firstChild||ae(n)}function y0(n,e,t,i=!0){const r=e[Rr];if(function eP(n,e,t,i){const r=Ea+i,s=t.length;i>0&&(t[r-1][oc]=e),i<s-Ea?(e[oc]=t[r],Pg(t,Ea+i,e)):(t.push(e),e[oc]=null),e[Na]=t;const o=e[Nl];null!==o&&t!==o&&function tP(n,e){const t=n[Xr];e[ko]!==e[Na][Na][ko]&&(n[Ks]|=J0.HasTransplantedViews),null===t?n[Xr]=[e]:t.push(e)}(o,e);const l=e[Ac];null!==l&&l.insertView(n),pf(e),e[Ks]|=128}(r,e,n,t),i){const o=FM(t,n),l=e[Ao],d=Gv(l,n[rh]);null!==d&&function ZB(n,e,t,i,r,s){i[wl]=r,i[Tc]=e,ly(n,i,t,1,r,s)}(r,n[Tc],l,e,d,o)}const s=e[Dc];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function Xv(n,e){const t=B_(n,e);return void 0!==t&&fw(t[Rr],t),t}function gy(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(Go(s)),Al(s)&&Iw(s,i);const o=t.type;if(8&o)gy(n,e,t.child,i);else if(32&o){const l=uw(t,e);let d;for(;d=l();)i.push(d)}else if(16&o){const l=HT(e,t);if(Array.isArray(l))i.push(...l);else{const d=Rh(e[ko]);gy(d[Rr],d,l,i,!0)}}t=r?t.projectionNext:t.next}return i}function Iw(n,e){for(let t=Ea;t<n.length;t++){const i=n[t],r=i[Rr].firstChild;null!==r&&gy(i[Rr],i,r,e)}n[rh]!==n[wl]&&e.push(n[rh])}let JT=[];const jM={...He,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{$p(n.lView)},consumerOnSignalRead(){this.lView[Bl]=this}},Bw=100;function tA(n,e=!0,t=0){const i=n[Au],r=i.rendererFactory;r.begin?.();try{!function n3(n,e){U_(n,e);let t=0;for(;Rc(n);){if(t===Bw)throw new Zt(103,!1);t++,U_(n,1)}}(n,t)}catch(o){throw e&&Tw(n,o),o}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function s3(n,e,t,i){const r=e[Ks];if(!(256&~r))return;e[Au].inlineEffectRunner?.flush(),jg(e);let o=null,l=null;(function o3(n){return 2!==n.type})(n)&&(l=function e3(n){return n[Bl]??function t3(n){const e=JT.pop()??Object.create(jM);return e.lView=n,e}(n)}(e),o=fe(l));try{R1(e),function r_(n){return Ts.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&zM(n,e,t,2,i);const d=!(3&~r);if(d){const g=n.preOrderCheckHooks;null!==g&&uh(e,g,null)}else{const g=n.preOrderHooks;null!==g&&hh(e,g,0,null),Zp(e,0)}if(function dP(n){for(let e=Ya(n);null!==e;e=Qc(e)){if(!(e[Ks]&J0.HasTransplantedViews))continue;const t=e[Xr];for(let i=0;i<t.length;i++){n_(t[i])}}}(e),Pw(e,0),null!==n.contentQueries&&GM(n,e),d){const g=n.contentCheckHooks;null!==g&&uh(e,g)}else{const g=n.contentHooks;null!==g&&hh(e,g,1),Zp(e,1)}!function qT(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)ap(~r);else{const s=r,o=t[++i],l=t[++i];o_(o,s),l(2,e[s])}}}finally{ap(-1)}}(n,e);const u=n.components;null!==u&&Rw(e,u,0);const f=n.viewQuery;if(null!==f&&L_(2,f,i),d){const g=n.viewCheckHooks;null!==g&&uh(e,g)}else{const g=n.viewHooks;null!==g&&hh(e,g,2),Zp(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Bd]){for(const g of e[Bd])g();e[Bd]=null}e[Ks]&=-73}catch(d){throw $p(e),d}finally{null!==l&&(le(l,o),function cP(n){n.lView[Bl]!==n&&(n.lView=null,JT.push(n))}(l)),f_()}}function Pw(n,e){for(let t=Ya(n);null!==t;t=Qc(t))for(let i=Ea;i<t.length;i++)$M(t[i],e)}function uP(n,e,t){$M(Rd(e,n),t)}function $M(n,e){ah(n)&&U_(n,e)}function U_(n,e){const i=n[Rr],r=n[Ks],s=n[Bl];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!Y(s)),s&&(s.dirty=!1),n[Ks]&=-9217,o)s3(i,n,i.template,n[ml]);else if(8192&r){Pw(n,1);const l=i.components;null!==l&&Rw(n,l,1)}}function Rw(n,e,t){for(let i=0;i<e.length;i++)uP(n,e[i],t)}function Yv(n){for(n[Au].changeDetectionScheduler?.notify();n;){n[Ks]|=64;const e=Rh(n);if(Gp(n)&&!e)return n;n=e}return null}class Kv{get rootNodes(){const e=this._lView,t=e[Rr];return gy(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ml]}set context(e){this._lView[ml]=e}get destroyed(){return!(256&~this._lView[Ks])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Na];if(Al(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(B_(e,i),jf(t,i))}this._attachedToViewContainer=!1}fw(this._lView[Rr],this._lView)}onDestroy(e){op(this._lView,e)}markForCheck(){Yv(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ks]&=-129}reattach(){pf(this._lView),this._lView[Ks]|=128}detectChanges(){this._lView[Ks]|=1024,tA(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Zt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,OT(this._lView[Rr],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Zt(902,!1);this._appRef=e,pf(this._lView)}}let Nd=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=hP}return n})();const a3=Nd,l3=class extends a3{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=Ay(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new Kv(r)}};function hP(){return kw(Ua(),qi())}function kw(n,e){return 4&n.type?new l3(e,n,hp(n,e)):null}let x3=()=>null;function eb(n,e){return x3(n,e)}class tb{}class yP{}class tS{}class vP{resolveComponentFactory(e){throw function zw(n){const e=Error(`No component factory found for ${_t(n)}.`);return e.ngComponent=n,e}(e)}}let M=(()=>{class n{static#e=this.NULL=new vP}return n})();class a{}let c=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function h(){const n=qi(),t=Rd(Ua().index,n);return(Bc(t)?t:n)[Ao]}()}return n})(),p=(()=>{class n{static#e=this.\u0275prov=ci({token:n,providedIn:"root",factory:()=>null})}return n})();const E={},K=new Set;function de(n){K.has(n)||(K.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function ge(...n){}class Be{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xs(!1),this.onMicrotaskEmpty=new xs(!1),this.onStable=new xs(!1),this.onError=new xs(!1),typeof Zone>"u")throw new Zt(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function Me(){const n="function"==typeof Wt.requestAnimationFrame;let e=Wt[n?"requestAnimationFrame":"setTimeout"],t=Wt[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Ye(n){const e=()=>{!function bt(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Wt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,qe(n),n.isCheckStableRunning=!0,it(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),qe(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,l)=>{if(function kn(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(l))return t.invokeTask(r,s,o,l);try{return Ft(n),t.invokeTask(r,s,o,l)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),mt(n)}},onInvoke:(t,i,r,s,o,l,d)=>{try{return Ft(n),t.invoke(r,s,o,l,d)}finally{n.shouldCoalesceRunChangeDetection&&e(),mt(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,qe(n),it(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Be.isInAngularZone())throw new Zt(909,!1)}static assertNotInAngularZone(){if(Be.isInAngularZone())throw new Zt(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,Ge,ge,ge);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const Ge={};function it(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function qe(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Ft(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function mt(n){n._nesting--,it(n)}class Ut{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xs,this.onMicrotaskEmpty=new xs,this.onStable=new xs,this.onError=new xs}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}var wn=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(wn||{});const $n={destroy(){}};function In(n,e){!e&&K0();const t=e?.injector??li(sl);if(!function zh(n){return"browser"===(n??li(sl)).get(om)}(t))return $n;de("NgAfterNextRender");const i=t.get(ei),r=i.handler??=new hr,s=e?.phase??wn.MixedReadWrite,o=()=>{r.unregister(d),l()},l=t.get(yu).onDestroy(o),d=hd(t,()=>new dr(s,()=>{o(),n()}));return r.register(d),{destroy:o}}class dr{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=li(Be),this.errorHandler=li(Cl,{optional:!0}),li(tb,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class hr{constructor(){this.executingCallbacks=!1,this.buckets={[wn.EarlyRead]:new Set,[wn.Write]:new Set,[wn.MixedReadWrite]:new Set,[wn.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const t of e)t.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let ei=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of t)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=ci({token:n,providedIn:"root",factory:()=>new n})}return n})();function co(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const l=e[o];"number"==typeof l?s=l:1==s?r=Lt(r,l):2==s&&(i=Lt(i,l+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class no extends M{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ys(e);return new Nn(t,this.ngModule)}}function $s(n){const e=[];for(const t in n){if(!n.hasOwnProperty(t))continue;const i=n[t];void 0!==i&&e.push({propName:Array.isArray(i)?i[0]:i,templateName:t})}return e}class uo{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Cc(i);const r=this.injector.get(e,E,i);return r!==E||t===E?r:this.parentInjector.get(e,t,i)}}class Nn extends tS{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=$s(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return $s(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Xf(n){return n.map(S1).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){const s=Je(null);try{let o=(r=r||this.ngModule)instanceof xl?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const l=o?new uo(e,o):e,d=l.get(a,null);if(null===d)throw new Zt(407,!1);const u=l.get(p,null),T={rendererFactory:d,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:l.get(ei,null),changeDetectionScheduler:l.get(tb,null)},B=d.createRenderer(null,this.componentDef),q=this.componentDef.selectors[0][0]||"div",re=i?function rP(n,e,t,i){const s=i.get(vu,!1)||t===Ed.ShadowDom,o=n.selectRootElement(e,s);return function k_(n){WT(n)}(o),o}(B,i,this.componentDef.encapsulation,l):hw(B,q,function _a(n){const e=n.toLowerCase();return"svg"===e?e_:"math"===e?"math":null}(q));let se=512;this.componentDef.signals?se|=4096:this.componentDef.onPush||(se|=16);let ne=null;null!==re&&(ne=Kn(re,l,!0));const De=Tf(0,null,null,1,0,null,null,null,null,null,null),Se=jv(null,De,null,se,null,null,T,B,l,null,ne);let je,Dt;jg(Se);try{const Mt=this.componentDef;let Bt,Jt=null;Mt.findHostDirectiveDefs?(Bt=[],Jt=new Map,Mt.findHostDirectiveDefs(Mt,Bt,Jt),Bt.push(Mt)):Bt=[Mt];const Vn=function lr(n,e){const t=n[Rr],i=us;return n[i]=e,R_(t,i,2,"#host",null)}(Se,re),Tt=function Yr(n,e,t,i,r,s,o){const l=r[Rr];!function _r(n,e,t,i){for(const r of n)e.mergedAttrs=rf(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(co(e,e.mergedAttrs,!0),null!==t&&VT(i,t,e))}(i,n,e,o);let d=null;null!==e&&(d=Kn(e,r[Zl]));const u=s.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const g=jv(r,QT(t),null,f,r[n.index],n,s,u,null,null,d);return l.firstCreatePass&&HM(l,n,i.length-1),O_(r,g),r[n.index]=g}(Vn,re,Mt,Bt,Se,T,B);Dt=LA(De,us),re&&function Ds(n,e,t,i){if(i)Rg(n,t,["ng-version","17.3.12"]);else{const{attrs:r,classes:s}=function Bp(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ru(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Rg(n,t,r),s&&s.length>0&&Aw(n,t,s.join(" "))}}(B,Mt,re,i),void 0!==t&&function eo(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(Dt,this.ngContentSelectors,t),je=function zs(n,e,t,i,r,s){const o=Ua(),l=r[Rr],d=Pd(o,r);ww(l,r,o,t,null,i);for(let f=0;f<t.length;f++)Dr(Nu(r,l,o.directiveStart+f,o),r);Mw(l,r,o),d&&Dr(d,r);const u=Nu(r,l,o.directiveStart+o.componentOffset,o);if(n[ml]=r[ml]=u,null!==s)for(const f of s)f(u,e);return yw(l,o,r),u}(Tt,Mt,Bt,Jt,Se,[Va]),Dw(De,Se,null)}finally{f_()}return new Jr(this.componentType,je,hp(Dt,Se),Se,Dt)}finally{Je(s)}}}class Jr extends yP{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Kv(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;my(s[Rr],s,r,e,t),this.previousInputValues.set(e,t),Yv(Rd(this._tNode.index,s))}}get injector(){return new lc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Va(){const n=Ua();Af(qi()[Rr],n)}let _n=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=Gt}return n})();function Gt(){return ea(Ua(),qi())}const ji=_n,Zi=class extends ji{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return hp(this._hostTNode,this._hostLView)}get injector(){return new lc(this._hostTNode,this._hostLView)}get parentInjector(){const e=__(this._hostTNode,this._hostLView);if(Zg(e)){const t=Jg(e,this._hostLView),i=GA(e);return new lc(t[Rr].data[i+8],t)}return new lc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Fr(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Ea}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=eb(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(l,r,N_(this._hostTNode,o)),l}createComponent(e,t,i,r,s){const o=e&&!function Lg(n){return"function"==typeof n}(e);let l;if(o)l=t;else{const q=t||{};l=q.index,i=q.injector,r=q.projectableNodes,s=q.environmentInjector||q.ngModuleRef}const d=o?e:new Nn(Ys(e)),u=i||this.parentInjector;if(!s&&null==d.ngModule){const re=(o?u:this.parentInjector).get(xl,null);re&&(s=re)}const f=Ys(d.componentType??{}),g=eb(this._lContainer,f?.id??null),B=d.create(u,r,g?.firstChild??null,s);return this.insertImpl(B.hostView,l,N_(this._hostTNode,g)),B}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function ff(n){return Al(n[Na])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const d=r[Na],u=new Zi(d,d[Tc],d[Na]);u.detach(u.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return y0(o,r,s,i),e.attachToViewContainerRef(),Pg(Cr(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Fr(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=B_(this._lContainer,t);i&&(jf(Cr(this._lContainer),t),fw(i[Rr],i))}detach(e){const t=this._adjustIndex(e,-1),i=B_(this._lContainer,t);return i&&null!=jf(Cr(this._lContainer),t)?new Kv(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function Fr(n){return n[8]}function Cr(n){return n[8]||(n[8]=[])}function ea(n,e){let t;const i=e[n.index];return Al(i)?t=i:(t=py(i,e,null,n),e[n.index]=t,O_(e,t)),ts(t,e,n,i),new Zi(t,n,e)}let ts=function Wr(n,e,t,i){if(n[rh])return;let r;r=8&t.type?Go(i):function Oo(n,e){const t=n[Ao],i=t.createComment(""),r=Pd(e,n);return Jm(t,Gv(t,r),i,function UT(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[rh]=r},fs=()=>!1;class so{constructor(e){this.queryList=e,this.matches=null}clone(){return new so(this.queryList)}setDirty(){this.queryList.setDirty()}}class oo{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new oo(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==nS(e,t).matches&&this.queries[t].setDirty()}}class tl{constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function yh(n){return n.split(",").map(e=>e.trim())}(e):e}}class la{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new la(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class ec{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new ec(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,oi(t,s)),this.matchTNodeWithReadOption(e,t,as(t,e,s,!1,!1))}else i===Nd?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,as(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Ws||r===_n||r===Nd&&4&t.type)this.addMatch(t.index,-2);else{const s=as(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function oi(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function Ri(n,e,t,i){return-1===t?function gs(n,e){return 11&n.type?hp(n,e):4&n.type?kw(n,e):null}(e,n):-2===t?function ns(n,e,t){return t===Ws?hp(e,n):t===Nd?kw(e,n):t===_n?ea(e,n):void 0}(n,e,i):Nu(n,n[Rr],t,e)}function bs(n,e,t,i){const r=e[Ac].queries[i];if(null===r.matches){const s=n.data,o=t.matches,l=[];for(let d=0;null!==o&&d<o.length;d+=2){const u=o[d];l.push(u<0?null:Ri(e,s[u],o[d+1],t.metadata.read))}r.matches=l}return r.matches}function Fa(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=bs(n,e,r,t);for(let l=0;l<s.length;l+=2){const d=s[l];if(d>0)i.push(o[l/2]);else{const u=s[l+1],f=e[-d];for(let g=Ea;g<f.length;g++){const T=f[g];T[Nl]===T[Na]&&Fa(T[Rr],T,u,i)}if(null!==f[Xr]){const g=f[Xr];for(let T=0;T<g.length;T++){const B=g[T];Fa(B[Rr],B,u,i)}}}}}return i}function Jd(n,e,t){const i=new vf(!(4&~t));return function oN(n,e,t,i){const r=QM(e);r.push(t),n.firstCreatePass&&Ew(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[Ac]??=new oo).queries.push(new so(i))-1}function lm(n,e,t){null===n.queries&&(n.queries=new la),n.queries.track(new ec(e,t))}function nS(n,e){return n.queries.getByIndex(e)}function nb(n,e){const t=n[Rr],i=nS(t,e);return i.crossesNgTemplate?Fa(t,n,e,[]):bs(t,n,i,e)}function ib(n){return"function"==typeof n&&void 0!==n[et]}function rS(n,e){de("NgSignals");const t=function A(n){const e=Object.create(be);e.value=n;const t=()=>(Ie(e),e.value);return t[et]=e,t}(n),i=t[et];return e?.equal&&(i.equal=e.equal),t.set=r=>J(i,r),t.update=r=>function _e(n,e){he()||N(),J(n,e(n.value))}(i,r),t.asReadonly=S3.bind(t),t}function S3(){const n=this[et];if(void 0===n.readonlyFn){const e=()=>this();e[et]=n,n.readonlyFn=e}return n.readonlyFn}function E3(n){return ib(n)&&"function"==typeof n.set}function Fo(n){let e=function _N(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ql(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Zt(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=k3(n.inputs),o.inputTransforms=k3(n.inputTransforms),o.declaredInputs=k3(n.declaredInputs),o.outputs=k3(n.outputs);const l=r.hostBindings;l&&UX(n,l);const d=r.viewQuery,u=r.contentQueries;if(d&&LX(n,d),u&&NX(n,u),FX(n,r),ut(n.outputs,r.outputs),ql(r)&&r.data.animation){const f=n.data;f.animation=(f.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const l=s[o];l&&l.ngInherit&&l(n),l===Fo&&(t=!1)}}e=Object.getPrototypeOf(e)}!function OX(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=rf(r.hostAttrs,t=rf(t,r.hostAttrs))}}(i)}function FX(n,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;const i=e.inputs[t];if(void 0!==i&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t],null!==e.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!e.inputTransforms.hasOwnProperty(r))continue;n.inputTransforms??={},n.inputTransforms[r]=e.inputTransforms[r]}}}function k3(n){return n===th?{}:n===Si?[]:n}function LX(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function NX(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function UX(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Wl(n){const e=n.inputConfig,t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];Array.isArray(r)&&r[3]&&(t[i]=r[3])}n.inputTransforms=t}class rb{}class xN{}class wP extends rb{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new no(this);const r=rc(e);this._bootstrapComponents=zu(r.bootstrap),this._r3Injector=r0(e,t,[{provide:rb,useValue:this},{provide:M,useValue:this.componentFactoryResolver},...i],_t(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class CP extends xN{constructor(e){super(),this.moduleType=e}create(e){return new wP(this.moduleType,e,[])}}class wN extends rb{constructor(e){super(),this.componentFactoryResolver=new no(this),this.instance=null;const t=new Jf([...e.providers,{provide:rb,useValue:this},{provide:M,useValue:this.componentFactoryResolver}],e.parent||nh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function F3(n,e,t=null){return new wN({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let vy=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new jt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function L3(n){return!!MP(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function MP(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function C0(n,e,t){return n[e]=t}function zd(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function sb(n,e,t,i){const r=zd(n,e,t);return zd(n,e+1,i)||r}function Ss(n,e,t,i,r,s,o,l){const d=qi(),u=ma(),f=n+us,g=u.firstCreatePass?function ZX(n,e,t,i,r,s,o,l,d){const u=e.consts,f=R_(e,n,4,o||null,Lu(u,l));xw(e,t,f,Lu(u,d)),Af(e,f);const g=f.tView=Tf(2,f,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return null!==e.queries&&(e.queries.template(e,f),g.queries=e.queries.embeddedTView(f)),f}(f,u,d,e,t,i,r,s,o):u.data[f];lh(g,!1);const T=CN(u,d,g,n);Vm()&&qv(u,d,T,g),Dr(T,d);const B=py(T,d,T,g);return d[f]=B,O_(d,B),function ta(n,e,t){return fs(n,e,t)}(B,g,d),Pc(g)&&eA(u,d,g),null!=o&&vw(d,g,l),Ss}let CN=function MN(n,e,t,i){return Ja(!0),e[Ao].createComment("")};function ol(n,e,t,i){const r=qi();return zd(r,dh(),e)&&(ma(),Hh(_l(),r,n,e,t,i)),ol}function Yw(n,e,t,i,r,s){const l=sb(n,function ch(){return Ts.lFrame.bindingIndex}(),t,r);return mf(2),l?e+ao(t)+i+ao(r)+s:Xo}function r2(n,e,t,i,r,s,o,l){const d=qi(),u=Yw(d,e,t,i,r,s);return u!==Xo&&Hh(_l(),d,n,u,o,l),r2}function q3(n,e){return n<<17|e<<2}function xy(n){return n>>17&32767}function FP(n){return 2|n}function ab(n){return(131068&n)>>2}function OP(n,e){return-131069&n|e<<2}function LP(n){return 1|n}function t6(n,e,t,i){const r=n[t+1],s=null===e;let o=i?xy(r):ab(r),l=!1;for(;0!==o&&(!1===l||s);){const u=n[o+1];NY(n[o],e)&&(l=!0,n[o+1]=i?LP(u):FP(u)),o=i?xy(u):ab(u)}l&&(n[t+1]=i?FP(r):LP(r))}function NY(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Zo(n,e)>=0}const bu={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function n6(n){return n.substring(bu.key,bu.keyEnd)}function UY(n){return n.substring(bu.value,bu.valueEnd)}function i6(n,e){const t=bu.textEnd;return t===e?-1:(e=bu.keyEnd=function VY(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,bu.key=e,t),s2(n,e,t))}function r6(n,e){const t=bu.textEnd;let i=bu.key=s2(n,e,t);return t===i?-1:(i=bu.keyEnd=function GY(n,e,t){let i;for(;e<t&&(45===(i=n.charCodeAt(e))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)e++;return e}(n,i,t),i=o6(n,i,t),i=bu.value=s2(n,i,t),i=bu.valueEnd=function qY(n,e,t){let i=-1,r=-1,s=-1,o=e,l=o;for(;o<t;){const d=n.charCodeAt(o++);if(59===d)return l;34===d||39===d?l=o=a6(n,d,o,t):e===o-4&&85===s&&82===r&&76===i&&40===d?l=o=a6(n,41,o,t):d>32&&(l=o),s=r,r=i,i=-33&d}return l}(n,i,t),o6(n,i,t))}function s6(n){bu.key=0,bu.keyEnd=0,bu.value=0,bu.valueEnd=0,bu.textEnd=n.length}function s2(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function o6(n,e,t,i){return(e=s2(n,e,t))<t&&e++,e}function a6(n,e,t,i){let r=-1,s=t;for(;s<i;){const o=n.charCodeAt(s++);if(o==e&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Qn(n,e,t){const i=qi();return zd(i,dh(),e)&&Ld(ma(),_l(),i,n,e,i[Ao],t,!1),Qn}function NP(n,e,t,i,r){const o=r?"class":"style";my(n,t,e.inputs[o],o,i)}function uS(n,e,t){return eg(n,e,t,!1),uS}function nl(n,e){return eg(n,e,null,!0),nl}function QY(n,e){for(let t=function HY(n){return s6(n),r6(n,s2(n,0,bu.textEnd))}(e);t>=0;t=r6(e,t))d6(n,n6(e),UY(e))}function sA(n){tg(KY,M0,n,!0)}function M0(n,e){for(let t=function zY(n){return s6(n),i6(n,s2(n,0,bu.textEnd))}(e);t>=0;t=i6(e,t))Ll(n,n6(e),!0)}function eg(n,e,t,i){const r=qi(),s=ma(),o=mf(2);s.firstUpdatePass&&c6(s,n,o,i),e!==Xo&&zd(r,o,e)&&u6(s,s.data[kc()],r,r[Ao],n,r[o+1]=function JY(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=_t(ha(n)))),n}(e,t),i,o)}function tg(n,e,t,i){const r=ma(),s=mf(2);r.firstUpdatePass&&c6(r,null,s,i);const o=qi();if(t!==Xo&&zd(o,s,t)){const l=r.data[kc()];if(f6(l,i)&&!l6(r,s)){let d=i?l.classesWithoutHost:l.stylesWithoutHost;null!==d&&(t=Lt(d,t||"")),NP(r,l,o,t,i)}else!function ZY(n,e,t,i,r,s,o,l){r===Xo&&(r=Si);let d=0,u=0,f=0<r.length?r[0]:null,g=0<s.length?s[0]:null;for(;null!==f||null!==g;){const T=d<r.length?r[d+1]:void 0,B=u<s.length?s[u+1]:void 0;let re,q=null;f===g?(d+=2,u+=2,T!==B&&(q=g,re=B)):null===g||null!==f&&f<g?(d+=2,q=f):(u+=2,q=g,re=B),null!==q&&u6(n,e,t,i,q,re,o,l),f=d<r.length?r[d]:null,g=u<s.length?s[u]:null}}(r,l,o,o[Ao],o[s+1],o[s+1]=function YY(n,e,t){if(null==t||""===t)return Si;const i=[],r=ha(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}function l6(n,e){return e>=n.expandoStartIndex}function c6(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[kc()],o=l6(n,t);f6(s,i)&&null===e&&!o&&(e=!1),e=function WY(n,e,t,i){const r=function l_(n){const e=Ts.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=hS(t=UP(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=UP(r,n,e,t,i),null===s){let d=function jY(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==ab(i))return n[xy(i)]}(n,e,i);void 0!==d&&Array.isArray(d)&&(d=UP(null,n,e,d[1],i),d=hS(d,e.attrs,i),function $Y(n,e,t,i){n[xy(t?e.classBindings:e.styleBindings)]=i}(n,e,i,d))}else s=function XY(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=hS(i,n[s].hostAttrs,t);return hS(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function OY(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,l=xy(o),d=ab(o);n[i]=t;let f,u=!1;if(Array.isArray(t)?(f=t[1],(null===f||Zo(t,f)>0)&&(u=!0)):f=t,r)if(0!==d){const T=xy(n[l+1]);n[i+1]=q3(T,l),0!==T&&(n[T+1]=OP(n[T+1],i)),n[l+1]=function kY(n,e){return 131071&n|e<<17}(n[l+1],i)}else n[i+1]=q3(l,0),0!==l&&(n[l+1]=OP(n[l+1],i)),l=i;else n[i+1]=q3(d,0),0===l?l=i:n[d+1]=OP(n[d+1],i),d=i;u&&(n[i+1]=FP(n[i+1])),t6(n,f,i,!0),t6(n,f,i,!1),function LY(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Zo(s,e)>=0&&(t[i+1]=LP(t[i+1]))}(e,f,n,i,s),o=q3(l,d),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function UP(n,e,t,i,r){let s=null;const o=t.directiveEnd;let l=t.directiveStylingLast;for(-1===l?l=t.directiveStart:l++;l<o&&(s=e[l],i=hS(i,s.hostAttrs,r),s!==n);)l++;return null!==n&&(t.directiveStylingLast=l),i}function hS(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ll(n,o,!!t||e[++s]))}return void 0===n?null:n}function d6(n,e,t){Ll(n,e,ha(t))}function KY(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&Ll(n,i,t)}function u6(n,e,t,i,r,s,o,l){if(!(3&e.type))return;const d=n.data,u=d[l+1],f=function FY(n){return!(1&~n)}(u)?h6(d,e,t,r,ab(u),o):void 0;Q3(f)||(Q3(s)||function RY(n){return!(2&~n)}(u)&&(s=h6(d,null,t,r,l,o)),function LM(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Ef.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Ef.Important),n.setStyle(t,i,r,s))}}(i,o,OA(kc(),t),r,s))}function h6(n,e,t,i,r,s){const o=null===e;let l;for(;r>0;){const d=n[r],u=Array.isArray(d),f=u?d[1]:d,g=null===f;let T=t[r+1];T===Xo&&(T=g?Si:void 0);let B=g?eh(T,i):f===i?T:void 0;if(u&&!Q3(B)&&(B=eh(d,i)),Q3(B)&&(l=B,o))return l;const q=n[r+1];r=o?xy(q):ab(q)}if(null!==e){let d=s?e.residualClasses:e.residualStyles;null!=d&&(l=eh(d,i))}return l}function Q3(n){return void 0!==n}function f6(n,e){return!!(n.flags&(e?8:16))}class dK{destroy(e){}updateValue(e,t){}swap(e,t){const i=Math.min(e,t),r=Math.max(e,t),s=this.detach(r);if(r-i>1){const o=this.detach(i);this.attach(i,s),this.attach(r,o)}else this.attach(i,s)}move(e,t){this.attach(t,this.detach(e))}}function zP(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function HP(n,e,t,i){return!(void 0===e||!e.has(i)||(n.attach(t,e.get(i)),e.delete(i),0))}function p6(n,e,t,i,r){if(HP(n,e,i,t(i,r)))n.updateValue(i,r);else{const s=n.create(i,r);n.attach(i,s)}}function m6(n,e,t,i){const r=new Set;for(let s=e;s<=t;s++)r.add(i(s,n.at(s)));return r}class A6{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;const t=this.kvMap.get(e);return void 0!==this._vMap&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);void 0===this._vMap&&(this._vMap=new Map);const r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),void 0!==this._vMap){const r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}}function V_(n,e,t){de("NgControlFlow");const i=qi(),r=dh(),s=GP(i,us+n);if(zd(i,r,e)){const l=Je(null);try{if(Xv(s,0),-1!==e){const d=qP(i[Rr],us+e),u=eb(s,d.tView.ssrId);y0(s,Ay(i,d,t,{dehydratedView:u}),0,N_(d,u))}}finally{Je(l)}}else{const l=ZT(s,0);void 0!==l&&(l[ml]=t)}}class hK{constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-Ea}}function g6(n){return n}class fK{constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}}class pK extends dK{constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Ea}at(e){return this.getLView(e)[ml].$implicit}attach(e,t){const i=t[Dc];this.needsIndexUpdate||=e!==this.length,y0(this.lContainer,t,e,N_(this.templateTNode,i))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,function mK(n,e){return B_(n,e)}(this.lContainer,e)}create(e,t){const i=eb(this.lContainer,this.templateTNode.tView.ssrId);return Ay(this.hostLView,this.templateTNode,new hK(this.lContainer,t,e),{dehydratedView:i})}destroy(e){fw(e[Rr],e)}updateValue(e,t){this.getLView(e)[ml].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[ml].$index=e}getLView(e){return function AK(n,e){return ZT(n,e)}(this.lContainer,e)}}function GP(n,e){return n[e]}function qP(n,e){return LA(n,e)}function en(n,e,t,i){const r=qi(),s=ma(),o=us+n,l=r[Ao],d=s.firstCreatePass?function gK(n,e,t,i,r,s){const o=e.consts,d=R_(e,n,2,i,Lu(o,r));return xw(e,t,d,Lu(o,s)),null!==d.attrs&&co(d,d.attrs,!1),null!==d.mergedAttrs&&co(d,d.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,d),d}(o,s,r,e,t,i):s.data[o],u=_6(s,r,d,l,e,n);r[o]=u;const f=Pc(d);return lh(d,!0),VT(l,u,d),!function aS(n){return!(32&~n.flags)}(d)&&Vm()&&qv(s,r,u,d),0===function $a(){return Ts.lFrame.elementDepthCount}()&&Dr(u,r),function Av(){Ts.lFrame.elementDepthCount++}(),f&&(eA(s,r,d),yw(s,d,r)),null!==i&&vw(r,d),en}function vn(){let n=Ua();zA()?qg():(n=n.parent,lh(n,!1));const e=n;(function F1(n){return Ts.skipHydrationRootTNode===n})(e)&&function Gg(){Ts.skipHydrationRootTNode=null}(),function NA(){Ts.lFrame.elementDepthCount--}();const t=ma();return t.firstCreatePass&&(Af(t,n),PA(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function Yg(n){return!!(8&n.flags)}(e)&&NP(t,e,qi(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Kg(n){return!!(16&n.flags)}(e)&&NP(t,e,qi(),e.stylesWithoutHost,!1),vn}function Er(n,e,t,i){return en(n,e,t,i),vn(),Er}let _6=(n,e,t,i,r,s)=>(Ja(!0),hw(i,r,function G1(){return Ts.lFrame.currentNamespace}()));function ng(n,e,t){const i=qi(),r=ma(),s=n+us,o=r.firstCreatePass?function vK(n,e,t,i,r){const s=e.consts,o=Lu(s,i),l=R_(e,n,8,"ng-container",o);return null!==o&&co(l,o,!0),xw(e,t,l,Lu(s,r)),null!==e.queries&&e.queries.elementStart(e,l),l}(s,r,i,e,t):r.data[s];lh(o,!0);const l=y6(r,i,o,n);return i[s]=l,Vm()&&qv(r,i,l,o),Dr(l,i),Pc(o)&&(eA(r,i,o),yw(r,o,i)),null!=t&&vw(i,o),ng}function ig(){let n=Ua();const e=ma();return zA()?qg():(n=n.parent,lh(n,!1)),e.firstCreatePass&&(Af(e,n),PA(n)&&e.queries.elementEnd(n)),ig}function o2(n,e,t){return ng(n,e,t),ig(),o2}let y6=(n,e,t,i)=>(Ja(!0),PM(e[Ao],""));function Uo(){return qi()}function a2(n,e,t){const i=qi();return zd(i,dh(),e)&&Ld(ma(),_l(),i,n,e,i[Ao],t,!0),a2}const lb=void 0;var CK=["en",[["a","p"],["AM","PM"],lb],[["AM","PM"],lb,lb],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],lb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],lb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",lb,"{1} 'at' {0}",lb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function wK(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let l2={};function If(n){const e=function MK(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=x6(e);if(t)return t;const i=e.split("-")[0];if(t=x6(i),t)return t;if("en"===i)return CK;throw new Zt(701,!1)}function x6(n){return n in l2||(l2[n]=Wt.ng&&Wt.ng.common&&Wt.ng.common.locales&&Wt.ng.common.locales[n]),l2[n]}var yc=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(yc||{});const c2="en-US";let w6=c2;function gi(n,e,t,i){const r=qi(),s=ma(),o=Ua();return jP(s,r,r[Ao],o,n,e,i),gi}function jP(n,e,t,i,r,s,o){const l=Pc(i),u=n.firstCreatePass&&Ew(n),f=e[ml],g=QM(e);let T=!0;if(3&i.type||o){const re=Pd(i,e),se=o?o(re):re,ne=g.length,De=o?je=>o(Go(je[i.index])):i.index;let Se=null;if(!o&&l&&(Se=function bZ(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const l=e[Bm],d=r[s+2];return l.length>d?l[d]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Se)(Se.__ngLastListenerFn__||Se).__ngNextListenerFn__=s,Se.__ngLastListenerFn__=s,T=!1;else{s=K6(i,e,f,s,!1);const je=t.listen(se,r,s);g.push(s,je),u&&u.push(r,De,ne,ne+1)}}else s=K6(i,e,f,s,!1);const B=i.outputs;let q;if(T&&null!==B&&(q=B[r])){const re=q.length;if(re)for(let se=0;se<re;se+=2){const Dt=e[q[se]][q[se+1]].subscribe(s),Mt=g.length;g.push(s,Dt),u&&u.push(r,i.index,Mt,-(Mt+1))}}}function Y6(n,e,t,i){const r=Je(null);try{return gl(6,e,t),!1!==t(i)}catch(s){return Tw(n,s),!1}finally{gl(7,e,t),Je(r)}}function K6(n,e,t,i,r){return function s(o){if(o===Function)return i;Yv(n.componentOffset>-1?Rd(n.index,e):e);let d=Y6(e,t,i,o),u=s.__ngNextListenerFn__;for(;u;)d=Y6(e,t,u,o)&&d,u=u.__ngNextListenerFn__;return r&&!1===d&&o.preventDefault(),d}}function br(n=1){return function VA(n){return(Ts.lFrame.contextLView=function i_(n,e){for(;n>0;)e=e[ih],n--;return e}(n,Ts.lFrame.contextLView))[ml]}(n)}function xZ(n,e){let t=null;const i=function Dm(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?DA(n,s,!0):uv(i,s))return r}else t=r}return t}function vh(n){const e=qi()[ko][Tc];if(!e.projection){const i=e.projection=function mc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?xZ(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function eu(n,e=0,t){const i=qi(),r=ma(),s=R_(r,us+n,16,null,t||null);null===s.projection&&(s.projection=e),qg(),(!i[Dc]||zm())&&32&~s.flags&&function iP(n,e,t){Wv(e[Ao],0,e,t,oy(n,t,e),ay(t.parent||e[Tc],t,e))}(r,i,s)}function vp(n,e,t,i){!function Ql(n,e,t,i){const r=ma();if(r.firstCreatePass){const s=Ua();lm(r,new tl(e,t,i),s.index),function M3(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),!(2&~t)&&(r.staticContentQueries=!0)}return Jd(r,qi(),t)}(n,e,t,i)}function vl(n,e,t){!function Df(n,e,t){const i=ma();return i.firstCreatePass&&(lm(i,new tl(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),Jd(i,qi(),e)}(n,e,t)}function ia(n){const e=qi(),t=ma(),i=c_();HA(i+1);const r=nS(t,i);if(n.dirty&&function t_(n){return!(4&~n[Ks])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=nb(e,i);n.reset(s,jA),n.notifyOnChanges()}return!0}return!1}function ra(){return function zl(n,e){return n[Ac].queries[e].queryList}(qi(),c_())}function qa(n){return Nm(function U1(){return Ts.lFrame.contextLView}(),us+n)}function Ji(n,e=""){const t=qi(),i=ma(),r=n+us,s=i.firstCreatePass?R_(i,r,1,e,null):i.data[r],o=A8(i,t,s,e,n);t[r]=o,Vm()&&qv(i,t,o,s),lh(s,!1)}let A8=(n,e,t,i,r)=>(Ja(!0),function BM(n,e){return n.createText(e)}(e[Ao],i));function rg(n){return Sl("",n,""),rg}function Sl(n,e,t){const i=qi(),r=function Xw(n,e,t,i){return zd(n,dh(),t)?e+ao(t)+i:Xo}(i,n,e,t);return r!==Xo&&function Ap(n,e,t){const i=OA(e,n);!function FT(n,e,t){n.setValue(e,t)}(n[Ao],i,t)}(i,kc(),r),Sl}function d2(n,e,t){E3(e)&&(e=e());const i=qi();return zd(i,dh(),e)&&Ld(ma(),_l(),i,n,e,i[Ao],t,!1),d2}function yS(n,e){const t=E3(n);return t&&n.set(e),t}function u2(n,e){const t=qi(),i=ma(),r=Ua();return jP(i,t,t[Ao],r,n,e),u2}function XP(n,e,t,i,r){if(n=cn(n),Array.isArray(n))for(let s=0;s<n.length;s++)XP(n[s],e,t,i,r);else{const s=ma(),o=qi(),l=Ua();let d=Lp(n)?n:cn(n.provide);const u=Td(n),f=1048575&l.providerIndexes,g=l.directiveStart,T=l.providerIndexes>>20;if(Lp(n)||!n.multi){const B=new cp(u,r,Vt),q=KP(d,e,r?f:f+T,g);-1===q?(j1(qm(l,o),s,d),YP(s,n,e.length),e.push(d),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(B),o.push(B)):(t[q]=B,o[q]=B)}else{const B=KP(d,e,f+T,g),q=KP(d,e,f,f+T),se=q>=0&&t[q];if(r&&!se||!r&&!(B>=0&&t[B])){j1(qm(l,o),s,d);const ne=function HZ(n,e,t,i,r){const s=new cp(n,t,Vt);return s.multi=[],s.index=e,s.componentProviders=0,M8(s,r,i&&!t),s}(r?zZ:UZ,t.length,r,i,u);!r&&se&&(t[q].providerFactory=ne),YP(s,n,e.length,0),e.push(d),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(ne),o.push(ne)}else YP(s,n,B>-1?B:q,M8(t[r?q:B],u,!r&&i));!r&&i&&se&&t[q].componentProviders++}}}function YP(n,e,t,i){const r=Lp(e),s=function Zf(n){return!!n.useClass}(e);if(r||s){const d=(s?cn(e.useClass):e).prototype.ngOnDestroy;if(d){const u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const f=u.indexOf(t);-1===f?u.push(t,[i,d]):u[f+1].push(i,d)}else u.push(t,d)}}}function M8(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function KP(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function UZ(n,e,t,i){return ZP(this.multi,[])}function zZ(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,l=Nu(t,t[Rr],this.providerFactory.index,i);s=l.slice(0,o),ZP(r,s);for(let d=o;d<l.length;d++)s.push(l[d])}else s=[],ZP(r,s);return s}function ZP(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Po(n,e=[]){return t=>{t.providersResolver=(i,r)=>function NZ(n,e,t){const i=ma();if(i.firstCreatePass){const r=ql(n);XP(t,i.data,i.blueprint,r,!0),XP(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}let VZ=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=kp(0,t.type),r=i.length>0?F3([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ci({token:n,providedIn:"environment",factory:()=>new n(pi(xl))})}return n})();function rd(n){de("NgStandalone"),n.getStandaloneInjector=e=>e.get(VZ).getOrCreateStandaloneInjector(n)}function Gh(n,e,t,i){return T8(qi(),qc(),n,e,t,i)}function E8(n,e,t,i,r,s){return function I8(n,e,t,i,r,s,o,l){const d=e+t;return function N3(n,e,t,i,r){const s=sb(n,e,t,i);return zd(n,e+2,r)||s}(n,d,r,s,o)?C0(n,d+3,l?i.call(l,r,s,o):i(r,s,o)):vS(n,d+3)}(qi(),qc(),n,e,t,i,r,s)}function vS(n,e){const t=n[e];return t===Xo?void 0:t}function T8(n,e,t,i,r,s){const o=e+t;return zd(n,o,r)?C0(n,o+1,s?i.call(s,r):i(r)):vS(n,o+1)}function D8(n,e,t,i,r,s,o){const l=e+t;return sb(n,l,r,s)?C0(n,l+2,o?i.call(o,r,s):i(r,s)):vS(n,l+2)}function bS(n,e){const t=ma();let i;const r=n+us;t.firstCreatePass?(i=function ZZ(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=dd(i.type)),l=jd(Vt);try{const d=A_(!1),u=s();return A_(d),function SZ(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,qi(),r,u),u}finally{jd(l)}}function J3(n,e,t,i){const r=n+us,s=qi(),o=Nm(s,r);return xS(s,r)?D8(s,qc(),e,o.transform,t,i,o):o.transform(t,i)}function xS(n,e){return n[Rr].data[e].pure}function eR(n,e){return kw(n,e)}let X8=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const eU=new Mi(""),nD=new Mi("");let lR,oR=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,lR||(function $J(n){lR=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Be.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Be),pi(aR),pi(nD))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})(),aR=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return lR?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function MS(n){return!!n&&"function"==typeof n.then}function tU(n){return!!n&&"function"==typeof n.subscribe}const cR=new Mi("");let dR=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=li(cR,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(MS(s))t.push(s);else if(tU(s)){const o=new Promise((l,d)=>{s.subscribe({complete:l,error:d})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const uR=new Mi("");function rU(n,e){return Array.isArray(e)?e.reduce(rU,n):{...n,...e}}let S0=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=li(up),this.afterRenderEffectManager=li(ei),this.externalTestViews=new Set,this.beforeRender=new xt,this.afterTick=new xt,this.componentTypes=[],this.components=[],this.isStable=li(vy).hasPendingTasks.pipe(Rn(t=>!t)),this._injector=li(xl)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof tS;if(!this._injector.get(dR).done)throw!r&&function Gc(n){const e=Ys(n)||ul(n)||hl(n);return null!==e&&e.standalone}(t),new Zt(405,!1);let o;o=r?t:this._injector.get(M).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const l=function XJ(n){return n.isBoundToModule}(o)?void 0:this._injector.get(rb),u=o.create(sl.NULL,[],i||o.selector,l),f=u.location.nativeElement,g=u.injector.get(eU,null);return g?.registerApplication(f),u.onDestroy(()=>{this.detachView(u.hostView),iD(this.components,u),g?.unregisterApplication(f)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new Zt(101,!1);const i=Je(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,Je(i)}}detectChangesInAttachedViews(t){let i=0;const r=this.afterRenderEffectManager;for(;;){if(i===Bw)throw new Zt(103,!1);if(t){const s=0===i;this.beforeRender.next(s);for(let{_lView:o,notifyErrorHandler:l}of this._views)KJ(o,s,l)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>hR(s))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>hR(s))))break}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;iD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(uR,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>iD(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Zt(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function KJ(n,e,t){!e&&!hR(n)||function ZJ(n,e,t){let i;t?(i=0,n[Ks]|=1024):i=64&n[Ks]?0:1,tA(n,e,i)}(n,t,e)}function hR(n){return Rc(n)}class JJ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let sU=(()=>{class n{compileModuleSync(t){return new CP(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=zu(rc(t).declarations).reduce((o,l)=>{const d=Ys(l);return d&&o.push(new Nn(d)),o},[]);return new JJ(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),nee=(()=>{class n{constructor(){this.zone=li(Be),this.applicationRef=li(S0)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iee(){const n=li(Be),e=li(Cl);return t=>n.runOutsideAngular(()=>e.handleError(t))}let see=(()=>{class n{constructor(){this.subscription=new lt,this.initialized=!1,this.zone=li(Be),this.pendingTasks=li(vy)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Be.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Be.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const E0=new Mi("",{providedIn:"root",factory:()=>li(E0,ua.Optional|ua.SkipSelf)||function oee(){return typeof $localize<"u"&&$localize.locale||c2}()}),fR=new Mi("");let cU=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function bn(n="zone.js",e){return"noop"===n?new Ut:"zone.js"===n?new Be(e):n}(i?.ngZone,function lU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function WX(n,e,t){return new wP(n,e,t)}(t.moduleType,this.injector,function aU(n){return[{provide:Be,useFactory:n},{provide:vo,multi:!0,useFactory:()=>{const e=li(nee,{optional:!0});return()=>e.initialize()}},{provide:vo,multi:!0,useFactory:()=>{const e=li(see);return()=>{e.initialize()}}},{provide:up,useFactory:iee}]}(()=>r)),o=s.injector.get(Cl,null);return r.runOutsideAngular(()=>{const l=r.onError.subscribe({next:d=>{o.handleError(d)}});s.onDestroy(()=>{iD(this._modules,s),l.unsubscribe()})}),function iU(n,e,t){try{const i=t();return MS(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const l=s.injector.get(dR);return l.runInitializers(),l.donePromise.then(()=>(function C6(n){"string"==typeof n&&(w6=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(E0,c2)||c2),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=rU({},i);return function tee(n,e,t){const i=new CP(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(S0);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Zt(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Zt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(fR,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(pi(sl))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),wy=null;const dU=new Mi("");function uU(n,e,t=[]){const i=`Platform: ${e}`,r=new Mi(i);return(s=[])=>{let o=pR();if(!o||o.injector.get(dU,!1)){const l=[...t,...s,{provide:r,useValue:!0}];n?n(l):function cee(n){if(wy&&!wy.get(dU,!1))throw new Zt(400,!1);(function nU(){!function m(n){te=n}(()=>{throw new Zt(600,!1)})})(),wy=n;const e=n.get(cU);(function fU(n){n.get($x,null)?.forEach(t=>t())})(n)}(function hU(n=[],e){return sl.create({name:e,providers:[{provide:af,useValue:"platform"},{provide:fR,useValue:new Set([()=>wy=null])},...n]})}(l,i))}return function dee(n){const e=pR();if(!e)throw new Zt(401,!1);return e}()}}function pR(){return wy?.get(cU)??null}let vc=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=hee}return n})();function hee(n){return function fee(n,e,t){if(cf(n)&&!t){const i=Rd(n.index,e);return new Kv(i,i)}return 47&n.type?new Kv(e[ko],e):null}(Ua(),qi(),!(16&~n))}class _U{constructor(){}supports(e){return L3(e)}create(e){return new _ee(e)}}const gee=(n,e)=>e;class _ee{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||gee}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<vU(i,r,s)?t:i,l=vU(o,r,s),d=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const u=l-r,f=d-r;if(u!=f){for(let T=0;T<u;T++){const B=T<s.length?s[T]:s[T]=0,q=B+T;f<=q&&q<u&&(s[T]=B+1)}s[o.previousIndex]=f-u}}l!==d&&e(o,l,d)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!L3(e))throw new Zt(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let l=0;l<this.length;l++)s=e[l],o=this._trackByFn(l,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,l)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,l),i=!0),t=t._next}else r=0,function YX(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,l=>{o=this._trackByFn(r,l),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,l,o,r)),Object.is(t.item,l)||this._addIdentityChange(t,l)):(t=this._mismatch(t,l,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new yee(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new yU),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new yU),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class yee{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class vee{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class yU{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new vee,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function vU(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class bU{constructor(){}supports(e){return e instanceof Map||MP(e)}create(){return new bee}}class bee{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||MP(e)))throw new Zt(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new xee(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class xee{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function xU(){return new p2([new _U])}let p2=(()=>{class n{static#e=this.\u0275prov=ci({token:n,providedIn:"root",factory:xU});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||xU()),deps:[[n,new bl,new fl]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Zt(901,!1)}}return n})();function wU(){return new aD([new bU])}let aD=(()=>{class n{static#e=this.\u0275prov=ci({token:n,providedIn:"root",factory:wU});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||wU()),deps:[[n,new bl,new fl]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Zt(901,!1)}}return n})();const Mee=uU(null,"core",[]);let See=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(pi(S0))};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})();function ho(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function tu(n,e=NaN){return isNaN(parseFloat(n))||isNaN(Number(n))?e:Number(n)}const nte=new Mi("",{providedIn:"root",factory:()=>li(ite)});let ite=(()=>{class n{static#e=this.\u0275prov=ci({token:n,providedIn:"root",factory:()=>new rte})}return n})();class rte{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=li(vy),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),null===this.taskId){const t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){const t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);const i=this.queues.get(t);i.has(e)||(this.queuedEffectCount++,i.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,t]of this.queues)null===e?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(const t of e)e.delete(t),this.queuedEffectCount--,t.run()}}class ste{constructor(e,t,i,r,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=i,this.injector=s,this.watcher=function Pe(n,e,t){const i=Object.create(dt);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=d=>{i.cleanupFn=d};return i.ref={notify:()=>ue(i),run:()=>{if(null===i.fn)return;if(function ot(){return ke}())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(i.dirty=!1,i.hasRun&&!Y(i))return;i.hasRun=!0;const d=fe(i);try{i.cleanupFn(),i.cleanupFn=We,i.fn(r)}finally{le(i,d)}},cleanup:()=>i.cleanupFn(),destroy:()=>function o(d){(function s(d){return null===d.fn&&null===d.schedule})(d)||(V(d),d.cleanupFn(),d.fn=null,d.schedule=null,d.cleanupFn=We)}(i),[et]:i},i.ref}(l=>this.runEffect(l),()=>this.schedule(),o),this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(Cl,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}}let jU=null;function Cy(){return jU}class cte{}const fa=new Mi("");let bR=(()=>{class n{historyGo(t){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>li(ute),providedIn:"platform"})}return n})();const dte=new Mi("");let ute=(()=>{class n extends bR{constructor(){super(),this._doc=li(fa),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cy().getBaseHref(this._doc)}onPopState(t){const i=Cy().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Cy().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function xR(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function $U(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function G_(n){return n&&"?"!==n[0]?"?"+n:n}let ub=(()=>{class n{historyGo(t){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>li(YU),providedIn:"root"})}return n})();const XU=new Mi("");let YU=(()=>{class n extends ub{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??li(fa).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return xR(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+G_(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+G_(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+G_(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(bR),pi(XU,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hte=(()=>{class n extends ub{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=xR(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+G_(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+G_(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(bR),pi(XU,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})(),hb=(()=>{class n{constructor(t){this._subject=new xs,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function mte(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}($U(KU(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+G_(i))}normalize(t){return n.stripTrailingSlash(function pte(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,KU(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+G_(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+G_(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=G_;static#t=this.joinWithSlash=xR;static#n=this.stripTrailingSlash=$U;static#i=this.\u0275fac=function(i){return new(i||n)(pi(ub))};static#r=this.\u0275prov=ci({token:n,factory:()=>function fte(){return new hb(pi(ub))}(),providedIn:"root"})}return n})();function KU(n){return n.replace(/\/index.html$/,"")}var fD=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(fD||{});const nu={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function oA(n,e){const t=If(n),i=t[yc.NumberSymbols][e];if(typeof i>"u"){if(e===nu.CurrencyDecimal)return t[yc.NumberSymbols][nu.Decimal];if(e===nu.CurrencyGroup)return t[yc.NumberSymbols][nu.Group]}return i}const Vte=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function IR(n){const e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function o7(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const PR=/\s+/,a7=[];let og=(()=>{class n{constructor(t,i){this._ngEl=t,this._renderer=i,this.initialClasses=a7,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(PR):a7}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(PR):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(PR).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(c))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngClass",""]],inputs:{klass:[mi.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class ene{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let um=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new ene(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const l=i.get(s);i.move(l,o),c7(l,r)}});for(let r=0,s=i.length;r<s;r++){const l=i.get(r).context;l.index=r,l.count=s,l.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{c7(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(_n),Vt(Nd),Vt(p2))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function c7(n,e){n.context.$implicit=e.item}let qh=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new tne,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){d7("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){d7("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(_n),Vt(Nd))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class tne{constructor(){this.$implicit=null,this.ngIf=null}}function d7(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${_t(e)}'.`)}class RR{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let CD=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const i=t===this._ngSwitch;return this._lastCasesMatched||=i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const i of this._defaultViews)i.enforceState(t)}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return n})(),u7=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new RR(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(_n),Vt(Nd),Vt(CD,9))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return n})(),f7=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:Ef.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(aD),Vt(c))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),p7=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(t,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(_n))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Pl]})}return n})();let A7=(()=>{class n{constructor(t){this._locale=t}transform(t,i,r){if(!function kR(n){return!(null==n||""===n||n!=n)}(t))return null;r||=this._locale;try{return function $te(n,e,t){return function TR(n,e,t,i,r,s,o=!1){let l="",d=!1;if(isFinite(n)){let u=function Yte(n){let i,r,s,o,l,e=Math.abs(n)+"",t=0;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(r<0&&(r=s),r+=+e.slice(s+1),e=e.substring(0,s)):r<0&&(r=e.length),s=0;"0"===e.charAt(s);s++);if(s===(l=e.length))i=[0],r=1;else{for(l--;"0"===e.charAt(l);)l--;for(r-=s,i=[],o=0;s<=l;s++,o++)i[o]=Number(e.charAt(s))}return r>22&&(i=i.splice(0,21),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}(n);o&&(u=function Xte(n){if(0===n.digits[0])return n;const e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===e?n.digits.push(0,0):1===e&&n.digits.push(0),n.integerLen+=2),n}(u));let f=e.minInt,g=e.minFrac,T=e.maxFrac;if(s){const De=s.match(Vte);if(null===De)throw new Error(`${s} is not a valid digit info`);const Se=De[1],je=De[3],Dt=De[5];null!=Se&&(f=IR(Se)),null!=je&&(g=IR(je)),null!=Dt?T=IR(Dt):null!=je&&g>T&&(T=g)}!function Kte(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let i=n.digits,r=i.length-n.integerLen;const s=Math.min(Math.max(e,r),t);let o=s+n.integerLen,l=i[o];if(o>0){i.splice(Math.max(n.integerLen,o));for(let g=o;g<i.length;g++)i[g]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,o=s+1),i[0]=0;for(let g=1;g<o;g++)i[g]=0}if(l>=5)if(o-1<0){for(let g=0;g>o;g--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[o-1]++;for(;r<Math.max(0,s);r++)i.push(0);let d=0!==s;const u=e+n.integerLen,f=i.reduceRight(function(g,T,B,q){return q[B]=(T+=g)<10?T:T-10,d&&(0===q[B]&&B>=u?q.pop():d=!1),T>=10?1:0},0);f&&(i.unshift(f),n.integerLen++)}(u,g,T);let B=u.digits,q=u.integerLen;const re=u.exponent;let se=[];for(d=B.every(De=>!De);q<f;q++)B.unshift(0);for(;q<0;q++)B.unshift(0);q>0?se=B.splice(q,B.length):(se=B,B=[0]);const ne=[];for(B.length>=e.lgSize&&ne.unshift(B.splice(-e.lgSize,B.length).join(""));B.length>e.gSize;)ne.unshift(B.splice(-e.gSize,B.length).join(""));B.length&&ne.unshift(B.join("")),l=ne.join(oA(t,i)),se.length&&(l+=oA(t,r)+se.join("")),re&&(l+=oA(t,nu.Exponential)+"+"+re)}else l=oA(t,nu.Infinity);return l=n<0&&!d?e.negPre+l+e.negSuf:e.posPre+l+e.posSuf,l}(n,function DR(n,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],s=i[1],o=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],l=o[0],d=o[1]||"";t.posPre=l.substring(0,l.indexOf("#"));for(let f=0;f<d.length;f++){const g=d.charAt(f);"0"===g?t.minFrac=t.maxFrac=f+1:"#"===g?t.maxFrac=f+1:t.posSuf+=g}const u=l.split(",");if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,s){const f=r.length-t.posPre.length-t.posSuf.length,g=s.indexOf("#");t.negPre=s.substring(0,g).replace(/'/g,""),t.negSuf=s.slice(g+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function wR(n,e){return If(n)[yc.NumberFormats][e]}(e,fD.Decimal),oA(e,nu.MinusSign)),e,nu.Group,nu.Decimal,t)}(function FR(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(t),r,i)}catch(s){throw function ag(n,e){return new Zt(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(E0,16))};static#t=this.\u0275pipe=Vc({name:"number",type:n,pure:!0,standalone:!0})}return n})();let DS=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})();const g7="browser";function _7(n){return n===g7}function y7(n){return"server"===n}let Dne=(()=>{class n{static#e=this.\u0275prov=ci({token:n,providedIn:"root",factory:()=>_7(li(om))?new Ine(li(fa),window):new Pne})}return n})();class Ine{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){const t=function Bne(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}}class Pne{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}}class v7{}class oie extends cte{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class LR extends oie{static makeCurrent(){!function lte(n){jU??=n}(new LR)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function aie(){return PS=PS||document.querySelector("base"),PS?PS.getAttribute("href"):null}();return null==t?null:function lie(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){PS=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return o7(document.cookie,e)}}let PS=null,die=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();const NR=new Mi("");let D7=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new Zt(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(pi(NR),pi(Be))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();class I7{constructor(e){this._doc=e}}const UR="ng-app-id";let B7=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=y7(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${UR}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(UR),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(UR,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(M_),pi(Ev,8),pi(om))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();const zR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},HR=/%COMP%/g,pie=new Mi("",{providedIn:"root",factory:()=>!0});function R7(n,e){return e.map(t=>t.replace(HR,n))}let VR=(()=>{class n{constructor(t,i,r,s,o,l,d,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=l,this.ngZone=d,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=y7(l),this.defaultRenderer=new GR(t,o,d,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ed.ShadowDom&&(i={...i,encapsulation:Ed.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof F7?r.applyToHost(t):r instanceof qR&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,l=this.ngZone,d=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case Ed.Emulated:s=new F7(d,u,i,this.appId,f,o,l,g);break;case Ed.ShadowDom:return new _ie(d,u,t,i,o,l,this.nonce,g);default:s=new qR(d,u,i,f,o,l,g)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(pi(D7),pi(B7),pi(M_),pi(pie),pi(fa),pi(om),pi(Be),pi(Ev))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();class GR{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(zR[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(k7(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(k7(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new Zt(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=zR[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=zR[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Ef.DashCase|Ef.Important)?e.style.setProperty(t,i,r&Ef.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ef.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Cy().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function k7(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class _ie extends GR{constructor(e,t,i,r,s,o,l,d){super(e,s,o,d),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=R7(r.id,r.styles);for(const f of u){const g=document.createElement("style");l&&g.setAttribute("nonce",l),g.textContent=f,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class qR extends GR{constructor(e,t,i,r,s,o,l,d){super(e,s,o,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=d?R7(d,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class F7 extends qR{constructor(e,t,i,r,s,o,l,d){const u=r+"-"+i.id;super(e,t,i,s,o,l,d,u),this.contentAttr=function mie(n){return"_ngcontent-%COMP%".replace(HR,n)}(u),this.hostAttr=function Aie(n){return"_nghost-%COMP%".replace(HR,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let yie=(()=>{class n extends I7{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();const O7=["alt","control","meta","shift"],vie={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},bie={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let xie=(()=>{class n extends I7{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cy().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),o="code."),O7.forEach(u=>{const f=i.indexOf(u);f>-1&&(i.splice(f,1),o+=u+".")}),o+=s,0!=i.length||0===s.length)return null;const d={};return d.domEventName=r,d.fullKey=o,d}static matchEventFullKeyCode(t,i){let r=vie[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),O7.forEach(o=>{o!==r&&(0,bie[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();const Sie=uU(Mee,"browser",[{provide:om,useValue:g7},{provide:$x,useValue:function wie(){LR.makeCurrent()},multi:!0},{provide:fa,useFactory:function Mie(){return function cM(n){Sv=n}(document),document},deps:[]}]),Eie=new Mi(""),U7=[{provide:nD,useClass:class cie{addToWindow(e){Wt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Zt(5103,!1);return s},Wt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Wt.getAllAngularRootElements=()=>e.getAllRootElements(),Wt.frameworkStabilizers||(Wt.frameworkStabilizers=[]),Wt.frameworkStabilizers.push(i=>{const r=Wt.getAllAngularTestabilities();let s=r.length;const o=function(){s--,0==s&&i()};r.forEach(l=>{l.whenStable(o)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Cy().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:eU,useClass:oR,deps:[Be,aR,nD]},{provide:oR,useClass:oR,deps:[Be,aR,nD]}],z7=[{provide:af,useValue:"root"},{provide:Cl,useFactory:function Cie(){return new Cl},deps:[]},{provide:NR,useClass:yie,multi:!0,deps:[fa,Be,om]},{provide:NR,useClass:xie,multi:!0,deps:[fa]},VR,B7,D7,{provide:a,useExisting:VR},{provide:v7,useClass:die,deps:[]},[]];let H7=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:M_,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Eie,12))};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[...z7,...U7],imports:[DS,See]})}return n})(),Tie=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Q7(n){return n&&Ke(n.schedule)}function WR(n){return n[n.length-1]}function W7(n){return Ke(WR(n))?n.pop():void 0}function kS(n){return Q7(WR(n))?n.pop():void 0}function My(n){return this instanceof My?(this.v=n,this):new My(n)}function Y7(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function YR(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(l,d){!function r(s,o,l,d){Promise.resolve(d).then(function(u){s({value:u,done:l})},o)}(l,d,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const KR=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function K7(n){return Ke(n?.then)}function Z7(n){return Ke(n[ds])}function J7(n){return Symbol.asyncIterator&&Ke(n?.[Symbol.asyncIterator])}function e9(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const t9=function tre(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function n9(n){return Ke(n?.[t9])}function i9(n){return function X7(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},l("next"),l("throw"),l("return",function o(B){return function(q){return Promise.resolve(q).then(B,g)}}),r[Symbol.asyncIterator]=function(){return this},r;function l(B,q){i[B]&&(r[B]=function(re){return new Promise(function(se,ne){s.push([B,re,se,ne])>1||d(B,re)})},q&&(r[B]=q(r[B])))}function d(B,q){try{!function u(B){B.value instanceof My?Promise.resolve(B.value.v).then(f,g):T(s[0][2],B)}(i[B](q))}catch(re){T(s[0][3],re)}}function f(B){d("next",B)}function g(B){d("throw",B)}function T(B,q){B(q),s.shift(),s.length&&d(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield My(t.read());if(r)return yield My(void 0);yield yield My(i)}}finally{t.releaseLock()}})}function r9(n){return Ke(n?.getReader)}function Qh(n){if(n instanceof me)return n;if(null!=n){if(Z7(n))return function nre(n){return new me(e=>{const t=n[ds]();if(Ke(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(KR(n))return function ire(n){return new me(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(K7(n))return function rre(n){return new me(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ot)})}(n);if(J7(n))return s9(n);if(n9(n))return function sre(n){return new me(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(r9(n))return function ore(n){return s9(i9(n))}(n)}throw e9(n)}function s9(n){return new me(e=>{(function are(n,e){var t,i,r,s;return function j7(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Y7(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function W_(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function o9(n,e=0){return ln((t,i)=>{t.subscribe(Un(i,r=>W_(i,n,()=>i.next(r),e),()=>W_(i,n,()=>i.complete(),e),r=>W_(i,n,()=>i.error(r),e)))})}function a9(n,e=0){return ln((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function l9(n,e){if(!n)throw new Error("Iterable cannot be null");return new me(t=>{W_(t,e,()=>{const i=n[Symbol.asyncIterator]();W_(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function ru(n,e){return e?function fre(n,e){if(null!=n){if(Z7(n))return function lre(n,e){return Qh(n).pipe(a9(e),o9(e))}(n,e);if(KR(n))return function dre(n,e){return new me(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(K7(n))return function cre(n,e){return Qh(n).pipe(a9(e),o9(e))}(n,e);if(J7(n))return l9(n,e);if(n9(n))return function ure(n,e){return new me(t=>{let i;return W_(t,e,()=>{i=n[t9](),W_(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Ke(i?.return)&&i.return()})}(n,e);if(r9(n))return function hre(n,e){return l9(i9(n),e)}(n,e)}throw e9(n)}(n,e):Qh(n)}function io(...n){return ru(n,kS(n))}function Gu(n,e,t=1/0){return Ke(e)?Gu((i,r)=>Rn((s,o)=>e(i,s,r,o))(Qh(n(i,r))),t):("number"==typeof e&&(t=e),ln((i,r)=>function pre(n,e,t,i,r,s,o,l){const d=[];let u=0,f=0,g=!1;const T=()=>{g&&!d.length&&!u&&e.complete()},B=re=>u<i?q(re):d.push(re),q=re=>{s&&e.next(re),u++;let se=!1;Qh(t(re,f++)).subscribe(Un(e,ne=>{r?.(ne),s?B(ne):e.next(ne)},()=>{se=!0},void 0,()=>{if(se)try{for(u--;d.length&&u<i;){const ne=d.shift();o?W_(e,o,()=>q(ne)):q(ne)}T()}catch(ne){e.error(ne)}}))};return n.subscribe(Un(e,B,()=>{g=!0,T()})),()=>{l?.()}}(i,r,n,t)))}function g2(n,e){return Ke(e)?Gu(n,e,1):Gu(n,1)}function jc(n,e){return ln((t,i)=>{let r=0;t.subscribe(Un(i,s=>n.call(e,s,r++)&&i.next(s)))})}function _2(n){return ln((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Rf(n,e){return ln((t,i)=>{let r=null,s=0,o=!1;const l=()=>o&&!r&&i.complete();t.subscribe(Un(i,d=>{r?.unsubscribe();let u=0;const f=s++;Qh(n(d,f)).subscribe(r=Un(i,g=>i.next(e?e(d,g,f,u++):g),()=>{r=null,l()}))},()=>{o=!0,l()}))})}class TD{}class DD{}class lA{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof lA?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new lA;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof lA?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(l=>-1===s.indexOf(l)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class mre{encodeKey(e){return c9(e)}encodeValue(e){return c9(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const gre=/%(\d[a-f0-9])/gi,_re={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function c9(n){return encodeURIComponent(n).replace(gre,(e,t)=>_re[t]??e)}function ID(n){return`${n}`}class Sy{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new mre,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Are(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,l]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],d=t.get(o)||[];d.push(l),t.set(o,d)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(ID):[ID(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Sy({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(ID(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(ID(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class yre{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function d9(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function u9(n){return typeof Blob<"u"&&n instanceof Blob}function h9(n){return typeof FormData<"u"&&n instanceof FormData}class FS{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function vre(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new lA,this.context??=new yre,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const l=t.indexOf("?");this.urlWithParams=t+(-1===l?"?":l<t.length-1?"&":"")+o}}else this.params=new Sy,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||d9(this.body)||u9(this.body)||h9(this.body)||function bre(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof Sy?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||h9(this.body)?null:u9(this.body)?this.body.type||null:d9(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Sy?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=void 0!==e.body?e.body:this.body,l=e.withCredentials??this.withCredentials,d=e.reportProgress??this.reportProgress;let u=e.headers||this.headers,f=e.params||this.params;const g=e.context??this.context;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((T,B)=>T.set(B,e.setHeaders[B]),u)),e.setParams&&(f=Object.keys(e.setParams).reduce((T,B)=>T.set(B,e.setParams[B]),f)),new FS(t,i,o,{params:f,headers:u,context:g,reportProgress:d,responseType:r,withCredentials:l,transferCache:s})}}var Ey=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Ey||{});class ZR{constructor(e,t=OS.Ok,i="OK"){this.headers=e.headers||new lA,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class BD extends ZR{constructor(e={}){super(e),this.type=Ey.ResponseHeader}clone(e={}){return new BD({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class fb extends ZR{constructor(e={}){super(e),this.type=Ey.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new fb({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class y2 extends ZR{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}var OS=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(OS||{});function JR(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let ek=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof FS)s=t;else{let d,u;d=r.headers instanceof lA?r.headers:new lA(r.headers),r.params&&(u=r.params instanceof Sy?r.params:new Sy({fromObject:r.params})),s=new FS(t,i,void 0!==r.body?r.body:null,{headers:d,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=io(s).pipe(g2(d=>this.handler.handle(d)));if(t instanceof FS||"events"===r.observe)return o;const l=o.pipe(jc(d=>d instanceof fb));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(Rn(d=>{if(null!==d.body&&!(d.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return d.body}));case"blob":return l.pipe(Rn(d=>{if(null!==d.body&&!(d.body instanceof Blob))throw new Error("Response is not a Blob.");return d.body}));case"text":return l.pipe(Rn(d=>{if(null!==d.body&&"string"!=typeof d.body)throw new Error("Response is not a string.");return d.body}));default:return l.pipe(Rn(d=>d.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Sy).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,JR(r,i))}post(t,i,r={}){return this.request("POST",t,JR(r,i))}put(t,i,r={}){return this.request("PUT",t,JR(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(pi(TD))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();function p9(n,e){return e(n)}function Sre(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Tre=new Mi(""),LS=new Mi(""),m9=new Mi(""),A9=new Mi("");function Dre(){let n=null;return(e,t)=>{null===n&&(n=(li(Tre,{optional:!0})??[]).reduceRight(Sre,p9));const i=li(vy),r=i.add();return n(e,t).pipe(_2(()=>i.remove(r)))}}let g9=(()=>{class n extends TD{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=li(vy);const r=li(A9,{optional:!0});this.backend=r??t}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(LS),...this.injector.get(m9,[])]));this.chain=r.reduceRight((s,o)=>function Ere(n,e,t){return(i,r)=>hd(t,()=>e(i,s=>n(s,r)))}(s,o,this.injector),p9)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(_2(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(pi(DD),pi(xl))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();const kre=/^\)\]\}',?\n/;let y9=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Zt(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?ru(i.\u0275loadImpl()):io(null)).pipe(Rf(()=>new me(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((re,se)=>o.setRequestHeader(re,se.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const re=t.detectContentTypeHeader();null!==re&&o.setRequestHeader("Content-Type",re)}if(t.responseType){const re=t.responseType.toLowerCase();o.responseType="json"!==re?re:"text"}const l=t.serializeBody();let d=null;const u=()=>{if(null!==d)return d;const re=o.statusText||"OK",se=new lA(o.getAllResponseHeaders()),ne=function Fre(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return d=new BD({headers:se,status:o.status,statusText:re,url:ne}),d},f=()=>{let{headers:re,status:se,statusText:ne,url:De}=u(),Se=null;se!==OS.NoContent&&(Se=typeof o.response>"u"?o.responseText:o.response),0===se&&(se=Se?OS.Ok:0);let je=se>=200&&se<300;if("json"===t.responseType&&"string"==typeof Se){const Dt=Se;Se=Se.replace(kre,"");try{Se=""!==Se?JSON.parse(Se):null}catch(Mt){Se=Dt,je&&(je=!1,Se={error:Mt,text:Se})}}je?(s.next(new fb({body:Se,headers:re,status:se,statusText:ne,url:De||void 0})),s.complete()):s.error(new y2({error:Se,headers:re,status:se,statusText:ne,url:De||void 0}))},g=re=>{const{url:se}=u(),ne=new y2({error:re,status:o.status||0,statusText:o.statusText||"Unknown Error",url:se||void 0});s.error(ne)};let T=!1;const B=re=>{T||(s.next(u()),T=!0);let se={type:Ey.DownloadProgress,loaded:re.loaded};re.lengthComputable&&(se.total=re.total),"text"===t.responseType&&o.responseText&&(se.partialText=o.responseText),s.next(se)},q=re=>{let se={type:Ey.UploadProgress,loaded:re.loaded};re.lengthComputable&&(se.total=re.total),s.next(se)};return o.addEventListener("load",f),o.addEventListener("error",g),o.addEventListener("timeout",g),o.addEventListener("abort",g),t.reportProgress&&(o.addEventListener("progress",B),null!==l&&o.upload&&o.upload.addEventListener("progress",q)),o.send(l),s.next({type:Ey.Sent}),()=>{o.removeEventListener("error",g),o.removeEventListener("abort",g),o.removeEventListener("load",f),o.removeEventListener("timeout",g),t.reportProgress&&(o.removeEventListener("progress",B),null!==l&&o.upload&&o.upload.removeEventListener("progress",q)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(pi(v7))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();const ik=new Mi(""),v9=new Mi("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),b9=new Mi("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class x9{}let Nre=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=o7(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(om),pi(v9))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();function Ure(n,e){const t=n.url.toLowerCase();if(!li(ik)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=li(x9).getToken(),r=li(b9);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Ty=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Ty||{});function zre(...n){const e=[ek,y9,g9,{provide:TD,useExisting:g9},{provide:DD,useExisting:y9},{provide:LS,useValue:Ure,multi:!0},{provide:ik,useValue:!0},{provide:x9,useClass:Nre}];for(const t of n)e.push(...t.\u0275providers);return function Mh(n){return{\u0275providers:n}}(e)}const w9=new Mi("");function Hre(){return function pb(n,e){return{\u0275kind:n,\u0275providers:e}}(Ty.LegacyInterceptors,[{provide:w9,useFactory:Dre},{provide:LS,useExisting:w9,multi:!0}])}let Vre=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[zre(Hre())]})}return n})();const{isArray:$re}=Array,{getPrototypeOf:Xre,prototype:Yre,keys:Kre}=Object;function B9(n){if(1===n.length){const e=n[0];if($re(e))return{args:e,keys:null};if(function Zre(n){return n&&"object"==typeof n&&Xre(n)===Yre}(e)){const t=Kre(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:Jre}=Array;function rk(n){return Rn(e=>function ese(n,e){return Jre(e)?n(...e):n(e)}(n,e))}function P9(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function RD(...n){const e=kS(n),t=W7(n),{args:i,keys:r}=B9(n);if(0===i.length)return ru([],e);const s=new me(function tse(n,e,t=wt){return i=>{R9(e,()=>{const{length:r}=n,s=new Array(r);let o=r,l=r;for(let d=0;d<r;d++)R9(e,()=>{const u=ru(n[d],e);let f=!1;u.subscribe(Un(i,g=>{s[d]=g,f||(f=!0,l--),l||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>P9(r,o):wt));return t?s.pipe(rk(t)):s}function R9(n,e,t){n?W_(t,n,e):e()}const kD=Ze(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function v2(n=1/0){return Gu(wt,n)}function US(...n){return function nse(){return v2(1)}()(ru(n,kS(n)))}function FD(n){return new me(e=>{Qh(n()).subscribe(e)})}function zS(n,e){const t=Ke(n)?n:()=>n,i=r=>r.error(t());return new me(e?r=>e.schedule(i,0,r):i)}const cA=new me(n=>n.complete());function sk(){return ln((n,e)=>{let t=null;n._refCount++;const i=Un(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class ok extends me{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Cn(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new lt;const t=this.getSubject();e.add(this.source.subscribe(Un(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=lt.EMPTY)}return e}refCount(){return sk()(this)}}function sd(n){return n<=0?()=>cA:ln((e,t)=>{let i=0;e.subscribe(Un(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function dA(...n){const e=kS(n);return ln((t,i)=>{(e?US(n,t,e):US(n,t)).subscribe(i)})}function OD(n){return ln((e,t)=>{let i=!1;e.subscribe(Un(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function k9(n=rse){return ln((e,t)=>{let i=!1;e.subscribe(Un(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function rse(){return new kD}function mb(n,e){const t=arguments.length>=2;return i=>i.pipe(n?jc((r,s)=>n(r,s,i)):wt,sd(1),t?OD(e):k9(()=>new kD))}function su(n,e,t){const i=Ke(n)||e||t?{next:n,error:e,complete:t}:n;return i?ln((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let l=!0;r.subscribe(Un(s,d=>{var u;null===(u=i.next)||void 0===u||u.call(i,d),s.next(d)},()=>{var d;l=!1,null===(d=i.complete)||void 0===d||d.call(i),s.complete()},d=>{var u;l=!1,null===(u=i.error)||void 0===u||u.call(i,d),s.error(d)},()=>{var d,u;l&&(null===(d=i.unsubscribe)||void 0===d||d.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):wt}function Ab(n){return ln((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Un(t,void 0,void 0,o=>{s=Qh(n(o,Ab(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function ak(n){return n<=0?()=>cA:ln((e,t)=>{let i=[];e.subscribe(Un(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function F9(n){return Rn(()=>n)}function jl(n){return ln((e,t)=>{Qh(n).subscribe(Un(t,()=>t.complete(),It)),!t.closed&&e.subscribe(t)})}const Ia="primary",HS=Symbol("RouteTitle");class lse{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function b2(n){return new lse(n)}function cse(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],l=n[s];if(o.startsWith(":"))r[o.substring(1)]=l;else if(o!==l.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function T0(n,e){const t=n?lk(n):void 0,i=e?lk(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!O9(n[r],e[r]))return!1;return!0}function lk(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function O9(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function L9(n){return n.length>0?n[n.length-1]:null}function Dy(n){return function NS(n){return!!n&&(n instanceof me||Ke(n.lift)&&Ke(n.subscribe))}(n)?n:MS(n)?ru(Promise.resolve(n)):io(n)}const use={exact:function z9(n,e,t){if(!gb(n.segments,e.segments)||!LD(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!z9(n.children[i],e.children[i],t))return!1;return!0},subset:H9},N9={exact:function hse(n,e){return T0(n,e)},subset:function fse(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>O9(n[t],e[t]))},ignored:()=>!0};function U9(n,e,t){return use[t.paths](n.root,e.root,t.matrixParams)&&N9[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function H9(n,e,t){return V9(n,e,e.segments,t)}function V9(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!gb(r,t)||e.hasChildren()||!LD(r,t,i))}if(n.segments.length===t.length){if(!gb(n.segments,t)||!LD(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!H9(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(gb(n.segments,r)&&LD(n.segments,r,i)&&n.children[Ia])&&V9(n.children[Ia],e,s,i)}}function LD(n,e,t){return e.every((i,r)=>N9[t](n[r].parameters,i.parameters))}class x2{constructor(e=new tc([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=b2(this.queryParams),this._queryParamMap}toString(){return Ase.serialize(this)}}class tc{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ND(this)}}class VS{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=b2(this.parameters),this._parameterMap}toString(){return Q9(this)}}function gb(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let w2=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>new ck,providedIn:"root"})}return n})();class ck{parse(e){const t=new Ese(e);return new x2(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${GS(e.root,!0)}`,i=function yse(n){const e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${UD(t)}=${UD(r)}`).join("&"):`${UD(t)}=${UD(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function gse(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Ase=new ck;function ND(n){return n.segments.map(e=>Q9(e)).join("/")}function GS(n,e){if(!n.hasChildren())return ND(n);if(e){const t=n.children[Ia]?GS(n.children[Ia],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Ia&&i.push(`${r}:${GS(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function mse(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ia&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ia&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Ia?[GS(n.children[Ia],!1)]:[`${r}:${GS(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ia]?`${ND(n)}/${t[0]}`:`${ND(n)}/(${t.join("//")})`}}function G9(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function UD(n){return G9(n).replace(/%3B/gi,";")}function dk(n){return G9(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zD(n){return decodeURIComponent(n)}function q9(n){return zD(n.replace(/\+/g,"%20"))}function Q9(n){return`${dk(n.path)}${function _se(n){return Object.entries(n).map(([e,t])=>`;${dk(e)}=${dk(t)}`).join("")}(n.parameters)}`}const vse=/^[^\/()?;#]+/;function uk(n){const e=n.match(vse);return e?e[0]:""}const bse=/^[^\/()?;=#]+/,wse=/^[^=?&#]+/,Mse=/^[^&#]+/;class Ese{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tc([],{}):new tc([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ia]=new tc(e,t)),i}parseSegment(){const e=uk(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Zt(4009,!1);return this.capture(e),new VS(zD(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function xse(n){const e=n.match(bse);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=uk(this.remaining);r&&(i=r,this.capture(i))}e[zD(t)]=zD(i)}parseQueryParam(e){const t=function Cse(n){const e=n.match(wse);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function Sse(n){const e=n.match(Mse);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=q9(t),s=q9(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=uk(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Zt(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ia);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Ia]:new tc([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Zt(4011,!1)}}function W9(n){return n.segments.length>0?new tc([],{[Ia]:n}):n}function j9(n){const e={};for(const[i,r]of Object.entries(n.children)){const s=j9(r);if(i===Ia&&0===s.segments.length&&s.hasChildren())for(const[o,l]of Object.entries(s.children))e[o]=l;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Tse(n){if(1===n.numberOfChildren&&n.children[Ia]){const e=n.children[Ia];return new tc(n.segments.concat(e.segments),e.children)}return n}(new tc(n.segments,e))}function C2(n){return n instanceof x2}function $9(n){let e;const r=W9(function t(s){const o={};for(const d of s.children){const u=t(d);o[d.outlet]=u}const l=new tc(s.url,o);return s===n&&(e=l),l}(n.root));return e??r}function X9(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return hk(r,r,r,t,i);const s=function Ise(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new K9(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const l={};return Object.entries(s.outlets).forEach(([d,u])=>{l[d]="string"==typeof u?u.split("/"):u}),[...r,{outlets:l}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((l,d)=>{0==d&&"."===l||(0==d&&""===l?t=!0:".."===l?e++:""!=l&&r.push(l))}),r):[...r,s]},[]);return new K9(t,e,i)}(e);if(s.toRoot())return hk(r,r,new tc([],{}),t,i);const o=function Bse(n,e,t){if(n.isAbsolute)return new VD(e,!0,0);if(!t)return new VD(e,!1,NaN);if(null===t.parent)return new VD(t,!0,0);const i=HD(n.commands[0])?0:1;return function Pse(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Zt(4005,!1);r=i.segments.length}return new VD(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),l=o.processChildren?QS(o.segmentGroup,o.index,s.commands):Z9(o.segmentGroup,o.index,s.commands);return hk(r,o.segmentGroup,l,t,i)}function HD(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function qS(n){return"object"==typeof n&&null!=n&&n.outlets}function hk(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([d,u])=>{s[d]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`}),o=n===e?t:Y9(n,e,t);const l=W9(j9(o));return new x2(l,s,r)}function Y9(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:Y9(s,e,t)}),new tc(n.segments,i)}class K9{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&HD(i[0]))throw new Zt(4003,!1);const r=i.find(qS);if(r&&r!==L9(i))throw new Zt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class VD{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function Z9(n,e,t){if(n??=new tc([],{}),0===n.segments.length&&n.hasChildren())return QS(n,e,t);const i=function kse(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],l=t[i];if(qS(l))break;const d=`${l}`,u=i<t.length-1?t[i+1]:null;if(r>0&&void 0===d)break;if(d&&u&&"object"==typeof u&&void 0===u.outlets){if(!ez(d,u,o))return s;i+=2}else{if(!ez(d,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new tc(n.segments.slice(0,i.pathIndex),{});return s.children[Ia]=new tc(n.segments.slice(i.pathIndex),n.children),QS(s,0,r)}return i.match&&0===r.length?new tc(n.segments,{}):i.match&&!n.hasChildren()?fk(n,e,t):i.match?QS(n,0,r):fk(n,e,t)}function QS(n,e,t){if(0===t.length)return new tc(n.segments,{});{const i=function Rse(n){return qS(n[0])?n[0].outlets:{[Ia]:n}}(t),r={};if(Object.keys(i).some(s=>s!==Ia)&&n.children[Ia]&&1===n.numberOfChildren&&0===n.children[Ia].segments.length){const s=QS(n.children[Ia],e,t);return new tc(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=Z9(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new tc(n.segments,r)}}function fk(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(qS(s)){const d=Fse(s.outlets);return new tc(i,d)}if(0===r&&HD(t[0])){i.push(new VS(n.segments[e].path,J9(t[0]))),r++;continue}const o=qS(s)?s.outlets[Ia]:`${s}`,l=r<t.length-1?t[r+1]:null;o&&l&&HD(l)?(i.push(new VS(o,J9(l))),r+=2):(i.push(new VS(o,{})),r++)}return new tc(i,{})}function Fse(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=fk(new tc([],{}),0,i))}),e}function J9(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function ez(n,e,t){return n==t.path&&T0(e,t.parameters)}const WS="imperative";var dl=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(dl||{});class D0{constructor(e,t){this.id=e,this.url=t}}class GD extends D0{constructor(e,t,i="imperative",r=null){super(e,t),this.type=dl.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class j_ extends D0{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=dl.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var hm=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(hm||{}),qD=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(qD||{});class M2 extends D0{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=dl.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class S2 extends D0{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=dl.NavigationSkipped}}class QD extends D0{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=dl.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class tz extends D0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=dl.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ose extends D0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=dl.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lse extends D0{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=dl.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Nse extends D0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=dl.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Use extends D0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=dl.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zse{constructor(e){this.route=e,this.type=dl.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Hse{constructor(e){this.route=e,this.type=dl.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Vse{constructor(e){this.snapshot=e,this.type=dl.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Gse{constructor(e){this.snapshot=e,this.type=dl.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qse{constructor(e){this.snapshot=e,this.type=dl.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qse{constructor(e){this.snapshot=e,this.type=dl.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nz{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=dl.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class pk{}class mk{constructor(e){this.url=e}}class Wse{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new jS,this.attachRef=null}}let jS=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Wse,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class iz{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Ak(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Ak(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=gk(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return gk(e,this._root).map(t=>t.value)}}function Ak(n,e){if(n===e.value)return e;for(const t of e.children){const i=Ak(n,t);if(i)return i}return null}function gk(n,e){if(n===e.value)return[e];for(const t of e.children){const i=gk(n,t);if(i.length)return i.unshift(e),i}return[]}class lg{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function E2(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class rz extends iz{constructor(e,t){super(e),this.snapshot=t,vk(this,e)}toString(){return this.snapshot.toString()}}function sz(n){const e=function jse(n){const s=new yk([],{},{},"",{},Ia,n,null,{});return new oz("",new lg(s,[]))}(n),t=new jt([new VS("",{})]),i=new jt({}),r=new jt({}),s=new jt({}),o=new jt(""),l=new T2(t,i,s,o,r,Ia,n,e.root);return l.snapshot=e.root,new rz(new lg(l,[]),e)}class T2{constructor(e,t,i,r,s,o,l,d){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=l,this._futureSnapshot=d,this.title=this.dataSubject?.pipe(Rn(u=>u[HS]))??io(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Rn(e=>b2(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Rn(e=>b2(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function _k(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...n.params},data:{...n.data},resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&lz(r)&&(i.resolve[HS]=r.title),i}class yk{get title(){return this.data?.[HS]}constructor(e,t,i,r,s,o,l,d,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=l,this.routeConfig=d,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=b2(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=b2(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class oz extends iz{constructor(e,t){super(t),this.url=e,vk(this,t)}toString(){return az(this._root)}}function vk(n,e){e.value._routerState=n,e.children.forEach(t=>vk(n,t))}function az(n){const e=n.children.length>0?` { ${n.children.map(az).join(", ")} } `:"";return`${n.value}${e}`}function bk(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,T0(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),T0(e.params,t.params)||n.paramsSubject.next(t.params),function dse(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!T0(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),T0(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function xk(n,e){const t=T0(n.params,e.params)&&function pse(n,e){return gb(n,e)&&n.every((t,i)=>T0(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||xk(n.parent,e.parent))}function lz(n){return"string"==typeof n.title||null===n.title}let WD=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ia,this.activateEvents=new xs,this.deactivateEvents=new xs,this.attachEvents=new xs,this.detachEvents=new xs,this.parentContexts=li(jS),this.location=li(_n),this.changeDetector=li(vc),this.environmentInjector=li(xl),this.inputBinder=li(jD,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Zt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Zt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Zt(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Zt(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,d=new wk(t,l,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:d,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Sr({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Pl]})}return n})();class wk{__ngOutletInjector(e){return new wk(this.route,this.childContexts,e)}constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===T2?this.route:e===jS?this.childContexts:this.parent.get(e,t)}}const jD=new Mi("");let cz=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=RD([i.queryParams,i.params,i.data]).pipe(Rf(([s,o,l],d)=>(l={...s,...o,...l},0===d?io(l):Promise.resolve(l)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function ate(n){const e=Ys(n);if(!e)return null;const t=new Nn(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:l}of o.inputs)t.activatedComponentRef.setInput(l,s[l]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();function $S(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function Xse(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return $S(n,i,r);return $S(n,i)})}(n,e,t);return new lg(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(l=>$S(n,l)),o}}const i=function Yse(n){return new T2(new jt(n.url),new jt(n.params),new jt(n.queryParams),new jt(n.fragment),new jt(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>$S(n,s));return new lg(i,r)}}const dz="ngNavigationCancelingError";function uz(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=C2(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=hz(!1,hm.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function hz(n,e){const t=new Error(`NavigationCancelingError: ${n||""}`);return t[dz]=!0,t.cancellationCode=e,t}function fz(n){return!!n&&n[dz]}let pz=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Qr({type:n,selectors:[["ng-component"]],standalone:!0,features:[rd],decls:1,vars:0,template:function(i,r){1&i&&Er(0,"router-outlet")},dependencies:[WD],encapsulation:2})}return n})();function Ck(n){const e=n.children&&n.children.map(Ck),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ia&&(t.component=pz),t}function I0(n){return n.outlet||Ia}function XS(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class roe{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),bk(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=E2(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=E2(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){const o=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:l})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=E2(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=E2(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Qse(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Gse(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(bk(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const l=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(l.contexts),o.attachRef=l.componentRef,o.route=l.route.value,o.outlet&&o.outlet.attach(l.componentRef,l.route.value),bk(l.route.value),this.activateChildRoutes(e,null,o.children)}else{const l=XS(r.snapshot);o.attachRef=null,o.route=r,o.injector=l,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class mz{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class $D{constructor(e,t){this.component=e,this.route=t}}function soe(n,e,t){const i=n._root;return YS(i,e?e._root:null,t,[i.value])}function D2(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function Md(n){return null!==Sa(n)}(n)?e.get(n):n:i}function YS(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=E2(e);return n.children.forEach(o=>{(function aoe(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,l=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const d=function loe(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!gb(n.url,e.url);case"pathParamsOrQueryParamsChange":return!gb(n.url,e.url)||!T0(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xk(n,e)||!T0(n.queryParams,e.queryParams);default:return!xk(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);d?r.canActivateChecks.push(new mz(i)):(s.data=o.data,s._resolvedData=o._resolvedData),YS(n,e,s.component?l?l.children:null:t,i,r),d&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new $D(l.outlet.component,o))}else o&&KS(e,l,r),r.canActivateChecks.push(new mz(i)),YS(n,null,s.component?l?l.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,l])=>KS(l,t.getContext(o),r)),r}function KS(n,e,t){const i=E2(n),r=n.value;Object.entries(i).forEach(([s,o])=>{KS(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new $D(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function ZS(n){return"function"==typeof n}function Az(n){return n instanceof kD||"EmptyError"===n?.name}const XD=Symbol("INITIAL_VALUE");function I2(){return Rf(n=>RD(n.map(e=>e.pipe(sd(1),dA(XD)))).pipe(Rn(e=>{for(const t of e)if(!0!==t){if(t===XD)return XD;if(!1===t||t instanceof x2)return t}return!0}),jc(e=>e!==XD),sd(1)))}function gz(n){return function W(...n){return pe(n)}(su(e=>{if(C2(e))throw uz(0,e)}),Rn(e=>!0===e))}class Mk{constructor(e){this.segmentGroup=e||null}}class Sk extends Error{constructor(e){super(),this.urlTree=e}}function B2(n){return zS(new Mk(n))}class Eoe{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return io(i);if(r.numberOfChildren>1||!r.children[Ia])return zS(new Zt(4e3,!1));r=r.children[Ia]}}applyRedirectCommands(e,t,i){const r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new Sk(r);return r}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new x2(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const l=s.substring(1);i[r]=t[l]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([l,d])=>{o[l]=this.createSegmentGroup(e,d,i,r)}),new tc(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Zt(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const Ek={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Toe(n,e,t,i,r){const s=Tk(n,e,t);return s.matched?(i=function Zse(n,e){return n.providers&&!n._injector&&(n._injector=F3(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function Coe(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?io(r.map(o=>{const l=D2(o,n);return Dy(function poe(n){return n&&ZS(n.canMatch)}(l)?l.canMatch(e,t):hd(n,()=>l(e,t)))})).pipe(I2(),gz()):io(!0)}(i,e,t).pipe(Rn(o=>!0===o?s:{...Ek}))):io(s)}function Tk(n,e,t){if("**"===e.path)return function Doe(n){return{matched:!0,parameters:n.length>0?L9(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Ek}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||cse)(t,n,e);if(!r)return{...Ek};const s={};Object.entries(r.posParams??{}).forEach(([l,d])=>{s[l]=d.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function _z(n,e,t,i){return t.length>0&&function Poe(n,e,t){return t.some(i=>YD(n,e,i)&&I0(i)!==Ia)}(n,t,i)?{segmentGroup:new tc(e,Boe(i,new tc(t,n.children))),slicedSegments:[]}:0===t.length&&function Roe(n,e,t){return t.some(i=>YD(n,e,i))}(n,t,i)?{segmentGroup:new tc(n.segments,Ioe(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new tc(n.segments,n.children),slicedSegments:t}}function Ioe(n,e,t,i){const r={};for(const s of t)if(YD(n,e,s)&&!i[I0(s)]){const o=new tc([],{});r[I0(s)]=o}return{...i,...r}}function Boe(n,e){const t={};t[Ia]=e;for(const i of n)if(""===i.path&&I0(i)!==Ia){const r=new tc([],{});t[I0(i)]=r}return t}function YD(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Ooe{}class Uoe{constructor(e,t,i,r,s,o,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=l,this.applyRedirects=new Eoe(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Zt(4002,`'${e.segmentGroup}'`)}recognize(){const e=_z(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Rn(t=>{const i=new yk([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ia,this.rootComponentType,null,{}),r=new lg(i,t),s=new oz("",r),o=function Dse(n,e,t=null,i=null){return X9($9(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Ia).pipe(Ab(i=>{if(i instanceof Sk)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Mk?this.noMatchError(i):i}))}inheritParamsAndData(e,t){const i=e.value,r=_k(i,t,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0).pipe(Rn(s=>s instanceof lg?[s]:[]))}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return ru(r).pipe(g2(s=>{const o=i.children[s],l=function noe(n,e){const t=n.filter(i=>I0(i)===e);return t.push(...n.filter(i=>I0(i)!==e)),t}(t,s);return this.processSegmentGroup(e,l,o,s)}),function ose(n,e){return ln(function sse(n,e,t,i,r){return(s,o)=>{let l=t,d=e,u=0;s.subscribe(Un(o,f=>{const g=u++;d=l?n(d,f,g):(l=!0,f),i&&o.next(d)},r&&(()=>{l&&o.next(d),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),OD(null),function ase(n,e){const t=arguments.length>=2;return i=>i.pipe(n?jc((r,s)=>n(r,s,i)):wt,ak(1),t?OD(e):k9(()=>new kD))}(),Gu(s=>{if(null===s)return B2(i);const o=yz(s);return function zoe(n){n.sort((e,t)=>e.value.outlet===Ia?-1:t.value.outlet===Ia?1:e.value.outlet.localeCompare(t.value.outlet))}(o),io(o)}))}processSegment(e,t,i,r,s,o){return ru(t).pipe(g2(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,s,o).pipe(Ab(d=>{if(d instanceof Mk)return io(null);throw d}))),mb(l=>!!l),Ab(l=>{if(Az(l))return function Foe(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?io(new Ooe):B2(i);throw l}))}processSegmentAgainstRoute(e,t,i,r,s,o,l){return function koe(n,e,t,i){return!!(I0(n)===i||i!==Ia&&YD(e,t,n))&&Tk(e,n,t).matched}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):B2(r):B2(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:l,consumedSegments:d,positionalParamSegments:u,remainingSegments:f}=Tk(t,r,s);if(!l)return B2(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const g=this.applyRedirects.applyRedirectCommands(d,r.redirectTo,u);return this.applyRedirects.lineralizeSegments(r,g).pipe(Gu(T=>this.processSegment(e,i,t,T.concat(f),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){const o=Toe(t,i,r,e);return"**"===i.path&&(t.children={}),o.pipe(Rf(l=>l.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(Rf(({routes:d})=>{const u=i._loadedInjector??e,{consumedSegments:f,remainingSegments:g,parameters:T}=l,B=new yk(f,T,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function Voe(n){return n.data||{}}(i),I0(i),i.component??i._loadedComponent??null,i,function Goe(n){return n.resolve||{}}(i)),{segmentGroup:q,slicedSegments:re}=_z(t,f,g,d);if(0===re.length&&q.hasChildren())return this.processChildren(u,d,q).pipe(Rn(ne=>null===ne?null:new lg(B,ne)));if(0===d.length&&0===re.length)return io(new lg(B,[]));const se=I0(i)===s;return this.processSegment(u,d,q,re,se?Ia:s,!0).pipe(Rn(ne=>new lg(B,ne instanceof lg?[ne]:[])))})):B2(t)))}getChildConfig(e,t,i){return t.children?io({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?io({routes:t._loadedRoutes,injector:t._loadedInjector}):function woe(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?io(!0):io(r.map(o=>{const l=D2(o,n);return Dy(function doe(n){return n&&ZS(n.canLoad)}(l)?l.canLoad(e,t):hd(n,()=>l(e,t)))})).pipe(I2(),gz())}(e,t,i).pipe(Gu(r=>r?this.configLoader.loadChildren(e,t).pipe(su(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Soe(n){return zS(hz(!1,hm.GuardRejected))}())):io({routes:[],injector:e})}}function Hoe(n){const e=n.value.routeConfig;return e&&""===e.path}function yz(n){const e=[],t=new Set;for(const i of n){if(!Hoe(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=yz(i.children);e.push(new lg(i.value,r))}return e.filter(i=>!t.has(i))}function vz(n){const e=n.children.map(t=>vz(t)).flat();return[n,...e]}function Dk(n){return Rf(e=>{const t=n(e);return t?ru(t).pipe(Rn(()=>e)):io(e)})}let bz=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Ia);return i}getResolvedTitleForRoute(t){return t.data[HS]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>li(Xoe),providedIn:"root"})}return n})(),Xoe=(()=>{class n extends bz{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Tie))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const P2=new Mi("",{providedIn:"root",factory:()=>({})}),R2=new Mi("");let Ik=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=li(sU)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return io(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Dy(t.loadComponent()).pipe(Rn(xz),su(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),_2(()=>{this.componentLoaders.delete(t)})),r=new ok(i,()=>new xt).pipe(sk());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return io({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function Yoe(n,e,t,i){return Dy(n.loadChildren()).pipe(Rn(xz),Gu(r=>r instanceof xN||Array.isArray(r)?io(r):ru(e.compileModuleAsync(r))),Rn(r=>{i&&i(n);let s,o,l=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(R2,[],{optional:!0,self:!0}).flat()),{routes:o.map(Ck),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(_2(()=>{this.childrenLoaders.delete(i)})),o=new ok(s,()=>new xt).pipe(sk());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xz(n){return function Koe(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Bk=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>li(Zoe),providedIn:"root"})}return n})(),Zoe=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const wz=new Mi(""),Cz=new Mi("");function Joe(n,e,t){const i=n.get(Cz),r=n.get(fa);return n.get(Be).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s;const o=new Promise(u=>{s=u}),l=r.startViewTransition(()=>(s(),function eae(n){return new Promise(e=>{In(e,{injector:n})})}(n))),{onViewTransitionCreated:d}=i;return d&&hd(n,()=>d({transition:l,from:e,to:t})),o})}let KD=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xt,this.transitionAbortSubject=new xt,this.configLoader=li(Ik),this.environmentInjector=li(xl),this.urlSerializer=li(w2),this.rootContexts=li(jS),this.location=li(hb),this.inputBindingEnabled=null!==li(jD,{optional:!0}),this.titleStrategy=li(bz),this.options=li(P2,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=li(Bk),this.createViewTransition=li(wz,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>io(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Hse(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new zse(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new jt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:WS,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(jc(s=>0!==s.id),Rn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Rf(s=>{let o=!1,l=!1;return io(s).pipe(Rf(d=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",hm.SupersededByNewNavigation),cA;this.currentTransition=s,this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!u&&"reload"!==(d.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const g="";return this.events.next(new S2(d.id,this.urlSerializer.serialize(d.rawUrl),g,qD.IgnoredSameUrlNavigation)),d.resolve(null),cA}if(this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return io(d).pipe(Rf(g=>{const T=this.transitions?.getValue();return this.events.next(new GD(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),T!==this.transitions?.getValue()?cA:Promise.resolve(g)}),function qoe(n,e,t,i,r,s){return Gu(o=>function Loe(n,e,t,i,r,s,o="emptyOnly"){return new Uoe(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Rn(({state:l,tree:d})=>({...o,targetSnapshot:l,urlAfterRedirects:d}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),su(g=>{s.targetSnapshot=g.targetSnapshot,s.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:g.urlAfterRedirects};const T=new tz(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(T)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(d.currentRawUrl)){const{id:g,extractedUrl:T,source:B,restoredState:q,extras:re}=d,se=new GD(g,this.urlSerializer.serialize(T),B,q);this.events.next(se);const ne=sz(this.rootComponentType).snapshot;return this.currentTransition=s={...d,targetSnapshot:ne,urlAfterRedirects:T,extras:{...re,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=T,io(s)}{const g="";return this.events.next(new S2(d.id,this.urlSerializer.serialize(d.extractedUrl),g,qD.IgnoredByUrlHandlingStrategy)),d.resolve(null),cA}}),su(d=>{const u=new Ose(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(u)}),Rn(d=>(this.currentTransition=s={...d,guards:soe(d.targetSnapshot,d.currentSnapshot,this.rootContexts)},s)),function moe(n,e){return Gu(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?io({...t,guardsResult:!0}):function Aoe(n,e,t,i){return ru(n).pipe(Gu(r=>function xoe(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?io(s.map(l=>{const d=XS(e)??r,u=D2(l,d);return Dy(function foe(n){return n&&ZS(n.canDeactivate)}(u)?u.canDeactivate(n,e,t,i):hd(d,()=>u(n,e,t,i))).pipe(mb())})).pipe(I2()):io(!0)}(r.component,r.route,t,e,i)),mb(r=>!0!==r,!0))}(o,i,r,n).pipe(Gu(l=>l&&function coe(n){return"boolean"==typeof n}(l)?function goe(n,e,t,i){return ru(e).pipe(g2(r=>US(function yoe(n,e){return null!==n&&e&&e(new Vse(n)),io(!0)}(r.route.parent,i),function _oe(n,e){return null!==n&&e&&e(new qse(n)),io(!0)}(r.route,i),function boe(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function ooe(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>FD(()=>io(o.guards.map(d=>{const u=XS(o.node)??t,f=D2(d,u);return Dy(function hoe(n){return n&&ZS(n.canActivateChild)}(f)?f.canActivateChild(i,n):hd(u,()=>f(i,n))).pipe(mb())})).pipe(I2())));return io(s).pipe(I2())}(n,r.path,t),function voe(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return io(!0);const r=i.map(s=>FD(()=>{const o=XS(e)??t,l=D2(s,o);return Dy(function uoe(n){return n&&ZS(n.canActivate)}(l)?l.canActivate(e,n):hd(o,()=>l(e,n))).pipe(mb())}));return io(r).pipe(I2())}(n,r.route,t))),mb(r=>!0!==r,!0))}(i,s,n,e):io(l)),Rn(l=>({...t,guardsResult:l})))})}(this.environmentInjector,d=>this.events.next(d)),su(d=>{if(s.guardsResult=d.guardsResult,C2(d.guardsResult))throw uz(0,d.guardsResult);const u=new Lse(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.events.next(u)}),jc(d=>!!d.guardsResult||(this.cancelNavigationTransition(d,"",hm.GuardRejected),!1)),Dk(d=>{if(d.guards.canActivateChecks.length)return io(d).pipe(su(u=>{const f=new Nse(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),Rf(u=>{let f=!1;return io(u).pipe(function Qoe(n,e){return Gu(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return io(t);const s=new Set(r.map(d=>d.route)),o=new Set;for(const d of s)if(!o.has(d))for(const u of vz(d))o.add(u);let l=0;return ru(o).pipe(g2(d=>s.has(d)?function Woe(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!lz(r)&&(s[HS]=r.title),function joe(n,e,t,i){const r=lk(n);if(0===r.length)return io({});const s={};return ru(r).pipe(Gu(o=>function $oe(n,e,t,i){const r=XS(e)??i,s=D2(n,r);return Dy(s.resolve?s.resolve(e,t):hd(r,()=>s(e,t)))}(n[o],e,t,i).pipe(mb(),su(l=>{s[o]=l}))),ak(1),F9(s),Ab(o=>Az(o)?cA:zS(o)))}(s,n,e,i).pipe(Rn(o=>(n._resolvedData=o,n.data=_k(n,n.parent,t).resolve,null)))}(d,i,n,e):(d.data=_k(d,d.parent,n).resolve,io(void 0))),su(()=>l++),ak(1),Gu(d=>l===o.size?io(t):cA))})}(this.paramsInheritanceStrategy,this.environmentInjector),su({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(u,"",hm.NoDataFromResolver)}}))}),su(u=>{const f=new Use(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}))}),Dk(d=>{const u=f=>{const g=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(f.routeConfig).pipe(su(T=>{f.component=T}),Rn(()=>{})));for(const T of f.children)g.push(...u(T));return g};return RD(u(d.targetSnapshot.root)).pipe(OD(null),sd(1))}),Dk(()=>this.afterPreactivation()),Rf(()=>{const{currentSnapshot:d,targetSnapshot:u}=s,f=this.createViewTransition?.(this.environmentInjector,d.root,u.root);return f?ru(f).pipe(Rn(()=>s)):io(s)}),Rn(d=>{const u=function $se(n,e,t){const i=$S(n,e._root,t?t._root:void 0);return new rz(i,e)}(t.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return this.currentTransition=s={...d,targetRouterState:u},this.currentNavigation.targetRouterState=u,s}),su(()=>{this.events.next(new pk)}),((n,e,t,i)=>Rn(r=>(new roe(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,d=>this.events.next(d),this.inputBindingEnabled),sd(1),su({next:d=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new j_(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects))),this.titleStrategy?.updateTitle(d.targetRouterState.snapshot),d.resolve(!0)},complete:()=>{o=!0}}),jl(this.transitionAbortSubject.pipe(su(d=>{throw d}))),_2(()=>{!o&&!l&&this.cancelNavigationTransition(s,"",hm.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ab(d=>{if(l=!0,fz(d))this.events.next(new M2(s.id,this.urlSerializer.serialize(s.extractedUrl),d.message,d.cancellationCode)),function Kse(n){return fz(n)&&C2(n.url)}(d)?this.events.next(new mk(d.url)):s.resolve(!1);else{this.events.next(new QD(s.id,this.urlSerializer.serialize(s.extractedUrl),d,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(d))}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return cA}))}))}cancelNavigationTransition(t,i,r){const s=new M2(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tae(n){return n!==WS}let nae=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>li(rae),providedIn:"root"})}return n})();class iae{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let rae=(()=>{class n extends iae{static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Mz=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:()=>li(sae),providedIn:"root"})}return n})(),sae=(()=>{class n extends Mz{constructor(){super(...arguments),this.location=li(hb),this.urlSerializer=li(w2),this.options=li(P2,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=li(Bk),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new x2,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=sz(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof GD)this.stateMemento=this.createStateMemento();else if(t instanceof S2)this.rawUrlTree=i.initialUrl;else if(t instanceof tz){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(r,i)}}else t instanceof pk?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):t instanceof M2&&(t.code===hm.GuardRejected||t.code===hm.NoDataFromResolver)?this.restoreHistory(i):t instanceof QD?this.restoreHistory(i,!0):t instanceof j_&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&0===s&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var JS=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(JS||{});function Sz(n,e){n.events.pipe(jc(t=>t instanceof j_||t instanceof M2||t instanceof QD||t instanceof S2),Rn(t=>t instanceof j_||t instanceof S2?JS.COMPLETE:t instanceof M2&&(t.code===hm.Redirect||t.code===hm.SupersededByNewNavigation)?JS.REDIRECTING:JS.FAILED),jc(t=>t!==JS.REDIRECTING),sd(1)).subscribe(()=>{e()})}function oae(n){throw n}const aae={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lae={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let cg=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=li(X8),this.stateManager=li(Mz),this.options=li(P2,{optional:!0})||{},this.pendingTasks=li(vy),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=li(KD),this.urlSerializer=li(w2),this.location=li(hb),this.urlHandlingStrategy=li(Bk),this._events=new xt,this.errorHandler=this.options.errorHandler||oae,this.navigated=!1,this.routeReuseStrategy=li(nae),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=li(R2,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!li(jD,{optional:!0}),this.eventsSubscription=new lt,this.isNgZoneEnabled=li(Be)instanceof Be&&Be.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==r&&null!==s)if(this.stateManager.handleRouterEvent(i,s),i instanceof M2&&i.code!==hm.Redirect&&i.code!==hm.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof j_)this.navigated=!0;else if(i instanceof mk){const o=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l={info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||tae(r.source)};this.scheduleNavigation(o,WS,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function dae(n){return!(n instanceof pk||n instanceof mk)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),WS,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const d={...r};delete d.navigationId,delete d.\u0275routerPageId,0!==Object.keys(d).length&&(s.state=d)}const l=this.parseUrl(t);this.scheduleNavigation(l,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Ck),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:l,preserveFragment:d}=i,u=d?this.currentUrlTree.fragment:o;let g,f=null;switch(l){case"merge":f={...this.currentUrlTree.queryParams,...s};break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}null!==f&&(f=this.removeEmptyProps(f));try{g=$9(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),g=this.currentUrlTree.root}return X9(g,t,f,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=C2(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,WS,null,i)}navigate(t,i={skipLocationChange:!1}){return function cae(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new Zt(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{...aae}:!1===i?{...lae}:i,C2(t))return U9(this.currentUrlTree,t,r);const s=this.parseUrl(t);return U9(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(null!=s&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let l,d,u;o?(l=o.resolve,d=o.reject,u=o.promise):u=new Promise((g,T)=>{l=g,d=T});const f=this.pendingTasks.add();return Sz(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:l,reject:d,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(g=>Promise.reject(g))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),eE=(()=>{class n{constructor(t,i,r,s,o,l){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=l,this.href=null,this.commands=null,this.onChanges=new xt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const d=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===d||"area"===d,this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof j_&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,o){const l=this.urlTree;return!!(null===l||this.isAnchorElement&&(0!==t||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(l,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const t=this.urlTree;this.href=null!==t&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;const i=null===this.href?null:function vM(n,e,t){return function PT(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?_M:ry}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(cg),Vt(T2),_u("tabindex"),Vt(c),Vt(Ws),Vt(ub))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&gi("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&i&&ol("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[mi.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ho],skipLocationChange:[mi.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ho],replaceUrl:[mi.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ho],routerLink:"routerLink"},standalone:!0,features:[Wl,Pl]})}return n})(),Ez=(()=>{class n{get isActive(){return this._isActive}constructor(t,i,r,s,o){this.router=t,this.element=i,this.renderer=r,this.cdr=s,this.link=o,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new xs,this.routerEventsSubscription=t.events.subscribe(l=>{l instanceof j_&&this.update()})}ngAfterContentInit(){io(this.links.changes,io(null)).pipe(v2()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=ru(t).pipe(v2()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){const i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const t=this.hasActiveLinks();this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){const i=function uae(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{const s=r.urlTree;return!!s&&t.isActive(s,i)}}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(cg),Vt(Ws),Vt(c),Vt(vc),Vt(eE,8))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,s){if(1&i&&vp(s,eE,5),2&i){let o;ia(o=ra())&&(r.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Pl]})}return n})();class Tz{}let hae=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(jc(t=>t instanceof j_),g2(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=F3(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,l=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(l,s.children??s._loadedRoutes))}return ru(r).pipe(v2())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):io(null);const s=r.pipe(Gu(o=>null===o?io(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?ru([s,this.loader.loadComponent(i)]).pipe(v2()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(pi(cg),pi(sU),pi(xl),pi(Tz),pi(Ik))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Pk=new Mi("");let Dz=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=li(xl),o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof GD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof j_?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof S2&&t.code===qD.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof nz&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){var r=this;this.zone.runOutsideAngular((0,ve.A)(function*(){yield new Promise(s=>{setTimeout(()=>{s()}),In(()=>{s()},{injector:r.environmentInjector})}),r.zone.run(()=>{r.transitions.events.next(new nz(t,"popstate"===r.lastSource?r.store[r.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){UM()};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();function B0(n,e){return{\u0275kind:n,\u0275providers:e}}function Bz(){const n=li(sl);return e=>{const t=n.get(S0);if(e!==t.components[0])return;const i=n.get(cg),r=n.get(Pz);1===n.get(Rk)&&i.initialNavigation(),n.get(Rz,null,ua.Optional)?.setUpPreloading(),n.get(Pk,null,ua.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const Pz=new Mi("",{factory:()=>new xt}),Rk=new Mi("",{providedIn:"root",factory:()=>1}),Rz=new Mi("");function Aae(n){return B0(0,[{provide:Rz,useExisting:hae},{provide:Tz,useExisting:n}])}function _ae(n){return B0(9,[{provide:wz,useValue:Joe},{provide:Cz,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const kz=new Mi("ROUTER_FORROOT_GUARD"),yae=[hb,{provide:w2,useClass:ck},cg,jS,{provide:T2,useFactory:function Iz(n){return n.routerState.root},deps:[cg]},Ik,[]];let ZD=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[yae,[],{provide:R2,multi:!0,useValue:t},{provide:kz,useFactory:wae,deps:[[cg,new fl,new bl]]},{provide:P2,useValue:i||{}},i?.useHash?{provide:ub,useClass:hte}:{provide:ub,useClass:YU},{provide:Pk,useFactory:()=>{const n=li(Dne),e=li(Be),t=li(P2),i=li(KD),r=li(w2);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Dz(r,i,n,e,t)}},i?.preloadingStrategy?Aae(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?Cae(i):[],i?.bindToComponentInputs?B0(8,[cz,{provide:jD,useExisting:cz}]).\u0275providers:[],i?.enableViewTransitions?_ae().\u0275providers:[],[{provide:Fz,useFactory:Bz},{provide:uR,multi:!0,useExisting:Fz}]]}}static forChild(t){return{ngModule:n,providers:[{provide:R2,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(pi(kz,8))};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})();function wae(n){return"guarded"}function Cae(n){return["disabled"===n.initialNavigation?B0(3,[{provide:cR,multi:!0,useFactory:()=>{const e=li(cg);return()=>{e.setUpLocationChangeListener()}}},{provide:Rk,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?B0(2,[{provide:Rk,useValue:0},{provide:cR,multi:!0,deps:[sl],useFactory:e=>{const t=e.get(dte,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(cg),s=e.get(Pz);Sz(r,()=>{i(!0)}),e.get(KD).afterPreactivation=()=>(i(!0),s.closed?io(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const Fz=new Mi(""),Sae=[];let Eae=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[ZD.forRoot(Sae),ZD]})}return n})(),Tae=(()=>{class n{constructor(){this.title="phoenix-for-ild"}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&Er(0,"router-outlet")},dependencies:[WD]})}return n})();var Wo=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(Wo||{});const $_="*";function tE(n,e){return{type:Wo.Trigger,name:n,definitions:e,options:{}}}function P0(n,e=null){return{type:Wo.Animate,styles:e,timings:n}}function qu(n){return{type:Wo.Style,styles:n,offset:null}}function X_(n,e,t){return{type:Wo.State,name:n,styles:e,options:t}}function R0(n,e,t=null){return{type:Wo.Transition,expr:n,animation:e,options:t}}class nE{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Uz{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,l)=>Math.max(o,l.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function zz(n){return new Zt(3e3,!1)}function Iy(n){switch(n.length){case 0:return new nE;case 1:return n[0];default:return new Uz(n)}}function Hz(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,l=null;if(e.forEach(d=>{const u=d.get("offset"),f=u==o,g=f&&l||new Map;d.forEach((T,B)=>{let q=B,re=T;if("offset"!==B)switch(q=n.normalizePropertyName(q,r),re){case"!":re=t.get(B);break;case $_:re=i.get(B);break;default:re=n.normalizeStyleValue(B,q,re,r)}g.set(q,re)}),f||s.push(g),l=g,o=u}),r.length)throw function nle(n){return new Zt(3502,!1)}();return s}function Fk(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&Ok(t,"start",n)));break;case"done":n.onDone(()=>i(t&&Ok(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&Ok(t,"destroy",n)))}}function Ok(n,e,t){const s=Lk(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function Lk(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function fm(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function Vz(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const ple=typeof document>"u"?null:document.documentElement;function Nk(n){const e=n.parentNode||n.host||null;return e===ple?null:e}let _b=null,Gz=!1;function qz(n,e){for(;e;){if(e===n)return!0;e=Nk(e)}return!1}function Qz(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let Uk=(()=>{class n{validateStyleProperty(t){return function Ale(n){_b||(_b=function gle(){return typeof document<"u"?document.body:null}()||{},Gz=!!_b.style&&"WebkitAppearance"in _b.style);let e=!0;return _b.style&&!function mle(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in _b.style,!e&&Gz&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in _b.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return qz(t,i)}getParentElement(t){return Nk(t)}query(t,i,r){return Qz(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,l=[],d){return new nE(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})();class zk{static#e=this.NOOP=new Uk}class Hk{}const yle=1e3,Vk="ng-enter",JD="ng-leave",eI="ng-trigger",tI=".ng-trigger",jz="ng-animating",Gk=".ng-animating";function Y_(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:qk(parseFloat(e[1]),e[2])}function qk(n,e){return"s"===e?n*yle:n}function nI(n,e,t){return n.hasOwnProperty("duration")?n:function ble(n,e,t){let r,s=0,o="";if("string"==typeof n){const l=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===l)return e.push(zz()),{duration:0,delay:0,easing:""};r=qk(parseFloat(l[1]),l[2]);const d=l[3];null!=d&&(s=qk(parseFloat(d),l[4]));const u=l[5];u&&(o=u)}else r=n;if(!t){let l=!1,d=e.length;r<0&&(e.push(function kae(){return new Zt(3100,!1)}()),l=!0),s<0&&(e.push(function Fae(){return new Zt(3101,!1)}()),l=!0),l&&e.splice(d,0,zz())}return{duration:r,delay:s,easing:o}}(n,e,t)}function k0(n,e,t){e.forEach((i,r)=>{const s=Wk(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function yb(n,e){e.forEach((t,i)=>{const r=Wk(i);n.style[r]=""})}function iE(n){return Array.isArray(n)?1==n.length?n[0]:function Dae(n,e=null){return{type:Wo.Sequence,steps:n,options:e}}(n):n}const Qk=new RegExp("{{\\s*(.+?)\\s*}}","g");function Xz(n){let e=[];if("string"==typeof n){let t;for(;t=Qk.exec(n);)e.push(t[1]);Qk.lastIndex=0}return e}function rE(n,e,t){const i=`${n}`,r=i.replace(Qk,(s,o)=>{let l=e[o];return null==l&&(t.push(function Lae(n){return new Zt(3003,!1)}()),l=""),l.toString()});return r==i?n:r}const Cle=/-+([a-z0-9])/g;function Wk(n){return n.replace(Cle,(...e)=>e[1].toUpperCase())}function pm(n,e,t){switch(e.type){case Wo.Trigger:return n.visitTrigger(e,t);case Wo.State:return n.visitState(e,t);case Wo.Transition:return n.visitTransition(e,t);case Wo.Sequence:return n.visitSequence(e,t);case Wo.Group:return n.visitGroup(e,t);case Wo.Animate:return n.visitAnimate(e,t);case Wo.Keyframes:return n.visitKeyframes(e,t);case Wo.Style:return n.visitStyle(e,t);case Wo.Reference:return n.visitReference(e,t);case Wo.AnimateChild:return n.visitAnimateChild(e,t);case Wo.AnimateRef:return n.visitAnimateRef(e,t);case Wo.Query:return n.visitQuery(e,t);case Wo.Stagger:return n.visitStagger(e,t);default:throw function Nae(n){return new Zt(3004,!1)}()}}function jk(n,e){return window.getComputedStyle(n)[e]}const Ele=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Yz extends Hk{normalizePropertyName(e,t){return Wk(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(Ele.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const l=i.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&0==l[1].length&&r.push(function Uae(n,e){return new Zt(3005,!1)}())}return o+s}}const iI="*";const rI=new Set(["true","1"]),sI=new Set(["false","0"]);function Kz(n,e){const t=rI.has(n)||sI.has(n),i=rI.has(e)||sI.has(e);return(r,s)=>{let o=n==iI||n==r,l=e==iI||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?rI.has(n):sI.has(n)),!l&&i&&"boolean"==typeof s&&(l=s?rI.has(e):sI.has(e)),o&&l}}const Ble=new RegExp("s*:selfs*,?","g");function $k(n,e,t,i){return new Ple(n).build(e,t,i)}class Ple{constructor(e){this._driver=e}build(e,t,i){const r=new Fle(t);return this._resetContextStyleTimingState(r),pm(this,iE(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function zae(){return new Zt(3006,!1)}()),e.definitions.forEach(l=>{if(this._resetContextStyleTimingState(t),l.type==Wo.State){const d=l,u=d.name;u.toString().split(/\s*,\s*/).forEach(f=>{d.name=f,s.push(this.visitState(d,t))}),d.name=u}else if(l.type==Wo.Transition){const d=this.visitTransition(l,t);i+=d.queryCount,r+=d.depCount,o.push(d)}else t.errors.push(function Hae(){return new Zt(3007,!1)}())}),{type:Wo.Trigger,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(l=>{l instanceof Map&&l.forEach(d=>{Xz(d).forEach(u=>{o.hasOwnProperty(u)||s.add(u)})})}),s.size&&t.errors.push(function Vae(n,e){return new Zt(3008,!1)}(0,s.values()))}return{type:Wo.State,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=pm(this,iE(e.animation),t),r=function Tle(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Dle(n,e,t){if(":"==n[0]){const d=function Ile(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function Zae(n){return new Zt(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof d)return void e.push(d);n=d}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function Kae(n){return new Zt(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(Kz(r,o)),"<"==s[0]&&(r!=iI||o!=iI)&&e.push(Kz(o,r))}(i,t,e)):t.push(n),t}(e.expr,t.errors);return{type:Wo.Transition,matchers:r,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:vb(e.options)}}visitSequence(e,t){return{type:Wo.Sequence,steps:e.steps.map(i=>pm(this,i,t)),options:vb(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const l=pm(this,o,t);return r=Math.max(r,t.currentTime),l});return t.currentTime=r,{type:Wo.Group,steps:s,options:vb(e.options)}}visitAnimate(e,t){const i=function Lle(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return Xk(nI(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Xk(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=nI(t,e);return Xk(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:qu({});if(s.type==Wo.Keyframes)r=this.visitKeyframes(s,t);else{let o=e.styles,l=!1;if(!o){l=!0;const u={};i.easing&&(u.easing=i.easing),o=qu(u)}t.currentTime+=i.duration+i.delay;const d=this.visitStyle(o,t);d.isEmptyStep=l,r=d}return t.currentAnimateTimings=null,{type:Wo.Animate,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let l of r)"string"==typeof l?l===$_?i.push(l):t.errors.push(new Zt(3002,!1)):i.push(new Map(Object.entries(l)));let s=!1,o=null;return i.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(o=l.get("easing"),l.delete("easing")),!s))for(let d of l.values())if(d.toString().indexOf("{{")>=0){s=!0;break}}),{type:Wo.Style,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((l,d)=>{const u=t.collectedStyles.get(t.currentQuerySelector),f=u.get(d);let g=!0;f&&(s!=r&&s>=f.startTime&&r<=f.endTime&&(t.errors.push(function qae(n,e,t,i,r){return new Zt(3010,!1)}()),g=!1),s=f.startTime),g&&u.set(d,{startTime:s,endTime:r}),t.options&&function wle(n,e,t){const i=e.params||{},r=Xz(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Oae(n){return new Zt(3001,!1)}())})}(l,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:Wo.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Qae(){return new Zt(3011,!1)}()),i;let s=0;const o=[];let l=!1,d=!1,u=0;const f=e.steps.map(ne=>{const De=this._makeStyleAst(ne,t);let Se=null!=De.offset?De.offset:function Ole(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(De.styles),je=0;return null!=Se&&(s++,je=De.offset=Se),d=d||je<0||je>1,l=l||je<u,u=je,o.push(je),De});d&&t.errors.push(function Wae(){return new Zt(3012,!1)}()),l&&t.errors.push(function jae(){return new Zt(3200,!1)}());const g=e.steps.length;let T=0;s>0&&s<g?t.errors.push(function $ae(){return new Zt(3202,!1)}()):0==s&&(T=1/(g-1));const B=g-1,q=t.currentTime,re=t.currentAnimateTimings,se=re.duration;return f.forEach((ne,De)=>{const Se=T>0?De==B?1:T*De:o[De],je=Se*se;t.currentTime=q+re.delay+je,re.duration=je,this._validateStyleAst(ne,t),ne.offset=Se,i.styles.push(ne)}),i}visitReference(e,t){return{type:Wo.Reference,animation:pm(this,iE(e.animation),t),options:vb(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:Wo.AnimateChild,options:vb(e.options)}}visitAnimateRef(e,t){return{type:Wo.AnimateRef,animation:this.visitReference(e.animation,t),options:vb(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Rle(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Ble,"")),n=n.replace(/@\*/g,tI).replace(/@\w+/g,t=>tI+"-"+t.slice(1)).replace(/:animating/g,Gk),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,fm(t.collectedStyles,t.currentQuerySelector,new Map);const l=pm(this,iE(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:Wo.Query,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:l,originalSelector:e.selector,options:vb(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function Xae(){return new Zt(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:nI(e.timings,t.errors,!0);return{type:Wo.Stagger,animation:pm(this,iE(e.animation),t),timings:i,options:null}}}class Fle{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function vb(n){return n?(n={...n}).params&&(n.params=function kle(n){return n?{...n}:null}(n.params)):n={},n}function Xk(n,e,t){return{duration:n,delay:e,easing:t}}function Yk(n,e,t,i,r,s,o=null,l=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:l}}class oI{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const zle=new RegExp(":enter","g"),Vle=new RegExp(":leave","g");function Kk(n,e,t,i,r,s=new Map,o=new Map,l,d,u=[]){return(new Gle).buildKeyframes(n,e,t,i,r,s,o,l,d,u)}class Gle{buildKeyframes(e,t,i,r,s,o,l,d,u,f=[]){u=u||new oI;const g=new Zk(e,t,u,r,s,f,[]);g.options=d;const T=d.delay?Y_(d.delay):0;g.currentTimeline.delayNextStep(T),g.currentTimeline.setStyles([o],null,g.errors,d),pm(this,i,g);const B=g.timelines.filter(q=>q.containsAnimation());if(B.length&&l.size){let q;for(let re=B.length-1;re>=0;re--){const se=B[re];if(se.element===t){q=se;break}}q&&!q.allowOnlyTimelineStyles()&&q.setStyles([l],null,g.errors,d)}return B.length?B.map(q=>q.buildKeyframes()):[Yk(t,[],[],[],0,T,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Y_(rE(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Y_(i.duration):null,l=null!=i.delay?Y_(i.delay):null;return 0!==o&&e.forEach(d=>{const u=t.appendInstructionToTimeline(d,o,l);s=Math.max(s,u.duration+u.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),pm(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){r.previousNode.type==Wo.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=aI);const o=Y_(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>pm(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Y_(e.options.delay):0;e.steps.forEach(o=>{const l=t.createSubContext(e.options);s&&l.delayNextStep(s),pm(this,o,l),r=Math.max(r,l.currentTimeline.currentTime),i.push(l.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return nI(t.params?rE(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;s.type==Wo.Keyframes?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,l=t.createSubContext().currentTimeline;l.easing=i.easing,e.styles.forEach(d=>{l.forwardTime((d.offset||0)*s),l.setStyles(d.styles,d.easing,t.errors,t.options),l.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(l),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Y_(r.delay):0;s&&(t.previousNode.type===Wo.Style||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=aI);let o=i;const l=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=l.length;let d=null;l.forEach((u,f)=>{t.currentQueryIndex=f;const g=t.createSubContext(e.options,u);s&&g.delayNextStep(s),u===t.element&&(d=g.currentTimeline),pm(this,e.animation,g),g.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,g.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),d&&(t.currentTimeline.mergeTimelineCollectedStyles(d),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),l=o*(t.currentQueryTotal-1);let d=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":d=l-d;break;case"full":d=i.currentStaggerTime}const f=t.currentTimeline;d&&f.delayNextStep(d);const g=f.currentTime;pm(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-g+(r.startTime-i.currentTimeline.startTime)}}const aI={};class Zk{constructor(e,t,i,r,s,o,l,d){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=l,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=aI,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=d||new lI(this._driver,t,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Y_(i.duration)),null!=i.delay&&(r.delay=Y_(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(l=>{(!t||!o.hasOwnProperty(l))&&(o[l]=rE(s[l],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new Zk(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=aI,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new qle(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let l=[];if(r&&l.push(this.element),e.length>0){e=(e=e.replace(zle,"."+this._enterClassName)).replace(Vle,"."+this._leaveClassName);let u=this._driver.query(this.element,e,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),l.push(...u)}return!s&&0==l.length&&o.push(function Yae(n){return new Zt(3014,!1)}()),l}}class lI{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new lI(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||$_),this._currentKeyframe.set(t,$_);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function Qle(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i??=e.keys();for(let s of i)t.set(s,$_)}else for(let[s,o]of r)t.set(s,o)}),t}(e,this._globalTimelineStyles);for(let[l,d]of o){const u=rE(d,s,i);this._pendingStyles.set(l,u),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??$_),this._updateStyle(l,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((l,d)=>{const u=new Map([...this._backFill,...l]);u.forEach((f,g)=>{"!"===f?e.add(g):f===$_&&t.add(g)}),i||u.set("offset",d/this.duration),r.push(u)});const s=[...e.values()],o=[...t.values()];if(i){const l=r[0],d=new Map(l);l.set("offset",0),d.set("offset",1),r=[l,d]}return Yk(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class qle extends lI{constructor(e,t,i,r,s,o,l=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=l,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,l=t/o,d=new Map(e[0]);d.set("offset",0),s.push(d);const u=new Map(e[0]);u.set("offset",eH(l)),s.push(u);const f=e.length-1;for(let g=1;g<=f;g++){let T=new Map(e[g]);const B=T.get("offset");T.set("offset",eH((t+B*i)/o)),s.push(T)}i=o,t=0,r="",e=s}return Yk(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function eH(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}function tH(n,e,t,i,r,s,o,l,d,u,f,g,T){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:l,queriedElements:d,preStyleProps:u,postStyleProps:f,totalTime:g,errors:T}}const Jk={};class nH{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function Wle(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,l,d,u,f){const g=[],T=this.ast.options&&this.ast.options.params||Jk,q=this.buildStyles(i,l&&l.params||Jk,g),re=d&&d.params||Jk,se=this.buildStyles(r,re,g),ne=new Set,De=new Map,Se=new Map,je="void"===r,Dt={params:iH(re,T),delay:this.ast.options?.delay},Mt=f?[]:Kk(e,t,this.ast.animation,s,o,q,se,Dt,u,g);let Bt=0;return Mt.forEach(Jt=>{Bt=Math.max(Jt.duration+Jt.delay,Bt)}),g.length?tH(t,this._triggerName,i,r,je,q,se,[],[],De,Se,Bt,g):(Mt.forEach(Jt=>{const Vn=Jt.element,Tt=fm(De,Vn,new Set);Jt.preStyleProps.forEach(Fi=>Tt.add(Fi));const tn=fm(Se,Vn,new Set);Jt.postStyleProps.forEach(Fi=>tn.add(Fi)),Vn!==t&&ne.add(Vn)}),tH(t,this._triggerName,i,r,je,q,se,Mt,[...ne.values()],De,Se,Bt))}}function iH(n,e){const t={...e};return Object.entries(n).forEach(([i,r])=>{null!=r&&(t[i]=r)}),t}class jle{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=iH(e,this.defaultParams);return this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,l)=>{o&&(o=rE(o,r,t));const d=this.normalizer.normalizePropertyName(l,t);o=this.normalizer.normalizeStyleValue(l,d,o,t),i.set(l,o)})}),i}}class Xle{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new jle(r.style,r.options&&r.options.params||{},i))}),rH(this.states,"true","1"),rH(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new nH(e,r,this.states))}),this.fallbackTransition=function Yle(n,e,t){return new nH(n,{type:Wo.Transition,animation:{type:Wo.Sequence,steps:[],options:null},matchers:[(o,l)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function rH(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const Kle=new oI;class Zle{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=$k(this._driver,t,i,[]);if(i.length)throw function ile(n){return new Zt(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=Hz(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const l=new Map;if(s?(o=Kk(this._driver,t,s,Vk,JD,new Map,new Map,i,Kle,r),o.forEach(f=>{const g=fm(l,f.element,new Map);f.postStyleProps.forEach(T=>g.set(T,null))})):(r.push(function rle(){return new Zt(3300,!1)}()),o=[]),r.length)throw function sle(n){return new Zt(3504,!1)}();l.forEach((f,g)=>{f.forEach((T,B)=>{f.set(B,this._driver.computeStyle(g,B,$_))})});const u=Iy(o.map(f=>{const g=l.get(f.element);return this._buildPlayer(f,new Map,g)}));return this._playersById.set(e,u),u.onDestroy(()=>this.destroy(e)),this.players.push(u),u}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function ole(n){return new Zt(3301,!1)}();return t}listen(e,t,i,r){const s=Lk(t,"","","");return Fk(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const sH="ng-animate-queued",eF="ng-animate-disabled",ice=[],oH={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},rce={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},dg="__ng_removed";class tF{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function lce(n){return n??null}(i?e.value:e),i){const{value:s,...o}=e;this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const sE="void",nF=new tF(sE);class sce{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,uA(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function ale(n,e){return new Zt(3302,!1)}();if(null==i||0==i.length)throw function lle(n){return new Zt(3303,!1)}();if(!function cce(n){return"start"==n||"done"==n}(i))throw function cle(n,e){return new Zt(3400,!1)}();const s=fm(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const l=fm(this._engine.statesByElement,e,new Map);return l.has(t)||(uA(e,eI),uA(e,eI+"-"+t),l.set(t,nF)),()=>{this._engine.afterFlush(()=>{const d=s.indexOf(o);d>=0&&s.splice(d,1),this._triggers.has(t)||l.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function dle(n){return new Zt(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new iF(this.id,t,e);let l=this._engine.statesByElement.get(e);l||(uA(e,eI),uA(e,eI+"-"+t),this._engine.statesByElement.set(e,l=new Map));let d=l.get(t);const u=new tF(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&d&&u.absorbOptions(d.options),l.set(t,u),d||(d=nF),u.value!==sE&&d.value===u.value){if(!function hce(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(d.params,u.params)){const re=[],se=s.matchStyles(d.value,d.params,re),ne=s.matchStyles(u.value,u.params,re);re.length?this._engine.reportError(re):this._engine.afterFlush(()=>{yb(e,se),k0(e,ne)})}return}const T=fm(this._engine.playersByElement,e,[]);T.forEach(re=>{re.namespaceId==this.id&&re.triggerName==t&&re.queued&&re.destroy()});let B=s.matchTransition(d.value,u.value,e,u.params),q=!1;if(!B){if(!r)return;B=s.fallbackTransition,q=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:B,fromState:d,toState:u,player:o,isFallbackTransition:q}),q||(uA(e,sH),o.onStart(()=>{k2(e,sH)})),o.onDone(()=>{let re=this.players.indexOf(o);re>=0&&this.players.splice(re,1);const se=this._engine.playersByElement.get(e);if(se){let ne=se.indexOf(o);ne>=0&&se.splice(ne,1)}}),this.players.push(o),T.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,tI,!0);i.forEach(r=>{if(r[dg])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const l=[];if(s.forEach((d,u)=>{if(o.set(u,d.value),this._triggers.has(u)){const f=this.trigger(e,u,sE,r);f&&l.push(f)}}),l.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&Iy(l).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const d=this._triggers.get(o).fallbackTransition,u=i.get(o)||nF,f=new tF(sE),g=new iF(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:d,fromState:u,toState:f,player:g,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[dg];(!s||s===oH)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){uA(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(l=>{if(l.name==i.triggerName){const d=Lk(s,i.triggerName,i.fromState.value,i.toState.value);d._data=e,Fk(i.player,l.phase,d,l.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class oce{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i,r){this.bodyNode=e,this.driver=t,this._normalizer=i,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,o)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new sce(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,l=this.driver.getParentElement(t);for(;l;){const d=r.get(l);if(d){const u=i.indexOf(d);i.splice(u+1,0,e),o=!0;break}l=this.driver.getParentElement(l)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(cI(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!cI(t))return;const s=t[dg];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),uA(e,eF)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),k2(e,eF))}removeNode(e,t,i){if(cI(t)){this.scheduler?.notify();const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[dg]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return cI(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,tI,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,Gk,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Iy(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[dg];if(t&&t.setForRemoval){if(e[dg]=oH,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(eF)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)uA(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Iy(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function ule(n){return new Zt(3402,!1)}()}_flushAnimations(e,t){const i=new oI,r=[],s=new Map,o=[],l=new Map,d=new Map,u=new Map,f=new Set;this.disabledNodes.forEach(Gn=>{f.add(Gn);const ri=this.driver.query(Gn,".ng-animate-queued",!0);for(let di=0;di<ri.length;di++)f.add(ri[di])});const g=this.bodyNode,T=Array.from(this.statesByElement.keys()),B=cH(T,this.collectedEnterElements),q=new Map;let re=0;B.forEach((Gn,ri)=>{const di=Vk+re++;q.set(ri,di),Gn.forEach(_i=>uA(_i,di))});const se=[],ne=new Set,De=new Set;for(let Gn=0;Gn<this.collectedLeaveElements.length;Gn++){const ri=this.collectedLeaveElements[Gn],di=ri[dg];di&&di.setForRemoval&&(se.push(ri),ne.add(ri),di.hasAnimation?this.driver.query(ri,".ng-star-inserted",!0).forEach(_i=>ne.add(_i)):De.add(ri))}const Se=new Map,je=cH(T,Array.from(ne));je.forEach((Gn,ri)=>{const di=JD+re++;Se.set(ri,di),Gn.forEach(_i=>uA(_i,di))}),e.push(()=>{B.forEach((Gn,ri)=>{const di=q.get(ri);Gn.forEach(_i=>k2(_i,di))}),je.forEach((Gn,ri)=>{const di=Se.get(ri);Gn.forEach(_i=>k2(_i,di))}),se.forEach(Gn=>{this.processLeaveNode(Gn)})});const Dt=[],Mt=[];for(let Gn=this._namespaceList.length-1;Gn>=0;Gn--)this._namespaceList[Gn].drainQueuedTransitions(t).forEach(di=>{const _i=di.player,sr=di.element;if(Dt.push(_i),this.collectedEnterElements.length){const _s=sr[dg];if(_s&&_s.setForMove){if(_s.previousTriggersValues&&_s.previousTriggersValues.has(di.triggerName)){const ws=_s.previousTriggersValues.get(di.triggerName),cs=this.statesByElement.get(di.element);if(cs&&cs.has(di.triggerName)){const po=cs.get(di.triggerName);po.value=ws,cs.set(di.triggerName,po)}}return void _i.destroy()}}const pr=!g||!this.driver.containsElement(g,sr),Hr=Se.get(sr),Ns=q.get(sr),ui=this._buildInstruction(di,i,Ns,Hr,pr);if(ui.errors&&ui.errors.length)return void Mt.push(ui);if(pr)return _i.onStart(()=>yb(sr,ui.fromStyles)),_i.onDestroy(()=>k0(sr,ui.toStyles)),void r.push(_i);if(di.isFallbackTransition)return _i.onStart(()=>yb(sr,ui.fromStyles)),_i.onDestroy(()=>k0(sr,ui.toStyles)),void r.push(_i);const xr=[];ui.timelines.forEach(_s=>{_s.stretchStartingKeyframe=!0,this.disabledNodes.has(_s.element)||xr.push(_s)}),ui.timelines=xr,i.append(sr,ui.timelines),o.push({instruction:ui,player:_i,element:sr}),ui.queriedElements.forEach(_s=>fm(l,_s,[]).push(_i)),ui.preStyleProps.forEach((_s,ws)=>{if(_s.size){let cs=d.get(ws);cs||d.set(ws,cs=new Set),_s.forEach((po,Xs)=>cs.add(Xs))}}),ui.postStyleProps.forEach((_s,ws)=>{let cs=u.get(ws);cs||u.set(ws,cs=new Set),_s.forEach((po,Xs)=>cs.add(Xs))})});if(Mt.length){const Gn=[];Mt.forEach(ri=>{Gn.push(function hle(n,e){return new Zt(3505,!1)}())}),Dt.forEach(ri=>ri.destroy()),this.reportError(Gn)}const Bt=new Map,Jt=new Map;o.forEach(Gn=>{const ri=Gn.element;i.has(ri)&&(Jt.set(ri,ri),this._beforeAnimationBuild(Gn.player.namespaceId,Gn.instruction,Bt))}),r.forEach(Gn=>{const ri=Gn.element;this._getPreviousPlayers(ri,!1,Gn.namespaceId,Gn.triggerName,null).forEach(_i=>{fm(Bt,ri,[]).push(_i),_i.destroy()})});const Vn=se.filter(Gn=>uH(Gn,d,u)),Tt=new Map;lH(Tt,this.driver,De,u,$_).forEach(Gn=>{uH(Gn,d,u)&&Vn.push(Gn)});const Fi=new Map;B.forEach((Gn,ri)=>{lH(Fi,this.driver,new Set(Gn),d,"!")}),Vn.forEach(Gn=>{const ri=Tt.get(Gn),di=Fi.get(Gn);Tt.set(Gn,new Map([...ri?.entries()??[],...di?.entries()??[]]))});const Vi=[],On=[],yi={};o.forEach(Gn=>{const{element:ri,player:di,instruction:_i}=Gn;if(i.has(ri)){if(f.has(ri))return di.onDestroy(()=>k0(ri,_i.toStyles)),di.disabled=!0,di.overrideTotalTime(_i.totalTime),void r.push(di);let sr=yi;if(Jt.size>1){let Hr=ri;const Ns=[];for(;Hr=Hr.parentNode;){const ui=Jt.get(Hr);if(ui){sr=ui;break}Ns.push(Hr)}Ns.forEach(ui=>Jt.set(ui,sr))}const pr=this._buildAnimation(di.namespaceId,_i,Bt,s,Fi,Tt);if(di.setRealPlayer(pr),sr===yi)Vi.push(di);else{const Hr=this.playersByElement.get(sr);Hr&&Hr.length&&(di.parentPlayer=Iy(Hr)),r.push(di)}}else yb(ri,_i.fromStyles),di.onDestroy(()=>k0(ri,_i.toStyles)),On.push(di),f.has(ri)&&r.push(di)}),On.forEach(Gn=>{const ri=s.get(Gn.element);if(ri&&ri.length){const di=Iy(ri);Gn.setRealPlayer(di)}}),r.forEach(Gn=>{Gn.parentPlayer?Gn.syncPlayerEvents(Gn.parentPlayer):Gn.destroy()});for(let Gn=0;Gn<se.length;Gn++){const ri=se[Gn],di=ri[dg];if(k2(ri,JD),di&&di.hasAnimation)continue;let _i=[];if(l.size){let pr=l.get(ri);pr&&pr.length&&_i.push(...pr);let Hr=this.driver.query(ri,Gk,!0);for(let Ns=0;Ns<Hr.length;Ns++){let ui=l.get(Hr[Ns]);ui&&ui.length&&_i.push(...ui)}}const sr=_i.filter(pr=>!pr.destroyed);sr.length?dce(this,ri,sr):this.processLeaveNode(ri)}return se.length=0,Vi.forEach(Gn=>{this.players.push(Gn),Gn.onDone(()=>{Gn.destroy();const ri=this.players.indexOf(Gn);this.players.splice(ri,1)}),Gn.play()}),Vi}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const l=this.playersByQueriedElement.get(e);l&&(o=l)}else{const l=this.playersByElement.get(e);if(l){const d=!s||s==sE;l.forEach(u=>{u.queued||!d&&u.triggerName!=r||o.push(u)})}}return(i||r)&&(o=o.filter(l=>!(i&&i!=l.namespaceId||r&&r!=l.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,l=t.isRemovalTransition?void 0:t.triggerName;for(const d of t.timelines){const u=d.element,f=u!==s,g=fm(i,u,[]);this._getPreviousPlayers(u,f,o,l,t.toState).forEach(B=>{const q=B.getRealPlayer();q.beforeDestroy&&q.beforeDestroy(),B.destroy(),g.push(B)})}yb(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const l=t.triggerName,d=t.element,u=[],f=new Set,g=new Set,T=t.timelines.map(q=>{const re=q.element;f.add(re);const se=re[dg];if(se&&se.removedBeforeQueried)return new nE(q.duration,q.delay);const ne=re!==d,De=function uce(n){const e=[];return dH(n,e),e}((i.get(re)||ice).map(Bt=>Bt.getRealPlayer())).filter(Bt=>!!Bt.element&&Bt.element===re),Se=s.get(re),je=o.get(re),Dt=Hz(this._normalizer,q.keyframes,Se,je),Mt=this._buildPlayer(q,Dt,De);if(q.subTimeline&&r&&g.add(re),ne){const Bt=new iF(e,l,re);Bt.setRealPlayer(Mt),u.push(Bt)}return Mt});u.forEach(q=>{fm(this.playersByQueriedElement,q.element,[]).push(q),q.onDone(()=>function ace(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,q.element,q))}),f.forEach(q=>uA(q,jz));const B=Iy(T);return B.onDestroy(()=>{f.forEach(q=>k2(q,jz)),k0(d,t.toStyles)}),g.forEach(q=>{fm(r,q,[]).push(B)}),B}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new nE(e.duration,e.delay)}}class iF{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new nE,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>Fk(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){fm(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function cI(n){return n&&1===n.nodeType}function aH(n,e){const t=n.style.display;return n.style.display=e??"none",t}function lH(n,e,t,i,r){const s=[];t.forEach(d=>s.push(aH(d)));const o=[];i.forEach((d,u)=>{const f=new Map;d.forEach(g=>{const T=e.computeStyle(u,g,r);f.set(g,T),(!T||0==T.length)&&(u[dg]=rce,o.push(u))}),n.set(u,f)});let l=0;return t.forEach(d=>aH(d,s[l++])),o}function cH(n,e){const t=new Map;if(n.forEach(l=>t.set(l,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(l){if(!l)return 1;let d=s.get(l);if(d)return d;const u=l.parentNode;return d=t.has(u)?u:r.has(u)?1:o(u),s.set(l,d),d}return e.forEach(l=>{const d=o(l);1!==d&&t.get(d).push(l)}),t}function uA(n,e){n.classList?.add(e)}function k2(n,e){n.classList?.remove(e)}function dce(n,e,t){Iy(t).onDone(()=>n.processLeaveNode(e))}function dH(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof Uz?dH(i.players,e):e.push(i)}}function uH(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class oE{constructor(e,t,i,r){this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(s,o)=>{},this._transitionEngine=new oce(e.body,t,i,r),this._timelineEngine=new Zle(e.body,t,i),this._transitionEngine.onRemovalComplete=(s,o)=>this.onRemovalComplete(s,o)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let l=this._triggerCache[o];if(!l){const d=[],f=$k(this._driver,s,d,[]);if(d.length)throw function tle(n,e){return new Zt(3404,!1)}();l=function $le(n,e,t){return new Xle(n,e,t)}(r,f,this._normalizer),this._triggerCache[o]=l}this._transitionEngine.registerTrigger(t,r,l)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=Vz(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,l]=Vz(i);return this._timelineEngine.listen(o,t,l,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}class aE{static#e=this.initialStylesByElement=new WeakMap;constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=aE.initialStylesByElement.get(e);r||aE.initialStylesByElement.set(e,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&k0(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(k0(this._element,this._initialStyles),this._endStyles&&(k0(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(aE.initialStylesByElement.delete(this._element),this._startStyles&&(yb(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(yb(this._element,this._endStyles),this._endStyles=null),k0(this._element,this._initialStyles),this._state=3)}}function rF(n){let e=null;return n.forEach((t,i)=>{(function pce(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class hH{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:jk(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class fH{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return qz(e,t)}getParentElement(e){return Nk(e)}query(e,t,i){return Qz(e,t,i)}computeStyle(e,t,i){return jk(e,t)}animate(e,t,i,r,s,o=[]){const d={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(d.easing=s);const u=new Map,f=o.filter(B=>B instanceof hH);(function Mle(n,e){return 0===n||0===e})(i,r)&&f.forEach(B=>{B.currentSnapshot.forEach((q,re)=>u.set(re,q))});let g=function xle(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}(t).map(B=>new Map(B));g=function Sle(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(l=>o.set(l,jk(n,l)))}}return e}(e,g,u);const T=function fce(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=rF(e[0]),e.length>1&&(i=rF(e[e.length-1]))):e instanceof Map&&(t=rF(e)),t||i?new aE(n,t,i):null}(e,g);return new hH(e,g,d,T)}}const pH="@.disabled";class mH{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==pH?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class mce extends mH{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==pH?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Ace(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function gce(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,l=>{this.factory.scheduleListenerCallback(l._data||-1,i,l)})}return this.delegate.listen(e,t,i)}}class _ce{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(r,s)=>{const o=s?.parentNode(r);o&&s.removeChild(o,r)}}createRenderer(e,t){const r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){const u=this._rendererCache;let f=u.get(r);return f||(f=new mH("",r,this.engine,()=>u.delete(r)),u.set(r,f)),f}const s=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(s,o,e,u.name,u)};return t.data.animation.forEach(l),new mce(this,o,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>t(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(s=>{const[o,l]=s;o(l)}),this._animationCallbacksBuffer=[]})}),r.push([t,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}const AH=[{provide:Hk,useFactory:function vce(){return new Yz}},{provide:oE,useClass:(()=>{class n extends oE{constructor(t,i,r){super(t,i,r,li(tb,{optional:!0}))}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(zk),pi(Hk))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac})}return n})()},{provide:a,useFactory:function bce(n,e,t){return new _ce(n,e,t)},deps:[VR,oE,Be]}],sF=[{provide:zk,useFactory:()=>new fH},{provide:Fd,useValue:"BrowserAnimations"},...AH],gH=[{provide:zk,useClass:Uk},{provide:Fd,useValue:"NoopAnimations"},...AH];let xce=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?gH:sF}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:sF,imports:[H7]})}return n})();const wce=new Mi("cdk-dir-doc",{providedIn:"root",factory:function Cce(){return li(fa)}}),Mce=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let oF,mm=(()=>{class n{constructor(t){this.value="ltr",this.change=new xs,t&&(this.value=function Sce(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Mce.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(pi(wce,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lE=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})();try{oF=typeof Intl<"u"&&Intl.v8BreakIterator}catch{oF=!1}let cE,bb,aF,od=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?_7(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!oF)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||n)(pi(om))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ug(n){return function Ece(){if(null==cE&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>cE=!0}))}finally{cE=cE||!1}return cE}()?n:!!n.capture}function yH(){if(null==bb){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return bb=!1,bb;if("scrollBehavior"in document.documentElement.style)bb=!0;else{const n=Element.prototype.scrollTo;bb=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return bb}function lF(n){if(function Tce(){if(null==aF){const n=typeof document<"u"?document.head:null;aF=!(!n||!n.createShadowRoot&&!n.attachShadow)}return aF}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function cF(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function hA(n){return n.composedPath?n.composedPath()[0]:n.target}function dF(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function O2(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}class Gce extends lt{constructor(e,t){super()}schedule(e,t=0){return this}}const fI={setInterval(n,e,...t){const{delegate:i}=fI;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=fI;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class fF extends Gce{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return fI.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&fI.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Oe(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const CH={now:()=>(CH.delegate||Date).now(),delegate:void 0};class uE{constructor(e,t=uE.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}uE.now=CH.now;class pF extends uE{constructor(e,t=uE.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const hE=new pF(fF),qce=hE;function mF(n,e=hE){return ln((t,i)=>{let r=null,s=null,o=null;const l=()=>{if(r){r.unsubscribe(),r=null;const u=s;s=null,i.next(u)}};function d(){const u=o+n,f=e.now();if(f<u)return r=this.schedule(void 0,u-f),void i.add(r);l()}t.subscribe(Un(i,u=>{s=u,o=e.now(),r||(r=e.schedule(d,n),i.add(r))},()=>{l(),i.complete()},void 0,()=>{s=r=null}))})}function AF(n){return jc((e,t)=>n<=t)}function Qce(n,e){return n===e}function SH(n){return null!=n&&"false"!=`${n}`}function xb(n,e=0){return function Wce(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function fE(n){return Array.isArray(n)?n:[n]}function ou(n){return null==n?"":"string"==typeof n?n:`${n}px`}function au(n){return n instanceof Ws?n.nativeElement:n}let EH=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Yce=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[EH]})}return n})();const TH=new Set;let wb,Kce=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Jce}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Zce(n,e){if(!TH.has(n))try{wb||(wb=document.createElement("style"),e&&wb.setAttribute("nonce",e),wb.setAttribute("type","text/css"),document.head.appendChild(wb)),wb.sheet&&(wb.sheet.insertRule(`@media ${n} {body{ }}`,0),TH.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(od),pi(Ev,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Jce(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let ede=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new xt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return DH(fE(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=RD(DH(fE(t)).map(o=>this._registerQuery(o).observable));return s=US(s.pipe(sd(1)),s.pipe(AF(1),mF(0))),s.pipe(Rn(o=>{const l={matches:!1,breakpoints:{}};return o.forEach(({matches:d,query:u})=>{l.matches=l.matches||d,l.breakpoints[u]=d}),l}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new me(o=>{const l=d=>this._zone.run(()=>o.next(d));return i.addListener(l),()=>{i.removeListener(l)}}).pipe(dA(i),Rn(({matches:o})=>({query:t,matches:o})),jl(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Kce),pi(Be))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function DH(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function pI(n,e){return n.getAttribute(e)?.match(/\S+/g)??[]}const BH="cdk-describedby-message",mI="cdk-describedby-host";let gF=0,ide=(()=>{class n{constructor(t,i){this._platform=i,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+gF++,this._document=t,this._id=li(M_)+"-"+gF++}describe(t,i,r){if(!this._canBeDescribed(t,i))return;const s=_F(i,r);"string"!=typeof i?(PH(i,this._id),this._messageRegistry.set(s,{messageElement:i,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(i,r),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,i,r){if(!i||!this._isElementNode(t))return;const s=_F(i,r);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),"string"==typeof i){const o=this._messageRegistry.get(s);o&&0===o.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${mI}="${this._id}"]`);for(let i=0;i<t.length;i++)this._removeCdkDescribedByReferenceIds(t[i]),t[i].removeAttribute(mI);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,i){const r=this._document.createElement("div");PH(r,this._id),r.textContent=t,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(_F(t,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<i.length;s++)i[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const i=pI(t,"aria-describedby").filter(r=>0!=r.indexOf(BH));t.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(t,i){const r=this._messageRegistry.get(i);(function tde(n,e,t){const i=pI(n,e);t=t.trim(),!i.some(r=>r.trim()===t)&&(i.push(t),n.setAttribute(e,i.join(" ")))})(t,"aria-describedby",r.messageElement.id),t.setAttribute(mI,this._id),r.referenceCount++}_removeMessageReference(t,i){const r=this._messageRegistry.get(i);r.referenceCount--,function nde(n,e,t){const i=pI(n,e);t=t.trim();const r=i.filter(s=>s!==t);r.length?n.setAttribute(e,r.join(" ")):n.removeAttribute(e)}(t,"aria-describedby",r.messageElement.id),t.removeAttribute(mI)}_isElementDescribedByMessage(t,i){const r=pI(t,"aria-describedby"),s=this._messageRegistry.get(i),o=s&&s.messageElement.id;return!!o&&-1!=r.indexOf(o)}_canBeDescribed(t,i){if(!this._isElementNode(t))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),s=t.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(od))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _F(n,e){return"string"==typeof n?`${e||""}/${n}`:n}function PH(n,e){n.id||(n.id=`${BH}-${e}-${gF++}`)}class rde{constructor(e,t){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new xt,this._typeaheadSubscription=lt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=i=>i.disabled,this._pressedLetters=[],this.tabOut=new xt,this.change=new xt,e instanceof vf?this._itemChangesSubscription=e.changes.subscribe(i=>this._itemsChanged(i.toArray())):ib(e)&&(this._effectRef=function WU(n,e){de("NgSignals"),!e?.injector&&K0();const t=e?.injector??li(sl),i=!0!==e?.manualCleanup?t.get(yu):null,r=new ste(t.get(nte),n,typeof Zone>"u"?null:Zone.current,i,t,e?.allowSignalWrites??!1),s=t.get(vc,null,{optional:!0});return s&&8&s._lView[Ks]?(s._lView[Bd]??=[]).push(r.watcher.notify):r.watcher.notify(),r}(()=>this._itemsChanged(e()),{injector:t}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(su(t=>this._pressedLetters.push(t)),mF(e),jc(()=>this._pressedLetters.length>0),Rn(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,o=i[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(s<o?s:o-1,-1);break}return;default:return void((r||O2(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return ib(this._items)?this._items():this._items instanceof vf?this._items.toArray():this._items}_itemsChanged(e){if(this._activeItem){const t=e.indexOf(this._activeItem);t>-1&&t!==this._activeItemIndex&&(this._activeItemIndex=t)}}}class RH extends rde{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let yF=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function ode(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function sde(n){try{return n.frameElement}catch{return null}}(function pde(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===FH(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=FH(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function hde(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function fde(n){return!function lde(n){return function dde(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function ade(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function cde(n){return function ude(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||kH(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}static#e=this.\u0275fac=function(i){return new(i||n)(pi(od))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kH(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function FH(n){if(!kH(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class OH{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(sd(1)).subscribe(e)}}let LH=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new OH(t,this._checker,this._ngZone,this._document,i)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(yF),pi(Be),pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function AI(n){return 0===n.buttons||0===n.detail}function gI(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const mde=new Mi("cdk-input-modality-detector-options"),Ade={ignoreKeys:[18,17,224,91,16]},L2=ug({passive:!0,capture:!0});let gde=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new jt(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(l=>l===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=hA(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(AI(o)?"keyboard":"mouse"),this._mostRecentTarget=hA(o))},this._onTouchstart=o=>{gI(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=hA(o))},this._options={...Ade,...s},this.modalityDetected=this._modality.pipe(AF(1)),this.modalityChanged=this.modalityDetected.pipe(function MH(n,e=wt){return n=n??Qce,ln((t,i)=>{let r,s=!0;t.subscribe(Un(i,o=>{const l=e(o);(s||!n(r,l))&&(s=!1,r=l,i.next(o))}))})}()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,L2),r.addEventListener("mousedown",this._onMousedown,L2),r.addEventListener("touchstart",this._onTouchstart,L2)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,L2),document.removeEventListener("mousedown",this._onMousedown,L2),document.removeEventListener("touchstart",this._onTouchstart,L2))}static#e=this.\u0275fac=function(i){return new(i||n)(pi(od),pi(Be),pi(fa),pi(mde,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var _I=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(_I||{});const yde=new Mi("cdk-focus-monitor-default-options"),yI=ug({passive:!0,capture:!0});let K_=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new xt,this._rootNodeFocusAndBlurListener=l=>{for(let u=hA(l);u;u=u.parentElement)"focus"===l.type?this._onFocus(l,u):this._onBlur(l,u)},this._document=s,this._detectionMode=o?.detectionMode||_I.IMMEDIATE}monitor(t,i=!1){const r=au(t);if(!this._platform.isBrowser||1!==r.nodeType)return io();const s=lF(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const l={checkChildren:i,subject:new xt,rootNode:s};return this._elementInfo.set(r,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(t){const i=au(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=au(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([l,d])=>this._originChanged(l,i,d)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===_I.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,this._detectionMode===_I.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=hA(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,yI),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,yI)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(jl(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,yI),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,yI),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Be),pi(od),pi(gde),pi(fa,8),pi(yde,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Cb=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(Cb||{});const UH="cdk-high-contrast-black-on-white",zH="cdk-high-contrast-white-on-black",vF="cdk-high-contrast-active";let HH=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=li(ede).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Cb.NONE;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Cb.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Cb.BLACK_ON_WHITE}return Cb.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(vF,UH,zH),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();i===Cb.BLACK_ON_WHITE?t.add(vF,UH):i===Cb.WHITE_ON_BLACK&&t.add(vF,zH)}}static#e=this.\u0275fac=function(i){return new(i||n)(pi(od),pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),VH=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}static#e=this.\u0275fac=function(i){return new(i||n)(pi(HH))};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Yce]})}return n})();const bde=["mat-internal-form-field",""],xde=["*"],Cde=new Mi("mat-sanity-checks",{providedIn:"root",factory:function wde(){return!0}});let Gd=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!dF()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||n)(pi(HH),pi(Cde,8),pi(fa))};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[lE,lE]})}return n})();var bp=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(bp||{});class Bde{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=bp.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const QH=ug({passive:!0,capture:!0});class Pde{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=hA(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,QH)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,QH)))}}const WH={enterDuration:225,exitDuration:150},jH=ug({passive:!0,capture:!0}),$H=["mousedown","touchstart"],XH=["mouseup","mouseleave","touchend","touchcancel"];class vI{static#e=this._eventManager=new Pde;constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=au(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...WH,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function kde(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),l=e-r.left,d=t-r.top,u=s.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=l-o+"px",f.style.top=d-o+"px",f.style.height=2*o+"px",f.style.width=2*o+"px",null!=i.color&&(f.style.backgroundColor=i.color),f.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(f);const g=window.getComputedStyle(f),B=g.transitionDuration,q="none"===g.transitionProperty||"0s"===B||"0s, 0s"===B||0===r.width&&0===r.height,re=new Bde(this,f,i,q);f.style.transform="scale3d(1, 1, 1)",re.state=bp.FADING_IN,i.persistent||(this._mostRecentTransientRipple=re);let se=null;return!q&&(u||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ne=()=>this._finishRippleTransition(re),De=()=>this._destroyRipple(re);f.addEventListener("transitionend",ne),f.addEventListener("transitioncancel",De),se={onTransitionEnd:ne,onTransitionCancel:De}}),this._activeRipples.set(re,se),(q||!u)&&this._finishRippleTransition(re),re}fadeOutRipple(e){if(e.state===bp.FADING_OUT||e.state===bp.HIDDEN)return;const t=e.element,i={...WH,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=bp.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=au(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,$H.forEach(i=>{vI._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{XH.forEach(t=>{this._triggerElement.addEventListener(t,this,jH)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===bp.FADING_IN?this._startFadeOutTransition(e):e.state===bp.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=bp.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=bp.HIDDEN,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=AI(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!gI(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(e.state===bp.VISIBLE||e.config.terminateOnPointerUp&&e.state===bp.FADING_IN)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&($H.forEach(t=>vI._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(XH.forEach(t=>e.removeEventListener(t,this,jH)),this._pointerUpEventsRegistered=!1))}}const bF=new Mi("mat-ripple-global-options");let O0=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new vI(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(Be),Vt(od),Vt(bF,8),Vt(Fd,8))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&nl("mat-ripple-unbounded",r.unbounded)},inputs:{color:[mi.None,"matRippleColor","color"],unbounded:[mi.None,"matRippleUnbounded","unbounded"],centered:[mi.None,"matRippleCentered","centered"],radius:[mi.None,"matRippleRadius","radius"],animation:[mi.None,"matRippleAnimation","animation"],disabled:[mi.None,"matRippleDisabled","disabled"],trigger:[mi.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}return n})(),bI=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Gd,Gd]})}return n})();const YH={capture:!0},KH=["focus","click","mouseenter","touchstart"],xF="mat-ripple-loader-uninitialized",wF="mat-ripple-loader-class-name",ZH="mat-ripple-loader-centered",xI="mat-ripple-loader-disabled";let Fde=(()=>{class n{constructor(){this._document=li(fa,{optional:!0}),this._animationMode=li(Fd,{optional:!0}),this._globalRippleOptions=li(bF,{optional:!0}),this._platform=li(od),this._ngZone=li(Be),this._hosts=new Map,this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;const r=t.target.closest(`[${xF}]`);r&&this._createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const t of KH)this._document?.addEventListener(t,this._onInteraction,YH)})}ngOnDestroy(){const t=this._hosts.keys();for(const i of t)this.destroyRipple(i);for(const i of KH)this._document?.removeEventListener(i,this._onInteraction,YH)}configureRipple(t,i){t.setAttribute(xF,""),(i.className||!t.hasAttribute(wF))&&t.setAttribute(wF,i.className||""),i.centered&&t.setAttribute(ZH,""),i.disabled&&t.setAttribute(xI,"")}getRipple(t){return this._hosts.get(t)||this._createRipple(t)}setDisabled(t,i){const r=this._hosts.get(t);r?r.disabled=i:i?t.setAttribute(xI,""):t.removeAttribute(xI)}_createRipple(t){if(!this._document)return;const i=this._hosts.get(t);if(i)return i;t.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",t.getAttribute(wF)),t.append(r);const s=new O0(new Ws(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=t,s.centered=t.hasAttribute(ZH),s.disabled=t.hasAttribute(xI),this.attachRipple(t,s),s}attachRipple(t,i){t.removeAttribute(xF),this._hosts.set(t,i)}destroyRipple(t){const i=this._hosts.get(t);i&&(i.ngOnDestroy(),this._hosts.delete(t))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),CF=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Qr({type:n,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){2&i&&nl("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[rd],attrs:bde,ngContentSelectors:xde,decls:1,vars:0,template:function(i,r){1&i&&(vh(),eu(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-form-field{font-family:var(--mdc-form-field-label-text-font);line-height:var(--mdc-form-field-label-text-line-height);font-size:var(--mdc-form-field-label-text-size);font-weight:var(--mdc-form-field-label-text-weight);letter-spacing:var(--mdc-form-field-label-text-tracking);color:var(--mdc-form-field-label-text-color)}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}return n})();let eV=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(c),Vt(Ws))};static#t=this.\u0275dir=Sr({type:n})}return n})(),Mb=(()=>{class n extends eV{static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275dir=Sr({type:n,features:[Fo]})}return n})();const kf=new Mi(""),Lde={provide:kf,useExisting:Xt(()=>MF),multi:!0},Ude=new Mi("");let MF=(()=>{class n extends eV{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Nde(){const n=Cy()?Cy().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(c),Vt(Ws),Vt(Ude,8))};static#t=this.\u0275dir=Sr({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&gi("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[Po([Lde]),Fo]})}return n})();const lu=new Mi(""),Py=new Mi("");function uV(n){return null!=n}function hV(n){return MS(n)?ru(n):n}function fV(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function pV(n,e){return e.map(t=>t(n))}function mV(n){return n.map(e=>function Hde(n){return!n.validate}(e)?e:t=>e.validate(t))}function SF(n){return null!=n?function AV(n){if(!n)return null;const e=n.filter(uV);return 0==e.length?null:function(t){return fV(pV(t,e))}}(mV(n)):null}function gV(n){if(!n)return null;const e=n.filter(uV);return 0==e.length?null:function(t){return function JH(...n){const e=W7(n),{args:t,keys:i}=B9(n),r=new me(s=>{const{length:o}=t;if(!o)return void s.complete();const l=new Array(o);let d=o,u=o;for(let f=0;f<o;f++){let g=!1;Qh(t[f]).subscribe(Un(s,T=>{g||(g=!0,u--),l[f]=T},()=>d--,void 0,()=>{(!d||!g)&&(u||s.next(i?P9(i,l):l),s.complete())}))}});return e?r.pipe(rk(e)):r}(pV(t,e).map(hV)).pipe(Rn(fV))}}function EF(n){return null!=n?gV(mV(n)):null}function _V(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function TF(n){return n?Array.isArray(n)?n:[n]:[]}function CI(n,e){return Array.isArray(n)?n.includes(e):n===e}function bV(n,e){const t=TF(e);return TF(n).forEach(r=>{CI(t,r)||t.push(r)}),t}function xV(n,e){return TF(e).filter(t=>!CI(n,t))}class wV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=SF(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=EF(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Ff extends wV{get formDirective(){return null}get path(){return null}}class Ry extends wV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class CV{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let DF=(()=>{class n extends CV{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ry,2))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&nl("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Fo]})}return n})();const mE="VALID",SI="INVALID",N2="PENDING",AE="DISABLED";function EI(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class kF{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===mE}get invalid(){return this.status===SI}get pending(){return this.status==N2}get disabled(){return this.status===AE}get enabled(){return this.status!==AE}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(bV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(bV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(xV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(xV(e,this._rawAsyncValidators))}hasValidator(e){return CI(this._rawValidators,e)}hasAsyncValidator(e){return CI(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=N2,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=AE,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=mE,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===mE||this.status===N2)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?AE:mE}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=N2,this._hasOwnPendingAsyncValidator=!0;const t=hV(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new xs,this.statusChanges=new xs}_calculateStatus(){return this._allControlsDisabled()?AE:this.errors?SI:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(N2)?N2:this._anyControlsHaveStatus(SI)?SI:mE}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){EI(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Wde(n){return Array.isArray(n)?SF(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function jde(n){return Array.isArray(n)?EF(n):n||null}(this._rawAsyncValidators)}}const U2=new Mi("CallSetDisabledState",{providedIn:"root",factory:()=>TI}),TI="always";function gE(n,e,t=TI){(function OF(n,e){const t=function yV(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(_V(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function vV(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(_V(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();BI(e._rawValidators,r),BI(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function Yde(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&TV(n,e)})}(n,e),function Zde(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Kde(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&TV(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function Xde(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function BI(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function TV(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function BV(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function PV(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}Promise.resolve();const RV=class extends kF{constructor(e=null,t,i){super(function PF(n){return(EI(n)?n.validators:n)||null}(t),function RF(n,e){return(EI(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),EI(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=PV(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){BV(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){BV(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){PV(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},oue={provide:Ry,useExisting:Xt(()=>RI)},OV=Promise.resolve();let RI=(()=>{class n extends Ry{constructor(t,i,r,s,o,l){super(),this._changeDetectorRef=o,this.callSetDisabledState=l,this.control=new RV,this._registered=!1,this.name="",this.update=new xs,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function UF(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===MF?t=s:function tue(n){return Object.getPrototypeOf(n.constructor)===Mb}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function NF(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){gE(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){OV.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&ho(i);OV.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function DI(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ff,9),Vt(lu,10),Vt(Py,10),Vt(kf,10),Vt(vc,8),Vt(U2,8))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[mi.None,"disabled","isDisabled"],model:[mi.None,"ngModel","model"],options:[mi.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Po([oue]),Fo,Pl]})}return n})();const gue={provide:kf,useExisting:Xt(()=>qF),multi:!0};function qV(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let qF=(()=>{class n extends Mb{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=qV(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function _ue(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275dir=Sr({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&gi("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Po([gue]),Fo]})}return n})(),z2=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(qV(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(c),Vt(qF,9))};static#t=this.\u0275dir=Sr({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})();const yue={provide:kf,useExisting:Xt(()=>QF),multi:!0};function QV(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let QF=(()=>{class n extends Mb{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let l=0;l<o.length;l++){const u=this._getOptionValue(o[l].value);r.push(u)}}else{const o=i.options;for(let l=0;l<o.length;l++){const d=o[l];if(d.selected){const u=this._getOptionValue(d.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function vue(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275dir=Sr({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&gi("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Po([yue]),Fo]})}return n})(),H2=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(QV(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(QV(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(c),Vt(QF,9))};static#t=this.\u0275dir=Sr({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})(),Due=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})(),Bue=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:U2,useValue:t.callSetDisabledState??TI}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Due]})}return n})();const Pue=["knob"],Rue=["valueIndicatorContainer"];function kue(n,e){if(1&n&&(en(0,"div",2,1)(2,"div",5)(3,"span",6),Ji(4),vn()()()),2&n){const t=br();qn(4),rg(t.valueIndicatorText)}}const Fue=["trackActive"],Oue=["*"];function Lue(n,e){if(1&n&&Er(0,"div"),2&n){const t=e.$implicit,i=e.$index,r=br(3);sA(0===t?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),uS("transform",r._calcTickMarkTransform(i))}}function Nue(n,e){1&n&&function W3(n,e,t,i,r,s,o,l,d,u,f,g,T){de("NgControlFlow");const B=void 0!==d,q=qi(),re=l?o.bind(q[ko][ml]):o,se=new fK(B,re);q[us+n]=se,Ss(n+1,e,t,i,r,s),B&&Ss(n+2,d,u,f,g,T)}(0,Lue,1,4,"div",8,g6),2&n&&function j3(n){const e=Je(null),t=kc();try{const i=qi(),r=i[Rr],s=i[t];if(void 0===s.liveCollection){const l=t+1,d=GP(i,l),u=qP(r,l);s.liveCollection=new pK(d,i,u)}else s.liveCollection.reset();const o=s.liveCollection;if(function uK(n,e,t){let i,r,s=0,o=n.length-1;if(Array.isArray(e)){let l=e.length-1;for(;s<=o&&s<=l;){const d=n.at(s),u=e[s],f=zP(s,d,s,u,t);if(0!==f){f<0&&n.updateValue(s,u),s++;continue}const g=n.at(o),T=e[l],B=zP(o,g,l,T,t);if(0!==B){B<0&&n.updateValue(o,T),o--,l--;continue}const q=t(s,d),re=t(o,g),se=t(s,u);if(Object.is(se,re)){const ne=t(l,T);Object.is(ne,q)?(n.swap(s,o),n.updateValue(o,T),l--,o--):n.move(o,s),n.updateValue(s,u),s++}else if(i??=new A6,r??=m6(n,s,o,t),HP(n,i,s,se))n.updateValue(s,u),s++,o++;else if(r.has(se))i.set(q,n.detach(s)),o--;else{const ne=n.create(s,e[s]);n.attach(s,ne),s++,o++}}for(;s<=l;)p6(n,i,t,s,e[s]),s++}else if(null!=e){const l=e[Symbol.iterator]();let d=l.next();for(;!d.done&&s<=o;){const u=n.at(s),f=d.value,g=zP(s,u,s,f,t);if(0!==g)g<0&&n.updateValue(s,f),s++,d=l.next();else{i??=new A6,r??=m6(n,s,o,t);const T=t(s,f);if(HP(n,i,s,T))n.updateValue(s,f),s++,o++,d=l.next();else if(r.has(T)){const B=t(s,u);i.set(B,n.detach(s)),o--}else n.attach(s,n.create(s,f)),s++,o++,d=l.next()}}for(;!d.done;)p6(n,i,t,n.length,d.value),d=l.next()}for(;s<=o;)n.destroy(n.detach(o--));i?.forEach(l=>{n.destroy(l)})}(o,n,s.trackByFn),o.updateIndexes(),s.hasEmptyBlock){const l=dh(),d=0===o.length;if(zd(i,l,d)){const u=t+2,f=GP(i,u);if(d){const g=qP(r,u),T=eb(f,g.tView.ssrId);y0(f,Ay(i,g,void 0,{dehydratedView:T}),0,N_(g,T))}else Xv(f,0)}}}finally{Je(e)}}(br(2)._tickMarks)}function Uue(n,e){if(1&n&&(en(0,"div",6,1),Ss(2,Nue,2,0),vn()),2&n){const t=br();qn(2),V_(2,t._cachedWidth?2:-1)}}function zue(n,e){if(1&n&&Er(0,"mat-slider-visual-thumb",7),2&n){const t=br();Qn("discrete",t.discrete)("thumbPosition",1)("valueIndicatorText",t.startValueIndicatorText)}}var zo=function(n){return n[n.START=1]="START",n[n.END=2]="END",n}(zo||{}),V2=function(n){return n[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE",n}(V2||{});const FI=new Mi("_MatSlider"),eG=new Mi("_MatSliderThumb"),tG=new Mi("_MatSliderRangeThumb"),nG=new Mi("_MatSliderVisualThumb");let Hue=(()=>{class n{constructor(t,i,r,s){this._cdr=t,this._ngZone=i,this._slider=s,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=li(od),this._onPointerMove=o=>{if(this._sliderInput._isFocused)return;const l=this._hostElement.getBoundingClientRect(),d=this._slider._isCursorOnSliderThumb(o,l);this._isHovered=d,d?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=o=>{0===o.button&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=r.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;const t=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{t.addEventListener("pointermove",this._onPointerMove),t.addEventListener("pointerdown",this._onDragStart),t.addEventListener("pointerup",this._onDragEnd),t.addEventListener("pointerleave",this._onMouseLeave),t.addEventListener("focus",this._onFocus),t.addEventListener("blur",this._onBlur)})}ngOnDestroy(){const t=this._sliderInputEl;t&&(t.removeEventListener("pointermove",this._onPointerMove),t.removeEventListener("pointerdown",this._onDragStart),t.removeEventListener("pointerup",this._onDragEnd),t.removeEventListener("pointerleave",this._onMouseLeave),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(t){return t?.state===bp.FADING_IN||t?.state===bp.VISIBLE}_showRipple(t,i){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===zo.START?zo.END:zo.START)._showValueIndicator(),!this._slider._globalRippleOptions?.disabled||i))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:t,centered:!0,persistent:!0})}_hideRipple(t){if(t?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();const i=this._getSibling();i._isShowingAnyRipple()||(this._hideValueIndicator(),i._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===zo.START?zo.END:zo.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(vc),Vt(Be),Vt(Ws),Vt(FI))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(i,r){if(1&i&&(vl(O0,5),vl(Pue,5),vl(Rue,5)),2&i){let s;ia(s=ra())&&(r._ripple=s.first),ia(s=ra())&&(r._knob=s.first),ia(s=ra())&&(r._valueIndicatorContainer=s.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[Po([{provide:nG,useExisting:n}]),rd],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(i,r){1&i&&(Ss(0,kue,5,1,"div",2),Er(1,"div",3,0)(3,"div",4)),2&i&&(V_(0,r.discrete?0:-1),qn(3),Qn("matRippleDisabled",!0))},dependencies:[O0],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}return n})(),jF=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t;const i=this._getInput(zo.END),r=this._getInput(zo.START);i&&(i.disabled=this._disabled),r&&(r.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(t){this._discrete=t,this._updateValueIndicatorUIs()}get min(){return this._min}set min(t){const i=isNaN(t)?this._min:t;this._min!==i&&this._updateMin(i)}_updateMin(t){const i=this._min;this._min=t,this._isRange?this._updateMinRange({old:i,new:t}):this._updateMinNonRange(t),this._onMinMaxOrStepChange()}_updateMinRange(t){const i=this._getInput(zo.END),r=this._getInput(zo.START),s=i.value,o=r.value;r.min=t.new,i.min=Math.max(t.new,r.value),r.max=Math.min(i.max,i.value),r._updateWidthInactive(),i._updateWidthInactive(),t.new<t.old?this._onTranslateXChangeBySideEffect(i,r):this._onTranslateXChangeBySideEffect(r,i),s!==i.value&&this._onValueChange(i),o!==r.value&&this._onValueChange(r)}_updateMinNonRange(t){const i=this._getInput(zo.END);if(i){const r=i.value;i.min=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get max(){return this._max}set max(t){const i=isNaN(t)?this._max:t;this._max!==i&&this._updateMax(i)}_updateMax(t){const i=this._max;this._max=t,this._isRange?this._updateMaxRange({old:i,new:t}):this._updateMaxNonRange(t),this._onMinMaxOrStepChange()}_updateMaxRange(t){const i=this._getInput(zo.END),r=this._getInput(zo.START),s=i.value,o=r.value;i.max=t.new,r.max=Math.min(t.new,i.value),i.min=r.value,i._updateWidthInactive(),r._updateWidthInactive(),t.new>t.old?this._onTranslateXChangeBySideEffect(r,i):this._onTranslateXChangeBySideEffect(i,r),s!==i.value&&this._onValueChange(i),o!==r.value&&this._onValueChange(r)}_updateMaxNonRange(t){const i=this._getInput(zo.END);if(i){const r=i.value;i.max=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get step(){return this._step}set step(t){const i=isNaN(t)?this._step:t;this._step!==i&&this._updateStep(i)}_updateStep(t){this._step=t,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){const t=this._getInput(zo.END),i=this._getInput(zo.START),r=t.value,s=i.value,o=i.value;t.min=this._min,i.max=this._max,t.step=this._step,i.step=this._step,this._platform.SAFARI&&(t.value=t.value,i.value=i.value),t.min=Math.max(this._min,i.value),i.max=Math.min(this._max,t.value),i._updateWidthInactive(),t._updateWidthInactive(),t.value<o?this._onTranslateXChangeBySideEffect(i,t):this._onTranslateXChangeBySideEffect(t,i),r!==t.value&&this._onValueChange(t),s!==i.value&&this._onValueChange(i)}_updateStepNonRange(){const t=this._getInput(zo.END);if(t){const i=t.value;t.step=this._step,this._platform.SAFARI&&(t.value=t.value),t._updateThumbUIByValue(),i!==t.value&&this._onValueChange(t)}}constructor(t,i,r,s,o,l){this._ngZone=t,this._cdr=i,this._elementRef=r,this._dir=s,this._globalRippleOptions=o,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=d=>`${d}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=li(od),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations="NoopAnimations"===l,this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl="rtl"===this._dir.value}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();const t=this._getInput(zo.END),i=this._getInput(zo.START);this._isRange=!!t&&!!i,this._cdr.detectChanges();const r=this._getThumb(zo.END);this._rippleRadius=r._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(t,i):this._initUINonRange(t),this._updateTrackUI(t),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(t){t.initProps(),t.initUI(),this._updateValueIndicatorUI(t),this._hasViewInitialized=!0,t._updateThumbUIByValue()}_initUIRange(t,i){t.initProps(),t.initUI(),i.initProps(),i.initUI(),t._updateMinMax(),i._updateMinMax(),t._updateStaticStyles(),i._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,t._updateThumbUIByValue(),i._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl="rtl"===this._dir.value,this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){const t=this._getInput(zo.END),i=this._getInput(zo.START);t._setIsLeftThumb(),i._setIsLeftThumb(),t.translateX=t._calcTranslateXByValue(),i.translateX=i._calcTranslateXByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateWidthInactive(),i._updateWidthInactive(),t._updateThumbUIByValue(),i._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(zo.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(zo.START)._isActive||this._getThumb(zo.END)._isActive}_getValue(t=zo.END){const i=this._getInput(t);return i?i.value:this.min}_skipUpdate(){return!(!this._getInput(zo.START)?._skipUIUpdate&&!this._getInput(zo.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(t){const i=this._trackActive.nativeElement.style;i.left=t.left,i.right=t.right,i.transformOrigin=t.transformOrigin,i.transform=t.transform}_calcTickMarkTransform(t){return`translateX(${t*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(t){this._hasViewInitialized&&(this._updateThumbUI(t),this._updateTrackUI(t),this._updateOverlappingThumbUI(t))}_onTranslateXChangeBySideEffect(t,i){this._hasViewInitialized&&(t._updateThumbUIByValue(),i._updateThumbUIByValue())}_onValueChange(t){this._hasViewInitialized&&(this._updateValueIndicatorUI(t),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){const t=this._getInput(zo.END),i=this._getInput(zo.START);t._updateThumbUIByValue(),i._updateThumbUIByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateMinMax(),i._updateMinMax(),t._updateWidthInactive(),i._updateWidthInactive()}else{const t=this._getInput(zo.END);t&&t._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){const t=this._getInput(zo.START),i=this._getInput(zo.END);return!(!t||!i)&&i.translateX-t.translateX<20}_updateOverlappingThumbClassNames(t){const i=t.getSibling(),r=this._getThumb(t.thumbPosition);this._getThumb(i.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),r._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(t){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(t))}_updateThumbUI(t){this._skipUpdate()||(this._getThumb(t.thumbPosition===zo.END?zo.END:zo.START)._hostElement.style.transform=`translateX(${t.translateX}px)`)}_updateValueIndicatorUI(t){if(this._skipUpdate())return;const i=this.displayWith(t.value);if(this._hasViewInitialized?t._valuetext.set(i):t._hostElement.setAttribute("aria-valuetext",i),this.discrete){t.thumbPosition===zo.START?this.startValueIndicatorText=i:this.endValueIndicatorText=i;const r=this._getThumb(t.thumbPosition);i.length<3?r._hostElement.classList.add("mdc-slider__thumb--short-value"):r._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){const t=this._getInput(zo.END),i=this._getInput(zo.START);t&&this._updateValueIndicatorUI(t),i&&this._updateValueIndicatorUI(i)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;const t=this._step&&this._step>0?this._step:1,r=(Math.floor(this.max/t)*t-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*r-6}_updateTrackUI(t){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(t):this._updateTrackUINonRange(t))}_updateTrackUIRange(t){const i=t.getSibling();if(!i||!this._cachedWidth)return;const r=Math.abs(i.translateX-t.translateX)/this._cachedWidth;this._setTrackActiveStyles(t._isLeftThumb&&this._cachedWidth?{left:"auto",right:this._cachedWidth-i.translateX+"px",transformOrigin:"right",transform:`scaleX(${r})`}:{left:`${i.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${r})`})}_updateTrackUINonRange(t){this._setTrackActiveStyles(this._isRtl?{left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-t.fillPercentage})`}:{left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${t.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||void 0===this.step||void 0===this.min||void 0===this.max)return;const t=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(t):this._updateTickMarkUINonRange(t),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(t){const i=this._getValue();let r=Math.max(Math.floor((i-this.min)/t),0),s=Math.max(Math.floor((this.max-i)/t),0);this._isRtl?r++:s++,this._tickMarks=Array(r).fill(V2.ACTIVE).concat(Array(s).fill(V2.INACTIVE))}_updateTickMarkUIRange(t){const i=this._getValue(),r=this._getValue(zo.START),s=Math.max(Math.floor((r-this.min)/t),0),o=Math.max(Math.floor((i-r)/t)+1,0),l=Math.max(Math.floor((this.max-i)/t),0);this._tickMarks=Array(s).fill(V2.INACTIVE).concat(Array(o).fill(V2.ACTIVE),Array(l).fill(V2.INACTIVE))}_getInput(t){return t===zo.END&&this._input?this._input:this._inputs?.length?t===zo.START?this._inputs.first:this._inputs.last:void 0}_getThumb(t){return t===zo.END?this._thumbs?.last:this._thumbs?.first}_setTransition(t){this._hasAnimation=!this._platform.IOS&&t&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(t,i){const r=i.width/2,d=t.clientY-(i.y+r);return Math.pow(t.clientX-(i.x+r),2)+Math.pow(d,2)<Math.pow(r,2)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Be),Vt(vc),Vt(Ws),Vt(mm,8),Vt(bF,8),Vt(Fd,8))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-slider"]],contentQueries:function(i,r,s){if(1&i&&(vp(s,eG,5),vp(s,tG,4)),2&i){let o;ia(o=ra())&&(r._input=o.first),ia(o=ra())&&(r._inputs=o)}},viewQuery:function(i,r){if(1&i&&(vl(Fue,5),vl(nG,5)),2&i){let s;ia(s=ra())&&(r._trackActive=s.first),ia(s=ra())&&(r._thumbs=s)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(i,r){2&i&&(sA("mat-"+(r.color||"primary")),nl("mdc-slider--range",r._isRange)("mdc-slider--disabled",r.disabled)("mdc-slider--discrete",r.discrete)("mdc-slider--tick-marks",r.showTickMarks)("_mat-animation-noopable",r._noopAnimations))},inputs:{disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",ho],discrete:[mi.HasDecoratorInputTransform,"discrete","discrete",ho],showTickMarks:[mi.HasDecoratorInputTransform,"showTickMarks","showTickMarks",ho],min:[mi.HasDecoratorInputTransform,"min","min",tu],color:"color",disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",ho],max:[mi.HasDecoratorInputTransform,"max","max",tu],step:[mi.HasDecoratorInputTransform,"step","step",tu],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[Po([{provide:FI,useExisting:n}]),Wl,rd],ngContentSelectors:Oue,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(i,r){1&i&&(vh(),eu(0),en(1,"div",2),Er(2,"div",3),en(3,"div",4),Er(4,"div",5,0),vn(),Ss(6,Uue,3,1,"div",6),vn(),Ss(7,zue,1,3,"mat-slider-visual-thumb",7),Er(8,"mat-slider-visual-thumb",7)),2&i&&(qn(6),V_(6,r.showTickMarks?6:-1),qn(),V_(7,r._isRange?7:-1),qn(),Qn("discrete",r.discrete)("thumbPosition",2)("valueIndicatorText",r.endValueIndicatorText))},dependencies:[Hue],styles:['.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{overflow:hidden}.mdc-slider .mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:50%;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:translateX(-50%);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:translateX(-50%);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__thumb{display:flex;left:-24px;outline:none;position:absolute;user-select:none;height:48px;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-sizing:border-box;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;pointer-events:none;position:absolute;top:2px;width:44px}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;margin-left:8px;margin-right:8px;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider .mdc-slider__thumb-knob{background-color:var(--mdc-slider-handle-color);border-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color);border-color:var(--mdc-slider-disabled-handle-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb::before,.mat-mdc-slider .mdc-slider__thumb::after{background-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover::before,.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:var(--mdc-ripple-hover-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:var(--mdc-ripple-focus-opacity)}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__track--active_fill{border-color:var(--mdc-slider-active-track-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color)}.mat-mdc-slider .mdc-slider__track--inactive{background-color:var(--mdc-slider-inactive-track-color);opacity:.24}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color);opacity:.24}.mat-mdc-slider .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-inactive-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-disabled-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider .mdc-slider__value-indicator{background-color:var(--mdc-slider-label-container-color);opacity:1}.mat-mdc-slider .mdc-slider__value-indicator::before{border-top-color:var(--mdc-slider-label-container-color)}.mat-mdc-slider .mdc-slider__value-indicator{color:var(--mdc-slider-label-label-text-color)}.mat-mdc-slider .mdc-slider__track{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__track--active{height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height)) / 2)}.mat-mdc-slider .mdc-slider__track--active_fill{border-top-width:var(--mdc-slider-active-track-height)}.mat-mdc-slider .mdc-slider__track--inactive{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{height:var(--mdc-slider-with-tick-marks-container-size);width:var(--mdc-slider-with-tick-marks-container-size)}.mat-mdc-slider.mdc-slider--disabled{opacity:0.38}.mat-mdc-slider .mdc-slider__value-indicator-text{letter-spacing:var(--mdc-slider-label-label-text-tracking);font-size:var(--mdc-slider-label-label-text-size);font-family:var(--mdc-slider-label-label-text-font);font-weight:var(--mdc-slider-label-label-text-weight);line-height:var(--mdc-slider-label-label-text-line-height)}.mat-mdc-slider .mdc-slider__track--active{border-radius:var(--mdc-slider-active-track-shape)}.mat-mdc-slider .mdc-slider__track--inactive{border-radius:var(--mdc-slider-inactive-track-shape)}.mat-mdc-slider .mdc-slider__thumb-knob{border-radius:var(--mdc-slider-handle-shape);width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-style:solid;border-width:calc(var(--mdc-slider-handle-height) / 2) calc(var(--mdc-slider-handle-width) / 2)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{border-radius:var(--mdc-slider-with-tick-marks-container-shape)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color);border-color:var(--mdc-slider-hover-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color);border-color:var(--mdc-slider-focus-handle-color)}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:var(--mdc-slider-with-overlap-handle-outline-color);border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mat-mdc-slider .mdc-slider__thumb-knob{box-shadow:var(--mdc-slider-handle-elevation)}.mat-mdc-slider .mdc-slider__input{box-sizing:content-box;pointer-events:auto}.mat-mdc-slider .mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mat-mdc-slider .mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mdc-slider__track,.mat-mdc-slider .mdc-slider__thumb{pointer-events:none}.mat-mdc-slider .mdc-slider__value-indicator-container{transform:var(--mat-slider-value-indicator-container-transform)}.mat-mdc-slider .mdc-slider__value-indicator{width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mat-mdc-slider .mdc-slider__value-indicator::before{display:var(--mat-slider-value-indicator-caret-display)}.mat-mdc-slider .mdc-slider__value-indicator-text{width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform)}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slider .mdc-slider__value-indicator{word-break:normal}.mat-mdc-slider .mdc-slider__value-indicator-text{text-align:center}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})();const Gue={provide:kf,useExisting:Xt(()=>yE),multi:!0};let yE=(()=>{class n{get value(){return tu(this._hostElement.value,0)}set value(t){const i=(t=isNaN(t)?0:t)+"";this._hasSetInitialValue?this._isActive||this._setValue(i):this._initialValue=i}_setValue(t){this._hostElement.value=t,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(void 0===this._translateX&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(t){this._translateX=t}get min(){return tu(this._hostElement.min,0)}set min(t){this._hostElement.min=t+"",this._cdr.detectChanges()}get max(){return tu(this._hostElement.max,0)}set max(t){this._hostElement.max=t+"",this._cdr.detectChanges()}get step(){return tu(this._hostElement.step,0)}set step(t){this._hostElement.step=t+"",this._cdr.detectChanges()}get disabled(){return ho(this._hostElement.disabled)}set disabled(t){this._hostElement.disabled=t,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?0===this._translateX?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(t){this._isFocused=t}constructor(t,i,r,s){this._ngZone=t,this._elementRef=i,this._cdr=r,this._slider=s,this.valueChange=new xs,this.dragStart=new xs,this.dragEnd=new xs,this.thumbPosition=zo.END,this._valuetext=rS(""),this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new xt,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=li(od),this._hostElement=i.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,void 0===this._initialValue?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(t){if(!this.disabled&&0===t.button){if(this._platform.IOS){const i=this._slider._isCursorOnSliderThumb(t,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());return this._isActive=i,this._updateWidthActive(),void this._slider._updateDimensions()}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(t,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(t),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(t){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(t)},0)}_fixValue(t){const i=t.clientX-this._slider._cachedLeft,r=this._slider._cachedWidth,s=0===this._slider.step?1:this._slider.step,o=Math.floor((this._slider.max-this._slider.min)/s),u=Math.round((this._slider._isRtl?1-i/r:i/r)*o)/o*(this._slider.max-this._slider.min)+this._slider.min,f=Math.round(u/s)*s;if(f===this.value)return this._slider._onValueChange(this),void(this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation}));this.value=f,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation})}_onPointerMove(t){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(t)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(t){const i=this._tickMarkOffset;return Math.max(Math.min(t,this._slider._cachedWidth-this._tickMarkOffset),i)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset}_calcTranslateXByPointerEvent(t){return t.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-2*this._tickMarkOffset}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(t){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(t)}_updateThumbUIByPointerEvent(t,i){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(t)),this._updateThumbUI(i)}_updateThumbUI(t){this._slider._setTransition(!!t?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(t){(this._isControlInitialized||null!==t)&&(this.value=t)}registerOnChange(t){this._onChangeFn=t,this._isControlInitialized=!0}registerOnTouched(t){this._onTouchedFn=t}setDisabledState(t){this.disabled=t}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Be),Vt(Ws),Vt(vc),Vt(FI))};static#t=this.\u0275dir=Sr({type:n,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(i,r){1&i&&gi("change",function(){return r._onChange()})("input",function(){return r._onInput()})("blur",function(){return r._onBlur()})("focus",function(){return r._onFocus()}),2&i&&ol("aria-valuetext",r._valuetext())},inputs:{value:[mi.HasDecoratorInputTransform,"value","value",tu]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[Po([Gue,{provide:eG,useExisting:n}]),Wl]})}return n})(),Wue=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Gd,bI]})}return n})();const jue=["mat-button",""],$ue=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Xue=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Jue=new Mi("MAT_BUTTON_CONFIG"),ehe=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}];let iG=(()=>{class n{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=t,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._updateRippleDisabled()}constructor(t,i,r,s){this._elementRef=t,this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=li(K_),this._rippleLoader=li(Fde),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;const o=li(Jue,{optional:!0}),l=t.nativeElement,d=l.classList;this.disabledInteractive=o?.disabledInteractive??!1,this._rippleLoader?.configureRipple(l,{className:"mat-mdc-button-ripple"});for(const{attribute:u,mdcClasses:f}of ehe)l.hasAttribute(u)&&d.add(...f)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){UM()};static#t=this.\u0275dir=Sr({type:n,inputs:{color:"color",disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",ho],disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",ho],ariaDisabled:[mi.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",ho],disabledInteractive:[mi.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",ho]},features:[Wl]})}return n})(),G2=(()=>{class n extends iG{constructor(t,i,r,s){super(t,i,r,s)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(od),Vt(Be),Vt(Fd,8))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,r){2&i&&(ol("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),sA(r.color?"mat-"+r.color:""),nl("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Fo,rd],attrs:jue,ngContentSelectors:Xue,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(vh($ue),Er(0,"span",0),eu(1),en(2,"span",1),eu(3,1),vn(),eu(4,2),Er(5,"span",2)(6,"span",3)),2&i&&nl("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return n})(),ihe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Gd,bI,Gd]})}return n})();const rhe=["switch"],she=["*"];function ohe(n,e){1&n&&(en(0,"div",10),Ul(),en(1,"svg",12),Er(2,"path",13),vn(),en(3,"svg",14),Er(4,"path",15),vn()())}const ahe=new Mi("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1})}),lhe={provide:kf,useExisting:Xt(()=>$F),multi:!0};class rG{constructor(e,t){this.source=e,this.checked=t}}let che=0,$F=(()=>{class n{_createChangeEvent(t){return new rG(this,t)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,l){this._elementRef=t,this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=d=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new xs,this.toggleChange=new xs,this.tabIndex=parseInt(s)||0,this.color=o.color||"accent",this._noopAnimations="NoopAnimations"===l,this.id=this._uniqueId="mat-mdc-slide-toggle-"+ ++che,this.hideIcon=o.hideIcon??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?(this._focused=!0,this._changeDetectorRef.markForCheck()):t||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(t){t.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorOnChange=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new rG(this,this.checked)))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(K_),Vt(vc),_u("tabindex"),Vt(ahe),Vt(Fd,8))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(i,r){if(1&i&&vl(rhe,5),2&i){let s;ia(s=ra())&&(r._switchElement=s.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(i,r){2&i&&(a2("id",r.id),ol("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),sA(r.color?"mat-"+r.color:""),nl("mat-mdc-slide-toggle-focused",r._focused)("mat-mdc-slide-toggle-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],required:[mi.HasDecoratorInputTransform,"required","required",ho],color:"color",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",ho],disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",ho],tabIndex:[mi.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>null==t?0:tu(t)],checked:[mi.HasDecoratorInputTransform,"checked","checked",ho],hideIcon:[mi.HasDecoratorInputTransform,"hideIcon","hideIcon",ho]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[Po([lhe,{provide:lu,useExisting:n,multi:!0}]),Wl,Pl,rd],ngContentSelectors:she,decls:13,vars:24,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(i,r){if(1&i){const s=Uo();vh(),en(0,"div",1)(1,"button",2,0),gi("click",function(){return vi(s),bi(r._handleClick())}),Er(3,"div",3),en(4,"div",4)(5,"div",5)(6,"div",6),Er(7,"div",7),vn(),en(8,"div",8),Er(9,"div",9),vn(),Ss(10,ohe,5,0,"div",10),vn()()(),en(11,"label",11),gi("click",function(l){return vi(s),bi(l.stopPropagation())}),eu(12),vn()()}if(2&i){const s=qa(2);Qn("labelPosition",r.labelPosition),qn(),nl("mdc-switch--selected",r.checked)("mdc-switch--unselected",!r.checked)("mdc-switch--checked",r.checked)("mdc-switch--disabled",r.disabled),Qn("tabIndex",r.disabled?-1:r.tabIndex)("disabled",r.disabled),ol("id",r.buttonId)("name",r.name)("aria-label",r.ariaLabel)("aria-labelledby",r._getAriaLabelledBy())("aria-describedby",r.ariaDescribedby)("aria-required",r.required||null)("aria-checked",r.checked),qn(8),Qn("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),qn(),V_(10,r.hideIcon?-1:10),qn(),Qn("for",r.buttonId),ol("id",r._labelId)}},dependencies:[O0,CF],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--mdc-elevation-overlay-color)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch[hidden]{display:none}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}.mdc-switch{width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color)}.mdc-switch .mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation)}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:var(--mdc-switch-handle-height)}.mdc-switch .mdc-switch__handle{border-radius:var(--mdc-switch-handle-shape)}.mdc-switch .mdc-switch__handle{width:var(--mdc-switch-handle-width)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - var(--mdc-switch-handle-width))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:var(--mdc-switch-selected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:var(--mdc-switch-unselected-icon-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-hover-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-focus-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-pressed-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-hover-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-focus-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-pressed-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-selected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-selected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-unselected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-unselected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch .mdc-switch__ripple{height:var(--mdc-switch-state-layer-size);width:var(--mdc-switch-state-layer-size)}.mdc-switch .mdc-switch__track{height:var(--mdc-switch-track-height)}.mdc-switch:disabled .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch:enabled .mdc-switch__track::after{background:var(--mdc-switch-selected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color)}.mdc-switch:enabled .mdc-switch__track::before{background:var(--mdc-switch-unselected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color)}.mdc-switch .mdc-switch__track{border-radius:var(--mdc-switch-track-shape)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mat-mdc-slide-toggle{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle .mdc-switch__ripple::after{content:"";opacity:0}.mat-mdc-slide-toggle .mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:opacity 75ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-elevation-overlay,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mdc-switch__handle{transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle:active .mdc-switch:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--selected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--unselected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch__track::after,.mdc-switch__track::before{border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color)}.mdc-switch--selected .mdc-switch__track::after,.mdc-switch--selected .mdc-switch__track::before{border-width:var(--mat-switch-selected-track-outline-width)}.mdc-switch--disabled .mdc-switch__track::after,.mdc-switch--disabled .mdc-switch__track::before{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}'],encapsulation:2,changeDetection:0})}return n})(),hhe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[$F,Gd,Gd]})}return n})();const fhe=["input"],phe=["label"],mhe=["*"],Ahe=new Mi("mat-checkbox-default-options",{providedIn:"root",factory:sG});function sG(){return{color:"accent",clickAction:"check-indeterminate"}}var Wh=function(n){return n[n.Init=0]="Init",n[n.Checked=1]="Checked",n[n.Unchecked=2]="Unchecked",n[n.Indeterminate=3]="Indeterminate",n}(Wh||{});const ghe={provide:kf,useExisting:Xt(()=>ky),multi:!0};class _he{}let yhe=0;const oG=sG();let ky=(()=>{class n{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){const i=new _he;return i.source=this,i.checked=t,i}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,l){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._animationMode=o,this._options=l,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new xs,this.indeterminateChange=new xs,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=Wh.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||oG,this.color=this._options.color||oG.color,this.tabIndex=parseInt(s)||0,this.id=this._uniqueId="mat-mdc-checkbox-"+ ++yhe}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){const i=t!=this._indeterminate;this._indeterminate=t,i&&(this._transitionCheckState(this._indeterminate?Wh.Indeterminate:this.checked?Wh.Checked:Wh.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let i=this._currentCheckState,r=this._getAnimationTargetElement();if(i!==t&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(i,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const t=this._options?.clickAction;this.disabled||"noop"===t?!this.disabled&&"noop"===t&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==t&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?Wh.Checked:Wh.Unchecked),this._emitChangeEvent())}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,i){if("NoopAnimations"===this._animationMode)return"";switch(t){case Wh.Init:if(i===Wh.Checked)return this._animationClasses.uncheckedToChecked;if(i==Wh.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case Wh.Unchecked:return i===Wh.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case Wh.Checked:return i===Wh.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case Wh.Indeterminate:return i===Wh.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){const i=this._inputElement;i&&(i.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(vc),Vt(Be),_u("tabindex"),Vt(Fd,8),Vt(Ahe,8))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-checkbox"]],viewQuery:function(i,r){if(1&i&&(vl(fhe,5),vl(phe,5),vl(O0,5)),2&i){let s;ia(s=ra())&&(r._inputElement=s.first),ia(s=ra())&&(r._labelElement=s.first),ia(s=ra())&&(r.ripple=s.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(i,r){2&i&&(a2("id",r.id),ol("tabindex",null)("aria-label",null)("aria-labelledby",null),sA(r.color?"mat-"+r.color:"mat-accent"),nl("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mdc-checkbox--disabled",r.disabled)("mat-mdc-checkbox-disabled",r.disabled)("mat-mdc-checkbox-checked",r.checked))},inputs:{ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],id:"id",required:[mi.HasDecoratorInputTransform,"required","required",ho],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",ho],tabIndex:[mi.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>null==t?void 0:tu(t)],color:"color",checked:[mi.HasDecoratorInputTransform,"checked","checked",ho],disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",ho],indeterminate:[mi.HasDecoratorInputTransform,"indeterminate","indeterminate",ho]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[Po([ghe,{provide:lu,useExisting:n,multi:!0}]),Wl,Pl,rd],ngContentSelectors:mhe,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const s=Uo();vh(),en(0,"div",3),gi("click",function(l){return vi(s),bi(r._preventBubblingFromLabel(l))}),en(1,"div",4,0)(3,"div",5),gi("click",function(){return vi(s),bi(r._onTouchTargetClick())}),vn(),en(4,"input",6,1),gi("blur",function(){return vi(s),bi(r._onBlur())})("click",function(){return vi(s),bi(r._onInputClick())})("change",function(l){return vi(s),bi(r._onInteractionEvent(l))}),vn(),Er(6,"div",7),en(7,"div",8),Ul(),en(8,"svg",9),Er(9,"path",10),vn(),kh(),Er(10,"div",11),vn(),Er(11,"div",12),vn(),en(12,"label",13,2),eu(14),vn()()}if(2&i){const s=qa(2);Qn("labelPosition",r.labelPosition),qn(4),nl("mdc-checkbox--selected",r.checked),Qn("checked",r.checked)("indeterminate",r.indeterminate)("disabled",r.disabled)("id",r.inputId)("required",r.required)("tabIndex",r.disabled?-1:r.tabIndex),ol("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-checked",r.indeterminate?"mixed":null)("name",r.name)("value",r.value),qn(7),Qn("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),qn(),Qn("for",r.inputId)}},dependencies:[O0,CF],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})(),xhe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[ky,Gd,Gd]})}return n})();var aG=Ee(6998),lG=(Ee(5680),Ee(9041),Ee(6224),Ee(1516),Ee(4149),Ee(1462),Ee(3190),Ee(4491)),cG=(Ee(6714),Ee(69),Ee(471));Ee(5983),Ee(7041),Ee(4779);var hg=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-hg.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*hg.Bounce.In(2*n):.5*hg.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),q2=function(){return performance.now()},dG=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=q2()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Eb={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Eb.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=Eb.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Eb.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Eb.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}}(),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),o=.5*(i-e),l=r*r;return(2*e-2*t+s+o)*(r*l)+(-3*e+3*t-2*s-o)*l+s*r+e}}},YF=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),KF=new dG,Of=function(){function n(e,t){void 0===t&&(t=KF),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=hg.Linear.None,this._interpolationFunction=Eb.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=YF.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=q2()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var l=e[o],d=Array.isArray(l),u=d?"array":typeof l,f=!d&&Array.isArray(i[o]);if("undefined"!==u&&"function"!==u){if(f){if(0===(g=i[o]).length)continue;for(var T=[l],B=0,q=g.length;B<q;B+=1){var re=this._handleRelativeValue(l,g[B]);if(isNaN(re)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}T.push(re)}f&&(i[o]=T)}if("object"!==u&&!d||!l||f)(typeof t[o]>"u"||s)&&(t[o]=l),d||(t[o]*=1),r[o]=f?i[o].slice().reverse():t[o]||0;else{t[o]=d?[]:{};var se=l;for(var ne in se)t[o][ne]=se[ne];r[o]=d?[]:{};var g=i[o];if(!this._isDynamic){var De={};for(var ne in g)De[ne]=g[ne];i[o]=g=De}this._setupProperties(se,t[o],g,r[o],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=q2()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=q2()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=KF),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=hg.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=Eb.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r,s,i=this;if(void 0===e&&(e=q2()),void 0===t&&(t=!0),this._isPaused)return!0;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=e-this._startTime,d=this._duration+(null!==(r=this._repeatDelayTime)&&void 0!==r?r:this._delayTime),u=this._duration+this._repeat*d,g=function(){if(0===i._duration||l>u)return 1;var se=Math.trunc(l/d),De=Math.min((l-se*d)/i._duration,1);return 0===De&&l===i._duration?1:De}(),T=this._easingFunction(g);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,T),this._onUpdateCallback&&this._onUpdateCallback(this._object,g),0===this._duration||l>=this._duration){if(this._repeat>0){var B=Math.min(Math.trunc((l-this._duration)/d)+1,this._repeat);for(s in isFinite(this._repeat)&&(this._repeat-=B),this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[s]&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=d*B,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var q=0,re=this._chainedTweens.length;q<re;q++)this._chainedTweens[q].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var o=t[s]||0,l=i[s],d=Array.isArray(e[s]),u=Array.isArray(l);!d&&u?e[s]=this._interpolationFunction(l,r):"object"==typeof l&&l?this._updateProperties(e[s],o,l,r):"number"==typeof(l=this._handleRelativeValue(o,l))&&(e[s]=o+(l-o)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),L0=KF,uG=(L0.getAll.bind(L0),L0.removeAll.bind(L0),L0.add.bind(L0),L0.remove.bind(L0),L0.update.bind(L0));const Q2="162",fG=1,Phe=2,Z_=3,LI=0,nfe=1,ife=2,Fy=0,rfe=1,sfe=2,ofe=3,afe=4,lfe=5,cfe=6,dfe=7,_G="attached",Oy=301,Ib=302,vE=306,Ly=1e3,bh=1001,$2=1002,gd=1003,Ny=1005,Nc=1006,X2=1007,fA=1008,Uy=1009,zy=1014,pA=1015,mA=1016,Bb=1020,wp=1023,Pb=1026,Y2=1027,K2=2300,Rb=2301,cu="srgb",Qu="srgb-linear",h5="display-p3",HI="display-p3-linear",VI="linear",Uc="srgb",GI="rec709",qI="p3",eC=7680,iq="300 es",e1=2e3;class t1{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const jh=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let rq=1234567;const Fb=Math.PI/180,tC=180/Math.PI;function Am(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(jh[255&n]+jh[n>>8&255]+jh[n>>16&255]+jh[n>>24&255]+"-"+jh[255&e]+jh[e>>8&255]+"-"+jh[e>>16&15|64]+jh[e>>24&255]+"-"+jh[63&t|128]+jh[t>>8&255]+"-"+jh[t>>16&255]+jh[t>>24&255]+jh[255&i]+jh[i>>8&255]+jh[i>>16&255]+jh[i>>24&255]).toLowerCase()}function _d(n,e,t){return Math.max(e,Math.min(t,n))}function p5(n,e){return(n%e+e)%e}function xE(n,e,t){return(1-t)*n+t*e}function m5(n){return!(n&n-1)&&0!==n}function jI(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Lf(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function wa(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const wE={DEG2RAD:Fb,RAD2DEG:tC,generateUUID:Am,clamp:_d,euclideanModulo:p5,mapLinear:function Pfe(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function Rfe(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:xE,damp:function kfe(n,e,t,i){return xE(n,e,1-Math.exp(-t*i))},pingpong:function Ffe(n,e=1){return e-Math.abs(p5(n,2*e)-e)},smoothstep:function Ofe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function Lfe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function Nfe(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function Ufe(n,e){return n+Math.random()*(e-n)},randFloatSpread:function zfe(n){return n*(.5-Math.random())},seededRandom:function Hfe(n){void 0!==n&&(rq=n);let e=rq+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function Vfe(n){return n*Fb},radToDeg:function Gfe(n){return n*tC},isPowerOfTwo:m5,ceilPowerOfTwo:function qfe(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},floorPowerOfTwo:jI,setQuaternionFromProperEuler:function Qfe(n,e,t,i,r){const s=Math.cos,o=Math.sin,l=s(t/2),d=o(t/2),u=s((e+i)/2),f=o((e+i)/2),g=s((e-i)/2),T=o((e-i)/2),B=s((i-e)/2),q=o((i-e)/2);switch(r){case"XYX":n.set(l*f,d*g,d*T,l*u);break;case"YZY":n.set(d*T,l*f,d*g,l*u);break;case"ZXZ":n.set(d*g,d*T,l*f,l*u);break;case"XZX":n.set(l*f,d*q,d*B,l*u);break;case"YXY":n.set(d*B,l*f,d*q,l*u);break;case"ZYZ":n.set(d*q,d*B,l*f,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:wa,denormalize:Lf};class Ni{constructor(e=0,t=0){Ni.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(_d(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ca{constructor(e,t,i,r,s,o,l,d,u){Ca.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,l,d,u)}set(e,t,i,r,s,o,l,d,u){const f=this.elements;return f[0]=e,f[1]=r,f[2]=l,f[3]=t,f[4]=s,f[5]=d,f[6]=i,f[7]=o,f[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],l=i[3],d=i[6],u=i[1],f=i[4],g=i[7],T=i[2],B=i[5],q=i[8],re=r[0],se=r[3],ne=r[6],De=r[1],Se=r[4],je=r[7],Dt=r[2],Mt=r[5],Bt=r[8];return s[0]=o*re+l*De+d*Dt,s[3]=o*se+l*Se+d*Mt,s[6]=o*ne+l*je+d*Bt,s[1]=u*re+f*De+g*Dt,s[4]=u*se+f*Se+g*Mt,s[7]=u*ne+f*je+g*Bt,s[2]=T*re+B*De+q*Dt,s[5]=T*se+B*Se+q*Mt,s[8]=T*ne+B*je+q*Bt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],l=e[5],d=e[6],u=e[7],f=e[8];return t*o*f-t*l*u-i*s*f+i*l*d+r*s*u-r*o*d}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],l=e[5],d=e[6],u=e[7],f=e[8],g=f*o-l*u,T=l*d-f*s,B=u*s-o*d,q=t*g+i*T+r*B;if(0===q)return this.set(0,0,0,0,0,0,0,0,0);const re=1/q;return e[0]=g*re,e[1]=(r*u-f*i)*re,e[2]=(l*i-r*o)*re,e[3]=T*re,e[4]=(f*t-r*d)*re,e[5]=(r*s-l*t)*re,e[6]=B*re,e[7]=(i*d-u*t)*re,e[8]=(o*t-i*s)*re,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,l){const d=Math.cos(s),u=Math.sin(s);return this.set(i*d,i*u,-i*(d*o+u*l)+o+e,-r*u,r*d,-r*(-u*o+d*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(A5.makeScale(e,t)),this}rotate(e){return this.premultiply(A5.makeRotation(-e)),this}translate(e,t){return this.premultiply(A5.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const A5=new Ca;function sq(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const Wfe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function nC(n,e){return new Wfe[n](e)}function CE(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function jfe(){const n=CE("canvas");return n.style.display="block",n}const oq={};function aq(n){n in oq||(oq[n]=!0,console.warn(n))}const lq=(new Ca).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),cq=(new Ca).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),$I={[Qu]:{transfer:VI,primaries:GI,toReference:n=>n,fromReference:n=>n},[cu]:{transfer:Uc,primaries:GI,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[HI]:{transfer:VI,primaries:qI,toReference:n=>n.applyMatrix3(cq),fromReference:n=>n.applyMatrix3(lq)},[h5]:{transfer:Uc,primaries:qI,toReference:n=>n.convertSRGBToLinear().applyMatrix3(cq),fromReference:n=>n.applyMatrix3(lq).convertLinearToSRGB()}},$fe=new Set([Qu,HI]),Hl={enabled:!0,_workingColorSpace:Qu,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!$fe.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,$I[t].fromReference)((0,$I[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return $I[n].primaries},getTransfer:function(n){return""===n?VI:$I[n].transfer}};function iC(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function g5(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let rC;class dq{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===rC&&(rC=CE("canvas")),rC.width=e.width,rC.height=e.height;const i=rC.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=rC}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=CE("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*iC(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*iC(t[i]/255)):iC(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Xfe=0;class Ob{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Xfe++}),this.uuid=Am(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,l=r.length;o<l;o++)s.push(_5(r[o].isDataTexture?r[o].image:r[o]))}else s=_5(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function _5(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?dq.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Yfe=0,$h=(()=>{class n extends t1{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=bh,s=bh,o=Nc,l=fA,d=wp,u=Uy,f=n.DEFAULT_ANISOTROPY,g=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Yfe++}),this.uuid=Am(),this.name="",this.source=new Ob(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=l,this.anisotropy=f,this.format=d,this.internalFormat=null,this.type=u,this.offset=new Ni(0,0),this.repeat=new Ni(1,1),this.center=new Ni(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ca,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ly:t.x=t.x-Math.floor(t.x);break;case bh:t.x=t.x<0?0:1;break;case $2:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ly:t.y=t.y-Math.floor(t.y);break;case bh:t.y=t.y<0?0:1;break;case $2:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class nc{constructor(e=0,t=0,i=0,r=1){nc.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const d=e.elements,u=d[0],f=d[4],g=d[8],T=d[1],B=d[5],q=d[9],re=d[2],se=d[6],ne=d[10];if(Math.abs(f-T)<.01&&Math.abs(g-re)<.01&&Math.abs(q-se)<.01){if(Math.abs(f+T)<.1&&Math.abs(g+re)<.1&&Math.abs(q+se)<.1&&Math.abs(u+B+ne-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Se=(u+1)/2,je=(B+1)/2,Dt=(ne+1)/2,Mt=(f+T)/4,Bt=(g+re)/4,Jt=(q+se)/4;return Se>je&&Se>Dt?Se<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(Se),r=Mt/i,s=Bt/i):je>Dt?je<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(je),i=Mt/r,s=Jt/r):Dt<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(Dt),i=Bt/s,r=Jt/s),this.set(i,r,s,t),this}let De=Math.sqrt((se-q)*(se-q)+(g-re)*(g-re)+(T-f)*(T-f));return Math.abs(De)<.001&&(De=1),this.x=(se-q)/De,this.y=(g-re)/De,this.z=(T-f)/De,this.w=Math.acos((u+B+ne-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Kfe extends t1{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new nc(0,0,e,t),this.scissorTest=!1,this.viewport=new nc(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Nc,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},i);const s=new $h(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let l=0;l<o;l++)this.textures[l]=s.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Ob(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Wu extends Kfe{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class y5 extends $h{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=gd,this.minFilter=gd,this.wrapR=bh,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class uq extends $h{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=gd,this.minFilter=gd,this.wrapR=bh,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class zc{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,l){let d=i[r+0],u=i[r+1],f=i[r+2],g=i[r+3];const T=s[o+0],B=s[o+1],q=s[o+2],re=s[o+3];if(0===l)return e[t+0]=d,e[t+1]=u,e[t+2]=f,void(e[t+3]=g);if(1===l)return e[t+0]=T,e[t+1]=B,e[t+2]=q,void(e[t+3]=re);if(g!==re||d!==T||u!==B||f!==q){let se=1-l;const ne=d*T+u*B+f*q+g*re,De=ne>=0?1:-1,Se=1-ne*ne;if(Se>Number.EPSILON){const Dt=Math.sqrt(Se),Mt=Math.atan2(Dt,ne*De);se=Math.sin(se*Mt)/Dt,l=Math.sin(l*Mt)/Dt}const je=l*De;if(d=d*se+T*je,u=u*se+B*je,f=f*se+q*je,g=g*se+re*je,se===1-l){const Dt=1/Math.sqrt(d*d+u*u+f*f+g*g);d*=Dt,u*=Dt,f*=Dt,g*=Dt}}e[t]=d,e[t+1]=u,e[t+2]=f,e[t+3]=g}static multiplyQuaternionsFlat(e,t,i,r,s,o){const l=i[r],d=i[r+1],u=i[r+2],f=i[r+3],g=s[o],T=s[o+1],B=s[o+2],q=s[o+3];return e[t]=l*q+f*g+d*B-u*T,e[t+1]=d*q+f*T+u*g-l*B,e[t+2]=u*q+f*B+l*T-d*g,e[t+3]=f*q-l*g-d*T-u*B,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,l=Math.cos,d=Math.sin,u=l(i/2),f=l(r/2),g=l(s/2),T=d(i/2),B=d(r/2),q=d(s/2);switch(o){case"XYZ":this._x=T*f*g+u*B*q,this._y=u*B*g-T*f*q,this._z=u*f*q+T*B*g,this._w=u*f*g-T*B*q;break;case"YXZ":this._x=T*f*g+u*B*q,this._y=u*B*g-T*f*q,this._z=u*f*q-T*B*g,this._w=u*f*g+T*B*q;break;case"ZXY":this._x=T*f*g-u*B*q,this._y=u*B*g+T*f*q,this._z=u*f*q+T*B*g,this._w=u*f*g-T*B*q;break;case"ZYX":this._x=T*f*g-u*B*q,this._y=u*B*g+T*f*q,this._z=u*f*q-T*B*g,this._w=u*f*g+T*B*q;break;case"YZX":this._x=T*f*g+u*B*q,this._y=u*B*g+T*f*q,this._z=u*f*q-T*B*g,this._w=u*f*g-T*B*q;break;case"XZY":this._x=T*f*g-u*B*q,this._y=u*B*g-T*f*q,this._z=u*f*q+T*B*g,this._w=u*f*g+T*B*q;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],l=t[5],d=t[9],u=t[2],f=t[6],g=t[10],T=i+l+g;if(T>0){const B=.5/Math.sqrt(T+1);this._w=.25/B,this._x=(f-d)*B,this._y=(s-u)*B,this._z=(o-r)*B}else if(i>l&&i>g){const B=2*Math.sqrt(1+i-l-g);this._w=(f-d)/B,this._x=.25*B,this._y=(r+o)/B,this._z=(s+u)/B}else if(l>g){const B=2*Math.sqrt(1+l-i-g);this._w=(s-u)/B,this._x=(r+o)/B,this._y=.25*B,this._z=(d+f)/B}else{const B=2*Math.sqrt(1+g-i-l);this._w=(o-r)/B,this._x=(s+u)/B,this._y=(d+f)/B,this._z=.25*B}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(_d(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,l=t._x,d=t._y,u=t._z,f=t._w;return this._x=i*f+o*l+r*u-s*d,this._y=r*f+o*d+s*l-i*u,this._z=s*f+o*u+i*d-r*l,this._w=o*f-i*l-r*d-s*u,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let l=o*e._w+i*e._x+r*e._y+s*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const d=1-l*l;if(d<=Number.EPSILON){const B=1-t;return this._w=B*o+t*this._w,this._x=B*i+t*this._x,this._y=B*r+t*this._y,this._z=B*s+t*this._z,this.normalize(),this}const u=Math.sqrt(d),f=Math.atan2(u,l),g=Math.sin((1-t)*f)/u,T=Math.sin(t*f)/u;return this._w=o*g+this._w*T,this._x=i*g+this._x*T,this._y=r*g+this._y*T,this._z=s*g+this._z*T,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Rt{constructor(e=0,t=0,i=0){Rt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(hq.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(hq.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,l=e.z,d=e.w,u=2*(o*r-l*i),f=2*(l*t-s*r),g=2*(s*i-o*t);return this.x=t+d*u+o*g-l*f,this.y=i+d*f+l*u-s*g,this.z=r+d*g+s*f-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,l=t.y,d=t.z;return this.x=r*d-s*l,this.y=s*o-i*d,this.z=i*l-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return v5.copy(this).projectOnVector(e),this.sub(v5)}reflect(e){return this.sub(v5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(_d(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const v5=new Rt,hq=new zc;class Nf{constructor(e=new Rt(1/0,1/0,1/0),t=new Rt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(pg.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(pg.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=pg.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const s=i.getAttribute("position");if(!0===t&&void 0!==s&&!0!==e.isInstancedMesh)for(let o=0,l=s.count;o<l;o++)!0===e.isMesh?e.getVertexPosition(o,pg):pg.fromBufferAttribute(s,o),pg.applyMatrix4(e.matrixWorld),this.expandByPoint(pg);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),XI.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),XI.copy(i.boundingBox)),XI.applyMatrix4(e.matrixWorld),this.union(XI)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,pg),pg.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ME),YI.subVectors(this.max,ME),sC.subVectors(e.a,ME),oC.subVectors(e.b,ME),aC.subVectors(e.c,ME),Hy.subVectors(oC,sC),Vy.subVectors(aC,oC),Lb.subVectors(sC,aC);let t=[0,-Hy.z,Hy.y,0,-Vy.z,Vy.y,0,-Lb.z,Lb.y,Hy.z,0,-Hy.x,Vy.z,0,-Vy.x,Lb.z,0,-Lb.x,-Hy.y,Hy.x,0,-Vy.y,Vy.x,0,-Lb.y,Lb.x,0];return!(!b5(t,sC,oC,aC,YI)||(t=[1,0,0,0,1,0,0,0,1],!b5(t,sC,oC,aC,YI)))&&(KI.crossVectors(Hy,Vy),t=[KI.x,KI.y,KI.z],b5(t,sC,oC,aC,YI))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,pg).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(pg).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(n1[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),n1[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),n1[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),n1[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),n1[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),n1[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),n1[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),n1[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(n1)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const n1=[new Rt,new Rt,new Rt,new Rt,new Rt,new Rt,new Rt,new Rt],pg=new Rt,XI=new Nf,sC=new Rt,oC=new Rt,aC=new Rt,Hy=new Rt,Vy=new Rt,Lb=new Rt,ME=new Rt,YI=new Rt,KI=new Rt,Nb=new Rt;function b5(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Nb.fromArray(n,s);const l=r.x*Math.abs(Nb.x)+r.y*Math.abs(Nb.y)+r.z*Math.abs(Nb.z),d=e.dot(Nb),u=t.dot(Nb),f=i.dot(Nb);if(Math.max(-Math.max(d,u,f),Math.min(d,u,f))>l)return!1}return!0}const Zfe=new Nf,SE=new Rt,x5=new Rt;class ju{constructor(e=new Rt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Zfe.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;SE.subVectors(e,this.center);const t=SE.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(SE,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(x5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(SE.copy(e.center).add(x5)),this.expandByPoint(SE.copy(e.center).sub(x5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const r1=new Rt,w5=new Rt,ZI=new Rt,Gy=new Rt,C5=new Rt,JI=new Rt,M5=new Rt;class lC{constructor(e=new Rt,t=new Rt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,r1)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=r1.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(r1.copy(this.origin).addScaledVector(this.direction,t),r1.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){w5.copy(e).add(t).multiplyScalar(.5),ZI.copy(t).sub(e).normalize(),Gy.copy(this.origin).sub(w5);const s=.5*e.distanceTo(t),o=-this.direction.dot(ZI),l=Gy.dot(this.direction),d=-Gy.dot(ZI),u=Gy.lengthSq(),f=Math.abs(1-o*o);let g,T,B,q;if(f>0)if(g=o*d-l,T=o*l-d,q=s*f,g>=0)if(T>=-q)if(T<=q){const re=1/f;g*=re,T*=re,B=g*(g+o*T+2*l)+T*(o*g+T+2*d)+u}else T=s,g=Math.max(0,-(o*T+l)),B=-g*g+T*(T+2*d)+u;else T=-s,g=Math.max(0,-(o*T+l)),B=-g*g+T*(T+2*d)+u;else T<=-q?(g=Math.max(0,-(-o*s+l)),T=g>0?-s:Math.min(Math.max(-s,-d),s),B=-g*g+T*(T+2*d)+u):T<=q?(g=0,T=Math.min(Math.max(-s,-d),s),B=T*(T+2*d)+u):(g=Math.max(0,-(o*s+l)),T=g>0?s:Math.min(Math.max(-s,-d),s),B=-g*g+T*(T+2*d)+u);else T=o>0?-s:s,g=Math.max(0,-(o*T+l)),B=-g*g+T*(T+2*d)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,g),r&&r.copy(w5).addScaledVector(ZI,T),B}intersectSphere(e,t){r1.subVectors(e.center,this.origin);const i=r1.dot(this.direction),r=r1.dot(r1)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),l=i-o,d=i+o;return d<0?null:this.at(l<0?d:l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,l,d;const u=1/this.direction.x,f=1/this.direction.y,g=1/this.direction.z,T=this.origin;return u>=0?(i=(e.min.x-T.x)*u,r=(e.max.x-T.x)*u):(i=(e.max.x-T.x)*u,r=(e.min.x-T.x)*u),f>=0?(s=(e.min.y-T.y)*f,o=(e.max.y-T.y)*f):(s=(e.max.y-T.y)*f,o=(e.min.y-T.y)*f),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),g>=0?(l=(e.min.z-T.z)*g,d=(e.max.z-T.z)*g):(l=(e.max.z-T.z)*g,d=(e.min.z-T.z)*g),i>d||l>r)||((l>i||i!=i)&&(i=l),(d<r||r!=r)&&(r=d),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,r1)}intersectTriangle(e,t,i,r,s){C5.subVectors(t,e),JI.subVectors(i,e),M5.crossVectors(C5,JI);let l,o=this.direction.dot(M5);if(o>0){if(r)return null;l=1}else{if(!(o<0))return null;l=-1,o=-o}Gy.subVectors(this.origin,e);const d=l*this.direction.dot(JI.crossVectors(Gy,JI));if(d<0)return null;const u=l*this.direction.dot(C5.cross(Gy));if(u<0||d+u>o)return null;const f=-l*Gy.dot(M5);return f<0?null:this.at(f/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class fo{constructor(e,t,i,r,s,o,l,d,u,f,g,T,B,q,re,se){fo.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,l,d,u,f,g,T,B,q,re,se)}set(e,t,i,r,s,o,l,d,u,f,g,T,B,q,re,se){const ne=this.elements;return ne[0]=e,ne[4]=t,ne[8]=i,ne[12]=r,ne[1]=s,ne[5]=o,ne[9]=l,ne[13]=d,ne[2]=u,ne[6]=f,ne[10]=g,ne[14]=T,ne[3]=B,ne[7]=q,ne[11]=re,ne[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new fo).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/cC.setFromMatrixColumn(e,0).length(),s=1/cC.setFromMatrixColumn(e,1).length(),o=1/cC.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),l=Math.sin(i),d=Math.cos(r),u=Math.sin(r),f=Math.cos(s),g=Math.sin(s);if("XYZ"===e.order){const T=o*f,B=o*g,q=l*f,re=l*g;t[0]=d*f,t[4]=-d*g,t[8]=u,t[1]=B+q*u,t[5]=T-re*u,t[9]=-l*d,t[2]=re-T*u,t[6]=q+B*u,t[10]=o*d}else if("YXZ"===e.order){const T=d*f,B=d*g,q=u*f,re=u*g;t[0]=T+re*l,t[4]=q*l-B,t[8]=o*u,t[1]=o*g,t[5]=o*f,t[9]=-l,t[2]=B*l-q,t[6]=re+T*l,t[10]=o*d}else if("ZXY"===e.order){const T=d*f,B=d*g,q=u*f,re=u*g;t[0]=T-re*l,t[4]=-o*g,t[8]=q+B*l,t[1]=B+q*l,t[5]=o*f,t[9]=re-T*l,t[2]=-o*u,t[6]=l,t[10]=o*d}else if("ZYX"===e.order){const T=o*f,B=o*g,q=l*f,re=l*g;t[0]=d*f,t[4]=q*u-B,t[8]=T*u+re,t[1]=d*g,t[5]=re*u+T,t[9]=B*u-q,t[2]=-u,t[6]=l*d,t[10]=o*d}else if("YZX"===e.order){const T=o*d,B=o*u,q=l*d,re=l*u;t[0]=d*f,t[4]=re-T*g,t[8]=q*g+B,t[1]=g,t[5]=o*f,t[9]=-l*f,t[2]=-u*f,t[6]=B*g+q,t[10]=T-re*g}else if("XZY"===e.order){const T=o*d,B=o*u,q=l*d,re=l*u;t[0]=d*f,t[4]=-g,t[8]=u*f,t[1]=T*g+re,t[5]=o*f,t[9]=B*g-q,t[2]=q*g-B,t[6]=l*f,t[10]=re*g+T}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Jfe,e,epe)}lookAt(e,t,i){const r=this.elements;return gm.subVectors(e,t),0===gm.lengthSq()&&(gm.z=1),gm.normalize(),qy.crossVectors(i,gm),0===qy.lengthSq()&&(1===Math.abs(i.z)?gm.x+=1e-4:gm.z+=1e-4,gm.normalize(),qy.crossVectors(i,gm)),qy.normalize(),e4.crossVectors(gm,qy),r[0]=qy.x,r[4]=e4.x,r[8]=gm.x,r[1]=qy.y,r[5]=e4.y,r[9]=gm.y,r[2]=qy.z,r[6]=e4.z,r[10]=gm.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],l=i[4],d=i[8],u=i[12],f=i[1],g=i[5],T=i[9],B=i[13],q=i[2],re=i[6],se=i[10],ne=i[14],De=i[3],Se=i[7],je=i[11],Dt=i[15],Mt=r[0],Bt=r[4],Jt=r[8],Vn=r[12],Tt=r[1],tn=r[5],Fi=r[9],Vi=r[13],On=r[2],yi=r[6],Gn=r[10],ri=r[14],di=r[3],_i=r[7],sr=r[11],pr=r[15];return s[0]=o*Mt+l*Tt+d*On+u*di,s[4]=o*Bt+l*tn+d*yi+u*_i,s[8]=o*Jt+l*Fi+d*Gn+u*sr,s[12]=o*Vn+l*Vi+d*ri+u*pr,s[1]=f*Mt+g*Tt+T*On+B*di,s[5]=f*Bt+g*tn+T*yi+B*_i,s[9]=f*Jt+g*Fi+T*Gn+B*sr,s[13]=f*Vn+g*Vi+T*ri+B*pr,s[2]=q*Mt+re*Tt+se*On+ne*di,s[6]=q*Bt+re*tn+se*yi+ne*_i,s[10]=q*Jt+re*Fi+se*Gn+ne*sr,s[14]=q*Vn+re*Vi+se*ri+ne*pr,s[3]=De*Mt+Se*Tt+je*On+Dt*di,s[7]=De*Bt+Se*tn+je*yi+Dt*_i,s[11]=De*Jt+Se*Fi+je*Gn+Dt*sr,s[15]=De*Vn+Se*Vi+je*ri+Dt*pr,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],l=e[5],d=e[9],u=e[13],f=e[2],g=e[6],T=e[10],B=e[14];return e[3]*(+s*d*g-r*u*g-s*l*T+i*u*T+r*l*B-i*d*B)+e[7]*(+t*d*B-t*u*T+s*o*T-r*o*B+r*u*f-s*d*f)+e[11]*(+t*u*g-t*l*B-s*o*g+i*o*B+s*l*f-i*u*f)+e[15]*(-r*l*f-t*d*g+t*l*T+r*o*g-i*o*T+i*d*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],l=e[5],d=e[6],u=e[7],f=e[8],g=e[9],T=e[10],B=e[11],q=e[12],re=e[13],se=e[14],ne=e[15],De=g*se*u-re*T*u+re*d*B-l*se*B-g*d*ne+l*T*ne,Se=q*T*u-f*se*u-q*d*B+o*se*B+f*d*ne-o*T*ne,je=f*re*u-q*g*u+q*l*B-o*re*B-f*l*ne+o*g*ne,Dt=q*g*d-f*re*d-q*l*T+o*re*T+f*l*se-o*g*se,Mt=t*De+i*Se+r*je+s*Dt;if(0===Mt)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Bt=1/Mt;return e[0]=De*Bt,e[1]=(re*T*s-g*se*s-re*r*B+i*se*B+g*r*ne-i*T*ne)*Bt,e[2]=(l*se*s-re*d*s+re*r*u-i*se*u-l*r*ne+i*d*ne)*Bt,e[3]=(g*d*s-l*T*s-g*r*u+i*T*u+l*r*B-i*d*B)*Bt,e[4]=Se*Bt,e[5]=(f*se*s-q*T*s+q*r*B-t*se*B-f*r*ne+t*T*ne)*Bt,e[6]=(q*d*s-o*se*s-q*r*u+t*se*u+o*r*ne-t*d*ne)*Bt,e[7]=(o*T*s-f*d*s+f*r*u-t*T*u-o*r*B+t*d*B)*Bt,e[8]=je*Bt,e[9]=(q*g*s-f*re*s-q*i*B+t*re*B+f*i*ne-t*g*ne)*Bt,e[10]=(o*re*s-q*l*s+q*i*u-t*re*u-o*i*ne+t*l*ne)*Bt,e[11]=(f*l*s-o*g*s-f*i*u+t*g*u+o*i*B-t*l*B)*Bt,e[12]=Dt*Bt,e[13]=(f*re*r-q*g*r+q*i*T-t*re*T-f*i*se+t*g*se)*Bt,e[14]=(q*l*r-o*re*r-q*i*d+t*re*d+o*i*se-t*l*se)*Bt,e[15]=(o*g*r-f*l*r+f*i*d-t*g*d-o*i*T+t*l*T)*Bt,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,l=e.y,d=e.z,u=s*o,f=s*l;return this.set(u*o+i,u*l-r*d,u*d+r*l,0,u*l+r*d,f*l+i,f*d-r*o,0,u*d-r*l,f*d+r*o,s*d*d+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,l=t._z,d=t._w,u=s+s,f=o+o,g=l+l,T=s*u,B=s*f,q=s*g,re=o*f,se=o*g,ne=l*g,De=d*u,Se=d*f,je=d*g,Dt=i.x,Mt=i.y,Bt=i.z;return r[0]=(1-(re+ne))*Dt,r[1]=(B+je)*Dt,r[2]=(q-Se)*Dt,r[3]=0,r[4]=(B-je)*Mt,r[5]=(1-(T+ne))*Mt,r[6]=(se+De)*Mt,r[7]=0,r[8]=(q+Se)*Bt,r[9]=(se-De)*Bt,r[10]=(1-(T+re))*Bt,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=cC.set(r[0],r[1],r[2]).length();const o=cC.set(r[4],r[5],r[6]).length(),l=cC.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],mg.copy(this);const u=1/s,f=1/o,g=1/l;return mg.elements[0]*=u,mg.elements[1]*=u,mg.elements[2]*=u,mg.elements[4]*=f,mg.elements[5]*=f,mg.elements[6]*=f,mg.elements[8]*=g,mg.elements[9]*=g,mg.elements[10]*=g,t.setFromRotationMatrix(mg),i.x=s,i.y=o,i.z=l,this}makePerspective(e,t,i,r,s,o,l=e1){const d=this.elements,u=2*s/(t-e),f=2*s/(i-r),g=(t+e)/(t-e),T=(i+r)/(i-r);let B,q;if(l===e1)B=-(o+s)/(o-s),q=-2*o*s/(o-s);else{if(2001!==l)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);B=-o/(o-s),q=-o*s/(o-s)}return d[0]=u,d[4]=0,d[8]=g,d[12]=0,d[1]=0,d[5]=f,d[9]=T,d[13]=0,d[2]=0,d[6]=0,d[10]=B,d[14]=q,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,i,r,s,o,l=e1){const d=this.elements,u=1/(t-e),f=1/(i-r),g=1/(o-s),T=(t+e)*u,B=(i+r)*f;let q,re;if(l===e1)q=(o+s)*g,re=-2*g;else{if(2001!==l)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);q=s*g,re=-1*g}return d[0]=2*u,d[4]=0,d[8]=0,d[12]=-T,d[1]=0,d[5]=2*f,d[9]=0,d[13]=-B,d[2]=0,d[6]=0,d[10]=re,d[14]=-q,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const cC=new Rt,mg=new fo,Jfe=new Rt(0,0,0),epe=new Rt(1,1,1),qy=new Rt,e4=new Rt,gm=new Rt,fq=new fo,pq=new zc;let U0=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],l=s[4],d=s[8],u=s[1],f=s[5],g=s[9],T=s[2],B=s[6],q=s[10];switch(i){case"XYZ":this._y=Math.asin(_d(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-g,q),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(B,f),this._z=0);break;case"YXZ":this._x=Math.asin(-_d(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(d,q),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-T,o),this._z=0);break;case"ZXY":this._x=Math.asin(_d(B,-1,1)),Math.abs(B)<.9999999?(this._y=Math.atan2(-T,q),this._z=Math.atan2(-l,f)):(this._y=0,this._z=Math.atan2(u,o));break;case"ZYX":this._y=Math.asin(-_d(T,-1,1)),Math.abs(T)<.9999999?(this._x=Math.atan2(B,q),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-l,f));break;case"YZX":this._z=Math.asin(_d(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-g,f),this._y=Math.atan2(-T,o)):(this._x=0,this._y=Math.atan2(d,q));break;case"XZY":this._z=Math.asin(-_d(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(B,f),this._y=Math.atan2(d,o)):(this._x=Math.atan2(-g,q),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return fq.makeRotationFromQuaternion(t),this.setFromRotationMatrix(fq,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return pq.setFromEuler(this),this.setFromQuaternion(pq,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class S5{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let tpe=0;const mq=new Rt,dC=new zc,s1=new fo,t4=new Rt,EE=new Rt,npe=new Rt,ipe=new zc,Aq=new Rt(1,0,0),gq=new Rt(0,1,0),_q=new Rt(0,0,1),rpe={type:"added"},spe={type:"removed"},E5={type:"childadded",child:null},T5={type:"childremoved",child:null};let Ol=(()=>{class n extends t1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tpe++}),this.uuid=Am(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new Rt,i=new U0,r=new zc,s=new Rt(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function l(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new fo},normalMatrix:{value:new Ca}}),this.matrix=new fo,this.matrixWorld=new fo,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new S5,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return dC.setFromAxisAngle(t,i),this.quaternion.multiply(dC),this}rotateOnWorldAxis(t,i){return dC.setFromAxisAngle(t,i),this.quaternion.premultiply(dC),this}rotateX(t){return this.rotateOnAxis(Aq,t)}rotateY(t){return this.rotateOnAxis(gq,t)}rotateZ(t){return this.rotateOnAxis(_q,t)}translateOnAxis(t,i){return mq.copy(t).applyQuaternion(this.quaternion),this.position.add(mq.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Aq,t)}translateY(t){return this.translateOnAxis(gq,t)}translateZ(t){return this.translateOnAxis(_q,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(s1.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?t4.copy(t):t4.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),EE.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?s1.lookAt(EE,t4,this.up):s1.lookAt(t4,EE,this.up),this.quaternion.setFromRotationMatrix(s1),s&&(s1.extractRotation(s.matrixWorld),dC.setFromRotationMatrix(s1),this.quaternion.premultiply(dC.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(rpe),E5.child=t,this.dispatchEvent(E5),E5.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(spe),T5.child=t,this.dispatchEvent(T5),T5.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),s1.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),s1.multiply(t.parent.matrixWorld)),t.applyMatrix4(s1),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const l=this.children[r].getObjectByProperty(t,i);if(void 0!==l)return l}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(EE,t,npe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(EE,ipe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,l=s.length;o<l;o++){const d=s[o];!0===d.matrixWorldAutoUpdate&&d.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(d,u){return void 0===d[u.uuid]&&(d[u.uuid]=u.toJSON(t)),u.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(d=>({boxInitialized:d.boxInitialized,boxMin:d.box.min.toArray(),boxMax:d.box.max.toArray(),sphereInitialized:d.sphereInitialized,sphereRadius:d.sphere.radius,sphereCenter:d.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),null!==this.boundingSphere&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),null!==this.boundingBox&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const d=this.geometry.parameters;if(void 0!==d&&void 0!==d.shapes){const u=d.shapes;if(Array.isArray(u))for(let f=0,g=u.length;f<g;f++)o(t.shapes,u[f]);else o(t.shapes,u)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const d=[];for(let u=0,f=this.material.length;u<f;u++)d.push(o(t.materials,this.material[u]));s.material=d}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let d=0;d<this.children.length;d++)s.children.push(this.children[d].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let d=0;d<this.animations.length;d++)s.animations.push(o(t.animations,this.animations[d]))}if(i){const d=l(t.geometries),u=l(t.materials),f=l(t.textures),g=l(t.images),T=l(t.shapes),B=l(t.skeletons),q=l(t.animations),re=l(t.nodes);d.length>0&&(r.geometries=d),u.length>0&&(r.materials=u),f.length>0&&(r.textures=f),g.length>0&&(r.images=g),T.length>0&&(r.shapes=T),B.length>0&&(r.skeletons=B),q.length>0&&(r.animations=q),re.length>0&&(r.nodes=re)}return r.object=s,r;function l(d){const u=[];for(const f in d){const g=d[f];delete g.metadata,u.push(g)}return u}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new Rt(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Ag=new Rt,o1=new Rt,D5=new Rt,a1=new Rt,uC=new Rt,hC=new Rt,yq=new Rt,I5=new Rt,B5=new Rt,P5=new Rt;class _m{constructor(e=new Rt,t=new Rt,i=new Rt){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Ag.subVectors(e,t),r.cross(Ag);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Ag.subVectors(r,t),o1.subVectors(i,t),D5.subVectors(e,t);const o=Ag.dot(Ag),l=Ag.dot(o1),d=Ag.dot(D5),u=o1.dot(o1),f=o1.dot(D5),g=o*u-l*l;if(0===g)return s.set(0,0,0),null;const T=1/g,B=(u*d-l*f)*T,q=(o*f-l*d)*T;return s.set(1-B-q,q,B)}static containsPoint(e,t,i,r){return null!==this.getBarycoord(e,t,i,r,a1)&&a1.x>=0&&a1.y>=0&&a1.x+a1.y<=1}static getInterpolation(e,t,i,r,s,o,l,d){return null===this.getBarycoord(e,t,i,r,a1)?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(s,a1.x),d.addScaledVector(o,a1.y),d.addScaledVector(l,a1.z),d)}static isFrontFacing(e,t,i,r){return Ag.subVectors(i,t),o1.subVectors(e,t),Ag.cross(o1).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ag.subVectors(this.c,this.b),o1.subVectors(this.a,this.b),.5*Ag.cross(o1).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return _m.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return _m.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return _m.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return _m.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return _m.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,l;uC.subVectors(r,i),hC.subVectors(s,i),I5.subVectors(e,i);const d=uC.dot(I5),u=hC.dot(I5);if(d<=0&&u<=0)return t.copy(i);B5.subVectors(e,r);const f=uC.dot(B5),g=hC.dot(B5);if(f>=0&&g<=f)return t.copy(r);const T=d*g-f*u;if(T<=0&&d>=0&&f<=0)return o=d/(d-f),t.copy(i).addScaledVector(uC,o);P5.subVectors(e,s);const B=uC.dot(P5),q=hC.dot(P5);if(q>=0&&B<=q)return t.copy(s);const re=B*u-d*q;if(re<=0&&u>=0&&q<=0)return l=u/(u-q),t.copy(i).addScaledVector(hC,l);const se=f*q-B*g;if(se<=0&&g-f>=0&&B-q>=0)return yq.subVectors(s,r),l=(g-f)/(g-f+(B-q)),t.copy(r).addScaledVector(yq,l);const ne=1/(se+re+T);return o=re*ne,l=T*ne,t.copy(i).addScaledVector(uC,o).addScaledVector(hC,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const vq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Qy={h:0,s:0,l:0},n4={h:0,s:0,l:0};function R5(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class fr{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=cu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Hl.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Hl.workingColorSpace){return this.r=e,this.g=t,this.b=i,Hl.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Hl.workingColorSpace){if(e=p5(e,1),t=_d(t,0,1),i=_d(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=R5(o,s,e+1/3),this.g=R5(o,s,e),this.b=R5(o,s,e-1/3)}return Hl.toWorkingColorSpace(this,r),this}setStyle(e,t=cu){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const l=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=cu){const i=vq[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=iC(e.r),this.g=iC(e.g),this.b=iC(e.b),this}copyLinearToSRGB(e){return this.r=g5(e.r),this.g=g5(e.g),this.b=g5(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=cu){return Hl.fromWorkingColorSpace(Xh.copy(this),e),65536*Math.round(_d(255*Xh.r,0,255))+256*Math.round(_d(255*Xh.g,0,255))+Math.round(_d(255*Xh.b,0,255))}getHexString(e=cu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Hl.workingColorSpace){Hl.fromWorkingColorSpace(Xh.copy(this),t);const i=Xh.r,r=Xh.g,s=Xh.b,o=Math.max(i,r,s),l=Math.min(i,r,s);let d,u;const f=(l+o)/2;if(l===o)d=0,u=0;else{const g=o-l;switch(u=f<=.5?g/(o+l):g/(2-o-l),o){case i:d=(r-s)/g+(r<s?6:0);break;case r:d=(s-i)/g+2;break;case s:d=(i-r)/g+4}d/=6}return e.h=d,e.s=u,e.l=f,e}getRGB(e,t=Hl.workingColorSpace){return Hl.fromWorkingColorSpace(Xh.copy(this),t),e.r=Xh.r,e.g=Xh.g,e.b=Xh.b,e}getStyle(e=cu){Hl.fromWorkingColorSpace(Xh.copy(this),e);const t=Xh.r,i=Xh.g,r=Xh.b;return e!==cu?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Qy),this.setHSL(Qy.h+e,Qy.s+t,Qy.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Qy),e.getHSL(n4);const i=xE(Qy.h,n4.h,t),r=xE(Qy.s,n4.s,t),s=xE(Qy.l,n4.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Xh=new fr;fr.NAMES=vq;let ope=0;class ad extends t1{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ope++}),this.uuid=Am(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new fr(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=eC,this.stencilZFail=eC,this.stencilZPass=eC,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const l in s){const d=s[l];delete d.metadata,o.push(d)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==eC&&(i.stencilFail=this.stencilFail),this.stencilZFail!==eC&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==eC&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class yd extends ad{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new fr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new U0,this.combine=LI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const du=new Rt,r4=new Ni;class To{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=pA,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return aq("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)r4.fromBufferAttribute(this,t),r4.applyMatrix3(e),this.setXY(t,r4.x,r4.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)du.fromBufferAttribute(this,t),du.applyMatrix3(e),this.setXYZ(t,du.x,du.y,du.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)du.fromBufferAttribute(this,t),du.applyMatrix4(e),this.setXYZ(t,du.x,du.y,du.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)du.fromBufferAttribute(this,t),du.applyNormalMatrix(e),this.setXYZ(t,du.x,du.y,du.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)du.fromBufferAttribute(this,t),du.transformDirection(e),this.setXYZ(t,du.x,du.y,du.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Lf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=wa(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Lf(t,this.array)),t}setX(e,t){return this.normalized&&(t=wa(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Lf(t,this.array)),t}setY(e,t){return this.normalized&&(t=wa(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Lf(t,this.array)),t}setZ(e,t){return this.normalized&&(t=wa(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Lf(t,this.array)),t}setW(e,t){return this.normalized&&(t=wa(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=wa(t,this.array),i=wa(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=wa(t,this.array),i=wa(i,this.array),r=wa(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=wa(t,this.array),i=wa(i,this.array),r=wa(r,this.array),s=wa(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class bq extends To{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class xq extends To{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class ks extends To{constructor(e,t,i){super(new Float32Array(e),t,i)}}let lpe=0;const AA=new fo,k5=new Ol,fC=new Rt,ym=new Nf,DE=new Nf,$u=new Rt;class Qs extends t1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:lpe++}),this.uuid=Am(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(sq(e)?xq:bq)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Ca).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return AA.makeRotationFromQuaternion(e),this.applyMatrix4(AA),this}rotateX(e){return AA.makeRotationX(e),this.applyMatrix4(AA),this}rotateY(e){return AA.makeRotationY(e),this.applyMatrix4(AA),this}rotateZ(e){return AA.makeRotationZ(e),this.applyMatrix4(AA),this}translate(e,t,i){return AA.makeTranslation(e,t,i),this.applyMatrix4(AA),this}scale(e,t,i){return AA.makeScale(e,t,i),this.applyMatrix4(AA),this}lookAt(e){return k5.lookAt(e),k5.updateMatrix(),this.applyMatrix4(k5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fC).negate(),this.translate(fC.x,fC.y,fC.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ks(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Nf);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Rt(-1/0,-1/0,-1/0),new Rt(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)ym.setFromBufferAttribute(t[i]),this.morphTargetsRelative?($u.addVectors(this.boundingBox.min,ym.min),this.boundingBox.expandByPoint($u),$u.addVectors(this.boundingBox.max,ym.max),this.boundingBox.expandByPoint($u)):(this.boundingBox.expandByPoint(ym.min),this.boundingBox.expandByPoint(ym.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ju);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Rt,1/0);if(e){const i=this.boundingSphere.center;if(ym.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)DE.setFromBufferAttribute(t[s]),this.morphTargetsRelative?($u.addVectors(ym.min,DE.min),ym.expandByPoint($u),$u.addVectors(ym.max,DE.max),ym.expandByPoint($u)):(ym.expandByPoint(DE.min),ym.expandByPoint(DE.max));ym.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)$u.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared($u));if(t)for(let s=0,o=t.length;s<o;s++){const l=t[s],d=this.morphTargetsRelative;for(let u=0,f=l.count;u<f;u++)$u.fromBufferAttribute(l,u),d&&(fC.fromBufferAttribute(e,u),$u.add(fC)),r=Math.max(r,i.distanceToSquared($u))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,r=t.normal,s=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new To(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),l=[],d=[];for(let Jt=0;Jt<i.count;Jt++)l[Jt]=new Rt,d[Jt]=new Rt;const u=new Rt,f=new Rt,g=new Rt,T=new Ni,B=new Ni,q=new Ni,re=new Rt,se=new Rt;function ne(Jt,Vn,Tt){u.fromBufferAttribute(i,Jt),f.fromBufferAttribute(i,Vn),g.fromBufferAttribute(i,Tt),T.fromBufferAttribute(s,Jt),B.fromBufferAttribute(s,Vn),q.fromBufferAttribute(s,Tt),f.sub(u),g.sub(u),B.sub(T),q.sub(T);const tn=1/(B.x*q.y-q.x*B.y);isFinite(tn)&&(re.copy(f).multiplyScalar(q.y).addScaledVector(g,-B.y).multiplyScalar(tn),se.copy(g).multiplyScalar(B.x).addScaledVector(f,-q.x).multiplyScalar(tn),l[Jt].add(re),l[Vn].add(re),l[Tt].add(re),d[Jt].add(se),d[Vn].add(se),d[Tt].add(se))}let De=this.groups;0===De.length&&(De=[{start:0,count:e.count}]);for(let Jt=0,Vn=De.length;Jt<Vn;++Jt){const Tt=De[Jt],tn=Tt.start;for(let Vi=tn,On=tn+Tt.count;Vi<On;Vi+=3)ne(e.getX(Vi+0),e.getX(Vi+1),e.getX(Vi+2))}const Se=new Rt,je=new Rt,Dt=new Rt,Mt=new Rt;function Bt(Jt){Dt.fromBufferAttribute(r,Jt),Mt.copy(Dt);const Vn=l[Jt];Se.copy(Vn),Se.sub(Dt.multiplyScalar(Dt.dot(Vn))).normalize(),je.crossVectors(Mt,Vn);const tn=je.dot(d[Jt])<0?-1:1;o.setXYZW(Jt,Se.x,Se.y,Se.z,tn)}for(let Jt=0,Vn=De.length;Jt<Vn;++Jt){const Tt=De[Jt],tn=Tt.start;for(let Vi=tn,On=tn+Tt.count;Vi<On;Vi+=3)Bt(e.getX(Vi+0)),Bt(e.getX(Vi+1)),Bt(e.getX(Vi+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new To(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let T=0,B=i.count;T<B;T++)i.setXYZ(T,0,0,0);const r=new Rt,s=new Rt,o=new Rt,l=new Rt,d=new Rt,u=new Rt,f=new Rt,g=new Rt;if(e)for(let T=0,B=e.count;T<B;T+=3){const q=e.getX(T+0),re=e.getX(T+1),se=e.getX(T+2);r.fromBufferAttribute(t,q),s.fromBufferAttribute(t,re),o.fromBufferAttribute(t,se),f.subVectors(o,s),g.subVectors(r,s),f.cross(g),l.fromBufferAttribute(i,q),d.fromBufferAttribute(i,re),u.fromBufferAttribute(i,se),l.add(f),d.add(f),u.add(f),i.setXYZ(q,l.x,l.y,l.z),i.setXYZ(re,d.x,d.y,d.z),i.setXYZ(se,u.x,u.y,u.z)}else for(let T=0,B=t.count;T<B;T+=3)r.fromBufferAttribute(t,T+0),s.fromBufferAttribute(t,T+1),o.fromBufferAttribute(t,T+2),f.subVectors(o,s),g.subVectors(r,s),f.cross(g),i.setXYZ(T+0,f.x,f.y,f.z),i.setXYZ(T+1,f.x,f.y,f.z),i.setXYZ(T+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)$u.fromBufferAttribute(e,t),$u.normalize(),e.setXYZ(t,$u.x,$u.y,$u.z)}toNonIndexed(){function e(l,d){const u=l.array,f=l.itemSize,g=l.normalized,T=new u.constructor(d.length*f);let B=0,q=0;for(let re=0,se=d.length;re<se;re++){B=l.isInterleavedBufferAttribute?d[re]*l.data.stride+l.offset:d[re]*f;for(let ne=0;ne<f;ne++)T[q++]=u[B++]}return new To(T,f,g)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Qs,i=this.index.array,r=this.attributes;for(const l in r){const u=e(r[l],i);t.setAttribute(l,u)}const s=this.morphAttributes;for(const l in s){const d=[],u=s[l];for(let f=0,g=u.length;f<g;f++){const B=e(u[f],i);d.push(B)}t.morphAttributes[l]=d}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,d=o.length;l<d;l++){const u=o[l];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const d=this.parameters;for(const u in d)void 0!==d[u]&&(e[u]=d[u]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const d in i)e.data.attributes[d]=i[d].toJSON(e.data);const r={};let s=!1;for(const d in this.morphAttributes){const u=this.morphAttributes[d],f=[];for(let g=0,T=u.length;g<T;g++)f.push(u[g].toJSON(e.data));f.length>0&&(r[d]=f,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r)this.setAttribute(u,r[u].clone(t));const s=e.morphAttributes;for(const u in s){const f=[],g=s[u];for(let T=0,B=g.length;T<B;T++)f.push(g[T].clone(t));this.morphAttributes[u]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,f=o.length;u<f;u++){const g=o[u];this.addGroup(g.start,g.count,g.materialIndex)}const l=e.boundingBox;null!==l&&(this.boundingBox=l.clone());const d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const wq=new fo,Ub=new lC,s4=new ju,Cq=new Rt,pC=new Rt,mC=new Rt,AC=new Rt,F5=new Rt,o4=new Rt,a4=new Ni,l4=new Ni,c4=new Ni,Mq=new Rt,Sq=new Rt,Eq=new Rt,d4=new Rt,u4=new Rt;class Yo extends Ol{constructor(e=new Qs,t=new yd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const l=this.morphTargetInfluences;if(s&&l){o4.set(0,0,0);for(let d=0,u=s.length;d<u;d++){const f=l[d];0!==f&&(F5.fromBufferAttribute(s[d],e),o4.addScaledVector(o?F5:F5.sub(t),f))}t.add(o4)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),s4.copy(i.boundingSphere),s4.applyMatrix4(s),Ub.copy(e.ray).recast(e.near),(!1!==s4.containsPoint(Ub.origin)||!(null===Ub.intersectSphere(s4,Cq)||Ub.origin.distanceToSquared(Cq)>(e.far-e.near)**2))&&(wq.copy(s).invert(),Ub.copy(e.ray).applyMatrix4(wq),(null===i.boundingBox||!1!==Ub.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Ub)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,l=s.index,d=s.attributes.position,u=s.attributes.uv,f=s.attributes.uv1,g=s.attributes.normal,T=s.groups,B=s.drawRange;if(null!==l)if(Array.isArray(o))for(let q=0,re=T.length;q<re;q++){const se=T[q],ne=o[se.materialIndex];for(let je=Math.max(se.start,B.start),Dt=Math.min(l.count,Math.min(se.start+se.count,B.start+B.count));je<Dt;je+=3)r=h4(this,ne,e,i,u,f,g,l.getX(je),l.getX(je+1),l.getX(je+2)),r&&(r.faceIndex=Math.floor(je/3),r.face.materialIndex=se.materialIndex,t.push(r))}else for(let se=Math.max(0,B.start),ne=Math.min(l.count,B.start+B.count);se<ne;se+=3)r=h4(this,o,e,i,u,f,g,l.getX(se),l.getX(se+1),l.getX(se+2)),r&&(r.faceIndex=Math.floor(se/3),t.push(r));else if(void 0!==d)if(Array.isArray(o))for(let q=0,re=T.length;q<re;q++){const se=T[q],ne=o[se.materialIndex];for(let je=Math.max(se.start,B.start),Dt=Math.min(d.count,Math.min(se.start+se.count,B.start+B.count));je<Dt;je+=3)r=h4(this,ne,e,i,u,f,g,je,je+1,je+2),r&&(r.faceIndex=Math.floor(je/3),r.face.materialIndex=se.materialIndex,t.push(r))}else for(let se=Math.max(0,B.start),ne=Math.min(d.count,B.start+B.count);se<ne;se+=3)r=h4(this,o,e,i,u,f,g,se,se+1,se+2),r&&(r.faceIndex=Math.floor(se/3),t.push(r))}}function h4(n,e,t,i,r,s,o,l,d,u){n.getVertexPosition(l,pC),n.getVertexPosition(d,mC),n.getVertexPosition(u,AC);const f=function cpe(n,e,t,i,r,s,o,l){let d;if(d=1===e.side?i.intersectTriangle(o,s,r,!0,l):i.intersectTriangle(r,s,o,0===e.side,l),null===d)return null;u4.copy(l),u4.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(u4);return u<t.near||u>t.far?null:{distance:u,point:u4.clone(),object:n}}(n,e,t,i,pC,mC,AC,d4);if(f){r&&(a4.fromBufferAttribute(r,l),l4.fromBufferAttribute(r,d),c4.fromBufferAttribute(r,u),f.uv=_m.getInterpolation(d4,pC,mC,AC,a4,l4,c4,new Ni)),s&&(a4.fromBufferAttribute(s,l),l4.fromBufferAttribute(s,d),c4.fromBufferAttribute(s,u),f.uv1=_m.getInterpolation(d4,pC,mC,AC,a4,l4,c4,new Ni)),o&&(Mq.fromBufferAttribute(o,l),Sq.fromBufferAttribute(o,d),Eq.fromBufferAttribute(o,u),f.normal=_m.getInterpolation(d4,pC,mC,AC,Mq,Sq,Eq,new Rt),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const g={a:l,b:d,c:u,normal:new Rt,materialIndex:0};_m.getNormal(pC,mC,AC,g.normal),f.face=g}return f}class Mp extends Qs{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const l=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const d=[],u=[],f=[],g=[];let T=0,B=0;function q(re,se,ne,De,Se,je,Dt,Mt,Bt,Jt,Vn){const Tt=je/Bt,tn=Dt/Jt,Fi=je/2,Vi=Dt/2,On=Mt/2,yi=Bt+1,Gn=Jt+1;let ri=0,di=0;const _i=new Rt;for(let sr=0;sr<Gn;sr++){const pr=sr*tn-Vi;for(let Hr=0;Hr<yi;Hr++)_i[re]=(Hr*Tt-Fi)*De,_i[se]=pr*Se,_i[ne]=On,u.push(_i.x,_i.y,_i.z),_i[re]=0,_i[se]=0,_i[ne]=Mt>0?1:-1,f.push(_i.x,_i.y,_i.z),g.push(Hr/Bt),g.push(1-sr/Jt),ri+=1}for(let sr=0;sr<Jt;sr++)for(let pr=0;pr<Bt;pr++){const Ns=T+pr+yi*(sr+1),ui=T+(pr+1)+yi*(sr+1),xr=T+(pr+1)+yi*sr;d.push(T+pr+yi*sr,Ns,xr),d.push(Ns,ui,xr),di+=6}l.addGroup(B,di,Vn),B+=di,T+=ri}q("z","y","x",-1,-1,i,t,e,o,s,0),q("z","y","x",1,-1,i,t,-e,o,s,1),q("x","z","y",1,1,e,i,t,r,o,2),q("x","z","y",1,-1,e,i,-t,r,o,3),q("x","y","z",1,-1,e,t,i,r,s,4),q("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(d),this.setAttribute("position",new ks(u,3)),this.setAttribute("normal",new ks(f,3)),this.setAttribute("uv",new ks(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function gC(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function Uf(n){const e={};for(let t=0;t<n.length;t++){const i=gC(n[t]);for(const r in i)e[r]=i[r]}return e}function Tq(n){return null===n.getRenderTarget()?n.outputColorSpace:Hl.workingColorSpace}const O5={clone:gC,merge:Uf};class Cu extends ad{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=gC(e.uniforms),this.uniformsGroups=function dpe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class L5 extends Ol{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new fo,this.projectionMatrix=new fo,this.projectionMatrixInverse=new fo,this.coordinateSystem=e1}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Wy=new Rt,Dq=new Ni,Iq=new Ni;class Mu extends L5{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*tC*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Fb*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*tC*Math.atan(Math.tan(.5*Fb*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Wy.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Wy.x,Wy.y).multiplyScalar(-e/Wy.z),Wy.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Wy.x,Wy.y).multiplyScalar(-e/Wy.z)}getViewSize(e,t){return this.getViewBounds(e,Dq,Iq),t.subVectors(Iq,Dq)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Fb*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const d=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/d,t-=o.offsetY*i/u,r*=o.width/d,i*=o.height/u}const l=this.filmOffset;0!==l&&(s+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class fpe extends Ol{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Mu(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new Mu(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new Mu(-90,1,e,t);o.layers=this.layers,this.add(o);const l=new Mu(-90,1,e,t);l.layers=this.layers,this.add(l);const d=new Mu(-90,1,e,t);d.layers=this.layers,this.add(d);const u=new Mu(-90,1,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,l,d]=t;for(const u of t)this.remove(u);if(e===e1)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1)}for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,l,d,u,f]=this.children,g=e.getRenderTarget(),T=e.getActiveCubeFace(),B=e.getActiveMipmapLevel(),q=e.xr.enabled;e.xr.enabled=!1;const re=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,l),e.setRenderTarget(i,3,r),e.render(t,d),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=re,e.setRenderTarget(i,5,r),e.render(t,f),e.setRenderTarget(g,T,B),e.xr.enabled=q,i.texture.needsPMREMUpdate=!0}}class f4 extends $h{constructor(e,t,i,r,s,o,l,d,u,f){super(e=void 0!==e?e:[],t=void 0!==t?t:Oy,i,r,s,o,l,d,u,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ppe extends Wu{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new f4([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Nc}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Mp(5,5,5),s=new Cu({name:"CubemapFromEquirect",uniforms:gC(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Yo(r,s),l=t.minFilter;return t.minFilter===fA&&(t.minFilter=Nc),new fpe(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const N5=new Rt,mpe=new Rt,Ape=new Ca;class gA{constructor(e=new Rt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=N5.subVectors(i,t).cross(mpe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(N5),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Ape.getNormalMatrix(e),r=this.coplanarPoint(N5).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const zb=new ju,p4=new Rt;class m4{constructor(e=new gA,t=new gA,i=new gA,r=new gA,s=new gA,o=new gA){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(r),l[4].copy(s),l[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=e1){const i=this.planes,r=e.elements,s=r[0],o=r[1],l=r[2],d=r[3],u=r[4],f=r[5],g=r[6],T=r[7],B=r[8],q=r[9],re=r[10],se=r[11],ne=r[12],De=r[13],Se=r[14],je=r[15];if(i[0].setComponents(d-s,T-u,se-B,je-ne).normalize(),i[1].setComponents(d+s,T+u,se+B,je+ne).normalize(),i[2].setComponents(d+o,T+f,se+q,je+De).normalize(),i[3].setComponents(d-o,T-f,se-q,je-De).normalize(),i[4].setComponents(d-l,T-g,se-re,je-Se).normalize(),t===e1)i[5].setComponents(d+l,T+g,se+re,je+Se).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(l,g,re,Se).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),zb.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),zb.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(zb)}intersectsSprite(e){return zb.center.set(0,0,0),zb.radius=.7071067811865476,zb.applyMatrix4(e.matrixWorld),this.intersectsSphere(zb)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(p4.x=r.normal.x>0?e.max.x:e.min.x,p4.y=r.normal.y>0?e.max.y:e.min.y,p4.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(p4)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Bq(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function gpe(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)},remove:function l(u){u.isInterleavedBufferAttribute&&(u=u.data);const f=i.get(u);f&&(n.deleteBuffer(f.buffer),i.delete(u))},update:function d(u,f){if(u.isGLBufferAttribute){const T=i.get(u);return void((!T||T.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version}))}u.isInterleavedBufferAttribute&&(u=u.data);const g=i.get(u);if(void 0===g)i.set(u,function r(u,f){const g=u.array,T=u.usage,B=g.byteLength,q=n.createBuffer();let re;if(n.bindBuffer(f,q),n.bufferData(f,g,T),u.onUploadCallback(),g instanceof Float32Array)re=n.FLOAT;else if(g instanceof Uint16Array)if(u.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");re=n.HALF_FLOAT}else re=n.UNSIGNED_SHORT;else if(g instanceof Int16Array)re=n.SHORT;else if(g instanceof Uint32Array)re=n.UNSIGNED_INT;else if(g instanceof Int32Array)re=n.INT;else if(g instanceof Int8Array)re=n.BYTE;else if(g instanceof Uint8Array)re=n.UNSIGNED_BYTE;else{if(!(g instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+g);re=n.UNSIGNED_BYTE}return{buffer:q,type:re,bytesPerElement:g.BYTES_PER_ELEMENT,version:u.version,size:B}}(u,f));else if(g.version<u.version){if(g.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function s(u,f,g){const T=f.array,B=f._updateRange,q=f.updateRanges;if(n.bindBuffer(g,u),-1===B.count&&0===q.length&&n.bufferSubData(g,0,T),0!==q.length){for(let re=0,se=q.length;re<se;re++){const ne=q[re];t?n.bufferSubData(g,ne.start*T.BYTES_PER_ELEMENT,T,ne.start,ne.count):n.bufferSubData(g,ne.start*T.BYTES_PER_ELEMENT,T.subarray(ne.start,ne.start+ne.count))}f.clearUpdateRanges()}-1!==B.count&&(t?n.bufferSubData(g,B.offset*T.BYTES_PER_ELEMENT,T,B.offset,B.count):n.bufferSubData(g,B.offset*T.BYTES_PER_ELEMENT,T.subarray(B.offset,B.offset+B.count)),B.count=-1),f.onUploadCallback()})(g.buffer,u,f),g.version=u.version}}}}class vC extends Qs{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,l=Math.floor(i),d=Math.floor(r),u=l+1,f=d+1,g=e/l,T=t/d,B=[],q=[],re=[],se=[];for(let ne=0;ne<f;ne++){const De=ne*T-o;for(let Se=0;Se<u;Se++)q.push(Se*g-s,-De,0),re.push(0,0,1),se.push(Se/l),se.push(1-ne/d)}for(let ne=0;ne<d;ne++)for(let De=0;De<l;De++){const je=De+u*(ne+1),Dt=De+1+u*(ne+1),Mt=De+1+u*ne;B.push(De+u*ne,je,Mt),B.push(je,Dt,Mt)}this.setIndex(B),this.setAttribute("position",new ks(q,3)),this.setAttribute("normal",new ks(re,3)),this.setAttribute("uv",new ks(se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vC(e.width,e.height,e.widthSegments,e.heightSegments)}}const pa={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tfloat startCompression = 0.8 - 0.04;\n\tfloat desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min(color.r, min(color.g, color.b));\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max(color.r, max(color.g, color.b));\n\tif (peak < startCompression) return color;\n\tfloat d = 1. - startCompression;\n\tfloat newPeak = 1. - d * d / (peak + d - startCompression);\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);\n\treturn mix(color, vec3(1, 1, 1), g);\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ps={common:{diffuse:{value:new fr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ca},alphaMap:{value:null},alphaMapTransform:{value:new Ca},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ca}},envmap:{envMap:{value:null},envMapRotation:{value:new Ca},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ca}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ca}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ca},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ca},normalScale:{value:new Ni(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ca},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ca}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ca}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ca}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ca},alphaTest:{value:0},uvTransform:{value:new Ca}},sprite:{diffuse:{value:new fr(16777215)},opacity:{value:1},center:{value:new Ni(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ca},alphaMap:{value:null},alphaMapTransform:{value:new Ca},alphaTest:{value:0}}},z0={basic:{uniforms:Uf([ps.common,ps.specularmap,ps.envmap,ps.aomap,ps.lightmap,ps.fog]),vertexShader:pa.meshbasic_vert,fragmentShader:pa.meshbasic_frag},lambert:{uniforms:Uf([ps.common,ps.specularmap,ps.envmap,ps.aomap,ps.lightmap,ps.emissivemap,ps.bumpmap,ps.normalmap,ps.displacementmap,ps.fog,ps.lights,{emissive:{value:new fr(0)}}]),vertexShader:pa.meshlambert_vert,fragmentShader:pa.meshlambert_frag},phong:{uniforms:Uf([ps.common,ps.specularmap,ps.envmap,ps.aomap,ps.lightmap,ps.emissivemap,ps.bumpmap,ps.normalmap,ps.displacementmap,ps.fog,ps.lights,{emissive:{value:new fr(0)},specular:{value:new fr(1118481)},shininess:{value:30}}]),vertexShader:pa.meshphong_vert,fragmentShader:pa.meshphong_frag},standard:{uniforms:Uf([ps.common,ps.envmap,ps.aomap,ps.lightmap,ps.emissivemap,ps.bumpmap,ps.normalmap,ps.displacementmap,ps.roughnessmap,ps.metalnessmap,ps.fog,ps.lights,{emissive:{value:new fr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pa.meshphysical_vert,fragmentShader:pa.meshphysical_frag},toon:{uniforms:Uf([ps.common,ps.aomap,ps.lightmap,ps.emissivemap,ps.bumpmap,ps.normalmap,ps.displacementmap,ps.gradientmap,ps.fog,ps.lights,{emissive:{value:new fr(0)}}]),vertexShader:pa.meshtoon_vert,fragmentShader:pa.meshtoon_frag},matcap:{uniforms:Uf([ps.common,ps.bumpmap,ps.normalmap,ps.displacementmap,ps.fog,{matcap:{value:null}}]),vertexShader:pa.meshmatcap_vert,fragmentShader:pa.meshmatcap_frag},points:{uniforms:Uf([ps.points,ps.fog]),vertexShader:pa.points_vert,fragmentShader:pa.points_frag},dashed:{uniforms:Uf([ps.common,ps.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pa.linedashed_vert,fragmentShader:pa.linedashed_frag},depth:{uniforms:Uf([ps.common,ps.displacementmap]),vertexShader:pa.depth_vert,fragmentShader:pa.depth_frag},normal:{uniforms:Uf([ps.common,ps.bumpmap,ps.normalmap,ps.displacementmap,{opacity:{value:1}}]),vertexShader:pa.meshnormal_vert,fragmentShader:pa.meshnormal_frag},sprite:{uniforms:Uf([ps.sprite,ps.fog]),vertexShader:pa.sprite_vert,fragmentShader:pa.sprite_frag},background:{uniforms:{uvTransform:{value:new Ca},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:pa.background_vert,fragmentShader:pa.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ca}},vertexShader:pa.backgroundCube_vert,fragmentShader:pa.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:pa.cube_vert,fragmentShader:pa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pa.equirect_vert,fragmentShader:pa.equirect_frag},distanceRGBA:{uniforms:Uf([ps.common,ps.displacementmap,{referencePosition:{value:new Rt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pa.distanceRGBA_vert,fragmentShader:pa.distanceRGBA_frag},shadow:{uniforms:Uf([ps.lights,ps.fog,{color:{value:new fr(0)},opacity:{value:1}}]),vertexShader:pa.shadow_vert,fragmentShader:pa.shadow_frag}};z0.physical={uniforms:Uf([z0.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ca},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ca},clearcoatNormalScale:{value:new Ni(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ca},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ca},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ca},sheen:{value:0},sheenColor:{value:new fr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ca},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ca},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ca},transmissionSamplerSize:{value:new Ni},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ca},attenuationDistance:{value:0},attenuationColor:{value:new fr(0)},specularColor:{value:new fr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ca},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ca},anisotropyVector:{value:new Ni},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ca}}]),vertexShader:pa.meshphysical_vert,fragmentShader:pa.meshphysical_frag};const A4={r:0,b:0,g:0},Hb=new U0,_Ae=new fo;function yAe(n,e,t,i,r,s,o){const l=new fr(0);let u,f,d=!0===s?0:1,g=null,T=0,B=null;function re(se,ne){se.getRGB(A4,Tq(n)),i.buffers.color.setClear(A4.r,A4.g,A4.b,ne,o)}return{getClearColor:function(){return l},setClearColor:function(se,ne=1){l.set(se),d=ne,re(l,d)},getClearAlpha:function(){return d},setClearAlpha:function(se){d=se,re(l,d)},render:function q(se,ne){let De=!1,Se=!0===ne.isScene?ne.background:null;Se&&Se.isTexture&&(Se=(ne.backgroundBlurriness>0?t:e).get(Se)),null===Se?re(l,d):Se&&Se.isColor&&(re(Se,1),De=!0);const je=n.xr.getEnvironmentBlendMode();"additive"===je?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===je&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||De)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),Se&&(Se.isCubeTexture||Se.mapping===vE)?(void 0===f&&(f=new Yo(new Mp(1,1,1),new Cu({name:"BackgroundCubeMaterial",uniforms:gC(z0.backgroundCube.uniforms),vertexShader:z0.backgroundCube.vertexShader,fragmentShader:z0.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(Dt,Mt,Bt){this.matrixWorld.copyPosition(Bt.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),Hb.copy(ne.backgroundRotation),Hb.x*=-1,Hb.y*=-1,Hb.z*=-1,Se.isCubeTexture&&!1===Se.isRenderTargetTexture&&(Hb.y*=-1,Hb.z*=-1),f.material.uniforms.envMap.value=Se,f.material.uniforms.flipEnvMap.value=Se.isCubeTexture&&!1===Se.isRenderTargetTexture?-1:1,f.material.uniforms.backgroundBlurriness.value=ne.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=ne.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(_Ae.makeRotationFromEuler(Hb)),f.material.toneMapped=Hl.getTransfer(Se.colorSpace)!==Uc,(g!==Se||T!==Se.version||B!==n.toneMapping)&&(f.material.needsUpdate=!0,g=Se,T=Se.version,B=n.toneMapping),f.layers.enableAll(),se.unshift(f,f.geometry,f.material,0,0,null)):Se&&Se.isTexture&&(void 0===u&&(u=new Yo(new vC(2,2),new Cu({name:"BackgroundMaterial",uniforms:gC(z0.background.uniforms),vertexShader:z0.background.vertexShader,fragmentShader:z0.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=Se,u.material.uniforms.backgroundIntensity.value=ne.backgroundIntensity,u.material.toneMapped=Hl.getTransfer(Se.colorSpace)!==Uc,!0===Se.matrixAutoUpdate&&Se.updateMatrix(),u.material.uniforms.uvTransform.value.copy(Se.matrix),(g!==Se||T!==Se.version||B!==n.toneMapping)&&(u.material.needsUpdate=!0,g=Se,T=Se.version,B=n.toneMapping),u.layers.enableAll(),se.unshift(u,u.geometry,u.material,0,0,null))}}}function vAe(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,l={},d=se(null);let u=d,f=!1;function B(On){return i.isWebGL2?n.bindVertexArray(On):s.bindVertexArrayOES(On)}function q(On){return i.isWebGL2?n.deleteVertexArray(On):s.deleteVertexArrayOES(On)}function se(On){const yi=[],Gn=[],ri=[];for(let di=0;di<r;di++)yi[di]=0,Gn[di]=0,ri[di]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:yi,enabledAttributes:Gn,attributeDivisors:ri,object:On,attributes:{},index:null}}function Se(){const On=u.newAttributes;for(let yi=0,Gn=On.length;yi<Gn;yi++)On[yi]=0}function je(On){Dt(On,0)}function Dt(On,yi){const ri=u.enabledAttributes,di=u.attributeDivisors;u.newAttributes[On]=1,0===ri[On]&&(n.enableVertexAttribArray(On),ri[On]=1),di[On]!==yi&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](On,yi),di[On]=yi)}function Mt(){const On=u.newAttributes,yi=u.enabledAttributes;for(let Gn=0,ri=yi.length;Gn<ri;Gn++)yi[Gn]!==On[Gn]&&(n.disableVertexAttribArray(Gn),yi[Gn]=0)}function Bt(On,yi,Gn,ri,di,_i,sr){!0===sr?n.vertexAttribIPointer(On,yi,Gn,di,_i):n.vertexAttribPointer(On,yi,Gn,ri,di,_i)}function Fi(){Vi(),f=!0,u!==d&&(u=d,B(u.object))}function Vi(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:function g(On,yi,Gn,ri,di){let _i=!1;if(o){const sr=function re(On,yi,Gn){const ri=!0===Gn.wireframe;let di=l[On.id];void 0===di&&(di={},l[On.id]=di);let _i=di[yi.id];void 0===_i&&(_i={},di[yi.id]=_i);let sr=_i[ri];return void 0===sr&&(sr=se(function T(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),_i[ri]=sr),sr}(ri,Gn,yi);u!==sr&&(u=sr,B(u.object)),_i=function ne(On,yi,Gn,ri){const di=u.attributes,_i=yi.attributes;let sr=0;const pr=Gn.getAttributes();for(const Hr in pr)if(pr[Hr].location>=0){const ui=di[Hr];let xr=_i[Hr];if(void 0===xr&&("instanceMatrix"===Hr&&On.instanceMatrix&&(xr=On.instanceMatrix),"instanceColor"===Hr&&On.instanceColor&&(xr=On.instanceColor)),void 0===ui||ui.attribute!==xr||xr&&ui.data!==xr.data)return!0;sr++}return u.attributesNum!==sr||u.index!==ri}(On,ri,Gn,di),_i&&function De(On,yi,Gn,ri){const di={},_i=yi.attributes;let sr=0;const pr=Gn.getAttributes();for(const Hr in pr)if(pr[Hr].location>=0){let ui=_i[Hr];void 0===ui&&("instanceMatrix"===Hr&&On.instanceMatrix&&(ui=On.instanceMatrix),"instanceColor"===Hr&&On.instanceColor&&(ui=On.instanceColor));const xr={};xr.attribute=ui,ui&&ui.data&&(xr.data=ui.data),di[Hr]=xr,sr++}u.attributes=di,u.attributesNum=sr,u.index=ri}(On,ri,Gn,di)}else{const sr=!0===yi.wireframe;(u.geometry!==ri.id||u.program!==Gn.id||u.wireframe!==sr)&&(u.geometry=ri.id,u.program=Gn.id,u.wireframe=sr,_i=!0)}null!==di&&t.update(di,n.ELEMENT_ARRAY_BUFFER),(_i||f)&&(f=!1,function Jt(On,yi,Gn,ri){if(!1===i.isWebGL2&&(On.isInstancedMesh||ri.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;Se();const di=ri.attributes,_i=Gn.getAttributes(),sr=yi.defaultAttributeValues;for(const pr in _i){const Hr=_i[pr];if(Hr.location>=0){let Ns=di[pr];if(void 0===Ns&&("instanceMatrix"===pr&&On.instanceMatrix&&(Ns=On.instanceMatrix),"instanceColor"===pr&&On.instanceColor&&(Ns=On.instanceColor)),void 0!==Ns){const ui=Ns.normalized,xr=Ns.itemSize,is=t.get(Ns);if(void 0===is)continue;const _s=is.buffer,ws=is.type,cs=is.bytesPerElement,po=!0===i.isWebGL2&&(ws===n.INT||ws===n.UNSIGNED_INT||1013===Ns.gpuType);if(Ns.isInterleavedBufferAttribute){const Xs=Ns.data,zn=Xs.stride,es=Ns.offset;if(Xs.isInstancedInterleavedBuffer){for(let ar=0;ar<Hr.locationSize;ar++)Dt(Hr.location+ar,Xs.meshPerAttribute);!0!==On.isInstancedMesh&&void 0===ri._maxInstanceCount&&(ri._maxInstanceCount=Xs.meshPerAttribute*Xs.count)}else for(let ar=0;ar<Hr.locationSize;ar++)je(Hr.location+ar);n.bindBuffer(n.ARRAY_BUFFER,_s);for(let ar=0;ar<Hr.locationSize;ar++)Bt(Hr.location+ar,xr/Hr.locationSize,ws,ui,zn*cs,(es+xr/Hr.locationSize*ar)*cs,po)}else{if(Ns.isInstancedBufferAttribute){for(let Xs=0;Xs<Hr.locationSize;Xs++)Dt(Hr.location+Xs,Ns.meshPerAttribute);!0!==On.isInstancedMesh&&void 0===ri._maxInstanceCount&&(ri._maxInstanceCount=Ns.meshPerAttribute*Ns.count)}else for(let Xs=0;Xs<Hr.locationSize;Xs++)je(Hr.location+Xs);n.bindBuffer(n.ARRAY_BUFFER,_s);for(let Xs=0;Xs<Hr.locationSize;Xs++)Bt(Hr.location+Xs,xr/Hr.locationSize,ws,ui,xr*cs,xr/Hr.locationSize*Xs*cs,po)}}else if(void 0!==sr){const ui=sr[pr];if(void 0!==ui)switch(ui.length){case 2:n.vertexAttrib2fv(Hr.location,ui);break;case 3:n.vertexAttrib3fv(Hr.location,ui);break;case 4:n.vertexAttrib4fv(Hr.location,ui);break;default:n.vertexAttrib1fv(Hr.location,ui)}}}}Mt()}(On,yi,Gn,ri),null!==di&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(di).buffer))},reset:Fi,resetDefaultState:Vi,dispose:function Vn(){Fi();for(const On in l){const yi=l[On];for(const Gn in yi){const ri=yi[Gn];for(const di in ri)q(ri[di].object),delete ri[di];delete yi[Gn]}delete l[On]}},releaseStatesOfGeometry:function Tt(On){if(void 0===l[On.id])return;const yi=l[On.id];for(const Gn in yi){const ri=yi[Gn];for(const di in ri)q(ri[di].object),delete ri[di];delete yi[Gn]}delete l[On.id]},releaseStatesOfProgram:function tn(On){for(const yi in l){const Gn=l[yi];if(void 0===Gn[On.id])continue;const ri=Gn[On.id];for(const di in ri)q(ri[di].object),delete ri[di];delete Gn[On.id]}},initAttributes:Se,enableAttribute:je,disableUnusedAttributes:Mt}}function bAe(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(f){s=f},this.render=function l(f,g){n.drawArrays(s,f,g),t.update(g,s,1)},this.renderInstances=function d(f,g,T){if(0===T)return;let B,q;if(r)B=n,q="drawArraysInstanced";else if(B=e.get("ANGLE_instanced_arrays"),q="drawArraysInstancedANGLE",null===B)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");B[q](s,f,g,T),t.update(g,s,T)},this.renderMultiDraw=function u(f,g,T){if(0===T)return;const B=e.get("WEBGL_multi_draw");if(null===B)for(let q=0;q<T;q++)this.render(f[q],g[q]);else{B.multiDrawArraysWEBGL(s,f,0,g,0,T);let q=0;for(let re=0;re<T;re++)q+=g[re];t.update(q,s,1)}}}function xAe(n,e,t){let i;function s(Bt){if("highp"===Bt){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Bt="mediump"}return"mediump"===Bt&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let l=void 0!==t.precision?t.precision:"highp";const d=s(l);d!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",d,"instead."),l=d);const u=o||e.has("WEBGL_draw_buffers"),f=!0===t.logarithmicDepthBuffer,g=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),T=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),B=n.getParameter(n.MAX_TEXTURE_SIZE),q=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),re=n.getParameter(n.MAX_VERTEX_ATTRIBS),se=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),ne=n.getParameter(n.MAX_VARYING_VECTORS),De=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),Se=T>0,je=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const Bt=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(Bt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:l,logarithmicDepthBuffer:f,maxTextures:g,maxVertexTextures:T,maxTextureSize:B,maxCubemapSize:q,maxAttributes:re,maxVertexUniforms:se,maxVaryings:ne,maxFragmentUniforms:De,vertexTextures:Se,floatFragmentTextures:je,floatVertexTextures:Se&&je,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function wAe(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new gA,l=new Ca,d={value:null,needsUpdate:!1};function f(g,T,B,q){const re=null!==g?g.length:0;let se=null;if(0!==re){if(se=d.value,!0!==q||null===se){const ne=B+4*re,De=T.matrixWorldInverse;l.getNormalMatrix(De),(null===se||se.length<ne)&&(se=new Float32Array(ne));for(let Se=0,je=B;Se!==re;++Se,je+=4)o.copy(g[Se]).applyMatrix4(De,l),o.normal.toArray(se,je),se[je+3]=o.constant}d.value=se,d.needsUpdate=!0}return e.numPlanes=re,e.numIntersection=0,se}this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(g,T){const B=0!==g.length||T||0!==i||r;return r=T,i=g.length,B},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(g,T){t=f(g,T,0)},this.setState=function(g,T,B){const q=g.clippingPlanes,re=g.clipIntersection,se=g.clipShadows,ne=n.get(g);if(!r||null===q||0===q.length||s&&!se)s?f(null):function u(){d.value!==t&&(d.value=t,d.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const De=s?0:i,Se=4*De;let je=ne.clippingState||null;d.value=je,je=f(q,T,Se,B);for(let Dt=0;Dt!==Se;++Dt)je[Dt]=t[Dt];ne.clippingState=je,this.numIntersection=re?this.numPlanes:0,this.numPlanes+=De}}}function CAe(n){let e=new WeakMap;function t(o,l){return 303===l?o.mapping=Oy:304===l&&(o.mapping=Ib),o}function r(o){const l=o.target;l.removeEventListener("dispose",r);const d=e.get(l);void 0!==d&&(e.delete(l),d.dispose())}return{get:function i(o){if(o&&o.isTexture){const l=o.mapping;if(303===l||304===l){if(e.has(o))return t(e.get(o).texture,o.mapping);{const d=o.image;if(d&&d.height>0){const u=new ppe(d.height);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class bC extends L5{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,l=r+t,d=r-t;if(null!==this.view&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,l-=f*this.view.offsetY,d=l-f*this.view.height}this.projectionMatrix.makeOrthographic(s,o,l,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Pq=[.125,.215,.35,.446,.526,.582],U5=new bC,Rq=new fr;let z5=null,H5=0,V5=0;const Gb=(1+Math.sqrt(5))/2,wC=1/Gb,kq=[new Rt(1,1,1),new Rt(-1,1,1),new Rt(1,1,-1),new Rt(-1,1,-1),new Rt(0,Gb,wC),new Rt(0,Gb,-wC),new Rt(wC,0,Gb),new Rt(-wC,0,Gb),new Rt(Gb,wC,0),new Rt(-Gb,wC,0)];class Fq{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){z5=this._renderer.getRenderTarget(),H5=this._renderer.getActiveCubeFace(),V5=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Nq(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Lq(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(z5,H5,V5),e.scissorTest=!1,g4(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Oy||e.mapping===Ib?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),z5=this._renderer.getRenderTarget(),H5=this._renderer.getActiveCubeFace(),V5=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Nc,minFilter:Nc,generateMipmaps:!1,type:mA,format:wp,colorSpace:Qu,depthBuffer:!1},r=Oq(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Oq(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function MAe(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+Pq.length;for(let o=0;o<s;o++){const l=Math.pow(2,r);t.push(l);let d=1/l;o>n-4?d=Pq[o-n+4-1]:0===o&&(d=0),i.push(d);const u=1/(l-2),f=-u,g=1+u,T=[f,f,g,f,g,g,f,f,g,g,f,g],B=6,q=6,re=3,se=2,ne=1,De=new Float32Array(re*q*B),Se=new Float32Array(se*q*B),je=new Float32Array(ne*q*B);for(let Mt=0;Mt<B;Mt++){const Bt=Mt%3*2/3-1,Jt=Mt>2?0:-1;De.set([Bt,Jt,0,Bt+2/3,Jt,0,Bt+2/3,Jt+1,0,Bt,Jt,0,Bt+2/3,Jt+1,0,Bt,Jt+1,0],re*q*Mt),Se.set(T,se*q*Mt),je.set([Mt,Mt,Mt,Mt,Mt,Mt],ne*q*Mt)}const Dt=new Qs;Dt.setAttribute("position",new To(De,re)),Dt.setAttribute("uv",new To(Se,se)),Dt.setAttribute("faceIndex",new To(je,ne)),e.push(Dt),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function SAe(n,e,t){const i=new Float32Array(20),r=new Rt(0,1,0);return new Cu({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Yo(this._lodPlanes[0],e);this._renderer.compile(t,U5)}_sceneToCubeUV(e,t,i,r){const l=new Mu(90,1,t,i),d=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],f=this._renderer,g=f.autoClear,T=f.toneMapping;f.getClearColor(Rq),f.toneMapping=Fy,f.autoClear=!1;const B=new yd({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),q=new Yo(new Mp,B);let re=!1;const se=e.background;se?se.isColor&&(B.color.copy(se),e.background=null,re=!0):(B.color.copy(Rq),re=!0);for(let ne=0;ne<6;ne++){const De=ne%3;0===De?(l.up.set(0,d[ne],0),l.lookAt(u[ne],0,0)):1===De?(l.up.set(0,0,d[ne]),l.lookAt(0,u[ne],0)):(l.up.set(0,d[ne],0),l.lookAt(0,0,u[ne]));const Se=this._cubeSize;g4(r,De*Se,ne>2?Se:0,Se,Se),f.setRenderTarget(r),re&&f.render(q,l),f.render(e,l)}q.geometry.dispose(),q.material.dispose(),f.toneMapping=T,f.autoClear=g,e.background=se}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Oy||e.mapping===Ib;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Nq()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Lq());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Yo(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const d=this._cubeSize;g4(t,0,0,3*d,2*d),i.setRenderTarget(t),i.render(o,U5)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,kq[(r-1)%kq.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,l){const d=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const g=new Yo(this._lodPlanes[r],u),T=u.uniforms,B=this._sizeLods[i]-1,q=isFinite(s)?Math.PI/(2*B):2*Math.PI/39,re=s/q,se=isFinite(s)?1+Math.floor(3*re):20;se>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${se} samples when the maximum is set to 20`);const ne=[];let De=0;for(let Bt=0;Bt<20;++Bt){const Jt=Bt/re,Vn=Math.exp(-Jt*Jt/2);ne.push(Vn),0===Bt?De+=Vn:Bt<se&&(De+=2*Vn)}for(let Bt=0;Bt<ne.length;Bt++)ne[Bt]=ne[Bt]/De;T.envMap.value=e.texture,T.samples.value=se,T.weights.value=ne,T.latitudinal.value="latitudinal"===o,l&&(T.poleAxis.value=l);const{_lodMax:Se}=this;T.dTheta.value=q,T.mipInt.value=Se-i;const je=this._sizeLods[r];g4(t,3*je*(r>Se-4?r-Se+4:0),4*(this._cubeSize-je),3*je,2*je),d.setRenderTarget(t),d.render(g,U5)}}function Oq(n,e,t){const i=new Wu(n,e,t);return i.texture.mapping=vE,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function g4(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Lq(){return new Cu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Nq(){return new Cu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function EAe(n){let e=new WeakMap,t=null;function s(l){const d=l.target;d.removeEventListener("dispose",s);const u=e.get(d);void 0!==u&&(e.delete(d),u.dispose())}return{get:function i(l){if(l&&l.isTexture){const d=l.mapping,u=303===d||304===d,f=d===Oy||d===Ib;if(u||f){if(l.isRenderTargetTexture&&!0===l.needsPMREMUpdate){l.needsPMREMUpdate=!1;let g=e.get(l);return null===t&&(t=new Fq(n)),g=u?t.fromEquirectangular(l,g):t.fromCubemap(l,g),e.set(l,g),g.texture}if(e.has(l))return e.get(l).texture;{const g=l.image;if(u&&g&&g.height>0||f&&g&&function r(l){let d=0;for(let f=0;f<6;f++)void 0!==l[f]&&d++;return 6===d}(g)){null===t&&(t=new Fq(n));const T=u?t.fromEquirectangular(l):t.fromCubemap(l);return e.set(l,T),l.addEventListener("dispose",s),T.texture}return null}}}return l},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function TAe(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function DAe(n,e,t,i){const r={},s=new WeakMap;function o(g){const T=g.target;null!==T.index&&e.remove(T.index);for(const q in T.attributes)e.remove(T.attributes[q]);for(const q in T.morphAttributes){const re=T.morphAttributes[q];for(let se=0,ne=re.length;se<ne;se++)e.remove(re[se])}T.removeEventListener("dispose",o),delete r[T.id];const B=s.get(T);B&&(e.remove(B),s.delete(T)),i.releaseStatesOfGeometry(T),!0===T.isInstancedBufferGeometry&&delete T._maxInstanceCount,t.memory.geometries--}function u(g){const T=[],B=g.index,q=g.attributes.position;let re=0;if(null!==B){const De=B.array;re=B.version;for(let Se=0,je=De.length;Se<je;Se+=3){const Dt=De[Se+0],Mt=De[Se+1],Bt=De[Se+2];T.push(Dt,Mt,Mt,Bt,Bt,Dt)}}else{if(void 0===q)return;re=q.version;for(let Se=0,je=q.array.length/3-1;Se<je;Se+=3){const Dt=Se+0,Mt=Se+1,Bt=Se+2;T.push(Dt,Mt,Mt,Bt,Bt,Dt)}}const se=new(sq(T)?xq:bq)(T,1);se.version=re;const ne=s.get(g);ne&&e.remove(ne),s.set(g,se)}return{get:function l(g,T){return!0===r[T.id]||(T.addEventListener("dispose",o),r[T.id]=!0,t.memory.geometries++),T},update:function d(g){const T=g.attributes;for(const q in T)e.update(T[q],n.ARRAY_BUFFER);const B=g.morphAttributes;for(const q in B){const re=B[q];for(let se=0,ne=re.length;se<ne;se++)e.update(re[se],n.ARRAY_BUFFER)}},getWireframeAttribute:function f(g){const T=s.get(g);if(T){const B=g.index;null!==B&&T.version<B.version&&u(g)}else u(g);return s.get(g)}}}function IAe(n,e,t,i){const r=i.isWebGL2;let s,l,d;this.setMode=function o(B){s=B},this.setIndex=function u(B){l=B.type,d=B.bytesPerElement},this.render=function f(B,q){n.drawElements(s,q,l,B*d),t.update(q,s,1)},this.renderInstances=function g(B,q,re){if(0===re)return;let se,ne;if(r)se=n,ne="drawElementsInstanced";else if(se=e.get("ANGLE_instanced_arrays"),ne="drawElementsInstancedANGLE",null===se)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");se[ne](s,q,l,B*d,re),t.update(q,s,re)},this.renderMultiDraw=function T(B,q,re){if(0===re)return;const se=e.get("WEBGL_multi_draw");if(null===se)for(let ne=0;ne<re;ne++)this.render(B[ne]/d,q[ne]);else{se.multiDrawElementsWEBGL(s,q,0,l,B,0,re);let ne=0;for(let De=0;De<re;De++)ne+=q[De];t.update(ne,s,1)}}}function BAe(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,l){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=l*(s/3);break;case n.LINES:t.lines+=l*(s/2);break;case n.LINE_STRIP:t.lines+=l*(s-1);break;case n.LINE_LOOP:t.lines+=l*s;break;case n.POINTS:t.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function PAe(n,e){return n[0]-e[0]}function RAe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function kAe(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new nc,l=[];for(let u=0;u<8;u++)l[u]=[u,0];return{update:function d(u,f,g){const T=u.morphTargetInfluences;if(!0===e.isWebGL2){const B=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,q=void 0!==B?B.length:0;let re=s.get(f);if(void 0===re||re.count!==q){let Fi=function(){Tt.dispose(),s.delete(f),f.removeEventListener("dispose",Fi)};void 0!==re&&re.texture.dispose();const se=void 0!==f.morphAttributes.position,ne=void 0!==f.morphAttributes.normal,De=void 0!==f.morphAttributes.color,Se=f.morphAttributes.position||[],je=f.morphAttributes.normal||[],Dt=f.morphAttributes.color||[];let Mt=0;!0===se&&(Mt=1),!0===ne&&(Mt=2),!0===De&&(Mt=3);let Bt=f.attributes.position.count*Mt,Jt=1;Bt>e.maxTextureSize&&(Jt=Math.ceil(Bt/e.maxTextureSize),Bt=e.maxTextureSize);const Vn=new Float32Array(Bt*Jt*4*q),Tt=new y5(Vn,Bt,Jt,q);Tt.type=pA,Tt.needsUpdate=!0;const tn=4*Mt;for(let Vi=0;Vi<q;Vi++){const On=Se[Vi],yi=je[Vi],Gn=Dt[Vi],ri=Bt*Jt*4*Vi;for(let di=0;di<On.count;di++){const _i=di*tn;!0===se&&(o.fromBufferAttribute(On,di),Vn[ri+_i+0]=o.x,Vn[ri+_i+1]=o.y,Vn[ri+_i+2]=o.z,Vn[ri+_i+3]=0),!0===ne&&(o.fromBufferAttribute(yi,di),Vn[ri+_i+4]=o.x,Vn[ri+_i+5]=o.y,Vn[ri+_i+6]=o.z,Vn[ri+_i+7]=0),!0===De&&(o.fromBufferAttribute(Gn,di),Vn[ri+_i+8]=o.x,Vn[ri+_i+9]=o.y,Vn[ri+_i+10]=o.z,Vn[ri+_i+11]=4===Gn.itemSize?o.w:1)}}re={count:q,texture:Tt,size:new Ni(Bt,Jt)},s.set(f,re),f.addEventListener("dispose",Fi)}if(!0===u.isInstancedMesh&&null!==u.morphTexture)g.getUniforms().setValue(n,"morphTexture",u.morphTexture,t);else{let se=0;for(let De=0;De<T.length;De++)se+=T[De];const ne=f.morphTargetsRelative?1:1-se;g.getUniforms().setValue(n,"morphTargetBaseInfluence",ne),g.getUniforms().setValue(n,"morphTargetInfluences",T)}g.getUniforms().setValue(n,"morphTargetsTexture",re.texture,t),g.getUniforms().setValue(n,"morphTargetsTextureSize",re.size)}else{const B=void 0===T?0:T.length;let q=i[f.id];if(void 0===q||q.length!==B){q=[];for(let Se=0;Se<B;Se++)q[Se]=[Se,0];i[f.id]=q}for(let Se=0;Se<B;Se++){const je=q[Se];je[0]=Se,je[1]=T[Se]}q.sort(RAe);for(let Se=0;Se<8;Se++)Se<B&&q[Se][1]?(l[Se][0]=q[Se][0],l[Se][1]=q[Se][1]):(l[Se][0]=Number.MAX_SAFE_INTEGER,l[Se][1]=0);l.sort(PAe);const re=f.morphAttributes.position,se=f.morphAttributes.normal;let ne=0;for(let Se=0;Se<8;Se++){const je=l[Se],Dt=je[0],Mt=je[1];Dt!==Number.MAX_SAFE_INTEGER&&Mt?(re&&f.getAttribute("morphTarget"+Se)!==re[Dt]&&f.setAttribute("morphTarget"+Se,re[Dt]),se&&f.getAttribute("morphNormal"+Se)!==se[Dt]&&f.setAttribute("morphNormal"+Se,se[Dt]),r[Se]=Mt,ne+=Mt):(re&&!0===f.hasAttribute("morphTarget"+Se)&&f.deleteAttribute("morphTarget"+Se),se&&!0===f.hasAttribute("morphNormal"+Se)&&f.deleteAttribute("morphNormal"+Se),r[Se]=0)}const De=f.morphTargetsRelative?1:1-ne;g.getUniforms().setValue(n,"morphTargetBaseInfluence",De),g.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function FAe(n,e,t,i){let r=new WeakMap;function l(d){const u=d.target;u.removeEventListener("dispose",l),t.remove(u.instanceMatrix),null!==u.instanceColor&&t.remove(u.instanceColor)}return{update:function s(d){const u=i.render.frame,g=e.get(d,d.geometry);if(r.get(g)!==u&&(e.update(g),r.set(g,u)),d.isInstancedMesh&&(!1===d.hasEventListener("dispose",l)&&d.addEventListener("dispose",l),r.get(d)!==u&&(t.update(d.instanceMatrix,n.ARRAY_BUFFER),null!==d.instanceColor&&t.update(d.instanceColor,n.ARRAY_BUFFER),r.set(d,u))),d.isSkinnedMesh){const T=d.skeleton;r.get(T)!==u&&(T.update(),r.set(T,u))}return g},dispose:function o(){r=new WeakMap}}}class Uq extends $h{constructor(e,t,i,r,s,o,l,d,u,f){if((f=void 0!==f?f:Pb)!==Pb&&f!==Y2)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&f===Pb&&(i=zy),void 0===i&&f===Y2&&(i=Bb),super(null,r,s,o,l,d,f,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==l?l:gd,this.minFilter=void 0!==d?d:gd,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const zq=new $h,Hq=new Uq(1,1);Hq.compareFunction=515;const Vq=new y5,Gq=new uq,qq=new f4,Qq=[],Wq=[],jq=new Float32Array(16),$q=new Float32Array(9),Xq=new Float32Array(4);function CC(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=Qq[r];if(void 0===s&&(s=new Float32Array(r),Qq[r]=s),0!==e){i.toArray(s,0);for(let o=1,l=0;o!==e;++o)l+=t,n[o].toArray(s,l)}return s}function Su(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Eu(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function _4(n,e){let t=Wq[e];void 0===t&&(t=new Int32Array(e),Wq[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function OAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function LAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Su(t,e))return;n.uniform2fv(this.addr,e),Eu(t,e)}}function NAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Su(t,e))return;n.uniform3fv(this.addr,e),Eu(t,e)}}function UAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Su(t,e))return;n.uniform4fv(this.addr,e),Eu(t,e)}}function zAe(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Su(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Eu(t,e)}else{if(Su(t,i))return;Xq.set(i),n.uniformMatrix2fv(this.addr,!1,Xq),Eu(t,i)}}function HAe(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Su(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Eu(t,e)}else{if(Su(t,i))return;$q.set(i),n.uniformMatrix3fv(this.addr,!1,$q),Eu(t,i)}}function VAe(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Su(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Eu(t,e)}else{if(Su(t,i))return;jq.set(i),n.uniformMatrix4fv(this.addr,!1,jq),Eu(t,i)}}function GAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function qAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Su(t,e))return;n.uniform2iv(this.addr,e),Eu(t,e)}}function QAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Su(t,e))return;n.uniform3iv(this.addr,e),Eu(t,e)}}function WAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Su(t,e))return;n.uniform4iv(this.addr,e),Eu(t,e)}}function jAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function $Ae(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Su(t,e))return;n.uniform2uiv(this.addr,e),Eu(t,e)}}function XAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Su(t,e))return;n.uniform3uiv(this.addr,e),Eu(t,e)}}function YAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Su(t,e))return;n.uniform4uiv(this.addr,e),Eu(t,e)}}function KAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||(this.type===n.SAMPLER_2D_SHADOW?Hq:zq),r)}function ZAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Gq,r)}function JAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||qq,r)}function ege(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Vq,r)}function nge(n,e){n.uniform1fv(this.addr,e)}function ige(n,e){const t=CC(e,this.size,2);n.uniform2fv(this.addr,t)}function rge(n,e){const t=CC(e,this.size,3);n.uniform3fv(this.addr,t)}function sge(n,e){const t=CC(e,this.size,4);n.uniform4fv(this.addr,t)}function oge(n,e){const t=CC(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function age(n,e){const t=CC(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function lge(n,e){const t=CC(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function cge(n,e){n.uniform1iv(this.addr,e)}function dge(n,e){n.uniform2iv(this.addr,e)}function uge(n,e){n.uniform3iv(this.addr,e)}function hge(n,e){n.uniform4iv(this.addr,e)}function fge(n,e){n.uniform1uiv(this.addr,e)}function pge(n,e){n.uniform2uiv(this.addr,e)}function mge(n,e){n.uniform3uiv(this.addr,e)}function Age(n,e){n.uniform4uiv(this.addr,e)}function gge(n,e,t){const i=this.cache,r=e.length,s=_4(t,r);Su(i,s)||(n.uniform1iv(this.addr,s),Eu(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||zq,s[o])}function _ge(n,e,t){const i=this.cache,r=e.length,s=_4(t,r);Su(i,s)||(n.uniform1iv(this.addr,s),Eu(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||Gq,s[o])}function yge(n,e,t){const i=this.cache,r=e.length,s=_4(t,r);Su(i,s)||(n.uniform1iv(this.addr,s),Eu(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||qq,s[o])}function vge(n,e,t){const i=this.cache,r=e.length,s=_4(t,r);Su(i,s)||(n.uniform1iv(this.addr,s),Eu(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||Vq,s[o])}class xge{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function tge(n){switch(n){case 5126:return OAe;case 35664:return LAe;case 35665:return NAe;case 35666:return UAe;case 35674:return zAe;case 35675:return HAe;case 35676:return VAe;case 5124:case 35670:return GAe;case 35667:case 35671:return qAe;case 35668:case 35672:return QAe;case 35669:case 35673:return WAe;case 5125:return jAe;case 36294:return $Ae;case 36295:return XAe;case 36296:return YAe;case 35678:case 36198:case 36298:case 36306:case 35682:return KAe;case 35679:case 36299:case 36307:return ZAe;case 35680:case 36300:case 36308:case 36293:return JAe;case 36289:case 36303:case 36311:case 36292:return ege}}(t.type)}}class wge{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function bge(n){switch(n){case 5126:return nge;case 35664:return ige;case 35665:return rge;case 35666:return sge;case 35674:return oge;case 35675:return age;case 35676:return lge;case 5124:case 35670:return cge;case 35667:case 35671:return dge;case 35668:case 35672:return uge;case 35669:case 35673:return hge;case 5125:return fge;case 36294:return pge;case 36295:return mge;case 36296:return Age;case 35678:case 36198:case 36298:case 36306:case 35682:return gge;case 35679:case 36299:case 36307:return _ge;case 35680:case 36300:case 36308:case 36293:return yge;case 36289:case 36303:case 36311:case 36292:return vge}}(t.type)}}class Cge{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const l=r[s];l.setValue(e,t[l.id],i)}}}const q5=/(\w+)(\])?(\[|\.)?/g;function Yq(n,e){n.seq.push(e),n.map[e.id]=e}function Mge(n,e,t){const i=n.name,r=i.length;for(q5.lastIndex=0;;){const s=q5.exec(i);let l=s[1];const u=s[3];if("]"===s[2]&&(l|=0),void 0===u||"["===u&&q5.lastIndex+2===r){Yq(t,void 0===u?new xge(l,n,e):new wge(l,n,e));break}{let g=t.map[l];void 0===g&&(g=new Cge(l),Yq(t,g)),t=g}}}class y4{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Mge(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const l=t[s],d=i[l.id];!1!==d.needsUpdate&&l.setValue(e,d.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function Kq(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const Sge=37297;let Ege=0;function Zq(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Tge(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const l=o+1;i.push(`${l===e?">":" "} ${l}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Ige(n,e){const t=function Dge(n){const e=Hl.getPrimaries(Hl.workingColorSpace),t=Hl.getPrimaries(n);let i;switch(e===t?i="":e===qI&&t===GI?i="LinearDisplayP3ToLinearSRGB":e===GI&&t===qI&&(i="LinearSRGBToLinearDisplayP3"),n){case Qu:case HI:return[i,"LinearTransferOETF"];case cu:case h5:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Bge(n,e){let t;switch(e){case rfe:t="Linear";break;case sfe:t="Reinhard";break;case ofe:t="OptimizedCineon";break;case afe:t="ACESFilmic";break;case cfe:t="AgX";break;case dfe:t="Neutral";break;case lfe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function MC(n){return""!==n}function Jq(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function eQ(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Oge=/^[ \t]*#include +<([\w\d./]+)>/gm;function Q5(n){return n.replace(Oge,Nge)}const Lge=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Nge(n,e){let t=pa[e];if(void 0===t){const i=Lge.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=pa[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return Q5(t)}const Uge=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function tQ(n){return n.replace(Uge,zge)}function zge(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function nQ(n){let e=`precision ${n.precision} float;\n\tprecision ${n.precision} int;\n\tprecision ${n.precision} sampler2D;\n\tprecision ${n.precision} samplerCube;\n\t`;return n.isWebGL2&&(e+=`precision ${n.precision} sampler3D;\n\t\tprecision ${n.precision} sampler2DArray;\n\t\tprecision ${n.precision} sampler2DShadow;\n\t\tprecision ${n.precision} samplerCubeShadow;\n\t\tprecision ${n.precision} sampler2DArrayShadow;\n\t\tprecision ${n.precision} isampler2D;\n\t\tprecision ${n.precision} isampler3D;\n\t\tprecision ${n.precision} isamplerCube;\n\t\tprecision ${n.precision} isampler2DArray;\n\t\tprecision ${n.precision} usampler2D;\n\t\tprecision ${n.precision} usampler3D;\n\t\tprecision ${n.precision} usamplerCube;\n\t\tprecision ${n.precision} usampler2DArray;\n\t\t`),"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function Wge(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,l=t.fragmentShader;const d=function Hge(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===fG?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Phe?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Z_&&(e="SHADOWMAP_TYPE_VSM"),e}(t),u=function Vge(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Oy:case Ib:e="ENVMAP_TYPE_CUBE";break;case vE:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),f=function Gge(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Ib&&(e="ENVMAP_MODE_REFRACTION"),e}(t),g=function qge(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case LI:e="ENVMAP_BLENDING_MULTIPLY";break;case nfe:e="ENVMAP_BLENDING_MIX";break;case ife:e="ENVMAP_BLENDING_ADD"}return e}(t),T=function Qge(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),B=t.isWebGL2?"":function Pge(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.alphaToCoverage||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(MC).join("\n")}(t),q=function Rge(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(MC).join("\n")}(t),re=function kge(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),se=r.createProgram();let ne,De,Se=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(ne=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re].filter(MC).join("\n"),ne.length>0&&(ne+="\n"),De=[B,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re].filter(MC).join("\n"),De.length>0&&(De+="\n")):(ne=[nQ(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(MC).join("\n"),De=[B,nQ(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",t.envMap?"#define "+g:"",T?"#define CUBEUV_TEXEL_WIDTH "+T.texelWidth:"",T?"#define CUBEUV_TEXEL_HEIGHT "+T.texelHeight:"",T?"#define CUBEUV_MAX_MIP "+T.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Fy?"#define TONE_MAPPING":"",t.toneMapping!==Fy?pa.tonemapping_pars_fragment:"",t.toneMapping!==Fy?Bge("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",pa.colorspace_pars_fragment,Ige("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(MC).join("\n")),o=Q5(o),o=Jq(o,t),o=eQ(o,t),l=Q5(l),l=Jq(l,t),l=eQ(l,t),o=tQ(o),l=tQ(l),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(Se="#version 300 es\n",ne=[q,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+ne,De=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===iq?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===iq?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+De);const Dt=Se+De+l,Mt=Kq(r,r.VERTEX_SHADER,Se+ne+o),Bt=Kq(r,r.FRAGMENT_SHADER,Dt);function Jt(Fi){if(n.debug.checkShaderErrors){const Vi=r.getProgramInfoLog(se).trim(),On=r.getShaderInfoLog(Mt).trim(),yi=r.getShaderInfoLog(Bt).trim();let Gn=!0,ri=!0;if(!1===r.getProgramParameter(se,r.LINK_STATUS))if(Gn=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,se,Mt,Bt);else{const di=Zq(r,Mt,"vertex"),_i=Zq(r,Bt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(se,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+Fi.name+"\nMaterial Type: "+Fi.type+"\n\nProgram Info Log: "+Vi+"\n"+di+"\n"+_i)}else""!==Vi?console.warn("THREE.WebGLProgram: Program Info Log:",Vi):(""===On||""===yi)&&(ri=!1);ri&&(Fi.diagnostics={runnable:Gn,programLog:Vi,vertexShader:{log:On,prefix:ne},fragmentShader:{log:yi,prefix:De}})}r.deleteShader(Mt),r.deleteShader(Bt),Vn=new y4(r,se),Tt=function Fge(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let l=1;s.type===n.FLOAT_MAT2&&(l=2),s.type===n.FLOAT_MAT3&&(l=3),s.type===n.FLOAT_MAT4&&(l=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:l}}return t}(r,se)}let Vn,Tt;r.attachShader(se,Mt),r.attachShader(se,Bt),void 0!==t.index0AttributeName?r.bindAttribLocation(se,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(se,0,"position"),r.linkProgram(se),this.getUniforms=function(){return void 0===Vn&&Jt(this),Vn},this.getAttributes=function(){return void 0===Tt&&Jt(this),Tt};let tn=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===tn&&(tn=r.getProgramParameter(se,Sge)),tn},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(se),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Ege++,this.cacheKey=e,this.usedTimes=1,this.program=se,this.vertexShader=Mt,this.fragmentShader=Bt,this}let jge=0;class $ge{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Xge(e),t.set(e,i)),i}}class Xge{constructor(e){this.id=jge++,this.code=e,this.usedTimes=0}}function Yge(n,e,t,i,r,s,o){const l=new S5,d=new $ge,u=new Set,f=[],g=r.isWebGL2,T=r.logarithmicDepthBuffer,B=r.vertexTextures;let q=r.precision;const re={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function se(Tt){return u.add(Tt),0===Tt?"uv":`uv${Tt}`}return{getParameters:function ne(Tt,tn,Fi,Vi,On){const yi=Vi.fog,Gn=On.geometry,di=(Tt.isMeshStandardMaterial?t:e).get(Tt.envMap||(Tt.isMeshStandardMaterial?Vi.environment:null)),_i=di&&di.mapping===vE?di.image.height:null,sr=re[Tt.type];null!==Tt.precision&&(q=r.getMaxPrecision(Tt.precision),q!==Tt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Tt.precision,"not supported, using",q,"instead."));const pr=Gn.morphAttributes.position||Gn.morphAttributes.normal||Gn.morphAttributes.color,Hr=void 0!==pr?pr.length:0;let ui,xr,is,_s,Ns=0;if(void 0!==Gn.morphAttributes.position&&(Ns=1),void 0!==Gn.morphAttributes.normal&&(Ns=2),void 0!==Gn.morphAttributes.color&&(Ns=3),sr){const Xl=z0[sr];ui=Xl.vertexShader,xr=Xl.fragmentShader}else ui=Tt.vertexShader,xr=Tt.fragmentShader,d.update(Tt),is=d.getVertexShaderID(Tt),_s=d.getFragmentShaderID(Tt);const ws=n.getRenderTarget(),cs=!0===On.isInstancedMesh,Xs=!!Tt.map,es=!!di,ar=!!Tt.aoMap,jr=!!Tt.lightMap,gr=!!Tt.bumpMap,Hs=!!Tt.normalMap,Is=!!Tt.displacementMap,Zs=!!Tt.emissiveMap,Ba=!!Tt.metalnessMap,Mn=!!Tt.roughnessMap,qt=Tt.anisotropy>0,$i=Tt.clearcoat>0,er=Tt.iridescence>0,Lr=Tt.sheen>0,Mr=Tt.transmission>0,sa=qt&&!!Tt.anisotropyMap,Ro=$i&&!!Tt.clearcoatMap,rs=$i&&!!Tt.clearcoatNormalMap,As=$i&&!!Tt.clearcoatRoughnessMap,oa=er&&!!Tt.iridescenceMap,Kr=er&&!!Tt.iridescenceThicknessMap,wd=Lr&&!!Tt.sheenColorMap,Qa=Lr&&!!Tt.sheenRoughnessMap,Mo=!!Tt.specularMap,Js=!!Tt.specularColorMap,_o=!!Tt.specularIntensityMap,Ln=Mr&&!!Tt.transmissionMap,Ar=Mr&&!!Tt.thicknessMap,Jn=!!Tt.alphaMap,Nr=!!Tt.extensions;let Es=Fy;Tt.toneMapped&&(null===ws||!0===ws.isXRRenderTarget)&&(Es=n.toneMapping);const Ka={isWebGL2:g,shaderID:sr,shaderType:Tt.type,shaderName:Tt.name,vertexShader:ui,fragmentShader:xr,defines:Tt.defines,customVertexShaderID:is,customFragmentShaderID:_s,isRawShaderMaterial:!0===Tt.isRawShaderMaterial,glslVersion:Tt.glslVersion,precision:q,batching:!0===On.isBatchedMesh,instancing:cs,instancingColor:cs&&null!==On.instanceColor,instancingMorph:cs&&null!==On.morphTexture,supportsVertexTextures:B,outputColorSpace:null===ws?n.outputColorSpace:!0===ws.isXRRenderTarget?ws.texture.colorSpace:Qu,alphaToCoverage:!!Tt.alphaToCoverage,map:Xs,matcap:!!Tt.matcap,envMap:es,envMapMode:es&&di.mapping,envMapCubeUVHeight:_i,aoMap:ar,lightMap:jr,bumpMap:gr,normalMap:Hs,displacementMap:B&&Is,emissiveMap:Zs,normalMapObjectSpace:Hs&&1===Tt.normalMapType,normalMapTangentSpace:Hs&&0===Tt.normalMapType,metalnessMap:Ba,roughnessMap:Mn,anisotropy:qt,anisotropyMap:sa,clearcoat:$i,clearcoatMap:Ro,clearcoatNormalMap:rs,clearcoatRoughnessMap:As,iridescence:er,iridescenceMap:oa,iridescenceThicknessMap:Kr,sheen:Lr,sheenColorMap:wd,sheenRoughnessMap:Qa,specularMap:Mo,specularColorMap:Js,specularIntensityMap:_o,transmission:Mr,transmissionMap:Ln,thicknessMap:Ar,gradientMap:!!Tt.gradientMap,opaque:!1===Tt.transparent&&1===Tt.blending&&!1===Tt.alphaToCoverage,alphaMap:Jn,alphaTest:Tt.alphaTest>0,alphaHash:!!Tt.alphaHash,combine:Tt.combine,mapUv:Xs&&se(Tt.map.channel),aoMapUv:ar&&se(Tt.aoMap.channel),lightMapUv:jr&&se(Tt.lightMap.channel),bumpMapUv:gr&&se(Tt.bumpMap.channel),normalMapUv:Hs&&se(Tt.normalMap.channel),displacementMapUv:Is&&se(Tt.displacementMap.channel),emissiveMapUv:Zs&&se(Tt.emissiveMap.channel),metalnessMapUv:Ba&&se(Tt.metalnessMap.channel),roughnessMapUv:Mn&&se(Tt.roughnessMap.channel),anisotropyMapUv:sa&&se(Tt.anisotropyMap.channel),clearcoatMapUv:Ro&&se(Tt.clearcoatMap.channel),clearcoatNormalMapUv:rs&&se(Tt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:As&&se(Tt.clearcoatRoughnessMap.channel),iridescenceMapUv:oa&&se(Tt.iridescenceMap.channel),iridescenceThicknessMapUv:Kr&&se(Tt.iridescenceThicknessMap.channel),sheenColorMapUv:wd&&se(Tt.sheenColorMap.channel),sheenRoughnessMapUv:Qa&&se(Tt.sheenRoughnessMap.channel),specularMapUv:Mo&&se(Tt.specularMap.channel),specularColorMapUv:Js&&se(Tt.specularColorMap.channel),specularIntensityMapUv:_o&&se(Tt.specularIntensityMap.channel),transmissionMapUv:Ln&&se(Tt.transmissionMap.channel),thicknessMapUv:Ar&&se(Tt.thicknessMap.channel),alphaMapUv:Jn&&se(Tt.alphaMap.channel),vertexTangents:!!Gn.attributes.tangent&&(Hs||qt),vertexColors:Tt.vertexColors,vertexAlphas:!0===Tt.vertexColors&&!!Gn.attributes.color&&4===Gn.attributes.color.itemSize,pointsUvs:!0===On.isPoints&&!!Gn.attributes.uv&&(Xs||Jn),fog:!!yi,useFog:!0===Tt.fog,fogExp2:!!yi&&yi.isFogExp2,flatShading:!0===Tt.flatShading,sizeAttenuation:!0===Tt.sizeAttenuation,logarithmicDepthBuffer:T,skinning:!0===On.isSkinnedMesh,morphTargets:void 0!==Gn.morphAttributes.position,morphNormals:void 0!==Gn.morphAttributes.normal,morphColors:void 0!==Gn.morphAttributes.color,morphTargetsCount:Hr,morphTextureStride:Ns,numDirLights:tn.directional.length,numPointLights:tn.point.length,numSpotLights:tn.spot.length,numSpotLightMaps:tn.spotLightMap.length,numRectAreaLights:tn.rectArea.length,numHemiLights:tn.hemi.length,numDirLightShadows:tn.directionalShadowMap.length,numPointLightShadows:tn.pointShadowMap.length,numSpotLightShadows:tn.spotShadowMap.length,numSpotLightShadowsWithMaps:tn.numSpotLightShadowsWithMaps,numLightProbes:tn.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:Tt.dithering,shadowMapEnabled:n.shadowMap.enabled&&Fi.length>0,shadowMapType:n.shadowMap.type,toneMapping:Es,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Xs&&!0===Tt.map.isVideoTexture&&Hl.getTransfer(Tt.map.colorSpace)===Uc,premultipliedAlpha:Tt.premultipliedAlpha,doubleSided:2===Tt.side,flipSided:1===Tt.side,useDepthPacking:Tt.depthPacking>=0,depthPacking:Tt.depthPacking||0,index0AttributeName:Tt.index0AttributeName,extensionDerivatives:Nr&&!0===Tt.extensions.derivatives,extensionFragDepth:Nr&&!0===Tt.extensions.fragDepth,extensionDrawBuffers:Nr&&!0===Tt.extensions.drawBuffers,extensionShaderTextureLOD:Nr&&!0===Tt.extensions.shaderTextureLOD,extensionClipCullDistance:Nr&&!0===Tt.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Nr&&!0===Tt.extensions.multiDraw&&i.has("WEBGL_multi_draw"),rendererExtensionFragDepth:g||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:Tt.customProgramCacheKey()};return Ka.vertexUv1s=u.has(1),Ka.vertexUv2s=u.has(2),Ka.vertexUv3s=u.has(3),u.clear(),Ka},getProgramCacheKey:function De(Tt){const tn=[];if(Tt.shaderID?tn.push(Tt.shaderID):(tn.push(Tt.customVertexShaderID),tn.push(Tt.customFragmentShaderID)),void 0!==Tt.defines)for(const Fi in Tt.defines)tn.push(Fi),tn.push(Tt.defines[Fi]);return!1===Tt.isRawShaderMaterial&&(function Se(Tt,tn){Tt.push(tn.precision),Tt.push(tn.outputColorSpace),Tt.push(tn.envMapMode),Tt.push(tn.envMapCubeUVHeight),Tt.push(tn.mapUv),Tt.push(tn.alphaMapUv),Tt.push(tn.lightMapUv),Tt.push(tn.aoMapUv),Tt.push(tn.bumpMapUv),Tt.push(tn.normalMapUv),Tt.push(tn.displacementMapUv),Tt.push(tn.emissiveMapUv),Tt.push(tn.metalnessMapUv),Tt.push(tn.roughnessMapUv),Tt.push(tn.anisotropyMapUv),Tt.push(tn.clearcoatMapUv),Tt.push(tn.clearcoatNormalMapUv),Tt.push(tn.clearcoatRoughnessMapUv),Tt.push(tn.iridescenceMapUv),Tt.push(tn.iridescenceThicknessMapUv),Tt.push(tn.sheenColorMapUv),Tt.push(tn.sheenRoughnessMapUv),Tt.push(tn.specularMapUv),Tt.push(tn.specularColorMapUv),Tt.push(tn.specularIntensityMapUv),Tt.push(tn.transmissionMapUv),Tt.push(tn.thicknessMapUv),Tt.push(tn.combine),Tt.push(tn.fogExp2),Tt.push(tn.sizeAttenuation),Tt.push(tn.morphTargetsCount),Tt.push(tn.morphAttributeCount),Tt.push(tn.numDirLights),Tt.push(tn.numPointLights),Tt.push(tn.numSpotLights),Tt.push(tn.numSpotLightMaps),Tt.push(tn.numHemiLights),Tt.push(tn.numRectAreaLights),Tt.push(tn.numDirLightShadows),Tt.push(tn.numPointLightShadows),Tt.push(tn.numSpotLightShadows),Tt.push(tn.numSpotLightShadowsWithMaps),Tt.push(tn.numLightProbes),Tt.push(tn.shadowMapType),Tt.push(tn.toneMapping),Tt.push(tn.numClippingPlanes),Tt.push(tn.numClipIntersection),Tt.push(tn.depthPacking)}(tn,Tt),function je(Tt,tn){l.disableAll(),tn.isWebGL2&&l.enable(0),tn.supportsVertexTextures&&l.enable(1),tn.instancing&&l.enable(2),tn.instancingColor&&l.enable(3),tn.instancingMorph&&l.enable(4),tn.matcap&&l.enable(5),tn.envMap&&l.enable(6),tn.normalMapObjectSpace&&l.enable(7),tn.normalMapTangentSpace&&l.enable(8),tn.clearcoat&&l.enable(9),tn.iridescence&&l.enable(10),tn.alphaTest&&l.enable(11),tn.vertexColors&&l.enable(12),tn.vertexAlphas&&l.enable(13),tn.vertexUv1s&&l.enable(14),tn.vertexUv2s&&l.enable(15),tn.vertexUv3s&&l.enable(16),tn.vertexTangents&&l.enable(17),tn.anisotropy&&l.enable(18),tn.alphaHash&&l.enable(19),tn.batching&&l.enable(20),Tt.push(l.mask),l.disableAll(),tn.fog&&l.enable(0),tn.useFog&&l.enable(1),tn.flatShading&&l.enable(2),tn.logarithmicDepthBuffer&&l.enable(3),tn.skinning&&l.enable(4),tn.morphTargets&&l.enable(5),tn.morphNormals&&l.enable(6),tn.morphColors&&l.enable(7),tn.premultipliedAlpha&&l.enable(8),tn.shadowMapEnabled&&l.enable(9),tn.useLegacyLights&&l.enable(10),tn.doubleSided&&l.enable(11),tn.flipSided&&l.enable(12),tn.useDepthPacking&&l.enable(13),tn.dithering&&l.enable(14),tn.transmission&&l.enable(15),tn.sheen&&l.enable(16),tn.opaque&&l.enable(17),tn.pointsUvs&&l.enable(18),tn.decodeVideoTexture&&l.enable(19),tn.alphaToCoverage&&l.enable(20),Tt.push(l.mask)}(tn,Tt),tn.push(n.outputColorSpace)),tn.push(Tt.customProgramCacheKey),tn.join()},getUniforms:function Dt(Tt){const tn=re[Tt.type];let Fi;return Fi=tn?O5.clone(z0[tn].uniforms):Tt.uniforms,Fi},acquireProgram:function Mt(Tt,tn){let Fi;for(let Vi=0,On=f.length;Vi<On;Vi++){const yi=f[Vi];if(yi.cacheKey===tn){Fi=yi,++Fi.usedTimes;break}}return void 0===Fi&&(Fi=new Wge(n,tn,Tt,s),f.push(Fi)),Fi},releaseProgram:function Bt(Tt){if(0==--Tt.usedTimes){const tn=f.indexOf(Tt);f[tn]=f[f.length-1],f.pop(),Tt.destroy()}},releaseShaderCache:function Jt(Tt){d.remove(Tt)},programs:f,dispose:function Vn(){d.dispose()}}}function Kge(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,l){n.get(s)[o]=l},dispose:function r(){n=new WeakMap}}}function Zge(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function iQ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function rQ(){const n=[];let e=0;const t=[],i=[],r=[];function o(g,T,B,q,re,se){let ne=n[e];return void 0===ne?(ne={id:g.id,object:g,geometry:T,material:B,groupOrder:q,renderOrder:g.renderOrder,z:re,group:se},n[e]=ne):(ne.id=g.id,ne.object=g,ne.geometry=T,ne.material=B,ne.groupOrder=q,ne.renderOrder=g.renderOrder,ne.z=re,ne.group=se),e++,ne}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function l(g,T,B,q,re,se){const ne=o(g,T,B,q,re,se);B.transmission>0?i.push(ne):!0===B.transparent?r.push(ne):t.push(ne)},unshift:function d(g,T,B,q,re,se){const ne=o(g,T,B,q,re,se);B.transmission>0?i.unshift(ne):!0===B.transparent?r.unshift(ne):t.unshift(ne)},finish:function f(){for(let g=e,T=n.length;g<T;g++){const B=n[g];if(null===B.id)break;B.id=null,B.object=null,B.geometry=null,B.material=null,B.group=null}},sort:function u(g,T){t.length>1&&t.sort(g||Zge),i.length>1&&i.sort(T||iQ),r.length>1&&r.sort(T||iQ)}}}function Jge(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new rQ,n.set(i,[o])):r>=s.length?(o=new rQ,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function e0e(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Rt,color:new fr};break;case"SpotLight":t={position:new Rt,direction:new Rt,color:new fr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Rt,color:new fr,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Rt,skyColor:new fr,groundColor:new fr};break;case"RectAreaLight":t={color:new fr,position:new Rt,halfWidth:new Rt,halfHeight:new Rt}}return n[e.id]=t,t}}}let n0e=0;function i0e(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function r0e(n,e){const t=new e0e,i=function t0e(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ni};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ni,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let f=0;f<9;f++)r.probe.push(new Rt);const s=new Rt,o=new fo,l=new fo;return{setup:function d(f,g){let T=0,B=0,q=0;for(let Fi=0;Fi<9;Fi++)r.probe[Fi].set(0,0,0);let re=0,se=0,ne=0,De=0,Se=0,je=0,Dt=0,Mt=0,Bt=0,Jt=0,Vn=0;f.sort(i0e);const Tt=!0===g?Math.PI:1;for(let Fi=0,Vi=f.length;Fi<Vi;Fi++){const On=f[Fi],yi=On.color,Gn=On.intensity,ri=On.distance,di=On.shadow&&On.shadow.map?On.shadow.map.texture:null;if(On.isAmbientLight)T+=yi.r*Gn*Tt,B+=yi.g*Gn*Tt,q+=yi.b*Gn*Tt;else if(On.isLightProbe){for(let _i=0;_i<9;_i++)r.probe[_i].addScaledVector(On.sh.coefficients[_i],Gn);Vn++}else if(On.isDirectionalLight){const _i=t.get(On);if(_i.color.copy(On.color).multiplyScalar(On.intensity*Tt),On.castShadow){const sr=On.shadow,pr=i.get(On);pr.shadowBias=sr.bias,pr.shadowNormalBias=sr.normalBias,pr.shadowRadius=sr.radius,pr.shadowMapSize=sr.mapSize,r.directionalShadow[re]=pr,r.directionalShadowMap[re]=di,r.directionalShadowMatrix[re]=On.shadow.matrix,je++}r.directional[re]=_i,re++}else if(On.isSpotLight){const _i=t.get(On);_i.position.setFromMatrixPosition(On.matrixWorld),_i.color.copy(yi).multiplyScalar(Gn*Tt),_i.distance=ri,_i.coneCos=Math.cos(On.angle),_i.penumbraCos=Math.cos(On.angle*(1-On.penumbra)),_i.decay=On.decay,r.spot[ne]=_i;const sr=On.shadow;if(On.map&&(r.spotLightMap[Bt]=On.map,Bt++,sr.updateMatrices(On),On.castShadow&&Jt++),r.spotLightMatrix[ne]=sr.matrix,On.castShadow){const pr=i.get(On);pr.shadowBias=sr.bias,pr.shadowNormalBias=sr.normalBias,pr.shadowRadius=sr.radius,pr.shadowMapSize=sr.mapSize,r.spotShadow[ne]=pr,r.spotShadowMap[ne]=di,Mt++}ne++}else if(On.isRectAreaLight){const _i=t.get(On);_i.color.copy(yi).multiplyScalar(Gn),_i.halfWidth.set(.5*On.width,0,0),_i.halfHeight.set(0,.5*On.height,0),r.rectArea[De]=_i,De++}else if(On.isPointLight){const _i=t.get(On);if(_i.color.copy(On.color).multiplyScalar(On.intensity*Tt),_i.distance=On.distance,_i.decay=On.decay,On.castShadow){const sr=On.shadow,pr=i.get(On);pr.shadowBias=sr.bias,pr.shadowNormalBias=sr.normalBias,pr.shadowRadius=sr.radius,pr.shadowMapSize=sr.mapSize,pr.shadowCameraNear=sr.camera.near,pr.shadowCameraFar=sr.camera.far,r.pointShadow[se]=pr,r.pointShadowMap[se]=di,r.pointShadowMatrix[se]=On.shadow.matrix,Dt++}r.point[se]=_i,se++}else if(On.isHemisphereLight){const _i=t.get(On);_i.skyColor.copy(On.color).multiplyScalar(Gn*Tt),_i.groundColor.copy(On.groundColor).multiplyScalar(Gn*Tt),r.hemi[Se]=_i,Se++}}De>0&&(e.isWebGL2?!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ps.LTC_FLOAT_1,r.rectAreaLTC2=ps.LTC_FLOAT_2):(r.rectAreaLTC1=ps.LTC_HALF_1,r.rectAreaLTC2=ps.LTC_HALF_2):!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ps.LTC_FLOAT_1,r.rectAreaLTC2=ps.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ps.LTC_HALF_1,r.rectAreaLTC2=ps.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=T,r.ambient[1]=B,r.ambient[2]=q;const tn=r.hash;(tn.directionalLength!==re||tn.pointLength!==se||tn.spotLength!==ne||tn.rectAreaLength!==De||tn.hemiLength!==Se||tn.numDirectionalShadows!==je||tn.numPointShadows!==Dt||tn.numSpotShadows!==Mt||tn.numSpotMaps!==Bt||tn.numLightProbes!==Vn)&&(r.directional.length=re,r.spot.length=ne,r.rectArea.length=De,r.point.length=se,r.hemi.length=Se,r.directionalShadow.length=je,r.directionalShadowMap.length=je,r.pointShadow.length=Dt,r.pointShadowMap.length=Dt,r.spotShadow.length=Mt,r.spotShadowMap.length=Mt,r.directionalShadowMatrix.length=je,r.pointShadowMatrix.length=Dt,r.spotLightMatrix.length=Mt+Bt-Jt,r.spotLightMap.length=Bt,r.numSpotLightShadowsWithMaps=Jt,r.numLightProbes=Vn,tn.directionalLength=re,tn.pointLength=se,tn.spotLength=ne,tn.rectAreaLength=De,tn.hemiLength=Se,tn.numDirectionalShadows=je,tn.numPointShadows=Dt,tn.numSpotShadows=Mt,tn.numSpotMaps=Bt,tn.numLightProbes=Vn,r.version=n0e++)},setupView:function u(f,g){let T=0,B=0,q=0,re=0,se=0;const ne=g.matrixWorldInverse;for(let De=0,Se=f.length;De<Se;De++){const je=f[De];if(je.isDirectionalLight){const Dt=r.directional[T];Dt.direction.setFromMatrixPosition(je.matrixWorld),s.setFromMatrixPosition(je.target.matrixWorld),Dt.direction.sub(s),Dt.direction.transformDirection(ne),T++}else if(je.isSpotLight){const Dt=r.spot[q];Dt.position.setFromMatrixPosition(je.matrixWorld),Dt.position.applyMatrix4(ne),Dt.direction.setFromMatrixPosition(je.matrixWorld),s.setFromMatrixPosition(je.target.matrixWorld),Dt.direction.sub(s),Dt.direction.transformDirection(ne),q++}else if(je.isRectAreaLight){const Dt=r.rectArea[re];Dt.position.setFromMatrixPosition(je.matrixWorld),Dt.position.applyMatrix4(ne),l.identity(),o.copy(je.matrixWorld),o.premultiply(ne),l.extractRotation(o),Dt.halfWidth.set(.5*je.width,0,0),Dt.halfHeight.set(0,.5*je.height,0),Dt.halfWidth.applyMatrix4(l),Dt.halfHeight.applyMatrix4(l),re++}else if(je.isPointLight){const Dt=r.point[B];Dt.position.setFromMatrixPosition(je.matrixWorld),Dt.position.applyMatrix4(ne),B++}else if(je.isHemisphereLight){const Dt=r.hemi[se];Dt.direction.setFromMatrixPosition(je.matrixWorld),Dt.direction.transformDirection(ne),se++}}},state:r}}function sQ(n,e){const t=new r0e(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function d(g){t.setup(i,g)},setupLightsView:function u(g){t.setupView(i,g)},pushLight:function o(g){i.push(g)},pushShadow:function l(g){r.push(g)}}}function s0e(n,e){let t=new WeakMap;return{get:function i(s,o=0){const l=t.get(s);let d;return void 0===l?(d=new sQ(n,e),t.set(s,[d])):o>=l.length?(d=new sQ(n,e),l.push(d)):d=l[o],d},dispose:function r(){t=new WeakMap}}}class W5 extends ad{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class oQ extends ad{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function l0e(n,e,t){let i=new m4;const r=new Ni,s=new Ni,o=new nc,l=new W5({depthPacking:3201}),d=new oQ,u={},f=t.maxTextureSize,g={0:1,1:0,2:2},T=new Cu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ni},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),B=T.clone();B.defines.HORIZONTAL_PASS=1;const q=new Qs;q.setAttribute("position",new To(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const re=new Yo(q,T),se=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=fG;let ne=this.type;function De(Mt,Bt){const Jt=e.update(re);T.defines.VSM_SAMPLES!==Mt.blurSamples&&(T.defines.VSM_SAMPLES=Mt.blurSamples,B.defines.VSM_SAMPLES=Mt.blurSamples,T.needsUpdate=!0,B.needsUpdate=!0),null===Mt.mapPass&&(Mt.mapPass=new Wu(r.x,r.y)),T.uniforms.shadow_pass.value=Mt.map.texture,T.uniforms.resolution.value=Mt.mapSize,T.uniforms.radius.value=Mt.radius,n.setRenderTarget(Mt.mapPass),n.clear(),n.renderBufferDirect(Bt,null,Jt,T,re,null),B.uniforms.shadow_pass.value=Mt.mapPass.texture,B.uniforms.resolution.value=Mt.mapSize,B.uniforms.radius.value=Mt.radius,n.setRenderTarget(Mt.map),n.clear(),n.renderBufferDirect(Bt,null,Jt,B,re,null)}function Se(Mt,Bt,Jt,Vn){let Tt=null;const tn=!0===Jt.isPointLight?Mt.customDistanceMaterial:Mt.customDepthMaterial;if(void 0!==tn)Tt=tn;else if(Tt=!0===Jt.isPointLight?d:l,n.localClippingEnabled&&!0===Bt.clipShadows&&Array.isArray(Bt.clippingPlanes)&&0!==Bt.clippingPlanes.length||Bt.displacementMap&&0!==Bt.displacementScale||Bt.alphaMap&&Bt.alphaTest>0||Bt.map&&Bt.alphaTest>0){const Fi=Tt.uuid,Vi=Bt.uuid;let On=u[Fi];void 0===On&&(On={},u[Fi]=On);let yi=On[Vi];void 0===yi&&(yi=Tt.clone(),On[Vi]=yi,Bt.addEventListener("dispose",Dt)),Tt=yi}return Tt.visible=Bt.visible,Tt.wireframe=Bt.wireframe,Tt.side=Vn===Z_?null!==Bt.shadowSide?Bt.shadowSide:Bt.side:null!==Bt.shadowSide?Bt.shadowSide:g[Bt.side],Tt.alphaMap=Bt.alphaMap,Tt.alphaTest=Bt.alphaTest,Tt.map=Bt.map,Tt.clipShadows=Bt.clipShadows,Tt.clippingPlanes=Bt.clippingPlanes,Tt.clipIntersection=Bt.clipIntersection,Tt.displacementMap=Bt.displacementMap,Tt.displacementScale=Bt.displacementScale,Tt.displacementBias=Bt.displacementBias,Tt.wireframeLinewidth=Bt.wireframeLinewidth,Tt.linewidth=Bt.linewidth,!0===Jt.isPointLight&&!0===Tt.isMeshDistanceMaterial&&(n.properties.get(Tt).light=Jt),Tt}function je(Mt,Bt,Jt,Vn,Tt){if(!1===Mt.visible)return;if(Mt.layers.test(Bt.layers)&&(Mt.isMesh||Mt.isLine||Mt.isPoints)&&(Mt.castShadow||Mt.receiveShadow&&Tt===Z_)&&(!Mt.frustumCulled||i.intersectsObject(Mt))){Mt.modelViewMatrix.multiplyMatrices(Jt.matrixWorldInverse,Mt.matrixWorld);const Vi=e.update(Mt),On=Mt.material;if(Array.isArray(On)){const yi=Vi.groups;for(let Gn=0,ri=yi.length;Gn<ri;Gn++){const di=yi[Gn],_i=On[di.materialIndex];if(_i&&_i.visible){const sr=Se(Mt,_i,Vn,Tt);Mt.onBeforeShadow(n,Mt,Bt,Jt,Vi,sr,di),n.renderBufferDirect(Jt,null,Vi,sr,Mt,di),Mt.onAfterShadow(n,Mt,Bt,Jt,Vi,sr,di)}}}else if(On.visible){const yi=Se(Mt,On,Vn,Tt);Mt.onBeforeShadow(n,Mt,Bt,Jt,Vi,yi,null),n.renderBufferDirect(Jt,null,Vi,yi,Mt,null),Mt.onAfterShadow(n,Mt,Bt,Jt,Vi,yi,null)}}const Fi=Mt.children;for(let Vi=0,On=Fi.length;Vi<On;Vi++)je(Fi[Vi],Bt,Jt,Vn,Tt)}function Dt(Mt){Mt.target.removeEventListener("dispose",Dt);for(const Jt in u){const Vn=u[Jt],Tt=Mt.target.uuid;Tt in Vn&&(Vn[Tt].dispose(),delete Vn[Tt])}}this.render=function(Mt,Bt,Jt){if(!1===se.enabled||!1===se.autoUpdate&&!1===se.needsUpdate||0===Mt.length)return;const Vn=n.getRenderTarget(),Tt=n.getActiveCubeFace(),tn=n.getActiveMipmapLevel(),Fi=n.state;Fi.setBlending(0),Fi.buffers.color.setClear(1,1,1,1),Fi.buffers.depth.setTest(!0),Fi.setScissorTest(!1);const Vi=ne!==Z_&&this.type===Z_,On=ne===Z_&&this.type!==Z_;for(let yi=0,Gn=Mt.length;yi<Gn;yi++){const ri=Mt[yi],di=ri.shadow;if(void 0===di){console.warn("THREE.WebGLShadowMap:",ri,"has no shadow.");continue}if(!1===di.autoUpdate&&!1===di.needsUpdate)continue;r.copy(di.mapSize);const _i=di.getFrameExtents();if(r.multiply(_i),s.copy(di.mapSize),(r.x>f||r.y>f)&&(r.x>f&&(s.x=Math.floor(f/_i.x),r.x=s.x*_i.x,di.mapSize.x=s.x),r.y>f&&(s.y=Math.floor(f/_i.y),r.y=s.y*_i.y,di.mapSize.y=s.y)),null===di.map||!0===Vi||!0===On){const pr=this.type!==Z_?{minFilter:gd,magFilter:gd}:{};null!==di.map&&di.map.dispose(),di.map=new Wu(r.x,r.y,pr),di.map.texture.name=ri.name+".shadowMap",di.camera.updateProjectionMatrix()}n.setRenderTarget(di.map),n.clear();const sr=di.getViewportCount();for(let pr=0;pr<sr;pr++){const Hr=di.getViewport(pr);o.set(s.x*Hr.x,s.y*Hr.y,s.x*Hr.z,s.y*Hr.w),Fi.viewport(o),di.updateMatrices(ri,pr),i=di.getFrustum(),je(Bt,Jt,di.camera,ri,this.type)}!0!==di.isPointLightShadow&&this.type===Z_&&De(di,Jt),di.needsUpdate=!1}ne=this.type,se.needsUpdate=!1,n.setRenderTarget(Vn,Tt,tn)}}function c0e(n,e,t){const i=t.isWebGL2,l=new function r(){let Jn=!1;const Vr=new nc;let Ei=null;const Nr=new nc(0,0,0,0);return{setMask:function(Es){Ei!==Es&&!Jn&&(n.colorMask(Es,Es,Es,Es),Ei=Es)},setLocked:function(Es){Jn=Es},setClear:function(Es,Ka,Xl,pc,Cd){!0===Cd&&(Es*=pc,Ka*=pc,Xl*=pc),Vr.set(Es,Ka,Xl,pc),!1===Nr.equals(Vr)&&(n.clearColor(Es,Ka,Xl,pc),Nr.copy(Vr))},reset:function(){Jn=!1,Ei=null,Nr.set(-1,0,0,0)}}},d=new function s(){let Jn=!1,Vr=null,Ei=null,Nr=null;return{setTest:function(Es){Es?cs(n.DEPTH_TEST):po(n.DEPTH_TEST)},setMask:function(Es){Vr!==Es&&!Jn&&(n.depthMask(Es),Vr=Es)},setFunc:function(Es){if(Ei!==Es){switch(Es){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Ei=Es}},setLocked:function(Es){Jn=Es},setClear:function(Es){Nr!==Es&&(n.clearDepth(Es),Nr=Es)},reset:function(){Jn=!1,Vr=null,Ei=null,Nr=null}}},u=new function o(){let Jn=!1,Vr=null,Ei=null,Nr=null,Es=null,Ka=null,Xl=null,pc=null,Cd=null;return{setTest:function(Dl){Jn||(Dl?cs(n.STENCIL_TEST):po(n.STENCIL_TEST))},setMask:function(Dl){Vr!==Dl&&!Jn&&(n.stencilMask(Dl),Vr=Dl)},setFunc:function(Dl,Hc,Zh){(Ei!==Dl||Nr!==Hc||Es!==Zh)&&(n.stencilFunc(Dl,Hc,Zh),Ei=Dl,Nr=Hc,Es=Zh)},setOp:function(Dl,Hc,Zh){(Ka!==Dl||Xl!==Hc||pc!==Zh)&&(n.stencilOp(Dl,Hc,Zh),Ka=Dl,Xl=Hc,pc=Zh)},setLocked:function(Dl){Jn=Dl},setClear:function(Dl){Cd!==Dl&&(n.clearStencil(Dl),Cd=Dl)},reset:function(){Jn=!1,Vr=null,Ei=null,Nr=null,Es=null,Ka=null,Xl=null,pc=null,Cd=null}}},f=new WeakMap,g=new WeakMap;let T={},B={},q=new WeakMap,re=[],se=null,ne=!1,De=null,Se=null,je=null,Dt=null,Mt=null,Bt=null,Jt=null,Vn=new fr(0,0,0),Tt=0,tn=!1,Fi=null,Vi=null,On=null,yi=null,Gn=null;const ri=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let di=!1,_i=0;const sr=n.getParameter(n.VERSION);-1!==sr.indexOf("WebGL")?(_i=parseFloat(/^WebGL (\d)/.exec(sr)[1]),di=_i>=1):-1!==sr.indexOf("OpenGL ES")&&(_i=parseFloat(/^OpenGL ES (\d)/.exec(sr)[1]),di=_i>=2);let pr=null,Hr={};const Ns=n.getParameter(n.SCISSOR_BOX),ui=n.getParameter(n.VIEWPORT),xr=(new nc).fromArray(Ns),is=(new nc).fromArray(ui);function _s(Jn,Vr,Ei,Nr){const Es=new Uint8Array(4),Ka=n.createTexture();n.bindTexture(Jn,Ka),n.texParameteri(Jn,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Jn,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Xl=0;Xl<Ei;Xl++)!i||Jn!==n.TEXTURE_3D&&Jn!==n.TEXTURE_2D_ARRAY?n.texImage2D(Vr+Xl,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Es):n.texImage3D(Vr,0,n.RGBA,1,1,Nr,0,n.RGBA,n.UNSIGNED_BYTE,Es);return Ka}const ws={};function cs(Jn){!0!==T[Jn]&&(n.enable(Jn),T[Jn]=!0)}function po(Jn){!1!==T[Jn]&&(n.disable(Jn),T[Jn]=!1)}ws[n.TEXTURE_2D]=_s(n.TEXTURE_2D,n.TEXTURE_2D,1),ws[n.TEXTURE_CUBE_MAP]=_s(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(ws[n.TEXTURE_2D_ARRAY]=_s(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),ws[n.TEXTURE_3D]=_s(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),l.setClear(0,0,0,1),d.setClear(1),u.setClear(0),cs(n.DEPTH_TEST),d.setFunc(3),Is(!1),Zs(1),cs(n.CULL_FACE),gr(0);const ar={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)ar[103]=n.MIN,ar[104]=n.MAX;else{const Jn=e.get("EXT_blend_minmax");null!==Jn&&(ar[103]=Jn.MIN_EXT,ar[104]=Jn.MAX_EXT)}const jr={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA,211:n.CONSTANT_COLOR,212:n.ONE_MINUS_CONSTANT_COLOR,213:n.CONSTANT_ALPHA,214:n.ONE_MINUS_CONSTANT_ALPHA};function gr(Jn,Vr,Ei,Nr,Es,Ka,Xl,pc,Cd,Dl){if(0!==Jn){if(!1===ne&&(cs(n.BLEND),ne=!0),5===Jn)Es=Es||Vr,Ka=Ka||Ei,Xl=Xl||Nr,(Vr!==Se||Es!==Mt)&&(n.blendEquationSeparate(ar[Vr],ar[Es]),Se=Vr,Mt=Es),(Ei!==je||Nr!==Dt||Ka!==Bt||Xl!==Jt)&&(n.blendFuncSeparate(jr[Ei],jr[Nr],jr[Ka],jr[Xl]),je=Ei,Dt=Nr,Bt=Ka,Jt=Xl),(!1===pc.equals(Vn)||Cd!==Tt)&&(n.blendColor(pc.r,pc.g,pc.b,Cd),Vn.copy(pc),Tt=Cd),De=Jn,tn=!1;else if(Jn!==De||Dl!==tn){if((100!==Se||100!==Mt)&&(n.blendEquation(n.FUNC_ADD),Se=100,Mt=100),Dl)switch(Jn){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Jn)}else switch(Jn){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Jn)}je=null,Dt=null,Bt=null,Jt=null,Vn.set(0,0,0),Tt=0,De=Jn,tn=Dl}}else!0===ne&&(po(n.BLEND),ne=!1)}function Is(Jn){Fi!==Jn&&(n.frontFace(Jn?n.CW:n.CCW),Fi=Jn)}function Zs(Jn){0!==Jn?(cs(n.CULL_FACE),Jn!==Vi&&n.cullFace(1===Jn?n.BACK:2===Jn?n.FRONT:n.FRONT_AND_BACK)):po(n.CULL_FACE),Vi=Jn}function Mn(Jn,Vr,Ei){Jn?(cs(n.POLYGON_OFFSET_FILL),(yi!==Vr||Gn!==Ei)&&(n.polygonOffset(Vr,Ei),yi=Vr,Gn=Ei)):po(n.POLYGON_OFFSET_FILL)}return{buffers:{color:l,depth:d,stencil:u},enable:cs,disable:po,bindFramebuffer:function Xs(Jn,Vr){return B[Jn]!==Vr&&(n.bindFramebuffer(Jn,Vr),B[Jn]=Vr,i&&(Jn===n.DRAW_FRAMEBUFFER&&(B[n.FRAMEBUFFER]=Vr),Jn===n.FRAMEBUFFER&&(B[n.DRAW_FRAMEBUFFER]=Vr)),!0)},drawBuffers:function zn(Jn,Vr){let Ei=re,Nr=!1;if(Jn){Ei=q.get(Vr),void 0===Ei&&(Ei=[],q.set(Vr,Ei));const Es=Jn.textures;if(Ei.length!==Es.length||Ei[0]!==n.COLOR_ATTACHMENT0){for(let Ka=0,Xl=Es.length;Ka<Xl;Ka++)Ei[Ka]=n.COLOR_ATTACHMENT0+Ka;Ei.length=Es.length,Nr=!0}}else Ei[0]!==n.BACK&&(Ei[0]=n.BACK,Nr=!0);if(Nr)if(t.isWebGL2)n.drawBuffers(Ei);else{if(!0!==e.has("WEBGL_draw_buffers"))throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension");e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ei)}},useProgram:function es(Jn){return se!==Jn&&(n.useProgram(Jn),se=Jn,!0)},setBlending:gr,setMaterial:function Hs(Jn,Vr){2===Jn.side?po(n.CULL_FACE):cs(n.CULL_FACE);let Ei=1===Jn.side;Vr&&(Ei=!Ei),Is(Ei),1===Jn.blending&&!1===Jn.transparent?gr(0):gr(Jn.blending,Jn.blendEquation,Jn.blendSrc,Jn.blendDst,Jn.blendEquationAlpha,Jn.blendSrcAlpha,Jn.blendDstAlpha,Jn.blendColor,Jn.blendAlpha,Jn.premultipliedAlpha),d.setFunc(Jn.depthFunc),d.setTest(Jn.depthTest),d.setMask(Jn.depthWrite),l.setMask(Jn.colorWrite);const Nr=Jn.stencilWrite;u.setTest(Nr),Nr&&(u.setMask(Jn.stencilWriteMask),u.setFunc(Jn.stencilFunc,Jn.stencilRef,Jn.stencilFuncMask),u.setOp(Jn.stencilFail,Jn.stencilZFail,Jn.stencilZPass)),Mn(Jn.polygonOffset,Jn.polygonOffsetFactor,Jn.polygonOffsetUnits),!0===Jn.alphaToCoverage?cs(n.SAMPLE_ALPHA_TO_COVERAGE):po(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Is,setCullFace:Zs,setLineWidth:function Ba(Jn){Jn!==On&&(di&&n.lineWidth(Jn),On=Jn)},setPolygonOffset:Mn,setScissorTest:function qt(Jn){Jn?cs(n.SCISSOR_TEST):po(n.SCISSOR_TEST)},activeTexture:function $i(Jn){void 0===Jn&&(Jn=n.TEXTURE0+ri-1),pr!==Jn&&(n.activeTexture(Jn),pr=Jn)},bindTexture:function er(Jn,Vr,Ei){void 0===Ei&&(Ei=null===pr?n.TEXTURE0+ri-1:pr);let Nr=Hr[Ei];void 0===Nr&&(Nr={type:void 0,texture:void 0},Hr[Ei]=Nr),(Nr.type!==Jn||Nr.texture!==Vr)&&(pr!==Ei&&(n.activeTexture(Ei),pr=Ei),n.bindTexture(Jn,Vr||ws[Jn]),Nr.type=Jn,Nr.texture=Vr)},unbindTexture:function Lr(){const Jn=Hr[pr];void 0!==Jn&&void 0!==Jn.type&&(n.bindTexture(Jn.type,null),Jn.type=void 0,Jn.texture=void 0)},compressedTexImage2D:function Mr(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},compressedTexImage3D:function sa(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texImage2D:function Qa(){try{n.texImage2D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texImage3D:function Mo(){try{n.texImage3D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},updateUBOMapping:function Ln(Jn,Vr){let Ei=g.get(Vr);void 0===Ei&&(Ei=new WeakMap,g.set(Vr,Ei));let Nr=Ei.get(Jn);void 0===Nr&&(Nr=n.getUniformBlockIndex(Vr,Jn.name),Ei.set(Jn,Nr))},uniformBlockBinding:function Ar(Jn,Vr){const Nr=g.get(Vr).get(Jn);f.get(Vr)!==Nr&&(n.uniformBlockBinding(Vr,Nr,Jn.__bindingPointIndex),f.set(Vr,Nr))},texStorage2D:function Kr(){try{n.texStorage2D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texStorage3D:function wd(){try{n.texStorage3D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texSubImage2D:function Ro(){try{n.texSubImage2D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texSubImage3D:function rs(){try{n.texSubImage3D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},compressedTexSubImage2D:function As(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},compressedTexSubImage3D:function oa(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},scissor:function Js(Jn){!1===xr.equals(Jn)&&(n.scissor(Jn.x,Jn.y,Jn.z,Jn.w),xr.copy(Jn))},viewport:function _o(Jn){!1===is.equals(Jn)&&(n.viewport(Jn.x,Jn.y,Jn.z,Jn.w),is.copy(Jn))},reset:function ro(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),T={},pr=null,Hr={},B={},q=new WeakMap,re=[],se=null,ne=!1,De=null,Se=null,je=null,Dt=null,Mt=null,Bt=null,Jt=null,Vn=new fr(0,0,0),Tt=0,tn=!1,Fi=null,Vi=null,On=null,yi=null,Gn=null,xr.set(0,0,n.canvas.width,n.canvas.height),is.set(0,0,n.canvas.width,n.canvas.height),l.reset(),d.reset(),u.reset()}}}function d0e(n,e,t,i,r,s,o){const l=r.isWebGL2,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),f=new Ni,g=new WeakMap;let T;const B=new WeakMap;let q=!1;try{q=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function re(Mn,qt){return q?new OffscreenCanvas(Mn,qt):CE("canvas")}function se(Mn,qt,$i,er){let Lr=1;const Mr=Ba(Mn);if((Mr.width>er||Mr.height>er)&&(Lr=er/Math.max(Mr.width,Mr.height)),Lr<1||!0===qt){if(typeof HTMLImageElement<"u"&&Mn instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Mn instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Mn instanceof ImageBitmap||typeof VideoFrame<"u"&&Mn instanceof VideoFrame){const sa=qt?jI:Math.floor,Ro=sa(Lr*Mr.width),rs=sa(Lr*Mr.height);void 0===T&&(T=re(Ro,rs));const As=$i?re(Ro,rs):T;return As.width=Ro,As.height=rs,As.getContext("2d").drawImage(Mn,0,0,Ro,rs),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Mr.width+"x"+Mr.height+") to ("+Ro+"x"+rs+")."),As}return"data"in Mn&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Mr.width+"x"+Mr.height+")."),Mn}return Mn}function ne(Mn){const qt=Ba(Mn);return m5(qt.width)&&m5(qt.height)}function Se(Mn,qt){return Mn.generateMipmaps&&qt&&Mn.minFilter!==gd&&Mn.minFilter!==Nc}function je(Mn){n.generateMipmap(Mn)}function Dt(Mn,qt,$i,er,Lr=!1){if(!1===l)return qt;if(null!==Mn){if(void 0!==n[Mn])return n[Mn];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Mn+"'")}let Mr=qt;if(qt===n.RED&&($i===n.FLOAT&&(Mr=n.R32F),$i===n.HALF_FLOAT&&(Mr=n.R16F),$i===n.UNSIGNED_BYTE&&(Mr=n.R8)),qt===n.RED_INTEGER&&($i===n.UNSIGNED_BYTE&&(Mr=n.R8UI),$i===n.UNSIGNED_SHORT&&(Mr=n.R16UI),$i===n.UNSIGNED_INT&&(Mr=n.R32UI),$i===n.BYTE&&(Mr=n.R8I),$i===n.SHORT&&(Mr=n.R16I),$i===n.INT&&(Mr=n.R32I)),qt===n.RG&&($i===n.FLOAT&&(Mr=n.RG32F),$i===n.HALF_FLOAT&&(Mr=n.RG16F),$i===n.UNSIGNED_BYTE&&(Mr=n.RG8)),qt===n.RG_INTEGER&&($i===n.UNSIGNED_BYTE&&(Mr=n.RG8UI),$i===n.UNSIGNED_SHORT&&(Mr=n.RG16UI),$i===n.UNSIGNED_INT&&(Mr=n.RG32UI),$i===n.BYTE&&(Mr=n.RG8I),$i===n.SHORT&&(Mr=n.RG16I),$i===n.INT&&(Mr=n.RG32I)),qt===n.RGBA){const sa=Lr?VI:Hl.getTransfer(er);$i===n.FLOAT&&(Mr=n.RGBA32F),$i===n.HALF_FLOAT&&(Mr=n.RGBA16F),$i===n.UNSIGNED_BYTE&&(Mr=sa===Uc?n.SRGB8_ALPHA8:n.RGBA8),$i===n.UNSIGNED_SHORT_4_4_4_4&&(Mr=n.RGBA4),$i===n.UNSIGNED_SHORT_5_5_5_1&&(Mr=n.RGB5_A1)}return(Mr===n.R16F||Mr===n.R32F||Mr===n.RG16F||Mr===n.RG32F||Mr===n.RGBA16F||Mr===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Mr}function Mt(Mn,qt,$i){return!0===Se(Mn,$i)||Mn.isFramebufferTexture&&Mn.minFilter!==gd&&Mn.minFilter!==Nc?Math.log2(Math.max(qt.width,qt.height))+1:void 0!==Mn.mipmaps&&Mn.mipmaps.length>0?Mn.mipmaps.length:Mn.isCompressedTexture&&Array.isArray(Mn.image)?qt.mipmaps.length:1}function Bt(Mn){return Mn===gd||1004===Mn||Mn===Ny?n.NEAREST:n.LINEAR}function Jt(Mn){const qt=Mn.target;qt.removeEventListener("dispose",Jt),function Tt(Mn){const qt=i.get(Mn);if(void 0===qt.__webglInit)return;const $i=Mn.source,er=B.get($i);if(er){const Lr=er[qt.__cacheKey];Lr.usedTimes--,0===Lr.usedTimes&&tn(Mn),0===Object.keys(er).length&&B.delete($i)}i.remove(Mn)}(qt),qt.isVideoTexture&&g.delete(qt)}function Vn(Mn){const qt=Mn.target;qt.removeEventListener("dispose",Vn),function Fi(Mn){const qt=i.get(Mn);if(Mn.depthTexture&&Mn.depthTexture.dispose(),Mn.isWebGLCubeRenderTarget)for(let er=0;er<6;er++){if(Array.isArray(qt.__webglFramebuffer[er]))for(let Lr=0;Lr<qt.__webglFramebuffer[er].length;Lr++)n.deleteFramebuffer(qt.__webglFramebuffer[er][Lr]);else n.deleteFramebuffer(qt.__webglFramebuffer[er]);qt.__webglDepthbuffer&&n.deleteRenderbuffer(qt.__webglDepthbuffer[er])}else{if(Array.isArray(qt.__webglFramebuffer))for(let er=0;er<qt.__webglFramebuffer.length;er++)n.deleteFramebuffer(qt.__webglFramebuffer[er]);else n.deleteFramebuffer(qt.__webglFramebuffer);if(qt.__webglDepthbuffer&&n.deleteRenderbuffer(qt.__webglDepthbuffer),qt.__webglMultisampledFramebuffer&&n.deleteFramebuffer(qt.__webglMultisampledFramebuffer),qt.__webglColorRenderbuffer)for(let er=0;er<qt.__webglColorRenderbuffer.length;er++)qt.__webglColorRenderbuffer[er]&&n.deleteRenderbuffer(qt.__webglColorRenderbuffer[er]);qt.__webglDepthRenderbuffer&&n.deleteRenderbuffer(qt.__webglDepthRenderbuffer)}const $i=Mn.textures;for(let er=0,Lr=$i.length;er<Lr;er++){const Mr=i.get($i[er]);Mr.__webglTexture&&(n.deleteTexture(Mr.__webglTexture),o.memory.textures--),i.remove($i[er])}i.remove(Mn)}(qt)}function tn(Mn){const qt=i.get(Mn);n.deleteTexture(qt.__webglTexture),delete B.get(Mn.source)[qt.__cacheKey],o.memory.textures--}let Vi=0;function ri(Mn,qt){const $i=i.get(Mn);if(Mn.isVideoTexture&&function Is(Mn){const qt=o.render.frame;g.get(Mn)!==qt&&(g.set(Mn,qt),Mn.update())}(Mn),!1===Mn.isRenderTargetTexture&&Mn.version>0&&$i.__version!==Mn.version){const er=Mn.image;if(null===er)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==er.complete)return void is($i,Mn,qt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,$i.__webglTexture,n.TEXTURE0+qt)}const pr={[Ly]:n.REPEAT,[bh]:n.CLAMP_TO_EDGE,[$2]:n.MIRRORED_REPEAT},Hr={[gd]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,[Ny]:n.NEAREST_MIPMAP_LINEAR,[Nc]:n.LINEAR,[X2]:n.LINEAR_MIPMAP_NEAREST,[fA]:n.LINEAR_MIPMAP_LINEAR},Ns={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function ui(Mn,qt,$i){if(qt.type===pA&&!1===e.has("OES_texture_float_linear")&&(qt.magFilter===Nc||qt.magFilter===X2||qt.magFilter===Ny||qt.magFilter===fA||qt.minFilter===Nc||qt.minFilter===X2||qt.minFilter===Ny||qt.minFilter===fA)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),$i?(n.texParameteri(Mn,n.TEXTURE_WRAP_S,pr[qt.wrapS]),n.texParameteri(Mn,n.TEXTURE_WRAP_T,pr[qt.wrapT]),(Mn===n.TEXTURE_3D||Mn===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Mn,n.TEXTURE_WRAP_R,pr[qt.wrapR]),n.texParameteri(Mn,n.TEXTURE_MAG_FILTER,Hr[qt.magFilter]),n.texParameteri(Mn,n.TEXTURE_MIN_FILTER,Hr[qt.minFilter])):(n.texParameteri(Mn,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(Mn,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(Mn===n.TEXTURE_3D||Mn===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Mn,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(qt.wrapS!==bh||qt.wrapT!==bh)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(Mn,n.TEXTURE_MAG_FILTER,Bt(qt.magFilter)),n.texParameteri(Mn,n.TEXTURE_MIN_FILTER,Bt(qt.minFilter)),qt.minFilter!==gd&&qt.minFilter!==Nc&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),qt.compareFunction&&(n.texParameteri(Mn,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Mn,n.TEXTURE_COMPARE_FUNC,Ns[qt.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(qt.magFilter===gd||qt.minFilter!==Ny&&qt.minFilter!==fA||qt.type===pA&&!1===e.has("OES_texture_float_linear")||!1===l&&qt.type===mA&&!1===e.has("OES_texture_half_float_linear"))return;if(qt.anisotropy>1||i.get(qt).__currentAnisotropy){const er=e.get("EXT_texture_filter_anisotropic");n.texParameterf(Mn,er.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(qt.anisotropy,r.getMaxAnisotropy())),i.get(qt).__currentAnisotropy=qt.anisotropy}}}function xr(Mn,qt){let $i=!1;void 0===Mn.__webglInit&&(Mn.__webglInit=!0,qt.addEventListener("dispose",Jt));const er=qt.source;let Lr=B.get(er);void 0===Lr&&(Lr={},B.set(er,Lr));const Mr=function Gn(Mn){const qt=[];return qt.push(Mn.wrapS),qt.push(Mn.wrapT),qt.push(Mn.wrapR||0),qt.push(Mn.magFilter),qt.push(Mn.minFilter),qt.push(Mn.anisotropy),qt.push(Mn.internalFormat),qt.push(Mn.format),qt.push(Mn.type),qt.push(Mn.generateMipmaps),qt.push(Mn.premultiplyAlpha),qt.push(Mn.flipY),qt.push(Mn.unpackAlignment),qt.push(Mn.colorSpace),qt.join()}(qt);if(Mr!==Mn.__cacheKey){void 0===Lr[Mr]&&(Lr[Mr]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,$i=!0),Lr[Mr].usedTimes++;const sa=Lr[Mn.__cacheKey];void 0!==sa&&(Lr[Mn.__cacheKey].usedTimes--,0===sa.usedTimes&&tn(qt)),Mn.__cacheKey=Mr,Mn.__webglTexture=Lr[Mr].texture}return $i}function is(Mn,qt,$i){let er=n.TEXTURE_2D;(qt.isDataArrayTexture||qt.isCompressedArrayTexture)&&(er=n.TEXTURE_2D_ARRAY),qt.isData3DTexture&&(er=n.TEXTURE_3D);const Lr=xr(Mn,qt),Mr=qt.source;t.bindTexture(er,Mn.__webglTexture,n.TEXTURE0+$i);const sa=i.get(Mr);if(Mr.version!==sa.__version||!0===Lr){t.activeTexture(n.TEXTURE0+$i);const Ro=Hl.getPrimaries(Hl.workingColorSpace),rs=""===qt.colorSpace?null:Hl.getPrimaries(qt.colorSpace),As=""===qt.colorSpace||Ro===rs?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,qt.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qt.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,qt.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,As);const oa=function De(Mn){return!l&&(Mn.wrapS!==bh||Mn.wrapT!==bh||Mn.minFilter!==gd&&Mn.minFilter!==Nc)}(qt)&&!1===ne(qt.image);let Kr=se(qt.image,oa,!1,r.maxTextureSize);Kr=Zs(qt,Kr);const wd=ne(Kr)||l,Qa=s.convert(qt.format,qt.colorSpace);let _o,Mo=s.convert(qt.type),Js=Dt(qt.internalFormat,Qa,Mo,qt.colorSpace,qt.isVideoTexture);ui(er,qt,wd);const Ln=qt.mipmaps,Ar=l&&!0!==qt.isVideoTexture&&36196!==Js,ro=void 0===sa.__version||!0===Lr,Jn=Mr.dataReady,Vr=Mt(qt,Kr,wd);if(qt.isDepthTexture)Js=n.DEPTH_COMPONENT,l?Js=qt.type===pA?n.DEPTH_COMPONENT32F:qt.type===zy?n.DEPTH_COMPONENT24:qt.type===Bb?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:qt.type===pA&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),qt.format===Pb&&Js===n.DEPTH_COMPONENT&&1012!==qt.type&&qt.type!==zy&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),qt.type=zy,Mo=s.convert(qt.type)),qt.format===Y2&&Js===n.DEPTH_COMPONENT&&(Js=n.DEPTH_STENCIL,qt.type!==Bb&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),qt.type=Bb,Mo=s.convert(qt.type))),ro&&(Ar?t.texStorage2D(n.TEXTURE_2D,1,Js,Kr.width,Kr.height):t.texImage2D(n.TEXTURE_2D,0,Js,Kr.width,Kr.height,0,Qa,Mo,null));else if(qt.isDataTexture)if(Ln.length>0&&wd){Ar&&ro&&t.texStorage2D(n.TEXTURE_2D,Vr,Js,Ln[0].width,Ln[0].height);for(let Ei=0,Nr=Ln.length;Ei<Nr;Ei++)_o=Ln[Ei],Ar?Jn&&t.texSubImage2D(n.TEXTURE_2D,Ei,0,0,_o.width,_o.height,Qa,Mo,_o.data):t.texImage2D(n.TEXTURE_2D,Ei,Js,_o.width,_o.height,0,Qa,Mo,_o.data);qt.generateMipmaps=!1}else Ar?(ro&&t.texStorage2D(n.TEXTURE_2D,Vr,Js,Kr.width,Kr.height),Jn&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Kr.width,Kr.height,Qa,Mo,Kr.data)):t.texImage2D(n.TEXTURE_2D,0,Js,Kr.width,Kr.height,0,Qa,Mo,Kr.data);else if(qt.isCompressedTexture)if(qt.isCompressedArrayTexture){Ar&&ro&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Vr,Js,Ln[0].width,Ln[0].height,Kr.depth);for(let Ei=0,Nr=Ln.length;Ei<Nr;Ei++)_o=Ln[Ei],qt.format!==wp?null!==Qa?Ar?Jn&&t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ei,0,0,0,_o.width,_o.height,Kr.depth,Qa,_o.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ei,Js,_o.width,_o.height,Kr.depth,0,_o.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ar?Jn&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ei,0,0,0,_o.width,_o.height,Kr.depth,Qa,Mo,_o.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ei,Js,_o.width,_o.height,Kr.depth,0,Qa,Mo,_o.data)}else{Ar&&ro&&t.texStorage2D(n.TEXTURE_2D,Vr,Js,Ln[0].width,Ln[0].height);for(let Ei=0,Nr=Ln.length;Ei<Nr;Ei++)_o=Ln[Ei],qt.format!==wp?null!==Qa?Ar?Jn&&t.compressedTexSubImage2D(n.TEXTURE_2D,Ei,0,0,_o.width,_o.height,Qa,_o.data):t.compressedTexImage2D(n.TEXTURE_2D,Ei,Js,_o.width,_o.height,0,_o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ar?Jn&&t.texSubImage2D(n.TEXTURE_2D,Ei,0,0,_o.width,_o.height,Qa,Mo,_o.data):t.texImage2D(n.TEXTURE_2D,Ei,Js,_o.width,_o.height,0,Qa,Mo,_o.data)}else if(qt.isDataArrayTexture)Ar?(ro&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Vr,Js,Kr.width,Kr.height,Kr.depth),Jn&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Kr.width,Kr.height,Kr.depth,Qa,Mo,Kr.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Js,Kr.width,Kr.height,Kr.depth,0,Qa,Mo,Kr.data);else if(qt.isData3DTexture)Ar?(ro&&t.texStorage3D(n.TEXTURE_3D,Vr,Js,Kr.width,Kr.height,Kr.depth),Jn&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Kr.width,Kr.height,Kr.depth,Qa,Mo,Kr.data)):t.texImage3D(n.TEXTURE_3D,0,Js,Kr.width,Kr.height,Kr.depth,0,Qa,Mo,Kr.data);else if(qt.isFramebufferTexture){if(ro)if(Ar)t.texStorage2D(n.TEXTURE_2D,Vr,Js,Kr.width,Kr.height);else{let Ei=Kr.width,Nr=Kr.height;for(let Es=0;Es<Vr;Es++)t.texImage2D(n.TEXTURE_2D,Es,Js,Ei,Nr,0,Qa,Mo,null),Ei>>=1,Nr>>=1}}else if(Ln.length>0&&wd){if(Ar&&ro){const Ei=Ba(Ln[0]);t.texStorage2D(n.TEXTURE_2D,Vr,Js,Ei.width,Ei.height)}for(let Ei=0,Nr=Ln.length;Ei<Nr;Ei++)_o=Ln[Ei],Ar?Jn&&t.texSubImage2D(n.TEXTURE_2D,Ei,0,0,Qa,Mo,_o):t.texImage2D(n.TEXTURE_2D,Ei,Js,Qa,Mo,_o);qt.generateMipmaps=!1}else if(Ar){if(ro){const Ei=Ba(Kr);t.texStorage2D(n.TEXTURE_2D,Vr,Js,Ei.width,Ei.height)}Jn&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Qa,Mo,Kr)}else t.texImage2D(n.TEXTURE_2D,0,Js,Qa,Mo,Kr);Se(qt,wd)&&je(er),sa.__version=Mr.version,qt.onUpdate&&qt.onUpdate(qt)}Mn.__version=qt.version}function ws(Mn,qt,$i,er,Lr,Mr){const sa=s.convert($i.format,$i.colorSpace),Ro=s.convert($i.type),rs=Dt($i.internalFormat,sa,Ro,$i.colorSpace);if(!i.get(qt).__hasExternalTextures){const oa=Math.max(1,qt.width>>Mr),Kr=Math.max(1,qt.height>>Mr);Lr===n.TEXTURE_3D||Lr===n.TEXTURE_2D_ARRAY?t.texImage3D(Lr,Mr,rs,oa,Kr,qt.depth,0,sa,Ro,null):t.texImage2D(Lr,Mr,rs,oa,Kr,0,sa,Ro,null)}t.bindFramebuffer(n.FRAMEBUFFER,Mn),Hs(qt)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,er,Lr,i.get($i).__webglTexture,0,gr(qt)):(Lr===n.TEXTURE_2D||Lr>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Lr<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,er,Lr,i.get($i).__webglTexture,Mr),t.bindFramebuffer(n.FRAMEBUFFER,null)}function cs(Mn,qt,$i){if(n.bindRenderbuffer(n.RENDERBUFFER,Mn),qt.depthBuffer&&!qt.stencilBuffer){let er=!0===l?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if($i||Hs(qt)){const Lr=qt.depthTexture;Lr&&Lr.isDepthTexture&&(Lr.type===pA?er=n.DEPTH_COMPONENT32F:Lr.type===zy&&(er=n.DEPTH_COMPONENT24));const Mr=gr(qt);Hs(qt)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Mr,er,qt.width,qt.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Mr,er,qt.width,qt.height)}else n.renderbufferStorage(n.RENDERBUFFER,er,qt.width,qt.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,Mn)}else if(qt.depthBuffer&&qt.stencilBuffer){const er=gr(qt);$i&&!1===Hs(qt)?n.renderbufferStorageMultisample(n.RENDERBUFFER,er,n.DEPTH24_STENCIL8,qt.width,qt.height):Hs(qt)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,er,n.DEPTH24_STENCIL8,qt.width,qt.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,qt.width,qt.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,Mn)}else{const er=qt.textures;for(let Lr=0;Lr<er.length;Lr++){const Mr=er[Lr],sa=s.convert(Mr.format,Mr.colorSpace),Ro=s.convert(Mr.type),rs=Dt(Mr.internalFormat,sa,Ro,Mr.colorSpace),As=gr(qt);$i&&!1===Hs(qt)?n.renderbufferStorageMultisample(n.RENDERBUFFER,As,rs,qt.width,qt.height):Hs(qt)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,As,rs,qt.width,qt.height):n.renderbufferStorage(n.RENDERBUFFER,rs,qt.width,qt.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Xs(Mn){const qt=i.get(Mn),$i=!0===Mn.isWebGLCubeRenderTarget;if(Mn.depthTexture&&!qt.__autoAllocateDepthBuffer){if($i)throw new Error("target.depthTexture not supported in Cube render targets");!function po(Mn,qt){if(qt&&qt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Mn),!qt.depthTexture||!qt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(qt.depthTexture).__webglTexture||qt.depthTexture.image.width!==qt.width||qt.depthTexture.image.height!==qt.height)&&(qt.depthTexture.image.width=qt.width,qt.depthTexture.image.height=qt.height,qt.depthTexture.needsUpdate=!0),ri(qt.depthTexture,0);const er=i.get(qt.depthTexture).__webglTexture,Lr=gr(qt);if(qt.depthTexture.format===Pb)Hs(qt)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,er,0,Lr):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,er,0);else{if(qt.depthTexture.format!==Y2)throw new Error("Unknown depthTexture format");Hs(qt)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,er,0,Lr):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,er,0)}}(qt.__webglFramebuffer,Mn)}else if($i){qt.__webglDepthbuffer=[];for(let er=0;er<6;er++)t.bindFramebuffer(n.FRAMEBUFFER,qt.__webglFramebuffer[er]),qt.__webglDepthbuffer[er]=n.createRenderbuffer(),cs(qt.__webglDepthbuffer[er],Mn,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,qt.__webglFramebuffer),qt.__webglDepthbuffer=n.createRenderbuffer(),cs(qt.__webglDepthbuffer,Mn,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function gr(Mn){return Math.min(r.maxSamples,Mn.samples)}function Hs(Mn){const qt=i.get(Mn);return l&&Mn.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==qt.__useRenderToTexture}function Zs(Mn,qt){const $i=Mn.colorSpace,er=Mn.format,Lr=Mn.type;return!0===Mn.isCompressedTexture||!0===Mn.isVideoTexture||1035===Mn.format||$i!==Qu&&""!==$i&&(Hl.getTransfer($i)===Uc?!1===l?!0===e.has("EXT_sRGB")&&er===wp?(Mn.format=1035,Mn.minFilter=Nc,Mn.generateMipmaps=!1):qt=dq.sRGBToLinear(qt):(er!==wp||Lr!==Uy)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",$i)),qt}function Ba(Mn){return typeof HTMLImageElement<"u"&&Mn instanceof HTMLImageElement?(f.width=Mn.naturalWidth||Mn.width,f.height=Mn.naturalHeight||Mn.height):typeof VideoFrame<"u"&&Mn instanceof VideoFrame?(f.width=Mn.displayWidth,f.height=Mn.displayHeight):(f.width=Mn.width,f.height=Mn.height),f}this.allocateTextureUnit=function yi(){const Mn=Vi;return Mn>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Mn+" texture units while this GPU supports only "+r.maxTextures),Vi+=1,Mn},this.resetTextureUnits=function On(){Vi=0},this.setTexture2D=ri,this.setTexture2DArray=function di(Mn,qt){const $i=i.get(Mn);Mn.version>0&&$i.__version!==Mn.version?is($i,Mn,qt):t.bindTexture(n.TEXTURE_2D_ARRAY,$i.__webglTexture,n.TEXTURE0+qt)},this.setTexture3D=function _i(Mn,qt){const $i=i.get(Mn);Mn.version>0&&$i.__version!==Mn.version?is($i,Mn,qt):t.bindTexture(n.TEXTURE_3D,$i.__webglTexture,n.TEXTURE0+qt)},this.setTextureCube=function sr(Mn,qt){const $i=i.get(Mn);Mn.version>0&&$i.__version!==Mn.version?function _s(Mn,qt,$i){if(6!==qt.image.length)return;const er=xr(Mn,qt),Lr=qt.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Mn.__webglTexture,n.TEXTURE0+$i);const Mr=i.get(Lr);if(Lr.version!==Mr.__version||!0===er){t.activeTexture(n.TEXTURE0+$i);const sa=Hl.getPrimaries(Hl.workingColorSpace),Ro=""===qt.colorSpace?null:Hl.getPrimaries(qt.colorSpace),rs=""===qt.colorSpace||sa===Ro?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,qt.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qt.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,qt.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,rs);const As=qt.isCompressedTexture||qt.image[0].isCompressedTexture,oa=qt.image[0]&&qt.image[0].isDataTexture,Kr=[];for(let Ei=0;Ei<6;Ei++)Kr[Ei]=As||oa?oa?qt.image[Ei].image:qt.image[Ei]:se(qt.image[Ei],!1,!0,r.maxCubemapSize),Kr[Ei]=Zs(qt,Kr[Ei]);const wd=Kr[0],Qa=ne(wd)||l,Mo=s.convert(qt.format,qt.colorSpace),Js=s.convert(qt.type),_o=Dt(qt.internalFormat,Mo,Js,qt.colorSpace),Ln=l&&!0!==qt.isVideoTexture,Ar=void 0===Mr.__version||!0===er,ro=Lr.dataReady;let Vr,Jn=Mt(qt,wd,Qa);if(ui(n.TEXTURE_CUBE_MAP,qt,Qa),As){Ln&&Ar&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Jn,_o,wd.width,wd.height);for(let Ei=0;Ei<6;Ei++){Vr=Kr[Ei].mipmaps;for(let Nr=0;Nr<Vr.length;Nr++){const Es=Vr[Nr];qt.format!==wp?null!==Mo?Ln?ro&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr,0,0,Es.width,Es.height,Mo,Es.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr,_o,Es.width,Es.height,0,Es.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ln?ro&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr,0,0,Es.width,Es.height,Mo,Js,Es.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr,_o,Es.width,Es.height,0,Mo,Js,Es.data)}}}else{if(Vr=qt.mipmaps,Ln&&Ar){Vr.length>0&&Jn++;const Ei=Ba(Kr[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Jn,_o,Ei.width,Ei.height)}for(let Ei=0;Ei<6;Ei++)if(oa){Ln?ro&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,0,0,0,Kr[Ei].width,Kr[Ei].height,Mo,Js,Kr[Ei].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,0,_o,Kr[Ei].width,Kr[Ei].height,0,Mo,Js,Kr[Ei].data);for(let Nr=0;Nr<Vr.length;Nr++){const Ka=Vr[Nr].image[Ei].image;Ln?ro&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr+1,0,0,Ka.width,Ka.height,Mo,Js,Ka.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr+1,_o,Ka.width,Ka.height,0,Mo,Js,Ka.data)}}else{Ln?ro&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,0,0,0,Mo,Js,Kr[Ei]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,0,_o,Mo,Js,Kr[Ei]);for(let Nr=0;Nr<Vr.length;Nr++){const Es=Vr[Nr];Ln?ro&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr+1,0,0,Mo,Js,Es.image[Ei]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ei,Nr+1,_o,Mo,Js,Es.image[Ei])}}}Se(qt,Qa)&&je(n.TEXTURE_CUBE_MAP),Mr.__version=Lr.version,qt.onUpdate&&qt.onUpdate(qt)}Mn.__version=qt.version}($i,Mn,qt):t.bindTexture(n.TEXTURE_CUBE_MAP,$i.__webglTexture,n.TEXTURE0+qt)},this.rebindTextures=function zn(Mn,qt,$i){const er=i.get(Mn);void 0!==qt&&ws(er.__webglFramebuffer,Mn,Mn.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==$i&&Xs(Mn)},this.setupRenderTarget=function es(Mn){const qt=Mn.texture,$i=i.get(Mn),er=i.get(qt);Mn.addEventListener("dispose",Vn);const Lr=Mn.textures,Mr=!0===Mn.isWebGLCubeRenderTarget,sa=Lr.length>1,Ro=ne(Mn)||l;if(sa||(void 0===er.__webglTexture&&(er.__webglTexture=n.createTexture()),er.__version=qt.version,o.memory.textures++),Mr){$i.__webglFramebuffer=[];for(let rs=0;rs<6;rs++)if(l&&qt.mipmaps&&qt.mipmaps.length>0){$i.__webglFramebuffer[rs]=[];for(let As=0;As<qt.mipmaps.length;As++)$i.__webglFramebuffer[rs][As]=n.createFramebuffer()}else $i.__webglFramebuffer[rs]=n.createFramebuffer()}else{if(l&&qt.mipmaps&&qt.mipmaps.length>0){$i.__webglFramebuffer=[];for(let rs=0;rs<qt.mipmaps.length;rs++)$i.__webglFramebuffer[rs]=n.createFramebuffer()}else $i.__webglFramebuffer=n.createFramebuffer();if(sa)if(r.drawBuffers)for(let rs=0,As=Lr.length;rs<As;rs++){const oa=i.get(Lr[rs]);void 0===oa.__webglTexture&&(oa.__webglTexture=n.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&Mn.samples>0&&!1===Hs(Mn)){$i.__webglMultisampledFramebuffer=n.createFramebuffer(),$i.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,$i.__webglMultisampledFramebuffer);for(let rs=0;rs<Lr.length;rs++){const As=Lr[rs];$i.__webglColorRenderbuffer[rs]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,$i.__webglColorRenderbuffer[rs]);const oa=s.convert(As.format,As.colorSpace),Kr=s.convert(As.type),wd=Dt(As.internalFormat,oa,Kr,As.colorSpace,!0===Mn.isXRRenderTarget),Qa=gr(Mn);n.renderbufferStorageMultisample(n.RENDERBUFFER,Qa,wd,Mn.width,Mn.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+rs,n.RENDERBUFFER,$i.__webglColorRenderbuffer[rs])}n.bindRenderbuffer(n.RENDERBUFFER,null),Mn.depthBuffer&&($i.__webglDepthRenderbuffer=n.createRenderbuffer(),cs($i.__webglDepthRenderbuffer,Mn,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Mr){t.bindTexture(n.TEXTURE_CUBE_MAP,er.__webglTexture),ui(n.TEXTURE_CUBE_MAP,qt,Ro);for(let rs=0;rs<6;rs++)if(l&&qt.mipmaps&&qt.mipmaps.length>0)for(let As=0;As<qt.mipmaps.length;As++)ws($i.__webglFramebuffer[rs][As],Mn,qt,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+rs,As);else ws($i.__webglFramebuffer[rs],Mn,qt,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+rs,0);Se(qt,Ro)&&je(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(sa){for(let rs=0,As=Lr.length;rs<As;rs++){const oa=Lr[rs],Kr=i.get(oa);t.bindTexture(n.TEXTURE_2D,Kr.__webglTexture),ui(n.TEXTURE_2D,oa,Ro),ws($i.__webglFramebuffer,Mn,oa,n.COLOR_ATTACHMENT0+rs,n.TEXTURE_2D,0),Se(oa,Ro)&&je(n.TEXTURE_2D)}t.unbindTexture()}else{let rs=n.TEXTURE_2D;if((Mn.isWebGL3DRenderTarget||Mn.isWebGLArrayRenderTarget)&&(l?rs=Mn.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(rs,er.__webglTexture),ui(rs,qt,Ro),l&&qt.mipmaps&&qt.mipmaps.length>0)for(let As=0;As<qt.mipmaps.length;As++)ws($i.__webglFramebuffer[As],Mn,qt,n.COLOR_ATTACHMENT0,rs,As);else ws($i.__webglFramebuffer,Mn,qt,n.COLOR_ATTACHMENT0,rs,0);Se(qt,Ro)&&je(rs),t.unbindTexture()}Mn.depthBuffer&&Xs(Mn)},this.updateRenderTargetMipmap=function ar(Mn){const qt=ne(Mn)||l,$i=Mn.textures;for(let er=0,Lr=$i.length;er<Lr;er++){const Mr=$i[er];if(Se(Mr,qt)){const sa=Mn.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ro=i.get(Mr).__webglTexture;t.bindTexture(sa,Ro),je(sa),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function jr(Mn){if(l&&Mn.samples>0&&!1===Hs(Mn)){const qt=Mn.textures,$i=Mn.width,er=Mn.height;let Lr=n.COLOR_BUFFER_BIT;const Mr=[],sa=Mn.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ro=i.get(Mn),rs=qt.length>1;if(rs)for(let As=0;As<qt.length;As++)t.bindFramebuffer(n.FRAMEBUFFER,Ro.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+As,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ro.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+As,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ro.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ro.__webglFramebuffer);for(let As=0;As<qt.length;As++){Mr.push(n.COLOR_ATTACHMENT0+As),Mn.depthBuffer&&Mr.push(sa);const oa=void 0!==Ro.__ignoreDepthValues&&Ro.__ignoreDepthValues;if(!1===oa&&(Mn.depthBuffer&&(Lr|=n.DEPTH_BUFFER_BIT),Mn.stencilBuffer&&(Lr|=n.STENCIL_BUFFER_BIT)),rs&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ro.__webglColorRenderbuffer[As]),!0===oa&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[sa]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[sa])),rs){const Kr=i.get(qt[As]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Kr,0)}n.blitFramebuffer(0,0,$i,er,0,0,$i,er,Lr,n.NEAREST),u&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Mr)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),rs)for(let As=0;As<qt.length;As++){t.bindFramebuffer(n.FRAMEBUFFER,Ro.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+As,n.RENDERBUFFER,Ro.__webglColorRenderbuffer[As]);const oa=i.get(qt[As]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ro.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+As,n.TEXTURE_2D,oa,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ro.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Xs,this.setupFrameBufferTexture=ws,this.useMultisampledRTT=Hs}function u0e(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let l;const d=Hl.getTransfer(o);if(s===Uy)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===zy)return n.UNSIGNED_INT;if(s===pA)return n.FLOAT;if(s===mA)return i?n.HALF_FLOAT:(l=e.get("OES_texture_half_float"),null!==l?l.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===wp)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===Pb)return n.DEPTH_COMPONENT;if(s===Y2)return n.DEPTH_STENCIL;if(1035===s)return l=e.get("EXT_sRGB"),null!==l?l.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(d===Uc){if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===l)return null;if(33776===s)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(l=e.get("WEBGL_compressed_texture_s3tc"),null===l)return null;if(33776===s)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(l=e.get("WEBGL_compressed_texture_pvrtc"),null===l)return null;if(35840===s)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return l=e.get("WEBGL_compressed_texture_etc1"),null!==l?l.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(l=e.get("WEBGL_compressed_texture_etc"),null===l)return null;if(37492===s)return d===Uc?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(37496===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(l=e.get("WEBGL_compressed_texture_astc"),null===l)return null;if(37808===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return d===Uc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(l=e.get("EXT_texture_compression_bptc"),null===l)return null;if(36492===s)return d===Uc?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(l=e.get("EXT_texture_compression_rgtc"),null===l)return null;if(36492===s)return l.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Bb?i?n.UNSIGNED_INT_24_8:(l=e.get("WEBGL_depth_texture"),null!==l?l.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class aQ extends Mu{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class $l extends Ol{constructor(){super(),this.isGroup=!0,this.type="Group"}}const h0e={type:"move"};class j5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new $l,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new $l,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Rt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Rt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new $l,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Rt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Rt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const l=this._targetRay,d=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){o=!0;for(const re of e.hand.values()){const se=t.getJointPose(re,i),ne=this._getHandJoint(u,re);null!==se&&(ne.matrix.fromArray(se.transform.matrix),ne.matrix.decompose(ne.position,ne.rotation,ne.scale),ne.matrixWorldNeedsUpdate=!0,ne.jointRadius=se.radius),ne.visible=null!==se}const T=u.joints["index-finger-tip"].position.distanceTo(u.joints["thumb-tip"].position),B=.02,q=.005;u.inputState.pinching&&T>B+q?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&T<=B-q&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==d&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1));null!==l&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(h0e)))}return null!==l&&(l.visible=null!==r),null!==d&&(d.visible=null!==s),null!==u&&(u.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new $l;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class m0e{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(null===this.texture){const r=new $h;e.properties.get(r).__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}render(e,t){if(null!==this.texture){if(null===this.mesh){const i=t.cameras[0].viewport,r=new Cu({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new Yo(new vC(20,20),r)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class A0e extends t1{constructor(e,t){super();const i=this;let r=null,s=1,o=null,l="local-floor",d=1,u=null,f=null,g=null,T=null,B=null,q=null;const re=new m0e,se=t.getContextAttributes();let ne=null,De=null;const Se=[],je=[],Dt=new Ni;let Mt=null;const Bt=new Mu;Bt.layers.enable(1),Bt.viewport=new nc;const Jt=new Mu;Jt.layers.enable(2),Jt.viewport=new nc;const Vn=[Bt,Jt],Tt=new aQ;Tt.layers.enable(1),Tt.layers.enable(2);let tn=null,Fi=null;function Vi(ui){const xr=je.indexOf(ui.inputSource);if(-1===xr)return;const is=Se[xr];void 0!==is&&(is.update(ui.inputSource,ui.frame,u||o),is.dispatchEvent({type:ui.type,data:ui.inputSource}))}function On(){r.removeEventListener("select",Vi),r.removeEventListener("selectstart",Vi),r.removeEventListener("selectend",Vi),r.removeEventListener("squeeze",Vi),r.removeEventListener("squeezestart",Vi),r.removeEventListener("squeezeend",Vi),r.removeEventListener("end",On),r.removeEventListener("inputsourceschange",yi);for(let ui=0;ui<Se.length;ui++){const xr=je[ui];null!==xr&&(je[ui]=null,Se[ui].disconnect(xr))}tn=null,Fi=null,re.reset(),e.setRenderTarget(ne),B=null,T=null,g=null,r=null,De=null,Ns.stop(),i.isPresenting=!1,e.setPixelRatio(Mt),e.setSize(Dt.width,Dt.height,!1),i.dispatchEvent({type:"sessionend"})}function yi(ui){for(let xr=0;xr<ui.removed.length;xr++){const is=ui.removed[xr],_s=je.indexOf(is);_s>=0&&(je[_s]=null,Se[_s].disconnect(is))}for(let xr=0;xr<ui.added.length;xr++){const is=ui.added[xr];let _s=je.indexOf(is);if(-1===_s){for(let cs=0;cs<Se.length;cs++){if(cs>=je.length){je.push(is),_s=cs;break}if(null===je[cs]){je[cs]=is,_s=cs;break}}if(-1===_s)break}const ws=Se[_s];ws&&ws.connect(is)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ui){let xr=Se[ui];return void 0===xr&&(xr=new j5,Se[ui]=xr),xr.getTargetRaySpace()},this.getControllerGrip=function(ui){let xr=Se[ui];return void 0===xr&&(xr=new j5,Se[ui]=xr),xr.getGripSpace()},this.getHand=function(ui){let xr=Se[ui];return void 0===xr&&(xr=new j5,Se[ui]=xr),xr.getHandSpace()},this.setFramebufferScaleFactor=function(ui){s=ui,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ui){l=ui,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(ui){u=ui},this.getBaseLayer=function(){return null!==T?T:B},this.getBinding=function(){return g},this.getFrame=function(){return q},this.getSession=function(){return r},this.setSession=function(){var ui=(0,ve.A)(function*(xr){if(r=xr,null!==r){if(ne=e.getRenderTarget(),r.addEventListener("select",Vi),r.addEventListener("selectstart",Vi),r.addEventListener("selectend",Vi),r.addEventListener("squeeze",Vi),r.addEventListener("squeezestart",Vi),r.addEventListener("squeezeend",Vi),r.addEventListener("end",On),r.addEventListener("inputsourceschange",yi),!0!==se.xrCompatible&&(yield t.makeXRCompatible()),Mt=e.getPixelRatio(),e.getSize(Dt),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)B=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||se.antialias,alpha:!0,depth:se.depth,stencil:se.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:B}),e.setPixelRatio(1),e.setSize(B.framebufferWidth,B.framebufferHeight,!1),De=new Wu(B.framebufferWidth,B.framebufferHeight,{format:wp,type:Uy,colorSpace:e.outputColorSpace,stencilBuffer:se.stencil});else{let is=null,_s=null,ws=null;se.depth&&(ws=se.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,is=se.stencil?Y2:Pb,_s=se.stencil?Bb:zy);const cs={colorFormat:t.RGBA8,depthFormat:ws,scaleFactor:s};g=new XRWebGLBinding(r,t),T=g.createProjectionLayer(cs),r.updateRenderState({layers:[T]}),e.setPixelRatio(1),e.setSize(T.textureWidth,T.textureHeight,!1),De=new Wu(T.textureWidth,T.textureHeight,{format:wp,type:Uy,depthTexture:new Uq(T.textureWidth,T.textureHeight,_s,void 0,void 0,void 0,void 0,void 0,void 0,is),stencilBuffer:se.stencil,colorSpace:e.outputColorSpace,samples:se.antialias?4:0}),e.properties.get(De).__ignoreDepthValues=T.ignoreDepthValues}De.isXRRenderTarget=!0,this.setFoveation(d),u=null,o=yield r.requestReferenceSpace(l),Ns.setContext(r),Ns.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(xr){return ui.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const Gn=new Rt,ri=new Rt;function _i(ui,xr){null===xr?ui.matrixWorld.copy(ui.matrix):ui.matrixWorld.multiplyMatrices(xr.matrixWorld,ui.matrix),ui.matrixWorldInverse.copy(ui.matrixWorld).invert()}this.updateCamera=function(ui){if(null===r)return;null!==re.texture&&(ui.near=re.depthNear,ui.far=re.depthFar),Tt.near=Jt.near=Bt.near=ui.near,Tt.far=Jt.far=Bt.far=ui.far,(tn!==Tt.near||Fi!==Tt.far)&&(r.updateRenderState({depthNear:Tt.near,depthFar:Tt.far}),tn=Tt.near,Fi=Tt.far,Bt.near=tn,Bt.far=Fi,Jt.near=tn,Jt.far=Fi,Bt.updateProjectionMatrix(),Jt.updateProjectionMatrix(),ui.updateProjectionMatrix());const xr=ui.parent,is=Tt.cameras;_i(Tt,xr);for(let _s=0;_s<is.length;_s++)_i(is[_s],xr);2===is.length?function di(ui,xr,is){Gn.setFromMatrixPosition(xr.matrixWorld),ri.setFromMatrixPosition(is.matrixWorld);const _s=Gn.distanceTo(ri),ws=xr.projectionMatrix.elements,cs=is.projectionMatrix.elements,po=ws[14]/(ws[10]-1),Xs=ws[14]/(ws[10]+1),zn=(ws[9]+1)/ws[5],es=(ws[9]-1)/ws[5],ar=(ws[8]-1)/ws[0],jr=(cs[8]+1)/cs[0],gr=po*ar,Hs=po*jr,Is=_s/(-ar+jr),Zs=Is*-ar;xr.matrixWorld.decompose(ui.position,ui.quaternion,ui.scale),ui.translateX(Zs),ui.translateZ(Is),ui.matrixWorld.compose(ui.position,ui.quaternion,ui.scale),ui.matrixWorldInverse.copy(ui.matrixWorld).invert();const Ba=po+Is,Mn=Xs+Is;ui.projectionMatrix.makePerspective(gr-Zs,Hs+(_s-Zs),zn*Xs/Mn*Ba,es*Xs/Mn*Ba,Ba,Mn),ui.projectionMatrixInverse.copy(ui.projectionMatrix).invert()}(Tt,Bt,Jt):Tt.projectionMatrix.copy(Bt.projectionMatrix),function sr(ui,xr,is){null===is?ui.matrix.copy(xr.matrixWorld):(ui.matrix.copy(is.matrixWorld),ui.matrix.invert(),ui.matrix.multiply(xr.matrixWorld)),ui.matrix.decompose(ui.position,ui.quaternion,ui.scale),ui.updateMatrixWorld(!0),ui.projectionMatrix.copy(xr.projectionMatrix),ui.projectionMatrixInverse.copy(xr.projectionMatrixInverse),ui.isPerspectiveCamera&&(ui.fov=2*tC*Math.atan(1/ui.projectionMatrix.elements[5]),ui.zoom=1)}(ui,Tt,xr)},this.getCamera=function(){return Tt},this.getFoveation=function(){if(null!==T||null!==B)return d},this.setFoveation=function(ui){d=ui,null!==T&&(T.fixedFoveation=ui),null!==B&&void 0!==B.fixedFoveation&&(B.fixedFoveation=ui)},this.hasDepthSensing=function(){return null!==re.texture};let pr=null;const Ns=new Bq;Ns.setAnimationLoop(function Hr(ui,xr){if(f=xr.getViewerPose(u||o),q=xr,null!==f){const is=f.views;null!==B&&(e.setRenderTargetFramebuffer(De,B.framebuffer),e.setRenderTarget(De));let _s=!1;is.length!==Tt.cameras.length&&(Tt.cameras.length=0,_s=!0);for(let cs=0;cs<is.length;cs++){const po=is[cs];let Xs=null;if(null!==B)Xs=B.getViewport(po);else{const es=g.getViewSubImage(T,po);Xs=es.viewport,0===cs&&(e.setRenderTargetTextures(De,es.colorTexture,T.ignoreDepthValues?void 0:es.depthStencilTexture),e.setRenderTarget(De))}let zn=Vn[cs];void 0===zn&&(zn=new Mu,zn.layers.enable(cs),zn.viewport=new nc,Vn[cs]=zn),zn.matrix.fromArray(po.transform.matrix),zn.matrix.decompose(zn.position,zn.quaternion,zn.scale),zn.projectionMatrix.fromArray(po.projectionMatrix),zn.projectionMatrixInverse.copy(zn.projectionMatrix).invert(),zn.viewport.set(Xs.x,Xs.y,Xs.width,Xs.height),0===cs&&(Tt.matrix.copy(zn.matrix),Tt.matrix.decompose(Tt.position,Tt.quaternion,Tt.scale)),!0===_s&&Tt.cameras.push(zn)}const ws=r.enabledFeatures;if(ws&&ws.includes("depth-sensing")){const cs=g.getDepthInformation(is[0]);cs&&cs.isValid&&cs.texture&&re.init(e,cs,r.renderState)}}for(let is=0;is<Se.length;is++){const _s=je[is],ws=Se[is];null!==_s&&void 0!==ws&&ws.update(_s,xr,u||o)}re.render(e,Tt),pr&&pr(ui,xr),xr.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:xr}),q=null}),this.setAnimationLoop=function(ui){pr=ui},this.dispose=function(){}}}const qb=new U0,g0e=new fo;function _0e(n,e){function t(se,ne){!0===se.matrixAutoUpdate&&se.updateMatrix(),ne.value.copy(se.matrix)}function s(se,ne){se.opacity.value=ne.opacity,ne.color&&se.diffuse.value.copy(ne.color),ne.emissive&&se.emissive.value.copy(ne.emissive).multiplyScalar(ne.emissiveIntensity),ne.map&&(se.map.value=ne.map,t(ne.map,se.mapTransform)),ne.alphaMap&&(se.alphaMap.value=ne.alphaMap,t(ne.alphaMap,se.alphaMapTransform)),ne.bumpMap&&(se.bumpMap.value=ne.bumpMap,t(ne.bumpMap,se.bumpMapTransform),se.bumpScale.value=ne.bumpScale,1===ne.side&&(se.bumpScale.value*=-1)),ne.normalMap&&(se.normalMap.value=ne.normalMap,t(ne.normalMap,se.normalMapTransform),se.normalScale.value.copy(ne.normalScale),1===ne.side&&se.normalScale.value.negate()),ne.displacementMap&&(se.displacementMap.value=ne.displacementMap,t(ne.displacementMap,se.displacementMapTransform),se.displacementScale.value=ne.displacementScale,se.displacementBias.value=ne.displacementBias),ne.emissiveMap&&(se.emissiveMap.value=ne.emissiveMap,t(ne.emissiveMap,se.emissiveMapTransform)),ne.specularMap&&(se.specularMap.value=ne.specularMap,t(ne.specularMap,se.specularMapTransform)),ne.alphaTest>0&&(se.alphaTest.value=ne.alphaTest);const De=e.get(ne),Se=De.envMap,je=De.envMapRotation;if(Se&&(se.envMap.value=Se,qb.copy(je),qb.x*=-1,qb.y*=-1,qb.z*=-1,Se.isCubeTexture&&!1===Se.isRenderTargetTexture&&(qb.y*=-1,qb.z*=-1),se.envMapRotation.value.setFromMatrix4(g0e.makeRotationFromEuler(qb)),se.flipEnvMap.value=Se.isCubeTexture&&!1===Se.isRenderTargetTexture?-1:1,se.reflectivity.value=ne.reflectivity,se.ior.value=ne.ior,se.refractionRatio.value=ne.refractionRatio),ne.lightMap){se.lightMap.value=ne.lightMap;const Dt=!0===n._useLegacyLights?Math.PI:1;se.lightMapIntensity.value=ne.lightMapIntensity*Dt,t(ne.lightMap,se.lightMapTransform)}ne.aoMap&&(se.aoMap.value=ne.aoMap,se.aoMapIntensity.value=ne.aoMapIntensity,t(ne.aoMap,se.aoMapTransform))}return{refreshFogUniforms:function i(se,ne){ne.color.getRGB(se.fogColor.value,Tq(n)),ne.isFog?(se.fogNear.value=ne.near,se.fogFar.value=ne.far):ne.isFogExp2&&(se.fogDensity.value=ne.density)},refreshMaterialUniforms:function r(se,ne,De,Se,je){ne.isMeshBasicMaterial||ne.isMeshLambertMaterial?s(se,ne):ne.isMeshToonMaterial?(s(se,ne),function g(se,ne){ne.gradientMap&&(se.gradientMap.value=ne.gradientMap)}(se,ne)):ne.isMeshPhongMaterial?(s(se,ne),function f(se,ne){se.specular.value.copy(ne.specular),se.shininess.value=Math.max(ne.shininess,1e-4)}(se,ne)):ne.isMeshStandardMaterial?(s(se,ne),function T(se,ne){se.metalness.value=ne.metalness,ne.metalnessMap&&(se.metalnessMap.value=ne.metalnessMap,t(ne.metalnessMap,se.metalnessMapTransform)),se.roughness.value=ne.roughness,ne.roughnessMap&&(se.roughnessMap.value=ne.roughnessMap,t(ne.roughnessMap,se.roughnessMapTransform)),e.get(ne).envMap&&(se.envMapIntensity.value=ne.envMapIntensity)}(se,ne),ne.isMeshPhysicalMaterial&&function B(se,ne,De){se.ior.value=ne.ior,ne.sheen>0&&(se.sheenColor.value.copy(ne.sheenColor).multiplyScalar(ne.sheen),se.sheenRoughness.value=ne.sheenRoughness,ne.sheenColorMap&&(se.sheenColorMap.value=ne.sheenColorMap,t(ne.sheenColorMap,se.sheenColorMapTransform)),ne.sheenRoughnessMap&&(se.sheenRoughnessMap.value=ne.sheenRoughnessMap,t(ne.sheenRoughnessMap,se.sheenRoughnessMapTransform))),ne.clearcoat>0&&(se.clearcoat.value=ne.clearcoat,se.clearcoatRoughness.value=ne.clearcoatRoughness,ne.clearcoatMap&&(se.clearcoatMap.value=ne.clearcoatMap,t(ne.clearcoatMap,se.clearcoatMapTransform)),ne.clearcoatRoughnessMap&&(se.clearcoatRoughnessMap.value=ne.clearcoatRoughnessMap,t(ne.clearcoatRoughnessMap,se.clearcoatRoughnessMapTransform)),ne.clearcoatNormalMap&&(se.clearcoatNormalMap.value=ne.clearcoatNormalMap,t(ne.clearcoatNormalMap,se.clearcoatNormalMapTransform),se.clearcoatNormalScale.value.copy(ne.clearcoatNormalScale),1===ne.side&&se.clearcoatNormalScale.value.negate())),ne.iridescence>0&&(se.iridescence.value=ne.iridescence,se.iridescenceIOR.value=ne.iridescenceIOR,se.iridescenceThicknessMinimum.value=ne.iridescenceThicknessRange[0],se.iridescenceThicknessMaximum.value=ne.iridescenceThicknessRange[1],ne.iridescenceMap&&(se.iridescenceMap.value=ne.iridescenceMap,t(ne.iridescenceMap,se.iridescenceMapTransform)),ne.iridescenceThicknessMap&&(se.iridescenceThicknessMap.value=ne.iridescenceThicknessMap,t(ne.iridescenceThicknessMap,se.iridescenceThicknessMapTransform))),ne.transmission>0&&(se.transmission.value=ne.transmission,se.transmissionSamplerMap.value=De.texture,se.transmissionSamplerSize.value.set(De.width,De.height),ne.transmissionMap&&(se.transmissionMap.value=ne.transmissionMap,t(ne.transmissionMap,se.transmissionMapTransform)),se.thickness.value=ne.thickness,ne.thicknessMap&&(se.thicknessMap.value=ne.thicknessMap,t(ne.thicknessMap,se.thicknessMapTransform)),se.attenuationDistance.value=ne.attenuationDistance,se.attenuationColor.value.copy(ne.attenuationColor)),ne.anisotropy>0&&(se.anisotropyVector.value.set(ne.anisotropy*Math.cos(ne.anisotropyRotation),ne.anisotropy*Math.sin(ne.anisotropyRotation)),ne.anisotropyMap&&(se.anisotropyMap.value=ne.anisotropyMap,t(ne.anisotropyMap,se.anisotropyMapTransform))),se.specularIntensity.value=ne.specularIntensity,se.specularColor.value.copy(ne.specularColor),ne.specularColorMap&&(se.specularColorMap.value=ne.specularColorMap,t(ne.specularColorMap,se.specularColorMapTransform)),ne.specularIntensityMap&&(se.specularIntensityMap.value=ne.specularIntensityMap,t(ne.specularIntensityMap,se.specularIntensityMapTransform))}(se,ne,je)):ne.isMeshMatcapMaterial?(s(se,ne),function q(se,ne){ne.matcap&&(se.matcap.value=ne.matcap)}(se,ne)):ne.isMeshDepthMaterial?s(se,ne):ne.isMeshDistanceMaterial?(s(se,ne),function re(se,ne){const De=e.get(ne).light;se.referencePosition.value.setFromMatrixPosition(De.matrixWorld),se.nearDistance.value=De.shadow.camera.near,se.farDistance.value=De.shadow.camera.far}(se,ne)):ne.isMeshNormalMaterial?s(se,ne):ne.isLineBasicMaterial?(function o(se,ne){se.diffuse.value.copy(ne.color),se.opacity.value=ne.opacity,ne.map&&(se.map.value=ne.map,t(ne.map,se.mapTransform))}(se,ne),ne.isLineDashedMaterial&&function l(se,ne){se.dashSize.value=ne.dashSize,se.totalSize.value=ne.dashSize+ne.gapSize,se.scale.value=ne.scale}(se,ne)):ne.isPointsMaterial?function d(se,ne,De,Se){se.diffuse.value.copy(ne.color),se.opacity.value=ne.opacity,se.size.value=ne.size*De,se.scale.value=.5*Se,ne.map&&(se.map.value=ne.map,t(ne.map,se.uvTransform)),ne.alphaMap&&(se.alphaMap.value=ne.alphaMap,t(ne.alphaMap,se.alphaMapTransform)),ne.alphaTest>0&&(se.alphaTest.value=ne.alphaTest)}(se,ne,De,Se):ne.isSpriteMaterial?function u(se,ne){se.diffuse.value.copy(ne.color),se.opacity.value=ne.opacity,se.rotation.value=ne.rotation,ne.map&&(se.map.value=ne.map,t(ne.map,se.mapTransform)),ne.alphaMap&&(se.alphaMap.value=ne.alphaMap,t(ne.alphaMap,se.alphaMapTransform)),ne.alphaTest>0&&(se.alphaTest.value=ne.alphaTest)}(se,ne):ne.isShadowMaterial?(se.color.value.copy(ne.color),se.opacity.value=ne.opacity):ne.isShaderMaterial&&(ne.uniformsNeedUpdate=!1)}}}function y0e(n,e,t,i){let r={},s={},o=[];const l=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function B(De,Se,je,Dt){const Mt=De.value,Bt=Se+"_"+je;if(void 0===Dt[Bt])return Dt[Bt]="number"==typeof Mt||"boolean"==typeof Mt?Mt:Mt.clone(),!0;{const Jt=Dt[Bt];if("number"==typeof Mt||"boolean"==typeof Mt){if(Jt!==Mt)return Dt[Bt]=Mt,!0}else if(!1===Jt.equals(Mt))return Jt.copy(Mt),!0}return!1}function re(De){const Se={boundary:0,storage:0};return"number"==typeof De||"boolean"==typeof De?(Se.boundary=4,Se.storage=4):De.isVector2?(Se.boundary=8,Se.storage=8):De.isVector3||De.isColor?(Se.boundary=16,Se.storage=12):De.isVector4?(Se.boundary=16,Se.storage=16):De.isMatrix3?(Se.boundary=48,Se.storage=48):De.isMatrix4?(Se.boundary=64,Se.storage=64):De.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",De),Se}function se(De){const Se=De.target;Se.removeEventListener("dispose",se);const je=o.indexOf(Se.__bindingPointIndex);o.splice(je,1),n.deleteBuffer(r[Se.id]),delete r[Se.id],delete s[Se.id]}return{bind:function d(De,Se){i.uniformBlockBinding(De,Se.program)},update:function u(De,Se){let je=r[De.id];void 0===je&&(function q(De){const Se=De.uniforms;let je=0;for(let Bt=0,Jt=Se.length;Bt<Jt;Bt++){const Vn=Array.isArray(Se[Bt])?Se[Bt]:[Se[Bt]];for(let Tt=0,tn=Vn.length;Tt<tn;Tt++){const Fi=Vn[Tt],Vi=Array.isArray(Fi.value)?Fi.value:[Fi.value];for(let On=0,yi=Vi.length;On<yi;On++){const ri=re(Vi[On]),di=je%16;0!==di&&16-di<ri.boundary&&(je+=16-di),Fi.__data=new Float32Array(ri.storage/Float32Array.BYTES_PER_ELEMENT),Fi.__offset=je,je+=ri.storage}}}const Mt=je%16;Mt>0&&(je+=16-Mt),De.__size=je,De.__cache={}}(De),je=function f(De){const Se=function g(){for(let De=0;De<l;De++)if(-1===o.indexOf(De))return o.push(De),De;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();De.__bindingPointIndex=Se;const je=n.createBuffer(),Dt=De.__size,Mt=De.usage;return n.bindBuffer(n.UNIFORM_BUFFER,je),n.bufferData(n.UNIFORM_BUFFER,Dt,Mt),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,Se,je),je}(De),r[De.id]=je,De.addEventListener("dispose",se)),i.updateUBOMapping(De,Se.program);const Mt=e.render.frame;s[De.id]!==Mt&&(function T(De){const je=De.uniforms,Dt=De.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[De.id]);for(let Mt=0,Bt=je.length;Mt<Bt;Mt++){const Jt=Array.isArray(je[Mt])?je[Mt]:[je[Mt]];for(let Vn=0,Tt=Jt.length;Vn<Tt;Vn++){const tn=Jt[Vn];if(!0===B(tn,Mt,Vn,Dt)){const Fi=tn.__offset,Vi=Array.isArray(tn.value)?tn.value:[tn.value];let On=0;for(let yi=0;yi<Vi.length;yi++){const Gn=Vi[yi],ri=re(Gn);"number"==typeof Gn||"boolean"==typeof Gn?(tn.__data[0]=Gn,n.bufferSubData(n.UNIFORM_BUFFER,Fi+On,tn.__data)):Gn.isMatrix3?(tn.__data[0]=Gn.elements[0],tn.__data[1]=Gn.elements[1],tn.__data[2]=Gn.elements[2],tn.__data[3]=0,tn.__data[4]=Gn.elements[3],tn.__data[5]=Gn.elements[4],tn.__data[6]=Gn.elements[5],tn.__data[7]=0,tn.__data[8]=Gn.elements[6],tn.__data[9]=Gn.elements[7],tn.__data[10]=Gn.elements[8],tn.__data[11]=0):(Gn.toArray(tn.__data,On),On+=ri.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Fi,tn.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(De),s[De.id]=Mt)},dispose:function ne(){for(const De in r)n.deleteBuffer(r[De]);o=[],r={},s={}}}}class v4{constructor(e={}){const{canvas:t=jfe(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:l=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:u=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:g=!1}=e;let T;this.isWebGLRenderer=!0,T=null!==i?i.getContextAttributes().alpha:o;const B=new Uint32Array(4),q=new Int32Array(4);let re=null,se=null;const ne=[],De=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=cu,this._useLegacyLights=!1,this.toneMapping=Fy,this.toneMappingExposure=1;const Se=this;let je=!1,Dt=0,Mt=0,Bt=null,Jt=-1,Vn=null;const Tt=new nc,tn=new nc;let Fi=null;const Vi=new fr(0);let On=0,yi=t.width,Gn=t.height,ri=1,di=null,_i=null;const sr=new nc(0,0,yi,Gn),pr=new nc(0,0,yi,Gn);let Hr=!1;const Ns=new m4;let ui=!1,xr=!1,is=null;const _s=new fo,ws=new Ni,cs=new Rt,po={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Xs(){return null===Bt?ri:1}let ar,jr,gr,Hs,Is,Zs,Ba,Mn,qt,$i,er,Lr,Mr,sa,Ro,rs,As,oa,Kr,wd,Qa,Mo,Js,_o,zn=i;function es(fn,Ai){for(let Hi=0;Hi<fn.length;Hi++){const Bi=t.getContext(fn[Hi],Ai);if(null!==Bi)return Bi}return null}try{const fn={alpha:!0,depth:r,stencil:s,antialias:l,premultipliedAlpha:d,preserveDrawingBuffer:u,powerPreference:f,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Q2}`),t.addEventListener("webglcontextlost",ro,!1),t.addEventListener("webglcontextrestored",Jn,!1),t.addEventListener("webglcontextcreationerror",Vr,!1),null===zn){const Ai=["webgl2","webgl","experimental-webgl"];if(!0===Se.isWebGL1Renderer&&Ai.shift(),zn=es(Ai,fn),null===zn)throw es(Ai)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&zn instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===zn.getShaderPrecisionFormat&&(zn.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(fn){throw console.error("THREE.WebGLRenderer: "+fn.message),fn}function Ln(){ar=new TAe(zn),jr=new xAe(zn,ar,e),ar.init(jr),Mo=new u0e(zn,ar,jr),gr=new c0e(zn,ar,jr),Hs=new BAe(zn),Is=new Kge,Zs=new d0e(zn,ar,gr,Is,jr,Mo,Hs),Ba=new CAe(Se),Mn=new EAe(Se),qt=new gpe(zn,jr),Js=new vAe(zn,ar,qt,jr),$i=new DAe(zn,qt,Hs,Js),er=new FAe(zn,$i,qt,Hs),Kr=new kAe(zn,jr,Zs),rs=new wAe(Is),Lr=new Yge(Se,Ba,Mn,ar,jr,Js,rs),Mr=new _0e(Se,Is),sa=new Jge,Ro=new s0e(ar,jr),oa=new yAe(Se,Ba,Mn,gr,er,T,d),As=new l0e(Se,er,jr),_o=new y0e(zn,Hs,jr,gr),wd=new bAe(zn,ar,Hs,jr),Qa=new IAe(zn,ar,Hs,jr),Hs.programs=Lr.programs,Se.capabilities=jr,Se.extensions=ar,Se.properties=Is,Se.renderLists=sa,Se.shadowMap=As,Se.state=gr,Se.info=Hs}Ln();const Ar=new A0e(Se,zn);function ro(fn){fn.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),je=!0}function Jn(){console.log("THREE.WebGLRenderer: Context Restored."),je=!1;const fn=Hs.autoReset,Ai=As.enabled,Hi=As.autoUpdate,Qi=As.needsUpdate,Bi=As.type;Ln(),Hs.autoReset=fn,As.enabled=Ai,As.autoUpdate=Hi,As.needsUpdate=Qi,As.type=Bi}function Vr(fn){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",fn.statusMessage)}function Ei(fn){const Ai=fn.target;Ai.removeEventListener("dispose",Ei),function Nr(fn){(function Es(fn){const Ai=Is.get(fn).programs;void 0!==Ai&&(Ai.forEach(function(Hi){Lr.releaseProgram(Hi)}),fn.isShaderMaterial&&Lr.releaseShaderCache(fn))})(fn),Is.remove(fn)}(Ai)}function Ka(fn,Ai,Hi){!0===fn.transparent&&2===fn.side&&!1===fn.forceSinglePass?(fn.side=1,fn.needsUpdate=!0,LB(fn,Ai,Hi),fn.side=0,fn.needsUpdate=!0,LB(fn,Ai,Hi),fn.side=2):LB(fn,Ai,Hi)}this.xr=Ar,this.getContext=function(){return zn},this.getContextAttributes=function(){return zn.getContextAttributes()},this.forceContextLoss=function(){const fn=ar.get("WEBGL_lose_context");fn&&fn.loseContext()},this.forceContextRestore=function(){const fn=ar.get("WEBGL_lose_context");fn&&fn.restoreContext()},this.getPixelRatio=function(){return ri},this.setPixelRatio=function(fn){void 0!==fn&&(ri=fn,this.setSize(yi,Gn,!1))},this.getSize=function(fn){return fn.set(yi,Gn)},this.setSize=function(fn,Ai,Hi=!0){Ar.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(yi=fn,Gn=Ai,t.width=Math.floor(fn*ri),t.height=Math.floor(Ai*ri),!0===Hi&&(t.style.width=fn+"px",t.style.height=Ai+"px"),this.setViewport(0,0,fn,Ai))},this.getDrawingBufferSize=function(fn){return fn.set(yi*ri,Gn*ri).floor()},this.setDrawingBufferSize=function(fn,Ai,Hi){yi=fn,Gn=Ai,ri=Hi,t.width=Math.floor(fn*Hi),t.height=Math.floor(Ai*Hi),this.setViewport(0,0,fn,Ai)},this.getCurrentViewport=function(fn){return fn.copy(Tt)},this.getViewport=function(fn){return fn.copy(sr)},this.setViewport=function(fn,Ai,Hi,Qi){fn.isVector4?sr.set(fn.x,fn.y,fn.z,fn.w):sr.set(fn,Ai,Hi,Qi),gr.viewport(Tt.copy(sr).multiplyScalar(ri).round())},this.getScissor=function(fn){return fn.copy(pr)},this.setScissor=function(fn,Ai,Hi,Qi){fn.isVector4?pr.set(fn.x,fn.y,fn.z,fn.w):pr.set(fn,Ai,Hi,Qi),gr.scissor(tn.copy(pr).multiplyScalar(ri).round())},this.getScissorTest=function(){return Hr},this.setScissorTest=function(fn){gr.setScissorTest(Hr=fn)},this.setOpaqueSort=function(fn){di=fn},this.setTransparentSort=function(fn){_i=fn},this.getClearColor=function(fn){return fn.copy(oa.getClearColor())},this.setClearColor=function(){oa.setClearColor.apply(oa,arguments)},this.getClearAlpha=function(){return oa.getClearAlpha()},this.setClearAlpha=function(){oa.setClearAlpha.apply(oa,arguments)},this.clear=function(fn=!0,Ai=!0,Hi=!0){let Qi=0;if(fn){let Bi=!1;if(null!==Bt){const Vs=Bt.texture.format;Bi=1033===Vs||1031===Vs||1029===Vs}if(Bi){const Vs=Bt.texture.type,bo=Vs===Uy||Vs===zy||1012===Vs||Vs===Bb||1017===Vs||1018===Vs,jo=oa.getClearColor(),ca=oa.getClearAlpha(),Wa=jo.r,Ma=jo.g,Pa=jo.b;bo?(B[0]=Wa,B[1]=Ma,B[2]=Pa,B[3]=ca,zn.clearBufferuiv(zn.COLOR,0,B)):(q[0]=Wa,q[1]=Ma,q[2]=Pa,q[3]=ca,zn.clearBufferiv(zn.COLOR,0,q))}else Qi|=zn.COLOR_BUFFER_BIT}Ai&&(Qi|=zn.DEPTH_BUFFER_BIT),Hi&&(Qi|=zn.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),zn.clear(Qi)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ro,!1),t.removeEventListener("webglcontextrestored",Jn,!1),t.removeEventListener("webglcontextcreationerror",Vr,!1),sa.dispose(),Ro.dispose(),Is.dispose(),Ba.dispose(),Mn.dispose(),er.dispose(),Js.dispose(),_o.dispose(),Lr.dispose(),Ar.dispose(),Ar.removeEventListener("sessionstart",Cd),Ar.removeEventListener("sessionend",Dl),is&&(is.dispose(),is=null),Hc.stop()},this.renderBufferDirect=function(fn,Ai,Hi,Qi,Bi,Vs){null===Ai&&(Ai=po);const bo=Bi.isMesh&&Bi.matrixWorld.determinant()<0,jo=function WCe(fn,Ai,Hi,Qi,Bi){!0!==Ai.isScene&&(Ai=po),Zs.resetTextureUnits();const Vs=Ai.fog,jo=null===Bt?Se.outputColorSpace:!0===Bt.isXRRenderTarget?Bt.texture.colorSpace:Qu,ca=(Qi.isMeshStandardMaterial?Mn:Ba).get(Qi.envMap||(Qi.isMeshStandardMaterial?Ai.environment:null)),Wa=!0===Qi.vertexColors&&!!Hi.attributes.color&&4===Hi.attributes.color.itemSize,Ma=!!Hi.attributes.tangent&&(!!Qi.normalMap||Qi.anisotropy>0),Pa=!!Hi.morphAttributes.position,Qd=!!Hi.morphAttributes.normal,Cm=!!Hi.morphAttributes.color;let Xu=Fy;Qi.toneMapped&&(null===Bt||!0===Bt.isXRRenderTarget)&&(Xu=Se.toneMapping);const A1=Hi.morphAttributes.position||Hi.morphAttributes.normal||Hi.morphAttributes.color,cd=void 0!==A1?A1.length:0,La=Is.get(Qi),WL=se.state.lights;!0!==ui||!0!==xr&&fn===Vn||rs.setState(Qi,fn,fn===Vn&&Qi.id===Jt);let Xc=!1;Qi.version===La.__version?(La.needsLights&&La.lightsStateVersion!==WL.state.version||La.outputColorSpace!==jo||Bi.isBatchedMesh&&!1===La.batching||!Bi.isBatchedMesh&&!0===La.batching||Bi.isInstancedMesh&&!1===La.instancing||!Bi.isInstancedMesh&&!0===La.instancing||Bi.isSkinnedMesh&&!1===La.skinning||!Bi.isSkinnedMesh&&!0===La.skinning||Bi.isInstancedMesh&&!0===La.instancingColor&&null===Bi.instanceColor||Bi.isInstancedMesh&&!1===La.instancingColor&&null!==Bi.instanceColor||Bi.isInstancedMesh&&!0===La.instancingMorph&&null===Bi.morphTexture||Bi.isInstancedMesh&&!1===La.instancingMorph&&null!==Bi.morphTexture||La.envMap!==ca||!0===Qi.fog&&La.fog!==Vs||void 0!==La.numClippingPlanes&&(La.numClippingPlanes!==rs.numPlanes||La.numIntersection!==rs.numIntersection)||La.vertexAlphas!==Wa||La.vertexTangents!==Ma||La.morphTargets!==Pa||La.morphNormals!==Qd||La.morphColors!==Cm||La.toneMapping!==Xu||!0===jr.isWebGL2&&La.morphTargetsCount!==cd)&&(Xc=!0):(Xc=!0,La.__version=Qi.version);let Px=La.currentProgram;!0===Xc&&(Px=LB(Qi,Ai,Bi));let EX=!1,vT=!1,jL=!1;const Jh=Px.getUniforms(),Rx=La.uniforms;if(gr.useProgram(Px.program)&&(EX=!0,vT=!0,jL=!0),Qi.id!==Jt&&(Jt=Qi.id,vT=!0),EX||Vn!==fn){Jh.setValue(zn,"projectionMatrix",fn.projectionMatrix),Jh.setValue(zn,"viewMatrix",fn.matrixWorldInverse);const xA=Jh.map.cameraPosition;void 0!==xA&&xA.setValue(zn,cs.setFromMatrixPosition(fn.matrixWorld)),jr.logarithmicDepthBuffer&&Jh.setValue(zn,"logDepthBufFC",2/(Math.log(fn.far+1)/Math.LN2)),(Qi.isMeshPhongMaterial||Qi.isMeshToonMaterial||Qi.isMeshLambertMaterial||Qi.isMeshBasicMaterial||Qi.isMeshStandardMaterial||Qi.isShaderMaterial)&&Jh.setValue(zn,"isOrthographic",!0===fn.isOrthographicCamera),Vn!==fn&&(Vn=fn,vT=!0,jL=!0)}if(Bi.isSkinnedMesh){Jh.setOptional(zn,Bi,"bindMatrix"),Jh.setOptional(zn,Bi,"bindMatrixInverse");const xA=Bi.skeleton;xA&&(jr.floatVertexTextures?(null===xA.boneTexture&&xA.computeBoneTexture(),Jh.setValue(zn,"boneTexture",xA.boneTexture,Zs)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Bi.isBatchedMesh&&(Jh.setOptional(zn,Bi,"batchingTexture"),Jh.setValue(zn,"batchingTexture",Bi._matricesTexture,Zs));const $L=Hi.morphAttributes;if((void 0!==$L.position||void 0!==$L.normal||void 0!==$L.color&&!0===jr.isWebGL2)&&Kr.update(Bi,Hi,Px),(vT||La.receiveShadow!==Bi.receiveShadow)&&(La.receiveShadow=Bi.receiveShadow,Jh.setValue(zn,"receiveShadow",Bi.receiveShadow)),Qi.isMeshGouraudMaterial&&null!==Qi.envMap&&(Rx.envMap.value=ca,Rx.flipEnvMap.value=ca.isCubeTexture&&!1===ca.isRenderTargetTexture?-1:1),vT&&(Jh.setValue(zn,"toneMappingExposure",Se.toneMappingExposure),La.needsLights&&function jCe(fn,Ai){fn.ambientLightColor.needsUpdate=Ai,fn.lightProbe.needsUpdate=Ai,fn.directionalLights.needsUpdate=Ai,fn.directionalLightShadows.needsUpdate=Ai,fn.pointLights.needsUpdate=Ai,fn.pointLightShadows.needsUpdate=Ai,fn.spotLights.needsUpdate=Ai,fn.spotLightShadows.needsUpdate=Ai,fn.rectAreaLights.needsUpdate=Ai,fn.hemisphereLights.needsUpdate=Ai}(Rx,jL),Vs&&!0===Qi.fog&&Mr.refreshFogUniforms(Rx,Vs),Mr.refreshMaterialUniforms(Rx,Qi,ri,Gn,is),y4.upload(zn,MX(La),Rx,Zs)),Qi.isShaderMaterial&&!0===Qi.uniformsNeedUpdate&&(y4.upload(zn,MX(La),Rx,Zs),Qi.uniformsNeedUpdate=!1),Qi.isSpriteMaterial&&Jh.setValue(zn,"center",Bi.center),Jh.setValue(zn,"modelViewMatrix",Bi.modelViewMatrix),Jh.setValue(zn,"normalMatrix",Bi.normalMatrix),Jh.setValue(zn,"modelMatrix",Bi.matrixWorld),Qi.isShaderMaterial||Qi.isRawShaderMaterial){const xA=Qi.uniformsGroups;for(let XL=0,XCe=xA.length;XL<XCe;XL++)if(jr.isWebGL2){const TX=xA[XL];_o.update(TX,Px),_o.bind(TX,Px)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Px}(fn,Ai,Hi,Qi,Bi);gr.setMaterial(Qi,bo);let ca=Hi.index,Wa=1;if(!0===Qi.wireframe){if(ca=$i.getWireframeAttribute(Hi),void 0===ca)return;Wa=2}const Ma=Hi.drawRange,Pa=Hi.attributes.position;let Qd=Ma.start*Wa,Cm=(Ma.start+Ma.count)*Wa;null!==Vs&&(Qd=Math.max(Qd,Vs.start*Wa),Cm=Math.min(Cm,(Vs.start+Vs.count)*Wa)),null!==ca?(Qd=Math.max(Qd,0),Cm=Math.min(Cm,ca.count)):null!=Pa&&(Qd=Math.max(Qd,0),Cm=Math.min(Cm,Pa.count));const Xu=Cm-Qd;if(Xu<0||Xu===1/0)return;Js.setup(Bi,Qi,jo,Hi,ca);let A1,cd=wd;if(null!==ca&&(A1=qt.get(ca),cd=Qa,cd.setIndex(A1)),Bi.isMesh)!0===Qi.wireframe?(gr.setLineWidth(Qi.wireframeLinewidth*Xs()),cd.setMode(zn.LINES)):cd.setMode(zn.TRIANGLES);else if(Bi.isLine){let La=Qi.linewidth;void 0===La&&(La=1),gr.setLineWidth(La*Xs()),cd.setMode(Bi.isLineSegments?zn.LINES:Bi.isLineLoop?zn.LINE_LOOP:zn.LINE_STRIP)}else Bi.isPoints?cd.setMode(zn.POINTS):Bi.isSprite&&cd.setMode(zn.TRIANGLES);if(Bi.isBatchedMesh)cd.renderMultiDraw(Bi._multiDrawStarts,Bi._multiDrawCounts,Bi._multiDrawCount);else if(Bi.isInstancedMesh)cd.renderInstances(Qd,Xu,Bi.count);else if(Hi.isInstancedBufferGeometry){const WL=Math.min(Hi.instanceCount,void 0!==Hi._maxInstanceCount?Hi._maxInstanceCount:1/0);cd.renderInstances(Qd,Xu,WL)}else cd.render(Qd,Xu)},this.compile=function(fn,Ai,Hi=null){null===Hi&&(Hi=fn),se=Ro.get(Hi),se.init(),De.push(se),Hi.traverseVisible(function(Bi){Bi.isLight&&Bi.layers.test(Ai.layers)&&(se.pushLight(Bi),Bi.castShadow&&se.pushShadow(Bi))}),fn!==Hi&&fn.traverseVisible(function(Bi){Bi.isLight&&Bi.layers.test(Ai.layers)&&(se.pushLight(Bi),Bi.castShadow&&se.pushShadow(Bi))}),se.setupLights(Se._useLegacyLights);const Qi=new Set;return fn.traverse(function(Bi){const Vs=Bi.material;if(Vs)if(Array.isArray(Vs))for(let bo=0;bo<Vs.length;bo++){const jo=Vs[bo];Ka(jo,Hi,Bi),Qi.add(jo)}else Ka(Vs,Hi,Bi),Qi.add(Vs)}),De.pop(),se=null,Qi},this.compileAsync=function(fn,Ai,Hi=null){const Qi=this.compile(fn,Ai,Hi);return new Promise(Bi=>{function Vs(){Qi.forEach(function(bo){Is.get(bo).currentProgram.isReady()&&Qi.delete(bo)}),0!==Qi.size?setTimeout(Vs,10):Bi(fn)}null!==ar.get("KHR_parallel_shader_compile")?Vs():setTimeout(Vs,10)})};let Xl=null;function Cd(){Hc.stop()}function Dl(){Hc.start()}const Hc=new Bq;function Zh(fn,Ai,Hi,Qi){if(!1===fn.visible)return;if(fn.layers.test(Ai.layers))if(fn.isGroup)Hi=fn.renderOrder;else if(fn.isLOD)!0===fn.autoUpdate&&fn.update(Ai);else if(fn.isLight)se.pushLight(fn),fn.castShadow&&se.pushShadow(fn);else if(fn.isSprite){if(!fn.frustumCulled||Ns.intersectsSprite(fn)){Qi&&cs.setFromMatrixPosition(fn.matrixWorld).applyMatrix4(_s);const bo=er.update(fn),jo=fn.material;jo.visible&&re.push(fn,bo,jo,Hi,cs.z,null)}}else if((fn.isMesh||fn.isLine||fn.isPoints)&&(!fn.frustumCulled||Ns.intersectsObject(fn))){const bo=er.update(fn),jo=fn.material;if(Qi&&(void 0!==fn.boundingSphere?(null===fn.boundingSphere&&fn.computeBoundingSphere(),cs.copy(fn.boundingSphere.center)):(null===bo.boundingSphere&&bo.computeBoundingSphere(),cs.copy(bo.boundingSphere.center)),cs.applyMatrix4(fn.matrixWorld).applyMatrix4(_s)),Array.isArray(jo)){const ca=bo.groups;for(let Wa=0,Ma=ca.length;Wa<Ma;Wa++){const Pa=ca[Wa],Qd=jo[Pa.materialIndex];Qd&&Qd.visible&&re.push(fn,bo,Qd,Hi,cs.z,Pa)}}else jo.visible&&re.push(fn,bo,jo,Hi,cs.z,null)}const Vs=fn.children;for(let bo=0,jo=Vs.length;bo<jo;bo++)Zh(Vs[bo],Ai,Hi,Qi)}function Bx(fn,Ai,Hi,Qi){const Bi=fn.opaque,Vs=fn.transmissive,bo=fn.transparent;se.setupLightsView(Hi),!0===ui&&rs.setGlobalState(Se.clippingPlanes,Hi),Vs.length>0&&function FB(fn,Ai,Hi,Qi){if(null!==(!0===Hi.isScene?Hi.overrideMaterial:null))return;const Vs=jr.isWebGL2;null===is&&(is=new Wu(1,1,{generateMipmaps:!0,type:ar.has("EXT_color_buffer_half_float")?mA:Uy,minFilter:fA,samples:Vs?4:0})),Se.getDrawingBufferSize(ws),Vs?is.setSize(ws.x,ws.y):is.setSize(jI(ws.x),jI(ws.y));const bo=Se.getRenderTarget();Se.setRenderTarget(is),Se.getClearColor(Vi),On=Se.getClearAlpha(),On<1&&Se.setClearColor(16777215,.5),Se.clear();const jo=Se.toneMapping;Se.toneMapping=Fy,OB(fn,Hi,Qi),Zs.updateMultisampleRenderTarget(is),Zs.updateRenderTargetMipmap(is);let ca=!1;for(let Wa=0,Ma=Ai.length;Wa<Ma;Wa++){const Pa=Ai[Wa],Qd=Pa.object,Cm=Pa.geometry,Xu=Pa.material,A1=Pa.group;if(2===Xu.side&&Qd.layers.test(Qi.layers)){const cd=Xu.side;Xu.side=1,Xu.needsUpdate=!0,CX(Qd,Hi,Qi,Cm,Xu,A1),Xu.side=cd,Xu.needsUpdate=!0,ca=!0}}!0===ca&&(Zs.updateMultisampleRenderTarget(is),Zs.updateRenderTargetMipmap(is)),Se.setRenderTarget(bo),Se.setClearColor(Vi,On),Se.toneMapping=jo}(Bi,Vs,Ai,Hi),Qi&&gr.viewport(Tt.copy(Qi)),Bi.length>0&&OB(Bi,Ai,Hi),Vs.length>0&&OB(Vs,Ai,Hi),bo.length>0&&OB(bo,Ai,Hi),gr.buffers.depth.setTest(!0),gr.buffers.depth.setMask(!0),gr.buffers.color.setMask(!0),gr.setPolygonOffset(!1)}function OB(fn,Ai,Hi){const Qi=!0===Ai.isScene?Ai.overrideMaterial:null;for(let Bi=0,Vs=fn.length;Bi<Vs;Bi++){const bo=fn[Bi],jo=bo.object,ca=bo.geometry,Wa=null===Qi?bo.material:Qi,Ma=bo.group;jo.layers.test(Hi.layers)&&CX(jo,Ai,Hi,ca,Wa,Ma)}}function CX(fn,Ai,Hi,Qi,Bi,Vs){fn.onBeforeRender(Se,Ai,Hi,Qi,Bi,Vs),fn.modelViewMatrix.multiplyMatrices(Hi.matrixWorldInverse,fn.matrixWorld),fn.normalMatrix.getNormalMatrix(fn.modelViewMatrix),Bi.onBeforeRender(Se,Ai,Hi,Qi,fn,Vs),!0===Bi.transparent&&2===Bi.side&&!1===Bi.forceSinglePass?(Bi.side=1,Bi.needsUpdate=!0,Se.renderBufferDirect(Hi,Ai,Qi,Bi,fn,Vs),Bi.side=0,Bi.needsUpdate=!0,Se.renderBufferDirect(Hi,Ai,Qi,Bi,fn,Vs),Bi.side=2):Se.renderBufferDirect(Hi,Ai,Qi,Bi,fn,Vs),fn.onAfterRender(Se,Ai,Hi,Qi,Bi,Vs)}function LB(fn,Ai,Hi){!0!==Ai.isScene&&(Ai=po);const Qi=Is.get(fn),Bi=se.state.lights,bo=Bi.state.version,jo=Lr.getParameters(fn,Bi.state,se.state.shadowsArray,Ai,Hi),ca=Lr.getProgramCacheKey(jo);let Wa=Qi.programs;Qi.environment=fn.isMeshStandardMaterial?Ai.environment:null,Qi.fog=Ai.fog,Qi.envMap=(fn.isMeshStandardMaterial?Mn:Ba).get(fn.envMap||Qi.environment),Qi.envMapRotation=null!==Qi.environment&&null===fn.envMap?Ai.environmentRotation:fn.envMapRotation,void 0===Wa&&(fn.addEventListener("dispose",Ei),Wa=new Map,Qi.programs=Wa);let Ma=Wa.get(ca);if(void 0!==Ma){if(Qi.currentProgram===Ma&&Qi.lightsStateVersion===bo)return SX(fn,jo),Ma}else jo.uniforms=Lr.getUniforms(fn),fn.onBuild(Hi,jo,Se),fn.onBeforeCompile(jo,Se),Ma=Lr.acquireProgram(jo,ca),Wa.set(ca,Ma),Qi.uniforms=jo.uniforms;const Pa=Qi.uniforms;return(!fn.isShaderMaterial&&!fn.isRawShaderMaterial||!0===fn.clipping)&&(Pa.clippingPlanes=rs.uniform),SX(fn,jo),Qi.needsLights=function $Ce(fn){return fn.isMeshLambertMaterial||fn.isMeshToonMaterial||fn.isMeshPhongMaterial||fn.isMeshStandardMaterial||fn.isShadowMaterial||fn.isShaderMaterial&&!0===fn.lights}(fn),Qi.lightsStateVersion=bo,Qi.needsLights&&(Pa.ambientLightColor.value=Bi.state.ambient,Pa.lightProbe.value=Bi.state.probe,Pa.directionalLights.value=Bi.state.directional,Pa.directionalLightShadows.value=Bi.state.directionalShadow,Pa.spotLights.value=Bi.state.spot,Pa.spotLightShadows.value=Bi.state.spotShadow,Pa.rectAreaLights.value=Bi.state.rectArea,Pa.ltc_1.value=Bi.state.rectAreaLTC1,Pa.ltc_2.value=Bi.state.rectAreaLTC2,Pa.pointLights.value=Bi.state.point,Pa.pointLightShadows.value=Bi.state.pointShadow,Pa.hemisphereLights.value=Bi.state.hemi,Pa.directionalShadowMap.value=Bi.state.directionalShadowMap,Pa.directionalShadowMatrix.value=Bi.state.directionalShadowMatrix,Pa.spotShadowMap.value=Bi.state.spotShadowMap,Pa.spotLightMatrix.value=Bi.state.spotLightMatrix,Pa.spotLightMap.value=Bi.state.spotLightMap,Pa.pointShadowMap.value=Bi.state.pointShadowMap,Pa.pointShadowMatrix.value=Bi.state.pointShadowMatrix),Qi.currentProgram=Ma,Qi.uniformsList=null,Ma}function MX(fn){if(null===fn.uniformsList){const Ai=fn.currentProgram.getUniforms();fn.uniformsList=y4.seqWithValue(Ai.seq,fn.uniforms)}return fn.uniformsList}function SX(fn,Ai){const Hi=Is.get(fn);Hi.outputColorSpace=Ai.outputColorSpace,Hi.batching=Ai.batching,Hi.instancing=Ai.instancing,Hi.instancingColor=Ai.instancingColor,Hi.instancingMorph=Ai.instancingMorph,Hi.skinning=Ai.skinning,Hi.morphTargets=Ai.morphTargets,Hi.morphNormals=Ai.morphNormals,Hi.morphColors=Ai.morphColors,Hi.morphTargetsCount=Ai.morphTargetsCount,Hi.numClippingPlanes=Ai.numClippingPlanes,Hi.numIntersection=Ai.numClipIntersection,Hi.vertexAlphas=Ai.vertexAlphas,Hi.vertexTangents=Ai.vertexTangents,Hi.toneMapping=Ai.toneMapping}Hc.setAnimationLoop(function pc(fn){Xl&&Xl(fn)}),typeof self<"u"&&Hc.setContext(self),this.setAnimationLoop=function(fn){Xl=fn,Ar.setAnimationLoop(fn),null===fn?Hc.stop():Hc.start()},Ar.addEventListener("sessionstart",Cd),Ar.addEventListener("sessionend",Dl),this.render=function(fn,Ai){if(void 0===Ai||!0===Ai.isCamera){if(!0!==je){if(!0===fn.matrixWorldAutoUpdate&&fn.updateMatrixWorld(),null===Ai.parent&&!0===Ai.matrixWorldAutoUpdate&&Ai.updateMatrixWorld(),!0===Ar.enabled&&!0===Ar.isPresenting&&(!0===Ar.cameraAutoUpdate&&Ar.updateCamera(Ai),Ai=Ar.getCamera()),!0===fn.isScene&&fn.onBeforeRender(Se,fn,Ai,Bt),se=Ro.get(fn,De.length),se.init(),De.push(se),_s.multiplyMatrices(Ai.projectionMatrix,Ai.matrixWorldInverse),Ns.setFromProjectionMatrix(_s),xr=this.localClippingEnabled,ui=rs.init(this.clippingPlanes,xr),re=sa.get(fn,ne.length),re.init(),ne.push(re),Zh(fn,Ai,0,Se.sortObjects),re.finish(),!0===Se.sortObjects&&re.sort(di,_i),this.info.render.frame++,!0===ui&&rs.beginShadows(),As.render(se.state.shadowsArray,fn,Ai),!0===ui&&rs.endShadows(),!0===this.info.autoReset&&this.info.reset(),(!1===Ar.enabled||!1===Ar.isPresenting||!1===Ar.hasDepthSensing())&&oa.render(re,fn),se.setupLights(Se._useLegacyLights),Ai.isArrayCamera){const Qi=Ai.cameras;for(let Bi=0,Vs=Qi.length;Bi<Vs;Bi++){const bo=Qi[Bi];Bx(re,fn,bo,bo.viewport)}}else Bx(re,fn,Ai);null!==Bt&&(Zs.updateMultisampleRenderTarget(Bt),Zs.updateRenderTargetMipmap(Bt)),!0===fn.isScene&&fn.onAfterRender(Se,fn,Ai),Js.resetDefaultState(),Jt=-1,Vn=null,De.pop(),se=De.length>0?De[De.length-1]:null,ne.pop(),re=ne.length>0?ne[ne.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Dt},this.getActiveMipmapLevel=function(){return Mt},this.getRenderTarget=function(){return Bt},this.setRenderTargetTextures=function(fn,Ai,Hi){Is.get(fn.texture).__webglTexture=Ai,Is.get(fn.depthTexture).__webglTexture=Hi;const Qi=Is.get(fn);Qi.__hasExternalTextures=!0,Qi.__autoAllocateDepthBuffer=void 0===Hi,Qi.__autoAllocateDepthBuffer||!0===ar.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Qi.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(fn,Ai){const Hi=Is.get(fn);Hi.__webglFramebuffer=Ai,Hi.__useDefaultFramebuffer=void 0===Ai},this.setRenderTarget=function(fn,Ai=0,Hi=0){Bt=fn,Dt=Ai,Mt=Hi;let Qi=!0,Bi=null,Vs=!1,bo=!1;if(fn){const ca=Is.get(fn);void 0!==ca.__useDefaultFramebuffer?(gr.bindFramebuffer(zn.FRAMEBUFFER,null),Qi=!1):void 0===ca.__webglFramebuffer?Zs.setupRenderTarget(fn):ca.__hasExternalTextures&&Zs.rebindTextures(fn,Is.get(fn.texture).__webglTexture,Is.get(fn.depthTexture).__webglTexture);const Wa=fn.texture;(Wa.isData3DTexture||Wa.isDataArrayTexture||Wa.isCompressedArrayTexture)&&(bo=!0);const Ma=Is.get(fn).__webglFramebuffer;fn.isWebGLCubeRenderTarget?(Bi=Array.isArray(Ma[Ai])?Ma[Ai][Hi]:Ma[Ai],Vs=!0):Bi=jr.isWebGL2&&fn.samples>0&&!1===Zs.useMultisampledRTT(fn)?Is.get(fn).__webglMultisampledFramebuffer:Array.isArray(Ma)?Ma[Hi]:Ma,Tt.copy(fn.viewport),tn.copy(fn.scissor),Fi=fn.scissorTest}else Tt.copy(sr).multiplyScalar(ri).floor(),tn.copy(pr).multiplyScalar(ri).floor(),Fi=Hr;if(gr.bindFramebuffer(zn.FRAMEBUFFER,Bi)&&jr.drawBuffers&&Qi&&gr.drawBuffers(fn,Bi),gr.viewport(Tt),gr.scissor(tn),gr.setScissorTest(Fi),Vs){const ca=Is.get(fn.texture);zn.framebufferTexture2D(zn.FRAMEBUFFER,zn.COLOR_ATTACHMENT0,zn.TEXTURE_CUBE_MAP_POSITIVE_X+Ai,ca.__webglTexture,Hi)}else if(bo){const ca=Is.get(fn.texture);zn.framebufferTextureLayer(zn.FRAMEBUFFER,zn.COLOR_ATTACHMENT0,ca.__webglTexture,Hi||0,Ai||0)}Jt=-1},this.readRenderTargetPixels=function(fn,Ai,Hi,Qi,Bi,Vs,bo){if(!fn||!fn.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let jo=Is.get(fn).__webglFramebuffer;if(fn.isWebGLCubeRenderTarget&&void 0!==bo&&(jo=jo[bo]),jo){gr.bindFramebuffer(zn.FRAMEBUFFER,jo);try{const ca=fn.texture,Wa=ca.format,Ma=ca.type;if(Wa!==wp&&Mo.convert(Wa)!==zn.getParameter(zn.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Pa=Ma===mA&&(ar.has("EXT_color_buffer_half_float")||jr.isWebGL2&&ar.has("EXT_color_buffer_float"));if(!(Ma===Uy||Mo.convert(Ma)===zn.getParameter(zn.IMPLEMENTATION_COLOR_READ_TYPE)||Ma===pA&&(jr.isWebGL2||ar.has("OES_texture_float")||ar.has("WEBGL_color_buffer_float"))||Pa))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Ai>=0&&Ai<=fn.width-Qi&&Hi>=0&&Hi<=fn.height-Bi&&zn.readPixels(Ai,Hi,Qi,Bi,Mo.convert(Wa),Mo.convert(Ma),Vs)}finally{const ca=null!==Bt?Is.get(Bt).__webglFramebuffer:null;gr.bindFramebuffer(zn.FRAMEBUFFER,ca)}}},this.copyFramebufferToTexture=function(fn,Ai,Hi=0){const Qi=Math.pow(2,-Hi),Bi=Math.floor(Ai.image.width*Qi),Vs=Math.floor(Ai.image.height*Qi);Zs.setTexture2D(Ai,0),zn.copyTexSubImage2D(zn.TEXTURE_2D,Hi,0,0,fn.x,fn.y,Bi,Vs),gr.unbindTexture()},this.copyTextureToTexture=function(fn,Ai,Hi,Qi=0){const Bi=Ai.image.width,Vs=Ai.image.height,bo=Mo.convert(Hi.format),jo=Mo.convert(Hi.type);Zs.setTexture2D(Hi,0),zn.pixelStorei(zn.UNPACK_FLIP_Y_WEBGL,Hi.flipY),zn.pixelStorei(zn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Hi.premultiplyAlpha),zn.pixelStorei(zn.UNPACK_ALIGNMENT,Hi.unpackAlignment),Ai.isDataTexture?zn.texSubImage2D(zn.TEXTURE_2D,Qi,fn.x,fn.y,Bi,Vs,bo,jo,Ai.image.data):Ai.isCompressedTexture?zn.compressedTexSubImage2D(zn.TEXTURE_2D,Qi,fn.x,fn.y,Ai.mipmaps[0].width,Ai.mipmaps[0].height,bo,Ai.mipmaps[0].data):zn.texSubImage2D(zn.TEXTURE_2D,Qi,fn.x,fn.y,bo,jo,Ai.image),0===Qi&&Hi.generateMipmaps&&zn.generateMipmap(zn.TEXTURE_2D),gr.unbindTexture()},this.copyTextureToTexture3D=function(fn,Ai,Hi,Qi,Bi=0){if(Se.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Vs=Math.round(fn.max.x-fn.min.x),bo=Math.round(fn.max.y-fn.min.y),jo=fn.max.z-fn.min.z+1,ca=Mo.convert(Qi.format),Wa=Mo.convert(Qi.type);let Ma;if(Qi.isData3DTexture)Zs.setTexture3D(Qi,0),Ma=zn.TEXTURE_3D;else{if(!Qi.isDataArrayTexture&&!Qi.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Zs.setTexture2DArray(Qi,0),Ma=zn.TEXTURE_2D_ARRAY}zn.pixelStorei(zn.UNPACK_FLIP_Y_WEBGL,Qi.flipY),zn.pixelStorei(zn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qi.premultiplyAlpha),zn.pixelStorei(zn.UNPACK_ALIGNMENT,Qi.unpackAlignment);const Pa=zn.getParameter(zn.UNPACK_ROW_LENGTH),Qd=zn.getParameter(zn.UNPACK_IMAGE_HEIGHT),Cm=zn.getParameter(zn.UNPACK_SKIP_PIXELS),Xu=zn.getParameter(zn.UNPACK_SKIP_ROWS),A1=zn.getParameter(zn.UNPACK_SKIP_IMAGES),cd=Hi.isCompressedTexture?Hi.mipmaps[Bi]:Hi.image;zn.pixelStorei(zn.UNPACK_ROW_LENGTH,cd.width),zn.pixelStorei(zn.UNPACK_IMAGE_HEIGHT,cd.height),zn.pixelStorei(zn.UNPACK_SKIP_PIXELS,fn.min.x),zn.pixelStorei(zn.UNPACK_SKIP_ROWS,fn.min.y),zn.pixelStorei(zn.UNPACK_SKIP_IMAGES,fn.min.z),Hi.isDataTexture||Hi.isData3DTexture?zn.texSubImage3D(Ma,Bi,Ai.x,Ai.y,Ai.z,Vs,bo,jo,ca,Wa,cd.data):Qi.isCompressedArrayTexture?zn.compressedTexSubImage3D(Ma,Bi,Ai.x,Ai.y,Ai.z,Vs,bo,jo,ca,cd.data):zn.texSubImage3D(Ma,Bi,Ai.x,Ai.y,Ai.z,Vs,bo,jo,ca,Wa,cd),zn.pixelStorei(zn.UNPACK_ROW_LENGTH,Pa),zn.pixelStorei(zn.UNPACK_IMAGE_HEIGHT,Qd),zn.pixelStorei(zn.UNPACK_SKIP_PIXELS,Cm),zn.pixelStorei(zn.UNPACK_SKIP_ROWS,Xu),zn.pixelStorei(zn.UNPACK_SKIP_IMAGES,A1),0===Bi&&Qi.generateMipmaps&&zn.generateMipmap(Ma),gr.unbindTexture()},this.initTexture=function(fn){fn.isCubeTexture?Zs.setTextureCube(fn,0):fn.isData3DTexture?Zs.setTexture3D(fn,0):fn.isDataArrayTexture||fn.isCompressedArrayTexture?Zs.setTexture2DArray(fn,0):Zs.setTexture2D(fn,0),gr.unbindTexture()},this.resetState=function(){Dt=0,Mt=0,Bt=null,gr.reset(),Js.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return e1}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===h5?"display-p3":"srgb",t.unpackColorSpace=Hl.workingColorSpace===HI?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class v0e extends v4{}).prototype.isWebGL1Renderer=!0;class $5{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new fr(e),this.density=t}clone(){return new $5(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class X5{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new fr(e),this.near=t,this.far=i}clone(){return new X5(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class IE extends Ol{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new U0,this.environmentRotation=new U0,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class b4{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Am()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return aq("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Am()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Am()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const zf=new Rt;class Qb{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)zf.fromBufferAttribute(this,t),zf.applyMatrix4(e),this.setXYZ(t,zf.x,zf.y,zf.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)zf.fromBufferAttribute(this,t),zf.applyNormalMatrix(e),this.setXYZ(t,zf.x,zf.y,zf.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)zf.fromBufferAttribute(this,t),zf.transformDirection(e),this.setXYZ(t,zf.x,zf.y,zf.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Lf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=wa(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=wa(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=wa(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=wa(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=wa(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Lf(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Lf(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Lf(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Lf(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=wa(t,this.array),i=wa(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=wa(t,this.array),i=wa(i,this.array),r=wa(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=wa(t,this.array),i=wa(i,this.array),r=wa(r,this.array),s=wa(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new To(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Qb(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class lQ extends ad{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new fr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let SC;const BE=new Rt,EC=new Rt,TC=new Rt,DC=new Ni,PE=new Ni,cQ=new fo,x4=new Rt,RE=new Rt,w4=new Rt,dQ=new Ni,Y5=new Ni,uQ=new Ni;class b0e extends Ol{constructor(e=new lQ){if(super(),this.isSprite=!0,this.type="Sprite",void 0===SC){SC=new Qs;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new b4(t,5);SC.setIndex([0,1,2,0,2,3]),SC.setAttribute("position",new Qb(i,3,0,!1)),SC.setAttribute("uv",new Qb(i,2,3,!1))}this.geometry=SC,this.material=e,this.center=new Ni(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),EC.setFromMatrixScale(this.matrixWorld),cQ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),TC.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&EC.multiplyScalar(-TC.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;C4(x4.set(-.5,-.5,0),TC,o,EC,r,s),C4(RE.set(.5,-.5,0),TC,o,EC,r,s),C4(w4.set(.5,.5,0),TC,o,EC,r,s),dQ.set(0,0),Y5.set(1,0),uQ.set(1,1);let l=e.ray.intersectTriangle(x4,RE,w4,!1,BE);if(null===l&&(C4(RE.set(-.5,.5,0),TC,o,EC,r,s),Y5.set(0,1),l=e.ray.intersectTriangle(x4,w4,RE,!1,BE),null===l))return;const d=e.ray.origin.distanceTo(BE);d<e.near||d>e.far||t.push({distance:d,point:BE.clone(),uv:_m.getInterpolation(BE,x4,RE,w4,dQ,Y5,uQ,new Ni),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function C4(n,e,t,i,r,s){DC.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(PE.x=s*DC.x-r*DC.y,PE.y=r*DC.x+s*DC.y):PE.copy(DC),n.copy(e),n.x+=PE.x,n.y+=PE.y,n.applyMatrix4(cQ)}const M4=new Rt,hQ=new Rt;class x0e extends Ol{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){M4.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(M4);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){M4.setFromMatrixPosition(e.matrixWorld),hQ.setFromMatrixPosition(this.matrixWorld);const i=M4.distanceTo(hQ)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),!(i>=o))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const fQ=new Rt,pQ=new nc,mQ=new nc,w0e=new Rt,AQ=new fo,S4=new Rt,K5=new ju,gQ=new fo,Z5=new lC;class _Q extends Yo{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=_G,this.bindMatrix=new fo,this.bindMatrixInverse=new fo,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Nf),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,S4),this.boundingBox.expandByPoint(S4)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new ju),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,S4),this.boundingSphere.expandByPoint(S4)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),K5.copy(this.boundingSphere),K5.applyMatrix4(r),!1!==e.ray.intersectsSphere(K5)&&(gQ.copy(r).invert(),Z5.copy(e.ray).applyMatrix4(gQ),(null===this.boundingBox||!1!==Z5.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Z5)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new nc,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===_G?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;pQ.fromBufferAttribute(r.attributes.skinIndex,e),mQ.fromBufferAttribute(r.attributes.skinWeight,e),fQ.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=mQ.getComponent(s);if(0!==o){const l=pQ.getComponent(s);AQ.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),t.addScaledVector(w0e.copy(fQ).applyMatrix4(AQ),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class J5 extends Ol{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Wb extends $h{constructor(e=null,t=1,i=1,r,s,o,l,d,u=gd,f=gd,g,T){super(null,o,l,d,u,f,r,s,g,T),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const yQ=new fo,C0e=new fo;class E4{constructor(e=[],t=[]){this.uuid=Am(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new fo)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new fo;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)yQ.multiplyMatrices(e[s]?e[s].matrixWorld:C0e,t[s]),yQ.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new E4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Wb(t,e,e,wp,pA);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new J5),this.bones.push(o),this.boneInverses.push((new fo).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class IC extends To{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const BC=new fo,vQ=new fo,T4=[],bQ=new Nf,M0e=new fo,kE=new Yo,FE=new ju;class xQ extends Yo{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new IC(new Float32Array(16*i),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,M0e)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Nf),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,BC),bQ.copy(e.boundingBox).applyMatrix4(BC),this.boundingBox.union(bQ)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new ju),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,BC),FE.copy(e.boundingSphere).applyMatrix4(BC),this.boundingSphere.union(FE)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,o=e*(i.length+1)+1;for(let l=0;l<i.length;l++)i[l]=r[o+l]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(kE.geometry=this.geometry,kE.material=this.material,void 0!==kE.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),FE.copy(this.boundingSphere),FE.applyMatrix4(i),!1!==e.ray.intersectsSphere(FE)))for(let s=0;s<r;s++){this.getMatrixAt(s,BC),vQ.multiplyMatrices(i,BC),kE.matrixWorld=vQ,kE.raycast(e,T4);for(let o=0,l=T4.length;o<l;o++){const d=T4[o];d.instanceId=s,d.object=this,t.push(d)}T4.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new IC(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;null===this.morphTexture&&(this.morphTexture=new Wb(new Float32Array(r*this.count),r,this.count,1028,pA));const s=this.morphTexture.source.data.data;let o=0;for(let u=0;u<i.length;u++)o+=i[u];const d=r*e;s[d]=this.geometry.morphTargetsRelative?1:1-o,s.set(i,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function S0e(n,e){return n.z-e.z}function E0e(n,e){return e.z-n.z}class T0e{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const i=this.pool,r=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1});const s=i[this.index];r.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const PC="batchId",jy=new fo,wQ=new fo,D0e=new fo,CQ=new fo,eO=new m4,D4=new Nf,jb=new ju,OE=new Rt,tO=new T0e,Yh=new Yo,I4=[];function I0e(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*i);e.needsUpdate=!0}class B0e extends Yo{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,i=2*t,r){super(new Qs,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(4*this._maxGeometryCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new Wb(t,e,e,wp,pA);this._matricesTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxGeometryCount,s=this._maxIndexCount;if(!1===this._geometryInitialized){for(const l in e.attributes){const d=e.getAttribute(l),{array:u,itemSize:f,normalized:g}=d,T=new u.constructor(i*f),B=new d.constructor(T,f,g);B.setUsage(d.usage),t.setAttribute(l,B)}if(null!==e.getIndex()){const l=i>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new To(l,1))}const o=r>65536?new Uint32Array(i):new Uint16Array(i);t.setAttribute(PC,new To(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(PC))throw new Error(`BatchedMesh: Geometry cannot use attribute "${PC}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(i===PC)continue;if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Nf);const e=this._geometryCount,t=this.boundingBox,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)!1!==i[r]&&(this.getMatrixAt(r,jy),this.getBoundingBoxAt(r,D4).applyMatrix4(jy),t.union(D4))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ju);const e=this._geometryCount,t=this.boundingSphere,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)!1!==i[r]&&(this.getMatrixAt(r,jy),this.getBoundingSphereAt(r,jb).applyMatrix4(jy),t.union(jb))}addGeometry(e,t=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,l=this._drawRanges,d=this._bounds;0!==this._geometryCount&&(s=o[o.length-1]),r.vertexCount=-1===t?e.getAttribute("position").count:t,r.vertexStart=null===s?0:s.vertexStart+s.vertexCount;const u=e.getIndex(),f=null!==u;if(f&&(r.indexCount=-1===i?u.count:i,r.indexStart=null===s?0:s.indexStart+s.indexCount),-1!==r.indexStart&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const T=this._active,B=this._matricesTexture,q=this._matricesTexture.image.data;this._visibility.push(!0),T.push(!0);const re=this._geometryCount;this._geometryCount++,D0e.toArray(q,16*re),B.needsUpdate=!0,o.push(r),l.push({start:f?r.indexStart:r.vertexStart,count:-1}),d.push({boxInitialized:!1,box:new Nf,sphereInitialized:!1,sphere:new ju});const se=this.geometry.getAttribute(PC);for(let ne=0;ne<r.vertexCount;ne++)se.setX(r.vertexStart+ne,re);return se.needsUpdate=!0,this.setGeometryAt(re,e),re}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=null!==i.getIndex(),s=i.getIndex(),o=t.getIndex(),l=this._reservedRanges[e];if(r&&o.count>l.indexCount||t.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const d=l.vertexStart,u=l.vertexCount;for(const B in i.attributes){if(B===PC)continue;const q=t.getAttribute(B),re=i.getAttribute(B);I0e(q,re,d);const se=q.itemSize;for(let ne=q.count,De=u;ne<De;ne++){const Se=d+ne;for(let je=0;je<se;je++)re.setComponent(Se,je,0)}re.needsUpdate=!0}if(r){const B=l.indexStart;for(let q=0;q<o.count;q++)s.setX(B+q,d+o.getX(q));for(let q=o.count,re=l.indexCount;q<re;q++)s.setX(B+q,d);s.needsUpdate=!0}const f=this._bounds[e];null!==t.boundingBox?(f.box.copy(t.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,null!==t.boundingSphere?(f.sphere.copy(t.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const g=this._drawRanges[e],T=t.getAttribute("position");return g.count=r?o.count:T.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||!1===t[e]||(t[e]=!1,this._visibilityChanged=!0),this}getBoundingBoxAt(e,t){if(!1===this._active[e])return null;const r=this._bounds[e],s=r.box,o=this.geometry;if(!1===r.boxInitialized){s.makeEmpty();const l=o.index,d=o.attributes.position,u=this._drawRanges[e];for(let f=u.start,g=u.start+u.count;f<g;f++){let T=f;l&&(T=l.getX(T)),s.expandByPoint(OE.fromBufferAttribute(d,T))}r.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(!1===this._active[e])return null;const r=this._bounds[e],s=r.sphere,o=this.geometry;if(!1===r.sphereInitialized){s.makeEmpty(),this.getBoundingBoxAt(e,D4),D4.getCenter(s.center);const l=o.index,d=o.attributes.position,u=this._drawRanges[e];let f=0;for(let g=u.start,T=u.start+u.count;g<T;g++){let B=g;l&&(B=l.getX(B)),OE.fromBufferAttribute(d,B),f=Math.max(f,s.center.distanceToSquared(OE))}s.radius=Math.sqrt(f),r.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._matricesTexture;return e>=this._geometryCount||!1===this._active[e]||(t.toArray(this._matricesTexture.image.data,16*e),r.needsUpdate=!0),this}getMatrixAt(e,t){return e>=this._geometryCount||!1===this._active[e]?null:t.fromArray(this._matricesTexture.image.data,16*e)}setVisibleAt(e,t){const i=this._visibility;return e>=this._geometryCount||!1===this._active[e]||i[e]===t||(i[e]=t,this._visibilityChanged=!0),this}getVisibleAt(e){return!(e>=this._geometryCount||!1===this._active[e])&&this._visibility[e]}raycast(e,t){const i=this._visibility,r=this._active,s=this._drawRanges,o=this._geometryCount,l=this.matrixWorld,d=this.geometry;Yh.material=this.material,Yh.geometry.index=d.index,Yh.geometry.attributes=d.attributes,null===Yh.geometry.boundingBox&&(Yh.geometry.boundingBox=new Nf),null===Yh.geometry.boundingSphere&&(Yh.geometry.boundingSphere=new ju);for(let u=0;u<o;u++){if(!i[u]||!r[u])continue;const f=s[u];Yh.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(u,Yh.matrixWorld).premultiply(l),this.getBoundingBoxAt(u,Yh.geometry.boundingBox),this.getBoundingSphereAt(u,Yh.geometry.boundingSphere),Yh.raycast(e,I4);for(let g=0,T=I4.length;g<T;g++){const B=I4[g];B.object=this,B.batchId=u,t.push(B)}I4.length=0}Yh.material=null,Yh.geometry.index=null,Yh.geometry.attributes={},Yh.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),l=null===o?1:o.array.BYTES_PER_ELEMENT,d=this._active,u=this._visibility,f=this._multiDrawStarts,g=this._multiDrawCounts,T=this._drawRanges,B=this.perObjectFrustumCulled;B&&(CQ.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),eO.setFromProjectionMatrix(CQ,e.coordinateSystem));let q=0;if(this.sortObjects){wQ.copy(this.matrixWorld).invert(),OE.setFromMatrixPosition(i.matrixWorld).applyMatrix4(wQ);for(let ne=0,De=u.length;ne<De;ne++)if(u[ne]&&d[ne]){this.getMatrixAt(ne,jy),this.getBoundingSphereAt(ne,jb).applyMatrix4(jy);let Se=!1;if(B&&(Se=!eO.intersectsSphere(jb)),!Se){const je=OE.distanceTo(jb.center);tO.push(T[ne],je)}}const re=tO.list,se=this.customSort;null===se?re.sort(s.transparent?E0e:S0e):se.call(this,re,i);for(let ne=0,De=re.length;ne<De;ne++){const Se=re[ne];f[q]=Se.start*l,g[q]=Se.count,q++}tO.reset()}else for(let re=0,se=u.length;re<se;re++)if(u[re]&&d[re]){let ne=!1;if(B&&(this.getMatrixAt(re,jy),this.getBoundingSphereAt(re,jb).applyMatrix4(jy),ne=!eO.intersectsSphere(jb)),!ne){const De=T[re];f[q]=De.start*l,g[q]=De.count,q++}}this._multiDrawCount=q,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class wc extends ad{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new fr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const MQ=new Rt,SQ=new Rt,EQ=new fo,nO=new lC,B4=new ju;class gg extends Ol{constructor(e=new Qs,t=new wc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)MQ.fromBufferAttribute(t,r-1),SQ.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=MQ.distanceTo(SQ);e.setAttribute("lineDistance",new ks(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),B4.copy(i.boundingSphere),B4.applyMatrix4(r),B4.radius+=s,!1===e.ray.intersectsSphere(B4))return;EQ.copy(r).invert(),nO.copy(e.ray).applyMatrix4(EQ);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=l*l,u=new Rt,f=new Rt,g=new Rt,T=new Rt,B=this.isLineSegments?2:1,q=i.index,se=i.attributes.position;if(null!==q)for(let Se=Math.max(0,o.start),je=Math.min(q.count,o.start+o.count)-1;Se<je;Se+=B){const Dt=q.getX(Se),Mt=q.getX(Se+1);if(u.fromBufferAttribute(se,Dt),f.fromBufferAttribute(se,Mt),nO.distanceSqToSegment(u,f,T,g)>d)continue;T.applyMatrix4(this.matrixWorld);const Jt=e.ray.origin.distanceTo(T);Jt<e.near||Jt>e.far||t.push({distance:Jt,point:g.clone().applyMatrix4(this.matrixWorld),index:Se,face:null,faceIndex:null,object:this})}else for(let Se=Math.max(0,o.start),je=Math.min(se.count,o.start+o.count)-1;Se<je;Se+=B){if(u.fromBufferAttribute(se,Se),f.fromBufferAttribute(se,Se+1),nO.distanceSqToSegment(u,f,T,g)>d)continue;T.applyMatrix4(this.matrixWorld);const Mt=e.ray.origin.distanceTo(T);Mt<e.near||Mt>e.far||t.push({distance:Mt,point:g.clone().applyMatrix4(this.matrixWorld),index:Se,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}const TQ=new Rt,DQ=new Rt;class hc extends gg{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)TQ.fromBufferAttribute(t,r),DQ.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+TQ.distanceTo(DQ);e.setAttribute("lineDistance",new ks(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class IQ extends gg{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class c1 extends ad{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new fr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const BQ=new fo,iO=new lC,P4=new ju,R4=new Rt;class $b extends Ol{constructor(e=new Qs,t=new c1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),P4.copy(i.boundingSphere),P4.applyMatrix4(r),P4.radius+=s,!1===e.ray.intersectsSphere(P4))return;BQ.copy(r).invert(),iO.copy(e.ray).applyMatrix4(BQ);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=l*l,u=i.index,g=i.attributes.position;if(null!==u)for(let q=Math.max(0,o.start),re=Math.min(u.count,o.start+o.count);q<re;q++){const se=u.getX(q);R4.fromBufferAttribute(g,se),PQ(R4,se,d,r,e,t,this)}else for(let q=Math.max(0,o.start),re=Math.min(g.count,o.start+o.count);q<re;q++)R4.fromBufferAttribute(g,q),PQ(R4,q,d,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function PQ(n,e,t,i,r,s,o){const l=iO.distanceSqToPoint(n);if(l<t){const d=new Rt;iO.closestPointToPoint(n,d),d.applyMatrix4(i);const u=r.ray.origin.distanceTo(d);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(l),point:d,index:e,face:null,object:o})}}class RC extends $h{constructor(e,t,i,r,s,o,l,d,u,f,g,T){super(null,o,l,d,u,f,r,s,g,T),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class RQ extends $h{constructor(e,t,i,r,s,o,l,d,u){super(e,t,i,r,s,o,l,d,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class H0{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let u,l=0,d=s-1;for(;l<=d;)if(r=Math.floor(l+(d-l)/2),u=i[r]-o,u<0)l=r+1;else{if(!(u>0)){d=r;break}d=r-1}if(r=d,i[r]===o)return r/(s-1);const f=i[r];return(r+(o-f)/(i[r+1]-f))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),l=this.getPoint(s),d=t||(o.isVector2?new Ni:new Rt);return d.copy(l).sub(o).normalize(),d}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new Rt,r=[],s=[],o=[],l=new Rt,d=new fo;for(let B=0;B<=e;B++)r[B]=this.getTangentAt(B/e,new Rt);s[0]=new Rt,o[0]=new Rt;let u=Number.MAX_VALUE;const f=Math.abs(r[0].x),g=Math.abs(r[0].y),T=Math.abs(r[0].z);f<=u&&(u=f,i.set(1,0,0)),g<=u&&(u=g,i.set(0,1,0)),T<=u&&i.set(0,0,1),l.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],l),o[0].crossVectors(r[0],s[0]);for(let B=1;B<=e;B++){if(s[B]=s[B-1].clone(),o[B]=o[B-1].clone(),l.crossVectors(r[B-1],r[B]),l.length()>Number.EPSILON){l.normalize();const q=Math.acos(_d(r[B-1].dot(r[B]),-1,1));s[B].applyMatrix4(d.makeRotationAxis(l,q))}o[B].crossVectors(r[B],s[B])}if(!0===t){let B=Math.acos(_d(s[0].dot(s[e]),-1,1));B/=e,r[0].dot(l.crossVectors(s[0],s[e]))>0&&(B=-B);for(let q=1;q<=e;q++)s[q].applyMatrix4(d.makeRotationAxis(r[q],B*q)),o[q].crossVectors(r[q],s[q])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class rO extends H0{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,l=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=l,this.aRotation=d}getPoint(e,t=new Ni){const i=t,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const l=this.aStartAngle+e*s;let d=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(0!==this.aRotation){const f=Math.cos(this.aRotation),g=Math.sin(this.aRotation),T=d-this.aX,B=u-this.aY;d=T*f-B*g+this.aX,u=T*g+B*f+this.aY}return i.set(d,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function sO(){let n=0,e=0,t=0,i=0;function r(s,o,l,d){n=s,e=l,t=-3*s+3*o-2*l-d,i=2*s-2*o+l+d}return{initCatmullRom:function(s,o,l,d,u){r(o,l,u*(l-s),u*(d-o))},initNonuniformCatmullRom:function(s,o,l,d,u,f,g){let T=(o-s)/u-(l-s)/(u+f)+(l-o)/f,B=(l-o)/f-(d-o)/(f+g)+(d-l)/g;T*=f,B*=f,r(o,l,T,B)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const k4=new Rt,oO=new sO,aO=new sO,lO=new sO;class cO extends H0{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new Rt){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let u,f,l=Math.floor(o),d=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:0===d&&l===s-1&&(l=s-2,d=1),this.closed||l>0?u=r[(l-1)%s]:(k4.subVectors(r[0],r[1]).add(r[0]),u=k4);const g=r[l%s],T=r[(l+1)%s];if(this.closed||l+2<s?f=r[(l+2)%s]:(k4.subVectors(r[s-1],r[s-2]).add(r[s-1]),f=k4),"centripetal"===this.curveType||"chordal"===this.curveType){const B="chordal"===this.curveType?.5:.25;let q=Math.pow(u.distanceToSquared(g),B),re=Math.pow(g.distanceToSquared(T),B),se=Math.pow(T.distanceToSquared(f),B);re<1e-4&&(re=1),q<1e-4&&(q=re),se<1e-4&&(se=re),oO.initNonuniformCatmullRom(u.x,g.x,T.x,f.x,q,re,se),aO.initNonuniformCatmullRom(u.y,g.y,T.y,f.y,q,re,se),lO.initNonuniformCatmullRom(u.z,g.z,T.z,f.z,q,re,se)}else"catmullrom"===this.curveType&&(oO.initCatmullRom(u.x,g.x,T.x,f.x,this.tension),aO.initCatmullRom(u.y,g.y,T.y,f.y,this.tension),lO.initCatmullRom(u.z,g.z,T.z,f.z,this.tension));return i.set(oO.calc(d),aO.calc(d),lO.calc(d)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new Rt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function kQ(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),l=n*n;return(2*t-2*i+s+o)*(n*l)+(-3*t+3*i-2*s-o)*l+s*n+t}function LE(n,e,t,i){return function R0e(n,e){const t=1-n;return t*t*e}(n,e)+function k0e(n,e){return 2*(1-n)*n*e}(n,t)+function F0e(n,e){return n*n*e}(n,i)}function NE(n,e,t,i,r){return function O0e(n,e){const t=1-n;return t*t*t*e}(n,e)+function L0e(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function N0e(n,e){return 3*(1-n)*n*n*e}(n,i)+function U0e(n,e){return n*n*n*e}(n,r)}class FQ extends H0{constructor(e=new Ni,t=new Ni,i=new Ni,r=new Ni){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Ni){const i=t,r=this.v0,s=this.v1,o=this.v2,l=this.v3;return i.set(NE(e,r.x,s.x,o.x,l.x),NE(e,r.y,s.y,o.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class OQ extends H0{constructor(e=new Ni,t=new Ni){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ni){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ni){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class LQ extends H0{constructor(e=new Ni,t=new Ni,i=new Ni){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Ni){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(LE(e,r.x,s.x,o.x),LE(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class dO extends H0{constructor(e=new Rt,t=new Rt,i=new Rt){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Rt){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(LE(e,r.x,s.x,o.x),LE(e,r.y,s.y,o.y),LE(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class NQ extends H0{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ni){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),l=s-o,d=r[0===o?o:o-1],u=r[o],f=r[o>r.length-2?r.length-1:o+1],g=r[o>r.length-3?r.length-1:o+2];return i.set(kQ(l,d.x,u.x,f.x,g.x),kQ(l,d.y,u.y,f.y,g.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new Ni).fromArray(r))}return this}}var F4=Object.freeze({__proto__:null,ArcCurve:class P0e extends rO{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:cO,CubicBezierCurve:FQ,CubicBezierCurve3:class z0e extends H0{constructor(e=new Rt,t=new Rt,i=new Rt,r=new Rt){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Rt){const i=t,r=this.v0,s=this.v1,o=this.v2,l=this.v3;return i.set(NE(e,r.x,s.x,o.x,l.x),NE(e,r.y,s.y,o.y,l.y),NE(e,r.z,s.z,o.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:rO,LineCurve:OQ,LineCurve3:class H0e extends H0{constructor(e=new Rt,t=new Rt){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Rt){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Rt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:LQ,QuadraticBezierCurve3:dO,SplineCurve:NQ});class V0e extends H0{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new F4[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,l=this.curves[s],d=l.getLength();return l.getPointAt(0===d?0:1-o/d,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],d=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let u=0;u<d.length;u++){const f=d[u];i&&i.equals(f)||(t.push(f),i=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new F4[r.type]).fromJSON(r))}return this}}class O4 extends V0e{constructor(e){super(),this.type="Path",this.currentPoint=new Ni,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new OQ(this.currentPoint.clone(),new Ni(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new LQ(this.currentPoint.clone(),new Ni(e,t),new Ni(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const l=new FQ(this.currentPoint.clone(),new Ni(e,t),new Ni(i,r),new Ni(s,o));return this.curves.push(l),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new NQ(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,l,d){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,l,d),this}absellipse(e,t,i,r,s,o,l,d){const u=new rO(e,t,i,r,s,o,l,d);if(this.curves.length>0){const g=u.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(u);const f=u.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class L4 extends Qs{constructor(e=[new Ni(0,-.5),new Ni(.5,0),new Ni(0,.5)],t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=_d(r,0,2*Math.PI);const s=[],o=[],l=[],d=[],u=[],f=1/t,g=new Rt,T=new Ni,B=new Rt,q=new Rt,re=new Rt;let se=0,ne=0;for(let De=0;De<=e.length-1;De++)switch(De){case 0:se=e[De+1].x-e[De].x,ne=e[De+1].y-e[De].y,B.x=1*ne,B.y=-se,B.z=0*ne,re.copy(B),B.normalize(),d.push(B.x,B.y,B.z);break;case e.length-1:d.push(re.x,re.y,re.z);break;default:se=e[De+1].x-e[De].x,ne=e[De+1].y-e[De].y,B.x=1*ne,B.y=-se,B.z=0*ne,q.copy(B),B.x+=re.x,B.y+=re.y,B.z+=re.z,B.normalize(),d.push(B.x,B.y,B.z),re.copy(q)}for(let De=0;De<=t;De++){const Se=i+De*f*r,je=Math.sin(Se),Dt=Math.cos(Se);for(let Mt=0;Mt<=e.length-1;Mt++)g.x=e[Mt].x*je,g.y=e[Mt].y,g.z=e[Mt].x*Dt,o.push(g.x,g.y,g.z),T.x=De/t,T.y=Mt/(e.length-1),l.push(T.x,T.y),u.push(d[3*Mt+0]*je,d[3*Mt+1],d[3*Mt+0]*Dt)}for(let De=0;De<t;De++)for(let Se=0;Se<e.length-1;Se++){const je=Se+De*e.length,Mt=je+e.length,Bt=je+e.length+1,Jt=je+1;s.push(je,Mt,Jt),s.push(Bt,Jt,Mt)}this.setIndex(s),this.setAttribute("position",new ks(o,3)),this.setAttribute("uv",new ks(l,2)),this.setAttribute("normal",new ks(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new L4(e.points,e.segments,e.phiStart,e.phiLength)}}class uO extends L4{constructor(e=1,t=1,i=4,r=8){const s=new O4;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new uO(e.radius,e.length,e.capSegments,e.radialSegments)}}class hO extends Qs{constructor(e=1,t=32,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],l=[],d=[],u=new Rt,f=new Ni;o.push(0,0,0),l.push(0,0,1),d.push(.5,.5);for(let g=0,T=3;g<=t;g++,T+=3){const B=i+g/t*r;u.x=e*Math.cos(B),u.y=e*Math.sin(B),o.push(u.x,u.y,u.z),l.push(0,0,1),f.x=(o[T]/e+1)/2,f.y=(o[T+1]/e+1)/2,d.push(f.x,f.y)}for(let g=1;g<=t;g++)s.push(g,g+1,0);this.setIndex(s),this.setAttribute("position",new ks(o,3)),this.setAttribute("normal",new ks(l,3)),this.setAttribute("uv",new ks(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hO(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class kC extends Qs{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,l=0,d=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:l,thetaLength:d};const u=this;r=Math.floor(r),s=Math.floor(s);const f=[],g=[],T=[],B=[];let q=0;const re=[],se=i/2;let ne=0;function Se(je){const Dt=q,Mt=new Ni,Bt=new Rt;let Jt=0;const Vn=!0===je?e:t,Tt=!0===je?1:-1;for(let Fi=1;Fi<=r;Fi++)g.push(0,se*Tt,0),T.push(0,Tt,0),B.push(.5,.5),q++;const tn=q;for(let Fi=0;Fi<=r;Fi++){const On=Fi/r*d+l,yi=Math.cos(On),Gn=Math.sin(On);Bt.x=Vn*Gn,Bt.y=se*Tt,Bt.z=Vn*yi,g.push(Bt.x,Bt.y,Bt.z),T.push(0,Tt,0),Mt.x=.5*yi+.5,Mt.y=.5*Gn*Tt+.5,B.push(Mt.x,Mt.y),q++}for(let Fi=0;Fi<r;Fi++){const Vi=Dt+Fi,On=tn+Fi;!0===je?f.push(On,On+1,Vi):f.push(On+1,On,Vi),Jt+=3}u.addGroup(ne,Jt,!0===je?1:2),ne+=Jt}(function De(){const je=new Rt,Dt=new Rt;let Mt=0;const Bt=(t-e)/i;for(let Jt=0;Jt<=s;Jt++){const Vn=[],Tt=Jt/s,tn=Tt*(t-e)+e;for(let Fi=0;Fi<=r;Fi++){const Vi=Fi/r,On=Vi*d+l,yi=Math.sin(On),Gn=Math.cos(On);Dt.x=tn*yi,Dt.y=-Tt*i+se,Dt.z=tn*Gn,g.push(Dt.x,Dt.y,Dt.z),je.set(yi,Bt,Gn).normalize(),T.push(je.x,je.y,je.z),B.push(Vi,1-Tt),Vn.push(q++)}re.push(Vn)}for(let Jt=0;Jt<r;Jt++)for(let Vn=0;Vn<s;Vn++){const tn=re[Vn+1][Jt],Fi=re[Vn+1][Jt+1],Vi=re[Vn][Jt+1];f.push(re[Vn][Jt],tn,Vi),f.push(tn,Fi,Vi),Mt+=6}u.addGroup(ne,Mt,0),ne+=Mt})(),!1===o&&(e>0&&Se(!0),t>0&&Se(!1)),this.setIndex(f),this.setAttribute("position",new ks(g,3)),this.setAttribute("normal",new ks(T,3)),this.setAttribute("uv",new ks(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kC(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class fO extends kC{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,l=2*Math.PI){super(0,e,t,i,r,s,o,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:l}}static fromJSON(e){return new fO(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Xb extends Qs{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function d(De,Se,je,Dt){const Mt=Dt+1,Bt=[];for(let Jt=0;Jt<=Mt;Jt++){Bt[Jt]=[];const Vn=De.clone().lerp(je,Jt/Mt),Tt=Se.clone().lerp(je,Jt/Mt),tn=Mt-Jt;for(let Fi=0;Fi<=tn;Fi++)Bt[Jt][Fi]=0===Fi&&Jt===Mt?Vn:Vn.clone().lerp(Tt,Fi/tn)}for(let Jt=0;Jt<Mt;Jt++)for(let Vn=0;Vn<2*(Mt-Jt)-1;Vn++){const Tt=Math.floor(Vn/2);Vn%2==0?(T(Bt[Jt][Tt+1]),T(Bt[Jt+1][Tt]),T(Bt[Jt][Tt])):(T(Bt[Jt][Tt+1]),T(Bt[Jt+1][Tt+1]),T(Bt[Jt+1][Tt]))}}function T(De){s.push(De.x,De.y,De.z)}function B(De,Se){const je=3*De;Se.x=e[je+0],Se.y=e[je+1],Se.z=e[je+2]}function re(De,Se,je,Dt){Dt<0&&1===De.x&&(o[Se]=De.x-1),0===je.x&&0===je.z&&(o[Se]=Dt/2/Math.PI+.5)}function se(De){return Math.atan2(De.z,-De.x)}function ne(De){return Math.atan2(-De.y,Math.sqrt(De.x*De.x+De.z*De.z))}(function l(De){const Se=new Rt,je=new Rt,Dt=new Rt;for(let Mt=0;Mt<t.length;Mt+=3)B(t[Mt+0],Se),B(t[Mt+1],je),B(t[Mt+2],Dt),d(Se,je,Dt,De)})(r),function u(De){const Se=new Rt;for(let je=0;je<s.length;je+=3)Se.x=s[je+0],Se.y=s[je+1],Se.z=s[je+2],Se.normalize().multiplyScalar(De),s[je+0]=Se.x,s[je+1]=Se.y,s[je+2]=Se.z}(i),function f(){const De=new Rt;for(let Se=0;Se<s.length;Se+=3){De.x=s[Se+0],De.y=s[Se+1],De.z=s[Se+2];const je=se(De)/2/Math.PI+.5,Dt=ne(De)/Math.PI+.5;o.push(je,1-Dt)}(function q(){const De=new Rt,Se=new Rt,je=new Rt,Dt=new Rt,Mt=new Ni,Bt=new Ni,Jt=new Ni;for(let Vn=0,Tt=0;Vn<s.length;Vn+=9,Tt+=6){De.set(s[Vn+0],s[Vn+1],s[Vn+2]),Se.set(s[Vn+3],s[Vn+4],s[Vn+5]),je.set(s[Vn+6],s[Vn+7],s[Vn+8]),Mt.set(o[Tt+0],o[Tt+1]),Bt.set(o[Tt+2],o[Tt+3]),Jt.set(o[Tt+4],o[Tt+5]),Dt.copy(De).add(Se).add(je).divideScalar(3);const tn=se(Dt);re(Mt,Tt+0,De,tn),re(Bt,Tt+2,Se,tn),re(Jt,Tt+4,je,tn)}})(),function g(){for(let De=0;De<o.length;De+=6){const Se=o[De+0],je=o[De+2],Dt=o[De+4],Mt=Math.max(Se,je,Dt),Bt=Math.min(Se,je,Dt);Mt>.9&&Bt<.1&&(Se<.2&&(o[De+0]+=1),je<.2&&(o[De+2]+=1),Dt<.2&&(o[De+4]+=1))}}()}(),this.setAttribute("position",new ks(s,3)),this.setAttribute("normal",new ks(s.slice(),3)),this.setAttribute("uv",new ks(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xb(e.vertices,e.indices,e.radius,e.details)}}class pO extends Xb{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new pO(e.radius,e.detail)}}const N4=new Rt,U4=new Rt,mO=new Rt,z4=new _m;class UQ extends Qs{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Fb*t),o=e.getIndex(),l=e.getAttribute("position"),d=o?o.count:l.count,u=[0,0,0],f=["a","b","c"],g=new Array(3),T={},B=[];for(let q=0;q<d;q+=3){o?(u[0]=o.getX(q),u[1]=o.getX(q+1),u[2]=o.getX(q+2)):(u[0]=q,u[1]=q+1,u[2]=q+2);const{a:re,b:se,c:ne}=z4;if(re.fromBufferAttribute(l,u[0]),se.fromBufferAttribute(l,u[1]),ne.fromBufferAttribute(l,u[2]),z4.getNormal(mO),g[0]=`${Math.round(re.x*r)},${Math.round(re.y*r)},${Math.round(re.z*r)}`,g[1]=`${Math.round(se.x*r)},${Math.round(se.y*r)},${Math.round(se.z*r)}`,g[2]=`${Math.round(ne.x*r)},${Math.round(ne.y*r)},${Math.round(ne.z*r)}`,g[0]!==g[1]&&g[1]!==g[2]&&g[2]!==g[0])for(let De=0;De<3;De++){const Se=(De+1)%3,je=g[De],Dt=g[Se],Mt=z4[f[De]],Bt=z4[f[Se]],Jt=`${je}_${Dt}`,Vn=`${Dt}_${je}`;Vn in T&&T[Vn]?(mO.dot(T[Vn].normal)<=s&&(B.push(Mt.x,Mt.y,Mt.z),B.push(Bt.x,Bt.y,Bt.z)),T[Vn]=null):Jt in T||(T[Jt]={index0:u[De],index1:u[Se],normal:mO.clone()})}}for(const q in T)if(T[q]){const{index0:re,index1:se}=T[q];N4.fromBufferAttribute(l,re),U4.fromBufferAttribute(l,se),B.push(N4.x,N4.y,N4.z),B.push(U4.x,U4.y,U4.z)}this.setAttribute("position",new ks(B,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class FC extends O4{constructor(e){super(e),this.uuid=Am(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new O4).fromJSON(r))}return this}}function zQ(n,e,t,i,r){let s,o;if(r===function s_e(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=GQ(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=GQ(s,n[s],n[s+1],o);return o&&H4(o,o.next)&&(HE(o),o=o.next),o}function Yb(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!H4(t,t.next)&&0!==ld(t.prev,t,t.next))t=t.next;else{if(HE(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function UE(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function J0e(n,e,t,i){let r=n;do{0===r.z&&(r.z=AO(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function e_e(n){let e,t,i,r,s,o,l,d,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,l=0,e=0;e<u&&(l++,i=i.nextZ,i);e++);for(d=u;l>0||d>0&&i;)0!==l&&(0===d||!i||t.z<=i.z)?(r=t,t=t.nextZ,l--):(r=i,i=i.nextZ,d--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1)}(r)}(n,i,r,s);let d,u,l=n;for(;n.prev!==n.next;)if(d=n.prev,u=n.next,s?Q0e(n,i,r,s):q0e(n))e.push(d.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),HE(n),n=u.next,l=u.next;else if((n=u)===l){o?1===o?UE(n=W0e(Yb(n),e,t),e,t,i,r,s,2):2===o&&j0e(n,e,t,i,r,s):UE(Yb(n),e,t,i,r,s,1);break}}function q0e(n){const e=n.prev,t=n,i=n.next;if(ld(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,l=e.y,d=t.y,u=i.y,f=r<s?r<o?r:o:s<o?s:o,g=l<d?l<u?l:u:d<u?d:u,T=r>s?r>o?r:o:s>o?s:o,B=l>d?l>u?l:u:d>u?d:u;let q=i.next;for(;q!==e;){if(q.x>=f&&q.x<=T&&q.y>=g&&q.y<=B&&OC(r,l,s,d,o,u,q.x,q.y)&&ld(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function Q0e(n,e,t,i){const r=n.prev,s=n,o=n.next;if(ld(r,s,o)>=0)return!1;const l=r.x,d=s.x,u=o.x,f=r.y,g=s.y,T=o.y,B=l<d?l<u?l:u:d<u?d:u,q=f<g?f<T?f:T:g<T?g:T,re=l>d?l>u?l:u:d>u?d:u,se=f>g?f>T?f:T:g>T?g:T,ne=AO(B,q,e,t,i),De=AO(re,se,e,t,i);let Se=n.prevZ,je=n.nextZ;for(;Se&&Se.z>=ne&&je&&je.z<=De;){if(Se.x>=B&&Se.x<=re&&Se.y>=q&&Se.y<=se&&Se!==r&&Se!==o&&OC(l,f,d,g,u,T,Se.x,Se.y)&&ld(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,je.x>=B&&je.x<=re&&je.y>=q&&je.y<=se&&je!==r&&je!==o&&OC(l,f,d,g,u,T,je.x,je.y)&&ld(je.prev,je,je.next)>=0))return!1;je=je.nextZ}for(;Se&&Se.z>=ne;){if(Se.x>=B&&Se.x<=re&&Se.y>=q&&Se.y<=se&&Se!==r&&Se!==o&&OC(l,f,d,g,u,T,Se.x,Se.y)&&ld(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;je&&je.z<=De;){if(je.x>=B&&je.x<=re&&je.y>=q&&je.y<=se&&je!==r&&je!==o&&OC(l,f,d,g,u,T,je.x,je.y)&&ld(je.prev,je,je.next)>=0)return!1;je=je.nextZ}return!0}function W0e(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!H4(r,s)&&HQ(r,i,i.next,s)&&zE(r,s)&&zE(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),HE(i),HE(i.next),i=n=s),i=i.next}while(i!==n);return Yb(i)}function j0e(n,e,t,i,r,s){let o=n;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&n_e(o,l)){let d=VQ(o,l);return o=Yb(o,o.next),d=Yb(d,d.next),UE(o,e,t,i,r,s,0),void UE(d,e,t,i,r,s,0)}l=l.next}o=o.next}while(o!==n)}function X0e(n,e){return n.x-e.x}function Y0e(n,e){const t=function K0e(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const T=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(T<=s&&T>i&&(i=T,r=t.x<t.next.x?t:t.next,T===s))return r}t=t.next}while(t!==e);if(!r)return null;const l=r,d=r.x,u=r.y;let g,f=1/0;t=r;do{s>=t.x&&t.x>=d&&s!==t.x&&OC(o<u?s:i,o,d,u,o<u?i:s,o,t.x,t.y)&&(g=Math.abs(o-t.y)/(s-t.x),zE(t,n)&&(g<f||g===f&&(t.x>r.x||t.x===r.x&&Z0e(r,t)))&&(r=t,f=g)),t=t.next}while(t!==l);return r}(n,e);if(!t)return e;const i=VQ(t,n);return Yb(i,i.next),Yb(t,t.next)}function Z0e(n,e){return ld(n.prev,n,e.prev)<0&&ld(e.next,n,n.next)<0}function AO(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function t_e(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function OC(n,e,t,i,r,s,o,l){return(r-o)*(e-l)>=(n-o)*(s-l)&&(n-o)*(i-l)>=(t-o)*(e-l)&&(t-o)*(s-l)>=(r-o)*(i-l)}function n_e(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function i_e(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&HQ(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(zE(n,e)&&zE(e,n)&&function r_e(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(ld(n.prev,n,e.prev)||ld(n,e.prev,e))||H4(n,e)&&ld(n.prev,n,n.next)>0&&ld(e.prev,e,e.next)>0)}function ld(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function H4(n,e){return n.x===e.x&&n.y===e.y}function HQ(n,e,t,i){const r=G4(ld(n,e,t)),s=G4(ld(n,e,i)),o=G4(ld(t,i,n)),l=G4(ld(t,i,e));return!!(r!==s&&o!==l||0===r&&V4(n,t,e)||0===s&&V4(n,i,e)||0===o&&V4(t,n,i)||0===l&&V4(t,e,i))}function V4(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function G4(n){return n>0?1:n<0?-1:0}function zE(n,e){return ld(n.prev,n,n.next)<0?ld(n,e,n.next)>=0&&ld(n,n.prev,e)>=0:ld(n,e,n.prev)<0||ld(n,n.next,e)<0}function VQ(n,e){const t=new gO(n.i,n.x,n.y),i=new gO(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function GQ(n,e,t,i){const r=new gO(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function HE(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function gO(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class d1{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return d1.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];qQ(e),QQ(i,e);let o=e.length;t.forEach(qQ);for(let d=0;d<t.length;d++)r.push(o),o+=t[d].length,QQ(i,t[d]);const l=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=zQ(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let l,d,u,f,g,T,B;if(i&&(s=function $0e(n,e,t,i){const r=[];let s,o,l,d,u;for(s=0,o=e.length;s<o;s++)l=e[s]*i,d=s<o-1?e[s+1]*i:n.length,u=zQ(n,l,d,i,!1),u===u.next&&(u.steiner=!0),r.push(t_e(u));for(r.sort(X0e),s=0;s<r.length;s++)t=Y0e(r[s],t);return t}(n,e,s,t)),n.length>80*t){l=u=n[0],d=f=n[1];for(let q=t;q<r;q+=t)g=n[q],T=n[q+1],g<l&&(l=g),T<d&&(d=T),g>u&&(u=g),T>f&&(f=T);B=Math.max(u-l,f-d),B=0!==B?32767/B:0}return UE(s,o,t,l,d,B,0),o}(i,r);for(let d=0;d<l.length;d+=3)s.push(l.slice(d,d+3));return s}}function qQ(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function QQ(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class q4 extends Qs{constructor(e=new FC([new Ni(.5,.5),new Ni(-.5,.5),new Ni(-.5,-.5),new Ni(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let l=0,d=e.length;l<d;l++)o(e[l]);function o(l){const d=[],u=void 0!==t.curveSegments?t.curveSegments:12,f=void 0!==t.steps?t.steps:1,g=void 0!==t.depth?t.depth:1;let T=void 0===t.bevelEnabled||t.bevelEnabled,B=void 0!==t.bevelThickness?t.bevelThickness:.2,q=void 0!==t.bevelSize?t.bevelSize:B-.1,re=void 0!==t.bevelOffset?t.bevelOffset:0,se=void 0!==t.bevelSegments?t.bevelSegments:3;const ne=t.extrudePath,De=void 0!==t.UVGenerator?t.UVGenerator:o_e;let Se,Dt,Mt,Bt,Jt,je=!1;ne&&(Se=ne.getSpacedPoints(f),je=!0,T=!1,Dt=ne.computeFrenetFrames(f,!1),Mt=new Rt,Bt=new Rt,Jt=new Rt),T||(se=0,B=0,q=0,re=0);const Vn=l.extractPoints(u);let Tt=Vn.shape;const tn=Vn.holes;if(!d1.isClockWise(Tt)){Tt=Tt.reverse();for(let zn=0,es=tn.length;zn<es;zn++){const ar=tn[zn];d1.isClockWise(ar)&&(tn[zn]=ar.reverse())}}const Vi=d1.triangulateShape(Tt,tn),On=Tt;for(let zn=0,es=tn.length;zn<es;zn++)Tt=Tt.concat(tn[zn]);function yi(zn,es,ar){return es||console.error("THREE.ExtrudeGeometry: vec does not exist"),zn.clone().addScaledVector(es,ar)}const Gn=Tt.length,ri=Vi.length;function di(zn,es,ar){let jr,gr,Hs;const Is=zn.x-es.x,Zs=zn.y-es.y,Ba=ar.x-zn.x,Mn=ar.y-zn.y,qt=Is*Is+Zs*Zs;if(Math.abs(Is*Mn-Zs*Ba)>Number.EPSILON){const er=Math.sqrt(qt),Lr=Math.sqrt(Ba*Ba+Mn*Mn),Mr=es.x-Zs/er,sa=es.y+Is/er,As=((ar.x-Mn/Lr-Mr)*Mn-(ar.y+Ba/Lr-sa)*Ba)/(Is*Mn-Zs*Ba);jr=Mr+Is*As-zn.x,gr=sa+Zs*As-zn.y;const oa=jr*jr+gr*gr;if(oa<=2)return new Ni(jr,gr);Hs=Math.sqrt(oa/2)}else{let er=!1;Is>Number.EPSILON?Ba>Number.EPSILON&&(er=!0):Is<-Number.EPSILON?Ba<-Number.EPSILON&&(er=!0):Math.sign(Zs)===Math.sign(Mn)&&(er=!0),er?(jr=-Zs,gr=Is,Hs=Math.sqrt(qt)):(jr=Is,gr=Zs,Hs=Math.sqrt(qt/2))}return new Ni(jr/Hs,gr/Hs)}const _i=[];for(let zn=0,es=On.length,ar=es-1,jr=zn+1;zn<es;zn++,ar++,jr++)ar===es&&(ar=0),jr===es&&(jr=0),_i[zn]=di(On[zn],On[ar],On[jr]);const sr=[];let pr,Hr=_i.concat();for(let zn=0,es=tn.length;zn<es;zn++){const ar=tn[zn];pr=[];for(let jr=0,gr=ar.length,Hs=gr-1,Is=jr+1;jr<gr;jr++,Hs++,Is++)Hs===gr&&(Hs=0),Is===gr&&(Is=0),pr[jr]=di(ar[jr],ar[Hs],ar[Is]);sr.push(pr),Hr=Hr.concat(pr)}for(let zn=0;zn<se;zn++){const es=zn/se,ar=B*Math.cos(es*Math.PI/2),jr=q*Math.sin(es*Math.PI/2)+re;for(let gr=0,Hs=On.length;gr<Hs;gr++){const Is=yi(On[gr],_i[gr],jr);_s(Is.x,Is.y,-ar)}for(let gr=0,Hs=tn.length;gr<Hs;gr++){const Is=tn[gr];pr=sr[gr];for(let Zs=0,Ba=Is.length;Zs<Ba;Zs++){const Mn=yi(Is[Zs],pr[Zs],jr);_s(Mn.x,Mn.y,-ar)}}}const Ns=q+re;for(let zn=0;zn<Gn;zn++){const es=T?yi(Tt[zn],Hr[zn],Ns):Tt[zn];je?(Bt.copy(Dt.normals[0]).multiplyScalar(es.x),Mt.copy(Dt.binormals[0]).multiplyScalar(es.y),Jt.copy(Se[0]).add(Bt).add(Mt),_s(Jt.x,Jt.y,Jt.z)):_s(es.x,es.y,0)}for(let zn=1;zn<=f;zn++)for(let es=0;es<Gn;es++){const ar=T?yi(Tt[es],Hr[es],Ns):Tt[es];je?(Bt.copy(Dt.normals[zn]).multiplyScalar(ar.x),Mt.copy(Dt.binormals[zn]).multiplyScalar(ar.y),Jt.copy(Se[zn]).add(Bt).add(Mt),_s(Jt.x,Jt.y,Jt.z)):_s(ar.x,ar.y,g/f*zn)}for(let zn=se-1;zn>=0;zn--){const es=zn/se,ar=B*Math.cos(es*Math.PI/2),jr=q*Math.sin(es*Math.PI/2)+re;for(let gr=0,Hs=On.length;gr<Hs;gr++){const Is=yi(On[gr],_i[gr],jr);_s(Is.x,Is.y,g+ar)}for(let gr=0,Hs=tn.length;gr<Hs;gr++){const Is=tn[gr];pr=sr[gr];for(let Zs=0,Ba=Is.length;Zs<Ba;Zs++){const Mn=yi(Is[Zs],pr[Zs],jr);je?_s(Mn.x,Mn.y+Se[f-1].y,Se[f-1].x+ar):_s(Mn.x,Mn.y,g+ar)}}}function is(zn,es){let ar=zn.length;for(;--ar>=0;){const jr=ar;let gr=ar-1;gr<0&&(gr=zn.length-1);for(let Hs=0,Is=f+2*se;Hs<Is;Hs++){const Zs=Gn*Hs,Ba=Gn*(Hs+1);cs(es+jr+Zs,es+gr+Zs,es+gr+Ba,es+jr+Ba)}}}function _s(zn,es,ar){d.push(zn),d.push(es),d.push(ar)}function ws(zn,es,ar){po(zn),po(es),po(ar);const jr=r.length/3,gr=De.generateTopUV(i,r,jr-3,jr-2,jr-1);Xs(gr[0]),Xs(gr[1]),Xs(gr[2])}function cs(zn,es,ar,jr){po(zn),po(es),po(jr),po(es),po(ar),po(jr);const gr=r.length/3,Hs=De.generateSideWallUV(i,r,gr-6,gr-3,gr-2,gr-1);Xs(Hs[0]),Xs(Hs[1]),Xs(Hs[3]),Xs(Hs[1]),Xs(Hs[2]),Xs(Hs[3])}function po(zn){r.push(d[3*zn+0]),r.push(d[3*zn+1]),r.push(d[3*zn+2])}function Xs(zn){s.push(zn.x),s.push(zn.y)}(function ui(){const zn=r.length/3;if(T){let es=0,ar=Gn*es;for(let jr=0;jr<ri;jr++){const gr=Vi[jr];ws(gr[2]+ar,gr[1]+ar,gr[0]+ar)}es=f+2*se,ar=Gn*es;for(let jr=0;jr<ri;jr++){const gr=Vi[jr];ws(gr[0]+ar,gr[1]+ar,gr[2]+ar)}}else{for(let es=0;es<ri;es++){const ar=Vi[es];ws(ar[2],ar[1],ar[0])}for(let es=0;es<ri;es++){const ar=Vi[es];ws(ar[0]+Gn*f,ar[1]+Gn*f,ar[2]+Gn*f)}}i.addGroup(zn,r.length/3-zn,0)})(),function xr(){const zn=r.length/3;let es=0;is(On,es),es+=On.length;for(let ar=0,jr=tn.length;ar<jr;ar++){const gr=tn[ar];is(gr,es),es+=gr.length}i.addGroup(zn,r.length/3-zn,1)}()}this.setAttribute("position",new ks(r,3)),this.setAttribute("uv",new ks(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function a_e(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new F4[r.type]).fromJSON(r)),new q4(i,e.options)}}const o_e={generateTopUV:function(n,e,t,i,r){const l=e[3*i],d=e[3*i+1],u=e[3*r],f=e[3*r+1];return[new Ni(e[3*t],e[3*t+1]),new Ni(l,d),new Ni(u,f)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],l=e[3*t+1],d=e[3*t+2],u=e[3*i],f=e[3*i+1],g=e[3*i+2],T=e[3*r],B=e[3*r+1],q=e[3*r+2],re=e[3*s],se=e[3*s+1],ne=e[3*s+2];return Math.abs(l-f)<Math.abs(o-u)?[new Ni(o,1-d),new Ni(u,1-g),new Ni(T,1-q),new Ni(re,1-ne)]:[new Ni(l,1-d),new Ni(f,1-g),new Ni(B,1-q),new Ni(se,1-ne)]}};class _O extends Xb{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _O(e.radius,e.detail)}}class Q4 extends Xb{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Q4(e.radius,e.detail)}}class yO extends Qs{constructor(e=.5,t=1,i=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i);const l=[],d=[],u=[],f=[];let g=e;const T=(t-e)/(r=Math.max(1,r)),B=new Rt,q=new Ni;for(let re=0;re<=r;re++){for(let se=0;se<=i;se++){const ne=s+se/i*o;B.x=g*Math.cos(ne),B.y=g*Math.sin(ne),d.push(B.x,B.y,B.z),u.push(0,0,1),q.x=(B.x/t+1)/2,q.y=(B.y/t+1)/2,f.push(q.x,q.y)}g+=T}for(let re=0;re<r;re++){const se=re*(i+1);for(let ne=0;ne<i;ne++){const De=ne+se,je=De+i+1,Dt=De+i+2,Mt=De+1;l.push(De,je,Mt),l.push(je,Dt,Mt)}}this.setIndex(l),this.setAttribute("position",new ks(d,3)),this.setAttribute("normal",new ks(u,3)),this.setAttribute("uv",new ks(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yO(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class vO extends Qs{constructor(e=new FC([new Ni(0,.5),new Ni(-.5,-.5),new Ni(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let l=0,d=0;if(!1===Array.isArray(e))u(e);else for(let f=0;f<e.length;f++)u(e[f]),this.addGroup(l,d,f),l+=d,d=0;function u(f){const g=r.length/3,T=f.extractPoints(t);let B=T.shape;const q=T.holes;!1===d1.isClockWise(B)&&(B=B.reverse());for(let se=0,ne=q.length;se<ne;se++){const De=q[se];!0===d1.isClockWise(De)&&(q[se]=De.reverse())}const re=d1.triangulateShape(B,q);for(let se=0,ne=q.length;se<ne;se++)B=B.concat(q[se]);for(let se=0,ne=B.length;se<ne;se++){const De=B[se];r.push(De.x,De.y,0),s.push(0,0,1),o.push(De.x,De.y)}for(let se=0,ne=re.length;se<ne;se++){const De=re[se];i.push(De[0]+g,De[1]+g,De[2]+g),d+=3}}this.setIndex(i),this.setAttribute("position",new ks(r,3)),this.setAttribute("normal",new ks(s,3)),this.setAttribute("uv",new ks(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function l_e(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new vO(i,e.curveSegments)}}class $y extends Qs{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const d=Math.min(o+l,Math.PI);let u=0;const f=[],g=new Rt,T=new Rt,B=[],q=[],re=[],se=[];for(let ne=0;ne<=i;ne++){const De=[],Se=ne/i;let je=0;0===ne&&0===o?je=.5/t:ne===i&&d===Math.PI&&(je=-.5/t);for(let Dt=0;Dt<=t;Dt++){const Mt=Dt/t;g.x=-e*Math.cos(r+Mt*s)*Math.sin(o+Se*l),g.y=e*Math.cos(o+Se*l),g.z=e*Math.sin(r+Mt*s)*Math.sin(o+Se*l),q.push(g.x,g.y,g.z),T.copy(g).normalize(),re.push(T.x,T.y,T.z),se.push(Mt+je,1-Se),De.push(u++)}f.push(De)}for(let ne=0;ne<i;ne++)for(let De=0;De<t;De++){const je=f[ne][De],Dt=f[ne+1][De],Mt=f[ne+1][De+1];(0!==ne||o>0)&&B.push(f[ne][De+1],je,Mt),(ne!==i-1||d<Math.PI)&&B.push(je,Dt,Mt)}this.setIndex(B),this.setAttribute("position",new ks(q,3)),this.setAttribute("normal",new ks(re,3)),this.setAttribute("uv",new ks(se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $y(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class bO extends Xb{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new bO(e.radius,e.detail)}}class xO extends Qs{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],l=[],d=[],u=[],f=new Rt,g=new Rt,T=new Rt;for(let B=0;B<=i;B++)for(let q=0;q<=r;q++){const re=q/r*s,se=B/i*Math.PI*2;g.x=(e+t*Math.cos(se))*Math.cos(re),g.y=(e+t*Math.cos(se))*Math.sin(re),g.z=t*Math.sin(se),l.push(g.x,g.y,g.z),f.x=e*Math.cos(re),f.y=e*Math.sin(re),T.subVectors(g,f).normalize(),d.push(T.x,T.y,T.z),u.push(q/r),u.push(B/i)}for(let B=1;B<=i;B++)for(let q=1;q<=r;q++){const se=(r+1)*(B-1)+q-1,ne=(r+1)*(B-1)+q,De=(r+1)*B+q;o.push((r+1)*B+q-1,se,De),o.push(se,ne,De)}this.setIndex(o),this.setAttribute("position",new ks(l,3)),this.setAttribute("normal",new ks(d,3)),this.setAttribute("uv",new ks(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xO(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class wO extends Qs{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const l=[],d=[],u=[],f=[],g=new Rt,T=new Rt,B=new Rt,q=new Rt,re=new Rt,se=new Rt,ne=new Rt;for(let Se=0;Se<=i;++Se){const je=Se/i*s*Math.PI*2;De(je,s,o,e,B),De(je+.01,s,o,e,q),se.subVectors(q,B),ne.addVectors(q,B),re.crossVectors(se,ne),ne.crossVectors(re,se),re.normalize(),ne.normalize();for(let Dt=0;Dt<=r;++Dt){const Mt=Dt/r*Math.PI*2,Bt=-t*Math.cos(Mt),Jt=t*Math.sin(Mt);g.x=B.x+(Bt*ne.x+Jt*re.x),g.y=B.y+(Bt*ne.y+Jt*re.y),g.z=B.z+(Bt*ne.z+Jt*re.z),d.push(g.x,g.y,g.z),T.subVectors(g,B).normalize(),u.push(T.x,T.y,T.z),f.push(Se/i),f.push(Dt/r)}}for(let Se=1;Se<=i;Se++)for(let je=1;je<=r;je++){const Mt=(r+1)*Se+(je-1),Bt=(r+1)*Se+je,Jt=(r+1)*(Se-1)+je;l.push((r+1)*(Se-1)+(je-1),Mt,Jt),l.push(Mt,Bt,Jt)}function De(Se,je,Dt,Mt,Bt){const Jt=Math.cos(Se),Vn=Math.sin(Se),Tt=Dt/je*Se,tn=Math.cos(Tt);Bt.x=Mt*(2+tn)*.5*Jt,Bt.y=Mt*(2+tn)*Vn*.5,Bt.z=Mt*Math.sin(Tt)*.5}this.setIndex(l),this.setAttribute("position",new ks(d,3)),this.setAttribute("normal",new ks(u,3)),this.setAttribute("uv",new ks(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wO(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Kb extends Qs{constructor(e=new dO(new Rt(-1,-1,0),new Rt(-1,1,0),new Rt(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const l=new Rt,d=new Rt,u=new Ni;let f=new Rt;const g=[],T=[],B=[],q=[];function se(Se){f=e.getPointAt(Se/t,f);const je=o.normals[Se],Dt=o.binormals[Se];for(let Mt=0;Mt<=r;Mt++){const Bt=Mt/r*Math.PI*2,Jt=Math.sin(Bt),Vn=-Math.cos(Bt);d.x=Vn*je.x+Jt*Dt.x,d.y=Vn*je.y+Jt*Dt.y,d.z=Vn*je.z+Jt*Dt.z,d.normalize(),T.push(d.x,d.y,d.z),l.x=f.x+i*d.x,l.y=f.y+i*d.y,l.z=f.z+i*d.z,g.push(l.x,l.y,l.z)}}(function re(){for(let Se=0;Se<t;Se++)se(Se);se(!1===s?t:0),function De(){for(let Se=0;Se<=t;Se++)for(let je=0;je<=r;je++)u.x=Se/t,u.y=je/r,B.push(u.x,u.y)}(),function ne(){for(let Se=1;Se<=t;Se++)for(let je=1;je<=r;je++){const Mt=(r+1)*Se+(je-1),Bt=(r+1)*Se+je,Jt=(r+1)*(Se-1)+je;q.push((r+1)*(Se-1)+(je-1),Mt,Jt),q.push(Mt,Bt,Jt)}}()})(),this.setIndex(q),this.setAttribute("position",new ks(g,3)),this.setAttribute("normal",new ks(T,3)),this.setAttribute("uv",new ks(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Kb((new F4[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}function WQ(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return!0!==t.has(i)&&!0!==t.has(r)&&(t.add(i),t.add(r),!0)}var jQ=Object.freeze({__proto__:null,BoxGeometry:Mp,CapsuleGeometry:uO,CircleGeometry:hO,ConeGeometry:fO,CylinderGeometry:kC,DodecahedronGeometry:pO,EdgesGeometry:UQ,ExtrudeGeometry:q4,IcosahedronGeometry:_O,LatheGeometry:L4,OctahedronGeometry:Q4,PlaneGeometry:vC,PolyhedronGeometry:Xb,RingGeometry:yO,ShapeGeometry:vO,SphereGeometry:$y,TetrahedronGeometry:bO,TorusGeometry:xO,TorusKnotGeometry:wO,TubeGeometry:Kb,WireframeGeometry:class c_e extends Qs{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],i=new Set,r=new Rt,s=new Rt;if(null!==e.index){const o=e.attributes.position,l=e.index;let d=e.groups;0===d.length&&(d=[{start:0,count:l.count,materialIndex:0}]);for(let u=0,f=d.length;u<f;++u){const g=d[u],T=g.start;for(let q=T,re=T+g.count;q<re;q+=3)for(let se=0;se<3;se++){const ne=l.getX(q+se),De=l.getX(q+(se+1)%3);r.fromBufferAttribute(o,ne),s.fromBufferAttribute(o,De),!0===WQ(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let l=0,d=o.count/3;l<d;l++)for(let u=0;u<3;u++){const g=3*l+(u+1)%3;r.fromBufferAttribute(o,3*l+u),s.fromBufferAttribute(o,g),!0===WQ(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new ks(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}});class d_e extends ad{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new fr(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class u_e extends Cu{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class W4 extends ad{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ni(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new U0,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class V0 extends W4{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ni(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return _d(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new fr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new fr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new fr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class _g extends ad{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new fr(16777215),this.specular=new fr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ni(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new U0,this.combine=LI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $Q extends ad{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new fr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ni(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class h_e extends ad{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ni(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class f_e extends ad{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new fr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ni(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new U0,this.combine=LI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class p_e extends ad{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ni(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Zb extends wc{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Jb(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function YQ(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function CO(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const l=t[s]*e;for(let d=0;d!==e;++d)r[o++]=n[l+d]}return r}function MO(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class VE{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let l=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const l=t[1];e<l&&(i=2,s=l);for(let d=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===d)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const l=i+o>>>1;e<t[l]?o=l:i=l+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class g_e extends VE{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,l=r[s],d=r[o];if(void 0===l)switch(this.getSettings_().endingStart){case 2401:s=e,l=2*t-i;break;case 2402:s=r.length-2,l=t+r[s]-r[s+1];break;default:s=e,l=i}if(void 0===d)switch(this.getSettings_().endingEnd){case 2401:o=e,d=2*i-t;break;case 2402:o=1,d=i+r[1]-r[0];break;default:o=e-1,d=t}const u=.5*(i-t),f=this.valueSize;this._weightPrev=u/(t-l),this._weightNext=u/(d-i),this._offsetPrev=s*f,this._offsetNext=o*f}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,d=e*l,u=d-l,f=this._offsetPrev,g=this._offsetNext,T=this._weightPrev,B=this._weightNext,q=(i-t)/(r-t),re=q*q,se=re*q,ne=-T*se+2*T*re-T*q,De=(1+T)*se+(-1.5-2*T)*re+(-.5+T)*q+1,Se=(-1-B)*se+(1.5+B)*re+.5*q,je=B*se-B*re;for(let Dt=0;Dt!==l;++Dt)s[Dt]=ne*o[f+Dt]+De*o[u+Dt]+Se*o[d+Dt]+je*o[g+Dt];return s}}class KQ extends VE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,d=e*l,u=d-l,f=(i-t)/(r-t),g=1-f;for(let T=0;T!==l;++T)s[T]=o[u+T]*g+o[d+T]*f;return s}}class __e extends VE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class G0{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Jb(t,this.TimeBufferType),this.values=Jb(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Jb(e.times,Array),values:Jb(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new __e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new KQ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new g_e(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case K2:t=this.InterpolantFactoryMethodDiscrete;break;case Rb:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return K2;case this.InterpolantFactoryMethodLinear:return Rb;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const l=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*l,o*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==s;l++){const d=i[l];if("number"==typeof d&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,d),e=!1;break}if(null!==o&&o>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,d,o),e=!1;break}o=d}if(void 0!==r&&function XQ(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let l=0,d=r.length;l!==d;++l){const u=r[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let l=1;l<s;++l){let d=!1;const u=e[l];if(u!==e[l+1]&&(1!==l||u!==e[0]))if(r)d=!0;else{const g=l*i,T=g-i,B=g+i;for(let q=0;q!==i;++q){const re=t[g+q];if(re!==t[T+q]||re!==t[B+q]){d=!0;break}}}if(d){if(l!==o){e[o]=e[l];const g=l*i,T=o*i;for(let B=0;B!==i;++B)t[T+B]=t[g+B]}++o}}if(s>0){e[o]=e[s];for(let l=s*i,d=o*i,u=0;u!==i;++u)t[d+u]=t[l+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}G0.prototype.TimeBufferType=Float32Array,G0.prototype.ValueBufferType=Float32Array,G0.prototype.DefaultInterpolation=Rb;class LC extends G0{}LC.prototype.ValueTypeName="bool",LC.prototype.ValueBufferType=Array,LC.prototype.DefaultInterpolation=K2,LC.prototype.InterpolantFactoryMethodLinear=void 0,LC.prototype.InterpolantFactoryMethodSmooth=void 0;class ZQ extends G0{}ZQ.prototype.ValueTypeName="color";class NC extends G0{}NC.prototype.ValueTypeName="number";class y_e extends VE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,d=(i-t)/(r-t);let u=e*l;for(let f=u+l;u!==f;u+=4)zc.slerpFlat(s,0,o,u-l,o,u,d);return s}}class ex extends G0{InterpolantFactoryMethodLinear(e){return new y_e(this.times,this.values,this.getValueSize(),e)}}ex.prototype.ValueTypeName="quaternion",ex.prototype.DefaultInterpolation=Rb,ex.prototype.InterpolantFactoryMethodSmooth=void 0;class UC extends G0{}UC.prototype.ValueTypeName="string",UC.prototype.ValueBufferType=Array,UC.prototype.DefaultInterpolation=K2,UC.prototype.InterpolantFactoryMethodLinear=void 0,UC.prototype.InterpolantFactoryMethodSmooth=void 0;class zC extends G0{}zC.prototype.ValueTypeName="vector";class GE{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Am(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,l=i.length;o!==l;++o)t.push(b_e(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(G0.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let l=0;l<s;l++){let d=[],u=[];d.push((l+s-1)%s,l,(l+1)%s),u.push(0,1,0);const f=YQ(d);d=CO(d,1,f),u=CO(u,1,f),!r&&0===d[0]&&(d.push(s),u.push(u[0])),o.push(new NC(".morphTargetInfluences["+t[l].name+"]",d,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let l=0,d=e.length;l<d;l++){const u=e[l],f=u.name.match(s);if(f&&f.length>1){const g=f[1];let T=r[g];T||(r[g]=T=[]),T.push(u)}}const o=[];for(const l in r)o.push(this.CreateFromMorphTargetSequence(l,r[l],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(g,T,B,q,re){if(0!==B.length){const se=[],ne=[];MO(B,se,ne,q),0!==se.length&&re.push(new g(T,se,ne))}},r=[],s=e.name||"default",o=e.fps||30,l=e.blendMode;let d=e.length||-1;const u=e.hierarchy||[];for(let g=0;g<u.length;g++){const T=u[g].keys;if(T&&0!==T.length)if(T[0].morphTargets){const B={};let q;for(q=0;q<T.length;q++)if(T[q].morphTargets)for(let re=0;re<T[q].morphTargets.length;re++)B[T[q].morphTargets[re]]=-1;for(const re in B){const se=[],ne=[];for(let De=0;De!==T[q].morphTargets.length;++De){const Se=T[q];se.push(Se.time),ne.push(Se.morphTarget===re?1:0)}r.push(new NC(".morphTargetInfluence["+re+"]",se,ne))}d=B.length*o}else{const B=".bones["+t[g].name+"]";i(zC,B+".position",T,"pos",r),i(ex,B+".quaternion",T,"rot",r),i(zC,B+".scale",T,"scl",r)}}return 0===r.length?null:new this(s,d,r,l)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function b_e(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function v_e(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NC;case"vector":case"vector2":case"vector3":case"vector4":return zC;case"color":return ZQ;case"quaternion":return ex;case"bool":case"boolean":return LC;case"string":return UC}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];MO(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xy={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class JQ{constructor(e,t,i){const r=this;let d,s=!1,o=0,l=0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(f){l++,!1===s&&void 0!==r.onStart&&r.onStart(f,o,l),s=!0},this.itemEnd=function(f){o++,void 0!==r.onProgress&&r.onProgress(f,o,l),o===l&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(f){void 0!==r.onError&&r.onError(f)},this.resolveURL=function(f){return d?d(f):f},this.setURLModifier=function(f){return d=f,this},this.addHandler=function(f,g){return u.push(f,g),this},this.removeHandler=function(f){const g=u.indexOf(f);return-1!==g&&u.splice(g,2),this},this.getHandler=function(f){for(let g=0,T=u.length;g<T;g+=2){const B=u[g],q=u[g+1];if(B.global&&(B.lastIndex=0),B.test(f))return q}return null}}}const x_e=new JQ;let Kh=(()=>{class n{constructor(t){this.manager=void 0!==t?t:x_e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const u1={};class w_e extends Error{constructor(e,t){super(e),this.response=t}}class Sp extends Kh{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Xy.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==u1[e])return void u1[e].push({onLoad:t,onProgress:i,onError:r});u1[e]=[],u1[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,d=this.responseType;fetch(o).then(u=>{if(200===u.status||0===u.status){if(0===u.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===u.body||void 0===u.body.getReader)return u;const f=u1[e],g=u.body.getReader(),T=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),B=T?parseInt(T):0,q=0!==B;let re=0;const se=new ReadableStream({start(ne){!function De(){g.read().then(({done:Se,value:je})=>{if(Se)ne.close();else{re+=je.byteLength;const Dt=new ProgressEvent("progress",{lengthComputable:q,loaded:re,total:B});for(let Mt=0,Bt=f.length;Mt<Bt;Mt++){const Jt=f[Mt];Jt.onProgress&&Jt.onProgress(Dt)}ne.enqueue(je),De()}})}()}});return new Response(se)}throw new w_e(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(d){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(f=>(new DOMParser).parseFromString(f,l));case"json":return u.json();default:if(void 0===l)return u.text();{const g=/charset="?([^;"\s]*)"?/i.exec(l),T=g&&g[1]?g[1].toLowerCase():void 0,B=new TextDecoder(T);return u.arrayBuffer().then(q=>B.decode(q))}}}).then(u=>{Xy.add(e,u);const f=u1[e];delete u1[e];for(let g=0,T=f.length;g<T;g++){const B=f[g];B.onLoad&&B.onLoad(u)}}).catch(u=>{const f=u1[e];if(void 0===f)throw this.manager.itemError(e),u;delete u1[e];for(let g=0,T=f.length;g<T;g++){const B=f[g];B.onError&&B.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class j4 extends Kh{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xy.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const l=CE("img");function d(){f(),Xy.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(g){f(),r&&r(g),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){l.removeEventListener("load",d,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",d,!1),l.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(e),l.src=e,l}}class C_e extends Kh{constructor(e){super(e)}load(e,t,i,r){const s=new $h,o=new j4(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){s.image=l,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class tx extends Ol{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new fr(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class M_e extends tx{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ol.DEFAULT_UP),this.updateMatrix(),this.groundColor=new fr(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const SO=new fo,eW=new Rt,tW=new Rt;class EO{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ni(512,512),this.map=null,this.mapPass=null,this.matrix=new fo,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new m4,this._frameExtents=new Ni(1,1),this._viewportCount=1,this._viewports=[new nc(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;eW.setFromMatrixPosition(e.matrixWorld),t.position.copy(eW),tW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(tW),t.updateMatrixWorld(),SO.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(SO),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(SO)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class S_e extends EO{constructor(){super(new Mu(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*tC*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class nW extends tx{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ol.DEFAULT_UP),this.updateMatrix(),this.target=new Ol,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new S_e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const iW=new fo,qE=new Rt,TO=new Rt;class E_e extends EO{constructor(){super(new Mu(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ni(4,2),this._viewportCount=6,this._viewports=[new nc(2,1,1,1),new nc(0,1,1,1),new nc(3,1,1,1),new nc(1,1,1,1),new nc(3,0,1,1),new nc(1,0,1,1)],this._cubeDirections=[new Rt(1,0,0),new Rt(-1,0,0),new Rt(0,0,1),new Rt(0,0,-1),new Rt(0,1,0),new Rt(0,-1,0)],this._cubeUps=[new Rt(0,1,0),new Rt(0,1,0),new Rt(0,1,0),new Rt(0,1,0),new Rt(0,0,1),new Rt(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),qE.setFromMatrixPosition(e.matrixWorld),i.position.copy(qE),TO.copy(i.position),TO.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(TO),i.updateMatrixWorld(),r.makeTranslation(-qE.x,-qE.y,-qE.z),iW.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iW)}}class rW extends tx{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new E_e}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class T_e extends EO{constructor(){super(new bC(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class HC extends tx{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ol.DEFAULT_UP),this.updateMatrix(),this.target=new Ol,this.shadow=new T_e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class $4 extends tx{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class D_e extends tx{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class I_e{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Rt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class B_e extends tx{constructor(e=new I_e,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class DO extends Kh{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Sp(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(d){r?r(d):console.error(d),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=DO.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new fr).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=(new fr).setHex(o.value);break;case"v2":r.uniforms[s].value=(new Ni).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new Rt).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new nc).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new Ca).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new fo).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Ni).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=i(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=i(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Ni).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=i(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=i(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=i(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=i(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=i(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:d_e,SpriteMaterial:lQ,RawShaderMaterial:u_e,ShaderMaterial:Cu,PointsMaterial:c1,MeshPhysicalMaterial:V0,MeshStandardMaterial:W4,MeshPhongMaterial:_g,MeshToonMaterial:$Q,MeshNormalMaterial:h_e,MeshLambertMaterial:f_e,MeshDepthMaterial:W5,MeshDistanceMaterial:oQ,MeshBasicMaterial:yd,MeshMatcapMaterial:p_e,LineDashedMaterial:Zb,LineBasicMaterial:wc,Material:ad}[e]}}class nx{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class P_e extends Qs{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class R_e extends Kh{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Sp(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(d){r?r(d):console.error(d),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(B,q){if(void 0!==t[q])return t[q];const se=B.interleavedBuffers[q],ne=function s(B,q){if(void 0!==i[q])return i[q];const ne=new Uint32Array(B.arrayBuffers[q]).buffer;return i[q]=ne,ne}(B,se.buffer),De=nC(se.type,ne),Se=new b4(De,se.stride);return Se.uuid=se.uuid,t[q]=Se,Se}const o=e.isInstancedBufferGeometry?new P_e:new Qs,l=e.data.index;if(void 0!==l){const B=nC(l.type,l.array);o.setIndex(new To(B,1))}const d=e.data.attributes;for(const B in d){const q=d[B];let re;if(q.isInterleavedBufferAttribute){const se=r(e.data,q.data);re=new Qb(se,q.itemSize,q.offset,q.normalized)}else{const se=nC(q.type,q.array);re=new(q.isInstancedBufferAttribute?IC:To)(se,q.itemSize,q.normalized)}void 0!==q.name&&(re.name=q.name),void 0!==q.usage&&re.setUsage(q.usage),o.setAttribute(B,re)}const u=e.data.morphAttributes;if(u)for(const B in u){const q=u[B],re=[];for(let se=0,ne=q.length;se<ne;se++){const De=q[se];let Se;if(De.isInterleavedBufferAttribute){const je=r(e.data,De.data);Se=new Qb(je,De.itemSize,De.offset,De.normalized)}else{const je=nC(De.type,De.array);Se=new To(je,De.itemSize,De.normalized)}void 0!==De.name&&(Se.name=De.name),re.push(Se)}o.morphAttributes[B]=re}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const g=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==g)for(let B=0,q=g.length;B!==q;++B){const re=g[B];o.addGroup(re.start,re.count,re.materialIndex)}const T=e.data.boundingSphere;if(void 0!==T){const B=new Rt;void 0!==T.center&&B.fromArray(T.center),o.boundingSphere=new ju(B,T.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class k_e extends Kh{constructor(e){super(e)}load(e,t,i,r){const s=this,o=""===this.path?nx.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const l=new Sp(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(d){let u=null;try{u=JSON.parse(d)}catch(g){return void 0!==r&&r(g),void console.error("THREE:ObjectLoader: Can't parse "+e+".",g.message)}const f=u.metadata;if(void 0===f||void 0===f.type||"geometry"===f.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(u,t)},i,r)}loadAsync(e,t){var i=this;return(0,ve.A)(function*(){const r=i,s=""===i.path?nx.extractUrlBase(e):i.path;i.resourcePath=i.resourcePath||s;const o=new Sp(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials);const l=yield o.loadAsync(e,t),d=JSON.parse(l),u=d.metadata;if(void 0===u||void 0===u.type||"geometry"===u.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(d)})()}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(u)}),l=this.parseTextures(e.textures,o),d=this.parseMaterials(e.materials,l),u=this.parseObject(e.object,s,d,l,i),f=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,f),void 0!==t){let g=!1;for(const T in o)if(o[T].data instanceof HTMLImageElement){g=!0;break}!1===g&&t(u)}return u}parseAsync(e){var t=this;return(0,ve.A)(function*(){const i=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),l=t.parseTextures(e.textures,o),d=t.parseMaterials(e.materials,l),u=t.parseObject(e.object,s,d,l,i),f=t.parseSkeletons(e.skeletons,u);return t.bindSkeletons(u,f),u})()}parseShapes(e){const t={};if(void 0!==e)for(let i=0,r=e.length;i<r;i++){const s=(new FC).fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const l=(new E4).fromJSON(e[s],r);i[l.uuid]=l}return i}parseGeometries(e,t){const i={};if(void 0!==e){const r=new R_e;for(let s=0,o=e.length;s<o;s++){let l;const d=e[s];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":l=r.parse(d);break;default:d.type in jQ?l=jQ[d.type].fromJSON(d,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}l.uuid=d.uuid,void 0!==d.name&&(l.name=d.name),void 0!==d.userData&&(l.userData=d.userData),i[d.uuid]=l}}return i}parseMaterials(e,t){const i={},r={};if(void 0!==e){const s=new DO;s.setTextures(t);for(let o=0,l=e.length;o<l;o++){const d=e[o];void 0===i[d.uuid]&&(i[d.uuid]=s.parse(d)),r[d.uuid]=i[d.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let i=0;i<e.length;i++){const s=GE.parse(e[i]);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function l(d){if("string"==typeof d){const u=d;return function o(d){return i.manager.itemStart(d),s.load(d,function(){i.manager.itemEnd(d)},void 0,function(){i.manager.itemError(d),i.manager.itemEnd(d)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u)}return d.data?{data:nC(d.type,d.data),width:d.width,height:d.height}:null}if(void 0!==e&&e.length>0){const d=new JQ(t);s=new j4(d),s.setCrossOrigin(this.crossOrigin);for(let u=0,f=e.length;u<f;u++){const g=e[u],T=g.url;if(Array.isArray(T)){const B=[];for(let q=0,re=T.length;q<re;q++){const ne=l(T[q]);null!==ne&&(ne instanceof HTMLImageElement?B.push(ne):B.push(new Wb(ne.data,ne.width,ne.height)))}r[g.uuid]=new Ob(B)}else{const B=l(g.url);r[g.uuid]=new Ob(B)}}}return r}parseImagesAsync(e){var t=this;return(0,ve.A)(function*(){const i=t,r={};let s;function o(d){return l.apply(this,arguments)}function l(){return(l=(0,ve.A)(function*(d){if("string"==typeof d){const u=d,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return yield s.loadAsync(f)}return d.data?{data:nC(d.type,d.data),width:d.width,height:d.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new j4(t.manager),s.setCrossOrigin(t.crossOrigin);for(let d=0,u=e.length;d<u;d++){const f=e[d],g=f.url;if(Array.isArray(g)){const T=[];for(let B=0,q=g.length;B<q;B++){const re=g[B],se=yield o(re);null!==se&&(se instanceof HTMLImageElement?T.push(se):T.push(new Wb(se.data,se.width,se.height)))}r[f.uuid]=new Ob(T)}else{const T=yield o(f.url);r[f.uuid]=new Ob(T)}}}return r})()}parseTextures(e,t){function i(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const l=e[s];void 0===l.image&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),void 0===t[l.image]&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const d=t[l.image],u=d.data;let f;Array.isArray(u)?(f=new f4,6===u.length&&(f.needsUpdate=!0)):(f=u&&u.data?new Wb:new $h,u&&(f.needsUpdate=!0)),f.source=d,f.uuid=l.uuid,void 0!==l.name&&(f.name=l.name),void 0!==l.mapping&&(f.mapping=i(l.mapping,F_e)),void 0!==l.channel&&(f.channel=l.channel),void 0!==l.offset&&f.offset.fromArray(l.offset),void 0!==l.repeat&&f.repeat.fromArray(l.repeat),void 0!==l.center&&f.center.fromArray(l.center),void 0!==l.rotation&&(f.rotation=l.rotation),void 0!==l.wrap&&(f.wrapS=i(l.wrap[0],sW),f.wrapT=i(l.wrap[1],sW)),void 0!==l.format&&(f.format=l.format),void 0!==l.internalFormat&&(f.internalFormat=l.internalFormat),void 0!==l.type&&(f.type=l.type),void 0!==l.colorSpace&&(f.colorSpace=l.colorSpace),void 0!==l.minFilter&&(f.minFilter=i(l.minFilter,oW)),void 0!==l.magFilter&&(f.magFilter=i(l.magFilter,oW)),void 0!==l.anisotropy&&(f.anisotropy=l.anisotropy),void 0!==l.flipY&&(f.flipY=l.flipY),void 0!==l.generateMipmaps&&(f.generateMipmaps=l.generateMipmaps),void 0!==l.premultiplyAlpha&&(f.premultiplyAlpha=l.premultiplyAlpha),void 0!==l.unpackAlignment&&(f.unpackAlignment=l.unpackAlignment),void 0!==l.compareFunction&&(f.compareFunction=l.compareFunction),void 0!==l.userData&&(f.userData=l.userData),r[l.uuid]=f}return r}parseObject(e,t,i,r,s){let o,f,g;function l(T){return void 0===t[T]&&console.warn("THREE.ObjectLoader: Undefined geometry",T),t[T]}function d(T){if(void 0!==T){if(Array.isArray(T)){const B=[];for(let q=0,re=T.length;q<re;q++){const se=T[q];void 0===i[se]&&console.warn("THREE.ObjectLoader: Undefined material",se),B.push(i[se])}return B}return void 0===i[T]&&console.warn("THREE.ObjectLoader: Undefined material",T),i[T]}}function u(T){return void 0===r[T]&&console.warn("THREE.ObjectLoader: Undefined texture",T),r[T]}switch(e.type){case"Scene":o=new IE,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new fr(e.background):u(e.background)),void 0!==e.environment&&(o.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new X5(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new $5(e.fog.color,e.fog.density)),""!==e.fog.name&&(o.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(o.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&o.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentRotation&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Mu(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new bC(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new $4(e.color,e.intensity);break;case"DirectionalLight":o=new HC(e.color,e.intensity);break;case"PointLight":o=new rW(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new D_e(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new nW(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new M_e(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new B_e).fromJSON(e);break;case"SkinnedMesh":f=l(e.geometry),g=d(e.material),o=new _Q(f,g),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":f=l(e.geometry),g=d(e.material),o=new Yo(f,g);break;case"InstancedMesh":f=l(e.geometry),g=d(e.material);const B=e.instanceMatrix,q=e.instanceColor;o=new xQ(f,g,e.count),o.instanceMatrix=new IC(new Float32Array(B.array),16),void 0!==q&&(o.instanceColor=new IC(new Float32Array(q.array),q.itemSize));break;case"BatchedMesh":f=l(e.geometry),g=d(e.material),o=new B0e(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,g),o.geometry=f,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(re=>{const se=new Nf;se.min.fromArray(re.boxMin),se.max.fromArray(re.boxMax);const ne=new ju;return ne.radius=re.sphereRadius,ne.center.fromArray(re.sphereCenter),{boxInitialized:re.boxInitialized,box:se,sphereInitialized:re.sphereInitialized,sphere:ne}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=u(e.matricesTexture.uuid);break;case"LOD":o=new x0e;break;case"Line":o=new gg(l(e.geometry),d(e.material));break;case"LineLoop":o=new IQ(l(e.geometry),d(e.material));break;case"LineSegments":o=new hc(l(e.geometry),d(e.material));break;case"PointCloud":case"Points":o=new $b(l(e.geometry),d(e.material));break;case"Sprite":o=new b0e(d(e.material));break;case"Group":o=new $l;break;case"Bone":o=new J5;break;default:o=new Ol}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.up&&o.up.fromArray(e.up),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const T=e.children;for(let B=0;B<T.length;B++)o.add(this.parseObject(T[B],t,i,r,s))}if(void 0!==e.animations){const T=e.animations;for(let B=0;B<T.length;B++)o.animations.push(s[T[B]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const T=e.levels;for(let B=0;B<T.length;B++){const q=T[B],re=o.getObjectByProperty("uuid",q.object);void 0!==re&&o.addLevel(re,q.distance,q.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(i){if(!0===i.isSkinnedMesh&&void 0!==i.skeleton){const r=t[i.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const F_e={UVMapping:300,CubeReflectionMapping:Oy,CubeRefractionMapping:Ib,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:vE},sW={RepeatWrapping:Ly,ClampToEdgeWrapping:bh,MirroredRepeatWrapping:$2},oW={NearestFilter:gd,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:Ny,LinearFilter:Nc,LinearMipmapNearestFilter:X2,LinearMipmapLinearFilter:fA};class O_e extends Kh{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xy.get(e);if(void 0!==o)return s.manager.itemStart(e),o.then?void o.then(u=>{t&&t(u),s.manager.itemEnd(e)}).catch(u=>{r&&r(u)}):(setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o);const l={};l.credentials="anonymous"===this.crossOrigin?"same-origin":"include",l.headers=this.requestHeader;const d=fetch(e,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return Xy.add(e,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){r&&r(u),Xy.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Xy.add(e,d),s.manager.itemStart(e)}}class dW{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=uW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=uW();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function uW(){return(typeof performance>"u"?Date:performance).now()}const IO="\\[\\]\\.:\\/",H_e=new RegExp("["+IO+"]","g"),BO="[^"+IO+"]",V_e="[^"+IO.replace("\\.","")+"]",j_e=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",BO)+/(WCOD+)?/.source.replace("WCOD",V_e)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",BO)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",BO)+"$"),$_e=["material","materials","bones","map"];class X_e{constructor(e,t,i){const r=i||Vl.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Vl=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(H_e,"")}static parseTrackName(t){const i=j_e.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==$_e.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let l=0;l<o.length;l++){const d=o[l];if(d.name===i||d.uuid===i)return d;const u=r(d.children);if(u)return u}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let f=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let g=0;g<t.length;g++)if(t[g].name===f){f=g;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==f){if(void 0===t[f])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[f]}}const l=t[s];if(void 0===l)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let d=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?d=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(d=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}u=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=o}else void 0!==l.fromArray&&void 0!==l.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(u=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][d]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=X_e,n})();Vl.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Vl.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Vl.prototype.GetterByBindingType=[Vl.prototype._getValue_direct,Vl.prototype._getValue_array,Vl.prototype._getValue_arrayElement,Vl.prototype._getValue_toArray],Vl.prototype.SetterByBindingTypeAndVersioning=[[Vl.prototype._setValue_direct,Vl.prototype._setValue_direct_setNeedsUpdate,Vl.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Vl.prototype._setValue_array,Vl.prototype._setValue_array_setNeedsUpdate,Vl.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Vl.prototype._setValue_arrayElement,Vl.prototype._setValue_arrayElement_setNeedsUpdate,Vl.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Vl.prototype._setValue_fromArray,Vl.prototype._setValue_fromArray_setNeedsUpdate,Vl.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class PO{constructor(e){this.value=e}clone(){return new PO(void 0===this.value.clone?this.value:this.value.clone())}}const pW=new fo;class mW{constructor(e,t,i=0,r=1/0){this.ray=new lC(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new S5,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return pW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(pW),this}intersectObject(e,t=!0,i=[]){return RO(e,this,i,t),i.sort(AW),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)RO(e[r],this,i,t);return i.sort(AW),i}}function AW(n,e){return n.distance-e.distance}function RO(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)RO(r[s],e,t,!0)}}class gW{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(_d(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const yW=new Rt,Y4=new Rt;class EW extends hc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Qs;r.setAttribute("position",new ks(t,3)),r.setAttribute("color",new ks([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new wc({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new fr,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class t1e{constructor(){this.type="ShapePath",this.color=new fr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new O4,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(ne,De){const Se=De.length;let je=!1;for(let Dt=Se-1,Mt=0;Mt<Se;Dt=Mt++){let Bt=De[Dt],Jt=De[Mt],Vn=Jt.x-Bt.x,Tt=Jt.y-Bt.y;if(Math.abs(Tt)>Number.EPSILON){if(Tt<0&&(Bt=De[Mt],Vn=-Vn,Jt=De[Dt],Tt=-Tt),ne.y<Bt.y||ne.y>Jt.y)continue;if(ne.y===Bt.y){if(ne.x===Bt.x)return!0}else{const tn=Tt*(ne.x-Bt.x)-Vn*(ne.y-Bt.y);if(0===tn)return!0;if(tn<0)continue;je=!je}}else{if(ne.y!==Bt.y)continue;if(Jt.x<=ne.x&&ne.x<=Bt.x||Bt.x<=ne.x&&ne.x<=Jt.x)return!0}}return je}const r=d1.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,l,d;const u=[];if(1===s.length)return l=s[0],d=new FC,d.curves=l.curves,u.push(d),u;let f=!r(s[0].getPoints());f=e?!f:f;const g=[],T=[];let re,se,B=[],q=0;T[q]=void 0,B[q]=[];for(let ne=0,De=s.length;ne<De;ne++)l=s[ne],re=l.getPoints(),o=r(re),o=e?!o:o,o?(!f&&T[q]&&q++,T[q]={s:new FC,p:re},T[q].s.curves=l.curves,f&&q++,B[q]=[]):B[q].push({h:l,p:re[0]});if(!T[0])return function t(ne){const De=[];for(let Se=0,je=ne.length;Se<je;Se++){const Dt=ne[Se],Mt=new FC;Mt.curves=Dt.curves,De.push(Mt)}return De}(s);if(T.length>1){let ne=!1,De=0;for(let Se=0,je=T.length;Se<je;Se++)g[Se]=[];for(let Se=0,je=T.length;Se<je;Se++){const Dt=B[Se];for(let Mt=0;Mt<Dt.length;Mt++){const Bt=Dt[Mt];let Jt=!0;for(let Vn=0;Vn<T.length;Vn++)i(Bt.p,T[Vn].p)&&(Se!==Vn&&De++,Jt?(Jt=!1,g[Vn].push(Bt)):ne=!0);Jt&&g[Se].push(Bt)}}De>0&&!1===ne&&(B=g)}for(let ne=0,De=T.length;ne<De;ne++){d=T[ne].s,u.push(d),se=B[ne];for(let Se=0,je=se.length;Se<je;Se++)d.holes.push(se[Se].h)}return u}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Q2}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Q2);var n1e=Ee(7239),i1e=Ee.n(n1e);const TW={type:"change"},OO={type:"start"},DW={type:"end"},nB=new lC,IW=new gA,r1e=Math.cos(70*wE.DEG2RAD);class s1e extends t1{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Rt,this.cursor=new Rt,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Ln){Ln.addEventListener("keydown",Ro),this._domElementKeyEvents=Ln},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Ro),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(TW),i.update(),s=r.NONE},this.update=function(){const Ln=new Rt,Ar=(new zc).setFromUnitVectors(e.up,new Rt(0,1,0)),ro=Ar.clone().invert(),Jn=new Rt,Vr=new zc,Ei=new Rt,Nr=2*Math.PI;return function(Ka=null){const Xl=i.object.position;Ln.copy(Xl).sub(i.target),Ln.applyQuaternion(Ar),l.setFromVector3(Ln),i.autoRotate&&s===r.NONE&&Fi(function Tt(Ln){return null!==Ln?2*Math.PI/60*i.autoRotateSpeed*Ln:2*Math.PI/60/60*i.autoRotateSpeed}(Ka)),i.enableDamping?(l.theta+=d.theta*i.dampingFactor,l.phi+=d.phi*i.dampingFactor):(l.theta+=d.theta,l.phi+=d.phi);let pc=i.minAzimuthAngle,Cd=i.maxAzimuthAngle;isFinite(pc)&&isFinite(Cd)&&(pc<-Math.PI?pc+=Nr:pc>Math.PI&&(pc-=Nr),Cd<-Math.PI?Cd+=Nr:Cd>Math.PI&&(Cd-=Nr),l.theta=pc<=Cd?Math.max(pc,Math.min(Cd,l.theta)):l.theta>(pc+Cd)/2?Math.max(pc,l.theta):Math.min(Cd,l.theta)),l.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,l.phi)),l.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor);let Dl=!1;if(i.zoomToCursor&&Mt||i.object.isOrthographicCamera)l.radius=sr(l.radius);else{const Hc=l.radius;l.radius=sr(l.radius*u),Dl=Hc!=l.radius}if(Ln.setFromSpherical(l),Ln.applyQuaternion(ro),Xl.copy(i.target).add(Ln),i.object.lookAt(i.target),!0===i.enableDamping?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),f.set(0,0,0)),i.zoomToCursor&&Mt){let Hc=null;if(i.object.isPerspectiveCamera){const Zh=Ln.length();Hc=sr(Zh*u);const Bx=Zh-Hc;i.object.position.addScaledVector(je,Bx),i.object.updateMatrixWorld(),Dl=!!Bx}else if(i.object.isOrthographicCamera){const Zh=new Rt(Dt.x,Dt.y,0);Zh.unproject(i.object);const Bx=i.object.zoom;i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/u)),i.object.updateProjectionMatrix(),Dl=Bx!==i.object.zoom;const FB=new Rt(Dt.x,Dt.y,0);FB.unproject(i.object),i.object.position.sub(FB).add(Zh),i.object.updateMatrixWorld(),Hc=Ln.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==Hc&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Hc).add(i.object.position):(nB.origin.copy(i.object.position),nB.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(nB.direction))<r1e?e.lookAt(i.target):(IW.setFromNormalAndCoplanarPoint(i.object.up,i.target),nB.intersectPlane(IW,i.target))))}else if(i.object.isOrthographicCamera){const Hc=i.object.zoom;i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/u)),Hc!==i.object.zoom&&(i.object.updateProjectionMatrix(),Dl=!0)}return u=1,Mt=!1,!!(Dl||Jn.distanceToSquared(i.object.position)>o||8*(1-Vr.dot(i.object.quaternion))>o||Ei.distanceToSquared(i.target)>o)&&(i.dispatchEvent(TW),Jn.copy(i.object.position),Vr.copy(i.object.quaternion),Ei.copy(i.target),!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",oa),i.domElement.removeEventListener("pointerdown",Zs),i.domElement.removeEventListener("pointercancel",Mn),i.domElement.removeEventListener("wheel",er),i.domElement.removeEventListener("pointermove",Ba),i.domElement.removeEventListener("pointerup",Mn),i.domElement.getRootNode().removeEventListener("keydown",Mr,{capture:!0}),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",Ro),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,l=new gW,d=new gW;let u=1;const f=new Rt,g=new Ni,T=new Ni,B=new Ni,q=new Ni,re=new Ni,se=new Ni,ne=new Ni,De=new Ni,Se=new Ni,je=new Rt,Dt=new Ni;let Mt=!1;const Bt=[],Jt={};let Vn=!1;function tn(Ln){const Ar=Math.abs(.01*Ln);return Math.pow(.95,i.zoomSpeed*Ar)}function Fi(Ln){d.theta-=Ln}function Vi(Ln){d.phi-=Ln}const On=function(){const Ln=new Rt;return function(ro,Jn){Ln.setFromMatrixColumn(Jn,0),Ln.multiplyScalar(-ro),f.add(Ln)}}(),yi=function(){const Ln=new Rt;return function(ro,Jn){!0===i.screenSpacePanning?Ln.setFromMatrixColumn(Jn,1):(Ln.setFromMatrixColumn(Jn,0),Ln.crossVectors(i.object.up,Ln)),Ln.multiplyScalar(ro),f.add(Ln)}}(),Gn=function(){const Ln=new Rt;return function(ro,Jn){const Vr=i.domElement;if(i.object.isPerspectiveCamera){Ln.copy(i.object.position).sub(i.target);let Nr=Ln.length();Nr*=Math.tan(i.object.fov/2*Math.PI/180),On(2*ro*Nr/Vr.clientHeight,i.object.matrix),yi(2*Jn*Nr/Vr.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(On(ro*(i.object.right-i.object.left)/i.object.zoom/Vr.clientWidth,i.object.matrix),yi(Jn*(i.object.top-i.object.bottom)/i.object.zoom/Vr.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function ri(Ln){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?u/=Ln:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function di(Ln){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?u*=Ln:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function _i(Ln,Ar){if(!i.zoomToCursor)return;Mt=!0;const ro=i.domElement.getBoundingClientRect(),Vr=Ar-ro.top,Nr=ro.height;Dt.x=(Ln-ro.left)/ro.width*2-1,Dt.y=-Vr/Nr*2+1,je.set(Dt.x,Dt.y,1).unproject(i.object).sub(i.object.position).normalize()}function sr(Ln){return Math.max(i.minDistance,Math.min(i.maxDistance,Ln))}function pr(Ln){g.set(Ln.clientX,Ln.clientY)}function Ns(Ln){q.set(Ln.clientX,Ln.clientY)}function cs(Ln){if(1===Bt.length)g.set(Ln.pageX,Ln.pageY);else{const Ar=Js(Ln);g.set(.5*(Ln.pageX+Ar.x),.5*(Ln.pageY+Ar.y))}}function po(Ln){if(1===Bt.length)q.set(Ln.pageX,Ln.pageY);else{const Ar=Js(Ln);q.set(.5*(Ln.pageX+Ar.x),.5*(Ln.pageY+Ar.y))}}function Xs(Ln){const Ar=Js(Ln),ro=Ln.pageX-Ar.x,Jn=Ln.pageY-Ar.y,Vr=Math.sqrt(ro*ro+Jn*Jn);ne.set(0,Vr)}function ar(Ln){if(1==Bt.length)T.set(Ln.pageX,Ln.pageY);else{const ro=Js(Ln);T.set(.5*(Ln.pageX+ro.x),.5*(Ln.pageY+ro.y))}B.subVectors(T,g).multiplyScalar(i.rotateSpeed);const Ar=i.domElement;Fi(2*Math.PI*B.x/Ar.clientHeight),Vi(2*Math.PI*B.y/Ar.clientHeight),g.copy(T)}function jr(Ln){if(1===Bt.length)re.set(Ln.pageX,Ln.pageY);else{const Ar=Js(Ln);re.set(.5*(Ln.pageX+Ar.x),.5*(Ln.pageY+Ar.y))}se.subVectors(re,q).multiplyScalar(i.panSpeed),Gn(se.x,se.y),q.copy(re)}function gr(Ln){const Ar=Js(Ln),ro=Ln.pageX-Ar.x,Jn=Ln.pageY-Ar.y,Vr=Math.sqrt(ro*ro+Jn*Jn);De.set(0,Vr),Se.set(0,Math.pow(De.y/ne.y,i.zoomSpeed)),ri(Se.y),ne.copy(De),_i(.5*(Ln.pageX+Ar.x),.5*(Ln.pageY+Ar.y))}function Zs(Ln){!1!==i.enabled&&(0===Bt.length&&(i.domElement.setPointerCapture(Ln.pointerId),i.domElement.addEventListener("pointermove",Ba),i.domElement.addEventListener("pointerup",Mn)),!function Qa(Ln){for(let Ar=0;Ar<Bt.length;Ar++)if(Bt[Ar]==Ln.pointerId)return!0;return!1}(Ln)&&(function Kr(Ln){Bt.push(Ln.pointerId)}(Ln),"touch"===Ln.pointerType?rs(Ln):function qt(Ln){let Ar;switch(Ln.button){case 0:Ar=i.mouseButtons.LEFT;break;case 1:Ar=i.mouseButtons.MIDDLE;break;case 2:Ar=i.mouseButtons.RIGHT;break;default:Ar=-1}switch(Ar){case 1:if(!1===i.enableZoom)return;(function Hr(Ln){_i(Ln.clientX,Ln.clientX),ne.set(Ln.clientX,Ln.clientY)})(Ln),s=r.DOLLY;break;case 0:if(Ln.ctrlKey||Ln.metaKey||Ln.shiftKey){if(!1===i.enablePan)return;Ns(Ln),s=r.PAN}else{if(!1===i.enableRotate)return;pr(Ln),s=r.ROTATE}break;case 2:if(Ln.ctrlKey||Ln.metaKey||Ln.shiftKey){if(!1===i.enableRotate)return;pr(Ln),s=r.ROTATE}else{if(!1===i.enablePan)return;Ns(Ln),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(OO)}(Ln)))}function Ba(Ln){!1!==i.enabled&&("touch"===Ln.pointerType?function As(Ln){switch(Mo(Ln),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;ar(Ln),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;jr(Ln),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Hs(Ln){i.enableZoom&&gr(Ln),i.enablePan&&jr(Ln)})(Ln),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Is(Ln){i.enableZoom&&gr(Ln),i.enableRotate&&ar(Ln)})(Ln),i.update();break;default:s=r.NONE}}(Ln):function $i(Ln){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function ui(Ln){T.set(Ln.clientX,Ln.clientY),B.subVectors(T,g).multiplyScalar(i.rotateSpeed);const Ar=i.domElement;Fi(2*Math.PI*B.x/Ar.clientHeight),Vi(2*Math.PI*B.y/Ar.clientHeight),g.copy(T),i.update()}(Ln);break;case r.DOLLY:if(!1===i.enableZoom)return;!function xr(Ln){De.set(Ln.clientX,Ln.clientY),Se.subVectors(De,ne),Se.y>0?ri(tn(Se.y)):Se.y<0&&di(tn(Se.y)),ne.copy(De),i.update()}(Ln);break;case r.PAN:if(!1===i.enablePan)return;!function is(Ln){re.set(Ln.clientX,Ln.clientY),se.subVectors(re,q).multiplyScalar(i.panSpeed),Gn(se.x,se.y),q.copy(re),i.update()}(Ln)}}(Ln))}function Mn(Ln){switch(function wd(Ln){delete Jt[Ln.pointerId];for(let Ar=0;Ar<Bt.length;Ar++)if(Bt[Ar]==Ln.pointerId)return void Bt.splice(Ar,1)}(Ln),Bt.length){case 0:i.domElement.releasePointerCapture(Ln.pointerId),i.domElement.removeEventListener("pointermove",Ba),i.domElement.removeEventListener("pointerup",Mn),i.dispatchEvent(DW),s=r.NONE;break;case 1:const Ar=Bt[0],ro=Jt[Ar];rs({pointerId:Ar,pageX:ro.x,pageY:ro.y})}}function er(Ln){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(Ln.preventDefault(),i.dispatchEvent(OO),function _s(Ln){_i(Ln.clientX,Ln.clientY),Ln.deltaY<0?di(tn(Ln.deltaY)):Ln.deltaY>0&&ri(tn(Ln.deltaY)),i.update()}(function Lr(Ln){const ro={clientX:Ln.clientX,clientY:Ln.clientY,deltaY:Ln.deltaY};switch(Ln.deltaMode){case 1:ro.deltaY*=16;break;case 2:ro.deltaY*=100}return Ln.ctrlKey&&!Vn&&(ro.deltaY*=10),ro}(Ln)),i.dispatchEvent(DW))}function Mr(Ln){"Control"===Ln.key&&(Vn=!0,i.domElement.getRootNode().addEventListener("keyup",sa,{passive:!0,capture:!0}))}function sa(Ln){"Control"===Ln.key&&(Vn=!1,i.domElement.getRootNode().removeEventListener("keyup",sa,{passive:!0,capture:!0}))}function Ro(Ln){!1===i.enabled||!1===i.enablePan||function ws(Ln){let Ar=!1;switch(Ln.code){case i.keys.UP:Ln.ctrlKey||Ln.metaKey||Ln.shiftKey?Vi(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Gn(0,i.keyPanSpeed),Ar=!0;break;case i.keys.BOTTOM:Ln.ctrlKey||Ln.metaKey||Ln.shiftKey?Vi(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Gn(0,-i.keyPanSpeed),Ar=!0;break;case i.keys.LEFT:Ln.ctrlKey||Ln.metaKey||Ln.shiftKey?Fi(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Gn(i.keyPanSpeed,0),Ar=!0;break;case i.keys.RIGHT:Ln.ctrlKey||Ln.metaKey||Ln.shiftKey?Fi(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Gn(-i.keyPanSpeed,0),Ar=!0}Ar&&(Ln.preventDefault(),i.update())}(Ln)}function rs(Ln){switch(Mo(Ln),Bt.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;cs(Ln),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;po(Ln),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function zn(Ln){i.enableZoom&&Xs(Ln),i.enablePan&&po(Ln)})(Ln),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function es(Ln){i.enableZoom&&Xs(Ln),i.enableRotate&&cs(Ln)})(Ln),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(OO)}function oa(Ln){!1!==i.enabled&&Ln.preventDefault()}function Mo(Ln){let Ar=Jt[Ln.pointerId];void 0===Ar&&(Ar=new Ni,Jt[Ln.pointerId]=Ar),Ar.set(Ln.pageX,Ln.pageY)}function Js(Ln){return Jt[Ln.pointerId===Bt[0]?Bt[1]:Bt[0]]}i.domElement.addEventListener("contextmenu",oa),i.domElement.addEventListener("pointerdown",Zs),i.domElement.addEventListener("pointercancel",Mn),i.domElement.addEventListener("wheel",er,{passive:!1}),i.domElement.getRootNode().addEventListener("keydown",Mr,{passive:!0,capture:!0}),this.update()}}class o1e{constructor(e,t=[0,0,200]){var i;this.controls=[],this.mainControls=null,this.overlayControls=null;const r=null===(i=e.getMainRenderer())||void 0===i?void 0:i.domElement,s=new Mu(75,r.offsetWidth/r.offsetHeight,10,1e5),o=new bC(r.offsetWidth/-2,r.offsetWidth/2,r.offsetHeight/2,r.offsetHeight/-2,10,1e5);this.perspectiveControls=this.setOrbitControls(s,r),this.orthographicControls=this.setOrbitControls(o,r),s.position.z=o.position.z=t[2],s.position.y=o.position.y=t[1],s.position.x=o.position.x=t[0],t.length>=6&&(this.perspectiveControls.target=this.orthographicControls.target=new Rt(t[3],t[4],t[5])),this.addControls(this.perspectiveControls),this.addControls(this.orthographicControls),this.setActiveControls(this.perspectiveControls),this.setMainControls(this.perspectiveControls),this.setOverlayControls(this.orthographicControls),this.getActiveControls().addEventListener("change",()=>{this.transformSync(),this.updateSync()}),this.initializeZoomControls(),this.setupResize(r)}setOrbitControls(e,t){const i=new s1e(e,t);return i.enableDamping=!0,i.dampingFactor=.25,i.enableZoom=!0,i.autoRotate=!1,i}setActiveControls(e){this.activeControls=e}setMainControls(e){this.mainControls=e}setOverlayControls(e){this.overlayControls=e}getActiveControls(){return this.activeControls}getMainControls(){return this.mainControls}getOverlayControls(){return this.overlayControls}getActiveCamera(){return this.activeControls.object}getMainCamera(){return this.mainControls.object}getOverlayCamera(){return this.overlayControls.object}getAllCameras(){return[this.getMainCamera(),this.getOverlayCamera()]}addControls(e){this.containsObject(e,this.controls)||this.controls.push(e)}removeControls(e){const t=this.controls.indexOf(e);t>-1&&this.controls.splice(t,1)}swapControls(){const e=this.mainControls;this.mainControls=this.overlayControls,this.overlayControls=e}updateSync(){for(const e of this.controls)e!==this.activeControls&&this.update(e)}update(e){e.update()}transformSync(){for(const e of this.controls)e!==this.activeControls&&(this.positionSync(e),this.rotationSync(e))}zoomTo(e,t){for(const i of this.zoomCameraAnimPairs){const r=i.camera,s=i.anim;if(r.isOrthographicCamera)s.to({zoom:r.zoom*(1/e)},t),r.updateProjectionMatrix();else{const o=r.position;s.to({x:o.x*e,y:o.y*e,z:o.z*e},t)}s.start()}}lookAtObject(e,t,i=0){new Rt(0,0,0);const s=this.getObjectPosition(e,t);if(s)for(const o of this.getAllCameras())new Of(o.position).to({x:1.1*s.x+i,y:1.1*s.y+i,z:1.1*s.z+i},200).start()}getObjectPosition(e,t){var i,r;const s=t.getObjectByProperty("uuid",e);if(s){const o=new Rt(0,0,0);let l=new Rt;return s instanceof $l?s.traverse(d=>{var u,f;if(0===d.children.length)if(d.position.equals(o)){if(null!==(u=d.geometry)&&void 0!==u&&u.boundingSphere)try{l.add(d.geometry.boundingSphere.getBoundingBox().max)}catch{l.add(null===(f=d.geometry.boundingSphere)||void 0===f?void 0:f.center)}}else l.add(d.position)}):l=s.position.equals(o)?null===(r=null===(i=s.geometry)||void 0===i?void 0:i.boundingSphere)||void 0===r?void 0:r.center:s.position,l}}hideTubeTracksOnZoom(e,t){let i=!1;const r=new Rt;this.activeControls.addEventListener("change",s=>{var o,l,d,u;const f=(null===(l=null===(o=s?.target)||void 0===o?void 0:o.object)||void 0===l?void 0:l.position).distanceTo(r)<t;f&&!i?(null===(d=e.getObjectByName("Tracks"))||void 0===d||d.traverse(g=>{"Track"===g.name&&g.geometry instanceof Kb&&(g.visible=!1)}),i=!0):!f&&i&&(null===(u=e.getObjectByName("Tracks"))||void 0===u||u.traverse(g=>{"Track"===g.name&&g.geometry instanceof Kb&&(g.visible=!0)}),i=!1)})}initializeZoomControls(){const e=this.getAllCameras();this.zoomCameraAnimPairs=[];for(const t of e){const i=new Of(t.isOrthographicCamera?t:t.position);this.zoomCameraAnimPairs.push({camera:t,anim:i})}}positionSync(e){e.object.position.set(this.activeControls.object.position.x,this.activeControls.object.position.y,this.activeControls.object.position.z)}rotationSync(e){e.target=this.activeControls.target}containsObject(e,t){for(const i of t)if(i===e)return!0;return!1}setupResize(e){window.addEventListener("resize",()=>{let t=this.getMainCamera();t.isOrthographicCamera?(t.left=e.offsetWidth/-2,t.right=e.offsetWidth/2,t.top=e.offsetHeight/2,t.bottom=e.offsetHeight/-2,t.updateProjectionMatrix()):(t.aspect=e.offsetWidth/e.offsetHeight,t.updateProjectionMatrix())})}objectIndex(e,t){for(let i=0;i<t.length;i++)if(t[i]===e)return i;return-1}}class a1e{constructor(){this.mainRenderer=null,this.overlayRenderer=null,this.renderers=[];const e=new v4({antialias:!0,alpha:!0,powerPreference:"high-performance"});this.addRenderer(e),this.setMainRenderer(e)}init(e="eventDisplay"){this.getMainRenderer().setAnimationLoop(null),this.initRenderer(e)}render(e,t){if(this.getOverlayRenderer()&&!this.getOverlayRenderer().domElement.hidden){const i=e.background;e.background=null,this.isFixedOverlay()||this.getOverlayRenderer().render(e,t),e.background=i}}initRenderer(e){let t=document.getElementById(e);t||(t=document.body);const i=()=>t.offsetWidth>0?t.offsetWidth:window.innerWidth,r=()=>t.offsetHeight>0?t.offsetHeight:window.innerHeight,s=this.getMainRenderer();s.setSize(i(),r(),!1),s.setPixelRatio(window.devicePixelRatio),s.domElement.id="three-canvas",t.appendChild(this.getMainRenderer().domElement),window.addEventListener("resize",()=>{s.setSize(i(),r())})}setMainRenderer(e){this.mainRenderer=e}setOverlayRenderer(e){const t=new v4({canvas:e,antialias:!1,alpha:!0});this.addRenderer(t),this.overlayRenderer=t}setRenderers(e){this.renderers=e}getMainRenderer(){return this.mainRenderer}getOverlayRenderer(){return this.overlayRenderer}getRenderers(){return this.renderers}addRenderer(e){this.containsObject(e,this.renderers)||this.renderers.push(e)}removeControls(e){const t=this.renderers.indexOf(e);t>-1&&this.renderers.splice(t,1)}swapRenderers(e,t){const i=e;e=t,t=i}containsObject(e,t){for(const i of t)if(i===e)return!0;return!1}setLocalClippingEnabled(e){for(const t of this.renderers)t.localClippingEnabled=e}getLocalClipping(){if(this.renderers.length>0)return this.renderers[0].localClippingEnabled}isFixedOverlay(){return this.fixedOverlay}setFixOverlay(e){this.fixedOverlay=e}}class l1e{parse(e){let t="",i=0,r=0,s=0;const o=new Rt,l=new fr,d=new Rt,u=new Ni,f=[];return e.traverse(function(q){!0===q.isMesh&&function g(q){let re=0,se=0,ne=0;const De=q.geometry,Se=new Ca,je=De.getAttribute("position"),Dt=De.getAttribute("normal"),Mt=De.getAttribute("uv"),Bt=De.getIndex();if(t+="o "+q.name+"\n",q.material&&q.material.name&&(t+="usemtl "+q.material.name+"\n"),void 0!==je)for(let Jt=0,Vn=je.count;Jt<Vn;Jt++,re++)o.fromBufferAttribute(je,Jt),o.applyMatrix4(q.matrixWorld),t+="v "+o.x+" "+o.y+" "+o.z+"\n";if(void 0!==Mt)for(let Jt=0,Vn=Mt.count;Jt<Vn;Jt++,ne++)u.fromBufferAttribute(Mt,Jt),t+="vt "+u.x+" "+u.y+"\n";if(void 0!==Dt){Se.getNormalMatrix(q.matrixWorld);for(let Jt=0,Vn=Dt.count;Jt<Vn;Jt++,se++)d.fromBufferAttribute(Dt,Jt),d.applyMatrix3(Se).normalize(),t+="vn "+d.x+" "+d.y+" "+d.z+"\n"}if(null!==Bt)for(let Jt=0,Vn=Bt.count;Jt<Vn;Jt+=3){for(let Tt=0;Tt<3;Tt++){const tn=Bt.getX(Jt+Tt)+1;f[Tt]=i+tn+(Dt||Mt?"/"+(Mt?r+tn:"")+(Dt?"/"+(s+tn):""):"")}t+="f "+f.join(" ")+"\n"}else for(let Jt=0,Vn=je.count;Jt<Vn;Jt+=3){for(let Tt=0;Tt<3;Tt++){const tn=Jt+Tt+1;f[Tt]=i+tn+(Dt||Mt?"/"+(Mt?r+tn:"")+(Dt?"/"+(s+tn):""):"")}t+="f "+f.join(" ")+"\n"}i+=re,r+=ne,s+=se}(q),!0===q.isLine&&function T(q){let re=0;const ne=q.type,De=q.geometry.getAttribute("position");if(t+="o "+q.name+"\n",void 0!==De)for(let Se=0,je=De.count;Se<je;Se++,re++)o.fromBufferAttribute(De,Se),o.applyMatrix4(q.matrixWorld),t+="v "+o.x+" "+o.y+" "+o.z+"\n";if("Line"===ne){t+="l ";for(let Se=1,je=De.count;Se<=je;Se++)t+=i+Se+" ";t+="\n"}if("LineSegments"===ne)for(let Se=1,je=Se+1,Dt=De.count;Se<Dt;Se+=2,je=Se+1)t+="l "+(i+Se)+" "+(i+je)+"\n";i+=re}(q),!0===q.isPoints&&function B(q){let re=0;const se=q.geometry,ne=se.getAttribute("position"),De=se.getAttribute("color");if(t+="o "+q.name+"\n",void 0!==ne){for(let Se=0,je=ne.count;Se<je;Se++,re++)o.fromBufferAttribute(ne,Se),o.applyMatrix4(q.matrixWorld),t+="v "+o.x+" "+o.y+" "+o.z,void 0!==De&&(l.fromBufferAttribute(De,Se).convertLinearToSRGB(),t+=" "+l.r+" "+l.g+" "+l.b),t+="\n";t+="p ";for(let Se=1,je=ne.count;Se<=je;Se++)t+=i+Se+" ";t+="\n"}i+=re}(q)}),t}}let QE,LO,VC,iB;function NO(n,e=1/0,t=null){LO||(LO=new vC(2,2,1,1)),VC||(VC=new Cu({uniforms:{blitTexture:new PO(n)},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main(){\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = vec4(position.xy * 1.0,0.,.999999);\n\t\t\t}",fragmentShader:"\n\t\t\tuniform sampler2D blitTexture; \n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main(){ \n\t\t\t\tgl_FragColor = vec4(vUv.xy, 0, 1);\n\t\t\t\t\n\t\t\t\t#ifdef IS_SRGB\n\t\t\t\tgl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n\t\t\t\t#else\n\t\t\t\tgl_FragColor = texture2D( blitTexture, vUv);\n\t\t\t\t#endif\n\t\t\t}"})),VC.uniforms.blitTexture.value=n,VC.defines.IS_SRGB=n.colorSpace==cu,VC.needsUpdate=!0,iB||(iB=new Yo(LO,VC),iB.frustrumCulled=!1);const i=new Mu,r=new IE;r.add(iB),null===t&&(t=QE=new v4({antialias:!1}));const s=Math.min(n.image.width,e),o=Math.min(n.image.height,e);t.setSize(s,o),t.clear(),t.render(r,i);const l=document.createElement("canvas"),d=l.getContext("2d");l.width=s,l.height=o,d.drawImage(t.domElement,0,0,s,o);const u=new RQ(l);return u.minFilter=n.minFilter,u.magFilter=n.magFilter,u.wrapS=n.wrapS,u.wrapT=n.wrapT,u.name=n.name,QE&&(QE.forceContextLoss(),QE.dispose(),QE=null),u}const BW={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class UO{constructor(){this.pluginCallbacks=[],this.register(function(e){return new _1e(e)}),this.register(function(e){return new y1e(e)}),this.register(function(e){return new x1e(e)}),this.register(function(e){return new w1e(e)}),this.register(function(e){return new C1e(e)}),this.register(function(e){return new M1e(e)}),this.register(function(e){return new v1e(e)}),this.register(function(e){return new b1e(e)}),this.register(function(e){return new S1e(e)}),this.register(function(e){return new E1e(e)}),this.register(function(e){return new T1e(e)}),this.register(function(e){return new D1e(e)}),this.register(function(e){return new I1e(e)})}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){const s=new g1e,o=[];for(let l=0,d=this.pluginCallbacks.length;l<d;l++)o.push(this.pluginCallbacks[l](s));s.setPlugins(o),s.write(e,t,r).catch(i)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,r,s,t)})}}const zO="KHR_mesh_quantization",vm={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987,1001:33071,1e3:10497,1002:33648},PW={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},c1e=new fr;function WE(n,e){return n.length===e.length&&n.every(function(t,i){return t===e[i]})}function FW(n){return 4*Math.ceil(n/4)}function HO(n,e=0){const t=FW(n.byteLength);if(t!==n.byteLength){const i=new Uint8Array(t);if(i.set(new Uint8Array(n)),0!==e)for(let r=n.byteLength;r<t;r++)i[r]=e;return i.buffer}return n}function OW(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function LW(n,e){if(void 0!==n.toBlob)return new Promise(i=>n.toBlob(i,e));let t;return"image/jpeg"===e?t=.92:"image/webp"===e&&(t=.8),n.convertToBlob({type:e,quality:t})}class g1e{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}write(e,t,i={}){var r=this;return(0,ve.A)(function*(){r.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),r.options.animations.length>0&&(r.options.trs=!0),r.processInput(e),yield Promise.all(r.pending);const l=r.json;i=r.options;const d=r.extensionsUsed,u=r.extensionsRequired,f=new Blob(r.buffers,{type:"application/octet-stream"}),g=Object.keys(d),T=Object.keys(u);if(g.length>0&&(l.extensionsUsed=g),T.length>0&&(l.extensionsRequired=T),l.buffers&&l.buffers.length>0&&(l.buffers[0].byteLength=f.size),!0===i.binary){const B=new FileReader;B.readAsArrayBuffer(f),B.onloadend=function(){const q=HO(B.result),re=new DataView(new ArrayBuffer(8));re.setUint32(0,q.byteLength,!0),re.setUint32(4,5130562,!0);const se=HO(function p1e(n){return(new TextEncoder).encode(n).buffer}(JSON.stringify(l)),32),ne=new DataView(new ArrayBuffer(8));ne.setUint32(0,se.byteLength,!0),ne.setUint32(4,1313821514,!0);const De=new ArrayBuffer(12),Se=new DataView(De);Se.setUint32(0,1179937895,!0),Se.setUint32(4,2,!0),Se.setUint32(8,12+ne.byteLength+se.byteLength+re.byteLength+q.byteLength,!0);const Dt=new Blob([De,ne,se,re,q],{type:"application/octet-stream"}),Mt=new FileReader;Mt.readAsArrayBuffer(Dt),Mt.onloadend=function(){t(Mt.result)}}}else if(l.buffers&&l.buffers.length>0){const B=new FileReader;B.readAsDataURL(f),B.onloadend=function(){l.buffers[0].uri=B.result,t(l)}}else t(l)})()}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const i=this.options,r=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&s.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const o in s.gltfExtensions)t.extensions[o]=s.gltfExtensions[o],r[o]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(t.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new Rt;for(let r=0,s=e.count;r<s;r++)if(Math.abs(i.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),r=new Rt;for(let s=0,o=i.count;s<o;s++)r.fromBufferAttribute(i,s),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),i.setXYZ(s,r.x,r.y,r.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const r={};(0!==t.offset.x||0!==t.offset.y)&&(r.offset=t.offset.toArray(),i=!0),0!==t.rotation&&(r.rotation=t.rotation,i=!0),(1!==t.repeat.x||1!==t.repeat.y)&&(r.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function i(B){return B.colorSpace===cu?function(re){return re<.04045?.0773993808*re:Math.pow(.9478672986*re+.0521327014,2.4)}:function(re){return re}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof RC&&(e=NO(e)),t instanceof RC&&(t=NO(t));const r=e?e.image:null,s=t?t.image:null,o=Math.max(r?r.width:0,s?s.width:0),l=Math.max(r?r.height:0,s?s.height:0),d=OW();d.width=o,d.height=l;const u=d.getContext("2d");u.fillStyle="#00ffff",u.fillRect(0,0,o,l);const f=u.getImageData(0,0,o,l);if(r){u.drawImage(r,0,0,o,l);const B=i(e),q=u.getImageData(0,0,o,l).data;for(let re=2;re<q.length;re+=4)f.data[re]=256*B(q[re]/256)}if(s){u.drawImage(s,0,0,o,l);const B=i(t),q=u.getImageData(0,0,o,l).data;for(let re=1;re<q.length;re+=4)f.data[re]=256*B(q[re]/256)}u.putImageData(f,0,0);const T=(e||t).clone();return T.source=new Ob(d),T.colorSpace="",T.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),T}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,r,s){const o=this.json;let l;switch(o.bufferViews||(o.bufferViews=[]),t){case 5120:case 5121:l=1;break;case 5122:case 5123:l=2;break;default:l=4}const d=FW(r*e.itemSize*l),u=new DataView(new ArrayBuffer(d));let f=0;for(let B=i;B<i+r;B++)for(let q=0;q<e.itemSize;q++){let re;e.itemSize>4?re=e.array[B*e.itemSize+q]:(0===q?re=e.getX(B):1===q?re=e.getY(B):2===q?re=e.getZ(B):3===q&&(re=e.getW(B)),!0===e.normalized&&(re=wE.normalize(re,e.array))),5126===t?u.setFloat32(f,re,!0):5124===t?u.setInt32(f,re,!0):5125===t?u.setUint32(f,re,!0):5122===t?u.setInt16(f,re,!0):5123===t?u.setUint16(f,re,!0):5120===t?u.setInt8(f,re):5121===t&&u.setUint8(f,re),f+=l}const g={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:d};return void 0!==s&&(g.target=s),34962===s&&(g.byteStride=e.itemSize*l),this.byteOffset+=d,o.bufferViews.push(g),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(r){const s=new FileReader;s.readAsArrayBuffer(e),s.onloadend=function(){const o=HO(s.result),l={buffer:t.processBuffer(o),byteOffset:t.byteOffset,byteLength:o.byteLength};t.byteOffset+=o.byteLength,r(i.bufferViews.push(l)-1)}})}processAccessor(e,t,i,r){const s=this.json;let l;if(e.array.constructor===Float32Array)l=5126;else if(e.array.constructor===Int32Array)l=5124;else if(e.array.constructor===Uint32Array)l=5125;else if(e.array.constructor===Int16Array)l=5122;else if(e.array.constructor===Uint16Array)l=5123;else if(e.array.constructor===Int8Array)l=5120;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);l=5121}if(void 0===i&&(i=0),(void 0===r||r===1/0)&&(r=e.count),0===r)return null;const d=function A1e(n,e,t){const i={min:new Array(n.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(n.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+t;r++)for(let s=0;s<n.itemSize;s++){let o;n.itemSize>4?o=n.array[r*n.itemSize+s]:(0===s?o=n.getX(r):1===s?o=n.getY(r):2===s?o=n.getZ(r):3===s&&(o=n.getW(r)),!0===n.normalized&&(o=wE.normalize(o,n.array))),i.min[s]=Math.min(i.min[s],o),i.max[s]=Math.max(i.max[s],o)}return i}(e,i,r);let u;void 0!==t&&(u=e===t.index?34963:34962);const f=this.processBufferView(e,l,i,r,u),g={bufferView:f.id,byteOffset:f.byteOffset,componentType:l,count:r,max:d.max,min:d.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(g.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(g)-1}processImage(e,t,i,r="image/png"){if(null!==e){const s=this,o=s.cache,l=s.json,d=s.options,u=s.pending;o.images.has(e)||o.images.set(e,{});const f=o.images.get(e),g=r+":flipY/"+i.toString();if(void 0!==f[g])return f[g];l.images||(l.images=[]);const T={mimeType:r},B=OW();B.width=Math.min(e.width,d.maxTextureSize),B.height=Math.min(e.height,d.maxTextureSize);const q=B.getContext("2d");if(!0===i&&(q.translate(0,B.height),q.scale(1,-1)),void 0!==e.data){t!==wp&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>d.maxTextureSize||e.height>d.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const se=new Uint8ClampedArray(e.height*e.width*4);for(let ne=0;ne<se.length;ne+=4)se[ne+0]=e.data[ne+0],se[ne+1]=e.data[ne+1],se[ne+2]=e.data[ne+2],se[ne+3]=e.data[ne+3];q.putImageData(new ImageData(se,e.width,e.height),0,0)}else{if(!(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap))throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement or ImageBitmap.");q.drawImage(e,0,0,B.width,B.height)}!0===d.binary?u.push(LW(B,r).then(se=>s.processBufferViewImage(se)).then(se=>{T.bufferView=se})):void 0!==B.toDataURL?T.uri=B.toDataURL(r):u.push(LW(B,r).then(se=>(new FileReader).readAsDataURL(se)).then(se=>{T.uri=se}));const re=l.images.push(T)-1;return f[g]=re,re}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;return t.samplers||(t.samplers=[]),t.samplers.push({magFilter:vm[e.magFilter],minFilter:vm[e.minFilter],wrapS:vm[e.wrapS],wrapT:vm[e.wrapT]})-1}processTexture(e){const i=this.options,r=this.cache,s=this.json;if(r.textures.has(e))return r.textures.get(e);s.textures||(s.textures=[]),e instanceof RC&&(e=NO(e,i.maxTextureSize));let o=e.userData.mimeType;"image/webp"===o&&(o="image/png");const l={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(l.name=e.name),this._invokeAll(function(u){u.writeTexture&&u.writeTexture(e,l)});const d=s.textures.push(l)-1;return r.textures.set(e,d),d}processMaterial(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(WE(s,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const l=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),d={index:this.processTexture(l),channel:l.channel};this.applyTextureTransform(d,l),r.pbrMetallicRoughness.metallicRoughnessTexture=d}if(e.map){const l={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(l,e.map),r.pbrMetallicRoughness.baseColorTexture=l}if(e.emissive){const l=e.emissive;if(Math.max(l.r,l.g,l.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const u={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(u,e.emissiveMap),r.emissiveTexture=u}}if(e.normalMap){const l={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(l.scale=e.normalScale.x),this.applyTextureTransform(l,e.normalMap),r.normalTexture=l}if(e.aoMap){const l={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(l.strength=e.aoMapIntensity),this.applyTextureTransform(l,e.aoMap),r.occlusionTexture=l}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),2===e.side&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll(function(l){l.writeMaterial&&l.writeMaterial(e,r)});const o=i.materials.push(r)-1;return t.materials.set(e,o),o}processMesh(e){const t=this.cache,i=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let je=0,Dt=e.material.length;je<Dt;je++)r.push(e.material[je].uuid);else r.push(e.material.uuid);const s=r.join(":");if(t.meshes.has(s))return t.meshes.get(s);const o=e.geometry;let l;l=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4;const d={},u={},f=[],g=[],T={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},B=o.getAttribute("normal");void 0!==B&&!this.isNormalizedNormalAttribute(B)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(B)));let q=null;for(let je in o.attributes){if("morph"===je.slice(0,5))continue;const Dt=o.attributes[je];if(je=T[je]||je.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(je)||(je="_"+je),t.attributes.has(this.getUID(Dt))){u[je]=t.attributes.get(this.getUID(Dt));continue}q=null;const Bt=Dt.array;"JOINTS_0"===je&&!(Bt instanceof Uint16Array)&&!(Bt instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),q=new To(new Uint16Array(Bt),Dt.itemSize,Dt.normalized));const Jt=this.processAccessor(q||Dt,o);null!==Jt&&(je.startsWith("_")||this.detectMeshQuantization(je,Dt),u[je]=Jt,t.attributes.set(this.getUID(Dt),Jt))}if(void 0!==B&&o.setAttribute("normal",B),0===Object.keys(u).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const je=[],Dt=[],Mt={};if(void 0!==e.morphTargetDictionary)for(const Bt in e.morphTargetDictionary)Mt[e.morphTargetDictionary[Bt]]=Bt;for(let Bt=0;Bt<e.morphTargetInfluences.length;++Bt){const Jt={};let Vn=!1;for(const Tt in o.morphAttributes){if("position"!==Tt&&"normal"!==Tt){Vn||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),Vn=!0);continue}const tn=o.morphAttributes[Tt][Bt],Fi=Tt.toUpperCase(),Vi=o.attributes[Tt];if(t.attributes.has(this.getUID(tn,!0))){Jt[Fi]=t.attributes.get(this.getUID(tn,!0));continue}const On=tn.clone();if(!o.morphTargetsRelative)for(let yi=0,Gn=tn.count;yi<Gn;yi++)for(let ri=0;ri<tn.itemSize;ri++)0===ri&&On.setX(yi,tn.getX(yi)-Vi.getX(yi)),1===ri&&On.setY(yi,tn.getY(yi)-Vi.getY(yi)),2===ri&&On.setZ(yi,tn.getZ(yi)-Vi.getZ(yi)),3===ri&&On.setW(yi,tn.getW(yi)-Vi.getW(yi));Jt[Fi]=this.processAccessor(On,o),t.attributes.set(this.getUID(Vi,!0),Jt[Fi])}g.push(Jt),je.push(e.morphTargetInfluences[Bt]),void 0!==e.morphTargetDictionary&&Dt.push(Mt[Bt])}d.weights=je,Dt.length>0&&(d.extras={},d.extras.targetNames=Dt)}const re=Array.isArray(e.material);if(re&&0===o.groups.length)return null;let se=!1;if(re&&null===o.index){const je=[];for(let Dt=0,Mt=o.attributes.position.count;Dt<Mt;Dt++)je[Dt]=Dt;o.setIndex(je),se=!0}const ne=re?e.material:[e.material],De=re?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let je=0,Dt=De.length;je<Dt;je++){const Mt={mode:l,attributes:u};if(this.serializeUserData(o,Mt),g.length>0&&(Mt.targets=g),null!==o.index){let Jt=this.getUID(o.index);(void 0!==De[je].start||void 0!==De[je].count)&&(Jt+=":"+De[je].start+":"+De[je].count),t.attributes.has(Jt)?Mt.indices=t.attributes.get(Jt):(Mt.indices=this.processAccessor(o.index,o,De[je].start,De[je].count),t.attributes.set(Jt,Mt.indices)),null===Mt.indices&&delete Mt.indices}const Bt=this.processMaterial(ne[De[je].materialIndex]);null!==Bt&&(Mt.material=Bt),f.push(Mt)}!0===se&&o.setIndex(null),d.primitives=f,i.meshes||(i.meshes=[]),this._invokeAll(function(je){je.writeMesh&&je.writeMesh(e,d)});const Se=i.meshes.push(d)-1;return t.meshes.set(s,Se),Se}detectMeshQuantization(e,t){if(this.extensionsUsed[zO])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const r=e.split("_",1)[0];BW[r]&&BW[r].includes(i)&&(this.extensionsUsed[zO]=!0,this.extensionsRequired[zO]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,r={type:i?"orthographic":"perspective"};return i?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:wE.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const i=this.json,r=this.nodeMap;i.animations||(i.animations=[]);const s=(e=UO.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,o=[],l=[];for(let d=0;d<s.length;++d){const u=s[d],f=Vl.parseTrackName(u.name);let g=Vl.findNode(t,f.nodeName);const T=PW[f.propertyName];if("bones"===f.objectName&&(g=!0===g.isSkinnedMesh?g.skeleton.getBoneByName(f.objectIndex):void 0),!g||!T)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',u.name),null;const B=1;let re,q=u.values.length/u.times.length;T===PW.morphTargetInfluences&&(q/=g.morphTargetInfluences.length),!0===u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(re="CUBICSPLINE",q/=3):re=u.getInterpolation()===K2?"STEP":"LINEAR",l.push({input:this.processAccessor(new To(u.times,B)),output:this.processAccessor(new To(u.values,q)),interpolation:re}),o.push({sampler:l.length-1,target:{node:r.get(g),path:T}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:l,channels:o}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,r=t.nodes[i.get(e)],s=e.skeleton;if(void 0===s)return null;const o=e.skeleton.bones[0];if(void 0===o)return null;const l=[],d=new Float32Array(16*s.bones.length),u=new fo;for(let g=0;g<s.bones.length;++g)l.push(i.get(s.bones[g])),u.copy(s.boneInverses[g]),u.multiply(e.bindMatrix).toArray(d,16*g);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new To(d,16)),joints:l,skeleton:i.get(o)}),r.skin=t.skins.length-1}processNode(e){const t=this.json,i=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const s={};if(i.trs){const l=e.quaternion.toArray(),d=e.position.toArray(),u=e.scale.toArray();WE(l,[0,0,0,1])||(s.rotation=l),WE(d,[0,0,0])||(s.translation=d),WE(u,[1,1,1])||(s.scale=u)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function m1e(n){return WE(n.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(s.matrix=e.matrix.elements);if(""!==e.name&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const l=this.processMesh(e);null!==l&&(s.mesh=l)}else e.isCamera&&(s.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const l=[];for(let d=0,u=e.children.length;d<u;d++){const f=e.children[d];if(f.visible||!1===i.onlyVisible){const g=this.processNode(f);null!==g&&l.push(g)}}l.length>0&&(s.children=l)}this._invokeAll(function(l){l.writeNode&&l.writeNode(e,s)});const o=t.nodes.push(s)-1;return r.set(e,o),o}processScene(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);const s=[];for(let o=0,l=e.children.length;o<l;o++){const d=e.children[o];if(d.visible||!1===i.onlyVisible){const u=this.processNode(d);null!==u&&s.push(u)}}s.length>0&&(r.nodes=s),this.serializeUserData(e,r)}processObjects(e){const t=new IE;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(r){r.beforeParse&&r.beforeParse(e)});const i=[];for(let r=0;r<e.length;r++)e[r]instanceof IE?this.processScene(e[r]):i.push(e[r]);i.length>0&&this.processObjects(i);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);this._invokeAll(function(r){r.afterParse&&r.afterParse(e)})}_invokeAll(e){for(let t=0,i=this.plugins.length;t<i;t++)e(this.plugins[t])}}class _1e{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const i=this.writer,r=i.json,s=i.extensionsUsed,o={};e.name&&(o.name=e.name),o.color=e.color.toArray(),o.intensity=e.intensity,e.isDirectionalLight?o.type="directional":e.isPointLight?(o.type="point",e.distance>0&&(o.range=e.distance)):e.isSpotLight&&(o.type="spot",e.distance>0&&(o.range=e.distance),o.spot={},o.spot.innerConeAngle=(1-e.penumbra)*e.angle,o.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||-1!==e.target.position.z)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},s[this.name]=!0);const l=r.extensions[this.name].lights;l.push(o),t.extensions=t.extensions||{},t.extensions[this.name]={light:l.length-1}}}class y1e{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class v1e{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.clearcoatFactor=e.clearcoat,e.clearcoatMap){const o={index:i.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(o,e.clearcoatMap),s.clearcoatTexture=o}if(s.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const o={index:i.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(o,e.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=o}if(e.clearcoatNormalMap){const o={index:i.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};i.applyTextureTransform(o,e.clearcoatNormalMap),s.clearcoatNormalTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class b1e{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.iridescenceFactor=e.iridescence,e.iridescenceMap){const o={index:i.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(o,e.iridescenceMap),s.iridescenceTexture=o}if(s.iridescenceIor=e.iridescenceIOR,s.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const o={index:i.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(o,e.iridescenceThicknessMap),s.iridescenceThicknessTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class x1e{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.transmissionFactor=e.transmission,e.transmissionMap){const o={index:i.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(o,e.transmissionMap),s.transmissionTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class w1e{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.thicknessFactor=e.thickness,e.thicknessMap){const o={index:i.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(o,e.thicknessMap),s.thicknessTexture=o}s.attenuationDistance=e.attenuationDistance,s.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class C1e{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const r=this.writer.extensionsUsed,s={};s.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class M1e{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(c1e)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.specularIntensityMap){const o={index:i.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(o,e.specularIntensityMap),s.specularTexture=o}if(e.specularColorMap){const o={index:i.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(o,e.specularColorMap),s.specularColorTexture=o}s.specularFactor=e.specularIntensity,s.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class S1e{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.sheenRoughnessMap){const o={index:i.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(o,e.sheenRoughnessMap),s.sheenRoughnessTexture=o}if(e.sheenColorMap){const o={index:i.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(o,e.sheenColorMap),s.sheenColorTexture=o}s.sheenRoughnessFactor=e.sheenRoughness,s.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class E1e{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.anisotropyMap){const o={index:i.processTexture(e.anisotropyMap)};i.applyTextureTransform(o,e.anisotropyMap),s.anisotropyTexture=o}s.anisotropyStrength=e.anisotropy,s.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class T1e{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const r=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class D1e{constructor(e){this.writer=e,this.name="EXT_materials_bump"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.bumpMap){const o={index:i.processTexture(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(o,e.bumpMap),s.bumpTexture=o}s.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class I1e{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,r=e,s=new Float32Array(3*r.count),o=new Float32Array(4*r.count),l=new Float32Array(3*r.count),d=new fo,u=new Rt,f=new zc,g=new Rt;for(let B=0;B<r.count;B++)r.getMatrixAt(B,d),d.decompose(u,f,g),u.toArray(s,3*B),f.toArray(o,4*B),g.toArray(l,3*B);const T={TRANSLATION:i.processAccessor(new To(s,3)),ROTATION:i.processAccessor(new To(o,4)),SCALE:i.processAccessor(new To(l,3))};r.instanceColor&&(T._COLOR_0=i.processAccessor(r.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:T},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}UO.Utils={insertKeyframe:function(n,e){const i=n.getValueSize(),r=new n.TimeBufferType(n.times.length+1),s=new n.ValueBufferType(n.values.length+i),o=n.createInterpolant(new n.ValueBufferType(i));let l;if(0===n.times.length){r[0]=e;for(let d=0;d<i;d++)s[d]=0;l=0}else if(e<n.times[0]){if(Math.abs(n.times[0]-e)<.001)return 0;r[0]=e,r.set(n.times,1),s.set(o.evaluate(e),0),s.set(n.values,i),l=0}else if(e>n.times[n.times.length-1]){if(Math.abs(n.times[n.times.length-1]-e)<.001)return n.times.length-1;r[r.length-1]=e,r.set(n.times,0),s.set(n.values,0),s.set(o.evaluate(e),n.values.length),l=r.length-1}else for(let d=0;d<n.times.length;d++){if(Math.abs(n.times[d]-e)<.001)return d;if(n.times[d]<e&&n.times[d+1]>e){r.set(n.times.slice(0,d+1),0),r[d+1]=e,r.set(n.times.slice(d+1),d+2),s.set(n.values.slice(0,(d+1)*i),0),s.set(o.evaluate(e),(d+1)*i),s.set(n.values.slice((d+1)*i),(d+2)*i),l=d+1;break}}return n.times=r,n.values=s,l},mergeMorphTargetTracks:function(n,e){const t=[],i={},r=n.tracks;for(let s=0;s<r.length;++s){let o=r[s];const l=Vl.parseTrackName(o.name),d=Vl.findNode(e,l.nodeName);if("morphTargetInfluences"!==l.propertyName||void 0===l.propertyIndex){t.push(o);continue}if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(Rb)}const u=d.morphTargetInfluences.length,f=d.morphTargetDictionary[l.propertyIndex];if(void 0===f)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let g;if(void 0===i[d.uuid]){g=o.clone();const B=new g.ValueBufferType(u*g.times.length);for(let q=0;q<g.times.length;q++)B[q*u+f]=g.values[q];g.name=(l.nodeName||"")+".morphTargetInfluences",g.values=B,i[d.uuid]=g,t.push(g);continue}const T=o.createInterpolant(new o.ValueBufferType(1));g=i[d.uuid];for(let B=0;B<g.times.length;B++)g.values[B*u+f]=T.evaluate(g.times[B]);for(let B=0;B<o.times.length;B++){const q=this.insertKeyframe(g,o.times[B]);g.values[q*u+f]=o.values[B]}}return n.tracks=t,n}};const rB=(n,e,t="application/json")=>{const i=new Blob([n],{type:t}),r=document.createElement("a");r.style.display="none",r.href=URL.createObjectURL(i),r.download=e,r.click(),r.remove()},NW=(n,e="application/json")=>{let t=document.createElement("input");t.type="file",t.accept=e,t.onchange=i=>{var r;const s=null===(r=i.target)||void 0===r?void 0:r.files[0],o=new FileReader;o.onload=l=>{n?.(l.target.result.toString()),t.remove(),t=null},o.readAsText(s)},t.click(),setTimeout(()=>{console.log("Let us just wait a second")},1e3)};class B1e{exportSceneToOBJ(e){const i=(new l1e).parse(e);rB(i,"phoenix-obj.obj","text/plain")}exportPhoenixScene(e,t,i){const r=new UO,s=this.saveSceneConfig(t,i);r.parse(e,o=>{const d=JSON.stringify({sceneConfiguration:s,scene:o},null,2);rB(d,"phoenix-scene.phnx","text/plain")},null)}saveSceneConfig(e,t){return{eventData:this.saveEventDataConfiguration(e),geometries:this.saveGeometriesConfiguration(t)}}saveEventDataConfiguration(e){const t={};for(const i of e.children)if(i.name){t[i.name]=[];for(const r of i.children)r.name&&t[i.name].push(r.name)}return t}saveGeometriesConfiguration(e){const t=[];return e.children.forEach(i=>{"EventData"!==i.name&&t.push(i.name)}),t}}const P1e=/^[og]\s*(.+)?/,R1e=/^mtllib /,k1e=/^usemtl /,F1e=/^usemap /,UW=/\s+/,zW=new Rt,VO=new Rt,HW=new Rt,VW=new Rt,_A=new Rt,sB=new fr;function O1e(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const l={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(d){const u={index:"number"==typeof d?d:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return u.clone=this.clone.bind(u),u}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,s=this.object.geometry.normals;zW.fromArray(r,e),VO.fromArray(r,t),HW.fromArray(r,i),_A.subVectors(HW,VO),VW.subVectors(zW,VO),_A.cross(VW),_A.normalize(),s.push(_A.x,_A.y,_A.z),s.push(_A.x,_A.y,_A.z),s.push(_A.x,_A.y,_A.z)},addColor:function(e,t,i){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&s.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,s,o,l,d,u){const f=this.vertices.length;let g=this.parseVertexIndex(e,f),T=this.parseVertexIndex(t,f),B=this.parseVertexIndex(i,f);if(this.addVertex(g,T,B),this.addColor(g,T,B),void 0!==l&&""!==l){const q=this.normals.length;g=this.parseNormalIndex(l,q),T=this.parseNormalIndex(d,q),B=this.parseNormalIndex(u,q),this.addNormal(g,T,B)}else this.addFaceNormal(g,T,B);if(void 0!==r&&""!==r){const q=this.uvs.length;g=this.parseUVIndex(r,q),T=this.parseUVIndex(s,q),B=this.parseUVIndex(o,q),this.addUV(g,T,B),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return n.startObject("",!1),n}class GW extends Kh{constructor(e){super(e),this.materials=null}load(e,t,i,r){const s=this,o=new Sp(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{t(s.parse(l))}catch(d){r?r(d):console.error(d),s.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new O1e;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let l=0,d=i.length;l<d;l++){const u=i[l].trimStart();if(0===u.length)continue;const f=u.charAt(0);if("#"!==f)if("v"===f){const g=u.split(UW);switch(g[0]){case"v":t.vertices.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])),g.length>=7?(sB.setRGB(parseFloat(g[4]),parseFloat(g[5]),parseFloat(g[6])).convertSRGBToLinear(),t.colors.push(sB.r,sB.g,sB.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));break;case"vt":t.uvs.push(parseFloat(g[1]),parseFloat(g[2]))}}else if("f"===f){const T=u.slice(1).trim().split(UW),B=[];for(let re=0,se=T.length;re<se;re++){const ne=T[re];if(ne.length>0){const De=ne.split("/");B.push(De)}}const q=B[0];for(let re=1,se=B.length-1;re<se;re++){const ne=B[re],De=B[re+1];t.addFace(q[0],ne[0],De[0],q[1],ne[1],De[1],q[2],ne[2],De[2])}}else if("l"===f){const g=u.substring(1).trim().split(" ");let T=[];const B=[];if(-1===u.indexOf("/"))T=g;else for(let q=0,re=g.length;q<re;q++){const se=g[q].split("/");""!==se[0]&&T.push(se[0]),""!==se[1]&&B.push(se[1])}t.addLineGeometry(T,B)}else if("p"===f){const T=u.slice(1).trim().split(" ");t.addPointGeometry(T)}else if(null!==(r=P1e.exec(u))){const g=(" "+r[0].slice(1).trim()).slice(1);t.startObject(g)}else if(k1e.test(u))t.object.startMaterial(u.substring(7).trim(),t.materialLibraries);else if(R1e.test(u))t.materialLibraries.push(u.substring(7).trim());else if(F1e.test(u))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===f){if(r=u.split(" "),r.length>1){const T=r[1].trim().toLowerCase();t.object.smooth="0"!==T&&"off"!==T}else t.object.smooth=!0;const g=t.object.currentMaterial();g&&(g.smooth=t.object.smooth)}else{if("\0"===u)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+u+'"')}}t.finalize();const s=new $l;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let l=0,d=t.objects.length;l<d;l++){const u=t.objects[l],f=u.geometry,g=u.materials,T="Line"===f.type,B="Points"===f.type;let q=!1;if(0===f.vertices.length)continue;const re=new Qs;re.setAttribute("position",new ks(f.vertices,3)),f.normals.length>0&&re.setAttribute("normal",new ks(f.normals,3)),f.colors.length>0&&(q=!0,re.setAttribute("color",new ks(f.colors,3))),!0===f.hasUVIndices&&re.setAttribute("uv",new ks(f.uvs,2));const se=[];for(let De=0,Se=g.length;De<Se;De++){const je=g[De],Dt=je.name+"_"+je.smooth+"_"+q;let Mt=t.materials[Dt];if(null!==this.materials)if(Mt=this.materials.create(je.name),!T||!Mt||Mt instanceof wc){if(B&&Mt&&!(Mt instanceof c1)){const Bt=new c1({size:10,sizeAttenuation:!1});ad.prototype.copy.call(Bt,Mt),Bt.color.copy(Mt.color),Bt.map=Mt.map,Mt=Bt}}else{const Bt=new wc;ad.prototype.copy.call(Bt,Mt),Bt.color.copy(Mt.color),Mt=Bt}void 0===Mt&&(Mt=T?new wc:B?new c1({size:1,sizeAttenuation:!1}):new _g,Mt.name=je.name,Mt.flatShading=!je.smooth,Mt.vertexColors=q,t.materials[Dt]=Mt),se.push(Mt)}let ne;if(se.length>1){for(let De=0,Se=g.length;De<Se;De++){const je=g[De];re.addGroup(je.groupStart,je.groupCount,De)}ne=T?new hc(re,se):B?new $b(re,se):new Yo(re,se)}else ne=T?new hc(re,se[0]):B?new $b(re,se[0]):new Yo(re,se[0]);ne.name=u.name,s.add(ne)}else if(t.vertices.length>0){const l=new c1({size:1,sizeAttenuation:!1}),d=new Qs;d.setAttribute("position",new ks(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(d.setAttribute("color",new ks(t.colors,3)),l.vertexColors=!0);const u=new $b(d,l);s.add(u)}return s}}function GO(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},l=n[0].morphTargetsRelative,d=new Qs;let u=0;for(let f=0;f<n.length;++f){const g=n[f];let T=0;if(t!==(null!==g.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const B in g.attributes){if(!i.has(B))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+B+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[B]&&(s[B]=[]),s[B].push(g.attributes[B]),T++}if(T!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(l!==g.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const B in g.morphAttributes){if(!r.has(B))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[B]&&(o[B]=[]),o[B].push(g.morphAttributes[B])}if(e){let B;if(t)B=g.index.count;else{if(void 0===g.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;B=g.attributes.position.count}d.addGroup(u,B,f),u+=B}}if(t){let f=0;const g=[];for(let T=0;T<n.length;++T){const B=n[T].index;for(let q=0;q<B.count;++q)g.push(B.getX(q)+f);f+=n[T].attributes.position.count}d.setIndex(g)}for(const f in s){const g=qW(s[f]);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" attribute."),null;d.setAttribute(f,g)}for(const f in o){const g=o[f][0].length;if(0===g)break;d.morphAttributes=d.morphAttributes||{},d.morphAttributes[f]=[];for(let T=0;T<g;++T){const B=[];for(let re=0;re<o[f].length;++re)B.push(o[f][re][T]);const q=qW(B);if(!q)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" morphAttribute."),null;d.morphAttributes[f].push(q)}}return d}function qW(n){let e,t,i,r=-1,s=0;for(let u=0;u<n.length;++u){const f=n[u];if(void 0===e&&(e=f.array.constructor),e!==f.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=f.itemSize),t!==f.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=f.normalized),i!==f.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===r&&(r=f.gpuType),r!==f.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=f.count*t}const o=new e(s),l=new To(o,t,i);let d=0;for(let u=0;u<n.length;++u){const f=n[u];if(f.isInterleavedBufferAttribute){const g=d/t;for(let T=0,B=f.count;T<B;T++)for(let q=0;q<t;q++){const re=f.getComponent(T,q);l.setComponent(T+g,q,re)}}else o.set(f.array,d);d+=f.count*t}return void 0!==r&&(l.gpuType=r),l}function QW(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],l=n.getAttribute("position");if(void 0===l)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let d=0;d<l.count;d++)o.push(d);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class oB extends Kh{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new H1e(t)}),this.register(function(t){return new Y1e(t)}),this.register(function(t){return new K1e(t)}),this.register(function(t){return new Z1e(t)}),this.register(function(t){return new G1e(t)}),this.register(function(t){return new q1e(t)}),this.register(function(t){return new Q1e(t)}),this.register(function(t){return new W1e(t)}),this.register(function(t){return new z1e(t)}),this.register(function(t){return new j1e(t)}),this.register(function(t){return new V1e(t)}),this.register(function(t){return new X1e(t)}),this.register(function(t){return new $1e(t)}),this.register(function(t){return new N1e(t)}),this.register(function(t){return new J1e(t)}),this.register(function(t){return new eye(t)})}load(e,t,i,r){const s=this;let o;if(""!==this.resourcePath)o=this.resourcePath;else if(""!==this.path){const u=nx.extractUrlBase(e);o=nx.resolveURL(u,this.path)}else o=nx.extractUrlBase(e);this.manager.itemStart(e);const l=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},d=new Sp(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(u){try{s.parse(u,o,function(f){t(f),s.manager.itemEnd(e)},l)}catch(f){l(f)}},i,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},l={},d=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===WW){try{o[ll.KHR_BINARY_GLTF]=new tye(e)}catch(g){return void(r&&r(g))}s=JSON.parse(o[ll.KHR_BINARY_GLTF].content)}else s=JSON.parse(d.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const u=new pye(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const g=this.pluginCallbacks[f](u);g.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[g.name]=g,o[g.name]=!0}if(s.extensionsUsed)for(let f=0;f<s.extensionsUsed.length;++f){const g=s.extensionsUsed[f],T=s.extensionsRequired||[];switch(g){case ll.KHR_MATERIALS_UNLIT:o[g]=new U1e;break;case ll.KHR_DRACO_MESH_COMPRESSION:o[g]=new nye(s,this.dracoLoader);break;case ll.KHR_TEXTURE_TRANSFORM:o[g]=new iye;break;case ll.KHR_MESH_QUANTIZATION:o[g]=new rye;break;default:T.indexOf(g)>=0&&void 0===l[g]&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}u.setExtensions(o),u.setPlugins(l),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function L1e(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const ll={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class N1e{constructor(e){this.parser=e,this.name=ll.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,d=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const f=new fr(16777215);void 0!==d.color&&f.setRGB(d.color[0],d.color[1],d.color[2],Qu);const g=void 0!==d.range?d.range:0;switch(d.type){case"directional":u=new HC(f),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new rW(f),u.distance=g;break;case"spot":u=new nW(f),u.distance=g,d.spot=d.spot||{},d.spot.innerConeAngle=void 0!==d.spot.innerConeAngle?d.spot.innerConeAngle:0,d.spot.outerConeAngle=void 0!==d.spot.outerConeAngle?d.spot.outerConeAngle:Math.PI/4,u.angle=d.spot.outerConeAngle,u.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return u.position.set(0,0,0),u.decay=2,Zy(u,d),void 0!==d.intensity&&(u.intensity=d.intensity),u.name=t.createUniqueName(d.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===l?null:this._loadLight(l).then(function(d){return i._getNodeRef(t.cache,l,d)})}}class U1e{constructor(){this.name=ll.KHR_MATERIALS_UNLIT}getMaterialType(){return yd}extendParams(e,t,i){const r=[];e.color=new fr(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Qu),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,cu))}return Promise.all(r)}}class z1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class H1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const l=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ni(l,l)}return Promise.all(s)}}class V1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class G1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new fr(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const l=o.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],Qu)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,cu)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class q1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Q1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const l=o.attenuationColor||[1,1,1];return t.attenuationColor=(new fr).setRGB(l[0],l[1],l[2],Qu),Promise.all(s)}}class W1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class j1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const l=o.specularColorFactor||[1,1,1];return t.specularColor=(new fr).setRGB(l[0],l[1],l[2],Qu),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,cu)),Promise.all(s)}}class $1e{constructor(e){this.parser=e,this.name=ll.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=void 0!==o.bumpFactor?o.bumpFactor:1,void 0!==o.bumpTexture&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class X1e{constructor(e){this.parser=e,this.name=ll.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?V0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Y1e{constructor(e){this.parser=e,this.name=ll.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class K1e{constructor(e){this.parser=e,this.name=ll.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=r.images[o.source];let d=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);null!==u&&(d=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Z1e{constructor(e){this.parser=e,this.name=ll.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=r.images[o.source];let d=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);null!==u&&(d=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class J1e{constructor(e){this.name=ll.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const f=r.count,g=r.byteStride,T=new Uint8Array(l,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(f,g,T,r.mode,r.filter).then(function(B){return B.buffer}):o.ready.then(function(){const B=new ArrayBuffer(f*g);return o.decodeGltfBuffer(new Uint8Array(B),f,g,T,r.mode,r.filter),B})})}return null}}class eye{constructor(e){this.name=ll.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==yA.TRIANGLES&&u.mode!==yA.TRIANGLE_STRIP&&u.mode!==yA.TRIANGLE_FAN&&void 0!==u.mode)return null;const o=i.extensions[this.name].attributes,l=[],d={};for(const u in o)l.push(this.parser.getDependency("accessor",o[u]).then(f=>(d[u]=f,d[u])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(u=>{const f=u.pop(),g=f.isGroup?f.children:[f],T=u[0].count,B=[];for(const q of g){const re=new fo,se=new Rt,ne=new zc,De=new Rt(1,1,1),Se=new xQ(q.geometry,q.material,T);for(let je=0;je<T;je++)d.TRANSLATION&&se.fromBufferAttribute(d.TRANSLATION,je),d.ROTATION&&ne.fromBufferAttribute(d.ROTATION,je),d.SCALE&&De.fromBufferAttribute(d.SCALE,je),Se.setMatrixAt(je,re.compose(se,ne,De));for(const je in d)if("_COLOR_0"===je){const Dt=d[je];Se.instanceColor=new IC(Dt.array,Dt.itemSize,Dt.normalized)}else"TRANSLATION"!==je&&"ROTATION"!==je&&"SCALE"!==je&&q.geometry.setAttribute(je,d[je]);Ol.prototype.copy.call(Se,q),this.parser.assignFinalMaterial(Se),B.push(Se)}return f.isGroup?(f.clear(),f.add(...B),f):B[0]}))}}const WW="glTF";class tye{constructor(e){this.name=ll.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==WW)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const l=s.getUint32(o,!0);o+=4;const d=s.getUint32(o,!0);if(o+=4,1313821514===d){const u=new Uint8Array(e,12+o,l);this.content=i.decode(u)}else if(5130562===d){const u=12+o;this.body=e.slice(u,u+l)}o+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class nye{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ll.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,l={},d={},u={};for(const f in o){const g=WO[f]||f.toLowerCase();l[g]=o[f]}for(const f in e.attributes){const g=WO[f]||f.toLowerCase();if(void 0!==o[f]){const T=i.accessors[e.attributes[f]];u[g]=GC[T.componentType].name,d[g]=!0===T.normalized}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(g,T){r.decodeDracoFile(f,function(B){for(const q in B.attributes){const se=d[q];void 0!==se&&(B.attributes[q].normalized=se)}g(B)},l,u,Qu,T)})})}}class iye{constructor(){this.name=ll.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class rye{constructor(){this.name=ll.KHR_MESH_QUANTIZATION}}class $W extends VE{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,d=2*l,u=3*l,f=r-t,g=(i-t)/f,T=g*g,B=T*g,q=e*u,re=q-u,se=-2*B+3*T,ne=B-T,De=1-se,Se=ne-T+g;for(let je=0;je!==l;je++)s[je]=De*o[re+je+l]+Se*(o[re+je+d]*f)+se*o[q+je+l]+ne*(o[q+je]*f);return s}}const sye=new zc;class oye extends $W{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return sye.fromArray(s).normalize().toArray(s),s}}const yA={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},GC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},XW={9728:gd,9729:Nc,9984:1004,9985:X2,9986:Ny,9987:fA},YW={33071:bh,33648:$2,10497:Ly},QO={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},WO={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ky={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},aye={CUBICSPLINE:void 0,LINEAR:Rb,STEP:K2};function lx(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Zy(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function dye(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function uye(n){let e;const t=n.extensions&&n.extensions[ll.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+$O(t.attributes):n.indices+":"+$O(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+$O(n.targets[i]);return e}function $O(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function XO(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const fye=new fo;class pye{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new L1e,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new C_e(this.options.manager):new O_e(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Sp(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const l={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return lx(s,l,r),Zy(l,r),Promise.all(i._invokeAll(function(d){return d.afterRoot&&d.afterRoot(l)})).then(function(){e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let l=0,d=o.length;l<d;l++)e[o[l]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,l)=>{const d=this.associations.get(o);null!=d&&this.associations.set(l,d);for(const[u,f]of o.children.entries())s(f,l.children[u])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[ll.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(nx.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=QO[r.type],d=!0===r.normalized,u=new(0,GC[r.componentType])(r.count*o);return Promise.resolve(new To(u,o,d))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const l=o[0],d=QO[r.type],u=GC[r.componentType],f=u.BYTES_PER_ELEMENT,T=r.byteOffset||0,B=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,q=!0===r.normalized;let re,se;if(B&&B!==f*d){const ne=Math.floor(T/B),De="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+ne+":"+r.count;let Se=t.cache.get(De);Se||(re=new u(l,ne*B,r.count*B/f),Se=new b4(re,B/f),t.cache.add(De,Se)),se=new Qb(Se,d,T%B/f,q)}else re=null===l?new u(r.count*d):new u(l,T,r.count*d),se=new To(re,d,q);if(void 0!==r.sparse){const je=r.sparse.values.byteOffset||0,Dt=new(0,GC[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*QO.SCALAR),Mt=new u(o[2],je,r.sparse.count*d);null!==l&&(se=new To(se.array.slice(),se.itemSize,se.normalized));for(let Bt=0,Jt=Dt.length;Bt<Jt;Bt++){const Vn=Dt[Bt];if(se.setX(Vn,Mt[Bt*d]),d>=2&&se.setY(Vn,Mt[Bt*d+1]),d>=3&&se.setZ(Vn,Mt[Bt*d+2]),d>=4&&se.setW(Vn,Mt[Bt*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return se})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let l=this.textureLoader;if(o.uri){const d=this.options.manager.getHandler(o.uri);null!==d&&(l=d)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],l=s.images[t],d=(l.uri||l.bufferView)+":"+o.sampler;if(this.textureCache[d])return this.textureCache[d];const u=this.loadImageSource(t,i).then(function(f){f.flipY=!1,f.name=o.name||l.name||"",""===f.name&&"string"==typeof l.uri&&!1===l.uri.startsWith("data:image/")&&(f.name=l.uri);const T=(s.samplers||{})[o.sampler]||{};return f.magFilter=XW[T.magFilter]||Nc,f.minFilter=XW[T.minFilter]||fA,f.wrapS=YW[T.wrapS]||Ly,f.wrapT=YW[T.wrapT]||Ly,r.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[d]=u,u}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(g=>g.clone());const o=r.images[e],l=self.URL||self.webkitURL;let d=o.uri||"",u=!1;if(void 0!==o.bufferView)d=this.getDependency("bufferView",o.bufferView).then(function(g){u=!0;const T=new Blob([g],{type:o.mimeType});return d=l.createObjectURL(T),d});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(d).then(function(g){return new Promise(function(T,B){let q=T;!0===t.isImageBitmapLoader&&(q=function(re){const se=new $h(re);se.needsUpdate=!0,T(se)}),t.load(nx.resolveURL(g,s.path),q,void 0,B)})}).then(function(g){return!0===u&&l.revokeObjectURL(d),g.userData.mimeType=o.mimeType||function hye(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),g}).catch(function(g){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),g});return this.sourceCache[e]=f,f}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[ll.KHR_TEXTURE_TRANSFORM]){const l=void 0!==i.extensions?i.extensions[ll.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const d=s.associations.get(o);o=s.extensions[ll.KHR_TEXTURE_TRANSFORM].extendTexture(o,l),s.associations.set(o,d)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const l="PointsMaterial:"+i.uuid;let d=this.cache.get(l);d||(d=new c1,ad.prototype.copy.call(d,i),d.color.copy(i.color),d.map=i.map,d.sizeAttenuation=!1,this.cache.add(l,d)),i=d}else if(e.isLine){const l="LineBasicMaterial:"+i.uuid;let d=this.cache.get(l);d||(d=new wc,ad.prototype.copy.call(d,i),d.color.copy(i.color),d.map=i.map,this.cache.add(l,d)),i=d}if(r||s||o){let l="ClonedMaterial:"+i.uuid+":";r&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),o&&(l+="flat-shading:");let d=this.cache.get(l);d||(d=i.clone(),s&&(d.vertexColors=!0),o&&(d.flatShading=!0),r&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(l,d),this.associations.set(d,this.associations.get(i))),i=d}e.material=i}getMaterialType(){return W4}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const l={},u=[];if((s.extensions||{})[ll.KHR_MATERIALS_UNLIT]){const g=r[ll.KHR_MATERIALS_UNLIT];o=g.getMaterialType(),u.push(g.extendParams(l,s,t))}else{const g=s.pbrMetallicRoughness||{};if(l.color=new fr(1,1,1),l.opacity=1,Array.isArray(g.baseColorFactor)){const T=g.baseColorFactor;l.color.setRGB(T[0],T[1],T[2],Qu),l.opacity=T[3]}void 0!==g.baseColorTexture&&u.push(t.assignTexture(l,"map",g.baseColorTexture,cu)),l.metalness=void 0!==g.metallicFactor?g.metallicFactor:1,l.roughness=void 0!==g.roughnessFactor?g.roughnessFactor:1,void 0!==g.metallicRoughnessTexture&&(u.push(t.assignTexture(l,"metalnessMap",g.metallicRoughnessTexture)),u.push(t.assignTexture(l,"roughnessMap",g.metallicRoughnessTexture))),o=this._invokeOne(function(T){return T.getMaterialType&&T.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(T){return T.extendMaterialParams&&T.extendMaterialParams(e,l)})))}!0===s.doubleSided&&(l.side=2);const f=s.alphaMode||"OPAQUE";if("BLEND"===f?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,"MASK"===f&&(l.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==yd&&(u.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new Ni(1,1),void 0!==s.normalTexture.scale)){const g=s.normalTexture.scale;l.normalScale.set(g,g)}if(void 0!==s.occlusionTexture&&o!==yd&&(u.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(l.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==yd){const g=s.emissiveFactor;l.emissive=(new fr).setRGB(g[0],g[1],g[2],Qu)}return void 0!==s.emissiveTexture&&o!==yd&&u.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,cu)),Promise.all(u).then(function(){const g=new o(l);return s.name&&(g.name=s.name),Zy(g,s),t.associations.set(g,{materials:e}),s.extensions&&lx(r,g,s),g})}createUniqueName(e){const t=Vl.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(l){return i[ll.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(d){return KW(d,l,t)})}const o=[];for(let l=0,d=e.length;l<d;l++){const u=e[l],f=uye(u),g=r[f];if(g)o.push(g.promise);else{let T;T=u.extensions&&u.extensions[ll.KHR_DRACO_MESH_COMPRESSION]?s(u):KW(new Qs,u,t),r[f]={primitive:u,promise:T},o.push(T)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,l=[];for(let d=0,u=o.length;d<u;d++){const f=void 0===o[d].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new W4({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[d].material);l.push(f)}var n;return l.push(t.loadGeometries(o)),Promise.all(l).then(function(d){const u=d.slice(0,d.length-1),f=d[d.length-1],g=[];for(let B=0,q=f.length;B<q;B++){const re=f[B],se=o[B];let ne;const De=u[B];if(se.mode===yA.TRIANGLES||se.mode===yA.TRIANGLE_STRIP||se.mode===yA.TRIANGLE_FAN||void 0===se.mode)ne=!0===s.isSkinnedMesh?new _Q(re,De):new Yo(re,De),!0===ne.isSkinnedMesh&&ne.normalizeSkinWeights(),se.mode===yA.TRIANGLE_STRIP?ne.geometry=QW(ne.geometry,1):se.mode===yA.TRIANGLE_FAN&&(ne.geometry=QW(ne.geometry,2));else if(se.mode===yA.LINES)ne=new hc(re,De);else if(se.mode===yA.LINE_STRIP)ne=new gg(re,De);else if(se.mode===yA.LINE_LOOP)ne=new IQ(re,De);else{if(se.mode!==yA.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+se.mode);ne=new $b(re,De)}Object.keys(ne.geometry.morphAttributes).length>0&&dye(ne,s),ne.name=t.createUniqueName(s.name||"mesh_"+e),Zy(ne,s),se.extensions&&lx(r,ne,se),t.assignFinalMaterial(ne),g.push(ne)}for(let B=0,q=g.length;B<q;B++)t.associations.set(g[B],{meshes:e,primitives:B});if(1===g.length)return s.extensions&&lx(r,g[0],s),g[0];const T=new $l;s.extensions&&lx(r,T,s),t.associations.set(T,{meshes:e});for(let B=0,q=g.length;B<q;B++)T.add(g[B]);return T})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new Mu(wE.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new bC(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Zy(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,l=[],d=[];for(let u=0,f=o.length;u<f;u++){const g=o[u];if(g){l.push(g);const T=new fo;null!==s&&T.fromArray(s.array,16*u),d.push(T)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new E4(l,d)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],l=[],d=[],u=[],f=[];for(let g=0,T=r.channels.length;g<T;g++){const B=r.channels[g],q=r.samplers[B.sampler],re=B.target,ne=void 0!==r.parameters?r.parameters[q.input]:q.input,De=void 0!==r.parameters?r.parameters[q.output]:q.output;void 0!==re.node&&(o.push(this.getDependency("node",re.node)),l.push(this.getDependency("accessor",ne)),d.push(this.getDependency("accessor",De)),u.push(q),f.push(re))}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(d),Promise.all(u),Promise.all(f)]).then(function(g){const T=g[0],B=g[1],q=g[2],re=g[3],se=g[4],ne=[];for(let De=0,Se=T.length;De<Se;De++){const je=T[De],Dt=B[De],Mt=q[De],Bt=re[De],Jt=se[De];if(void 0===je)continue;je.updateMatrix&&je.updateMatrix();const Vn=i._createAnimationTracks(je,Dt,Mt,Bt,Jt);if(Vn)for(let Tt=0;Tt<Vn.length;Tt++)ne.push(Vn[Tt])}return new GE(s,void 0,ne)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(l){if(l.isMesh)for(let d=0,u=r.weights.length;d<u;d++)l.morphTargetInfluences[d]=r.weights[d]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],l=r.children||[];for(let u=0,f=l.length;u<f;u++)o.push(i.getDependency("node",l[u]));const d=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),d]).then(function(u){const f=u[0],g=u[1],T=u[2];null!==T&&f.traverse(function(B){B.isSkinnedMesh&&B.bind(T,fye)});for(let B=0,q=g.length;B<q;B++)f.add(g[B]);return f})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",l=[],d=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return d&&l.push(d),void 0!==s.camera&&l.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){l.push(u)}),this.nodeCache[e]=Promise.all(l).then(function(u){let f;if(f=!0===s.isBone?new J5:u.length>1?new $l:1===u.length?u[0]:new Ol,f!==u[0])for(let g=0,T=u.length;g<T;g++)f.add(u[g]);if(s.name&&(f.userData.name=s.name,f.name=o),Zy(f,s),s.extensions&&lx(i,f,s),void 0!==s.matrix){const g=new fo;g.fromArray(s.matrix),f.applyMatrix4(g)}else void 0!==s.translation&&f.position.fromArray(s.translation),void 0!==s.rotation&&f.quaternion.fromArray(s.rotation),void 0!==s.scale&&f.scale.fromArray(s.scale);return r.associations.has(f)||r.associations.set(f,{}),r.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new $l;i.name&&(s.name=r.createUniqueName(i.name)),Zy(s,i),i.extensions&&lx(t,s,i);const o=i.nodes||[],l=[];for(let d=0,u=o.length;d<u;d++)l.push(r.getDependency("node",o[d]));return Promise.all(l).then(function(d){for(let f=0,g=d.length;f<g;f++)s.add(d[f]);return r.associations=(f=>{const g=new Map;for(const[T,B]of r.associations)(T instanceof ad||T instanceof $h)&&g.set(T,B);return f.traverse(T=>{const B=r.associations.get(T);null!=B&&g.set(T,B)}),g})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],l=e.name?e.name:e.uuid,d=[];let u;switch(Ky[s.path]===Ky.weights?e.traverse(function(T){T.morphTargetInfluences&&d.push(T.name?T.name:T.uuid)}):d.push(l),Ky[s.path]){case Ky.weights:u=NC;break;case Ky.rotation:u=ex;break;case Ky.position:case Ky.scale:u=zC;break;default:u=1===i.itemSize?NC:zC}const f=void 0!==r.interpolation?aye[r.interpolation]:Rb,g=this._getArrayFromAccessor(i);for(let T=0,B=d.length;T<B;T++){const q=new u(d[T]+"."+Ky[s.path],t.array,g,f);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(q),o.push(q)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=XO(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof ex?oye:$W)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function KW(n,e,t){const i=e.attributes,r=[];function s(o,l){return t.getDependency("accessor",o).then(function(d){n.setAttribute(l,d)})}for(const o in i){const l=WO[o]||o.toLowerCase();l in n.attributes||r.push(s(i[o],l))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});r.push(o)}return Hl.workingColorSpace!==Qu&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Hl.workingColorSpace}" not supported.`),Zy(n,e),function mye(n,e,t){const i=e.attributes,r=new Nf;if(void 0===i.POSITION)return;{const l=t.json.accessors[i.POSITION],d=l.min,u=l.max;if(void 0===d||void 0===u)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new Rt(d[0],d[1],d[2]),new Rt(u[0],u[1],u[2])),l.normalized){const f=XO(GC[l.componentType]);r.min.multiplyScalar(f),r.max.multiplyScalar(f)}}const s=e.targets;if(void 0!==s){const l=new Rt,d=new Rt;for(let u=0,f=s.length;u<f;u++){const g=s[u];if(void 0!==g.POSITION){const T=t.json.accessors[g.POSITION],B=T.min,q=T.max;if(void 0!==B&&void 0!==q){if(d.setX(Math.max(Math.abs(B[0]),Math.abs(q[0]))),d.setY(Math.max(Math.abs(B[1]),Math.abs(q[1]))),d.setZ(Math.max(Math.abs(B[2]),Math.abs(q[2]))),T.normalized){const re=XO(GC[T.componentType]);d.multiplyScalar(re)}l.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(l)}n.boundingBox=r;const o=new ju;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function cye(n,e,t){let i=!1,r=!1,s=!1;for(let u=0,f=e.length;u<f;u++){const g=e[u];if(void 0!==g.POSITION&&(i=!0),void 0!==g.NORMAL&&(r=!0),void 0!==g.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],l=[],d=[];for(let u=0,f=e.length;u<f;u++){const g=e[u];if(i){const T=void 0!==g.POSITION?t.getDependency("accessor",g.POSITION):n.attributes.position;o.push(T)}if(r){const T=void 0!==g.NORMAL?t.getDependency("accessor",g.NORMAL):n.attributes.normal;l.push(T)}if(s){const T=void 0!==g.COLOR_0?t.getDependency("accessor",g.COLOR_0):n.attributes.color;d.push(T)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(d)]).then(function(u){const g=u[1],T=u[2];return i&&(n.morphAttributes.position=u[0]),r&&(n.morphAttributes.normal=g),s&&(n.morphAttributes.color=T),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const YO=new WeakMap;class KO extends Kh{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new Sp(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},i,r)}parse(e,t,i=(()=>{})){this.decodeDracoFile(e,t,null,null,cu).catch(i)}decodeDracoFile(e,t,i,r,s=Qu,o=(()=>{})){return this.decodeGeometry(e,{attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s}).then(t).catch(o)}decodeGeometry(e,t){const i=JSON.stringify(t);if(YO.has(e)){const d=YO.get(e);if(d.key===i)return d.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,l=this._getWorker(s,e.byteLength).then(d=>(r=d,new Promise((u,f)=>{r._callbacks[s]={resolve:u,reject:f},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(d=>this._createGeometry(d.geometry));return l.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),YO.set(e,{key:i,promise:l}),l}_createGeometry(e){const t=new Qs;e.index&&t.setIndex(new To(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,d=new To(o,r.itemSize);"color"===s&&(this._assignVertexColorSpace(d,r.vertexColorSpace),d.normalized=!(o instanceof Float32Array)),t.setAttribute(s,d)}return t}_assignVertexColorSpace(e,t){if(t!==cu)return;const i=new fr;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new Sp(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Aye.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function Aye(){let n,e;function r(o,l,d,u,f,g){const T=g.num_components(),q=d.num_points()*T,re=q*f.BYTES_PER_ELEMENT,se=function s(o,l){switch(l){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,f),ne=o._malloc(re);l.GetAttributeDataArrayForAllPoints(d,g,se,re,ne);const De=new f(o.HEAPF32.buffer,ne,q).slice();return o._free(ne),{name:u,array:De,itemSize:T}}onmessage=function(o){const l=o.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(g){f({draco:g})},DracoDecoderModule(n)});break;case"decode":const d=l.buffer,u=l.taskConfig;e.then(f=>{const g=f.draco,T=new g.Decoder;try{const B=function t(o,l,d,u){const f=u.attributeIDs,g=u.attributeTypes;let T,B;const q=l.GetEncodedGeometryType(d);if(q===o.TRIANGULAR_MESH)T=new o.Mesh,B=l.DecodeArrayToMesh(d,d.byteLength,T);else{if(q!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");T=new o.PointCloud,B=l.DecodeArrayToPointCloud(d,d.byteLength,T)}if(!B.ok()||0===T.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+B.error_msg());const re={index:null,attributes:[]};for(const se in f){const ne=self[g[se]];let De,Se;if(u.useUniqueIDs)Se=f[se],De=l.GetAttributeByUniqueId(T,Se);else{if(Se=l.GetAttributeId(T,o[f[se]]),-1===Se)continue;De=l.GetAttribute(T,Se)}const je=r(o,l,T,se,ne,De);"color"===se&&(je.vertexColorSpace=u.vertexColorSpace),re.attributes.push(je)}return q===o.TRIANGULAR_MESH&&(re.index=function i(o,l,d){const f=3*d.num_faces(),g=4*f,T=o._malloc(g);l.GetTrianglesUInt32Array(d,g,T);const B=new Uint32Array(o.HEAPF32.buffer,T,f).slice();return o._free(T),{array:B,itemSize:1}}(o,l,T)),o.destroy(T),re}(g,T,new Int8Array(d),u),q=B.attributes.map(re=>re.array.buffer);B.index&&q.push(B.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:B},q)}catch(B){console.error(B),self.postMessage({type:"error",id:l.id,error:B.message})}finally{g.destroy(T)}})}}}class gye{constructor(e,t,i){this.clipPlanes=e,this.EVENT_DATA_ID=t,this.GEOMETRIES_ID=i}loadOBJGeometry(e,t,i,r,s){i=i??4302580;const o=new GW;return new Promise((l,d)=>{o.load(e,u=>{const f=this.processOBJ(u,t,i,r,s);l({object:f})},null,u=>{d(u)})})}parseOBJGeometry(e,t){const r=(new GW).parse(e);return this.processOBJ(r,t,4302580,!1,!1)}processOBJ(e,t,i,r,s){return e.name=t,e.userData={name:t},this.setObjFlat(e,i,r,s)}setObjFlat(e,t,i,r){const s=new _g({color:t,shininess:0,wireframe:!1,clippingPlanes:this.clipPlanes,clipIntersection:!0,clipShadows:!1,side:i?2:0,flatShading:r});return e.traverse(o=>{o instanceof Yo?(o.name=e.name,o.userData=e.userData,o.userData.size=this.getObjectSize(o),o.material instanceof ad&&(o.material.dispose(),o.material=s),o.castShadow=!1,o.receiveShadow=!1):o instanceof hc&&o.material instanceof wc&&o.material.color.set(t)}),e}parsePhnxScene(e,t){const i=new oB,r=new KO;r.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${Q2}.0/examples/jsm/libs/draco/`),i.setDRACOLoader(r);const s=JSON.stringify(e,null,2);return new Promise((o,l)=>{i.parse(s,"",d=>{const u=d.scene.getObjectByName(this.EVENT_DATA_ID),f=d.scene.getObjectByName(this.GEOMETRIES_ID);t(u,f),o()},d=>{l(d)})})}loadGLTFGeometry(e,t,i,r,s){const o=new oB,l=new KO;return l.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${Q2}.0/examples/jsm/libs/draco/`),o.setDRACOLoader(l),new Promise((d,u)=>{o.load(e,f=>{var g;const T=[];for(const B of f.scenes){B.visible=null!==(g=B.userData.visible)&&void 0!==g?g:s;const q=this.processGLTFSceneName(B.name,i),re={},se=(ne,De,Se)=>{const je=De.clone().multiply(ne.matrix);if(ne instanceof Yo){const Dt=ne.material.id;re[Dt]||(re[Dt]={material:ne.material,geoms:[],renderOrder:-Se}),re[Dt].geoms.push(ne.geometry.clone().applyMatrix4(je))}for(const Dt of ne.children)se(Dt,je,Se+1)};se(B,new fo,0),B.remove(...B.children);for(const ne of Object.values(re)){const De=new Yo(GO(ne.geoms),ne.material);De.renderOrder=ne.renderOrder,B.add(De)}this.processGeometry(B,t??q.name,r,!0),T.push({object:B,menuNodeName:i??q.menuNodeName})}d(T)},void 0,f=>{u(f)})})}parseGLTFGeometry(e,t){const i=new oB,r=new KO;return r.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${Q2}.0/examples/jsm/libs/draco/`),i.setDRACOLoader(r),new Promise((s,o)=>{i.parse(e,"",l=>{const d=[];for(const u of l.scenes){u.visible=u.userData.visible;const f=this.processGLTFSceneName(u.name);this.processGeometry(u,t??f.name),d.push({object:u})}s(d)},l=>{o(l)})})}processGLTFSceneName(e,t){if(e){const i=e.split("_>_");t&&i.unshift(t);const r=i.join(" > ");return i.pop(),{name:r,menuNodeName:i.join(" > ")}}}loadJSONGeometry(e,t,i,r){const s=new k_e;switch(typeof e){case"string":return new Promise((o,l)=>{s.load(e,d=>{this.processGeometry(d,t,i,r),o({object:d})},null,d=>{l(d)})});case"object":return new Promise(o=>{const l=s.parse(e);this.processGeometry(l,t,i,r),o({object:l})})}}processGeometry(e,t,i,r){e.name=t,i&&e.scale.setScalar(i),e.traverse(s=>{var o;if(s instanceof Yo&&(s.name=s.userData.name=t,s.userData.size=this.getObjectSize(s),s.material instanceof ad)){const l=s.material.color?s.material.color:3135121,d=r?2:s.material.side;s.material.dispose();let u=!1;e.userData.opacity&&(u=!0),s.material=new _g({color:l,shininess:0,side:d,transparent:u,opacity:null!==(o=e.userData.opacity)&&void 0!==o?o:1}),s.material.clippingPlanes=this.clipPlanes,s.material.clipIntersection=!0,s.material.clipShadows=!1}})}getObjectSize(e){var t,i;const r=new Rt;return e.geometry.computeBoundingBox(),null===(i=null===(t=e.geometry)||void 0===t?void 0:t.boundingBox)||void 0===i||i.getSize(r),JSON.stringify(r,null,2)}}let Jy=(()=>{class n{static getPrettySymbol(t){return Object.keys(n.symbols).find(r=>n.symbols[r].includes(t))||t}static getPrettyParams(t){const i=Object.assign({},t);for(const r of Object.keys(i)){const s=n.getPrettySymbol(r);s!==r&&(i[s]=i[r],delete i[r])}if(delete i.pos,i?.dparams){const r={};return r.\u03b8=i.dparams[3],r.\u03d5=i.dparams[2],r["|p|"]=Math.abs(1/i.dparams[4]),r.q=Math.sign(1/i.dparams[4]),r.d0=i.dparams[0],r.z0=i.dparams[1],delete i.dparams,Object.assign(Object.assign({},i),r)}return i}}return n.symbols={\u03b8:["theta"],\u03d5:["phi"],pT:["pt"],\u{1d6d8}2:["chi2"],\u03b7:["eta"],q:["charge"],NDOF:["ndof"],DOF:["dof"],Energy:["energy"],ET:["et"],"|p|":["momentum","mom"]},n})();class qC{constructor(e){this.value=e,this.callbacks=[]}update(e){this.value=e,this.callbacks.forEach(t=>t(e))}onUpdate(e){this.callbacks.push(e)}}class _ye{constructor(){this.activeObject=new qC(""),this.onTouchMove=e=>{const t=this.intersectObject(e);if(t){if(this.ignoreList.includes(t.type))return;this.outlinePass.selectedObjects=[t]}},this.onDocumentMouseDown=()=>{const e=this.outlinePass.selectedObjects[0];if(e){this.selectedObject.name=e.name,this.selectedObject.attributes.splice(0,this.selectedObject.attributes.length),this.activeObject.update(e.uuid);const t=Jy.getPrettyParams(e.userData);for(const s of Object.keys(t))this.selectedObject.attributes.push({attributeName:s,attributeValue:t[s]});const i=Object.keys(e.userData).map(s=>{if(["string","number"].includes(typeof e.userData[s]))return s+"="+e.userData[s]}).filter(s=>s),r=e.name+(i.length>0?" with "+i.join(", "):"");r&&this.infoLogger.add(r,"Clicked")}},this.onTouchDown=e=>{e.preventDefault(),this.onTouchMove(e.targetTouches[0]),this.onDocumentMouseDown()},this.isInit=!1,this.ignoreList=[(new $4).type,(new HC).type,(new EW).type]}init(e,t,i,r){this.camera=e,this.scene=t,this.isInit=!0,this.infoLogger=r,this.effectsManager=i,this.outlinePass=this.effectsManager.addOutlinePassForSelection()}setSelectedObject(e){this.selectedObject=e}getActiveObjectId(){return this.activeObject}setSelecting(e){this.isInit&&(e?this.enableSelecting():this.disableSelecting())}enableSelecting(){document.getElementById("three-canvas").addEventListener("mousemove",this.onTouchMove,!0),document.getElementById("three-canvas").addEventListener("click",this.onDocumentMouseDown,!0),document.getElementById("three-canvas").addEventListener("touchstart",this.onTouchDown),this.preSelectionAntialias=this.effectsManager.antialiasing,this.effectsManager.setAntialiasing(!1)}disableSelecting(){document.getElementById("three-canvas").removeEventListener("mousemove",this.onTouchMove,!0),document.getElementById("three-canvas").removeEventListener("click",this.onDocumentMouseDown,!0),document.getElementById("three-canvas").removeEventListener("touchstart",this.onTouchDown),this.outlinePass.selectedObjects=[],this.effectsManager.setAntialiasing(this.preSelectionAntialias)}intersectObject(e){var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const i=new Ni,r=this.effectsManager.composer.renderer.domElement;i.x=e.clientX/r.clientWidth*2-1,i.y=-e.clientY/r.clientHeight*2+1;const s=new mW;s.setFromCamera(i,this.camera),s.params.Line.threshold=3;const o=s.intersectObjects(this.scene.children,!0);if(o.length>0)return o[0].object}enableHighlighting(){this.preSelectionAntialias=this.effectsManager.antialiasing,this.effectsManager.setAntialiasing(!1)}highlightObject(e,t){const i=t.getObjectByProperty("uuid",e);i&&(this.outlinePass.selectedObjects=[i],this.activeObject.update(i.uuid))}disableHighlighting(){this.outlinePass.selectedObjects=[],this.effectsManager.setAntialiasing(this.preSelectionAntialias)}}class yye extends q4{constructor(e,t={}){const i=t.font;if(void 0===i)super();else{const r=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class ZW{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=function vye(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let l=0,d=0;for(let u=0;u<i.length;u++){const f=i[u];if("\n"===f)l=0,d-=s;else{const g=bye(f,r,l,d,t);l+=g.offsetX,o.push(g.path)}}return o}(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function bye(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");const o=new t1e;let l,d,u,f,g,T,B,q;if(s.o){const re=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let se=0,ne=re.length;se<ne;)switch(re[se++]){case"m":l=re[se++]*e+t,d=re[se++]*e+i,o.moveTo(l,d);break;case"l":l=re[se++]*e+t,d=re[se++]*e+i,o.lineTo(l,d);break;case"q":u=re[se++]*e+t,f=re[se++]*e+i,g=re[se++]*e+t,T=re[se++]*e+i,o.quadraticCurveTo(g,T,u,f);break;case"b":u=re[se++]*e+t,f=re[se++]*e+i,g=re[se++]*e+t,T=re[se++]*e+i,B=re[se++]*e+t,q=re[se++]*e+i,o.bezierCurveTo(g,T,B,q,u,f)}}return{offsetX:s.ha*e,path:o}}class Hf{static anglesAreSane(e,t){const i=-Math.PI<t&&Math.PI>t,r=0<e&&Math.PI>e;return i&&r}static etaToTheta(e){return 2*Math.atan(Math.pow(Math.E,-e))}static thetaToEta(e){return-Math.log(Math.tan(e/2))}static sphericalToCartesian(e,t,i){const r=new Rt;return r.setFromSphericalCoords(e,t,i),r.applyQuaternion(Hf.atlasQuaternion()),r}static etaPhiToCartesian(e,t,i){const r=new Rt;return r.setFromSphericalCoords(e,this.etaToTheta(t),i),r.applyQuaternion(Hf.atlasQuaternion()),r}static atlasQuaternion(){const e=new Rt(0,1,0),t=new Rt(0,0,1),i=new zc;i.setFromUnitVectors(e,t);const r=new zc;return r.setFromAxisAngle(new Rt(0,1,0),Math.PI/2),i.multiply(r),i}}const xye=JSON.parse('{"glyphs":{"0":{"x_min":73,"x_max":715,"ha":792,"o":"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},"1":{"x_min":215.671875,"x_max":574,"ha":792,"o":"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},"2":{"x_min":59,"x_max":731,"ha":792,"o":"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},"3":{"x_min":54,"x_max":737,"ha":792,"o":"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},"4":{"x_min":48,"x_max":742.453125,"ha":792,"o":"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},"5":{"x_min":54.171875,"x_max":738,"ha":792,"o":"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},"6":{"x_min":53,"x_max":739,"ha":792,"o":"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},"7":{"x_min":58.71875,"x_max":730.953125,"ha":792,"o":"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},"8":{"x_min":55,"x_max":736,"ha":792,"o":"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},"9":{"x_min":53,"x_max":739,"ha":792,"o":"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},"\u03bf":{"x_min":0,"x_max":712,"ha":815,"o":"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},"S":{"x_min":0,"x_max":788,"ha":890,"o":"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{"x_min":343,"x_max":449,"ha":792,"o":"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{"x_min":183.25,"x_max":608.328125,"ha":792,"o":"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},"\u03a4":{"x_min":-0.4375,"x_max":777.453125,"ha":839,"o":"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},"y":{"x_min":0,"x_max":684.78125,"ha":771,"o":"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},"\u03a0":{"x_min":0,"x_max":803,"ha":917,"o":"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},"\u0390":{"x_min":-111,"x_max":339,"ha":361,"o":"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},"g":{"x_min":0,"x_max":686,"ha":838,"o":"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{"x_min":0,"x_max":442,"ha":539,"o":"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},"\u039a":{"x_min":0,"x_max":819.5625,"ha":893,"o":"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},"\u0192":{"x_min":-46.265625,"x_max":392,"ha":513,"o":"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},"e":{"x_min":0,"x_max":714,"ha":813,"o":"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},"\u03cc":{"x_min":0,"x_max":712,"ha":815,"o":"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},"J":{"x_min":0,"x_max":588,"ha":699,"o":"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{"x_min":-1,"x_max":503,"ha":601,"o":"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{"x_min":-3,"x_max":1008,"ha":1106,"o":"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},"\u03ce":{"x_min":0,"x_max":922,"ha":1030,"o":"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{"x_min":193.0625,"x_max":598.609375,"ha":792,"o":"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{"x_min":0,"x_max":507.203125,"ha":604,"o":"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},"D":{"x_min":0,"x_max":828,"ha":935,"o":"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\xff":{"x_min":0,"x_max":47,"ha":125,"o":"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},"w":{"x_min":0,"x_max":1009.71875,"ha":1100,"o":"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},"$":{"x_min":0,"x_max":700,"ha":793,"o":"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\\\":{"x_min":-0.015625,"x_max":425.0625,"ha":522,"o":"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},"\xb5":{"x_min":0,"x_max":697.21875,"ha":747,"o":"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},"\u0399":{"x_min":42,"x_max":181,"ha":297,"o":"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},"\u038e":{"x_min":0,"x_max":1144.5,"ha":1214,"o":"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{"x_min":0,"x_max":139,"ha":236,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\u039d":{"x_min":0,"x_max":801,"ha":915,"o":"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{"x_min":8.71875,"x_max":350.390625,"ha":478,"o":"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},"Q":{"x_min":0,"x_max":968,"ha":1072,"o":"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},"\u03c2":{"x_min":1,"x_max":676.28125,"ha":740,"o":"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},"M":{"x_min":0,"x_max":954,"ha":1067,"o":"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},"\u03a8":{"x_min":0,"x_max":1006,"ha":1094,"o":"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},"C":{"x_min":0,"x_max":886,"ha":944,"o":"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{"x_min":0,"x_max":138,"ha":236,"o":"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{"x_min":0,"x_max":480.5625,"ha":578,"o":"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},"X":{"x_min":-0.015625,"x_max":854.15625,"ha":940,"o":"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{"x_min":0,"x_max":963.890625,"ha":1061,"o":"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},"\u03b9":{"x_min":42,"x_max":284,"ha":361,"o":"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},"\u0386":{"x_min":0,"x_max":906.953125,"ha":982,"o":"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{"x_min":0,"x_max":318,"ha":415,"o":"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},"\u03b5":{"x_min":0,"x_max":634.71875,"ha":714,"o":"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},"\u0394":{"x_min":0,"x_max":952.78125,"ha":1028,"o":"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{"x_min":0,"x_max":481,"ha":578,"o":"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{"x_min":-3,"x_max":1672,"ha":1821,"o":"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},"a":{"x_min":0,"x_max":698.609375,"ha":794,"o":"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{"x_min":0,"x_max":941.671875,"ha":1039,"o":"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{"x_min":8.71875,"x_max":780.953125,"ha":792,"o":"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},"N":{"x_min":0,"x_max":801,"ha":914,"o":"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},"\u03c1":{"x_min":0,"x_max":712,"ha":797,"o":"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{"x_min":0,"x_max":941.671875,"ha":938,"o":"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},"Z":{"x_min":0,"x_max":779,"ha":849,"o":"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},"u":{"x_min":0,"x_max":617,"ha":729,"o":"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},"k":{"x_min":0,"x_max":612.484375,"ha":697,"o":"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},"\u0397":{"x_min":0,"x_max":803,"ha":917,"o":"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u0391":{"x_min":0,"x_max":906.953125,"ha":985,"o":"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},"s":{"x_min":0,"x_max":604,"ha":697,"o":"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},"B":{"x_min":0,"x_max":778,"ha":876,"o":"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{"x_min":0,"x_max":614,"ha":708,"o":"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{"x_min":0,"x_max":607,"ha":704,"o":"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},"H":{"x_min":0,"x_max":803,"ha":915,"o":"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u03bd":{"x_min":0,"x_max":675,"ha":761,"o":"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},"c":{"x_min":1,"x_max":701.390625,"ha":775,"o":"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{"x_min":0,"x_max":566.671875,"ha":678,"o":"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},"\u03b2":{"x_min":0,"x_max":660,"ha":745,"o":"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},"\u039c":{"x_min":0,"x_max":954,"ha":1068,"o":"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},"\u038c":{"x_min":0.109375,"x_max":1120,"ha":1217,"o":"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u0389":{"x_min":0,"x_max":1158,"ha":1275,"o":"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{"x_min":0,"x_max":663.890625,"ha":775,"o":"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{"x_min":0.1875,"x_max":819.546875,"ha":886,"o":"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{"x_min":0,"x_max":318.0625,"ha":415,"o":"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},"U":{"x_min":0,"x_max":796,"ha":904,"o":"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},"\u03b3":{"x_min":0.5,"x_max":744.953125,"ha":822,"o":"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},"\u03b1":{"x_min":0,"x_max":765.5625,"ha":809,"o":"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},"F":{"x_min":0,"x_max":683.328125,"ha":717,"o":"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03a7":{"x_min":0,"x_max":854.171875,"ha":935,"o":"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{"x_min":116,"x_max":674,"ha":792,"o":"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{"x_min":0,"x_max":777,"ha":835,"o":"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{"x_min":0,"x_max":347,"ha":444,"o":"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},"V":{"x_min":0,"x_max":862.71875,"ha":940,"o":"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},"\u039e":{"x_min":0,"x_max":734.71875,"ha":763,"o":"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{"x_min":0,"x_max":0,"ha":853},"\u03ab":{"x_min":0.328125,"x_max":819.515625,"ha":889,"o":"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{"x_min":0,"x_max":347,"ha":454,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{"x_min":0,"x_max":1260,"ha":1357,"o":"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},"\u038a":{"x_min":0,"x_max":499,"ha":613,"o":"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},"i":{"x_min":14,"x_max":136,"ha":275,"o":"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},"\u0392":{"x_min":0,"x_max":778,"ha":877,"o":"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},"\u03c5":{"x_min":0,"x_max":617,"ha":725,"o":"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{"x_min":0,"x_max":275,"ha":372,"o":"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},"m":{"x_min":0,"x_max":1019,"ha":1128,"o":"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},"\u03c7":{"x_min":8.328125,"x_max":780.5625,"ha":815,"o":"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},"\u03af":{"x_min":42,"x_max":326.71875,"ha":361,"o":"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},"\u0396":{"x_min":0,"x_max":779.171875,"ha":850,"o":"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},"R":{"x_min":0,"x_max":781.953125,"ha":907,"o":"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},"o":{"x_min":0,"x_max":713,"ha":821,"o":"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},"K":{"x_min":0,"x_max":819.46875,"ha":906,"o":"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},"d":{"x_min":0,"x_max":683,"ha":796,"o":"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{"x_min":-109,"x_max":247,"ha":232,"o":"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},"E":{"x_min":0,"x_max":736.109375,"ha":789,"o":"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"Y":{"x_min":0,"x_max":820,"ha":886,"o":"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},"\\"":{"x_min":0,"x_max":299,"ha":396,"o":"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{"x_min":17.984375,"x_max":773.609375,"ha":792,"o":"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{"x_min":0,"x_max":364,"ha":467,"o":"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},"\u03b4":{"x_min":1,"x_max":710,"ha":810,"o":"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},"\u03ad":{"x_min":0,"x_max":634.71875,"ha":714,"o":"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},"\u03c9":{"x_min":0,"x_max":922,"ha":1031,"o":"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{"x_min":0,"x_max":96,"ha":251,"o":"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{"x_min":11,"x_max":781,"ha":792,"o":"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{"x_min":343,"x_max":449,"ha":792,"o":"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"\u03cb":{"x_min":0,"x_max":617,"ha":725,"o":"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{"x_min":0,"x_max":593,"ha":690,"o":"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},"b":{"x_min":0,"x_max":685,"ha":783,"o":"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},"q":{"x_min":0,"x_max":683,"ha":876,"o":"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},"\u03a9":{"x_min":-0.171875,"x_max":969.5625,"ha":1068,"o":"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},"\u03cd":{"x_min":0,"x_max":617,"ha":725,"o":"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},"z":{"x_min":-0.015625,"x_max":613.890625,"ha":697,"o":"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{"x_min":0,"x_max":894,"ha":1000,"o":"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},"\u03ae":{"x_min":0.78125,"x_max":697,"ha":810,"o":"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},"\u0398":{"x_min":0,"x_max":960,"ha":1056,"o":"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{"x_min":-3,"x_max":1008,"ha":1106,"o":"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{"x_min":0,"x_max":833,"ha":931,"o":"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},"\u0395":{"x_min":0,"x_max":736.21875,"ha":778,"o":"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{"x_min":0,"x_max":450,"ha":547,"o":"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{"x_min":0,"x_max":273.609375,"ha":371,"o":"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},"L":{"x_min":0,"x_max":645.828125,"ha":696,"o":"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},"\u03c3":{"x_min":0,"x_max":803.390625,"ha":894,"o":"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},"\u03b6":{"x_min":0,"x_max":573,"ha":642,"o":"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},"\u03b8":{"x_min":0,"x_max":674,"ha":778,"o":"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},"\u039f":{"x_min":0,"x_max":958,"ha":1054,"o":"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},"\u0393":{"x_min":0,"x_max":705.28125,"ha":749,"o":"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{"x_min":0,"x_max":0,"ha":375},"%":{"x_min":-3,"x_max":1089,"ha":1186,"o":"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},"P":{"x_min":0,"x_max":726,"ha":806,"o":"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},"\u0388":{"x_min":0,"x_max":1078.21875,"ha":1118,"o":"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u038f":{"x_min":0.125,"x_max":1136.546875,"ha":1235,"o":"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},"_":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},"\u03aa":{"x_min":-110,"x_max":246,"ha":275,"o":"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{"x_min":23,"x_max":768,"ha":792,"o":"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{"x_min":0,"x_max":1050,"ha":1149,"o":"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},"\u03a1":{"x_min":0,"x_max":720,"ha":783,"o":"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"\'":{"x_min":0,"x_max":139,"ha":236,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\xaa":{"x_min":0,"x_max":350,"ha":397,"o":"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{"x_min":0,"x_max":450,"ha":553,"o":"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},"T":{"x_min":0,"x_max":777,"ha":835,"o":"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},"\u03a6":{"x_min":0,"x_max":915,"ha":997,"o":"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{"x_min":0,"x_max":0,"ha":694},"j":{"x_min":-77.78125,"x_max":167,"ha":349,"o":"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},"\u03a3":{"x_min":0,"x_max":756.953125,"ha":819,"o":"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{"x_min":18.0625,"x_max":774,"ha":792,"o":"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{"x_min":17.984375,"x_max":773.609375,"ha":792,"o":"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{"x_min":0,"x_max":704.484375,"ha":801,"o":"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},"t":{"x_min":0,"x_max":367,"ha":458,"o":"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{"x_min":0,"x_max":706,"ha":803,"o":"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},"\u03bb":{"x_min":0,"x_max":750,"ha":803,"o":"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},"W":{"x_min":0,"x_max":1263.890625,"ha":1351,"o":"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{"x_min":18.0625,"x_max":774,"ha":792,"o":"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"v":{"x_min":0,"x_max":675.15625,"ha":761,"o":"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},"\u03c4":{"x_min":0.28125,"x_max":644.5,"ha":703,"o":"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},"\u03be":{"x_min":0,"x_max":624.9375,"ha":699,"o":"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{"x_min":-3,"x_max":894.25,"ha":992,"o":"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},"\u039b":{"x_min":0,"x_max":862.5,"ha":942,"o":"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},"I":{"x_min":41,"x_max":180,"ha":293,"o":"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},"G":{"x_min":0,"x_max":921,"ha":1011,"o":"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},"\u03b0":{"x_min":0,"x_max":617,"ha":725,"o":"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{"x_min":0,"x_max":138.890625,"ha":236,"o":"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\u03a5":{"x_min":0.328125,"x_max":819.515625,"ha":889,"o":"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},"r":{"x_min":0,"x_max":355.5625,"ha":432,"o":"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},"x":{"x_min":0,"x_max":675,"ha":764,"o":"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},"\u03bc":{"x_min":0,"x_max":696.609375,"ha":747,"o":"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},"h":{"x_min":0,"x_max":615,"ha":724,"o":"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03c6":{"x_min":-2,"x_max":878,"ha":974,"o":"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},"f":{"x_min":0,"x_max":378,"ha":472,"o":"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{"x_min":1,"x_max":348.21875,"ha":454,"o":"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},"A":{"x_min":0.03125,"x_max":906.953125,"ha":1008,"o":"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{"x_min":1,"x_max":139.890625,"ha":236,"o":"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},"\u03ca":{"x_min":-70,"x_max":283,"ha":361,"o":"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},"\u03c0":{"x_min":-0.21875,"x_max":773.21875,"ha":857,"o":"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},"\u03ac":{"x_min":0,"x_max":765.5625,"ha":809,"o":"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},"O":{"x_min":0,"x_max":958,"ha":1057,"o":"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},"n":{"x_min":0,"x_max":615,"ha":724,"o":"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},"l":{"x_min":41,"x_max":166,"ha":279,"o":"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{"x_min":40.09375,"x_max":728.796875,"ha":825,"o":"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},"\u03ba":{"x_min":0,"x_max":632.328125,"ha":679,"o":"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},"p":{"x_min":0,"x_max":685,"ha":786,"o":"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{"x_min":0,"x_max":777,"ha":835,"o":"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},"\u03c8":{"x_min":0,"x_max":808,"ha":907,"o":"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},"\u03b7":{"x_min":0.78125,"x_max":697,"ha":810,"o":"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},"cssFontWeight":"normal","ascender":1189,"underlinePosition":-100,"cssFontStyle":"normal","boundingBox":{"yMin":-334,"xMin":-111,"yMax":1189,"xMax":1672},"resolution":1000,"original_font_information":{"postscript_name":"Helvetiker-Regular","version_string":"Version 1.00 2004 initial release","vendor_url":"http://www.magenta.gr/","full_font_name":"Helvetiker","font_family_name":"Helvetiker","copyright":"Copyright (c) \u039cagenta ltd, 2004","description":"","trademark":"","designer":"","designer_url":"","unique_font_identifier":"\u039cagenta ltd:Helvetiker:22-10-104","license_url":"http://www.ellak.gr/fonts/MgOpen/license.html","license_description":"Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\\r\\n\\r\\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license (\\"Fonts\\") and associated documentation files (the \\"Font Software\\"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \\r\\n\\r\\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\\r\\n\\r\\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word \\"MgOpen\\", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\\r\\n\\r\\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the \\"MgOpen\\" name.\\r\\n\\r\\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \\r\\n\\r\\nTHE FONT SOFTWARE IS PROVIDED \\"AS IS\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.","manufacturer_name":"\u039cagenta ltd","font_sub_family_name":"Regular"},"descender":-334,"familyName":"Helvetiker","lineHeight":1522,"underlineThickness":50}');let il=(()=>{class n{constructor(t,i=!0){this.cartesianGridConfig={showXY:!0,showYZ:!0,showZX:!0,xDistance:0,yDistance:0,zDistance:0,sparsity:2},this.useCameraLight=!0,this.textFont=new ZW(xye),this.labelTextLookCallbacks={},this.axesNumbers=[],this.getScene(),this.ignoreList=t,this.axis=null,this.setLights(i)}setLights(t=!0){this.useCameraLight=t;const i=new $4(16777215,1.2);this.scene.add(i),this.useCameraLight?(this.cameraLight=new HC(16777215,.9),this.cameraLight.position.set(0,0,10),this.scene.add(this.cameraLight)):[[-100,-50,100],[100,50,-100],[-100,50,-100],[100,-50,100]].forEach(r=>{const s=new HC(16777215,.2);s.position.set(r[0],r[1],r[2]),this.scene.add(s)})}updateLights(t){this.useCameraLight&&this.cameraLight.position.copy(t.position)}getScene(){return this.scene||(this.scene=new IE),this.scene}getCleanScene(){const t=this.scene.clone(),i=[];return t.traverse(r=>{this.ignoreList.includes(r.type)&&i.push(r)}),t.remove(...i),t}setGeometryOpacity(t,i){i&&t&&t.traverse(r=>{r?.material&&(r.material.transparent=!0,r.material.opacity=i)})}changeObjectColor(t,i){t&&t.traverse(r=>{(r instanceof Yo||r instanceof hc)&&(r.material instanceof _g||r.material instanceof yd||r.material instanceof wc)&&r.material.color.set(i)})}objectVisibility(t,i){t&&(t.visible=i,t.traverse(r=>{i?(r.layers.enable(0),r.layers.disable(1)):(r.layers.disable(0),r.layers.enable(1))}))}getObjectPosition(t){var i;return null===(i=this.scene.getObjectByName(t))||void 0===i?void 0:i.position}removeGeometry(t){this.getGeometries().remove(t)}removeLabel(t){const i=this.scene.getObjectByName(t);this.getObjectsGroup(n.LABELS_ID).remove(i)}scaleObject(t,i){t.scale.setScalar(i)}addEventDataTypeGroup(t){const i=this.getEventData();let r=this.scene.getObjectByName(t);return r||(r=new $l),r.name=t,i.add(r),r}collectionFilter(t,i){const r=this.getScene().getObjectByName(n.EVENT_DATA_ID).getObjectByName(t);for(const s of Object.values(r.children))if(s.userData)for(const o of i){const l=s.userData[o.field];if(l){if(!o.cutPassed(l)){s.visible=!1;break}s.visible=!0}}}groupVisibility(t,i,r){const o=(r?this.scene.getObjectByName(r):this.scene).getObjectByName(t);for(const l of Object.values(o.children))l.visible=i}getObjectsGroup(t){let i=this.scene.getObjectByName(t);return null==i&&(i=new $l,i.name=t,this.scene.add(i)),i}getEventData(){return this.getObjectsGroup(n.EVENT_DATA_ID)}getGeometries(){return this.getObjectsGroup(n.GEOMETRIES_ID)}clearEventData(){const t=this.getEventData();null!=t&&this.scene.remove(t),this.getEventData()}getText(t,i){const r=new yye(t,{font:this.textFont,size:60,curveSegments:1,height:1});return new Yo(r,new yd({color:new fr(i)}))}setAxis(t,i=2e3,r=!0){if(null==this.axis){this.axis=new $l;const s=new fr(14037811),o=new fr(3397171),l=new fr(3355606),d=new wc({color:s}),u=new wc({color:o}),f=new wc({color:l});let g=[new Rt(-i,0,0),new Rt(i,0,0)],T=(new Qs).setFromPoints(g);const B=new hc(T,d);this.axis.add(B),g=[new Rt(0,-i,0),new Rt(0,i,0)],T=(new Qs).setFromPoints(g);const q=new hc(T,u);this.axis.add(q),g=[new Rt(0,0,-i),new Rt(0,0,i)],T=(new Qs).setFromPoints(g);const re=new hc(T,f);this.axis.add(re),this.axis.name="gridline",this.axis.traverse(se=>se.name="gridline"),this.scene.add(this.axis)}if(this.axis.visible=t,r&&null==this.axisLabels){this.axisLabels=new $l;const s=["X [cm]","Y [cm]","Z [cm]"],o=[16711680,65280,255];let l=0;for(const d of s){const u=this.getText(d,new fr(o[l++]));this.axisLabels.add(u)}this.axisLabels.children[0].position.set(i+200,0,0),this.axisLabels.children[1].position.set(0,i+200,0),this.axisLabels.children[2].position.set(0,0,i+200),this.axisLabels.name="XYZ Labels",this.axisLabels.traverse(d=>d.name="XYZ Labels"),this.scene.add(this.axisLabels)}this.axisLabels.visible=t}createCartesianGrid(t=3e3){if(null==this.cartesianGrid){this.cartesianGrid=new $l;const i=new fr(14037811),r=new fr(3397171),s=new fr(3355606),o=new Zb({color:i,dashSize:.5,gapSize:.1,scale:.01}),l=new Zb({color:r,dashSize:.5,gapSize:.1,scale:.01}),d=new Zb({color:s,dashSize:.5,gapSize:.1,scale:.01});let u=new $l;for(let T=-t;T<=t;T+=.1*t){u=new $l;let B=[];for(let ne=-t;ne<=t;ne+=.1*t)B.push(new Rt(-t,ne,T)),B.push(new Rt(t,ne,T));let q=(new Qs).setFromPoints(B);const re=d;let se=new hc(q,re);se.computeLineDistances(),u.add(se),B=[];for(let ne=-t;ne<=t;ne+=.1*t)B.push(new Rt(ne,-t,T)),B.push(new Rt(ne,t,T));q=(new Qs).setFromPoints(B),se=new hc(q,re),se.computeLineDistances(),u.add(se),this.cartesianGrid.add(u)}let f=new $l;for(let T=-t;T<=t;T+=.1*t){f=new $l;let B=[];for(let ne=-t;ne<=t;ne+=.1*t)B.push(new Rt(T,ne,-t)),B.push(new Rt(T,ne,t));let q=(new Qs).setFromPoints(B);const re=o;let se=new hc(q,re);se.computeLineDistances(),f.add(se),B=[];for(let ne=-t;ne<=t;ne+=.1*t)B.push(new Rt(T,-t,ne)),B.push(new Rt(T,t,ne));q=(new Qs).setFromPoints(B),se=new hc(q,re),se.computeLineDistances(),f.add(se),this.cartesianGrid.add(f)}let g=new $l;for(let T=-t;T<=t;T+=.1*t){g=new $l;let B=[];for(let ne=-t;ne<=t;ne+=.1*t)B.push(new Rt(ne,T,-t)),B.push(new Rt(ne,T,t));let q=(new Qs).setFromPoints(B);const re=l;let se=new hc(q,re);se.computeLineDistances(),g.add(se),B=[];for(let ne=-t;ne<=t;ne+=.1*t)B.push(new Rt(-t,T,ne)),B.push(new Rt(t,T,ne));q=(new Qs).setFromPoints(B),se=new hc(q,re),se.computeLineDistances(),g.add(se),this.cartesianGrid.add(g)}this.cartesianGrid.name="gridline",this.cartesianGrid.traverse(T=>T.name="gridline"),this.cartesianGrid.children.forEach(T=>T.visible=!1),this.scene.add(this.cartesianGrid)}}setCartesianGrid(t,i,r){this.createCartesianGrid(i);for(let d=0;d<=62;d+=1)this.cartesianGrid.children[d].visible=!1;typeof r>"u"?r=this.cartesianGridConfig:this.cartesianGridConfig=r;const s=[10,31,52],o=[r.zDistance,r.xDistance,r.yDistance],l=[r.showXY,r.showYZ,r.showZX];if(t)for(let d=0;d<3;d+=1)if(l[d]){for(let u=s[d];u>=s[d]-10*o[d]/i;u-=r.sparsity)this.cartesianGrid.children[u].visible=t;for(let u=s[d];u<=s[d]+10*o[d]/i;u+=r.sparsity)this.cartesianGrid.children[u].visible=t}}getCartesianGridConfig(){return this.cartesianGridConfig}eventDataDepthTest(t){const i=this.getEventData();null!==i&&i.traverse(r=>{r.material&&(r.renderOrder=t?0:999,r.material.depthTest=t)})}wireframeGeometries(t){this.getGeometries().traverse(r=>{r.material&&(r.material.wireframe=t,t?(r.material.transparent=!0,r.material.opacity=.1):(r.material.transparent=!1,r.material.opacity=1))})}wireframeObjects(t,i){t.traverse(r=>{r.material&&(r.material.wireframe=i)})}scaleJets(t){t<=0||this.scene.getObjectByName("Jets").traverse(r=>{if("Jet"===r.name){const s=r.scale.x;r.scale.setScalar(t),r.position.divideScalar(s).multiplyScalar(t)}})}scaleChildObjects(t,i,r){this.scene.getObjectByName(t).traverse(o=>{0===o.children.length&&(r?o.scale[r]=i:o.scale.setScalar(i))})}addLabelToObject(t,i,r,s,o){this.scene.getObjectByProperty("uuid",i).userData.label=t;const d=this.getObjectsGroup(n.LABELS_ID),u=this.scene.getObjectByName(r);u&&d.remove(u);const f=this.getText(t,new fr("#a8a8a8"));f.position.fromArray(s.toArray()),f.name=r,d.add(f),o.removeEventListener("change",this.labelTextLookCallbacks[i]),this.labelTextLookCallbacks[i]=()=>{f.lookAt(o.object.position)},this.labelTextLookCallbacks[i](),o.addEventListener("change",this.labelTextLookCallbacks[i])}translateCartesianGrid(t){this.createCartesianGrid();const i=t.length(),r=t.normalize();this.cartesianGrid.translateOnAxis(r,i)}translateCartesianLabels(t){this.createCartesianLabels();const i=t.length(),r=t.normalize();this.cartesianLabels.translateOnAxis(r,i),this.axis.translateOnAxis(r,i),this.axisLabels.translateOnAxis(r,i)}createCartesianLabels(t=3e3){if(null==this.cartesianLabels){this.cartesianLabels=new $l,this.cartesianLabels.name="XYZ Labels";const i=new fr(14037811),r=new fr(3397171),s=new fr(3355606),o=new yd({color:i,side:2}),l=new yd({color:r,side:2}),d=new yd({color:s,side:2});for(let u=-t;u<=t;u+=.1*t){const f=this.getText((u/10).toString(),i);f.position.set(u,40,0),this.axesNumbers.push(f),this.cartesianLabels.add(f);const g=new Mp(10,30,10);g.translate(u,0,0);const T=new Yo(g,o);this.cartesianLabels.add(T)}for(let u=-t;u<=t;u+=.1*t){const f=this.getText((u/10).toString(),r);f.position.set(-40,u,0),this.axesNumbers.push(f),this.cartesianLabels.add(f);const g=new Mp(30,10,10);g.translate(0,u,0);const T=new Yo(g,l);this.cartesianLabels.add(T)}for(let u=-t;u<=t;u+=.1*t){const f=this.getText((u/10).toString(),s);f.position.set(-40,0,u),this.axesNumbers.push(f),this.cartesianLabels.add(f);const g=new Mp(30,10,10);g.translate(0,0,u);const T=new Yo(g,d);this.cartesianLabels.add(T)}this.cartesianLabels.traverse(u=>u.name="XYZ Labels"),this.scene.add(this.cartesianLabels),this.cartesianLabels.children.forEach(u=>u.visible=!1),this.setAxis(!1,3e3)}}alignText(t){null!=this.cartesianLabels&&this.axesNumbers.forEach(i=>{i.lookAt(t.position)}),null!=this.axisLabels&&this.axisLabels.children.forEach(i=>i.lookAt(t.position))}showLabels(t){this.createCartesianLabels(),this.setAxis(t,3e3),this.cartesianLabels.children.forEach(i=>i.visible=t)}setEtaPhiGrid(t,i=3e3){if(null==this.etaPhiGrid){this.etaPhiGrid=new $l;let r=[];const s=i,o=new fr(255);for(let De=-3;De<=3;De+=1){r.push(new Rt(0,0,0));const Se=Hf.etaPhiToCartesian(s,De,Math.PI/2),je=this.getText("\u03b7="+De.toPrecision(2),o);je.position.set(Se.x,Se.y,Se.z),je.rotateOnWorldAxis(new Rt(0,1,0),Math.PI/2),this.etaPhiGrid.add(je),r.push(Se)}const l=(new Qs).setFromPoints(r),d=new Zb({color:o,dashSize:2,gapSize:1,scale:.01}),u=new hc(l,d);u.computeLineDistances();const f=2*Math.PI/8,g=["-\u03c0","-3\u03c0/4","-\u03c0/2,","-\u03c0/4","0","\u03c0/4","\u03c0/2,","3\u03c0/4"];let T=0;const B=new fr(16711680);r=[];const q=.9*s;for(let De=-Math.PI;De<Math.PI;De+=f){r.push(new Rt(0,0,0));const Se=Hf.etaPhiToCartesian(q,0,De),je=this.getText("\u03c6="+g[T++],B);je.position.set(Se.x,Se.y,Se.z),this.etaPhiGrid.add(je),r.push(Se)}const re=(new Qs).setFromPoints(r),se=new Zb({color:B,dashSize:1,gapSize:1,scale:.01}),ne=new hc(re,se);ne.computeLineDistances(),this.etaPhiGrid.add(u),this.etaPhiGrid.add(ne),this.etaPhiGrid.name="gridline",this.etaPhiGrid.traverse(De=>De.name="gridline"),this.scene.add(this.etaPhiGrid)}this.etaPhiGrid.visible=t}getObjectByName(t){return this.scene.getObjectByName(t)}}return n.EVENT_DATA_ID="EventData",n.GEOMETRIES_ID="Geometries",n.LABELS_ID="Labels",n})();class JW extends Qs{constructor(){super(),this.type="TracksMesh",this.positions=[],this.previous=[],this.next=[],this.side=[],this.counter=[],this.track_id=[],this.colors=[],this.indices_array=[],this.next_track_id=0}addTrack(e,t){const i=this.next_track_id++,r=new fr(t);this.previous.push(e[0].x,e[0].y,e[0].z),this.previous.push(e[0].x,e[0].y,e[0].z);for(let o=0;o<e.length;o++){const l=e[o],d=this.positions.length/3;this.positions.push(l.x,l.y,l.z),this.positions.push(l.x,l.y,l.z),this.side.push(1,-1),this.track_id.push(i,i),this.colors.push(r.r,r.g,r.b),this.colors.push(r.r,r.g,r.b),this.counter.push(o/e.length,o/e.length),o<e.length-1?(this.previous.push(l.x,l.y,l.z),this.previous.push(l.x,l.y,l.z),this.indices_array.push(d,d+1,d+2),this.indices_array.push(d+2,d+1,d+3)):o>0&&(this.next.push(l.x,l.y,l.z),this.next.push(l.x,l.y,l.z))}const s=e.length-1;return this.next.push(e[s].x,e[s].y,e[s].z),this.next.push(e[s].x,e[s].y,e[s].z),i}process(){this._attributes&&this._attributes.position.count===this.positions.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.track_id.copyArray(new Int32Array(this.track_id)),this._attributes.track_id.needsUpdate=!0,this._attributes.color.copyArray(new Float32Array(this.colors)),this._attributes.color.needsUpdate=!0,this._attributes.counter.copyArray(new Float32Array(this.counter)),this._attributes.counter.needsUpdate=!0,this._attributes.index.copyArray(new Uint32Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new To(new Float32Array(this.positions),3),previous:new To(new Float32Array(this.previous),3),next:new To(new Float32Array(this.next),3),side:new To(new Float32Array(this.side),1),track_id:new To(new Int32Array(this.track_id),1),color:new To(new Float32Array(this.colors),3),counter:new To(new Float32Array(this.counter),1),index:new To(new Uint32Array(this.indices_array),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("track_id",this._attributes.track_id),this.setAttribute("color",this._attributes.color),this.setAttribute("counter",this._attributes.counter),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}}pa.tracks_vert=["attribute vec3 previous;","attribute vec3 next;","attribute int track_id;","attribute float side;","attribute vec3 color;","attribute float counter;","varying vec3 v_color;","varying float v_counter;","flat varying int v_track_id;","uniform vec2 resolution;","uniform float lineWidth;","void main() {","  vec2 aspect = vec2(resolution.x / resolution.y, 1.0);","","  v_color = color;","  v_counter = counter;","  v_track_id = track_id;","","  mat4 m = projectionMatrix * modelViewMatrix;","  vec4 finalPosition = m * vec4(position, 1.0);","  vec4 prevPos = m * vec4(previous, 1.0);","  vec4 nextPos = m * vec4(next, 1.0);","","  vec2 curP = finalPosition.xy / finalPosition.w * aspect;","  vec2 prevP = prevPos.xy / prevPos.w * aspect;","  vec2 nextP = nextPos.xy / nextPos.w * aspect;","","  vec2 dir;","  if (curP == prevP) dir = normalize(nextP - curP);","  else if (curP == nextP) dir = normalize(curP - prevP);","  else dir = normalize(curP - prevP);","","  vec2 normal = vec2(-dir.y, dir.x);","  normal.xy *= .5 * lineWidth;","  normal.x /= aspect.x;","  normal.xy *= finalPosition.w * 0.001;","  finalPosition.xy += normal.xy * side;","  gl_Position = finalPosition;","}"].join("\n"),pa.tracks_frag=["uniform float progress;","varying vec3 v_color;","varying float v_counter;","flat varying int v_track_id;","void main() {","  if (v_counter > progress) discard;","  gl_FragColor = vec4(v_color, 1.0);","}"].join("\n");class wye extends Cu{constructor(e){super({uniforms:Object.assign({},{lineWidth:{value:1},resolution:{value:new Ni(1,1)},progress:{value:1}}),vertexShader:pa.tracks_vert,fragmentShader:pa.tracks_vert}),this.isTracksMaterial=!0,this.type="TracksMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},progress:{enumerable:!0,get:function(){return this.uniforms.progress.value},set:function(t){this.uniforms.progress.value=t}}}),this.setValues(e)}}class Cye{constructor(e,t,i){this.scene=e,this.activeCamera=t,this.rendererManager=i,this.animateEvent=this.animateEvent.bind(this),this.animateEventWithClipping=this.animateEventWithClipping.bind(this)}getCameraTween(e,t=1e3,i){const r=new Of(this.activeCamera.position).to({x:e[0],y:e[1],z:e[2]},t);return i&&r.easing(i),r}animateThroughEvent(e,t,i){const r=this.getCameraTween(e,1e3,hg.Cubic.Out),o=this.getCameraTween([0,0,e[2]],t),f=3*Math.PI/24,g=[];for(let Se=1;Se<=24;Se++)g.push([500*Math.sin(f*Se),0,500*Math.cos(f*Se)]);const T=this.getCameraTween([0,0,500],t,hg.Cubic.Out);let B=T;const re=4*t/24;for(const Se of g){const je=this.getCameraTween(Se,re);B.chain(je),B=je}const ne=this.getCameraTween([0,0,-e[2]],t,hg.Cubic.In),De=this.getCameraTween(e,t,hg.Cubic.Out);De.onComplete(()=>i?.()),De.delay(500),r.chain(o),o.chain(T),B.chain(ne),ne.chain(De),r.start()}animateEvent(e,t,i){const r=.25*e;e*=.75;const s=this.scene.getObjectByName(il.EVENT_DATA_ID),o=new ju(new Rt,0),l=[],d=[];s.traverse(T=>{var B,q,re;if(T.geometry)if("Track"===T.name||"LineHit"===T.name){let se=null===(re=null===(q=null===(B=T.geometry)||void 0===B?void 0:B.attributes)||void 0===q?void 0:q.position)||void 0===re?void 0:re.count;if(se)if(T.geometry instanceof Kb&&(se*=6),T.geometry instanceof JW){T.material.progress=0;const ne=new Of(T.material).to({progress:1},e);ne.onComplete(()=>{T.material.progress=1}),d.push(ne)}else if(T.geometry instanceof Qs){const ne=T.geometry.drawRange.count;T.geometry.setDrawRange(0,0);const De=new Of(T.geometry.drawRange).to({count:se},e);De.onComplete(()=>{T.geometry.drawRange.count=ne}),d.push(De)}}else if("Jet"===T.name){const se=new Of({x:.01,y:.01,z:.01}).to({x:T.scale.x,y:T.scale.y,z:T.scale.z},e);se.onUpdate(ne=>{const De=T.scale.x;T.scale.setScalar(ne.x),T.position.divideScalar(De).multiplyScalar(ne.x)}),d.push(se)}else{let ne=T.position.equals(new Rt(0,0,0))?T.geometry.boundingSphere.center:T.position;"Hit"===T.name?(ne=Array.from(T.geometry.attributes.position.array),T.geometry.deleteAttribute("position"),T.geometry.computeBoundingSphere()):T.visible=!1,l.push({eventObject:T,position:ne})}});const u=new Of(o).to({radius:3e3},e),f=T=>{l.forEach(B=>{if("Hit"===B.eventObject.name){const q=B.eventObject.geometry,se=this.getHitsPositions(B.position).filter(ne=>T.containsPoint((new Rt).fromArray(ne)));se.length>0&&(q.setAttribute("position",new To(new Float32Array([].concat(...se)),3)),q.computeBoundingSphere())}else T.containsPoint(B.position)&&(B.eventObject.visible=!0)})};u.onUpdate(f);const g=new Of(o).to({radius:1e4},r);g.onUpdate(f),u.chain(g),d.push(u),d[0].onStart(()=>i?.());for(const T of d)T.easing(hg.Quartic.Out).start();g.onComplete(()=>{f(new ju(new Rt,1/0)),t?.()})}animateEventWithClipping(e,t,i,r=11e3){const s=this.scene.getObjectByName(il.EVENT_DATA_ID),o=new $y(1,8,8),l=[],d=o.attributes.position,u=new Rt;for(let T=0;T<d.count;T++)u.fromBufferAttribute(d,T),l.push(new gA(u.clone(),0));const f=this.rendererManager.getMainRenderer().localClippingEnabled;f||this.rendererManager.setLocalClippingEnabled(!0),s.traverse(T=>{T.geometry&&T.material&&(T.material.clippingPlanes=l)});const g=[];for(const T of l){T.constant=0;const B=new Of(T).to({constant:r},e);g.push(B)}g[0].onStart(()=>i?.());for(const T of g)T.start();g[g.length-1].onComplete(()=>{f||(this.rendererManager.getMainRenderer().localClippingEnabled=f),s.traverse(T=>{T.geometry&&T.material&&(T.material.clippingPlanes=null)}),t?.()})}collideParticles(e,t=10,i=5e3,r=new fr(16777215),s){const o=new $y(t,32,32),l=new yd({color:r,transparent:!0,opacity:0}),d=new Yo(o,l),u=d.clone();d.position.setZ(i),u.position.setZ(-i);const f=[d,u];this.scene.add(...f);const g=[];for(const T of f){new Of(T.material).to({opacity:1},300).start();const B=new Of(T.position).to({z:0},e).start();g.push(B)}g[0].onComplete(()=>{this.scene.remove(...f),s?.()})}animateWithCollision(e,t,i){var r,s;const o=this.scene.getObjectByName(il.EVENT_DATA_ID),l=o.getObjectByName("Track");let d;d=l instanceof $l?null===(s=null===(r=l.children[0])||void 0===r?void 0:r.material)||void 0===s?void 0:s.color:l?.material.color,o&&(o.visible=!1),this.collideParticles(1500,30,5e3,d,()=>{e(t,i,()=>{o&&(o.visible=!0)})})}animateEventWithCollision(e,t){this.animateWithCollision(this.animateEvent,e,t)}animateClippingWithCollision(e,t){this.animateWithCollision(this.animateEventWithClipping,e,t)}getHitsPositions(e){const t=[];for(let i=0;i<e.length;i+=3)t.push(e.slice(i,i+3));return t}animatePreset(e,t){var i;const{positions:r,animateEventAfterInterval:s,collisionDuration:o}=e;s&&o&&(this.scene.getObjectByName(il.EVENT_DATA_ID).visible=!1,setTimeout(()=>{this.animateEventWithCollision(o)},s));const l=this.getCameraTween(r[0].position,null!==(i=r[0].duration)&&void 0!==i?i:2e3,r[0].easing);let d=l;r.slice(1).forEach(({position:u,duration:f,easing:g})=>{const T=this.getCameraTween(u,f??2e3,g);d.chain(T),d=T}),d.onComplete(t),l.start()}}const ej={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class $E{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Mye=new bC(-1,1,1,-1,0,1),Eye=new class Sye extends Qs{constructor(){super(),this.setAttribute("position",new ks([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ks([0,2,0,0,2,0],2))}};class tj{constructor(e){this._mesh=new Yo(Eye,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Mye)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Tye extends $E{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Cu?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=O5.clone(e.uniforms),this.material=new Cu({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new tj(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class nj extends $E{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;let o,l;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,l=1):(o=1,l=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(l),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class Dye extends $E{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Iye{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const i=e.getSize(new Ni);this._width=i.width,this._height=i.height,(t=new Wu(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:mA})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Tye(ej),this.copyPass.material.blending=0,this.clock=new dW}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const l=this.renderer.getContext(),d=this.renderer.state.buffers.stencil;d.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),d.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==nj&&(o instanceof nj?i=!0:o instanceof Dye&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new Ni);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Bye extends $E{constructor(e,t,i=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new fr}render(e,t,i){const r=e.autoClear;let s,o;e.autoClear=!1,null!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor)),null!==this.clearAlpha&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(s),null!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}class ev extends $E{constructor(e,t,i,r){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new fr(1,1,1),this.hiddenEdgeColor=new fr(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new Ni(e.x,e.y):new Ni(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Wu(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new W5,this.depthMaterial.side=2,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=0,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=2,this.prepareMaskMaterial.fragmentShader=function f(g,T){return g.replace(/DEPTH_TO_VIEW_Z/g,(T.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Wu(this.resolution.x,this.resolution.y,{type:mA}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Wu(s,o,{type:mA}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Wu(s,o,{type:mA}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Wu(Math.round(s/2),Math.round(o/2),{type:mA}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Wu(s,o,{type:mA}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Wu(Math.round(s/2),Math.round(o/2),{type:mA}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();const u=ej;this.copyUniforms=O5.clone(u.uniforms),this.materialCopy=new Cu({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:0,depthTest:!1,depthWrite:!1}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new fr,this.oldClearAlpha=1,this.fsQuad=new tj(null),this.tempPulseColor1=new fr,this.tempPulseColor2=new fr,this.textureMatrix=new fo}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value.set(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value.set(i,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function i(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(i)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=[];function r(o){o.isMesh&&i.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);this.renderScene.traverse(function s(o){if(o.isMesh||o.isSprite){let l=!1;for(let d=0;d<i.length;d++)if(i[d].id===o.id){l=!0;break}if(!1===l){const d=o.visible;(!1===e||!0===t.get(o))&&(o.visible=e),t.set(o,d)}}else(o.isPoints||o.isLine)&&(!0===e?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const l=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=l,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const d=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(d),this.tempPulseColor2.multiplyScalar(d)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=ev.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=ev.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=ev.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=ev.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Cu({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Ni(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\n\t\t\t\t\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t\t\t\t\t#ifdef USE_INSTANCING\n\n\t\t\t\t\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t\t\t\t\t#endif\n\t\t\t\t\t\n\t\t\t\t\tworldPosition = modelMatrix * worldPosition;\n\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Cu({uniforms:{maskTexture:{value:null},texSize:{value:new Ni(.5,.5)},visibleEdgeColor:{value:new Rt(1,1,1)},hiddenEdgeColor:{value:new Rt(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Cu({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Ni(.5,.5)},direction:{value:new Ni(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Cu({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:2,depthTest:!1,depthWrite:!1,transparent:!0})}}ev.BlurDirectionX=new Ni(1,0),ev.BlurDirectionY=new Ni(0,1);class Pye{constructor(e,t,i){this.antialiasing=!0,this.composer=new Iye(i),this.camera=e,this.scene=t,this.defaultRenderPass=new Bye(this.scene,this.camera),this.composer.addPass(this.defaultRenderPass),this.render=this.antialiasing?this.antialiasRender:this.effectsRender}effectsRender(e,t){this.composer&&(this.defaultRenderPass.camera=t,this.defaultRenderPass.scene=e,this.composer.render())}antialiasRender(e,t){this.composer.renderer.render(e,t)}addOutlinePassForSelection(){const e=new ev(new Ni(window.innerWidth,window.innerHeight),this.scene,this.camera);return e.overlayMaterial.blending=1,e.visibleEdgeColor.set(16777062),e.visibleEdgeColor.set(14635824),this.composer.addPass(e),e}removePass(e){const t=this.composer.passes.indexOf(e);this.composer.passes.splice(t,1)}setAntialiasing(e){this.antialiasing=e,this.render=this.antialiasing?this.antialiasRender:this.effectsRender}}class yg{constructor(){return this.clippingEnabled=new qC(!1),this.startClippingAngle=new qC(0),this.openingClippingAngle=new qC(0),this.eventMetadata={runNumber:"000",eventNumber:"000"},void 0===yg.instance&&(yg.instance=this),yg.instance}static getInstance(){return yg.instance}setPhoenixMenuRoot(e){this.phoenixMenuRoot=e,this.phoenixMenuRoot&&this.phoenixMenuRoot.addConfig("button",{label:"Save state",onClick:()=>{this.saveStateAsJSON()}}).addConfig("button",{label:"Load state",onClick:()=>{NW(t=>{this.loadStateFromJSON(JSON.parse(t))})}})}saveStateAsJSON(){const e={phoenixMenu:this.phoenixMenuRoot.getNodeState(),eventDisplay:{cameraPosition:this.activeCamera.position.toArray(),startClippingAngle:this.clippingEnabled.value?this.startClippingAngle.value:null,openingClippingAngle:this.clippingEnabled.value?this.openingClippingAngle.value:null}};rB(JSON.stringify(e),`run${this.eventMetadata.runNumber}_evt${this.eventMetadata.eventNumber}.json`)}loadStateFromJSON(e){var t,i,r;const s="string"==typeof e?JSON.parse(e):e;if(s.phoenixMenu&&this.phoenixMenuRoot&&(this.phoenixMenuRoot.loadStateFromJSON(s.phoenixMenu),this.phoenixMenuRoot.configActive=!1),s.eventDisplay){this.activeCamera.position.fromArray(null===(t=s.eventDisplay)||void 0===t?void 0:t.cameraPosition);const o=null===(i=s.eventDisplay)||void 0===i?void 0:i.startClippingAngle,l=null===(r=s.eventDisplay)||void 0===r?void 0:r.openingClippingAngle;(o||l)&&(this.setClippingEnabled(!0),this.eventDisplay.getUIManager().setClipping(!0),o&&this.eventDisplay.getUIManager().rotateStartAngleClipping(s.eventDisplay.startClippingAngle),l&&this.eventDisplay.getUIManager().rotateOpeningAngleClipping(s.eventDisplay.openingClippingAngle))}}setClippingEnabled(e){this.clippingEnabled.update(e)}setStartClippingAngle(e){this.startClippingAngle.update(e)}getStartClippingAngle(){return this.startClippingAngle.value}setOpeningClippingAngle(e){this.openingClippingAngle.update(e)}getOpeningClippingAngle(){return this.openingClippingAngle.value}setCamera(e){this.activeCamera=e}setEventDisplay(e){this.eventDisplay=e}}class cx{constructor(){return this.toLoad=[],this.loaded=[],this.onLoadCallbacks=[],this.onProgressCallbacks=[],this.progressItems={},void 0===cx.instance&&(cx.instance=this),cx.instance}addLoadableItem(e=""){this.toLoad.push(e),this.progressItems[e]=0}itemLoaded(e=""){this.loaded.push(e),this.onProgress(e,100),this.toLoad.length===this.loaded.length&&this.toLoad.sort().join(",")===this.loaded.sort().join(",")&&(this.onLoadCallbacks.forEach(t=>t()),this.reset())}onProgress(e,t){this.progressItems[e]=t;const s=Object.values(this.progressItems).reduce((o,l)=>o+l,0)/Object.keys(this.progressItems).length;for(const o of this.onProgressCallbacks)o(s)}addLoadListener(e){this.onLoadCallbacks.push(e)}addLoadListenerWithCheck(e){this.toLoad.length>0&&this.toLoad.length!==this.loaded.length?this.onLoadCallbacks.push(e):e()}addProgressListener(e){this.onProgressCallbacks.push(e)}reset(){this.toLoad=[],this.loaded=[],this.onLoadCallbacks=[],this.onProgressCallbacks=[],this.progressItems={}}}class Rye{constructor(e){this.sceneManager=e}colorObjectsByProperty(e,t,i){this.sceneManager.getScene().getObjectByName(t).traverse(s=>{var o;null!==(o=s.material)&&void 0!==o&&o.color&&i(s.userData)&&s.material.color.set(e)})}collectionColor(e,t){const i=this.sceneManager.getScene().getObjectByName(il.EVENT_DATA_ID).getObjectByName(e);for(const r of Object.values(i.children))r.traverse(s=>{var o,l;null===(l=null===(o=s.material)||void 0===o?void 0:o.color)||void 0===l||l.set(t)})}collectionColorRandom(e){const t=this.sceneManager.getScene().getObjectByName(il.EVENT_DATA_ID).getObjectByName(e);for(const i of Object.values(t.children))i.traverse(r=>{var s,o;null===(o=null===(s=r.material)||void 0===s?void 0:s.color)||void 0===o||o.set(16777215*Math.random())})}colorTracksByVertex(e){const t=this.sceneManager.getScene();t.getObjectByName("Vertices").traverse(r=>{const{linkedTrackCollection:s,linkedTracks:o}=r.userData;if("Vertex"===r.name&&s===e&&o){const l=r.material.color,d=t.getObjectByName(s);o.forEach(u=>{d.children[u].traverse(f=>{var g,T;null===(T=null===(g=f?.material)||void 0===g?void 0:g.color)||void 0===T||T.set(l)})})}})}}var bm=function(n){return n.VR="VR",n.AR="AR",n}(bm||{});class ij{constructor(e){this.sessionType=e,this.xrActive=!1,this.currentXRSession=null}setXRSession(e,t,i){var r;this.renderer=e,this.onSessionEnded=i;const s=navigator?.xr,o=this.sessionType===bm.VR?"vr":"ar";s?.requestSession(`immersive-${o}`,null===(r=this.sessionInit)||void 0===r?void 0:r.call(this)).then(l=>{this.onXRSessionStarted.bind(this)(l),t?.()}).catch(l=>{console.error(`${o.toUpperCase()} Error:`,l)})}onXRSessionStarted(e){return function(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){this.xrActive=!0,e.addEventListener("end",this.onXRSessionEnded.bind(this)),yield this.renderer.xr.setSession(e),this.currentXRSession=e})}onXRSessionEnded(){var e;this.xrActive=!1,this.currentXRSession.removeEventListener("end",this.onXRSessionEnded),this.currentXRSession=null,this.cameraGroup=void 0,null===(e=this.onSessionEnded)||void 0===e||e.call(this)}endXRSession(){var e;null===(e=this.currentXRSession)||void 0===e||e.end()}getCameraGroup(e){if(this.cameraGroup||(this.cameraGroup=new $l),e&&this.xrActive){this.xrCamera=this.renderer.xr.getCamera().copy(new aQ([e.clone()])),this.xrCamera.name="XR_CAMERA";const t=this.sessionType===bm.VR?this.xrCamera.position:new Rt(0,0,.1);this.cameraGroup.position.copy(t),this.cameraGroup.add(this.xrCamera)}return this.cameraGroup}getXRCamera(){return this.xrCamera}}const bd={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function rj(n){return ZO.apply(this,arguments)}function ZO(){return(ZO=(0,ve.A)(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)})).apply(this,arguments)}function JO(){return(JO=(0,ve.A)(function*(n){if(!n)throw new Error("No basePath supplied");return yield rj(`${n}/profilesList.json`)})).apply(this,arguments)}function eL(){return eL=(0,ve.A)(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function Fye(n){return JO.apply(this,arguments)}(e);let s;if(n.profiles.some(d=>{const u=r[d];return u&&(s={profileId:d,profilePath:`${e}/${u.path}`,deprecated:!!u.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const d=r[t];if(!d)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${d.path}`,deprecated:!!d.deprecated}}const o=yield rj(s.profilePath);let l;if(i){let d;if(d="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!d)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);d.assetPath&&(l=s.profilePath.replace("profile.json",d.assetPath))}return{profile:o,assetPath:l}}),eL.apply(this,arguments)}const Lye={xAxis:0,yAxis:0,button:0,state:bd.ComponentState.DEFAULT};class Uye{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===bd.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(Lye)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function Nye(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case bd.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case bd.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case bd.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case bd.ComponentProperty.STATE:this.value=this.valueNodeProperty===bd.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class zye{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new Uye(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:bd.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=bd.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=bd.ComponentState.PRESSED:(t.touched||this.values.button>bd.ButtonTouchThreshold)&&(this.values.state=bd.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===bd.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>bd.AxisTouchThreshold&&(this.values.state=bd.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===bd.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>bd.AxisTouchThreshold&&(this.values.state=bd.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class Hye{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new zye(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class qye extends Ol{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:l,valueNodeProperty:d}=i;r&&(d===bd.VisualResponseProperty.VISIBILITY?r.visible=l:d===bd.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,l),r.position.lerpVectors(s.position,o.position,l)))})}))}}function sj(n,e){(function Qye(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===bd.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new $y(.001),l=new yd({color:255}),d=new Yo(o,l);t.touchPointNode.add(d)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:l,minNodeName:d,maxNodeName:u,valueNodeProperty:f}=o;if(f===bd.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(d),o.maxNode=e.getObjectByName(u),!o.minNode)return void console.warn(`Could not find ${d} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${u} in the model`)}o.valueNode=e.getObjectByName(l),o.valueNode||console.warn(`Could not find ${l} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class Wye{constructor(e=null,t=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.onLoad=t,this.gltfLoader||(this.gltfLoader=new oB)}setPath(e){return this.path=e,this}createControllerModel(e){const t=new qye;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function Oye(n,e){return eL.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:l})=>{t.motionController=new Hye(s,o,l);const d=this._assetCache[t.motionController.assetUrl];if(d)i=d.scene.clone(),sj(t,i),this.onLoad&&this.onLoad(i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,u=>{this._assetCache[t.motionController.assetUrl]=u,i=u.scene.clone(),sj(t,i),this.onLoad&&this.onLoad(i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let oj=(()=>{class n extends ij{constructor(){super(bm.VR),this.sessionInit=()=>({optionalFeatures:["local-floor","bounded-floor","hand-tracking"]})}setXRSession(t,i,r){super.setXRSession(t,i,r),this.setupVRControls()}onXRSessionEnded(){var t,i;super.onXRSessionEnded(),null===(t=this.controller1)||void 0===t||t.removeEventListener("selectstart",this.onControllerSelectStart),null===(i=this.controller1)||void 0===i||i.removeEventListener("selectend",this.onControllerSelectEnd)}setupVRControls(){this.controller1=this.renderer.xr.getController(0),this.getCameraGroup().add(this.controller1),this.controller2=this.renderer.xr.getController(1),this.getCameraGroup().add(this.controller2);const t=new Wye;this.controllerGrip1=this.renderer.xr.getControllerGrip(0),this.controllerGrip1.add(t.createControllerModel(this.controllerGrip1)),this.getCameraGroup().add(this.controllerGrip1),this.controllerGrip2=this.renderer.xr.getControllerGrip(1),this.controllerGrip2.add(t.createControllerModel(this.controllerGrip2)),this.getCameraGroup().add(this.controllerGrip2);const i=(new Qs).setFromPoints([new Rt(0,0,0),new Rt(0,0,-1)]),r=new gg(i);r.name="line",r.scale.z=50,this.controller1.add(r.clone()),this.controller2.add(r.clone());const o=new Rt;let l;this.onControllerSelectStart=()=>{console.log("Select: c1 position "+this.controller1.position.toArray().join(", ")),console.log("Select: CG position "+this.cameraGroup.position.toArray().join(", ")),l=setInterval(()=>{this.moveInDirection(o,30)},20)},this.onControllerSelectEnd=()=>{clearInterval(l)},this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd)}moveInDirection(t,i){var r;null===(r=this.xrCamera)||void 0===r||r.getWorldDirection(t),this.cameraGroup.position.addScaledVector(t,i),this.xrCamera.position.addScaledVector(t,i)}}return n.SESSION_TYPE="immersive-vr",n})();let tL=(()=>{class n extends ij{constructor(t,i){super(bm.AR),this.scene=t,this.camera=i,this.previousValues={sceneScale:1,cameraNear:10},this.previousValues.sceneScale=t.scale.x,this.previousValues.cameraNear=i.near,this.sessionInit=()=>n.enableDomOverlay?{optionalFeatures:["dom-overlay"],domOverlay:{root:document.body}}:{}}onXRSessionStarted(t){const i=Object.create(null,{onXRSessionStarted:{get:()=>super.onXRSessionStarted}});return function(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){document.body.style.setProperty("background-color","transparent"),this.previousValues.sceneScale=this.scene.scale.x,this.previousValues.cameraNear=this.camera.near,this.scaleScene(1e-5),this.camera.near=.01,this.renderer.xr.setReferenceSpaceType("local"),yield i.onXRSessionStarted.call(this,t)})}onXRSessionEnded(){document.body.style.removeProperty("background-color"),this.scaleScene(this.previousValues.sceneScale),this.camera.near=this.previousValues.cameraNear,super.onXRSessionEnded()}scaleScene(t){[il.EVENT_DATA_ID,il.GEOMETRIES_ID,il.LABELS_ID].forEach(i=>{var r;null===(r=this.scene.getObjectByName(i))||void 0===r||r.scale.setScalar(t)})}}return n.SESSION_TYPE="immersive-ar",n.enableDomOverlay=!0,n})();var XE=function(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})};!function(){const n=Ol.prototype.updateMatrixWorld;Ol.prototype.updateMatrixWorld=function(){this.visible&&n.apply(this)}}();class $ye{constructor(e){this.infoLogger=e,this.origin=new Rt(0,0,0),this.ignoreList=[(new $4).type,(new HC).type,(new EW).type],this.prev3DCoord=null,this.prevIntersectName=null,this.distanceCanvas=null,this.displayColor="black",this.originChanged=new xs,this.shiftGrid=!1,this.stopShifting=new xs,this.saveBlob=function(){const t=document.createElement("a");return document.body.appendChild(t),t.style.display="none",function(r,s){const o=window.URL.createObjectURL(r);t.href=o,t.download=s,t.click()}}(),this.rendererManager=new a1e,this.loadingManager=new cx}init(e){this.clipPlanes=[new gA(new Rt(0,1,0),0),new gA(new Rt(0,-1,0),0)],this.sceneManager=new il(this.ignoreList),this.exportManager=new B1e,this.importManager=new gye(this.clipPlanes,il.EVENT_DATA_ID,il.GEOMETRIES_ID),this.rendererManager.init(e.elementId),this.controlsManager=new o1e(this.rendererManager,e.defaultView),this.controlsManager.hideTubeTracksOnZoom(this.sceneManager.getScene(),200),this.effectsManager=new Pye(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.rendererManager.getMainRenderer()),this.animationsManager=new Cye(this.sceneManager.getScene(),this.controlsManager.getActiveCamera(),this.rendererManager),this.vrManager=new oj,this.arManager=new tL(this.sceneManager.getScene(),this.controlsManager.getMainCamera()),this.colorManager=new Rye(this.sceneManager),this.getSelectionManager().init(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.effectsManager,this.infoLogger),(new yg).setCamera(this.controlsManager.getActiveCamera())}setDarkColor(e){this.displayColor=e?"white":"black"}updateControls(){this.controlsManager.getActiveControls().update(),this.controlsManager.updateSync(),uG()}setAnimationLoop(e){this.uiLoop=e,this.animationLoop=()=>{this.uiLoop(),this.updateControls(),this.sceneManager.alignText(this.controlsManager.getMainCamera()),this.render()},this.rendererManager.getMainRenderer().setAnimationLoop(this.animationLoop)}stopAnimationLoop(){this.rendererManager.getMainRenderer().setAnimationLoop(null)}render(){this.rendererManager.render(this.sceneManager.getScene(),this.controlsManager.getOverlayCamera()),this.effectsManager.render(this.sceneManager.getScene(),this.controlsManager.getMainCamera()),this.sceneManager.updateLights(this.controlsManager.getActiveCamera())}xrRender(e){this.uiLoop(),this.rendererManager.getMainRenderer().render(this.sceneManager.getScene(),e.getXRCamera()),this.sceneManager.updateLights(e.getXRCamera())}getSceneManager(){return this.sceneManager||(this.sceneManager=new il(this.ignoreList)),this.sceneManager}autoRotate(e){this.controlsManager.getActiveControls().autoRotate=e}filterRayIntersect(){null==this.stateManager&&(this.stateManager=new yg),null==this.isEventData&&(this.isEventData=e=>{let t=!1;return e.object.traverseAncestors(i=>{"EventData"==i.name&&(t=!0)}),t}),null==this.isVisible&&(this.isVisible=e=>{let t=!1;return this.clipPlanes.length>0&&(this.clipIntersection?this.clipPlanes.every(i=>i.distanceToPoint(e.point)<0)||(t=!0):this.clipPlanes.every(i=>i.distanceToPoint(e.point)>0)&&(t=!0)),t})}originChangedEmit(e){this.origin=e,this.originChanged.emit(e)}getMainIntersect(e){const t=this.controlsManager.getMainCamera(),i=this.sceneManager.getScene(),r=new mW,s=new Ni;s.x=e.clientX/window.innerWidth*2-1,s.y=-e.clientY/window.innerHeight*2+1,r.setFromCamera(s,t);const o=r.intersectObjects(i.children);let l=null;if(o.length>0&&!this.stateManager.clippingEnabled.value){for(const d of o)if("gridline"!=d.object.name&&"XYZ Labels"!=d.object.name){l=d;break}}else for(const d of o)if("gridline"!=d.object.name&&"XYZ Labels"!=d.object.name){if(this.isEventData(d)){l=d;break}if(this.isVisible(d)){l=d;break}}return l}show3DMousePoints(e){this.filterRayIntersect(),null==this.show3DPointsCallback&&(this.show3DPointsCallback=t=>{const i=this.getMainIntersect(t);if(null!=i){const r=i.point,s=new Rt;s.subVectors(r,this.origin);const o=document.getElementsByTagName("app-root")[0],l=document.createElement("p");l.id="3dcoordinates",l.innerHTML=`${i.object.name}:\r\n\tOriginal (cm): (${Math.round(r.x/10)}, ${Math.round(r.y/10)}, ${Math.round(r.z/10)})`,(0!=this.origin.x||0!=this.origin.y||0!=this.origin.z)&&(l.innerHTML+=`\r\n\tCompared to grid (cm): (${Math.round(s.x/10)}, ${Math.round(s.y/10)}, ${Math.round(s.z/10)})`),l.style.whiteSpace="pre",l.style.color=this.displayColor,l.style.position="absolute",l.style.top=`${t.clientY+10}px`,l.style.left=`${t.clientX+10}px`;const d=document.createElement("div");d.id="circledDot",d.style.width="1rem",d.style.height="1rem",d.style.position="absolute",d.style.top=`calc(${t.clientY}px - 0.5rem)`,d.style.left=`calc(${t.clientX}px - 0.5rem)`,d.style.border=`2px solid ${this.displayColor}`,d.style.borderRadius="0.5rem",d.innerHTML=`\n            <div \n              style = "\n                background-color: ${this.displayColor}; \n                margin-top: calc(0.3rem - 1.5px);\n                margin-left: calc(0.3rem - 1.5px); \n                width: 0.4rem; \n                height: 0.4rem; \n                border-radius: 0.5rem;\n              "\n            ></div>`,o?.appendChild(l),o?.appendChild(d),setTimeout(()=>{document.getElementById("3dcoordinates").remove(),document.getElementById("circledDot").remove()},3e3)}}),e?window.addEventListener("click",this.show3DPointsCallback):window.removeEventListener("click",this.show3DPointsCallback)}show3DDistance(e){this.prev3DCoord=null,this.prev2DCoord=null,this.prevIntersectName=null,this.filterRayIntersect(),null==this.show3DDistanceCallback&&(this.mousemoveCallback=this.drawLine.bind(this),this.show3DDistanceCallback=t=>{const i=this.getMainIntersect(t);if(null!=i)if(null==this.prev3DCoord){this.prev3DCoord=i.point,this.prev2DCoord=new Ni(t.clientX,t.clientY),this.prevIntersectName=i.object.name;const r=document.getElementsByTagName("app-root")[0];null==this.distanceCanvas&&(this.distanceCanvas=document.createElement("canvas"),this.distanceCanvas.id="3Ddistance",this.distanceCanvas.width=window.innerWidth,this.distanceCanvas.height=window.innerHeight,this.distanceCanvas.style.position="absolute",this.distanceCanvas.style.bottom="0"),r?.appendChild(this.distanceCanvas);const s=this.distanceCanvas.getContext("2d");s.strokeStyle=this.displayColor,s.lineWidth=2,s.fillStyle=this.displayColor,s.beginPath(),s.arc(this.prev2DCoord.x,this.prev2DCoord.y,7,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(this.prev2DCoord.x,this.prev2DCoord.y,3,0,2*Math.PI),s.fill(),window.addEventListener("mousemove",this.mousemoveCallback)}else{window.removeEventListener("mousemove",this.mousemoveCallback);const r=i.point.distanceTo(this.prev3DCoord)/10;this.drawLine(t);const s=this.distanceCanvas.getContext("2d");s.beginPath(),s.arc(t.clientX,t.clientY,7,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(t.clientX,t.clientY,3,0,2*Math.PI),s.fill(),s.font="15px Arial";let o=this.prev2DCoord.x,l=t.clientX;const d=this.prev2DCoord.y,u=t.clientY,f=(o+l)/2,g=(d+u)/2,B=(o-l)/(u-d),q=25/Math.sqrt(1+B*B),se=f+q,ne=g+B*q;this.prev2DCoord.x>t.clientX?(o=this.prev2DCoord.x+20,l=t.clientX-s.measureText(i.object.name).width-20):(o=this.prev2DCoord.x-s.measureText(this.prevIntersectName).width-20,l=t.clientX+20),s.fillText(this.prevIntersectName,o,d),s.fillText(i.object.name,l,u),s.fillText(r.toFixed(2).toString()+"cm",se,ne),setTimeout(()=>{null!=document.getElementById("3Ddistance")&&document.getElementById("3Ddistance").remove(),this.distanceCanvas.getContext("2d").clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height)},3e3),this.prev3DCoord=null,this.prev2DCoord=null,this.prevIntersectName=null}}),e?window.addEventListener("click",this.show3DDistanceCallback):(window.removeEventListener("click",this.show3DDistanceCallback),window.removeEventListener("mousemove",this.mousemoveCallback),null!=document.getElementById("3Ddistance")&&document.getElementById("3Ddistance").remove(),null!=this.distanceCanvas&&this.distanceCanvas.getContext("2d").clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height))}drawLine(e){const t=this.distanceCanvas.getContext("2d");t.clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height),t.beginPath(),t.moveTo(this.prev2DCoord.x,this.prev2DCoord.y),t.lineTo(e.clientX,e.clientY),t.stroke(),t.beginPath(),t.arc(this.prev2DCoord.x,this.prev2DCoord.y,7,0,2*Math.PI),t.stroke(),t.beginPath(),t.arc(this.prev2DCoord.x,this.prev2DCoord.y,3,0,2*Math.PI),t.fill()}shiftCartesianGrid(){this.shiftGrid=!0,this.filterRayIntersect(),null==this.shiftCartesianGridCallback&&(this.shiftCartesianGridCallback=t=>{const i=this.getMainIntersect(t);null!=i&&this.originChangedEmit(i.point)});const e=t=>{window.removeEventListener("click",this.shiftCartesianGridCallback),this.stopShifting.emit(!0),this.shiftGrid=!1,window.removeEventListener("contextmenu",e)};window.addEventListener("click",this.shiftCartesianGridCallback),window.addEventListener("contextmenu",e)}setClipping(e){this.rendererManager.setLocalClippingEnabled(e)}setClippingAngle(e,t){const i=new zc;i.setFromAxisAngle(new Rt(0,0,1),e*Math.PI/180),this.clipPlanes[0].normal.set(0,-1,0).applyQuaternion(i);const r=new zc;r.setFromAxisAngle(new Rt(0,0,1),(e+t)*Math.PI/180),this.clipPlanes[1].normal.set(0,1,0).applyQuaternion(r),(this.clipIntersection&&t>180||!this.clipIntersection&&t<180)&&(this.clipIntersection=t<180,this.sceneManager.getGeometries().traverse(o=>{o instanceof Yo&&o.material instanceof ad&&(o.material.clipIntersection=this.clipIntersection)}))}animateCameraTransform(e,t,i){this.animateCameraPosition(e,i),this.animateCameraTarget(t,i)}swapCameras(e){let t;t=e?"OrthographicCamera":"PerspectiveCamera",this.controlsManager.getMainCamera().type!==t&&this.controlsManager.swapControls()}loadOBJGeometry(e,t,i,r){return XE(this,arguments,void 0,function*(s,o,l,d,u=!0,f=!0){const g=this.sceneManager.getGeometries(),T=yield this.importManager.loadOBJGeometry(s,o,l,d,f),{object:B}=T;return B.visible=u,g.add(B),T})}loadGLTFGeometry(e,t,i,r,s){return XE(this,void 0,void 0,function*(){const o=this.sceneManager.getGeometries(),l=yield this.importManager.loadGLTFGeometry(e,t,i,r,s);for(const{object:d}of l)o.add(d),this.infoLogger.add(t,"Loaded GLTF scene");return l})}parseOBJGeometry(e,t,i=!0){const r=this.sceneManager.getGeometries(),s=this.importManager.parseOBJGeometry(e,t);return s.visible=i,r.add(s),{object:s}}parseGLTFGeometry(e,t){return XE(this,void 0,void 0,function*(){const i=yield this.importManager.parseGLTFGeometry(e,t);for(const{object:r}of i)this.sceneManager.getGeometries().add(r),this.infoLogger.add(t,"Parsed GLTF geometry");return i})}parsePhnxScene(e){return XE(this,void 0,void 0,function*(){yield this.importManager.parsePhnxScene(e,(i,r)=>{this.sceneManager.getScene().add(i),this.sceneManager.getScene().add(r)})})}loadJSONGeometry(e,t,i,r){return XE(this,arguments,void 0,function*(s,o,l,d,u=!0){const f=this.sceneManager.getGeometries(),{object:g}=yield this.importManager.loadJSONGeometry(s,o,l,d);return g.visible=u,f.add(g),{object:g}})}exportSceneToOBJ(){const e=this.sceneManager.getCleanScene();this.exportManager.exportSceneToOBJ(e)}exportPhoenixScene(){const e=this.sceneManager.getCleanScene();this.exportManager.exportPhoenixScene(e,this.sceneManager.getEventData(),this.sceneManager.getGeometries())}fixOverlayView(e){this.rendererManager.setFixOverlay(e)}setSelectedObjectDisplay(e){this.getSelectionManager().setSelectedObject(e)}eventDataDepthTest(e){this.sceneManager.eventDataDepthTest(e)}enableSelecting(e){this.getSelectionManager().setSelecting(e)}clearEventData(){this.sceneManager.clearEventData()}addEventDataTypeGroup(e){return this.sceneManager.addEventDataTypeGroup(e)}setOverlayRenderer(e){this.rendererManager&&this.rendererManager.setOverlayRenderer(e)}zoomTo(e,t){this.controlsManager.zoomTo(e,t)}getSelectionManager(){return this.selectionManager||(this.selectionManager=new _ye),this.selectionManager}animateCameraPosition(e,t){const i=new Of(this.controlsManager.getActiveCamera().position);i.to({x:e[0],y:e[1],z:e[2]},t),i.start()}animateCameraTarget(e,t){const i=new Of(this.controlsManager.getActiveControls().target);i.to({x:e[0],y:e[1],z:e[2]},t),i.start()}getActiveObjectId(){return this.getSelectionManager().getActiveObjectId()}lookAtObject(e,t=!1){1==t?this.controlsManager.lookAtObject(e,this.getSceneManager().getGeometries(),1e3):this.controlsManager.lookAtObject(e,this.getSceneManager().getEventData(),0)}getObjectPosition(e){return this.controlsManager.getObjectPosition(e,this.getSceneManager().getScene())}highlightObject(e,t=!1){this.selectionManager.highlightObject(e,1==t?this.getSceneManager().getGeometries():this.getSceneManager().getEventData())}enableHighlighting(){this.selectionManager.enableHighlighting()}disableHighlighting(){this.selectionManager.disableHighlighting()}enableKeyboardControls(){document.addEventListener("keydown",e=>{var t;if(!["input","textarea"].includes(null===(t=e.target)||void 0===t?void 0:t.tagName.toLowerCase())&&e.shiftKey)switch(e.code){case"KeyR":this.autoRotate(!this.controlsManager.getActiveControls().autoRotate);break;case"Equal":this.zoomTo(1/1.2,100);break;case"Minus":this.zoomTo(1.2,100);break;case"KeyC":this.setClipping(!this.rendererManager.getLocalClipping()),this.rendererManager.getLocalClipping()&&this.setClippingAngle(0,180);break;case"KeyV":{const r="OrthographicCamera"===this.controlsManager.getMainCamera().type;this.swapCameras(!r);break}}})}animateThroughEvent(e,t,i){this.animationsManager.animateThroughEvent(e,t,i)}animatePreset(e,t){this.animationsManager.animatePreset(e,t)}animateEventWithCollision(e,t){this.animationsManager.animateEventWithCollision(e,t)}animateClippingWithCollision(e,t){this.animationsManager.animateClippingWithCollision(e,t)}croppedSize(e,t,i,r){let s=t,o=e;return i*t<r*e?s=r*e/i:o=i*t/r,{width:o,height:s}}checkScreenShotCanvasSize(e,t,i="Stretch"){const r=this.rendererManager.getMainRenderer(),s=new Ni;r.getSize(s);const o=this.croppedSize(e,t,s.width,s.height),l=window.devicePixelRatio,d=r.getContext(),u=d.getParameter(d.MAX_RENDERBUFFER_SIZE);return o.width/l<u&&o.height/l<u}makeScreenShot(e,t,i="Strech"){const r=this.rendererManager.getMainRenderer(),s=new Ni;r.getSize(s);const o=this.croppedSize(e,t,s.width,s.height),l=(o.height-t)/2,d=(o.width-e)/2,u=getComputedStyle(document.body).getPropertyValue("--phoenix-background-color"),f=window.devicePixelRatio,g=document.getElementById("screenshotCanvas");g.width=e,g.height=t,g.style.width=(e/f).toString()+"px",g.style.height=(t/f).toString()+"px";const T=g.getContext("2d");T.fillStyle=u,T.fillRect(0,0,e,t),r.setSize(o.width/f,o.height/f,!1),this.render(),T.drawImage(r.domElement,d,l,e,t,0,0,e,t),r.setSize(s.width,s.height,!1),this.render();const B=document.getElementById("experimentInfo");if(null!=B){const q=B.clientHeight*o.height/s.height,re=B.clientWidth*o.width/s.width;i1e()(B,{backgroundColor:u,ignoreElements:se=>"CANVAS"==se.tagName}).then(se=>{se.toBlob(ne=>{T.drawImage(se,q/6,q/6,re,q),g.toBlob(De=>{const Se=document.createElement("a");document.body.appendChild(Se),Se.style.display="none";const je=window.URL.createObjectURL(De);Se.href=je,Se.download="screencapture.png",Se.click()})})})}}initXRSession(e,t){const i=e===bm.VR?this.vrManager:this.arManager,r=this.rendererManager.getMainRenderer();r.xr.enabled=!0,r.xr.setAnimationLoop(this.xrRender.bind(this,i)),i.setXRSession(r,()=>{const o=i.getCameraGroup(this.controlsManager.getMainCamera());this.sceneManager.getScene().add(o)},t)}endXRSession(e){const t=e===bm.VR?this.vrManager:this.arManager;this.sceneManager.getScene().remove(t.getCameraGroup());const i=this.rendererManager.getMainRenderer();i.xr.setAnimationLoop(null),i.xr.enabled=!1,t.endXRSession()}getObjectByName(e){return this.getSceneManager().getScene().getObjectByName(e)}setAntialiasing(e){this.effectsManager.setAntialiasing(e)}addGeometryFromParameters(e){this.loadingManager.addLoadableItem("geom_from_params");const t=this.getSceneManager().getScene(),l=e.NumPhiEl,d=e.NumZEl,u=e.Radius,f=e.MinZ,g=e.MaxZ,T=e.TiltAngle,B=e.ZTiltAngle,q=e.PhiOffset,re=e.Colour,ne=new Mp(e.Xdim,e.Ydim,e.Zdim),De=new yd({color:re,opacity:.5,transparent:!0}),Se=(g-f)/d,je=2*Math.PI/l;let Dt=f+Se/2;const Mt=Math.PI/2;let Bt;for(let Jt=0;Jt<d;Jt++){let Vn=q;for(let Tt=0;Tt<l;Tt++){Vn+=je,Bt=new Rt(u*Math.cos(Vn),u*Math.sin(Vn),Dt);const tn=new Yo(ne.clone(),De);tn.matrix.makeRotationFromEuler(new U0(B,0,Mt+Vn+T)),tn.matrix.setPosition(Bt),tn.matrixAutoUpdate=!1,t.add(tn)}Dt+=Se}this.loadingManager.itemLoaded("geom_from_params")}addLabelToObject(e,t,i){const r=this.controlsManager.getActiveControls(),s=this.getObjectPosition(t);this.getSceneManager().addLabelToObject(e,t,i,s,r)}getColorManager(){return this.colorManager}}var Xye=Ee(39),Yye=Ee.n(Xye),Tu=function(n){return n[n.NotForced=0]="NotForced",n[n.On=1]="On",n[n.Off=2]="Off",n}(Tu||{});class Vf{constructor(e,t,i,r,s=Tu.NotForced,o=0,l=0){this.name=e,this.cameraPos=t,this.cameraTarget=i,this.icon=r,this.clipping=s,this.clippingStartAngle=o,this.clippingOpeningAngle=l}getIconURL(){return"assets/preset-views/"+this.icon+".svg#"+this.icon}}function QC(n,e){var t=n.__state.conversionName.toString(),i=Math.round(n.r),r=Math.round(n.g),s=Math.round(n.b),o=n.a,l=Math.round(n.h),d=n.s.toFixed(1),u=n.v.toFixed(1);if(e||"THREE_CHAR_HEX"===t||"SIX_CHAR_HEX"===t){for(var f=n.hex.toString(16);f.length<6;)f="0"+f;return"#"+f}return"CSS_RGB"===t?"rgb("+i+","+r+","+s+")":"CSS_RGBA"===t?"rgba("+i+","+r+","+s+","+o+")":"HEX"===t?"0x"+n.hex.toString(16):"RGB_ARRAY"===t?"["+i+","+r+","+s+"]":"RGBA_ARRAY"===t?"["+i+","+r+","+s+","+o+"]":"RGB_OBJ"===t?"{r:"+i+",g:"+r+",b:"+s+"}":"RGBA_OBJ"===t?"{r:"+i+",g:"+r+",b:"+s+",a:"+o+"}":"HSV_OBJ"===t?"{h:"+l+",s:"+d+",v:"+u+"}":"HSVA_OBJ"===t?"{h:"+l+",s:"+d+",v:"+u+",a:"+o+"}":"unknown format"}var aj=Array.prototype.forEach,YE=Array.prototype.slice,mr={BREAK:{},extend:function(e){return this.each(YE.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))},this),e},defaults:function(e){return this.each(YE.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))},this),e},compose:function(){var e=YE.call(arguments);return function(){for(var t=YE.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e)if(aj&&e.forEach&&e.forEach===aj)e.forEach(t,i);else if(e.length===e.length+0){var s,r=void 0;for(r=0,s=e.length;r<s;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var o in e)if(t.call(i,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var r=void 0;return function(){var s=this,o=arguments,d=i||!r;clearTimeout(r),r=setTimeout(function l(){r=null,i||e.apply(s,o)},t),d&&e.apply(s,o)}},toArray:function(e){return e.toArray?e.toArray():YE.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},Zye=[{litmus:mr.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:QC},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:QC},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:QC},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:QC}}},{litmus:mr.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:mr.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:mr.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(mr.isNumber(e.r)&&mr.isNumber(e.g)&&mr.isNumber(e.b)&&mr.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(mr.isNumber(e.r)&&mr.isNumber(e.g)&&mr.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(mr.isNumber(e.h)&&mr.isNumber(e.s)&&mr.isNumber(e.v)&&mr.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(mr.isNumber(e.h)&&mr.isNumber(e.s)&&mr.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],KE=void 0,aB=void 0,lB=function(){aB=!1;var e=arguments.length>1?mr.toArray(arguments):arguments[0];return mr.each(Zye,function(t){if(t.litmus(e))return mr.each(t.conversions,function(i,r){if(KE=i.read(e),!1===aB&&!1!==KE)return aB=KE,KE.conversionName=r,KE.conversion=i,mr.BREAK}),mr.BREAK}),aB},lj=void 0,ZE={hsv_to_rgb:function(e,t,i){var r=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),o=i*(1-t),l=i*(1-s*t),d=i*(1-(1-s)*t),u=[[i,d,o],[l,i,o],[o,i,d],[o,l,i],[d,o,i],[i,o,l]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),s=Math.max(e,t,i),o=s-r,l=void 0;return 0===s?{h:NaN,s:0,v:0}:(l=e===s?(t-i)/o:t===s?2+(i-e)/o:4+(e-t)/o,(l/=6)<0&&(l+=1),{h:360*l,s:o/s,v:s/255})},rgb_to_hex:function(e,t,i){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),this.hex_with_component(r,0,i)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,i){return i<<(lj=8*t)|e&~(255<<lj)}},Jye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},vg=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},bg=function(){function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),tv=function n(e,t,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:n(s,t,i)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(i)},nv=function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},iv=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?n:e},Du=function(){function n(){if(vg(this,n),this.__state=lB.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return bg(n,[{key:"toString",value:function(){return QC(this)}},{key:"toHexString",value:function(){return QC(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function nL(n,e,t){Object.defineProperty(n,e,{get:function(){return"RGB"===this.__state.space||Du.recalculateRGB(this,e,t),this.__state[e]},set:function(r){"RGB"!==this.__state.space&&(Du.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=r}})}function iL(n,e){Object.defineProperty(n,e,{get:function(){return"HSV"===this.__state.space||Du.recalculateHSV(this),this.__state[e]},set:function(i){"HSV"!==this.__state.space&&(Du.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}Du.recalculateRGB=function(n,e,t){if("HEX"===n.__state.space)n.__state[e]=ZE.component_from_hex(n.__state.hex,t);else{if("HSV"!==n.__state.space)throw new Error("Corrupted color state");mr.extend(n.__state,ZE.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v))}},Du.recalculateHSV=function(n){var e=ZE.rgb_to_hsv(n.r,n.g,n.b);mr.extend(n.__state,{s:e.s,v:e.v}),mr.isNaN(e.h)?mr.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h},Du.COMPONENTS=["r","g","b","h","s","v","hex","a"],nL(Du.prototype,"r",2),nL(Du.prototype,"g",1),nL(Du.prototype,"b",0),iL(Du.prototype,"h"),iL(Du.prototype,"s"),iL(Du.prototype,"v"),Object.defineProperty(Du.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(Du.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=ZE.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var rv=function(){function n(e,t){vg(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return bg(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),cj={};mr.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(n,e){mr.each(n,function(t){cj[t]=e})});var tve=/(\d+(\.\d+)?)px/;function q0(n){if("0"===n||mr.isUndefined(n))return 0;var e=n.match(tve);return mr.isNull(e)?0:parseFloat(e[1])}var Di={makeSelectable:function(e,t){void 0===e||void 0===e.style||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var r=i,s=t;mr.isUndefined(s)&&(s=!0),mr.isUndefined(r)&&(r=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,r){var s=i||{},o=cj[t];if(!o)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(o);switch(o){case"MouseEvents":l.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,s.x||s.clientX||0,s.y||s.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var f=l.initKeyboardEvent||l.initKeyEvent;mr.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break;default:l.initEvent(t,s.bubbles||!1,s.cancelable||!0)}mr.defaults(l,r),e.dispatchEvent(l)},bind:function(e,t,i,r){return e.addEventListener?e.addEventListener(t,i,r||!1):e.attachEvent&&e.attachEvent("on"+t,i),Di},unbind:function(e,t,i,r){return e.removeEventListener?e.removeEventListener(t,i,r||!1):e.detachEvent&&e.detachEvent("on"+t,i),Di},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);-1===i.indexOf(t)&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Di},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);-1!==r&&(i.splice(r,1),e.className=i.join(" "))}else e.className=void 0;return Di},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return q0(t["border-left-width"])+q0(t["border-right-width"])+q0(t["padding-left"])+q0(t["padding-right"])+q0(t.width)},getHeight:function(e){var t=getComputedStyle(e);return q0(t["border-top-width"])+q0(t["border-bottom-width"])+q0(t["padding-top"])+q0(t["padding-bottom"])+q0(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do{i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent}while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},rL=function(n){function e(t,i){vg(this,e);var r=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),Di.bind(r.__checkbox,"change",function o(){s.setValue(!s.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return nv(e,n),bg(e,[{key:"setValue",value:function(i){var r=tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(rv),dj=function(n){function e(t,i,r){vg(this,e);var s=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=r,l=s;if(s.__select=document.createElement("select"),mr.isArray(o)){var d={};mr.each(o,function(u){d[u]=u}),o=d}return mr.each(o,function(u,f){var g=document.createElement("option");g.innerHTML=f,g.setAttribute("value",u),l.__select.appendChild(g)}),s.updateDisplay(),Di.bind(s.__select,"change",function(){l.setValue(this.options[this.selectedIndex].value)}),s.domElement.appendChild(s.__select),s}return nv(e,n),bg(e,[{key:"setValue",value:function(i){var r=tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return Di.isActive(this.__select)?this:(this.__select.value=this.getValue(),tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(rv),uj=function(n){function e(t,i){vg(this,e);var r=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=r;function o(){s.setValue(s.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),Di.bind(r.__input,"keyup",o),Di.bind(r.__input,"change",o),Di.bind(r.__input,"blur",function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),Di.bind(r.__input,"keydown",function(d){13===d.keyCode&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return nv(e,n),bg(e,[{key:"updateDisplay",value:function(){return Di.isActive(this.__input)||(this.__input.value=this.getValue()),tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(rv);function hj(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var sL=function(n){function e(t,i,r){vg(this,e);var s=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=r||{};return s.__min=o.min,s.__max=o.max,s.__step=o.step,s.__impliedStep=mr.isUndefined(s.__step)?0===s.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__step,s.__precision=hj(s.__impliedStep),s}return nv(e,n),bg(e,[{key:"setValue",value:function(i){var r=i;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=hj(i),this}}]),e}(rv),JE=function(n){function e(t,i,r){vg(this,e);var s=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r));s.__truncationSuspended=!1;var o=s,l=void 0;function u(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function g(q){var re=l-q.clientY;o.setValue(o.getValue()+re*o.__impliedStep),l=q.clientY}function T(){Di.unbind(window,"mousemove",g),Di.unbind(window,"mouseup",T),u()}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),Di.bind(s.__input,"change",function d(){var q=parseFloat(o.__input.value);mr.isNaN(q)||o.setValue(q)}),Di.bind(s.__input,"blur",function f(){u()}),Di.bind(s.__input,"mousedown",function B(q){Di.bind(window,"mousemove",g),Di.bind(window,"mouseup",T),l=q.clientY}),Di.bind(s.__input,"keydown",function(q){13===q.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,u())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return nv(e,n),bg(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():function nve(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}(this.getValue(),this.__precision),tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(sL);function fj(n,e,t,i,r){return i+(n-e)/(t-e)*(r-i)}var cB=function(n){function e(t,i,r,s,o){vg(this,e);var l=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:r,max:s,step:o})),d=l;function f(re){re.preventDefault();var se=d.__background.getBoundingClientRect();return d.setValue(fj(re.clientX,se.left,se.right,d.__min,d.__max)),!1}function g(){Di.unbind(window,"mousemove",f),Di.unbind(window,"mouseup",g),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}function B(re){var se=re.touches[0].clientX,ne=d.__background.getBoundingClientRect();d.setValue(fj(se,ne.left,ne.right,d.__min,d.__max))}function q(){Di.unbind(window,"touchmove",B),Di.unbind(window,"touchend",q),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}return l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),Di.bind(l.__background,"mousedown",function u(re){document.activeElement.blur(),Di.bind(window,"mousemove",f),Di.bind(window,"mouseup",g),f(re)}),Di.bind(l.__background,"touchstart",function T(re){1===re.touches.length&&(Di.bind(window,"touchmove",B),Di.bind(window,"touchend",q),B(re))}),Di.addClass(l.__background,"slider"),Di.addClass(l.__foreground,"slider-fg"),l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return nv(e,n),bg(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*i+"%",tv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(sL),oL=function(n){function e(t,i,r){vg(this,e);var s=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=s;return s.__button=document.createElement("div"),s.__button.innerHTML=void 0===r?"Fire":r,Di.bind(s.__button,"click",function(l){return l.preventDefault(),o.fire(),!1}),Di.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return nv(e,n),bg(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(rv),dB=function(n){function e(t,i){vg(this,e);var r=iv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));r.__color=new Du(r.getValue()),r.__temp=new Du(0);var s=r;r.domElement=document.createElement("div"),Di.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",Di.bind(r.__input,"keydown",function(re){13===re.keyCode&&g.call(this)}),Di.bind(r.__input,"blur",g),Di.bind(r.__selector,"mousedown",function(){Di.addClass(this,"drag").bind(window,"mouseup",function(){Di.removeClass(s.__selector,"drag")})}),Di.bind(r.__selector,"touchstart",function(){Di.addClass(this,"drag").bind(window,"touchend",function(){Di.removeClass(s.__selector,"drag")})});var o=document.createElement("div");function l(re){B(re),Di.bind(window,"mousemove",B),Di.bind(window,"touchmove",B),Di.bind(window,"mouseup",u),Di.bind(window,"touchend",u)}function d(re){q(re),Di.bind(window,"mousemove",q),Di.bind(window,"touchmove",q),Di.bind(window,"mouseup",f),Di.bind(window,"touchend",f)}function u(){Di.unbind(window,"mousemove",B),Di.unbind(window,"touchmove",B),Di.unbind(window,"mouseup",u),Di.unbind(window,"touchend",u),T()}function f(){Di.unbind(window,"mousemove",q),Di.unbind(window,"touchmove",q),Di.unbind(window,"mouseup",f),Di.unbind(window,"touchend",f),T()}function g(){var re=lB(this.value);!1!==re?(s.__color.__state=re,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function T(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}function B(re){-1===re.type.indexOf("touch")&&re.preventDefault();var se=s.__saturation_field.getBoundingClientRect(),ne=re.touches&&re.touches[0]||re,je=(ne.clientX-se.left)/(se.right-se.left),Dt=1-(ne.clientY-se.top)/(se.bottom-se.top);return Dt>1?Dt=1:Dt<0&&(Dt=0),je>1?je=1:je<0&&(je=0),s.__color.v=Dt,s.__color.s=je,s.setValue(s.__color.toOriginal()),!1}function q(re){-1===re.type.indexOf("touch")&&re.preventDefault();var se=s.__hue_field.getBoundingClientRect(),Se=1-((re.touches&&re.touches[0]||re).clientY-se.top)/(se.bottom-se.top);return Se>1?Se=1:Se<0&&(Se=0),s.__color.h=360*Se,s.setValue(s.__color.toOriginal()),!1}return mr.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),mr.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),mr.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),mr.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),mr.extend(o.style,{width:"100%",height:"100%",background:"none"}),pj(o,"top","rgba(0,0,0,0)","#000"),mr.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function rve(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(r.__hue_field),mr.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),Di.bind(r.__saturation_field,"mousedown",l),Di.bind(r.__saturation_field,"touchstart",l),Di.bind(r.__field_knob,"mousedown",l),Di.bind(r.__field_knob,"touchstart",l),Di.bind(r.__hue_field,"mousedown",d),Di.bind(r.__hue_field,"touchstart",d),r.__saturation_field.appendChild(o),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return nv(e,n),bg(e,[{key:"updateDisplay",value:function(){var i=lB(this.getValue());if(!1!==i){var r=!1;mr.each(Du.COMPONENTS,function(l){if(!mr.isUndefined(i[l])&&!mr.isUndefined(this.__color.__state[l])&&i[l]!==this.__color.__state[l])return r=!0,{}},this),r&&mr.extend(this.__color.__state,i)}mr.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,o=255-s;mr.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,pj(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),mr.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(rv),ive=["-moz-","-o-","-webkit-","-ms-",""];function pj(n,e,t,i){n.style.background="",mr.each(ive,function(r){n.style.cssText+="background: "+r+"linear-gradient("+e+", "+t+" 0%, "+i+" 100%); "})}var ave=function(e,t){var i=e[t];return mr.isArray(arguments[2])||mr.isObject(arguments[2])?new dj(e,t,arguments[2]):mr.isNumber(i)?mr.isNumber(arguments[2])&&mr.isNumber(arguments[3])?mr.isNumber(arguments[4])?new cB(e,t,arguments[2],arguments[3],arguments[4]):new cB(e,t,arguments[2],arguments[3]):mr.isNumber(arguments[4])?new JE(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new JE(e,t,{min:arguments[2],max:arguments[3]}):mr.isString(i)?new uj(e,t):mr.isFunction(i)?new oL(e,t,""):mr.isBoolean(i)?new rL(e,t):null},cve=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function lve(n){setTimeout(n,1e3/60)},dve=function(){function n(){vg(this,n),this.backgroundElement=document.createElement("div"),mr.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Di.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),mr.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Di.bind(this.backgroundElement,"click",function(){e.hide()})}return bg(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),mr.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,i=function r(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Di.unbind(t.domElement,"webkitTransitionEnd",r),Di.unbind(t.domElement,"transitionend",r),Di.unbind(t.domElement,"oTransitionEnd",r)};Di.bind(this.domElement,"webkitTransitionEnd",i),Di.bind(this.domElement,"transitionend",i),Di.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Di.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Di.getHeight(this.domElement)/2+"px"}}]),n}();!function(e,t){var i=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var s=i.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}}(function Kye(n){if(n&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var eT="Default",tT=function(){try{return!!window.localStorage}catch{return!1}}(),nT=void 0,_j=!0,WC=void 0,aL=!1,yj=[],fc=function n(e){var t=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Di.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=mr.defaults(i,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),i=mr.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),mr.isUndefined(i.load)?i.load={preset:eT}:i.preset&&(i.load.preset=i.preset),mr.isUndefined(i.parent)&&i.hideable&&yj.push(this),i.resizable=mr.isUndefined(i.parent)&&i.resizable,i.autoPlace&&mr.isUndefined(i.scrollable)&&(i.scrollable=!0);var r=tT&&"true"===localStorage.getItem(jC(0,"isLocal")),s=void 0,o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:i.load.preset},set:function(T){t.parent?t.getRoot().preset=T:i.load.preset=T,function mve(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}(this),t.revert()}},width:{get:function(){return i.width},set:function(T){i.width=T,uL(t,T)}},name:{get:function(){return i.name},set:function(T){i.name=T,o&&(o.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(T){i.closed=T,i.closed?Di.addClass(t.__ul,n.CLASS_CLOSED):Di.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=T?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return r},set:function(T){tT&&(r=T,T?Di.bind(window,"unload",s):Di.unbind(window,"unload",s),localStorage.setItem(jC(0,"isLocal"),T))}}}),mr.isUndefined(i.parent)){if(this.closed=i.closed||!1,Di.addClass(this.domElement,n.CLASS_MAIN),Di.makeSelectable(this.domElement,!1),tT&&r){t.useLocalStorage=!0;var l=localStorage.getItem(jC(0,"gui"));l&&(i.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,Di.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),i.closeOnTop?(Di.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Di.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Di.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{void 0===i.closed&&(i.closed=!0);var d=document.createTextNode(i.name);Di.addClass(d,"controller-name"),o=lL(t,d),Di.addClass(this.__ul,n.CLASS_CLOSED),Di.addClass(o,"title"),Di.bind(o,"click",function(T){return T.preventDefault(),t.closed=!t.closed,!1}),i.closed||(this.closed=!1)}i.autoPlace&&(mr.isUndefined(i.parent)&&(_j&&(WC=document.createElement("div"),Di.addClass(WC,"dg"),Di.addClass(WC,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(WC),_j=!1),WC.appendChild(this.domElement),Di.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||uL(t,i.width)),this.__resizeHandler=function(){t.onResizeDebounced()},Di.bind(window,"resize",this.__resizeHandler),Di.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Di.bind(this.__ul,"transitionend",this.__resizeHandler),Di.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&function pve(n){var e=void 0;function t(s){return s.preventDefault(),n.width+=e-s.clientX,n.onResize(),e=s.clientX,!1}function i(){Di.removeClass(n.__closeButton,fc.CLASS_DRAG),Di.unbind(window,"mousemove",t),Di.unbind(window,"mouseup",i)}function r(s){return s.preventDefault(),e=s.clientX,Di.addClass(n.__closeButton,fc.CLASS_DRAG),Di.bind(window,"mousemove",t),Di.bind(window,"mouseup",i),!1}n.__resize_handle=document.createElement("div"),mr.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Di.bind(n.__resize_handle,"mousedown",r),Di.bind(n.__closeButton,"mousedown",r),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}(this),this.saveToLocalStorageIfPossible=s=function(){tT&&"true"===localStorage.getItem(jC(0,"isLocal"))&&localStorage.setItem(jC(0,"gui"),JSON.stringify(t.getSaveObject()))},i.parent||function f(){var g=t.getRoot();g.width+=1,mr.defer(function(){g.width-=1})}()};function lL(n,e,t){var i=document.createElement("li");return e&&i.appendChild(e),t?n.__ul.insertBefore(i,t):n.__ul.appendChild(i),n.onResize(),i}function vj(n){Di.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&Di.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function cL(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];t.innerHTML=e?t.value+"*":t.value}function bj(n,e){var t=n.getRoot(),i=t.__rememberedObjects.indexOf(e.object);if(-1!==i){var r=t.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(t.__rememberedObjectIndecesToControllers[i]=r={}),r[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,o=void 0;if(s[n.preset])o=s[n.preset];else{if(!s[eT])return;o=s[eT]}if(o[i]&&void 0!==o[i][e.property]){var l=o[i][e.property];e.initialValue=l,e.setValue(l)}}}}function iT(n,e,t,i){if(void 0===e[t])throw new Error('Object "'+e+'" has no property "'+t+'"');var r=void 0;if(i.color)r=new dB(e,t);else{var s=[e,t].concat(i.factoryArgs);r=ave.apply(n,s)}i.before instanceof rv&&(i.before=i.before.__li),bj(n,r),Di.addClass(r.domElement,"c");var o=document.createElement("span");Di.addClass(o,"property-name"),o.innerHTML=r.property;var l=document.createElement("div");l.appendChild(o),l.appendChild(r.domElement);var d=lL(n,l,i.before);return Di.addClass(d,fc.CLASS_CONTROLLER_ROW),Di.addClass(d,r instanceof dB?"color":Jye(r.getValue())),function hve(n,e,t){if(t.__li=e,t.__gui=n,mr.extend(t,{options:function(o){if(arguments.length>1){var l=t.__li.nextElementSibling;return t.remove(),iT(n,t.object,t.property,{before:l,factoryArgs:[mr.toArray(arguments)]})}if(mr.isArray(o)||mr.isObject(o)){var d=t.__li.nextElementSibling;return t.remove(),iT(n,t.object,t.property,{before:d,factoryArgs:[o]})}},name:function(o){return t.__li.firstElementChild.firstElementChild.innerHTML=o,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof cB){var i=new JE(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});mr.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var o=t[s],l=i[s];t[s]=i[s]=function(){var d=Array.prototype.slice.call(arguments);return l.apply(i,d),o.apply(t,d)}}),Di.addClass(e,"has-slider"),t.domElement.insertBefore(i.domElement,t.domElement.firstElementChild)}else if(t instanceof JE){var r=function(o){if(mr.isNumber(t.__min)&&mr.isNumber(t.__max)){var l=t.__li.firstElementChild.firstElementChild.innerHTML,d=t.__gui.__listening.indexOf(t)>-1;t.remove();var u=iT(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return u.name(l),d&&u.listen(),u}return o};t.min=mr.compose(r,t.min),t.max=mr.compose(r,t.max)}else t instanceof rL?(Di.bind(e,"click",function(){Di.fakeEvent(t.__checkbox,"click")}),Di.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof oL?(Di.bind(e,"click",function(){Di.fakeEvent(t.__button,"click")}),Di.bind(e,"mouseover",function(){Di.addClass(t.__button,"hover")}),Di.bind(e,"mouseout",function(){Di.removeClass(t.__button,"hover")})):t instanceof dB&&(Di.addClass(e,"color"),t.updateDisplay=mr.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=mr.compose(function(s){return n.getRoot().__preset_select&&t.isModified()&&cL(n.getRoot(),!0),s},t.setValue)}(n,d,r),n.__controllers.push(r),r}function jC(n,e){return document.location.href+"."+e}function dL(n,e,t){var i=document.createElement("option");i.innerHTML=e,i.value=e,n.__preset_select.appendChild(i),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function xj(n,e){e.style.display=n.useLocalStorage?"block":"none"}function uL(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function uB(n,e){var t={};return mr.each(n.__rememberedObjects,function(i,r){var s={};mr.each(n.__rememberedObjectIndecesToControllers[r],function(l,d){s[d]=e?l.initialValue:l.getValue()}),t[r]=s}),t}function wj(n){0!==n.length&&cve.call(window,function(){wj(n)}),mr.each(n,function(e){e.updateDisplay()})}fc.toggleHide=function(){aL=!aL,mr.each(yj,function(n){n.domElement.style.display=aL?"none":""})},fc.CLASS_AUTO_PLACE="a",fc.CLASS_AUTO_PLACE_CONTAINER="ac",fc.CLASS_MAIN="main",fc.CLASS_CONTROLLER_ROW="cr",fc.CLASS_TOO_TALL="taller-than-window",fc.CLASS_CLOSED="closed",fc.CLASS_CLOSE_BUTTON="close-button",fc.CLASS_CLOSE_TOP="close-top",fc.CLASS_CLOSE_BOTTOM="close-bottom",fc.CLASS_DRAG="drag",fc.DEFAULT_WIDTH=245,fc.TEXT_CLOSED="Close Controls",fc.TEXT_OPEN="Open Controls",fc._keydownHandler=function(n){"text"!==document.activeElement.type&&(72===n.which||72===n.keyCode)&&fc.toggleHide()},Di.bind(window,"keydown",fc._keydownHandler,!1),mr.extend(fc.prototype,{add:function(e,t){return iT(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return iT(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;mr.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&WC.removeChild(this.domElement);var e=this;mr.each(this.__folders,function(t){e.removeFolder(t)}),Di.unbind(window,"keydown",fc._keydownHandler,!1),vj(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new fc(t);this.__folders[e]=i;var r=lL(this,i.domElement);return Di.addClass(r,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],vj(e);var t=this;mr.each(e.__folders,function(i){e.removeFolder(i)}),mr.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=Di.getOffset(e.__ul).top,i=0;mr.each(e.__ul.childNodes,function(r){e.autoPlace&&r===e.__save_row||(i+=Di.getHeight(r))}),window.innerHeight-t-20<i?(Di.addClass(e.domElement,fc.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(Di.removeClass(e.domElement,fc.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&mr.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:mr.debounce(function(){this.onResize()},50),remember:function(){if(mr.isUndefined(nT)&&((nT=new dve).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;mr.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&function fve(n){var e=n.__save_row=document.createElement("li");Di.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),Di.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",Di.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",Di.addClass(i,"button"),Di.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",Di.addClass(r,"button"),Di.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",Di.addClass(s,"button"),Di.addClass(s,"revert");var o=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?mr.each(n.load.remembered,function(g,T){dL(n,T,T===n.preset)}):dL(n,eT,!1),Di.bind(o,"change",function(){for(var g=0;g<n.__preset_select.length;g++)n.__preset_select[g].innerHTML=n.__preset_select[g].value;n.preset=this.value}),e.appendChild(o),e.appendChild(t),e.appendChild(i),e.appendChild(r),e.appendChild(s),tT){var l=document.getElementById("dg-local-explain"),d=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(jC(0,"isLocal"))&&d.setAttribute("checked","checked"),xj(n,l),Di.bind(d,"change",function(){n.useLocalStorage=!n.useLocalStorage,xj(n,l)})}var f=document.getElementById("dg-new-constructor");Di.bind(f,"keydown",function(g){g.metaKey&&(67===g.which||67===g.keyCode)&&nT.hide()}),Di.bind(t,"click",function(){f.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),nT.show(),f.focus(),f.select()}),Di.bind(i,"click",function(){n.save()}),Di.bind(r,"click",function(){var g=prompt("Enter a new preset name.");g&&n.saveAs(g)}),Di.bind(s,"click",function(){n.revert()})}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&uL(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=uB(this)),e.folders={},mr.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=uB(this),cL(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[eT]=uB(this,!0)),this.load.remembered[e]=uB(this),this.preset=e,dL(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){mr.each(this.__controllers,function(t){this.getRoot().load.remembered?bj(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),mr.each(this.__folders,function(t){t.revert(t)}),e||cL(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&wj(this.__listening)},updateDisplay:function(){mr.each(this.__controllers,function(e){e.updateDisplay()}),mr.each(this.__folders,function(e){e.updateDisplay()})}});var Cj=fc;class Mj{constructor(e="eventDisplay",t){var i;this.three=t,this.guiParameters={rotate:void 0,axis:void 0,lowRes:void 0,eventData:void 0,geometries:void 0,labels:void 0},this.maxPositionX=4e3,this.maxPositionY=4e3,this.maxPositionZ=4e3,this.gui=new Cj,this.gui.domElement.id="gui",this.gui.domElement.style.cssText="position: absolute; right: 0; top: 2rem; z-index: 11;",(null!==(i=document.getElementById(e))&&void 0!==i?i:document.body).appendChild(this.gui.domElement),this.geomFolder=null,this.eventFolder=null,this.labelsFolder=null,this.sceneManager=t.getSceneManager()}clear(){const e=document.getElementById("gui");e?.remove(),this.geomFolder=null}addGeometryFolder(){null===this.geomFolder&&(this.geomFolder=this.gui.addFolder(il.GEOMETRIES_ID)),this.guiParameters.geometries={show:!0,wireframe:!1},this.geomFolder.add(this.guiParameters.geometries,"show").name("Show").listen().onChange(i=>{this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(il.GEOMETRIES_ID),i)}),this.geomFolder.add(this.guiParameters.geometries,"wireframe").name("Wireframe").listen().onChange(i=>{this.sceneManager.wireframeGeometries(i)})}addGeometry(e,t){const{name:i,material:r,visible:s}=e,o=r?.color;this.guiParameters[i]={show:s,color:o??"#000000",x:0,y:0,z:0,detectorOpacity:1,remove:this.removeOBJ(e),scale:1};const l=this.geomFolder.addFolder(i);l.addColor(this.guiParameters[i],"color").name("Color").onChange(T=>this.sceneManager.changeObjectColor(e,T)),l.add(this.guiParameters[i],"detectorOpacity",0,1).name("Opacity").onFinishChange(T=>this.sceneManager.setGeometryOpacity(e,T)),l.add(this.guiParameters[i],"show").name("Show").listen().onChange(T=>this.sceneManager.objectVisibility(e,T)),l.add(this.guiParameters[i],"scale",0,1e3).name("Scale").onChange(T=>{this.sceneManager.scaleObject(e,T)}),l.add(this.guiParameters[i],"x",-this.maxPositionX,this.maxPositionX).name("X").onChange(T=>this.sceneManager.getObjectPosition(i).setX(T)),l.add(this.guiParameters[i],"y",-this.maxPositionY,this.maxPositionY).name("Y").onChange(T=>this.sceneManager.getObjectPosition(i).setY(T)),l.add(this.guiParameters[i],"z",-this.maxPositionZ,this.maxPositionZ).name("Z").onChange(T=>this.sceneManager.getObjectPosition(i).setZ(T)),l.add(this.guiParameters[i],"remove").name("Remove")}removeOBJ(e){return()=>{const t=this.geomFolder.__folders[e.name];t&&this.geomFolder.removeFolder(t),this.sceneManager.removeGeometry(e)}}addEventDataFolder(){null!==this.eventFolder&&this.gui.removeFolder(this.eventFolder),this.eventFolder=this.gui.addFolder("Event Data"),this.guiParameters.eventData={show:!0,depthTest:!0},this.eventFolder.add(this.guiParameters.eventData,"show").name("Show").listen().onChange(i=>this.sceneManager.groupVisibility(il.EVENT_DATA_ID,i)),this.eventFolder.add(this.guiParameters.eventData,"depthTest").name("Depth Test").listen().onChange(i=>this.three.eventDataDepthTest(i))}addEventDataTypeFolder(e){const t=this.eventFolder.addFolder(e);this.guiParameters.eventData[e]=!0,t.add(this.guiParameters.eventData,e).name("Show").listen().onChange(r=>this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(il.EVENT_DATA_ID).getObjectByName(e),r))}addCollection(e,t,i,r){const s=this.eventFolder.__folders[e];if(!s)return;this.guiParameters[t]={show:!0,color:0,randomColor:()=>this.three.getColorManager().collectionColorRandom(t),resetCut:()=>this.sceneManager.groupVisibility(t,!0,il.EVENT_DATA_ID)};const o=s.addFolder(t);o.add(this.guiParameters[t],"show").name("Show").listen().onChange(u=>{const f=this.sceneManager.getObjectByName(il.EVENT_DATA_ID).getObjectByName(t);this.sceneManager.objectVisibility(f,u)});const d=o.addColor(this.guiParameters[t],"color").name("Color");if(d.onChange(u=>this.three.getColorManager().collectionColor(t,u)),d.setValue(r?.getHex()),o.add(this.guiParameters[t],"randomColor").name("Random Color"),i){const u=o.addFolder("Cuts");u.add(this.guiParameters[t],"resetCut").name("Reset cuts");for(const f of i)u.add({minValue:f.minValue},"minValue",f.minValue,f.maxValue).name("min "+f.field).onChange(B=>{f.minValue=B,this.sceneManager.collectionFilter(t,i)}),u.add({maxValue:f.maxValue},"maxValue",f.minValue,f.maxValue).name("max "+f.field).onChange(B=>{f.maxValue=B,this.sceneManager.collectionFilter(t,i)})}}addLabelsFolder(e){if(null!==this.labelsFolder)return;const{onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:o}=e;this.labelsFolder=this.gui.addFolder(il.LABELS_ID),this.guiParameters.labels={show:!0,size:1,color:"#a8a8a8",saveLabels:s,loadLabels:o},this.labelsFolder.add(this.guiParameters.labels,"show").name("Show").listen().onChange(t),this.labelsFolder.add(this.guiParameters.labels,"size",0,10).name("Size").onFinishChange(i),this.labelsFolder.addColor(this.guiParameters.labels,"color").name("Color").onChange(r),this.labelsFolder.add(this.guiParameters.labels,"saveLabels").name("Save Labels"),this.labelsFolder.add(this.guiParameters.labels,"loadLabels").name("Load Labels")}addLabel(e,t){this.guiParameters[e]={show:!0,color:11513775};const i=this.labelsFolder.addFolder(e);i.add(this.guiParameters[e],"show").name("Show").listen().onChange(o=>{const l=this.sceneManager.getObjectByName(il.LABELS_ID).getObjectByName(e);this.sceneManager.objectVisibility(l,o)}),i.addColor(this.guiParameters[e],"color").name("\xc7olor").onChange(o=>this.sceneManager.changeObjectColor(this.sceneManager.getObjectByName(e),o)),this.guiParameters[e].removeLabel=()=>{t?.(),this.removeLabel(e,i)},i.add(this.guiParameters[e],"removeLabel").name("Remove")}removeLabel(e,t){t||(t=this.labelsFolder.__folders[e]),t&&this.labelsFolder.removeFolder(t)}getEventDataTypeFolder(e){return this.eventFolder.__folders[e]}}var xm=function(n){return n.CHARGE="charge",n.MOM="mom",n.VERTEX="vertex",n}(xm||{});class vve{constructor(e,t,i,r){this.colorManager=e,this.allColorByOptions=[{key:xm.CHARGE,name:"Charge "+Jy.getPrettySymbol("charge"),initialize:this.initChargeColorOptions.bind(this),apply:this.applyChargeColorOptions.bind(this)},{key:xm.MOM,name:"Momentum "+Jy.getPrettySymbol("mom"),initialize:this.initMomColorOptions.bind(this),apply:this.applyMomColorOptions.bind(this)},{key:xm.VERTEX,name:"Vertex",apply:this.applyVertexColorOptions.bind(this)}],this.chargeColors={"-1":"#ff0000",0:"#ff0000",1:"#ff0000"},this.momColors={min:{value:0,color:"#ff0000"},max:{value:5e4,color:"#ff0000"}},this.collectionName=t.name,this.colorOptionsFolder=t.addChild("Color Options"),this.colorOptionsFolder.addConfig("color",{label:"Color",color:i?`#${i?.getHexString()}`:void 0,onChange:s=>this.colorManager.collectionColor(this.collectionName,s)}),this.colorOptionsFolder.addConfig("button",{label:"Random",onClick:()=>this.colorManager.collectionColorRandom(this.collectionName)}),r?.length>0&&(this.colorByOptions=this.allColorByOptions.filter(s=>r.includes(s.key)),this.initColorByOptions(),this.colorByOptions.forEach(s=>{var o;return null===(o=s.initialize)||void 0===o?void 0:o.call(s)}),this.onlySelectedColorByOption())}initColorByOptions(){this.selectedColorByOption=this.colorByOptions[0].key,this.colorOptionsFolder.addConfig("select",{label:"Color by",options:this.colorByOptions.map(e=>e.name),onChange:e=>{var t;const i=this.colorByOptions.find(r=>r.name===e);this.selectedColorByOption=i?.key,null===(t=i?.apply)||void 0===t||t.call(i),this.onlySelectedColorByOption()}})}initChargeColorOptions(){[-1,0,1].forEach(e=>{this.colorOptionsFolder.addConfig("color",{label:`${Jy.getPrettySymbol("charge")}=${e}`,group:xm.CHARGE,color:this.chargeColors[e],onChange:t=>{this.chargeColors[e]=t,this.selectedColorByOption===xm.CHARGE&&this.colorManager.colorObjectsByProperty(t,this.collectionName,i=>this.shouldColorByCharge(i,e))}})})}applyChargeColorOptions(){[-1,0,1].forEach(e=>{this.colorManager.colorObjectsByProperty(this.chargeColors[e],this.collectionName,t=>this.shouldColorByCharge(t,e))})}shouldColorByCharge(e,t){var i;return Math.sign(1/parseInt(null===(i=e?.dparams)||void 0===i?void 0:i[4]))===t||e?.charge===t||void 0}initMomColorOptions(){Object.entries(this.momColors).forEach(([e,t])=>{this.colorOptionsFolder.addConfig("slider",{label:Jy.getPrettySymbol("mom")+" "+e,group:xm.MOM,min:this.momColors.min.value,max:this.momColors.max.value,value:this.momColors[e].value,step:10,allowCustomValue:!0,onChange:i=>{this.momColors[e].value=i,this.selectedColorByOption===xm.MOM&&(this.colorByMomentum("min"),this.colorByMomentum("max"))}}),this.colorOptionsFolder.addConfig("color",{label:Jy.getPrettySymbol("mom")+" "+e+" color",group:xm.MOM,color:t.color,onChange:i=>{this.momColors[e].color=i,this.selectedColorByOption===xm.MOM&&this.colorByMomentum(e)}})})}applyMomColorOptions(){this.colorByMomentum("min"),this.colorByMomentum("max")}colorByMomentum(e){this.colorManager.colorObjectsByProperty(this.momColors[e].color,this.collectionName,t=>{const i=this.getMomentum(t),r=(this.momColors.min.value+this.momColors.max.value)/2;return"max"===e&&i>r&&i<this.momColors.max.value||"min"===e&&i<r&&i>this.momColors.min.value||void 0})}getMomentum(e){var t,i;return null!==(t=e?.dparams)&&void 0!==t&&t[4]?Math.abs(1/parseFloat(null===(i=e?.dparams)||void 0===i?void 0:i[4])):e?.mom}applyVertexColorOptions(){this.colorManager.colorTracksByVertex(this.collectionName)}onlySelectedColorByOption(){this.colorOptionsFolder.configs.forEach(e=>{e.hidden=void 0!==e.group&&e.group!==this.selectedColorByOption})}}class hL{constructor(e,t){this.phoenixMenuRoot=e,this.three=t,this.geomFolder=null,this.eventFolder=null,this.labelsFolder=null,this.sceneManager=t.getSceneManager()}clear(){this.phoenixMenuRoot&&(this.phoenixMenuRoot.truncate(),this.phoenixMenuRoot=void 0),this.geomFolder=null,this.eventFolder=null,this.labelsFolder=null}addGeometryFolder(){null===this.geomFolder&&(this.geomFolder=this.phoenixMenuRoot.addChild("Detector",e=>{this.sceneManager.groupVisibility(il.GEOMETRIES_ID,e)},"perspective")),this.geomFolder.addConfig("checkbox",{label:"Wireframe",isChecked:!1,onChange:e=>{this.sceneManager.wireframeGeometries(e)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.01,allowCustomValue:!0,onChange:e=>{this.sceneManager.setGeometryOpacity(this.sceneManager.getObjectByName(il.GEOMETRIES_ID),e)}}).addConfig("slider",{label:"Scale",min:0,max:20,step:.01,allowCustomValue:!0,onChange:e=>{this.sceneManager.scaleObject(this.sceneManager.getObjectByName(il.GEOMETRIES_ID),e)}})}addGeometry(e,t){const{name:i,material:r,visible:s}=e,o=r?.color;let l=this.geomFolder;t&&(l=this.geomFolder.findInTreeOrCreate(t));let d=i.lastIndexOf(" > ");d<0?d=0:d+=3;const u=l.addChild(i.substring(d),f=>{this.sceneManager.objectVisibility(e,f)});u.toggleState=s,u.addConfig("color",{label:"Color",color:o?`#${new fr(o).getHexString()}`:void 0,onChange:f=>{this.sceneManager.changeObjectColor(e,f)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.05,allowCustomValue:!0,onChange:f=>{this.sceneManager.setGeometryOpacity(e,f)}}).addConfig("button",{label:"Remove",onClick:()=>{u.remove(),this.sceneManager.removeGeometry(e)}})}addEventDataFolder(){null!==this.eventFolder&&(this.eventFolderState=this.eventFolder.getNodeState(),this.eventFolder.remove()),this.eventFolder=this.phoenixMenuRoot.addChild("Event Data",e=>{this.sceneManager.groupVisibility(il.EVENT_DATA_ID,e)},"event-folder"),this.eventFolder.addConfig("checkbox",{label:"Depth Test",isChecked:!0,onChange:e=>{this.three.eventDataDepthTest(e)}})}addEventDataTypeFolder(e){this.eventFolder.addChild(e,t=>{this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(il.EVENT_DATA_ID).getObjectByName(e),t)})}addCollection(e,t,i,r){const s=this.eventFolder.children.find(d=>d.name===e);if(!s)return;const o=s.addChild(t,d=>{const u=this.sceneManager.getObjectByName(il.EVENT_DATA_ID).getObjectByName(t);this.sceneManager.objectVisibility(u,d)});this.addDrawOptions(o,t),i&&i.length>0&&this.addCutOptions(o,t,i);const l=[];"Tracks"===s.name&&l.push(xm.CHARGE,xm.MOM,xm.VERTEX),new vve(this.three.getColorManager(),o,r,l)}addCutOptions(e,t,i){const r=e.addChild("Cut Options");r.addConfig("label",{label:"Cuts"}).addConfig("button",{label:"Reset cuts",onClick:()=>{this.sceneManager.groupVisibility(t,!0,il.EVENT_DATA_ID);for(const s of i)s.reset()}});for(const s of i)r.addConfig("rangeSlider",{label:Jy.getPrettySymbol(s.field),min:s.minValue,max:s.maxValue,step:s.step,value:s.minValue,highValue:s.maxValue,enableMin:s.minCutActive,enableMax:s.maxCutActive,onChange:({value:o,highValue:l})=>{s.minValue=o,s.maxValue=l,this.sceneManager.collectionFilter(t,i)},setEnableMin:o=>{s.enableMinCut(o),this.sceneManager.collectionFilter(t,i)},setEnableMax:o=>{s.enableMaxCut(o),this.sceneManager.collectionFilter(t,i)}})}addDrawOptions(e,t){const i=e.addChild("Draw Options");i.addConfig("slider",{label:"Opacity",min:.1,step:.1,max:1,onChange:r=>{const s=this.sceneManager.getObjectByName(il.EVENT_DATA_ID);if(s){const o=s.getObjectByName(t);o&&this.sceneManager.setGeometryOpacity(o,r)}}}),i.addConfig("checkbox",{label:"Wireframe",onChange:r=>this.sceneManager.wireframeObjects(this.sceneManager.getObjectByName(il.EVENT_DATA_ID).getObjectByName(t),r)})}addLabelsFolder(e){if(null!==this.labelsFolder)return;const{onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:o}=e;this.labelsFolder=this.phoenixMenuRoot.addChild(il.LABELS_ID,t,"info"),this.labelsFolder.addConfig("slider",{label:"Size",min:0,max:10,step:.01,allowCustomValue:!0,onChange:i}),this.labelsFolder.addConfig("color",{label:"Color",color:"#a8a8a8",onChange:r}),this.labelsFolder.addConfig("button",{label:"Save Labels",onClick:s}),this.labelsFolder.addConfig("button",{label:"Load Labels",onClick:o})}addLabel(e,t){let i=this.labelsFolder.children.find(r=>r.name===e);i||(i=this.labelsFolder.addChild(e,r=>{const s=this.sceneManager.getObjectByName(il.LABELS_ID).getObjectByName(e);this.sceneManager.objectVisibility(s,r)}),i.addConfig("color",{label:"Color",color:"#a8a8a8",onChange:r=>{this.sceneManager.changeObjectColor(this.sceneManager.getObjectByName(e),r)}}),i.addConfig("button",{label:"Remove",onClick:()=>{t?.(),this.removeLabel(e,i)}}))}removeLabel(e,t){var i;t||(t=null===(i=this.labelsFolder)||void 0===i?void 0:i.children.find(r=>r.name===e)),t?.remove()}getEventDataTypeFolder(e){return this.eventFolder.children.find(t=>t.name===e)}loadEventFolderState(){this.eventFolderState&&this.eventFolder.loadStateFromJSON(this.eventFolderState)}}const Sj=n=>{try{return localStorage.getItem(n)}catch(e){console.warn("Exception in localStorage",e)}},xve=[{name:"Cavern to ID",positions:[{position:[66388.95051168812,5264.228603228927,-46910.7848593543],duration:1e3},{position:[12834.18729094943,677.7571205763458,135.68755273443463],duration:2e3},{position:[312.02688693297375,25.884223757326,270.10019006776236],duration:3500},{position:[263.3640855132258,19.874838262525053,-318.16541790248885],duration:3e3},{position:[5534.140362338047,234.03507981484574,-2933.619479808285],duration:2e3},{position:[2681.277288705242,646.5795158318147,5628.5248735111745],duration:1e3},{position:[-6062.586283740076,790.5876682946184,1381.1675900848818],duration:1e3},{position:[-1766.7693725879053,1007.1048030984678,-5928.901341784575],duration:1e3},{position:[12814.982506255355,2516.987185037266,-22891.902734328327],duration:1e3}],animateEventAfterInterval:5e3,collisionDuration:6e3}];class wve{constructor(e){this.three=e,this.uiMenus=[],this.geomFolderAdded=!1,this.labelsFolderAdded=!1}init(e){this.clearUI(),this.configuration=e,this.showStats(e.elementId),this.uiMenus=[],e.enableDatGUIMenu&&this.uiMenus.push(new Mj(e.elementId,this.three)),e.phoenixMenuRoot&&this.uiMenus.push(new hL(e.phoenixMenuRoot,this.three)),e.forceColourTheme?this.setDarkTheme("dark"==e.forceColourTheme.toLocaleLowerCase()):this.detectColorScheme(),this.stateManager=new yg,this.stateManager.setPhoenixMenuRoot(e.phoenixMenuRoot)}showStats(e="eventDisplay"){this.stats=new(Yye()),this.stats.showPanel(0),this.stats.dom.className="ui-element",this.stats.dom.id="statsElement",this.stats.domElement.style.cssText="position: absolute; left: 0px; cursor: pointer; opacity: 0.9; z-index: 10; bottom: 0px;";let t=document.getElementById(e);null==t&&(t=document.body),t.appendChild(this.stats.dom)}updateUI(){this.stats.update()}clearUI(){this.uiMenus.forEach(e=>e.clear()),this.geomFolderAdded=!1,this.labelsFolderAdded=!1}addGeomFolder(){this.geomFolderAdded=!0,this.uiMenus.forEach(e=>e.addGeometryFolder())}addGeometry(e,t){this.geomFolderAdded||this.addGeomFolder(),this.uiMenus.forEach(i=>i.addGeometry(e,t))}addEventDataFolder(){this.uiMenus.forEach(e=>e.addEventDataFolder())}addEventDataTypeFolder(e){this.uiMenus.forEach(t=>t.addEventDataTypeFolder(e))}addCollection(e,t,i,r){this.uiMenus.forEach(s=>s.addCollection(e,t,i,r))}addLabelsFolder(){const e=this.three.getSceneManager();this.labelsFolderAdded=!0;const t=l=>{e.objectVisibility(e.getObjectByName(il.LABELS_ID),l)},i=l=>{const d=e.getObjectByName(il.LABELS_ID);e.scaleObject(d,l)},r=l=>{const d=e.getObjectByName(il.LABELS_ID);e.changeObjectColor(d,l)},s=()=>{var l,d;const u=null===(d=null===(l=this.configuration)||void 0===l?void 0:l.eventDataLoader)||void 0===d?void 0:d.getLabelsObject();u&&rB(JSON.stringify(u),"phoenix-labels.json")},o=()=>{this.loadLabelsFile()};this.uiMenus.forEach(l=>l.addLabelsFolder({onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:o}))}addLabel(e){this.labelsFolderAdded||this.addLabelsFolder(),this.uiMenus.forEach(t=>t?.addLabel(e,()=>this.removeLabel(e)))}removeLabel(e,t){var i,r,s;this.three.getSceneManager().removeLabel(e);const o=e.split(" > "),l=null===(i=this.configuration.eventDataLoader)||void 0===i?void 0:i.getLabelsObject();null===(s=null===(r=l?.[o[0]])||void 0===r?void 0:r[o[1]])||void 0===s||delete s[o[2]],t&&this.uiMenus.forEach(d=>d.removeLabel(e))}geometryVisibility(e,t){const i=this.three.getSceneManager();i.objectVisibility(i.getObjectByName(e),t)}rotateStartAngleClipping(e){const t=this.stateManager.getOpeningClippingAngle();this.three.setClippingAngle(e,t),this.stateManager.setStartClippingAngle(e)}rotateOpeningAngleClipping(e){const t=this.stateManager.getStartClippingAngle();this.three.setClippingAngle(t,e),this.stateManager.setOpeningClippingAngle(e)}setClipping(e){this.three.setClipping(e),this.stateManager.setClippingEnabled(e)}detectColorScheme(){let e=!1;Sj("theme")?"dark"===Sj("theme")&&(e=!0):window.matchMedia&&matchMedia("(prefers-color-scheme: dark)").matches&&(e=!0),this.darkTheme=e,this.setDarkTheme(e)}setDarkTheme(e){const t=e?"dark":"light";((n,e)=>{try{localStorage.setItem("theme",e)}catch(t){console.warn("Exception in localStorage",t)}})(0,t),document.documentElement.setAttribute("data-theme",t),this.three.setDarkColor(e)}getDarkTheme(){return this.darkTheme}setAutoRotate(e){this.three.autoRotate(e)}setShowAxis(e){this.three.getSceneManager().setAxis(e)}translateCartesianGrid(e){this.three.getSceneManager().translateCartesianGrid(e)}translateCartesianLabels(e){this.three.getSceneManager().translateCartesianLabels(e)}showLabels(e){this.three.getSceneManager().showLabels(e)}setShowCartesianGrid(e,t,i){typeof i>"u"?this.three.getSceneManager().setCartesianGrid(e,t):this.three.getSceneManager().setCartesianGrid(e,t,i)}getCartesianGridConfig(){return this.three.getSceneManager().getCartesianGridConfig()}setShowEtaPhiGrid(e){this.three.getSceneManager().setEtaPhiGrid(e)}show3DMousePoints(e){this.three.show3DMousePoints(e)}show3DDistance(e){this.three.show3DDistance(e)}shiftCartesianGridByPointer(){this.three.shiftCartesianGrid()}getPresetViews(){var e;return null===(e=this.configuration)||void 0===e?void 0:e.presetViews}getPresetAnimations(){var e,t;return null!==(e=this.configuration)&&void 0!==e&&e.presetAnimations?null===(t=this.configuration)||void 0===t?void 0:t.presetAnimations:xve}displayView(e){this.three.animateCameraTransform(e.cameraPos,e.cameraTarget,1e3),e.clipping!=Tu.NotForced&&(this.rotateStartAngleClipping(e.clippingStartAngle),this.rotateOpeningAngleClipping(e.clippingOpeningAngle),this.setClipping(e.clipping==Tu.On))}toggleOrthographicView(e){this.three.swapCameras(e)}setOverlayRenderer(e){this.three.setOverlayRenderer(e)}enableKeyboardControls(){document.addEventListener("keydown",e=>{var t,i,r;if(!["input","textarea"].includes(null===(t=e.target)||void 0===t?void 0:t.tagName.toLowerCase())&&e.shiftKey&&("KeyT"===e.code&&this.setDarkTheme(!this.getDarkTheme()),null!==(i=this.configuration)&&void 0!==i&&i.presetViews&&e.code.startsWith("Digit"))){const o=parseInt(e.code.slice(-1))-1;null!==(r=this.configuration.presetViews)&&void 0!==r&&r[o]&&this.displayView(this.configuration.presetViews[o])}})}loadLabelsFile(){var e;const t=null===(e=this.configuration)||void 0===e?void 0:e.eventDataLoader,i=t?.getLabelsObject();t&&i&&NW(r=>{const s=JSON.parse(r);for(const o of Object.keys(s))for(const l of Object.keys(s[o])){const d=t.getCollection(l);for(const u of Object.keys(s[o][l])){const f=s[o][l][u],g=d[u].uuid,T=t.addLabelToEventObject(f,l,Number(u));this.addLabel(T),this.three.addLabelToObject(f,g,T)}}})}loadEventFolderPhoenixMenuState(){const e=this.uiMenus.find(t=>t instanceof hL);e?.loadEventFolderState()}getUIMenus(){return this.uiMenus}}class Cve{constructor(){this.infoLoggerList=[],this.maxEntries=10}add(e,t){this.infoLoggerList.length>this.maxEntries&&this.infoLoggerList.pop(),this.infoLoggerList.unshift(t?t+": "+e:e)}getInfoLoggerList(){return this.infoLoggerList}}class El{constructor(e,t,i,r=1,s=!0,o=!0){this.field=e,this.minValue=t,this.maxValue=i,this.step=r,this.minCutActive=s,this.maxCutActive=o,this.defaultMinValue=t,this.defaultMaxValue=i,this.defaultApplyMinValue=s,this.defaultApplyMaxValue=o}enableMaxCut(e){this.maxCutActive=e}enableMinCut(e){this.minCutActive=e}cutPassed(e){return(!this.maxCutActive||e<=this.maxValue)&&(!this.minCutActive||e>this.minValue)}reset(){this.minValue=this.defaultMinValue,this.maxValue=this.defaultMaxValue,this.minCutActive=this.defaultApplyMinValue,this.maxCutActive=this.defaultApplyMaxValue}}const Sve=new Rt,Ej=new class J_e{constructor(e=new Rt,t=new Rt){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){yW.subVectors(e,this.start),Y4.subVectors(this.end,this.start);const i=Y4.dot(Y4);let s=Y4.dot(yW)/i;return t&&(s=_d(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},fL=new gA,Tj=new Rt,fB=new _m;class Eve{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new Dj,this.unassigned=new Dj,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.vertices.push(new Tve(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(i){const r=i.geometry;if(void 0!==r){const s=r.attributes.position;if(void 0!==s)for(let o=0,l=s.count;o<l;o++){const d=new Rt;d.fromBufferAttribute(s,o).applyMatrix4(i.matrixWorld),t.push(d)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let i=0,r=t.length;i<r;i++)if(t[i].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const i=this.faces;let r=-1/0,s=1/0;for(let o=0,l=i.length;o<l;o++){const d=i[o],u=d.distanceToPoint(e.origin),f=d.normal.dot(e.direction);if(u>0&&f>=0)return null;const g=0!==f?-u/f:0;if(!(g<=0)&&(f>0?s=Math.min(g,s):r=Math.max(g,r),r>s))return null}return e.at(r!==-1/0?r:s,t),t}intersectsRay(e){return null!==this.intersectRay(e,Sve)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let i=e.outside;for(;null!==i.next&&i.next.face===e;)i=i.next;return this.assigned.removeSubList(t,i),t.prev=i.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const i=this.removeAllVerticesFromFace(e);if(void 0!==i)if(void 0===t)this.unassigned.appendChain(i);else{let r=i;do{const s=r.next;t.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,t):this.unassigned.append(r),r=s}while(null!==r)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const i=t.next;let r=this.tolerance,s=null;for(let o=0;o<e.length;o++){const l=e[o];if(0===l.mark){const d=l.distanceToPoint(t.point);if(d>r&&(r=d,s=l),r>1e3*this.tolerance)break}}null!==s&&this.addVertexToFace(t,s),t=i}while(null!==t)}return this}computeExtremes(){const e=new Rt,t=new Rt,i=[],r=[];for(let s=0;s<3;s++)i[s]=r[s]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let s=0,o=this.vertices.length;s<o;s++){const l=this.vertices[s],d=l.point;for(let u=0;u<3;u++)d.getComponent(u)<e.getComponent(u)&&(e.setComponent(u,d.getComponent(u)),i[u]=l);for(let u=0;u<3;u++)d.getComponent(u)>t.getComponent(u)&&(t.setComponent(u,d.getComponent(u)),r[u]=l)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:i,max:r}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),i=t.min,r=t.max;let s=0,o=0;for(let T=0;T<3;T++){const B=r[T].point.getComponent(T)-i[T].point.getComponent(T);B>s&&(s=B,o=T)}const l=i[o],d=r[o];let u,f;s=0,Ej.set(l.point,d.point);for(let T=0,B=this.vertices.length;T<B;T++){const q=e[T];if(q!==l&&q!==d){Ej.closestPointToPoint(q.point,!0,Tj);const re=Tj.distanceToSquared(q.point);re>s&&(s=re,u=q)}}s=-1,fL.setFromCoplanarPoints(l.point,d.point,u.point);for(let T=0,B=this.vertices.length;T<B;T++){const q=e[T];if(q!==l&&q!==d&&q!==u){const re=Math.abs(fL.distanceToPoint(q.point));re>s&&(s=re,f=q)}}const g=[];if(fL.distanceToPoint(f.point)<0){g.push(xg.create(l,d,u),xg.create(f,d,l),xg.create(f,u,d),xg.create(f,l,u));for(let T=0;T<3;T++){const B=(T+1)%3;g[T+1].getEdge(2).setTwin(g[0].getEdge(B)),g[T+1].getEdge(1).setTwin(g[B+1].getEdge(0))}}else{g.push(xg.create(l,u,d),xg.create(f,l,d),xg.create(f,d,u),xg.create(f,u,l));for(let T=0;T<3;T++){const B=(T+1)%3;g[T+1].getEdge(2).setTwin(g[0].getEdge((3-T)%3)),g[T+1].getEdge(0).setTwin(g[B+1].getEdge(1))}}for(let T=0;T<4;T++)this.faces.push(g[T]);for(let T=0,B=e.length;T<B;T++){const q=e[T];if(q!==l&&q!==d&&q!==u&&q!==f){s=this.tolerance;let re=null;for(let se=0;se<4;se++){const ne=this.faces[se].distanceToPoint(q.point);ne>s&&(s=ne,re=this.faces[se])}null!==re&&this.addVertexToFace(q,re)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const i=this.faces[t];0===i.mark&&e.push(i)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const i=this.assigned.first().face;let r=i.outside;do{const s=i.distanceToPoint(r.point);s>t&&(t=s,e=r),r=r.next}while(null!==r&&r.face===i);return e}}computeHorizon(e,t,i,r){let s;this.deleteFaceVertices(i),i.mark=1,s=null===t?t=i.getEdge(0):t.next;do{const o=s.twin,l=o.face;0===l.mark&&(l.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,l,r):r.push(s)),s=s.next}while(s!==t);return this}addAdjoiningFace(e,t){const i=xg.create(e,t.tail(),t.head());return this.faces.push(i),i.getEdge(-1).setTwin(t.twin),i.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let i=null,r=null;for(let s=0;s<t.length;s++){const l=this.addAdjoiningFace(e,t[s]);null===i?i=l:l.next.setTwin(r),this.newFaces.push(l.face),r=l}return i.next.setTwin(r),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class xg{constructor(){this.normal=new Rt,this.midpoint=new Rt,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,i){const r=new xg,s=new pL(e,r),o=new pL(t,r),l=new pL(i,r);return s.next=l.prev=o,o.next=s.prev=l,l.next=o.prev=s,r.edge=s,r.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),i=this.edge.next.head();return fB.set(e.point,t.point,i.point),fB.getNormal(this.normal),fB.getMidpoint(this.midpoint),this.area=fB.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class pL{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class Tve{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class Dj{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class Dve extends Qs{constructor(e=[]){super();const t=[],i=[],s=(new Eve).setFromPoints(e).faces;for(let o=0;o<s.length;o++){const l=s[o];let d=l.edge;do{const u=d.head().point;t.push(u.x,u.y,u.z),i.push(l.normal.x,l.normal.y,l.normal.z),d=d.next}while(d!==l.edge)}this.setAttribute("position",new ks(t,3)),this.setAttribute("normal",new ks(i,3))}}const Ep={Hits:new fr(16711680),Tracks:new fr(16711680),Jets:new fr(2200782),CaloClusters:new fr(16765286),MuonChambers:new fr(16711680),Vertices:new fr(16765286),MissingEnergy:new fr(16777215),PlanarCaloCells:new fr(16774810)};class mL{static step(e){const t=e.q/(e.unitC*e.p);let i,r,s,o,l,d,u;const f=AL.get(e.pos),g=e.dir.clone().cross(f).multiplyScalar(t),T=se=>{i=se*se,r=se/2;const ne=e.pos.clone().add(e.dir.clone().multiplyScalar(r)).add(g.clone().multiplyScalar(i/8));s=AL.get(ne),l=e.dir.clone().add(g.clone().multiplyScalar(r)).cross(s).multiplyScalar(t),d=e.dir.clone().add(l.clone().multiplyScalar(r)).cross(s).multiplyScalar(t);const De=e.pos.clone().add(e.dir.clone().multiplyScalar(se)).add(d.clone().multiplyScalar(i/2));o=AL.get(De),u=e.dir.clone().add(d.clone().multiplyScalar(se)).cross(o).multiplyScalar(t);const Se=g.clone().sub(l).sub(d).add(u);return se*(Math.abs(Se.x)+Math.abs(Se.y)+Math.abs(Se.z))};let B=T(e.stepSize);for(;B>2e-4;)e.stepSize*=.5,B=T(e.stepSize);const q=e.stepSize,re=Math.pow(q,2);return e.pos.add(e.dir.clone().multiplyScalar(q)).add(g.clone().add(l).add(d).multiplyScalar(re/6)),e.dir.add(g.clone().add(l.clone().multiplyScalar(2)).add(d.clone().multiplyScalar(2)).add(u).multiplyScalar(q/6)),e.dir.normalize(),e.stepSize}static propagate(e,t,i,r,s=-1,o=1e3,l=(()=>!0)){const d=new Ive;d.pos=e,d.dir=t,d.p=i,d.q=r,d.maxStepSize=s;const u=[];for(;d.pathLength<o;){d.pathLength+=mL.step(d);const f=JSON.parse(JSON.stringify(d));if(u.push({pos:f.pos,dir:f.dir}),!l(f.pos))break}return u}}class Ive{constructor(){this.pos=new Rt(0,0,0),this.dir=new Rt(0,0,0),this.p=0,this.q=1,this.unitC=3.3333,this.stepSize=1e3,this.maxStepSize=10,this.pathLength=0}}class AL{static get(e){return new Rt(0,0,2)}}class rT{static extrapolationLimit(e){return!(e.z>3e3||Math.sqrt(e.x*e.x+e.y*e.y)>1100)}static getTracksWithRungeKutta(e){const t=Object.assign({},e);for(const r of Object.keys(t))for(const s of t[r])s.pos=rT.extrapolateTrackPositions(s);return{}}static extrapolateTrackPositions(e,t=rT.extrapolationLimit){const i=e.dparams,r=i[0],o=i[2];let l=i[3];const d=i[4];let u;l<0&&(l+=Math.PI),u=0!==d?Math.abs(1/d):Number.MAX_VALUE;const f=Math.round(u*d),g=Hf.sphericalToCartesian(u,l,o),T=Hf.sphericalToCartesian(r,l,o),B=[];B.push([T.x,T.y,T.z]);const q=g.clone();q.normalize();const se=mL.propagate(T,q,u,f,5,1500,t).map(ne=>[ne.pos.x,ne.pos.y,ne.pos.z]);return B.concat(se)}}class xd{static getTracks(e){var t;const i=new JW,r=new wye({lineWidth:2});for(const o of e){if((null===(t=o.pos)||void 0===t?void 0:t.length)>2||(o.dparams&&(o.pos=rT.extrapolateTrackPositions(o)),o.extended=!0),o.pos.length<2){console.log("Track too short, and extrapolation failed.");continue}o?.dparams&&(o?.phi||(o.phi=o.dparams[2]),o?.eta||(o.eta=Hf.thetaToEta(o.dparams[3])),o?.d0||(o.d0=o.dparams[0]),o?.z0||(o.z0=o.dparams[1]));const l=o.pos.map(g=>new Rt(g[0],g[1],g[2])),u=new cO(l).getPoints(50),f=o.color?parseInt(o.color,16):Ep.Tracks.getHex();o.tid=i.addTrack(u,f),o.material=r}i.process();const s=new Yo(i,r);s.name="Track";for(const o of e)o.uuid=s.uuid;return s}static getTrack(e){var t;(null===(t=e.pos)||void 0===t?void 0:t.length)>2||(e.dparams&&(e.pos=rT.extrapolateTrackPositions(e)),e.extended=!0);const i=e.pos;if(i.length<2)return void console.log("Track too short, and extrapolation failed.");e?.dparams&&(e?.phi||(e.phi=e.dparams[2]),e?.eta||(e.eta=Hf.thetaToEta(e.dparams[3])),e?.d0||(e.d0=e.dparams[0]),e?.z0||(e.z0=e.dparams[1]));const r=e.color?parseInt(e.color,16):Ep.Tracks.getHex(),s=[];for(let re=0;re<i.length;re++){s.push(new Rt(i[re][0],i[re][1],i[re][2]));const se=Math.sqrt(i[re][0]*i[re][0]+i[re][1]*i[re][1]+i[re][2]*i[re][2]);Math.acos(i[re][2]/se)}const o=new cO(s),l=new Kb(o,void 0,2),d=new $Q({color:r}),u=new Yo(l,d),f=o.getPoints(50),g=(new Qs).setFromPoints(f),T=new wc({color:r,linewidth:2}),B=new gg(g,T);B.name="Track";const q=new $l;q.add(u),q.add(B);for(const re of[u,q,B])re.userData=Object.assign({},e),re.name="Track";return e.uuid=q.uuid,q}static getJet(e){var t;const r=e.phi,s=e.theta?e.theta:Hf.etaToTheta(e.eta),o=.2*(e.energy?e.energy:e.et),l=Math.sin(r),d=Math.cos(r),u=Math.sin(s),f=Math.cos(s),g=new Rt(.5*o*d*u,.5*o*l*u,.5*o*f),T=e.coneR?o*Math.sin(e.coneR):.1*o,B=d*u,q=l*u,re=f,se=new Rt(0,1,0),ne=new Rt(B,q,re),De=new zc;De.setFromUnitVectors(se,ne);const Se=new kC(T,10,o,50,50,!1),je=new yd({color:null!==(t=e.color)&&void 0!==t?t:Ep.Jets,opacity:.3,transparent:!0});je.opacity=.5;const Dt=new Yo(Se,je);return Dt.position.copy(g),Dt.quaternion.copy(De),Dt.userData=Object.assign({},e),Dt.name="Jet",e.uuid=Dt.uuid,Dt}static getHits(e){let t,r="Point",s=3,o=!1;if(!(e.length>0))return console.log("No hits! Aborting from getHits."),new Ol;{const f=e[0];Array.isArray(f)?(o=!0,t={pos:e}):(t=e,"type"in f&&(r=f.type))}("Line"===r||"Box"===r)&&(s=6);const l=e.length*s;o&&(length=l);const d=new Float32Array(l);let u=0;for(const f of e)for(let g=0;g<s;++g,++u)d[u]=o?f[g]:f.pos[g];switch(r){case"Point":return xd.hitsToPoints(d,e,t);case"CircularPoint":return xd.hitsToCircularPoints(d,e,t);case"Line":return xd.hitsToLines(d,e,t);case"Box":return xd.hitsToBoxes(d,e,t);default:return void console.log("ERROR: Unknown hit type!")}}static hitsToPoints(e,t,i){var s;const o=new Qs;o.setAttribute("position",new To(e,3)),o.computeBoundingSphere();const d=new c1({size:10,color:null!==(s=parseInt(t[0].color))&&void 0!==s?s:Ep.Hits}),u=new $b(o,d);return u.userData={},u.name="Hit",t.uuid=u.uuid,u}static hitsToCircularPoints(e,t,i){var r,s;const o=new Qs;o.setAttribute("position",new To(e,3)),o.computeBoundingSphere();const l=document.createElement("canvas");l.width=128,l.height=128;const d=l.getContext("2d");d.clearRect(0,0,128,128),d.fillStyle="white",d.beginPath(),d.arc(64,64,64,0,2*Math.PI),d.fill();const u=new RQ(l),f=new c1({size:null!==(r=t[0].size)&&void 0!==r?r:10,color:null!==(s=t[0].color)&&void 0!==s?s:Ep.Hits,map:u,alphaMap:u,alphaTest:.5}),g=new $b(o,f);return g.userData={},g.name="CircularHit",t.uuid=g.uuid,g}static hitsToLines(e,t,i){var r;const s=new Qs;s.setAttribute("position",new To(e,3)),s.computeBoundingSphere();const o=new wc({linewidth:2,color:null!==(r=t.color)&&void 0!==r?r:Ep.Hits}),l=new hc(s,o);return l.userData={},l.name="LineHit",t.uuid=l.uuid,l}static hitsToBoxes(e,t,i){var r;const s=[];for(let u=0;u<e.length;u+=6){const f=new Mp(e[u+3],e[u+4],e[u+5]);f.translate(e[u],e[u+1],e[u+2]),s.push(f)}const o=GO(s);o.computeBoundingSphere();const l=new _g({color:null!==(r=t.color)&&void 0!==r?r:Ep.Hits}),d=new Yo(o,l);return d.userData={},d.name="BoxHit",t.uuid=d.uuid,d}static getCluster(e,t=1800,i=3600,r=.03){var s;const l=null!==(s=e.side)&&void 0!==s?s:40,d=xd.getCaloCube(e,l,e.energy*r),u=xd.getCaloPosition(e,t,i);return d.position.copy(u),d.lookAt(new Rt(0,0,0)),d.userData=Object.assign({},e),d.name="Cluster",e.uuid=d.uuid,d}static getCaloPosition(e,t=1800,i=3600,r=!0){var s,o,l;const d=null!==(s=e.theta)&&void 0!==s?s:Hf.etaToTheta(e.eta),u=r?null!==(o=e.radius)&&void 0!==o?o:t+i:null!==(l=e.radius)&&void 0!==l?l:t,f=Hf.sphericalToCartesian(u,d,e.phi);if(e.z&&f.setLength(f.length()*e.z/Math.abs(f.z)),!e.radius&&!e.z){Math.abs(f.z)>i&&f.setLength(f.length()*i/Math.abs(f.z));const g=f.x*f.x+f.y*f.y,T=t*t;g>T&&f.setLength(f.length()*Math.sqrt(T)/Math.sqrt(g))}return f}static getCaloCube(e,t=30,i=30){var r,s,o,l,d;const u=null!==(r=e.side)&&void 0!==r?r:t;let f=null!==(s=e.length)&&void 0!==s?s:i;f<u&&(f=u);const g=new Mp(u,u,f),T=new _g({color:null!==(o=e.color)&&void 0!==o?o:Ep.CaloClusters,opacity:null!==(l=e.opacity)&&void 0!==l?l:1,transparent:1!=(null!==(d=e.opacity)&&void 0!==d?d:1)});return new Yo(g,T)}static getCaloCell(e){const o=xd.getCaloCube(e,30,30),l=xd.getCaloPosition(e,1700,2e3);return o.position.copy(l),e.radius||e.z?e.z&&!e.radius&&o.lookAt(new Rt(l.x,l.y,0)):o.lookAt(new Rt(0,0,0)),e.radius&&o.lookAt(new Rt(0,0,l.z)),o.userData=Object.assign({},e),o.name="Cluster",e.uuid=o.uuid,o}static getPlanarCaloCells(e){var t;const i=[];for(const o of e){const l=o.pos;if(!l)continue;const d=.22*o.energy,u=o.cellSize,f=o.plane,g=new Mp(u,u,d);g.translate(l[0],l[1],f[3]+d/2);const T=new zc;T.setFromUnitVectors(new Rt(0,0,1),new Rt(...f.slice(0,3))),g.applyQuaternion(T),i.push(g)}const r=new _g({color:null!==(t=e[0].color)&&void 0!==t?t:Ep.PlanarCaloCells}),s=new Yo(GO(i),r);s.userData=Object.assign({},e[0]),s.name="PlanarCaloCell";for(const o of e)o.uuid=s.uuid;return s}static getPlanarCaloCell(e){var t;const i=e.pos;if(!i)return;const r=.22*e.energy,s=e.cellSize,o=e.plane,l=new Mp(s,s,r),d=new Ol,u=new _g({color:null!==(t=e.color)&&void 0!==t?t:Ep.PlanarCaloCells}),f=new Yo(l,u);d.add(f);const g=new Rt(...i.slice(0,2),o[3]+r/2);f.position.copy(g);const T=new zc;return T.setFromUnitVectors(new Rt(0,0,1),new Rt(...o.slice(0,3))),d.quaternion.copy(T),d.userData=Object.assign({},e),d.name="PlanarCaloCell",e.uuid=d.uuid,d}static getVertex(e){var t,i;const r=new $y(null!==(t=e.size)&&void 0!==t?t:3),s=new _g({color:null!==(i=e.color)&&void 0!==i?i:Ep.Vertices}),o=new Yo(r,s);return"pos"in e?(o.position.x=e.pos[0],o.position.y=e.pos[1],o.position.z=e.pos[2]):(o.position.x=e.x,o.position.y=e.y,o.position.z=e.z),o.userData=Object.assign({},e),o.name="Vertex",e.uuid=o.uuid,o}static getMissingEnergy(e){var t;const i=[];i.push(new Rt(0,0,0)),i.push(new Rt(e.etx,e.ety,0));const r=(new Qs).setFromPoints(i),s=new Zb({linewidth:2,dashSize:2,color:null!==(t=e.color)&&void 0!==t?t:Ep.MissingEnergy}),o=new gg(r,s);return o.computeLineDistances(),o.userData=Object.assign({},e),o.name="Missing Energy",e.uuid=o.uuid,o}static getIrregularCaloCell(e){const t=[];for(let l=0;l<24;l+=3)t.push(new Rt(e.vtx[l],e.vtx[l+1],e.vtx[l+2]));const i=new Dve(t),r=new fr("rgb("+e.color[0].toString()+","+e.color[1].toString()+","+e.color[2].toString()+")"),s=new _g({color:r,transparent:!0,opacity:e.opacity}),o=new Yo(i,s);return o.userData=Object.assign({},e),o.name="IrregularCaloCell",e.uuid=o.uuid,o}}const Ij=(n,e,t)=>`${n} > ${e} > ${t}`;class vA{constructor(){this.labelsObject={},this.loadingManager=new cx,this.stateManager=new yg}buildEventData(e,t,i,r){this.graphicsLibrary=t,this.ui=i,this.eventData=e,this.loadObjectTypes(e);const s=e["event number"]?e["event number"]:e.eventNumber,o=e["run number"]?e["run number"]:e.runNumber;r.add("Event#"+s+" from run#"+o,"Loaded"),this.stateManager.eventMetadata={runNumber:o,eventNumber:s}}getEventsList(e){const t=[];for(const i in e)null!==e[i]&&t.push(i);return t}getCollections(){if(!this.eventData)return null;const e=[];for(const t in this.eventData)if(this.eventData[t]&&"object"==typeof this.eventData[t])for(const i in this.eventData[t])e.push(i);return e}getCollection(e){if(!this.eventData)return null;for(const t in this.eventData)if(this.eventData[t])for(const i in this.eventData[t])if(i===e)return this.eventData[t][i]}loadObjectTypes(e){const t=parseFloat(Math.PI.toFixed(2));if(e.Tracks){const i=[new El("phi",-t,t,.01),new El("eta",-4,4,.1),new El("chi2",0,100),new El("dof",0,100),new El("pT",0,5e4,.1),new El("z0",-30,30,.1),new El("d0",-30,30,.1)];this.addObjectType(e.Tracks,xd.getTrack,"Tracks",!1,i)}if(e.Jets){const i=[new El("phi",-t,t,.01),new El("eta",-5,5,.1),new El("energy",0,6e5,100)],s=this.addScaleOptions("jetsScale","Jets Scale",o=>{this.graphicsLibrary.getSceneManager().scaleJets(o)});this.addObjectType(e.Jets,xd.getJet,"Jets",!1,i,s)}if(e.Hits&&this.addObjectType(e.Hits,xd.getHits,"Hits",!0),e.CaloClusters){const i=[new El("phi",-t,t,.01),new El("eta",-5,5,.1),new El("energy",0,1e4)],s=this.addScaleOptions("caloClustersScale","CaloClusters Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("CaloClusters",o,"z")});this.addObjectType(e.CaloClusters,xd.getCluster,"CaloClusters",!1,i,s)}if(e.CaloCells){const i=[new El("phi",-t,t,.01),new El("eta",-5,5,.1),new El("energy",0,1e4)],s=this.addScaleOptions("caloCellsScale","CaloCells Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("CaloCells",o,"z")});this.addObjectType(e.CaloCells,xd.getCaloCell,"CaloCells",!1,i,s)}if(e.PlanarCaloCells){const i=[new El("energy",0,1e4)],s=this.addScaleOptions("planarCaloCellsScale","PlanarCaloCells Scale",l=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("PlanarCaloCells",l,"z")}),o={};for(const l in e.PlanarCaloCells){const d=e.PlanarCaloCells[l],u=d.plane,f=new Rt(...u.slice(0,3)).normalize();d.cells.forEach(g=>g.plane=[...f.toArray(),u[3]]),o[l]=d.cells}this.addObjectType(o,xd.getPlanarCaloCell,"PlanarCaloCells",!1,i,s)}if(e.IrregularCaloCells){const i=[new El("layer",0,10),new El("energy",0,1e4)],s=this.addScaleOptions("IrregularCaloCellsScale","IrregularCaloCells Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("IrregularCaloCells",o,"z")});this.addObjectType(e.IrregularCaloCells,xd.getIrregularCaloCell,"IrregularCaloCells",!1,i,s)}if(e.Muons){const i=[new El("phi",-t,t,.01),new El("eta",-4,4,.1),new El("energy",0,1e4),new El("pT",0,5e4)];this.addObjectType(e.Muons,this.getCompoundTrack,"Muons",!1,i)}if(e.Photons){const i=[new El("phi",-t,t,.01),new El("eta",-4,4,.1),new El("energy",0,1e4),new El("pT",0,5e4)];this.addObjectType(e.Photons,this.getCompoundCluster,"Photons",!1,i)}if(e.Electrons){const i=[new El("phi",-t,t,.01),new El("eta",-4,4,.1),new El("energy",0,1e4),new El("pT",0,5e4)];this.addObjectType(e.Electrons,this.getCompoundTrack,"Electrons",!1,i)}if(e.Vertices){const i=[new El("vertexType",0,5)],s=this.addScaleOptions("verticesScale","Vertices Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("Vertices",o)});this.addObjectType(e.Vertices,xd.getVertex,"Vertices",!1,i,s)}e.MissingEnergy&&this.addObjectType(e.MissingEnergy,xd.getMissingEnergy,"MissingEnergy",!1,[],(r,s)=>{const o=l=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("MissingEnergy",l)};r&&r.add({jetsScale:100},"jetsScale",1,200).name("Size (%)").onChange(o),s&&s.addConfig("slider",{label:"Size (%)",value:100,min:1,max:200,allowCustomValue:!0,onChange:o})})}addObjectType(e,t,i,r=!1,s,o){var l,d;const u=this.graphicsLibrary.addEventDataTypeGroup(i),f=this.getObjectTypeCollections(e);this.ui.addEventDataTypeFolder(i);for(const B of f){const q=e[B];console.log(`${i} collection ${B} has ${q.length} constituents.`),0!=q.length?(this.addCollection(q,B,t,i,u,r),s=s?.filter(re=>re.field in q[0]),this.ui.addCollection(i,B,s)):console.log("Skipping")}const g=null===(l=this.ui.getUIMenus().find(B=>B instanceof Mj))||void 0===l?void 0:l.getEventDataTypeFolder(i),T=null===(d=this.ui.getUIMenus().find(B=>B instanceof hL))||void 0===d?void 0:d.getEventDataTypeFolder(i);o?.(g,T)}addCollection(e,t,i,r,s,o){const l=new $l;if(l.name=t,o){const d=i.bind(this)(e,r);d&&l.add(d)}else for(const d of e){const u=i.bind(this)(d,r);u&&l.add(u)}s.add(l)}getObjectTypeCollections(e){const t=[];for(const i in e)null!==e[i]&&t.push(i);return t}getCompoundTrack(e,t=""){return this.getCompound(e,t,!0,!1)}getCompoundCluster(e,t=""){return this.getCompound(e,t,!1,!0)}getCompound(e,t="",i=!1,r=!1){const s=new $l;if("LinkedClusters"in e&&e.LinkedClusters)for(const o of e.LinkedClusters){const l=o.split(":")[0],d=o.split(":")[1];if(l&&d&&this.eventData.CaloClusters&&this.eventData.CaloClusters[l]){const u=this.eventData.CaloClusters[l][d];if(u){const f=xd.getCluster(u);f.name=t+" Cluster",s.add(f)}}}else if(r){const l=xd.getCluster({energy:e?.energy,phi:e?.phi,eta:e?.eta});l.name=t+" Cluster",s.add(l)}if("LinkedTracks"in e&&e.LinkedTracks)for(const o of e.LinkedTracks){const l=o.split(":")[0],d=o.split(":")[1];if(l&&d&&this.eventData.Tracks&&this.eventData.Tracks[l]){const u=this.eventData.Tracks[l][d];if(u){const f=xd.getTrack(u);f?(f.name=t+" Track",s.add(f)):console.log("WARNING: failed to get a track back.")}}}else if(i){new Rt(0,0,0);const l=Hf.etaToTheta(e.eta),d=e.pt/Math.cos(Math.PI/2-l);let u=0;"pdgId"in e&&(u=e.pdgId>0?1:-1);const g=xd.getTrack({dparams:[0,0,e.phi,l,u/d]});g?(g.name=t+" Track",s.add(g)):console.log("WARNING: failed to get a track back.")}return e.uuid=s.uuid,s.name=t,s}getEventMetadata(){const e=[],t=[[{keys:["runNumber","run number"],label:"Run"},{keys:["eventNumber","event number"],label:"Event"},{keys:["ls"],label:"LS"},{keys:["lumiBlock"],label:"LumiBlock"}],[{keys:["time"],label:"Data recorded"}]],i=Object.keys(this.eventData);for(const r of t){const s={};for(const o of r)for(const l of o.keys)if(i.includes(l)&&l in this.eventData){s[o.label]=this.eventData[l];break}Object.keys(s).length>0&&e.push({label:Object.keys(s).join(" / "),value:Object.values(s).join(" / ")})}return e}addLabelToEventObject(e,t,i){var r,s;for(const o in this.eventData)if(null!==(s=null===(r=this.eventData)||void 0===r?void 0:r[o])&&void 0!==s&&s[t])return this.labelsObject[o]=this.labelsObject[o]||{},this.labelsObject[o][t]=this.labelsObject[o][t]||{},this.labelsObject[o][t][i]=e,Ij(o,t,i)}getLabelsObject(){return this.labelsObject}addScaleOptions(e,t,i){return(r,s)=>{r&&r.add({[e]:1},e,.001,100).name(t).onChange(i),s&&s.addConfig("slider",{label:t,value:1,min:.001,step:.01,max:100,allowCustomValue:!0,onChange:i})}}}class sT extends vA{constructor(){super(),this.data={}}process(e){console.log("Processing JiveXML event data"),this.data=e}getEventData(){const i=(new DOMParser).parseFromString(this.data,"text/xml").getElementsByTagName("Event")[0],r={eventNumber:i.getAttribute("eventNumber"),runNumber:i.getAttribute("runNumber"),lumiBlock:i.getAttribute("lumiBlock"),time:i.getAttribute("dateTime"),Hits:void 0,Tracks:{},Jets:{},CaloClusters:{},CaloCells:{},PlanarCaloCells:{},Vertices:{},Electrons:{},Muons:{},Photons:{},MissingEnergy:{}};return this.getPixelClusters(i,r),this.getSCTClusters(i,r),this.getTRT_DriftCircles(i,r),this.getMuonPRD(i,"MDT",r),this.getRPC(i,r),this.getMuonPRD(i,"TGC",r),this.getMuonPRD(i,"CSCD",r),this.getMuonPRD(i,"MM",r),this.getMuonPRD(i,"STGC",r),this.getTracks(i,r),this.getJets(i,r),this.getCaloClusters(i,r),this.getCaloCells(i,"LAr",r),this.getCaloCells(i,"HEC",r),this.getCaloCells(i,"Tile",r),this.getVertices(i,r),this.getMissingEnergy(i,r),this.getElectrons(i,r),this.getMuons(i,r),this.getPhotons(i,r),r}getNumberArrayFromHTML(e,t){let i=[];const r=e.getElementsByTagName(t);return r.length&&(i=r[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number)),i}getStringArrayFromHTML(e,t){return e.getElementsByTagName(t)[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(String)}getPositionOfHit(e,t){for(const i in t.Hits)for(const r of t.Hits[i])if(null==r)console.log("Empty hit");else if("id"in r&&r.id==e)return[!0,r.pos[0],r.pos[1],r.pos[2]];return[!1,0,0,0]}getTracks(e,t){const i=e.getElementsByTagName("Track"),r=Array.from(i),s={};for(const o of r){let l=o.getAttribute("storeGateKey");"Tracks"===l&&(l="Tracks_");const d=Number(o.getAttribute("count")),u=[];let g,T,B,q;if(0===o.getElementsByTagName("numPolyline").length)console.log("WARNING the track collection "+l+" has no line information. Will rely on Phoenix to extrapolate.");else{q=this.getNumberArrayFromHTML(o,"numPolyline");const tn=o.getElementsByTagName("polylineX");tn.length>0?(g=tn[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),T=this.getNumberArrayFromHTML(o,"polylineY"),B=this.getNumberArrayFromHTML(o,"polylineZ")):(q=null,g=null,T=null,B=null)}const re=this.getNumberArrayFromHTML(o,"chi2"),se=this.getNumberArrayFromHTML(o,"numDoF"),ne=this.getNumberArrayFromHTML(o,"pt"),De=this.getNumberArrayFromHTML(o,"d0"),Se=this.getNumberArrayFromHTML(o,"z0"),je=this.getNumberArrayFromHTML(o,"phi0"),Dt=this.getNumberArrayFromHTML(o,"cotTheta");let Jt;this.getNumberArrayFromHTML(o,"hits"),this.getNumberArrayFromHTML(o,"numHits"),(d!=ne.length||d!=De.length||d!=Se.length||d!=Dt.length)&&console.log("ERROR: Wrong number of some track variables. Corrupted JiveXML?"),o.getElementsByTagName("trackAuthor").length&&(Jt=this.getNumberArrayFromHTML(o,"trackAuthor"));let Vn=0;q&&q.length!=d&&console.log("numPolyline ",q.length,"numOfTracks",d);for(let tn=0;tn<d;tn++){let Fi=!0;const Vi=!1,On={chi2:0,dof:0,pT:0,phi:0,eta:0,pos:[],dparams:[],hits:{},author:{},badtrack:[]};re.length>=tn&&(On.chi2=re[tn]),se.length>=tn&&(On.dof=se[tn]),Jt?.length>=tn&&(On.author=Jt[tn]);let yi=Math.atan(1/Dt[tn]);On.pT=1e3*Math.abs(ne[tn]);const Gn=On.pT/Math.sin(yi);On.dparams=[De[tn],Se[tn],je[tn],yi,1/Gn],On.phi=je[tn],yi<0&&(yi+=Math.PI),On.phi>Math.PI?On.phi-=2*Math.PI:On.phi<-Math.PI&&(On.phi+=2*Math.PI),Hf.anglesAreSane(yi,On.phi)||(s["Improper angles"]++,On.badtrack.push("Improper angles"),Fi=!1),On.eta=Hf.thetaToEta(yi),Number.isNaN(On.eta)&&(On.badtrack.push("Invalid eta"),Fi=!1);const ri=[];let _i=0,sr=0,pr=0,Hr=0,Ns=0;if(q){(Vn+q[tn]>g.length||Vn+q[tn]>T.length||Vn+q[tn]>B.length)&&console.log("ERROR: not enough points left for this track. Corrupted JiveXML?");for(let ui=0;ui<q[tn];ui++)pr=10*g[Vn+ui],Hr=10*T[Vn+ui],Ns=10*B[Vn+ui],ri.push([pr,Hr,Ns]),sr=Math.sqrt(pr*pr+Hr*Hr+Ns*Ns),sr<_i&&(console.log("WARNING: track positions do not seem to be sorted radially"),s["Hits not sorted"]++,On.badtrack.push("Hits not sorted")),Vi&&(console.log("pos: ",ui,"/",q[tn],":",ri),console.log("theta:",yi,"theta from hit",Math.acos(Ns/sr))),_i=sr;Vn+=q[tn],On.pos=ri}Fi&&u.push(On)}q&&(Vn!=g.length||Vn!=T.length||Vn!=B.length)&&console.log("ERROR: something has gone wrong with assigning the positions to the tracks!"),t.Tracks[l]=u}for(const o in s)s[o]>0&&console.log(s[o]+' tracks had "'+o+'" and were marked as bad.')}getPixelClusters(e,t){if(t.Hits={},0===e.getElementsByTagName("PixCluster").length)return;const i=e.getElementsByTagName("PixCluster")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"id"),o=this.getNumberArrayFromHTML(i,"x0"),l=this.getNumberArrayFromHTML(i,"y0"),d=this.getNumberArrayFromHTML(i,"z0"),u=this.getNumberArrayFromHTML(i,"eloss");t.Hits.Pixel=[];for(let f=0;f<r;f++){const g={pos:[],id:0,energyLoss:0};g.pos=[10*o[f],10*l[f],10*d[f]],g.id=s[f],g.energyLoss=u[f],t.Hits.Pixel.push(g)}}getSCTClusters(e,t){if(0===e.getElementsByTagName("STC").length)return;const i=e.getElementsByTagName("STC")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"id"),o=this.getNumberArrayFromHTML(i,"phiModule"),l=this.getNumberArrayFromHTML(i,"side"),d=this.getNumberArrayFromHTML(i,"x0"),u=this.getNumberArrayFromHTML(i,"y0"),f=this.getNumberArrayFromHTML(i,"z0");t.Hits.SCT=[];for(let g=0;g<r;g++){const T={pos:[],id:0,phiModule:0,side:0};T.pos=[10*d[g],10*u[g],10*f[g]],T.id=s[g],T.phiModule=o[g],T.side=l[g],t.Hits.SCT.push(T)}}getTRT_DriftCircles(e,t){if(0===e.getElementsByTagName("TRT").length)return;const i=e.getElementsByTagName("TRT")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"driftR"),o=this.getNumberArrayFromHTML(i,"id"),l=this.getNumberArrayFromHTML(i,"noise"),d=this.getNumberArrayFromHTML(i,"phi"),u=this.getNumberArrayFromHTML(i,"rhoz"),f=this.getNumberArrayFromHTML(i,"sub"),g=this.getNumberArrayFromHTML(i,"threshold"),T=this.getNumberArrayFromHTML(i,"timeOverThreshold");t.Hits.TRT=[];for(let B=0;B<r;B++){const q={pos:[],id:0,type:"Line",driftR:0,threshold:0,timeOverThreshold:0,noise:!1};if(1==f[B]||2==f[B]){const re=1==f[B]?-3.5:3.5,se=1==f[B]?-742:742;q.pos=[Math.cos(d[B])*u[B]*10,Math.sin(d[B])*u[B]*10,re,Math.cos(d[B])*u[B]*10,Math.sin(d[B])*u[B]*10,se]}else{const re=Math.abs(u[B])>280?480:640,se=1030;q.pos=[Math.cos(d[B])*re,Math.sin(d[B])*re,10*u[B],Math.cos(d[B])*se,Math.sin(d[B])*se,10*u[B]]}q.id=o[B],q.driftR=s[B],q.noise=l[B],q.threshold=g[B],q.timeOverThreshold=T[B],t.Hits.TRT.push(q)}}getMuonPRD(e,t,i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0];"CSCD"==t&&(t="CSC");const s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),d=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"length"),f=this.getNumberArrayFromHTML(r,"id"),g=this.getStringArrayFromHTML(r,"identifier");i.Hits[t]=[];for(let T=0;T<s;T++){const B={pos:[],id:f[T],type:"Line",identifier:g[T]};B.pos=this.getMuonLinePositions(T,o,l,d,u),i.Hits[t].push(B)}}getRPC(e,t){const i="RPC";if(0===e.getElementsByTagName(i).length)return;const r=e.getElementsByTagName(i)[0],s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),d=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"length"),f=this.getNumberArrayFromHTML(r,"width"),g=this.getNumberArrayFromHTML(r,"id"),T=this.getStringArrayFromHTML(r,"identifier");t.Hits[i]=[];for(let B=0;B<s;B++){const q={pos:[],id:g[B],type:"Line",identifier:T[B],width:f[B]};q.pos=this.getMuonLinePositions(B,o,l,d,u),t.Hits[i].push(q)}}getMuonLinePositions(e,t,i,r,s){const o=Math.sqrt(t[e]*t[e]+i[e]*i[e]),l=s[e]/o;return[10*t[e]-i[e]*l*5,10*i[e]+t[e]*l*5,10*r[e],10*t[e]+i[e]*l*5,10*i[e]-t[e]*l*5,10*r[e]]}getJets(e,t){var i;const r=e.getElementsByTagName("Jet"),s=Array.from(r);for(const o of s){const l=Number(o.getAttribute("count")),d=this.getNumberArrayFromHTML(o,"phi"),u=this.getNumberArrayFromHTML(o,"eta"),f=this.getNumberArrayFromHTML(o,"energy"),g=this.getNumberArrayFromHTML(o,"coneR"),T=[];for(let B=0;B<l;B++)T.push({coneR:null!==(i=g[B])&&void 0!==i?i:.4,phi:d[B],eta:u[B],energy:1e3*f[B]});t.Jets[o.getAttribute("storeGateKey")]=T}}getCaloClusters(e,t){const i=e.getElementsByTagName("Cluster"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=this.getNumberArrayFromHTML(s,"phi"),d=this.getNumberArrayFromHTML(s,"eta"),u=this.getNumberArrayFromHTML(s,"et"),f=[];for(let g=0;g<o;g++)f.push({phi:l[g],eta:d[g],energy:1e3*u[g]});t.CaloClusters[s.getAttribute("storeGateKey")]=f}}getFCALCaloCells(e,t,i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0],s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),d=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"dx"),g=(this.getNumberArrayFromHTML(r,"dy"),this.getNumberArrayFromHTML(r,"dz")),T=this.getNumberArrayFromHTML(r,"channel"),q=(this.getNumberArrayFromHTML(r,"energy"),this.getNumberArrayFromHTML(r,"id")),re=this.getStringArrayFromHTML(r,"slot");i.PlanarCaloCells[t]={cells:[]};let se=0;for(let ne=0;ne<s;ne++){const De=d.length?10*d[ne]:10;i.PlanarCaloCells[t].cells.push({pos:[10*o[ne],10*l[ne],De],length:g.length?10*g[ne]:u[ne],cellSize:10*u[ne],id:q[ne],slot:re[ne],channel:T[ne]}),se&&se!=De&&console.log("WARNING - we're assuming that all cells have the same z. This is apparently not correct!"),se=De}i.PlanarCaloCells[t].plane=[10,10,se]}getCaloCells(e,t="FCAL",i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0],s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"eta"),l=this.getNumberArrayFromHTML(r,"phi"),d=this.getNumberArrayFromHTML(r,"channel"),u=this.getNumberArrayFromHTML(r,"energy"),f=this.getNumberArrayFromHTML(r,"id");this.getStringArrayFromHTML(r,"slot"),i.CaloCells[t]=[];for(let T=0;T<s;T++)i.CaloCells[t].push({eta:o[T],phi:l[T],id:f[T],energy:u[T],channel:d[T]})}getVertices(e,t){const i=e.getElementsByTagName("RVx"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=s.getElementsByTagName("x")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),d=s.getElementsByTagName("y")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),u=s.getElementsByTagName("z")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),f=s.getElementsByTagName("chi2")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),g=s.getElementsByTagName("primVxCand")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),T=s.getElementsByTagName("vertexType")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),B=s.getElementsByTagName("numTracks")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),q=s.getElementsByTagName("sgkey")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(String),re=s.getElementsByTagName("tracks")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),se=[];let ne=0;for(let De=0;De<o;De++){const Se=ne+B[De],je=[];for(;ne<Se;ne++)ne>re.length&&console.log("Error! TrackIndex exceeds maximum number of track indices."),je.push(re[ne]);se.push({x:l[De],y:d[De],z:u[De],chi2:f[De],primVxCand:g[De],vertexType:T[De],linkedTracks:je,linkedTrackCollection:q[De]})}t.Vertices[s.getAttribute("storeGateKey")]=se}}getMuons(e,t){const i=e.getElementsByTagName("Muon"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let d=0;d<o;d++){const u=this.getNumberArrayFromHTML(s,"chi2"),f=this.getNumberArrayFromHTML(s,"energy"),g=this.getNumberArrayFromHTML(s,"eta"),T=this.getNumberArrayFromHTML(s,"phi"),B=this.getNumberArrayFromHTML(s,"pt"),q=this.getNumberArrayFromHTML(s,"pdgId");l.push({chi2:u[d],energy:f[d],eta:g[d],phi:T[d],pt:1e3*B[d],pdgId:q[d]})}t.Muons[s.getAttribute("storeGateKey")]=l}}getElectrons(e,t){const i=e.getElementsByTagName("Electron"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let d=0;d<o;d++){const u=this.getStringArrayFromHTML(s,"author"),f=this.getNumberArrayFromHTML(s,"energy"),g=this.getNumberArrayFromHTML(s,"eta"),T=this.getNumberArrayFromHTML(s,"phi"),B=this.getNumberArrayFromHTML(s,"pt"),q=this.getNumberArrayFromHTML(s,"pdgId");l.push({author:u[d],energy:f[d],eta:g[d],phi:T[d],pt:1e3*B[d],pdgId:q[d]})}t.Electrons[s.getAttribute("storeGateKey")]=l}}getPhotons(e,t){const i=e.getElementsByTagName("Photon"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let d=0;d<o;d++){const u=this.getStringArrayFromHTML(s,"author"),f=this.getNumberArrayFromHTML(s,"energy"),g=this.getNumberArrayFromHTML(s,"eta"),T=this.getNumberArrayFromHTML(s,"phi"),B=this.getNumberArrayFromHTML(s,"pt");l.push({author:u[d],energy:f[d],eta:g[d],phi:T[d],pt:1e3*B[d]})}t.Photons[s.getAttribute("storeGateKey")]=l}}getMissingEnergy(e,t){const i=e.getElementsByTagName("ETMis"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let d=0;d<o;d++){const u=this.getStringArrayFromHTML(s,"et"),f=this.getNumberArrayFromHTML(s,"etx"),g=this.getNumberArrayFromHTML(s,"ety");l.push({et:u[d],etx:f[d],ety:g[d]})}t.MissingEnergy[s.getAttribute("storeGateKey")]=l}}}var Bj=Ee(7247),Pj=Ee.n(Bj);const Rj=n=>function(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})}(void 0,void 0,void 0,function*(){const e=new(Pj()),t={};yield e.loadAsync(n);for(const i in e.files){const r=yield e.file(i).async("string");t[i]=r}return t});var gL=function(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})};const Pve={file:"",type:"",config:"",hideWidgets:!1,embed:!1};class Rve{constructor(e,t){this.eventDisplay=e,this.configuration=t,this.urlOptions=new URLSearchParams(window.location.href.substr(window.location.href.lastIndexOf("?")))}applyOptions(){var e,t;this.applyEventOptions(null===(e=this.configuration.defaultEventFile)||void 0===e?void 0:e.eventFile,null===(t=this.configuration.defaultEventFile)||void 0===t?void 0:t.eventType),this.applyHideWidgetsOptions(),this.applyEmbedOption()}applyEventOptions(e,t){if(!("fetch"in window))return;let i,r;(!this.urlOptions.get("file")&&this.urlOptions.get("type")||this.urlOptions.get("file")&&!this.urlOptions.get("type"))&&(console.log("WARNING - if you set one of type or file, then you need to set both!"),console.log("WARNING - reverting to defaults!")),this.urlOptions.get("file")&&this.urlOptions.get("type")?(console.log("Setting and config from urlOptions"),i=this.urlOptions.get("file"),r=this.urlOptions.get("type").toLowerCase()):(console.log("Setting and config from defaults"),i=e,r=t),console.log("Loading ",i,"of type",r);const s=()=>{this.urlOptions.get("config")&&(this.eventDisplay.getLoadingManager().addLoadableItem("url_config"),fetch(this.urlOptions.get("config")).then(l=>l.json()).then(l=>{(new yg).loadStateFromJSON(l)}).finally(()=>{this.eventDisplay.getLoadingManager().itemLoaded("url_config")}))};i&&r?(this.eventDisplay.getLoadingManager().addLoadableItem("url_event"),(l=>"jivexml"===r?(console.log("Opening JiveXML"),this.handleJiveXMLEvent(l)):"zip"===r?(console.log("Opening zip file"),this.handleZipFileEvents(l)):this.handleJSONEvent(l))(i).catch(l=>{this.eventDisplay.getInfoLogger().add("Could not find the file specified in URL.","Error"),console.error("Could not find the file specified in URL.",l)}).finally(()=>{s(),this.eventDisplay.getLoadingManager().itemLoaded("url_event")})):s()}handleJiveXMLEvent(e){return gL(this,void 0,void 0,function*(){const t=yield(yield fetch(e)).text(),i=new sT;this.configuration.eventDataLoader=i,i.process(t);const r=i.getEventData();this.eventDisplay.buildEventDataFromJSON(r)})}handleJSONEvent(e){return gL(this,void 0,void 0,function*(){const t=yield(yield fetch(e)).json();this.configuration.eventDataLoader=new vA,this.eventDisplay.parsePhoenixEvents(t)})}handleZipFileEvents(e){return gL(this,void 0,void 0,function*(){const t=yield(yield fetch(e)).arrayBuffer(),i={};let r;try{r=yield Rj(t)}catch(o){return console.error("Error while reading zip",o),void this.eventDisplay.getInfoLogger().add("Could not read zip file","Error")}Object.keys(r).filter(o=>o.endsWith(".json")).forEach(o=>{Object.assign(i,JSON.parse(r[o]))});const s=new sT;Object.keys(r).filter(o=>o.endsWith(".xml")||o.startsWith("JiveXML")).forEach(o=>{s.process(r[o]);const l=s.getEventData();Object.assign(i,{[o]:l})}),this.eventDisplay.parsePhoenixEvents(i)})}applyHideWidgetsOptions(){this.hideIdsWithURLOption({hideWidgets:["mainLogo","uiMenu","experimentInfo","phoenixMenu","statsElement","gui"]})}applyEmbedOption(){var e;"true"===this.urlOptions.get("embed")&&(this.hideIdsWithURLOption({embed:["mainLogo","uiMenu","experimentInfo","phoenixMenu","statsElement","gui"]}),null===(e=document.getElementById("embedMenu"))||void 0===e||e.style.setProperty("display","block"))}hideIdsWithURLOption(e){Object.entries(e).forEach(([t,i])=>{"true"===this.urlOptions.get(t)&&i.forEach(r=>{var s;null===(s=document.getElementById(r))||void 0===s||s.style.setProperty("display","none")})})}getURLOptions(){return this.urlOptions}}var dx=function(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(g){o(g)}}function d(f){try{u(i.throw(f))}catch(g){o(g)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,d)}u((i=i.apply(n,e||[])).next())})};class kve{constructor(e){this.onEventsChange=[],this.onDisplayedEventChange=[],this.loadingManager=new cx,this.infoLogger=new Cve,this.graphicsLibrary=new $ye(this.infoLogger),this.ui=new wve(this.graphicsLibrary),e&&this.init(e)}init(e){this.configuration=e,this.graphicsLibrary.init(e),this.ui.init(e),this.getStateManager().setEventDisplay(this),this.graphicsLibrary.setAnimationLoop(()=>{this.ui.updateUI()}),this.urlOptionsManager=new Rve(this,e),!1!==e.allowUrlOptions&&this.urlOptionsManager.applyOptions(),this.enableEventDisplayConsole(),this.enableKeyboardControls()}initXR(e,t){this.graphicsLibrary.initXRSession(e,t)}endXR(e){this.graphicsLibrary.endXRSession(e)}parsePhoenixEvents(e){this.eventsData=e,typeof this.configuration.eventDataLoader>"u"&&(this.configuration.eventDataLoader=new vA);const t=this.configuration.eventDataLoader.getEventsList(e);return this.loadEvent(t[0]),this.onEventsChange.forEach(i=>i(t)),t}buildEventDataFromJSON(e){this.resetLabels(),this.ui.addEventDataFolder(),this.ui.addLabelsFolder(),this.graphicsLibrary.clearEventData(),this.configuration.eventDataLoader.buildEventData(e,this.graphicsLibrary,this.ui,this.infoLogger),this.onDisplayedEventChange.forEach(t=>t(e)),this.ui.loadEventFolderPhoenixMenuState()}loadEvent(e){const t=this.eventsData[e];t&&this.buildEventDataFromJSON(t)}getThreeManager(){return this.graphicsLibrary}getUIManager(){return this.ui}getInfoLogger(){return this.infoLogger}getLoadingManager(){return this.loadingManager}getStateManager(){return this.stateManager||(this.stateManager=new yg),this.stateManager}getURLOptionsManager(){return this.urlOptionsManager}loadOBJGeometry(e,t,i,r,s){return dx(this,arguments,void 0,function*(o,l,d,u,f,g=!0,T=!0){this.loadingManager.addLoadableItem(`obj_geom_${l}`);const{object:B}=yield this.graphicsLibrary.loadOBJGeometry(o,l,d,f,g,T);this.ui.addGeometry(B,u),this.loadingManager.itemLoaded(`obj_geom_${l}`),this.infoLogger.add(l,"Loaded OBJ geometry")})}parseOBJGeometry(e,t,i,r=!0){this.loadingManager.addLoadableItem(`parse_obj_${t}`);const{object:s}=this.graphicsLibrary.parseOBJGeometry(e,t,r);this.ui.addGeometry(s,i),this.loadingManager.itemLoaded(`parse_obj_${t}`)}exportToOBJ(){this.graphicsLibrary.exportSceneToOBJ(),this.infoLogger.add("Exported scene to OBJ")}parsePhoenixDisplay(e){return dx(this,void 0,void 0,function*(){const t=JSON.parse(e);t.sceneConfiguration&&t.scene&&(this.ui.addEventDataFolder(),this.ui.addLabelsFolder(),this.graphicsLibrary.clearEventData(),this.loadSceneConfiguration(t.sceneConfiguration),this.loadingManager.addLoadableItem(`parse_phnx_${name}`),yield this.graphicsLibrary.parsePhnxScene(t.scene),this.loadingManager.itemLoaded(`parse_phnx_${name}`))})}exportPhoenixDisplay(){this.graphicsLibrary.exportPhoenixScene()}parseGLTFGeometry(e,t){return dx(this,void 0,void 0,function*(){this.loadingManager.addLoadableItem(`parse_gltf_${t}`);const i=yield this.graphicsLibrary.parseGLTFGeometry(e,t);for(const{object:r}of i)this.ui.addGeometry(r);this.loadingManager.itemLoaded(`parse_gltf_${t}`)})}loadGLTFGeometry(e,t,i,r){return dx(this,arguments,void 0,function*(s,o,l,d,u=!0){this.loadingManager.addLoadableItem(`gltf_geom_${o}`);const f=yield this.graphicsLibrary.loadGLTFGeometry(s,o,l,d,u);for(const{object:g,menuNodeName:T}of f)this.ui.addGeometry(g,T);this.loadingManager.itemLoaded(`gltf_geom_${o}`)})}loadJSONGeometry(e,t,i,r,s){return dx(this,arguments,void 0,function*(o,l,d,u,f,g=!0){this.loadingManager.addLoadableItem(`json_geom_${l}`);const{object:T}=yield this.graphicsLibrary.loadJSONGeometry(o,l,u,f,g);this.ui.addGeometry(T,d),this.loadingManager.itemLoaded(`json_geom_${l}`),this.infoLogger.add(l,"Loaded JSON geometry")})}loadRootJSONGeometry(e,t,i,r,s){return dx(this,arguments,void 0,function*(o,l,d,u,f,g=!0){this.loadingManager.addLoadableItem("root_json_geom");const T=yield(0,aG.httpRequest)(o,"object");yield this.loadJSONGeometry((0,lG.build)(T,{dflt_colors:!0}).toJSON(),l,d,u,f,g),this.loadingManager.itemLoaded("root_json_geom")})}loadRootGeometry(e,t,i,r,s,o){return dx(this,arguments,void 0,function*(l,d,u,f,g,T,B=!0){this.loadingManager.addLoadableItem("root_geom"),aG.settings.UseStamp=!1;const re=yield(yield(0,cG.Tq)(l)).readObject(d);yield this.loadJSONGeometry((0,lG.build)(re,{dflt_colors:!0}).toJSON(),u,f,g,T,B),this.loadingManager.itemLoaded("root_geom")})}buildGeometryFromParameters(e){this.graphicsLibrary.addGeometryFromParameters(e)}zoomTo(e,t){this.graphicsLibrary.zoomTo(e,t)}loadSceneConfiguration(e){for(const t of Object.keys(e.eventData)){this.ui.addEventDataTypeFolder(t);const i=e.eventData[t];for(const r of i)this.ui.addCollection(t,r)}for(const t of e.geometries)this.ui.addGeometry(t,"#ffffff")}getCollection(e){return this.configuration.eventDataLoader.getCollection(e)}getCollections(){return this.configuration.eventDataLoader.getCollections()}listenToDisplayedEventChange(e){this.onDisplayedEventChange.push(e)}listenToLoadedEventsChange(e){this.onEventsChange.push(e)}getEventMetadata(){return this.configuration.eventDataLoader.getEventMetadata()}enableEventDisplayConsole(){window.EventDisplay={loadGLTFGeometry:(e,t)=>{this.loadGLTFGeometry(e,t)},loadOBJGeometry:(e,t,i,r,s)=>{this.loadOBJGeometry(e,t,i,r,s)},loadJSONGeometry:(e,t,i,r,s,o=!0)=>{this.loadJSONGeometry(e,t,i,r,s,o)},buildGeometryFromParameters:e=>this.buildGeometryFromParameters(e),scene:this.getThreeManager().getSceneManager().getScene()}}setOverlayRenderer(e){this.graphicsLibrary.setOverlayRenderer(e)}allowSelection(e){this.graphicsLibrary.setSelectedObjectDisplay(e)}enableSelecting(e){this.graphicsLibrary.enableSelecting(e)}fixOverlayView(e){this.graphicsLibrary.fixOverlayView(e)}getActiveObjectId(){return this.graphicsLibrary.getActiveObjectId()}lookAtObject(e,t=!1){1==t?(this.graphicsLibrary.lookAtObject(e,!0),this.graphicsLibrary.highlightObject(e,!0)):(this.graphicsLibrary.lookAtObject(e),this.graphicsLibrary.highlightObject(e))}highlightObject(e,t=!1){this.graphicsLibrary.highlightObject(e,1==t)}enableHighlighting(){this.graphicsLibrary.enableHighlighting()}disableHighlighting(){this.graphicsLibrary.disableHighlighting()}enableKeyboardControls(){this.ui.enableKeyboardControls(),this.graphicsLibrary.enableKeyboardControls()}animateThroughEvent(e,t,i){this.graphicsLibrary.animateThroughEvent(e,t,i)}animatePreset(e,t){this.graphicsLibrary.animatePreset(e,t)}animateEventWithCollision(e,t){this.graphicsLibrary.animateEventWithCollision(e,t)}animateClippingWithCollision(e,t){this.graphicsLibrary.animateClippingWithCollision(e,t)}addLabelToObject(e,t,i,r){const s=this.configuration.eventDataLoader.addLabelToEventObject(e,t,i);e?(this.ui.addLabel(s),this.graphicsLibrary.addLabelToObject(e,r,s)):this.ui.removeLabel(s,!0)}resetLabels(){const e=this.configuration.eventDataLoader.getLabelsObject();for(const t in e)for(const i in e[t])for(const r in e[t][i]){const s=Ij(t,i,r);this.ui.removeLabel(s,!0),delete e[t][i][r]}}}class ux{constructor(e,t,i,r,s,o){this.toggleState=!0,this.children=[],this.configs=[],this.nodeLevel=0,this.childrenToggleState={},this.childrenActive=!1,this.configActive=!1,this.name=e,this.icon=t,this.onToggle=i,r&&(this.children=r),s&&(this.configs=s),o&&(this.parent=o)}addChild(e,t,i){const r=new ux(e,i,t);return r.parent=this,r.nodeLevel=this.nodeLevel+1,this.children.push(r),r}removeChild(e){const t=this.children.indexOf(e);return this.children.splice(t,1),this}remove(){this.parent?this.parent.removeChild(this):console.error("Cannot delete root node of phoenix menu. Set it to undefined/null instead.")}truncate(){this.children=[]}addConfig(e,t){const i=this.configs.push(Object.assign({type:e},t));return this.applyConfigState(this.configs[i-1]),this}toggleSelfAndDescendants(e){var t;null===(t=this.onToggle)||void 0===t||t.call(this,e),this.toggleState=e;for(const i of this.children)e?(i.toggleState=this.childrenToggleState[i.name],i.toggleSelfAndDescendants(i.toggleState)):(this.childrenToggleState[i.name]=i.toggleState,i.toggleSelfAndDescendants(e))}applyConfigState(e){var t,i,r,s,o,l;"checkbox"===e.type&&e?.isChecked?null===(t=e.onChange)||void 0===t||t.call(e,e?.isChecked):"color"===e.type&&e?.color&&!e.group?null===(i=e.onChange)||void 0===i||i.call(e,e?.color):"slider"===e.type&&e?.value?null===(r=e.onChange)||void 0===r||r.call(e,e?.value):"rangeSlider"===e.type&&void 0!==e?.value&&(null===(s=e.onChange)||void 0===s||s.call(e,{value:e?.value,highValue:e?.highValue}),null===(o=e.setEnableMin)||void 0===o||o.call(e,e?.enableMin),null===(l=e.setEnableMax)||void 0===l||l.call(e,e?.enableMax))}getNodeState(){const e={};e.name=this.name,e.nodeLevel=this.nodeLevel,e.toggleState=this.toggleState,e.childrenActive=this.childrenActive,e.configs=this.configs,e.children=[];for(const t of this.children)e.children.push(t.getNodeState());return e}loadStateFromJSON(e){var t;let i;i="string"==typeof e?JSON.parse(e):e,this.childrenActive=i.childrenActive,this.toggleState=i.toggleState,void 0!==this.toggleState&&(null===(t=this.onToggle)||void 0===t||t.call(this,this.toggleState));for(const r of i.configs){const s=this.configs.find(o=>o.type===r.type&&o.label===r.label);if(s){for(const o in r)s[o]=r[o];this.applyConfigState(s)}}for(const r of i.children){const s=this.children.filter(o=>o.name===r.name&&o.nodeLevel===r.nodeLevel)[0];s&&s.loadStateFromJSON(r)}}findInTree(e){if(this.name===e)return this;for(const t of this.children){const i=t.findInTree(e);if(i)return i}}findInTreeOrCreate(e){let t=this;return e.split(">").forEach(i=>{i=i.trim();const r=t.findInTree(i);t=r||t.addChild(i,()=>{})}),t}}class Fve{static getMuonChamber(e){var t;let i=[];const r=(...f)=>{i=i.concat(...f.map(g=>e[g]))};r("front_1","front_2","front_3"),r("front_3","front_4","front_1"),r("back_1","back_2","back_3"),r("back_3","back_4","back_1"),r("back_1","back_2","front_2"),r("front_2","front_1","back_1"),r("back_4","back_3","front_3"),r("front_3","front_4","back_4"),r("front_1","front_4","back_4"),r("back_4","back_1","front_1"),r("front_2","back_2","back_3"),r("back_3","front_3","front_2");const s=new Qs;s.attributes.position=new To(new Float32Array(i),3),s.computeVertexNormals();const o=new Yo(s,new yd({color:null!==(t=e.color)&&void 0!==t?t:Ep.MuonChambers,transparent:!0,opacity:.1,side:2}));o.userData=Object.assign({},e),o.name="MuonChamber";const l=new UQ(s),d=new hc(l,new wc({color:16777215,transparent:!0,opacity:.7})),u=new $l;return u.add(o),u.add(d),e.uuid=o.uuid,u}}class Ove extends vA{constructor(){super(),this.geometryScale=1e3,this.data={}}loadObjectTypes(e){super.loadObjectTypes(e),e.MuonChambers&&this.addObjectType(e.MuonChambers,Fve.getMuonChamber,"MuonChambers")}readIgArchive(e,t,i){this.loadingManager.addLoadableItem("ig_archive");const r=new(Pj()),s=[],o=l=>{r.loadAsync(l).then(()=>{let d=Object.keys(r.files);i&&(d=d.filter(f=>f.includes(i)));let u=1;for(const f of d)f.toLowerCase().startsWith("events")?r.file(f).async("string").then(g=>{g=g.replace(/'/g,'"').replace(/\(/g,"[").replace(/\)/g,"]").replace(/nan/g,"0");const T=JSON.parse(g);T.eventPath=f,s.push(T),u===d.length&&(t(s),this.loadingManager.itemLoaded("ig_archive")),u++}):(u===d.length&&(t(s),this.loadingManager.itemLoaded("ig_archive")),u++)})};e instanceof File?o(e):fetch(e).then(l=>l.arrayBuffer()).then(l=>{o(l)})}loadEventDataFromIg(e,t,i){this.readIgArchive(e,r=>{i(r[0])},t)}getEventData(){var e,t,i;const r=null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.Collections)||void 0===t?void 0:t.Event_V2)||void 0===i?void 0:i[0],s={runNumber:r?.[0],eventNumber:r?.[1],ls:r?.[2],time:r?.[5],Hits:{},Tracks:{},Jets:{},CaloClusters:{},MuonChambers:{}};s.Hits=this.getTrackingClusters(s.Hits),s.Tracks=this.getTracks(),s.Jets=this.getJets(),s.CaloClusters=this.getCaloClusters(),s.MuonChambers=this.getMuonChambers();for(const o of["Hits","Tracks","Jets","CaloClusters","MuonChambers"])0===Object.keys(s[o]).length&&(s[o]=void 0);return s}getAllEventsData(e){const t={};for(const i of e)this.data=i,t[i.eventPath]=this.getEventData();return t}getTrackingClusters(e){const i=this.getObjectCollections(["TrackingRecHits_V1","SiStripClusters_V1","SiPixelClusters_V1","CSCLCTDigis_V1"],r=>{r.pos&&(r.pos=r.pos.map(s=>s*this.geometryScale))});return Object.assign(e,i),e}getCaloClusters(){return this.getObjectCollections(["SuperClusters_V1"],i=>{i.energy&&(i.energy*=this.geometryScale)})}getJets(){let e={};const t=Object.keys(this.data.Collections).filter(r=>r.toLowerCase().includes("jets"));return e=this.getObjectCollections(t,r=>{for(const s of["et","energy"])if(r[s]){r[s]*=this.geometryScale;break}},[{attribute:"et",min:10},{attribute:"energy",min:10}]),e}getMuonChambers(){return this.getObjectCollections(["MatchingCSCs_V1","MuonChambers_V1"],i=>{for(const r of Object.keys(i))(r.startsWith("front")||r.startsWith("back"))&&(i[r]=i[r].map(s=>s*this.geometryScale))})}getObjectCollections(e,t,i){const r={};e=e.filter(s=>this.data.Collections[s]);for(const s of e){r[s]=[];const o=this.data.Types[s];for(const l of this.data.Collections[s]){const d={};if(o.forEach((u,f)=>{d[u[0]]=l[f]}),i){let u=!0,f=!0;for(const g of i)if(d[g.attribute]){if(g.max&&d[g.attribute]>g.max){u=!1;break}if(g.min&&d[g.attribute]<g.min){f=!1;break}}u&&f&&(t?.(d),r[s].push(d))}else t?.(d),r[s].push(d)}0===r[s].length&&delete r[s]}return r}getTracks(){const e={};let t=[{collection:"Tracks_V1",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V2",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V3",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"StandaloneMuons_V2",extras:"Extras_V1",assocs:"MuonTrackExtras_V1",color:"0xf57842",min_pt:1},{collection:"PATStandaloneMuons_V1",extras:"Extras_V1",assocs:"PATMuonTrackExtras_V1",color:"0xf5aa42",min_pt:1},{collection:"TrackerMuons_V2",extras:"Extras_V1",assocs:"MuonTrackerExtras_V1",color:"0xe8d546",min_pt:2},{collection:"GsfElectrons_V1",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1CFF1A",min_pt:10},{collection:"GsfElectrons_V2",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1bcf9f",min_pt:10},{collection:"GsfElectrons_V3",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1ad9ff",min_pt:10},{collection:"PATElectrons_V1",extras:"Extras_V1",assocs:"PATElectronExtras_V1",color:"0x1a40ff",min_pt:1}];t=t.filter(i=>this.data.Collections[i.collection]);for(const i of t){e[i.collection]=[];const r=this.data.Collections[i.collection],s=this.data.Collections[i.extras],o=this.data.Associations[i.assocs],l=this.data.Types[i.collection];let d,u,f,g,T,B,q,re,se,ne,De,Se;for(let je=0;je<o.length;je++){if(Se={},l.forEach((Mt,Bt)=>{Se[Mt[0]]=r[je][Bt]}),Se.pt<i.min_pt)continue;Se.color=i.color,d=o[je][0][1],u=o[je][1][1],f=new Rt(s[u][0][0],s[u][0][1],s[u][0][2]),g=new Rt(s[u][1][0],s[u][1][1],s[u][1][2]),g.normalize(),T=new Rt(s[u][2][0],s[u][2][1],s[u][2][2]),B=new Rt(s[u][3][0],s[u][3][1],s[u][3][2]),B.normalize(),q=f.distanceTo(T),re=.25*q,se=new Rt(f.x+re*g.x,f.y+re*g.y,f.z+re*g.z),ne=new Rt(T.x+re*B.x,T.y+re*B.y,T.z+re*B.z),De=new dO(f,se,T);const Dt=[];for(const Mt of De.getPoints(24))Mt.multiplyScalar(this.geometryScale),Dt.push([Mt.x,Mt.y,Mt.z]);Se.pos=Dt,e[i.collection].push(Se)}0===e[i.collection].length&&delete e[i.collection]}return e}getEventMetadata(){var e,t,i;const r=super.getEventMetadata(),s=null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.Collections)||void 0===t?void 0:t.Event_V2)||void 0===i?void 0:i[0];return s?.[3]&&r.push({label:"Orbit",value:s[3]}),r}}class Lve extends vA{constructor(){super(),this.eventData={}}setRawEventData(e){this.rawEventData=e}processEventData(){return Object.entries(this.rawEventData).forEach(([e,t])=>{const i={Vertices:{},Tracks:{},Hits:{},CaloCells:{},CaloClusters:{},Jets:{},MissingEnergy:{},"event number":this.getEventNumber(t),"run number":this.getRunNumber(t)};this.colorTracks(t),i.Vertices=this.getVertices(t),i.Tracks=this.getTracks(t),i.Hits=this.getHits(t),i.CaloCells=this.getCells(t),i.CaloClusters=this.getCaloClusters(t),i.Jets=this.getJets(t),i.MissingEnergy=this.getMissingEnergy(t),this.eventData[e]=i}),!0}getEventData(){return this.eventData}getNumEvents(){return Object.keys(this.rawEventData).length}getRunNumber(e){if(!("EventHeader"in e))return 0;const t=e.EventHeader.collection;return"runNumber"in t?0:t[0].runNumber}getEventNumber(e){if(!("EventHeader"in e))return 0;const t=e.EventHeader.collection;return"eventNumber"in t?0:t[0].eventNumber}colorTracks(e){let t,i,r,s;"ReconstructedParticles"in e&&(t=e.ReconstructedParticles.collection,"Particle"in e&&(i=e.Particle.collection,"MCRecoAssociations"in e&&(r=e.MCRecoAssociations.collection,"EFlowTrack"in e&&(s=e.EFlowTrack.collection,r.forEach(o=>{const u=i[o.sim.index].PDG;t[o.rec.index].tracks.forEach(g=>{const T=s[g.index];11===Math.abs(u)?(T.color="00ff00",T.pid="electron"):22===Math.abs(u)?(T.color="ff0000",T.pid="photon"):211===Math.abs(u)||111===Math.abs(u)?(T.color="a52a2a",T.pid="pion"):2212===Math.abs(u)?(T.color="778899",T.pid="proton"):321===Math.abs(u)?(T.color="5f9ea0",T.pid="kaon"):(T.color="0000cd",T.pid="other"),T.pdgid=u})})))))}getVertices(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||!("collection"in r)||"edm4hep::VertexCollection"!==r.collType)continue;const s=[],o=r.collection,l=this.randomColor();o.forEach(d=>{const u=[];"position"in d&&(u.push(.1*d.position.x),u.push(.1*d.position.y),u.push(.1*d.position.z)),s.push({pos:u,size:.2,color:"#"+l})}),t[i]=s}return t}getTracks(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::TrackCollection"!==r.collType||!("collection"in r))continue;const o=[],l=[],d=[],u=[],f=[],g=[];r.collection.forEach(T=>{const B=[];"trackerHits"in T&&T.trackerHits.forEach(ne=>{const Se=this.getCollByID(e,ne.collectionID)[ne.index];B.push([.1*Se.position.x,.1*Se.position.y,.1*Se.position.z])}),"trackStates"in T&&0===B.length&&T.trackStates.forEach(ne=>{"referencePoint"in ne&&B.push([.1*ne.referencePoint.x,.1*ne.referencePoint.y,.1*ne.referencePoint.z])});let q="0000cd";"color"in T&&(q=T.color);const re={pos:B,color:q};"pid"in T?"electron"==T.pid?o.push(re):"photon"==T.pid?l.push(re):"pion"==T.pid?d.push(re):"proton"==T.pid?u.push(re):"kaon"==T.pid?f.push(re):g.push(re):g.push(re)}),t[i+" | Electrons"]=o,t[i+" | Photons"]=l,t[i+" | Pions"]=d,t[i+" | Protons"]=u,t[i+" | Kaons"]=f,t[i+" | Other"]=g}return t}getHits(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r&&r.collType.includes("edm4hep::")&&r.collType.includes("TrackerHitCollection")&&"collection"in r))continue;const s=r.collection,o=[],l=this.randomColor();s.forEach(d=>{const u=[];"position"in d&&(u.push(.1*d.position.x),u.push(.1*d.position.y),u.push(.1*d.position.z)),o.push({type:"CircularPoint",pos:u,color:"#"+l,size:2})}),t[i]=o}return t}getCells(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r&&r.collType.includes("edm4hep::")&&r.collType.includes("CalorimeterHitCollection")&&"collection"in r))continue;const s=r.collection,o=[];let l=1e9;for(let f=0;f<1e4;++f){const g=Math.floor(Math.random()*s.length),T=Math.floor(Math.random()*s.length);if(g===T)continue;const B=Math.pow(s[g].position.x-s[T].position.x,2),q=Math.pow(s[g].position.y-s[T].position.y,2),re=Math.pow(s[g].position.z-s[T].position.z,2),se=Math.sqrt(B+q+re);se<l&&(l=se)}const d=.1*Math.floor(l)>1?.1*Math.floor(l):1,u=Math.floor(358*Math.random());s.forEach(f=>{const g=.1*f.position.x,T=.1*f.position.y,B=.1*f.position.z,q=Math.sqrt(Math.pow(g,2)+Math.pow(T,2)+Math.pow(B,2)),re=Math.sqrt(Math.pow(g,2)+Math.pow(T,2)),se=Math.asinh(B/re),ne=Math.acos(g/re)*Math.sign(T),De=this.valToLightness(f.energy,.001,1),Se=this.valToOpacity(f.energy,.001,1),je={eta:se,phi:ne,energy:f.energy,radius:q,side:d,length:d,color:"#"+this.convHSLtoHEX(u,90,De),opacity:Se};o.push(je)}),t[i]=o}return t}getCaloClusters(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ClusterCollection"!==r.collType||!("collection"in r))continue;const o=[];r.collection.forEach(l=>{const d=.1*l.position.x,u=.1*l.position.y,f=.1*l.position.z,g=Math.sqrt(Math.pow(d,2)+Math.pow(u,2)+Math.pow(f,2)),T=Math.sqrt(Math.pow(d,2)+Math.pow(u,2)),B=Math.asinh(f/T),q=Math.acos(d/T)*Math.sign(u);o.push({eta:B,phi:q,energy:100*l.energy,radius:g,side:4})}),t[i]=o}return t}getJets(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ReconstructedParticleCollection"!==r.collType||!i.includes("Jet")&&!i.includes("jet")||!("collection"in r))continue;const s=[];r.collection.forEach(l=>{if(!("momentum"in l)||!("energy"in l))return;const d=l.momentum.x,u=l.momentum.y,f=l.momentum.z,g=Math.sqrt(Math.pow(d,2)+Math.pow(u,2)),T=Math.asinh(f/g),B=Math.acos(d/g)*Math.sign(u);s.push({eta:T,phi:B,energy:1e3*l.energy})}),t[i]=s}return t}getMissingEnergy(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ReconstructedParticleCollection"!==r.collType||!i.includes("Missing")&&!i.includes("missing")||!("collection"in r))continue;const s=[];r.collection.forEach(d=>{if(!("momentum"in d)||!("energy"in d))return;const u=d.momentum.x,f=d.momentum.y,g=d.momentum.z,T=Math.sqrt(Math.pow(u,2)+Math.pow(f,2)+Math.pow(g,2));s.push({etx:d.energy*u/T*10,ety:d.energy*f/T*10,color:"#ff69b4"})}),t[i]=s}return t}randomColor(){return Math.floor(16777215*Math.random()).toString(16).padStart(6,"0").toUpperCase()}convHSLtoHEX(e,t,i){i/=100;const r=t*Math.min(i,1-i)/100,s=o=>{const l=(o+e/30)%12,d=i-r*Math.max(Math.min(l-3,9-l,1),-1);return Math.round(255*d).toString(16).padStart(2,"0")};return`${s(0)}${s(8)}${s(4)}`}valToLightness(e,t,i){let r=80-65*(e-t)/(i-t);return r<20&&(r=20),r>85&&(r=85),r}valToOpacity(e,t,i){let r=.2+.65*(e-t)/(i-t);return r<.2&&(r=.2),r>.8&&(r=.8),r}getCollByID(e,t){for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if("collID"in r&&r.collID===t)return r.collection}}}function wm(...n){const e=kS(n),t=function Rie(n,e){return"number"==typeof WR(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Qh(i[0]):v2(t)(ru(i,e)):cA}let _L,Nve=1;const pB={};function kj(n){return n in pB&&(delete pB[n],!0)}const Uve={setImmediate(n){const e=Nve++;return pB[e]=!0,_L||(_L=Promise.resolve()),_L.then(()=>kj(e)&&n()),e},clearImmediate(n){kj(n)}},{setImmediate:zve,clearImmediate:Hve}=Uve,mB={setImmediate(...n){const{delegate:e}=mB;return(e?.setImmediate||zve)(...n)},clearImmediate(n){const{delegate:e}=mB;return(e?.clearImmediate||Hve)(n)},delegate:void 0},yL=new class Gve extends pF{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class Vve extends fF{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=mB.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(mB.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});function Fj(n,e){return e?t=>US(e.pipe(sd(1),function qve(){return ln((n,e)=>{n.subscribe(Un(e,It))})}()),t.pipe(Fj(n))):Gu((t,i)=>Qh(n(t,i)).pipe(sd(1),F9(t)))}function AB(n=0,e,t=qce){let i=-1;return null!=e&&(Q7(e)?t=e:i=e),new me(r=>{let s=function Qve(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function Oj(n,e=hE){const t=AB(n,e);return Fj(()=>t)}class vL{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class h1 extends vL{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class oT extends vL{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class Wve extends vL{constructor(e){super(),this.element=e instanceof Ws?e.nativeElement:e}}class bL{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof h1?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof oT?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof Wve?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class jve extends bL{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const l=o.element,d=this._document.createComment("dom-portal");l.parentNode.insertBefore(d,l),this.outletElement.appendChild(l),this._attachedPortal=o,super.setDisposeFn(()=>{d.parentNode&&d.parentNode.replaceChild(l,d)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||sl.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let $C=(()=>{class n extends bL{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new xs,this.attachDomPortal=s=>{const o=s.element,l=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(l,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(o,l)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(M),Vt(_n),Vt(fa))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[mi.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[Fo]})}return n})(),gB=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})();const Xve=["addListener","removeListener"],Yve=["addEventListener","removeEventListener"],Kve=["on","off"];function hx(n,e,t,i){if(Ke(t)&&(i=t,t=void 0),i)return hx(n,e,t).pipe(rk(i));const[r,s]=function ebe(n){return Ke(n.addEventListener)&&Ke(n.removeEventListener)}(n)?Yve.map(o=>l=>n[o](e,l,t)):function Zve(n){return Ke(n.addListener)&&Ke(n.removeListener)}(n)?Xve.map(Lj(n,e)):function Jve(n){return Ke(n.on)&&Ke(n.off)}(n)?Kve.map(Lj(n,e)):[];if(!r&&KR(n))return Gu(o=>hx(o,e,t))(Qh(n));if(!r)throw new TypeError("Invalid event target");return new me(o=>{const l=(...d)=>o.next(1<d.length?d:d[0]);return r(l),()=>s(l)})}function Lj(n,e){return t=>i=>n[t](e,i)}const aT={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=aT;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new lt(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=aT;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=aT;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},Nj=new class nbe extends pF{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class tbe extends fF{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=aT.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(aT.cancelAnimationFrame(t),e._scheduled=void 0)}});function Uj(n,e=hE){return function ibe(n){return ln((e,t)=>{let i=!1,r=null,s=null,o=!1;const l=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const u=r;r=null,t.next(u)}o&&t.complete()},d=()=>{s=null,o&&t.complete()};e.subscribe(Un(t,u=>{i=!0,r=u,s||Qh(n(u)).subscribe(s=Un(t,l,d))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>AB(n,e))}let _B=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new xt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new me(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(Uj(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):io()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(jc(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=au(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>hx(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Be),pi(od),pi(fa,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lT=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new xt,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Uj(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||n)(pi(od),pi(Be),pi(fa,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),cT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})(),zj=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[lE,cT,lE,cT]})}return n})();const Hj=yH();class abe{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=ou(-this._previousScrollPosition.left),e.style.top=ou(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),Hj&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Hj&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class lbe{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(jc(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Vj{enable(){}disable(){}attach(){}}function xL(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function Gj(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class cbe{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();xL(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let dbe=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new Vj,this.close=o=>new lbe(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new abe(this._viewportRuler,this._document),this.reposition=o=>new cbe(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static#e=this.\u0275fac=function(i){return new(i||n)(pi(_B),pi(lT),pi(Be),pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class wL{constructor(e){if(this.scrollStrategy=new Vj,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class ube{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let qj=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hbe=(()=>{class n extends qj{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const l=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(r)):l.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(Be,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fbe=(()=>{class n extends qj{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=hA(s)},this._clickListener=s=>{const o=hA(s),l="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const d=this._attachedOverlays.slice();for(let u=d.length-1;u>-1;u--){const f=d[u];if(f._outsidePointerEvents.observers.length<1||!f.hasAttached())continue;if(f.overlayElement.contains(o)||f.overlayElement.contains(l))break;const g=f._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>g.next(s)):g.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(od),pi(Be,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yB=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||dF()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),dF()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(od))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class vB{constructor(e,t,i,r,s,o,l,d,u,f=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=l,this._location=d,this._outsideClickDispatcher=u,this._animationsDisabled=f,this._backdropElement=null,this._backdropClick=new xt,this._attachments=new xt,this._detachments=new xt,this._locationChanges=lt.EMPTY,this._backdropClickHandler=g=>this._backdropClick.next(g),this._backdropTransitionendHandler=g=>{this._disposeBackdrop(g.target)},this._keydownEvents=new xt,this._outsidePointerEvents=new xt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(sd(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=ou(this._config.width),e.height=ou(this._config.height),e.minWidth=ou(this._config.minWidth),e.minHeight=ou(this._config.minHeight),e.maxWidth=ou(this._config.maxWidth),e.maxHeight=ou(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=fE(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(jl(wm(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Qj="cdk-overlay-connected-position-bounding-box",pbe=/([A-Za-z%]+)$/;class mbe{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new xt,this._resizeSubscription=lt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(Qj),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let l of this._preferredPositions){let d=this._getOriginPoint(e,r,l),u=this._getOverlayPoint(d,t,l),f=this._getOverlayFit(u,t,i,l);if(f.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(l,d);this._canFitWithFlexibleDimensions(f,u,i)?s.push({position:l,origin:d,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(d,l)}):(!o||o.overlayFit.visibleArea<f.visibleArea)&&(o={overlayFit:f,overlayPoint:u,originPoint:d,position:l,overlayRect:t})}if(s.length){let l=null,d=-1;for(const u of s){const f=u.boundingBoxRect.width*u.boundingBoxRect.height*(u.position.weight||1);f>d&&(d=f,l=u)}return this._isPushed=!1,void this._applyPosition(l.position,l.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&fx(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Qj),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,l=this._isRtl()?e.left:e.right;r="start"==i.originX?o:l}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=jj(t);let{x:o,y:l}=e,d=this._getOffset(r,"x"),u=this._getOffset(r,"y");d&&(o+=d),u&&(l+=u);let T=0-l,B=l+s.height-i.height,q=this._subtractOverflows(s.width,0-o,o+s.width-i.width),re=this._subtractOverflows(s.height,T,B),se=q*re;return{visibleArea:se,isCompletelyWithinViewport:s.width*s.height===se,fitsInViewportVertically:re===s.height,fitsInViewportHorizontally:q==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=Wj(this._overlayRef.getConfig().minHeight),l=Wj(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=l&&l<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=jj(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),l=Math.max(e.y+r.height-s.height,0),d=Math.max(s.top-i.top-e.y,0),u=Math.max(s.left-i.left-e.x,0);let f=0,g=0;return f=r.width<=s.width?u||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,g=r.height<=s.height?d||-l:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:f,y:g},{x:e.x+f,y:e.y+g}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!function Abe(n,e){return n===e||n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new ube(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,l,f,g,T;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)l=i.height-e.y+2*this._viewportMargin,s=i.height-l+this._viewportMargin;else{const B=Math.min(i.bottom-e.y+i.top,e.y),q=this._lastBoundingBoxSize.height;s=2*B,o=e.y-B,s>q&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-q/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)T=i.width-e.x+2*this._viewportMargin,f=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)g=e.x,f=i.right-e.x;else{const B=Math.min(i.right-e.x+i.left,e.x),q=this._lastBoundingBoxSize.width;f=2*B,g=e.x-B,f>q&&!this._isInitialRender&&!this._growAfterOpen&&(g=e.x-q/2)}return{top:o,left:g,bottom:l,right:T,width:f,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=ou(i.height),r.top=ou(i.top),r.bottom=ou(i.bottom),r.width=ou(i.width),r.left=ou(i.left),r.right=ou(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=ou(s)),o&&(r.maxWidth=ou(o))}this._lastBoundingBoxSize=i,fx(this._boundingBox.style,r)}_resetBoundingBoxStyles(){fx(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){fx(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const f=this._viewportRuler.getViewportScrollPosition();fx(i,this._getExactOverlayY(t,e,f)),fx(i,this._getExactOverlayX(t,e,f))}else i.position="static";let l="",d=this._getOffset(t,"x"),u=this._getOffset(t,"y");d&&(l+=`translateX(${d}px) `),u&&(l+=`translateY(${u}px)`),i.transform=l.trim(),o.maxHeight&&(r?i.maxHeight=ou(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=ou(o.maxWidth):s&&(i.maxWidth="")),fx(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=ou(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=ou(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Gj(e,i),isOriginOutsideView:xL(e,i),isOverlayClipped:Gj(t,i),isOverlayOutsideView:xL(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&fE(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Ws)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function fx(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Wj(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(pbe);return t&&"px"!==t?null:parseFloat(e)}return n||null}function jj(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const $j="cdk-global-overlay-wrapper";class gbe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add($j),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:l}=i,d=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),u=!("100%"!==s&&"100vh"!==s||l&&"100%"!==l&&"100vh"!==l),f=this._xPosition,g=this._xOffset,T="rtl"===this._overlayRef.getConfig().direction;let B="",q="",re="";d?re="flex-start":"center"===f?(re="center",T?q=g:B=g):T?"left"===f||"end"===f?(re="flex-end",B=g):("right"===f||"start"===f)&&(re="flex-start",q=g):"left"===f||"start"===f?(re="flex-start",B=g):("right"===f||"end"===f)&&(re="flex-end",q=g),e.position=this._cssPosition,e.marginLeft=d?"0":B,e.marginTop=u?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=d?"0":q,t.justifyContent=re,t.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove($j),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let _be=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new gbe}flexibleConnectedTo(t){return new mbe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(lT),pi(fa),pi(od),pi(yB))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ybe=0,uu=(()=>{class n{constructor(t,i,r,s,o,l,d,u,f,g,T,B){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=l,this._ngZone=d,this._document=u,this._directionality=f,this._location=g,this._outsideClickDispatcher=T,this._animationsModuleType=B}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new wL(t);return o.direction=o.direction||this._directionality.value,new vB(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+ybe++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(S0)),new jve(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(dbe),pi(yB),pi(M),pi(_be),pi(hbe),pi(sl),pi(Be),pi(fa),pi(mm),pi(hb),pi(fbe),pi(Fd,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const xbe={provide:new Mi("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const n=li(uu);return()=>n.scrollStrategies.reposition()}}),deps:[uu],useFactory:function bbe(n){return()=>n.scrollStrategies.reposition()}};let dT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[uu,xbe],imports:[lE,gB,zj,zj]})}return n})();const wbe=["mat-menu-item",""],Cbe=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Mbe=["mat-icon, [matMenuItemIcon]","*"];function Sbe(n,e){1&n&&(Ul(),en(0,"svg",2),Er(1,"polygon",3),vn())}const Ebe=["*"];function Tbe(n,e){if(1&n){const t=Uo();en(0,"div",0),gi("keydown",function(r){return vi(t),bi(br()._handleKeydown(r))})("click",function(){return vi(t),bi(br().closed.emit("click"))})("@transformMenu.start",function(r){return vi(t),bi(br()._onAnimationStart(r))})("@transformMenu.done",function(r){return vi(t),bi(br()._onAnimationDone(r))}),en(1,"div",1),eu(2),vn()()}if(2&n){const t=br();sA(t._classList),Qn("id",t.panelId)("@transformMenu",t._panelAnimationState),ol("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const CL=new Mi("MAT_MENU_PANEL");let f1=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=o,this.role="menuitem",this.disabled=!1,this.disableRipple=!1,this._hovered=new xt,this._focused=new xt,this._highlighted=!1,this._triggersSubmenu=!1,s?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(fa),Vt(K_),Vt(CL,8),Vt(vc))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(i,r){1&i&&gi("click",function(o){return r._checkDisabled(o)})("mouseenter",function(){return r._handleMouseEnter()}),2&i&&(ol("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),nl("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{role:"role",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",ho],disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",ho]},exportAs:["matMenuItem"],standalone:!0,features:[Wl,rd],attrs:wbe,ngContentSelectors:Mbe,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(i,r){1&i&&(vh(Cbe),eu(0),en(1,"span",0),eu(2,1),vn(),Er(3,"div",1),Ss(4,Sbe,2,0,":svg:svg",2)),2&i&&(qn(3),Qn("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),qn(),V_(4,r._triggersSubmenu?4:-1))},dependencies:[O0],encapsulation:2,changeDetection:0})}return n})();const Dbe=new Mi("MatMenuContent"),bB={transformMenu:tE("transformMenu",[X_("void",qu({opacity:0,transform:"scale(0.8)"})),R0("void => enter",P0("120ms cubic-bezier(0, 0, 0.2, 1)",qu({opacity:1,transform:"scale(1)"}))),R0("* => void",P0("100ms 25ms linear",qu({opacity:0})))]),fadeInItems:tE("fadeInItems",[X_("showing",qu({opacity:1})),R0("void => *",[qu({opacity:0}),P0("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Ibe=0;const Bbe=new Mi("mat-menu-default-options",{providedIn:"root",factory:function Pbe(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let p1=(()=>{class n{get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}set panelClass(t){const i=this._previousPanelClass,r={...this._classList};i&&i.length&&i.split(" ").forEach(s=>{r[s]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(s=>{r[s]=!0}),this._elementRef.nativeElement.className=""),this._classList=r}get classList(){return this.panelClass}set classList(t){this.panelClass=t}constructor(t,i,r,s){this._elementRef=t,this._ngZone=i,this._changeDetectorRef=s,this._elevationPrefix="mat-elevation-z",this._baseElevation=8,this._directDescendantItems=new vf,this._classList={},this._panelAnimationState="void",this._animationDone=new xt,this.closed=new xs,this.close=this.closed,this.panelId="mat-menu-panel-"+Ibe++,this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this.overlapTrigger=r.overlapTrigger,this.hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new RH(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(dA(this._directDescendantItems),Rf(t=>wm(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),s=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[s]&&!r[s].disabled?i.setActiveItem(s):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe(dA(this._directDescendantItems),Rf(i=>wm(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:O2(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe(sd(1)).subscribe(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,s=Object.keys(this._classList).find(o=>o.startsWith(this._elevationPrefix));if(!s||s===this._previousElevation){const o={...this._classList};this._previousElevation&&(o[this._previousElevation]=!1),o[r]=!0,this._previousElevation=r,this._classList=o}}setPositionClasses(t=this.xPosition,i=this.yPosition){this._classList={...this._classList,"mat-menu-before":"before"===t,"mat-menu-after":"after"===t,"mat-menu-above":"above"===i,"mat-menu-below":"below"===i},this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(dA(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(Be),Vt(Bbe),Vt(vc))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-menu"]],contentQueries:function(i,r,s){if(1&i&&(vp(s,Dbe,5),vp(s,f1,5),vp(s,f1,4)),2&i){let o;ia(o=ra())&&(r.lazyContent=o.first),ia(o=ra())&&(r._allItems=o),ia(o=ra())&&(r.items=o)}},viewQuery:function(i,r){if(1&i&&vl(Nd,5),2&i){let s;ia(s=ra())&&(r.templateRef=s.first)}},hostVars:3,hostBindings:function(i,r){2&i&&ol("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[mi.HasDecoratorInputTransform,"overlapTrigger","overlapTrigger",ho],hasBackdrop:[mi.HasDecoratorInputTransform,"hasBackdrop","hasBackdrop",t=>null==t?null:ho(t)],panelClass:[mi.None,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],standalone:!0,features:[Po([{provide:CL,useExisting:n}]),Wl,rd],ngContentSelectors:Ebe,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"keydown","click","id"],[1,"mat-mdc-menu-content"]],template:function(i,r){1&i&&(vh(),Ss(0,Tbe,3,7,"ng-template"))},styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font);line-height:var(--mat-menu-item-label-text-line-height);font-size:var(--mat-menu-item-label-text-size);letter-spacing:var(--mat-menu-item-label-text-tracking);font-weight:var(--mat-menu-item-label-text-weight)}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape);background-color:var(--mat-menu-container-color);will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-divider{color:var(--mat-menu-divider-color);margin-bottom:var(--mat-menu-divider-bottom-spacing);margin-top:var(--mat-menu-divider-top-spacing)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:var(--mat-menu-item-leading-spacing);padding-right:var(--mat-menu-item-trailing-spacing);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;align-items:center;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:var(--mat-menu-item-trailing-spacing);padding-right:var(--mat-menu-item-leading-spacing)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing);padding-right:var(--mat-menu-item-with-icon-trailing-spacing)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]),.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon])[dir=rtl]{padding-left:var(--mat-menu-item-with-icon-trailing-spacing);padding-right:var(--mat-menu-item-with-icon-leading-spacing)}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color)}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color)}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing);height:var(--mat-menu-item-icon-size);width:var(--mat-menu-item-icon-size)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing)}[dir=rtl] .mat-mdc-menu-submenu-icon{padding-right:var(--mat-menu-item-spacing);padding-left:0}[dir=rtl] .mat-mdc-menu-submenu-icon polygon{transform:scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[bB.transformMenu,bB.fadeInItems]},changeDetection:0})}return n})();const Xj=new Mi("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{const n=li(uu);return()=>n.scrollStrategies.reposition()}}),kbe={provide:Xj,deps:[uu],useFactory:function Rbe(n){return()=>n.scrollStrategies.reposition()}},Yj=ug({passive:!0});let XC=(()=>{class n{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(t,i,r,s,o,l,d,u,f){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=l,this._dir=d,this._focusMonitor=u,this._ngZone=f,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=lt.EMPTY,this._hoverSubscription=lt.EMPTY,this._menuCloseSubscription=lt.EMPTY,this._changeDetectorRef=li(vc),this._handleTouchStart=g=>{gI(g)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new xs,this.onMenuOpen=this.menuOpened,this.menuClosed=new xs,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=o instanceof p1?o:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,Yj)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,Yj),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const i=this._createOverlay(t),r=i.getConfig(),s=r.positionStrategy;this._setPosition(t,s),r.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,i.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof p1&&(t._startAnimation(),t._directDescendantItems.changes.pipe(jl(t.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof p1?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(jc(r=>"void"===r.toState),sd(1),jl(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let i=0,r=t.parentMenu;for(;r;)i++,r=r.parentMenu;t.setElevation(i)}}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new wL({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{const s="start"===r.connectionPair.overlayX?"after":"before",o="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(s,o)):t.setPositionClasses(s,o)})}_setPosition(t,i){let[r,s]="before"===t.xPosition?["end","start"]:["start","end"],[o,l]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[d,u]=[o,l],[f,g]=[r,s],T=0;if(this.triggersSubmenu()){if(g=r="before"===t.xPosition?"start":"end",s=f="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const B=this._parentMaterialMenu.items.first;this._parentInnerPadding=B?B._getHostElement().offsetTop:0}T="bottom"===o?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(d="top"===o?"bottom":"top",u="top"===l?"bottom":"top");i.withPositions([{originX:r,originY:d,overlayX:f,overlayY:o,offsetY:T},{originX:s,originY:d,overlayX:g,overlayY:o,offsetY:T},{originX:r,originY:u,overlayX:f,overlayY:l,offsetY:-T},{originX:s,originY:u,overlayX:g,overlayY:l,offsetY:-T}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return wm(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:io(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(jc(o=>o!==this._menuItemInstance),jc(()=>this._menuOpen)):io(),i)}_handleMousedown(t){AI(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(jc(t=>t===this._menuItemInstance&&!t.disabled),Oj(0,yL)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof p1&&this.menu._isAnimating?this.menu._animationDone.pipe(sd(1),Oj(0,yL),jl(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new oT(t.templateRef,this._viewContainerRef)),this._portal}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(uu),Vt(Ws),Vt(_n),Vt(Xj),Vt(CL,8),Vt(f1,10),Vt(mm,8),Vt(K_),Vt(Be))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(i,r){1&i&&gi("click",function(o){return r._handleClick(o)})("mousedown",function(o){return r._handleMousedown(o)})("keydown",function(o){return r._handleKeydown(o)}),2&i&&ol("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[mi.None,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[mi.None,"matMenuTriggerFor","menu"],menuData:[mi.None,"matMenuTriggerData","menuData"],restoreFocus:[mi.None,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"],standalone:!0})}return n})(),Fbe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[kbe],imports:[DS,bI,Gd,dT,cT,Gd]})}return n})();const Obe=["tooltip"],Zj=new Mi("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{const n=li(uu);return()=>n.scrollStrategies.reposition({scrollThrottle:20})}}),Nbe={provide:Zj,deps:[uu],useFactory:function Lbe(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},zbe=new Mi("mat-tooltip-default-options",{providedIn:"root",factory:function Ube(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),Jj="tooltip-panel",e$=ug({passive:!0});let m1=(()=>{class n{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=SH(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){this._disabled=SH(t),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=xb(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=xb(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,i,r,s,o,l,d,u,f,g,T,B){this._overlay=t,this._elementRef=i,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=o,this._platform=l,this._ariaDescriber=d,this._focusMonitor=u,this._dir=g,this._defaultOptions=T,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=Qbe,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new xt,this._scrollStrategy=f,this._document=B,T&&(this._showDelay=T.showDelay,this._hideDelay=T.hideDelay,T.position&&(this.position=T.position),T.positionAtOrigin&&(this.positionAtOrigin=T.positionAtOrigin),T.touchGestures&&(this.touchGestures=T.touchGestures)),g.change.pipe(jl(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=8}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(jl(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{t.removeEventListener(i,r,e$)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new h1(this._tooltipComponent,this._viewContainerRef);const s=this._tooltipInstance=r.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(jl(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(t)}hide(t=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(t):(i._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&s._origin instanceof Ws)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(jl(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${Jj}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(jl(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(jl(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(jl(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!O2(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const i=t.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...s.main}),this._addOffset({...r.fallback,...s.fallback})])}_addOffset(t){const r=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=r?-8:8:"end"===t.originX&&(t.offsetX=r?8:-8),t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={originX:"end",originY:"center"});const{x:s,y:o}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:o}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:o}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:o}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(sd(1),jl(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:i}}_updateCurrentPositionClass(t){const{overlayY:i,originX:r,originY:s}=t;let o;if(o="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===s?"above":"below",o!==this._currentPosition){const l=this._overlayRef;if(l){const d=`${this._cssClassPrefix}-${Jj}-`;l.removePanelClass(d+this._currentPosition),l.addPanelClass(d+o)}this._currentPosition=o}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(i=t),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const i=t.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,r),this._defaultOptions.touchLongPressShowDelay??500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",i],["touchcancel",i])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,e$)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const i=this._elementRef.nativeElement,r=i.style;("on"===t||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(uu),Vt(Ws),Vt(_B),Vt(_n),Vt(Be),Vt(od),Vt(ide),Vt(K_),Vt(Zj),Vt(mm),Vt(zbe,8),Vt(fa))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(i,r){2&i&&nl("mat-mdc-tooltip-disabled",r.disabled)},inputs:{position:[mi.None,"matTooltipPosition","position"],positionAtOrigin:[mi.None,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[mi.None,"matTooltipDisabled","disabled"],showDelay:[mi.None,"matTooltipShowDelay","showDelay"],hideDelay:[mi.None,"matTooltipHideDelay","hideDelay"],touchGestures:[mi.None,"matTooltipTouchGestures","touchGestures"],message:[mi.None,"matTooltip","message"],tooltipClass:[mi.None,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}return n})(),Qbe=(()=>{class n{constructor(t,i,r){this._changeDetectorRef=t,this._elementRef=i,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new xt,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled="NoopAnimations"===r}show(t){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const i=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(i.classList.remove(t?s:r),i.classList.add(t?r:s),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const o=getComputedStyle(i);("0s"===o.getPropertyValue("animation-duration")||"none"===o.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(vc),Vt(Ws),Vt(Fd,8))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(i,r){if(1&i&&vl(Obe,7),2&i){let s;ia(s=ra())&&(r._tooltip=s.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(i,r){1&i&&gi("mouseleave",function(o){return r._handleMouseLeave(o)}),2&i&&uS("zoom",r.isVisible()?1:null)},standalone:!0,features:[rd],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(i,r){if(1&i){const s=Uo();en(0,"div",1,0),gi("animationend",function(l){return vi(s),bi(r._handleAnimationEnd(l))}),en(2,"div",2),Ji(3),vn()()}2&i&&(nl("mdc-tooltip--multiline",r._isMultiline),Qn("ngClass",r.tooltipClass),qn(3),rg(r.message))},dependencies:[og],styles:['.mdc-tooltip__surface{word-break:break-all;word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip--showing-transition .mdc-tooltip__surface-animation{transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-tooltip--hide-transition .mdc-tooltip__surface-animation{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - 2*8px);margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - 2*8px);align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mat-mdc-tooltip .mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color)}.mat-mdc-tooltip .mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__caret-surface-top,.mat-mdc-tooltip .mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color)}.mat-mdc-tooltip .mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}return n})(),Wbe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[Nbe],imports:[VH,DS,dT,Gd,Gd,cT]})}return n})();var jbe=Ee(1123);function ML(n,e,t){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];r?n.setProperty(i,r,t?.has(i)?"important":""):n.removeProperty(i)}return n}function YC(n,e){const t=e?"":"none";ML(n.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function t$(n,e,t){ML(n.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function xB(n,e){return e&&"none"!=e?n+" "+e:n}function n$(n,e){n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,n.style.transform=wB(e.left,e.top)}function wB(n,e){return`translate3d(${Math.round(n)}px, ${Math.round(e)}px, 0)`}function SL(n){const e=n.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function EL(n,e,t){const{top:i,bottom:r,left:s,right:o}=n;return t>=i&&t<=r&&e>=s&&e<=o}function uT(n,e,t){n.top+=e,n.bottom=n.top+n.height,n.left+=t,n.right=n.left+n.width}function i$(n,e,t,i){const{top:r,right:s,bottom:o,left:l,width:d,height:u}=n,f=d*e,g=u*e;return i>r-g&&i<o+g&&t>l-f&&t<s+f}class r${constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:SL(t)})})}handleScroll(e){const t=hA(e),i=this.positions.get(t);if(!i)return null;const r=i.scrollPosition;let s,o;if(t===this._document){const u=this.getViewportScrollPosition();s=u.top,o=u.left}else s=t.scrollTop,o=t.scrollLeft;const l=r.top-s,d=r.left-o;return this.positions.forEach((u,f)=>{u.clientRect&&t!==f&&t.contains(f)&&uT(u.clientRect,l,d)}),r.top=s,r.left=o,{top:l,left:d}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function s$(n){const e=n.cloneNode(!0),t=e.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===i?l$(n,e):("input"===i||"select"===i||"textarea"===i)&&a$(n,e),o$("canvas",n,e,l$),o$("input, textarea, select",n,e,a$),e}function o$(n,e,t,i){const r=e.querySelectorAll(n);if(r.length){const s=t.querySelectorAll(n);for(let o=0;o<r.length;o++)i(r[o],s[o])}}let Xbe=0;function a$(n,e){"file"!==e.type&&(e.value=n.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${Xbe++}`)}function l$(n,e){const t=e.getContext("2d");if(t)try{t.drawImage(n,0,0)}catch{}}function c$(n,e){const t=n.rootNodes;if(1===t.length&&t[0].nodeType===e.ELEMENT_NODE)return t[0];const i=e.createElement("div");return t.forEach(r=>i.appendChild(r)),i}function d$(n){const e=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*e}function TL(n,e){return n.getPropertyValue(e).split(",").map(i=>i.trim())}const Kbe=new Set(["position"]);class Zbe{constructor(e,t,i,r,s,o,l,d,u){this._document=e,this._rootElement=t,this._direction=i,this._initialDomRect=r,this._previewTemplate=s,this._previewClass=o,this._pickupPositionOnPage=l,this._initialTransform=d,this._zIndex=u}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),"showPopover"in this._preview&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return function Ybe(n){const e=getComputedStyle(n),t=TL(e,"transition-property"),i=t.find(l=>"transform"===l||"all"===l);if(!i)return 0;const r=t.indexOf(i),s=TL(e,"transition-duration"),o=TL(e,"transition-delay");return d$(s[r])+d$(o[r])}(this._preview)}addEventListener(e,t){this._preview.addEventListener(e,t)}removeEventListener(e,t){this._preview.removeEventListener(e,t)}_createPreview(){const e=this._previewTemplate,t=this._previewClass,i=e?e.template:null;let r;if(i&&e){const s=e.matchSize?this._initialDomRect:null,o=e.viewContainer.createEmbeddedView(i,e.context);o.detectChanges(),r=c$(o,this._document),this._previewEmbeddedView=o,e.matchSize?n$(r,s):r.style.transform=wB(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=s$(this._rootElement),n$(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return ML(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Kbe),YC(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}}const u$=ug({passive:!0}),CB=ug({passive:!1}),h$=ug({passive:!1,capture:!0}),f$=new Set(["position"]);class exe{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>YC(t,e)))}constructor(e,t,i,r,s,o){this._config=t,this._document=i,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new xt,this._pointerMoveSubscription=lt.EMPTY,this._pointerUpSubscription=lt.EMPTY,this._scrollSubscription=lt.EMPTY,this._resizeSubscription=lt.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new xt,this.started=new xt,this.released=new xt,this.ended=new xt,this.entered=new xt,this.exited=new xt,this.dropped=new xt,this.moved=this._moveEvents,this._pointerDown=l=>{if(this.beforeStarted.next(),this._handles.length){const d=this._getTargetHandle(l);d&&!this._disabledHandles.has(d)&&!this.disabled&&this._initializeDragSequence(d,l)}else this.disabled||this._initializeDragSequence(this._rootElement,l)},this._pointerMove=l=>{const d=this._getPointerPositionOnPage(l);if(!this._hasStartedDragging){if(Math.abs(d.x-this._pickupPositionOnPage.x)+Math.abs(d.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const B=Date.now()>=this._dragStartTime+this._getDragStartDelay(l),q=this._dropContainer;if(!B)return void this._endDragSequence(l);(!q||!q.isDragging()&&!q.isReceiving())&&(l.cancelable&&l.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(l)))}return}l.cancelable&&l.preventDefault();const u=this._getConstrainedPointerPosition(d);if(this._hasMoved=!0,this._lastKnownPointerPosition=d,this._updatePointerDirectionDelta(u),this._dropContainer)this._updateActiveDropContainer(u,d);else{const f=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,g=this._activeTransform;g.x=u.x-f.x+this._passiveTransform.x,g.y=u.y-f.y+this._passiveTransform.y,this._applyRootElementTransform(g.x,g.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:u,event:l,distance:this._getDragDistance(u),delta:this._pointerDirectionDelta})})},this._pointerUp=l=>{this._endDragSequence(l)},this._nativeDragStart=l=>{if(this._handles.length){const d=this._getTargetHandle(l);d&&!this._disabledHandles.has(d)&&!this.disabled&&l.preventDefault()}else this.disabled||l.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new r$(i),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(i=>au(i)),this._handles.forEach(i=>YC(i,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){const t=au(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,CB),t.addEventListener("touchstart",this._pointerDown,u$),t.addEventListener("dragstart",this._nativeDragStart,CB)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?au(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),YC(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),YC(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){const e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){const e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",m$,h$)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){hT(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._getShadowRoot(),i=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{t.addEventListener("selectstart",m$,h$)}),i){const r=this._rootElement,s=r.parentNode,o=this._placeholder=this._createPlaceholderElement(),l=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(l,r),this._initialTransform=r.style.transform||"",this._preview=new Zbe(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,t)),t$(r,!1,f$),this._document.body.appendChild(s.replaceChild(o,r)),this.started.next({source:this,event:e}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();const i=this.isDragging(),r=hT(t),s=!r&&0!==t.button,o=this._rootElement,l=hA(t),d=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),u=r?gI(t):AI(t);if(l&&l.draggable&&"mousedown"===t.type&&t.preventDefault(),i||s||d||u)return;if(this._handles.length){const T=o.style;this._rootElementTapHighlight=T.webkitTapHighlightColor||"",T.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(T=>this._updateOnScroll(T)),this._boundaryElement&&(this._boundaryRect=SL(this._boundaryElement));const f=this._previewTemplate;this._pickupPositionInElement=f&&f.template&&!f.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);const g=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:g.x,y:g.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){t$(this._rootElement,!0,f$),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),s=this._getDragDistance(r),o=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s,dropPoint:r,event:e}),t.drop(this,i,this._initialIndex,this._initialContainer,o,s,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:i,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);const t=this._preview.getTransitionDuration();return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const r=o=>{(!o||hA(o)===this._preview&&"transform"===o.propertyName)&&(this._preview?.removeEventListener("transitionend",r),i(),clearTimeout(s))},s=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const e=this._placeholderTemplate,t=e?e.template:null;let i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=c$(this._placeholderRef,this._document)):i=s$(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(e,t,i){const r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():e,o=hT(i)?i.targetTouches[0]:i,l=this._getViewportScrollPosition();return{x:s.left-e.left+(o.pageX-s.left-l.left),y:s.top-e.top+(o.pageY-s.top-l.top)}}_getPointerPositionOnPage(e){const t=this._getViewportScrollPosition(),i=hT(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=i.pageX-t.left,s=i.pageY-t.top;if(this._ownerSVGElement){const o=this._ownerSVGElement.getScreenCTM();if(o){const l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=s,l.matrixTransform(o.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(e){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:s,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,l=this._boundaryRect,{width:d,height:u}=this._getPreviewRect(),f=l.top+o,g=l.bottom-(u-o);i=p$(i,l.left+s,l.right-(d-s)),r=p$(r,f,g)}return{x:i,y:r}}_updatePointerDirectionDelta(e){const{x:t,y:i}=e,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-s.x),l=Math.abs(i-s.y);return o>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),l>this._config.pointerDirectionChangeThreshold&&(r.y=i>s.y?1:-1,s.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,YC(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,CB),e.removeEventListener("touchstart",this._pointerDown,u$),e.removeEventListener("dragstart",this._nativeDragStart,CB)}_applyRootElementTransform(e,t){const i=wB(e,t),r=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=r.transform&&"none"!=r.transform?r.transform:""),r.transform=xB(i,this._initialTransform)}_applyPreviewTransform(e,t){const i=this._previewTemplate?.template?void 0:this._initialTransform,r=wB(e,t);this._preview.setTransform(xB(r,i))}_getDragDistance(e){const t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(0===e&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===i.width&&0===i.height)return;const s=r.left-i.left,o=i.right-r.right,l=r.top-i.top,d=i.bottom-r.bottom;r.width>i.width?(s>0&&(e+=s),o>0&&(e-=o)):e=0,r.height>i.height?(l>0&&(t+=l),d>0&&(t-=d)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){const t=this.dragStartDelay;return"number"==typeof t?t:hT(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){const t=this._parentPositions.handleScroll(e);if(t){const i=hA(e);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&uT(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=lF(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){const i=this._previewContainer||"global";if("parent"===i)return e;if("global"===i){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return au(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}}function p$(n,e,t){return Math.max(e,Math.min(t,n))}function hT(n){return"t"===n.type[0]}function m$(n){n.preventDefault()}function fT(n,e){return Math.max(0,Math.min(e,n))}class nxe{constructor(e,t){this._element=e,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,i,r){const s=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,i,r);if(-1===o&&s.length>0)return null;const l="horizontal"===this.orientation,d=s.findIndex(se=>se.drag===e),u=s[o],g=u.clientRect,T=d>o?1:-1,B=this._getItemOffsetPx(s[d].clientRect,g,T),q=this._getSiblingOffsetPx(d,s,T),re=s.slice();return function txe(n,e,t){const i=fT(e,n.length-1),r=fT(t,n.length-1);if(i===r)return;const s=n[i],o=r<i?-1:1;for(let l=i;l!==r;l+=o)n[l]=n[l+o];n[r]=s}(s,d,o),s.forEach((se,ne)=>{if(re[ne]===se)return;const De=se.drag===e,Se=De?B:q,je=De?e.getPlaceholderElement():se.drag.getRootElement();se.offset+=Se,l?(je.style.transform=xB(`translate3d(${Math.round(se.offset)}px, 0, 0)`,se.initialTransform),uT(se.clientRect,0,Se)):(je.style.transform=xB(`translate3d(0, ${Math.round(se.offset)}px, 0)`,se.initialTransform),uT(se.clientRect,Se,0))}),this._previousSwap.overlaps=EL(g,t,i),this._previousSwap.drag=u.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:d,currentIndex:o}}enter(e,t,i,r){const s=null==r||r<0?this._getItemIndexFromPointerPosition(e,t,i):r,o=this._activeDraggables,l=o.indexOf(e),d=e.getPlaceholderElement();let u=o[s];if(u===e&&(u=o[s+1]),!u&&(null==s||-1===s||s<o.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(u=o[0]),l>-1&&o.splice(l,1),u&&!this._dragDropRegistry.isDragging(u)){const f=u.getRootElement();f.parentElement.insertBefore(d,f),o.splice(s,0,e)}else au(this._element).appendChild(d),o.push(e);d.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables.forEach(e=>{const t=e.getRootElement();if(t){const i=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:i})=>{uT(i,e,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}_cacheItemPositions(){const e="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:SL(i)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getItemOffsetPx(e,t,i){const r="horizontal"===this.orientation;let s=r?t.left-e.left:t.top-e.top;return-1===i&&(s+=r?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,i){const r="horizontal"===this.orientation,s=t[e].clientRect,o=t[e+-1*i];let l=s[r?"width":"height"]*i;if(o){const d=r?"left":"top",u=r?"right":"bottom";-1===i?l-=o.clientRect[d]-s[u]:l+=s[d]-o.clientRect[u]}return l}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,r="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const o=i[i.length-1].clientRect;return r?e>=o.right:t>=o.bottom}{const o=i[0].clientRect;return r?e<=o.left:t<=o.top}}_getItemIndexFromPointerPosition(e,t,i,r){const s="horizontal"===this.orientation,o=this._itemPositions.findIndex(({drag:l,clientRect:d})=>l!==e&&((!r||l!==this._previousSwap.drag||!this._previousSwap.overlaps||(s?r.x:r.y)!==this._previousSwap.delta)&&(s?t>=Math.floor(d.left)&&t<Math.floor(d.right):i>=Math.floor(d.top)&&i<Math.floor(d.bottom))));return-1!==o&&this._sortPredicate(o,e)?o:-1}}var bA=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(bA||{}),Gf=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(Gf||{});class ixe{constructor(e,t,i,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new xt,this.entered=new xt,this.exited=new xt,this.dropped=new xt,this.sorted=new xt,this.receivingStarted=new xt,this.receivingStopped=new xt,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=lt.EMPTY,this._verticalScrollDirection=bA.NONE,this._horizontalScrollDirection=Gf.NONE,this._stopScrollTimers=new xt,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function $be(n=0,e=hE){return n<0&&(n=0),AB(n,n,e)}(0,Nj).pipe(jl(this._stopScrollTimers)).subscribe(()=>{const o=this._scrollNode,l=this.autoScrollStep;this._verticalScrollDirection===bA.UP?o.scrollBy(0,-l):this._verticalScrollDirection===bA.DOWN&&o.scrollBy(0,l),this._horizontalScrollDirection===Gf.LEFT?o.scrollBy(-l,0):this._horizontalScrollDirection===Gf.RIGHT&&o.scrollBy(l,0)})},this.element=au(e),this._document=i,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new r$(i),this._sortStrategy=new nxe(this.element,t),this._sortStrategy.withSortPredicate((o,l)=>this.sortPredicate(o,l,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,i,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,r,s,o,l,d={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:s,distance:o,dropPoint:l,event:d})}withItems(e){const t=this._draggables;return this._draggables=e,e.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===e.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._sortStrategy.direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._sortStrategy.orientation=e,this}withScrollableParents(e){const t=au(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,r){if(this.sortingDisabled||!this._domRect||!i$(this._domRect,.05,t,i))return;const s=this._sortStrategy.sort(e,t,i,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,r=bA.NONE,s=Gf.NONE;if(this._parentPositions.positions.forEach((o,l)=>{l===this._document||!o.clientRect||i||i$(o.clientRect,.05,e,t)&&([r,s]=function rxe(n,e,t,i,r){const s=_$(e,r),o=y$(e,i);let l=bA.NONE,d=Gf.NONE;if(s){const u=n.scrollTop;s===bA.UP?u>0&&(l=bA.UP):n.scrollHeight-u>n.clientHeight&&(l=bA.DOWN)}if(o){const u=n.scrollLeft;"rtl"===t?o===Gf.RIGHT?u<0&&(d=Gf.RIGHT):n.scrollWidth+u>n.clientWidth&&(d=Gf.LEFT):o===Gf.LEFT?u>0&&(d=Gf.LEFT):n.scrollWidth-u>n.clientWidth&&(d=Gf.RIGHT)}return[l,d]}(l,o.clientRect,this._sortStrategy.direction,e,t),(r||s)&&(i=l))}),!r&&!s){const{width:o,height:l}=this._viewportRuler.getViewportSize(),d={width:o,height:l,top:0,right:o,bottom:l,left:0};r=_$(d,t),s=y$(d,e),i=window}i&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=i,(r||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const e=au(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const e=au(this.element);this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(e).clientRect}_reset(){this._isDragging=!1;const e=au(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return null!=this._domRect&&EL(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(r=>r._canReceive(e,t,i))}_canReceive(e,t,i){if(!this._domRect||!EL(this._domRect,t,i)||!this.enterPredicate(e,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,i);if(!r)return!1;const s=au(this.element);return r===s||s.contains(r)}_startReceiving(e,t){const i=this._activeSiblings;!i.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const e=lF(au(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}}function _$(n,e){const{top:t,bottom:i,height:r}=n,s=.05*r;return e>=t-s&&e<=t+s?bA.UP:e>=i-s&&e<=i+s?bA.DOWN:bA.NONE}function y$(n,e){const{left:t,right:i,width:r}=n,s=.05*r;return e>=t-s&&e<=t+s?Gf.LEFT:e>=i-s&&e<=i+s?Gf.RIGHT:Gf.NONE}const MB=ug({passive:!1,capture:!0}),SB=new Set;let sxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Qr({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[rd],decls:0,vars:0,template:function(i,r){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit}}"],encapsulation:2,changeDetection:0})}return n})(),oxe=(()=>{class n{constructor(t,i){this._ngZone=t,this._appRef=li(S0),this._environmentInjector=li(xl),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new xt,this.pointerUp=new xt,this.scroll=new xt,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,MB)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,MB)}startDragging(t,i){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._loadResets(),this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=i.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:MB}),r||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:MB}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,o)=>{this._document.addEventListener(o,s.handler,s.options)})})}}stopDragging(t){const i=this._activeDragInstances.indexOf(t);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new me(r=>this._ngZone.runOutsideAngular(()=>{const o=l=>{this._activeDragInstances.length&&r.next(l)};return t.addEventListener("scroll",o,!0),()=>{t.removeEventListener("scroll",o,!0)}}))),wm(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}_loadResets(){if(!SB.has(this._appRef)){SB.add(this._appRef);const t=function ote(n,e){const t=Ys(n),i=e.elementInjector||nh();return new Nn(t).create(i,e.projectableNodes,e.hostElement,e.environmentInjector)}(sxe,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{SB.delete(this._appRef),0===SB.size&&t.destroy()})}}static#e=this.\u0275fac=function(i){return new(i||n)(pi(Be),pi(fa))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const axe={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let DL=(()=>{class n{constructor(t,i,r,s){this._document=t,this._ngZone=i,this._viewportRuler=r,this._dragDropRegistry=s}createDrag(t,i=axe){return new exe(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new ixe(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static#e=this.\u0275fac=function(i){return new(i||n)(pi(fa),pi(Be),pi(lT),pi(oxe))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const pT=new Mi("CDK_DRAG_PARENT"),v$=new Mi("CdkDragHandle");let b$=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._stateChanges.next(this)}constructor(t,i){this.element=t,this._parentDrag=i,this._stateChanges=new xt,this._disabled=!1,i?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(pT,12))};static#t=this.\u0275dir=Sr({type:n,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[mi.HasDecoratorInputTransform,"cdkDragHandleDisabled","disabled",ho]},standalone:!0,features:[Po([{provide:v$,useExisting:n}]),Wl]})}return n})();const x$=new Mi("CDK_DRAG_CONFIG"),w$=new Mi("CdkDropList");let IL=(()=>{class n{static#e=this._dragInstances=[];get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}constructor(t,i,r,s,o,l,d,u,f,g,T){this.element=t,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=o,this._dir=d,this._changeDetectorRef=f,this._selfHandle=g,this._parentDrag=T,this._destroyed=new xt,this._handles=new jt([]),this.started=new xs,this.released=new xs,this.ended=new xs,this.entered=new xs,this.exited=new xs,this.dropped=new xs,this.moved=new me(B=>{const q=this._dragRef.moved.pipe(Rn(re=>({source:this,pointerPosition:re.pointerPosition,event:re.event,delta:re.delta,distance:re.distance}))).subscribe(B);return()=>{q.unsubscribe()}}),this._dragRef=u.createDrag(t,{dragStartThreshold:l&&null!=l.dragStartThreshold?l.dragStartThreshold:5,pointerDirectionChangeThreshold:l&&null!=l.pointerDirectionChangeThreshold?l.pointerDirectionChangeThreshold:5,zIndex:l?.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),l&&this._assignDefaults(l),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(sd(1),jl(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=n._dragInstances.indexOf(this);t>-1&&n._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){const i=this._handles.getValue();i.push(t),this._handles.next(i)}_removeHandle(t){const i=this._handles.getValue(),r=i.indexOf(t);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const t=this.element.nativeElement;let i=t;this.rootElementSelector&&(i=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):au(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,r=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof r&&r?r:xb(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe(sd(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){t.withParent(n._dragInstances.find(r=>r.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:r,constrainPosition:s,previewClass:o,boundaryElement:l,draggingDisabled:d,rootElementSelector:u,previewContainer:f}=t;this.disabled=d??!1,this.dragStartDelay=r||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),o&&(this.previewClass=o),l&&(this.boundaryElement=l),u&&(this.rootElementSelector=u),f&&(this.previewContainer=f)}_setupHandlesListener(){this._handles.pipe(su(t=>{const i=t.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),Rf(t=>wm(...t.map(i=>i._stateChanges.pipe(dA(i))))),jl(this._destroyed)).subscribe(t=>{const i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}static#t=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(w$,12),Vt(fa),Vt(Be),Vt(_n),Vt(x$,8),Vt(mm,8),Vt(DL),Vt(vc),Vt(v$,10),Vt(pT,12))};static#n=this.\u0275dir=Sr({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){2&i&&nl("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[mi.None,"cdkDragData","data"],lockAxis:[mi.None,"cdkDragLockAxis","lockAxis"],rootElementSelector:[mi.None,"cdkDragRootElement","rootElementSelector"],boundaryElement:[mi.None,"cdkDragBoundary","boundaryElement"],dragStartDelay:[mi.None,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[mi.None,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[mi.HasDecoratorInputTransform,"cdkDragDisabled","disabled",ho],constrainPosition:[mi.None,"cdkDragConstrainPosition","constrainPosition"],previewClass:[mi.None,"cdkDragPreviewClass","previewClass"],previewContainer:[mi.None,"cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[Po([{provide:pT,useExisting:n}]),Wl,Pl]})}return n})(),mxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[DL],imports:[cT]})}return n})();function gxe(n,e){}class EB{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let C$=(()=>{class n extends bL{constructor(t,i,r,s,o,l,d,u){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=o,this._ngZone=l,this._overlayRef=d,this._focusMonitor=u,this._platform=li(od),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=li(vc),this.attachDomPortal=f=>{this._portalOutlet.hasAttached();const g=this._portalOutlet.attachDomPortal(f);return this._contentAttached(),g},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(t){this._ariaLabelledByQueue.push(t),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(t){const i=this._ariaLabelledByQueue.indexOf(t);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=cF(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=cF();return t===i||t.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=cF()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(LH),Vt(fa,8),Vt(EB),Vt(yF),Vt(Be),Vt(vB),Vt(K_))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&vl($C,7),2&i){let s;ia(s=ra())&&(r._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&ol("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},standalone:!0,features:[Fo,rd],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&Ss(0,gxe,0,0,"ng-template",0)},dependencies:[$C],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return n})();class PL{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new xt,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!O2(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const M$=new Mi("DialogScrollStrategy",{providedIn:"root",factory:()=>{const n=li(uu);return()=>n.scrollStrategies.block()}}),_xe=new Mi("DialogData"),yxe=new Mi("DefaultDialogConfig");let bxe=0,S$=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,r,s,o,l){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new xt,this._afterOpenedAtThisLevel=new xt,this._ariaHiddenElements=new Map,this.afterAllClosed=FD(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(dA(void 0))),this._scrollStrategy=l}open(t,i){(i={...this._defaultOptions||new EB,...i}).id=i.id||"cdk-dialog-"+bxe++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),o=this._overlay.create(s),l=new PL(o,i),d=this._attachContainer(o,l,i);return l.containerInstance=d,this._attachDialogContent(t,l,d,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(l),l.closed.subscribe(()=>this._removeOpenDialog(l,!0)),this.afterOpened.next(l),l}closeAll(){RL(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){RL(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),RL(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new wL({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:EB,useValue:r},{provide:PL,useValue:i},{provide:vB,useValue:t}];let l;r.container?"function"==typeof r.container?l=r.container:(l=r.container.type,o.push(...r.container.providers(r))):l=C$;const d=new h1(l,r.viewContainerRef,sl.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return t.attach(d).instance}_attachDialogContent(t,i,r,s){if(t instanceof Nd){const o=this._createInjector(s,i,r,void 0);let l={$implicit:s.data,dialogRef:i};s.templateContext&&(l={...l,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new oT(t,null,l,o))}else{const o=this._createInjector(s,i,r,this._injector),l=r.attachComponentPortal(new h1(t,s.viewContainerRef,o,s.componentFactoryResolver));i.componentRef=l,i.componentInstance=l.instance}}_createInjector(t,i,r,s){const o=t.injector||t.viewContainerRef?.injector,l=[{provide:_xe,useValue:t.data},{provide:PL,useValue:i}];return t.providers&&("function"==typeof t.providers?l.push(...t.providers(i,t,r)):l.push(...t.providers)),t.direction&&(!o||!o.get(mm,null,{optional:!0}))&&l.push({provide:mm,useValue:{value:t.direction,change:io()}}),sl.create({parent:o||s,providers:l})}_removeOpenDialog(t,i){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#e=this.\u0275fac=function(i){return new(i||n)(pi(uu),pi(sl),pi(yxe,8),pi(n,12),pi(yB),pi(M$))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function RL(n,e){let t=n.length;for(;t--;)e(n[t])}let xxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[S$],imports:[dT,gB,VH,gB]})}return n})();function wxe(n,e){}class kL{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const FL="mdc-dialog--open",E$="mdc-dialog--opening",T$="mdc-dialog--closing";let D$=(()=>{class n extends C${constructor(t,i,r,s,o,l,d,u,f){super(t,i,r,s,o,l,d,f),this._animationMode=u,this._animationStateChanged=new xs,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?B$(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?B$(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(I$,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(E$,FL)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(FL),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(FL),this._animationsEnabled?(this._hostElement.style.setProperty(I$,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(T$)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(t){this._actionSectionCount+=t,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(E$,T$)}_waitForAnimationToComplete(t,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(t){const i=super.attachComponentPortal(t);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(LH),Vt(fa,8),Vt(kL),Vt(yF),Vt(Be),Vt(vB),Vt(Fd,8),Vt(K_))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,r){2&i&&(a2("id",r._config.id),ol("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),nl("_mat-animation-noopable",!r._animationsEnabled)("mat-mdc-dialog-container-with-actions",r._actionSectionCount>0))},standalone:!0,features:[Fo,rd],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(en(0,"div",0)(1,"div",1),Ss(2,wxe,0,0,"ng-template",2),vn()())},dependencies:[$C],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0;transform:scale(0.8)}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--closing .mdc-dialog__surface{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{opacity:1}.mdc-dialog--open .mdc-dialog__surface{transform:none}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{width:100%;height:100%}.mat-mdc-dialog-component-host{display:contents}.mat-mdc-dialog-container{--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition:opacity linear var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container .mdc-dialog__surface{transition:transform var(--mat-dialog-transition-duration, 0ms) 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container,.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__surface{transition:none}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-title{padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2})}return n})();const I$="--mat-dialog-transition-duration";function B$(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?xb(n.substring(0,n.length-2)):n.endsWith("s")?1e3*xb(n.substring(0,n.length-1)):"0"===n?0:null}var TB=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(TB||{});class px{constructor(e,t,i){this._ref=e,this._containerInstance=i,this._afterOpened=new xt,this._beforeClosed=new xt,this._state=TB.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),i._animationStateChanged.pipe(jc(r=>"opened"===r.state),sd(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(jc(r=>"closed"===r.state),sd(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),wm(this.backdropClick(),this.keydownEvents().pipe(jc(r=>27===r.keyCode&&!this.disableClose&&!O2(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function P$(n,e,t){return n._closeInteractionType=e,n.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(jc(t=>"closing"===t.state),sd(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=TB.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=TB.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const OL=new Mi("MatMdcDialogData"),Sxe=new Mi("mat-mdc-dialog-default-options"),R$=new Mi("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const n=li(uu);return()=>n.scrollStrategies.block()}});let Txe=0,mx=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,i,r,s,o,l,d,u){this._overlay=t,this._defaultOptions=s,this._scrollStrategy=o,this._parentDialog=l,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new xt,this._afterOpenedAtThisLevel=new xt,this.dialogConfigClass=kL,this.afterAllClosed=FD(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(dA(void 0))),this._dialog=i.get(S$),this._dialogRefConstructor=px,this._dialogContainerType=D$,this._dialogDataToken=OL}open(t,i){let r;(i={...this._defaultOptions||new kL,...i}).id=i.id||"mat-mdc-dialog-"+Txe++,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:EB,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(o,l,d)=>(r=new this._dialogRefConstructor(o,i,d),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:d},{provide:this._dialogDataToken,useValue:l.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=s.componentRef,r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}static#e=this.\u0275fac=function(i){return new(i||n)(pi(uu),pi(sl),pi(hb,8),pi(Sxe,8),pi(R$),pi(n,12),pi(yB),pi(Fd,8))};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Dxe=0,k$=(()=>{class n{constructor(t,i,r){this._dialogRef=t,this._elementRef=i,this._dialog=r}ngOnInit(){this._dialogRef||(this._dialogRef=function F$(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(px,8),Vt(Ws),Vt(mx))};static#t=this.\u0275dir=Sr({type:n,standalone:!0})}return n})(),mT=(()=>{class n extends k${constructor(){super(...arguments),this.id="mat-mdc-dialog-title-"+Dxe++}_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275dir=Sr({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(i,r){2&i&&a2("id",r.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],standalone:!0,features:[Fo]})}return n})(),AT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Sr({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0})}return n})(),gT=(()=>{class n extends k${_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Aa(n)))(r||n)}})();static#t=this.\u0275dir=Sr({type:n,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(i,r){2&i&&nl("mat-mdc-dialog-actions-align-start","start"===r.align)("mat-mdc-dialog-actions-align-center","center"===r.align)("mat-mdc-dialog-actions-align-end","end"===r.align)},inputs:{align:"align"},standalone:!0,features:[Fo]})}return n})();let Bxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({providers:[mx],imports:[xxe,dT,gB,Gd,Gd]})}return n})(),qxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Gd,Gd]})}return n})(),jxe=(()=>{class n{constructor(){this._listeners=[]}notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const $xe=["input"],Xxe=["formField"],Yxe=["*"];let V$=0;class G${constructor(e,t){this.source=e,this.value=t}}const q$=new Mi("MatRadioGroup"),Zxe=new Mi("mat-radio-default-options",{providedIn:"root",factory:function Jxe(){return{color:"accent"}}});let UL=(()=>{class n{get checked(){return this._checked}set checked(t){this._checked!==t&&(this._checked=t,t&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!t&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),t&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===t),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(t){this._labelPosition=t}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(t){this._setDisabled(t)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(t){this._required=t}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(t){this._color=t}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,l,d,u){this._elementRef=i,this._changeDetector=r,this._focusMonitor=s,this._radioDispatcher=o,this._providerOverride=d,this._uniqueId="mat-radio-"+ ++V$,this.id=this._uniqueId,this.disableRipple=!1,this.tabIndex=0,this.change=new xs,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=t,this._noopAnimations="NoopAnimations"===l,u&&(this.tabIndex=tu(u,0))}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((t,i)=>{t!==this.id&&i===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{!t&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new G$(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(t){t.stopPropagation()}_onInputInteraction(t){if(t.stopPropagation(),!this.checked&&!this.disabled){const i=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),i&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(t){this._onInputInteraction(t),this.disabled||this._inputElement.nativeElement.focus()}_setDisabled(t){this._disabled!==t&&(this._disabled=t,this._changeDetector.markForCheck())}_updateTabIndex(){const t=this.radioGroup;let i;if(i=t&&t.selected&&!this.disabled?t.selected===this?this.tabIndex:-1:this.tabIndex,i!==this._previousTabIndex){const r=this._inputElement?.nativeElement;r&&(r.setAttribute("tabindex",i+""),this._previousTabIndex=i)}}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(q$,8),Vt(Ws),Vt(vc),Vt(K_),Vt(jxe),Vt(Fd,8),Vt(Zxe,8),_u("tabindex"))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["mat-radio-button"]],viewQuery:function(i,r){if(1&i&&(vl($xe,5),vl(Xxe,7,Ws)),2&i){let s;ia(s=ra())&&(r._inputElement=s.first),ia(s=ra())&&(r._rippleTrigger=s.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:15,hostBindings:function(i,r){1&i&&gi("focus",function(){return r._inputElement.nativeElement.focus()}),2&i&&(ol("id",r.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),nl("mat-primary","primary"===r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("mat-mdc-radio-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",ho],tabIndex:[mi.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>null==t?0:tu(t)],checked:[mi.HasDecoratorInputTransform,"checked","checked",ho],value:"value",labelPosition:"labelPosition",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",ho],required:[mi.HasDecoratorInputTransform,"required","required",ho],color:"color"},outputs:{change:"change"},exportAs:["matRadioButton"],standalone:!0,features:[Wl,rd],ngContentSelectors:Yxe,decls:13,vars:16,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const s=Uo();vh(),en(0,"div",2,0)(2,"div",3)(3,"div",4),gi("click",function(l){return vi(s),bi(r._onTouchTargetClick(l))}),vn(),en(4,"input",5,1),gi("change",function(l){return vi(s),bi(r._onInputInteraction(l))}),vn(),en(6,"div",6),Er(7,"div",7)(8,"div",8),vn(),en(9,"div",9),Er(10,"div",10),vn()(),en(11,"label",11),eu(12),vn()()}2&i&&(Qn("labelPosition",r.labelPosition),qn(2),nl("mdc-radio--disabled",r.disabled),qn(2),Qn("id",r.inputId)("checked",r.checked)("disabled",r.disabled)("required",r.required),ol("name",r.name)("value",r.value)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby),qn(5),Qn("matRippleTrigger",r._rippleTrigger.nativeElement)("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0),qn(2),Qn("for",r.inputId))},dependencies:[O0,CF],styles:['.mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio[hidden]{display:none}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:calc((40px - 48px) / 2);right:calc((40px - 48px) / 2);left:calc((40px - 48px) / 2);width:48px;height:48px}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{border-color:CanvasText}}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{border-color:CanvasText}}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{padding:calc((var(--mdc-radio-state-layer-size) - 20px) / 2)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{top:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);left:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control{top:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);right:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);left:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display)}[dir=rtl] .mat-mdc-radio-touch-target{left:0;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0})}return n})(),ewe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Gd,DS,bI,UL,Gd]})}return n})();var twe=Ee(8314);let awe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({})}return n})(),$we=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n});static#n=this.\u0275inj=os({imports:[Gd,Gd]})}return n})(),ZC=(()=>{class n{constructor(){}ngOnInit(){}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-nav"]],decls:2,vars:0,consts:[["id","mainLogo","routerLink","/",1,"main-logo","fixed-top","p-2","mx-auto","mt-2"],["src","assets/images/logo-text.svg"]],template:function(i,r){1&i&&(en(0,"a",0),Er(1,"img",1),vn())},dependencies:[eE],styles:[".main-logo[_ngcontent-%COMP%]{width:140px;z-index:9999}.main-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:all .5s}.main-logo[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 10px var(--phoenix-text-color));transition:all .5s}"]})}return n})();function Xwe(n,e){if(1&n){const t=Uo();en(0,"input",4),gi("input",function(r){return vi(t),bi(br().onValueChange(r.target.value))}),vn()}2&n&&Qn("value",br().value)}let tX=(()=>{class n{value=0;min=0;oldMin=0;max=100;oldMax=0;step=1;allowCustomValue=!1;onChange=new xs;onValueChange(t){t&&this.onChange.emit(t)}toggleMinCut(t){t.checked?this.min=this.oldMin:(this.oldMin=this.min,this.min=Number.MIN_SAFE_INTEGER)}toggleMaxCut(t){t.checked?this.max=this.oldMax:(this.oldMax=this.max,this.max=Number.MAX_SAFE_INTEGER)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-config-slider"]],inputs:{value:"value",min:"min",max:"max",step:"step",allowCustomValue:"allowCustomValue"},outputs:{onChange:"onChange"},decls:4,vars:5,consts:[[1,"d-flex","flex-row","align-items-center"],["thumbLabel","",1,"mx-2",3,"min","max","step"],["matSliderThumb","",3,"valueChange","value"],["class","config-slider-input","type","number",3,"value","input",4,"ngIf"],["type","number",1,"config-slider-input",3,"input","value"]],template:function(i,r){1&i&&(en(0,"div",0)(1,"mat-slider",1)(2,"input",2),gi("valueChange",function(o){return r.onValueChange(o)}),vn()(),Ss(3,Xwe,1,1,"input",3),vn()),2&i&&(qn(),Qn("min",r.min)("max",r.max)("step",r.step),qn(),Qn("value",r.value),qn(),Qn("ngIf",r.allowCustomValue))},dependencies:[qh,jF,yE],styles:[".config-slider-input[_ngcontent-%COMP%]{background:transparent;color:var(--phoenix-text-color);border:none;border-bottom:1px solid var(--phoenix-text-color);width:25%;-moz-appearance:textfield}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}"]})}return n})();const Ywe=["phoenixMenuItem"],Kwe=n=>({"top.px":n}),Zwe=n=>({"font-weight-bold w-100":n}),Jwe=n=>({"p-0":n}),e2e=n=>({expanded:n});function t2e(n,e){1&n&&o2(0)}function n2e(n,e){if(1&n){const t=Uo();ng(0),en(1,"mat-slide-toggle",9),gi("change",function(r){return vi(t),bi(br().currentNode.toggleSelfAndDescendants(r.checked))}),Ss(2,t2e,1,0,"ng-container",10),vn(),ig()}if(2&n){const t=br(),i=qa(5);qn(),Qn("checked",t.currentNode.toggleState),qn(),Qn("ngTemplateOutlet",i)}}function i2e(n,e){if(1&n&&(en(0,"span",14),Ul(),en(1,"svg"),Er(2,"use"),vn()()),2&n){const t=br(2);qn(2),r2("href","assets/icons/",t.currentNode.icon,".svg#",t.currentNode.icon,"")}}function r2e(n,e){if(1&n&&(en(0,"span",11),Ss(1,i2e,3,3,"span",12),en(2,"span",13),Ji(3),vn()()),2&n){const t=br();qn(),Qn("ngIf",t.currentNode.icon),qn(),Qn("title",t.currentNode.name),qn(),rg(t.currentNode.name)}}function s2e(n,e){if(1&n){const t=Uo();en(0,"div",20),gi("click",function(){return vi(t),bi(br(2).currentNode.configActive=!1)}),vn()}}function o2e(n,e){if(1&n&&(en(0,"label",26),Ji(1),vn()),2&n){const t=br(2).$implicit;Qn("ngClass",Gh(2,Zwe,"label"===t.type)),qn(),Sl(" ",t.label," ")}}function a2e(n,e){if(1&n){const t=Uo();en(0,"mat-checkbox",9),gi("change",function(r){vi(t);const s=br(3).$implicit;return s.onChange(r.checked),bi(s.isChecked=r.checked)}),vn()}2&n&&Qn("checked",br(3).$implicit.isChecked)}function l2e(n,e){if(1&n){const t=Uo();en(0,"app-config-slider",34),gi("onChange",function(r){vi(t);const s=br(3).$implicit;return s.onChange(r),bi(s.value=r)}),vn()}if(2&n){const t=br(3).$implicit;Qn("value",t.value)("min",t.min)("max",t.max)("step",t.step)("allowCustomValue",t.allowCustomValue)}}function c2e(n,e){if(1&n){const t=Uo();en(0,"button",35),gi("click",function(){return vi(t),bi(br(3).$implicit.onClick())}),Ji(1),vn()}if(2&n){const t=br(3).$implicit;qn(),Sl(" ",t.label," ")}}function d2e(n,e){if(1&n){const t=Uo();en(0,"input",36),gi("input",function(r){vi(t);const s=br(3).$implicit;return s.onChange(r.target.value),bi(s.color=r.target.value)}),vn()}2&n&&Qn("value",br(3).$implicit.color)}function u2e(n,e){if(1&n){const t=Uo();en(0,"div",37)(1,"div",38)(2,"mat-checkbox",9),gi("change",function(r){return vi(t),bi(br(3).$implicit.setEnableMin(r.checked))}),vn(),en(3,"mat-checkbox",9),gi("change",function(r){return vi(t),bi(br(3).$implicit.setEnableMax(r.checked))}),vn()(),en(4,"div",38)(5,"input",39),gi("input",function(r){vi(t);const s=br(3).$implicit;return s.value=r.target.value,bi(s.onChange(s))}),vn(),en(6,"input",40),gi("input",function(r){vi(t);const s=br(3).$implicit;return s.highValue=r.target.value,bi(s.onChange(s))}),vn()()()}if(2&n){const t=br(3).$implicit;qn(2),Qn("checked",t.enableMin),qn(),Qn("checked",t.enableMax),qn(2),Qn("value",t.value),qn(),Qn("value",t.highValue)}}function h2e(n,e){if(1&n&&(en(0,"option",43),Ji(1),vn()),2&n){const t=e.$implicit;Qn("value",t),qn(),Sl(" ",t," ")}}function f2e(n,e){if(1&n){const t=Uo();en(0,"select",41),gi("change",function(r){return vi(t),bi(br(3).$implicit.onChange(r.target.value))}),Ss(1,h2e,2,2,"option",42),vn()}if(2&n){const t=br(3).$implicit;qn(),Qn("ngForOf",t.options)}}function p2e(n,e){if(1&n&&(en(0,"div",27),Ss(1,a2e,1,1,"mat-checkbox",28)(2,l2e,1,5,"app-config-slider",29)(3,c2e,2,1,"button",30)(4,d2e,1,1,"input",31)(5,u2e,7,4,"div",32)(6,f2e,2,1,"select",33),vn()),2&n){const t=br(2).$implicit;Qn("ngClass",Gh(7,Jwe,"button"===t.type)),qn(),Qn("ngSwitchCase","checkbox"),qn(),Qn("ngSwitchCase","slider"),qn(),Qn("ngSwitchCase","button"),qn(),Qn("ngSwitchCase","color"),qn(),Qn("ngSwitchCase","rangeSlider"),qn(),Qn("ngSwitchCase","select")}}function m2e(n,e){if(1&n&&(en(0,"div",23),Ss(1,o2e,2,4,"label",24)(2,p2e,7,9,"div",25),vn()),2&n){const t=br().$implicit;qn(),Qn("ngIf","button"!==t.type),qn(),Qn("ngIf","label"!==t.type)}}function A2e(n,e){if(1&n&&(ng(0,21),Ss(1,m2e,3,2,"div",22),ig()),2&n){const t=e.$implicit;Qn("ngSwitch",t.type),qn(),Qn("ngIf",!t.hidden)}}function g2e(n,e){if(1&n){const t=Uo();en(0,"div")(1,"button",15),gi("click",function(){vi(t);const r=br();return r.calculateConfigTop(),bi(r.currentNode.configActive=!r.currentNode.configActive)}),Ul(),en(2,"svg"),Er(3,"use",16),vn()(),Ss(4,s2e,1,0,"div",17),kh(),en(5,"div",18),Ss(6,A2e,2,2,"ng-container",19),vn()()}if(2&n){const t=br();qn(4),Qn("ngIf",t.currentNode.configActive),qn(),Qn("hidden",!t.currentNode.configActive)("ngStyle",Gh(4,Kwe,t.configTop)),qn(),Qn("ngForOf",t.castConfigsToAny(t.currentNode.configs))}}function _2e(n,e){if(1&n){const t=Uo();en(0,"button",44),gi("click",function(){vi(t);const r=br();return bi(r.currentNode.childrenActive=!r.currentNode.childrenActive)}),Ul(),en(1,"svg"),Er(2,"use",45),vn()()}if(2&n){const t=br();Qn("ngClass",Gh(1,e2e,t.currentNode.childrenActive))}}function y2e(n,e){1&n&&Er(0,"app-phoenix-menu-item",48),2&n&&Qn("currentNode",e.$implicit)}function v2e(n,e){if(1&n&&(en(0,"div",46),Ss(1,y2e,1,1,"app-phoenix-menu-item",47),vn()),2&n){const t=br();qn(),Qn("ngForOf",t.currentNode.children)}}let nX=(()=>{class n{cdr;currentNode;phoenixMenuItem;configTop;constructor(t){this.cdr=t}calculateConfigTop(){this.phoenixMenuItem&&(this.configTop=this.phoenixMenuItem.nativeElement.getBoundingClientRect().top,this.cdr.detectChanges())}castConfigsToAny(t){return t}static \u0275fac=function(i){return new(i||n)(Vt(vc))};static \u0275cmp=Qr({type:n,selectors:[["app-phoenix-menu-item"]],viewQuery:function(i,r){if(1&i&&vl(Ywe,5),2&i){let s;ia(s=ra())&&(r.phoenixMenuItem=s.first)}},inputs:{currentNode:"currentNode"},decls:10,vars:5,consts:[["phoenixMenuItem",""],["nodeName",""],[1,"phoenix-menu-item"],[1,"phoenix-menu-item-left","align-items-center"],[4,"ngIf","ngIfElse"],[1,"phoenix-menu-item-right"],[4,"ngIf"],["class","icon-wrapper icon-button btn-blank item-expand","data-testid","dropdown",3,"ngClass","click",4,"ngIf"],["class","phoenix-menu-children",4,"ngIf"],[3,"change","checked"],[4,"ngTemplateOutlet"],[1,"d-flex","w-100","align-items-center"],["class","icon-wrapper item-icon",4,"ngIf"],[1,"item-name",3,"title"],[1,"icon-wrapper","item-icon"],[1,"icon-wrapper","icon-button","btn-blank","item-settings",3,"click"],["href","assets/icons/gear.svg#gear"],["class","item-config-backdrop",3,"click",4,"ngIf"],[1,"item-config",3,"hidden","ngStyle"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"item-config-backdrop",3,"click"],[3,"ngSwitch"],["class","item-config-single",4,"ngIf"],[1,"item-config-single"],["class","item-config-label","for","item-config-field",3,"ngClass",4,"ngIf"],["class","item-config-data",3,"ngClass",4,"ngIf"],["for","item-config-field",1,"item-config-label",3,"ngClass"],[1,"item-config-data",3,"ngClass"],[3,"checked","change",4,"ngSwitchCase"],[3,"value","min","max","step","allowCustomValue","onChange",4,"ngSwitchCase"],["class","w-100","mat-button","","mat-stroked-button","",3,"click",4,"ngSwitchCase"],["id","item-config-field","type","color",3,"value","input",4,"ngSwitchCase"],["class","range-slider",4,"ngSwitchCase"],["id","item-config-field","class","w-100",3,"change",4,"ngSwitchCase"],[3,"onChange","value","min","max","step","allowCustomValue"],["mat-button","","mat-stroked-button","",1,"w-100",3,"click"],["id","item-config-field","type","color",3,"input","value"],[1,"range-slider"],[1,"range-slider-inputs","d-flex","justify-content-between"],["type","number","placeholder","Min","step","config.step",1,"form-control","form-control-sm",3,"input","value"],["type","number","placeholder","Max","step","config.step",1,"form-control","form-control-sm",3,"input","value"],["id","item-config-field",1,"w-100",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["data-testid","dropdown",1,"icon-wrapper","icon-button","btn-blank","item-expand",3,"click","ngClass"],["href","assets/icons/expand.svg#expand"],[1,"phoenix-menu-children"],[3,"currentNode",4,"ngFor","ngForOf"],[3,"currentNode"]],template:function(i,r){if(1&i&&(en(0,"div",2,0)(2,"div",3),Ss(3,n2e,3,2,"ng-container",4)(4,r2e,4,3,"ng-template",null,1,eR),vn(),en(6,"div",5),Ss(7,g2e,7,6,"div",6)(8,_2e,3,3,"button",7),vn()(),Ss(9,v2e,2,1,"div",8)),2&i){const s=qa(5);qn(3),Qn("ngIf",r.currentNode.onToggle)("ngIfElse",s),qn(4),Qn("ngIf",r.currentNode.configs.length>0),qn(),Qn("ngIf",r.currentNode.children.length>0),qn(),Qn("ngIf",r.currentNode.childrenActive)}},dependencies:[og,um,qh,p7,f7,CD,u7,G2,z2,H2,$F,ky,n,tX],styles:[".phoenix-menu-item{width:100%;padding:.6rem;background:var(--phoenix-background-color-secondary);color:var(--phoenix-text-color);font-size:.8rem;transition:all .5s;display:flex;justify-content:space-between;align-items:center}.phoenix-menu-item-left{display:flex;justify-content:flex-start;min-width:0;padding-right:.5rem;overflow:hidden}.phoenix-menu-item-left .item-name{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.phoenix-menu-item-left .item-icon{margin-right:.2rem}.phoenix-menu-item-right{display:flex;justify-content:flex-end}.phoenix-menu-item-right .item-expand.expanded{transform:scaleY(-1)}.phoenix-menu-item-right .item-settings{margin-right:.2rem}.phoenix-menu-item-right .item-config-backdrop{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:110}.phoenix-menu-item-right .item-config{position:absolute;margin-top:-5rem;right:100%;width:14rem;padding:.5rem;background:var(--phoenix-background-color-secondary);color:var(--phoenix-text-color-secondary);box-shadow:var(--phoenix-box-shadow);display:flex;flex-direction:column;z-index:120}.phoenix-menu-item-right .item-config>*{margin-bottom:.4rem}.phoenix-menu-item-right .item-config>*:last-child{margin-bottom:0}.phoenix-menu-item-right .item-config .item-config-single{display:flex;flex-direction:row}.phoenix-menu-item-right .item-config .item-config-single .item-config-label{width:30%}.phoenix-menu-item-right .item-config .item-config-single .item-config-data{flex-grow:1;padding-left:.5rem}.phoenix-menu-item .icon-wrapper{display:inline-block;width:1.3rem;height:1.3rem;padding:.23rem;transition:all .4s}.phoenix-menu-item .icon-wrapper.icon-button:hover{background:var(--phoenix-options-icon-bg);border-radius:40%;cursor:pointer}.phoenix-menu-item .icon-wrapper svg{width:100%;height:100%;vertical-align:top}.phoenix-menu-item .mat-slide-toggle-bar{width:30px!important}.phoenix-menu-item .mat-slide-toggle-thumb{width:15px!important;height:15px!important;position:absolute;top:2px}.phoenix-menu-item .mat-slider-horizontal{min-width:0;width:100%;height:20px}.phoenix-menu-item .mat-slider-horizontal .mat-slider-wrapper{top:10px}.phoenix-menu-item label.mat-checkbox-layout{margin:0}@media screen and (max-width: 768px){.phoenix-menu-item{font-size:.75rem;padding:.5rem}.phoenix-menu-item .icon-wrapper{width:1rem;height:1rem;padding:.15rem}}.phoenix-menu-children{margin-left:.5rem;border-left:1px solid var(--phoenix-accent)}.range-slider .range-slider-inputs{gap:20%}\n"],encapsulation:2})}return n})(),JC=(()=>{class n{rootNode;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-phoenix-menu"]],inputs:{rootNode:"rootNode"},decls:2,vars:1,consts:[["id","phoenixMenu"],[3,"currentNode"]],template:function(i,r){1&i&&(en(0,"div",0),Er(1,"app-phoenix-menu-item",1),vn()),2&i&&(qn(),Qn("currentNode",r.rootNode))},dependencies:[nX],styles:["[_nghost-%COMP%]{width:15rem;max-width:45%;position:absolute;top:5rem;right:1rem}#phoenixMenu[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);max-height:75vh;overflow-y:auto;box-shadow:var(--phoenix-box-shadow);z-index:100}@media screen and (max-width: 768px){#phoenixMenu[_ngcontent-%COMP%]{top:4rem}}"]})}return n})(),Tl=(()=>{class n extends kve{constructor(){super()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const b2e=n=>({disabled:n}),x2e=n=>({"active-icon":n});let $c=(()=>{class n{icon;active;tooltip;disabled=!1;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-menu-toggle"]],inputs:{icon:"icon",active:"active",tooltip:"tooltip",disabled:"disabled"},decls:3,vars:10,consts:[["matTooltipPosition","above","matTooltipTouchGestures","off",1,"menu-toggle",3,"ngClass","matTooltip"],[1,"menu-toggle-icon",3,"ngClass"]],template:function(i,r){1&i&&(en(0,"button",0),Ul(),en(1,"svg",1),Er(2,"use"),vn()()),2&i&&(Qn("ngClass",Gh(6,b2e,r.disabled))("matTooltip",r.tooltip),qn(),Qn("ngClass",Gh(8,x2e,r.active)),qn(),r2("href","assets/icons/",r.icon,".svg#",r.icon,""))},dependencies:[og,m1],styles:["[_nghost-%COMP%]{display:flex;margin:0 .6rem}[_nghost-%COMP%]   .menu-toggle[_ngcontent-%COMP%]{display:flex;background:unset;border:none;height:2.5rem;width:2.5rem;min-height:2.5rem;min-width:2.5rem;padding:.65rem;cursor:pointer;align-self:center;transition:all .4s}[_nghost-%COMP%]   .menu-toggle-icon[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .menu-toggle-icon.active-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #00bcd4}[_nghost-%COMP%]   .menu-toggle[_ngcontent-%COMP%]:hover{background-color:var(--phoenix-options-icon-bg);border-radius:40%;transition:all .4s}[_nghost-%COMP%]   .menu-toggle.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.4}"]})}return n})(),ov=(()=>{class n{eventDisplay;isAnimating=!1;constructor(t){this.eventDisplay=t}toggleAnimateEvent(){this.isAnimating||(this.isAnimating=!0,this.eventDisplay.animateEventWithCollision(1e4,()=>{this.isAnimating=!1}))}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-animate-event"]],decls:1,vars:1,consts:[["tooltip","Animate event","icon","event-folder",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleAnimateEvent()}),vn()),2&i&&Qn("active",r.isAnimating)},dependencies:[$c]})}return n})(),av=(()=>{class n{eventDisplay;autoRotate=!1;constructor(t){this.eventDisplay=t}toggleAutoRotate(){this.autoRotate=!this.autoRotate,this.eventDisplay.getUIManager().setAutoRotate(this.autoRotate)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-auto-rotate"]],decls:1,vars:1,consts:[["tooltip","Auto rotate","icon","rotate",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleAutoRotate()}),vn()),2&i&&Qn("active",r.autoRotate)},dependencies:[$c]})}return n})();const C2e=["overlayCard"],M2e=["resizeHandleCorner"],S2e=["*"],E2e=n=>({"with-body":n}),T2e=n=>({expand:n}),D2e=n=>({"transparent-bg":n});function I2e(n,e){if(1&n&&(en(0,"div",11),Ul(),en(1,"svg"),Er(2,"use"),vn()()),2&n){const t=br(2);qn(2),r2("href","assets/icons/",t.icon,".svg#",t.icon,"")}}function B2e(n,e){if(1&n){const t=Uo();en(0,"div",6),Ss(1,I2e,3,3,"div",7),en(2,"h5",8),Ji(3),vn(),en(4,"button",9),gi("click",function(){vi(t);const r=br();return bi(r.showBody=!r.showBody)}),Ul(),en(5,"svg"),Er(6,"use",10),vn()()()}if(2&n){const t=br();Qn("ngClass",Gh(4,E2e,t.showBody)),qn(),Qn("ngIf",t.icon),qn(2),rg(t.overlayTitle),qn(),Qn("ngClass",Gh(6,T2e,t.showBody))}}function P2e(n,e){if(1&n&&(en(0,"div",12),eu(1),vn()),2&n){const t=br();Qn("ngClass",Gh(1,D2e,t.transparentBody))}}function R2e(n,e){if(1&n){const t=Uo();en(0,"span",13,1),gi("cdkDragMoved",function(){return vi(t),bi(br().onResize())}),vn()}2&n&&Qn("hidden",!br().showBody)}let eM=(()=>{class n{overlayTitle;active=!1;icon;resizable=!1;transparentBody=!1;keepAspectRatioFixed=!1;showBody=!0;aspectRatio=window.innerWidth/window.innerHeight;overlayCard;resizeHandleCorner;MIN_RES_WIDTH=300;MIN_RES_HEIGHT=100;ngAfterViewInit(){if(this.resizable){const t=this.resizeHandleCorner.nativeElement;t.style.bottom="0",t.style.right="0",new jbe.ResizeSensor(this.overlayCard.nativeElement,()=>{this.resetHandlePosition()}),window.addEventListener("resize",()=>{this.resetHandlePosition()})}}onResize(){const i=this.overlayCard.nativeElement,r=this.resizeHandleCorner.nativeElement.getBoundingClientRect(),s=i.getBoundingClientRect(),o=r.left-s.left+r.width,l=r.top-s.top+r.height;this.setHandleTransform(s,r),o>this.MIN_RES_WIDTH&&l>this.MIN_RES_HEIGHT&&(i.style.width=o+"px",i.style.height=this.keepAspectRatioFixed?o/this.aspectRatio+30+"px":l+"px")}resetHandlePosition(){const t=this.resizeHandleCorner.nativeElement;this.setHandleTransform(this.overlayCard.nativeElement.getBoundingClientRect(),t.getBoundingClientRect()),t.style.bottom=null,t.style.right=null}setHandleTransform(t,i){this.resizeHandleCorner.nativeElement.style.transform=`translate3d(${t.width-i.width}px, ${t.height-i.height}px, 0)`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-overlay"]],viewQuery:function(i,r){if(1&i&&(vl(C2e,5),vl(M2e,5)),2&i){let s;ia(s=ra())&&(r.overlayCard=s.first),ia(s=ra())&&(r.resizeHandleCorner=s.first)}},inputs:{overlayTitle:"overlayTitle",active:"active",icon:"icon",resizable:"resizable",transparentBody:"transparentBody",keepAspectRatioFixed:"keepAspectRatioFixed"},ngContentSelectors:S2e,decls:5,vars:4,consts:[["overlayCard",""],["resizeHandleCorner",""],["cdkDrag","","cdkDragBoundary","body",1,"overlay-card","card",3,"hidden"],["class","card-header d-flex justify-content-between","cdkDragHandle","",3,"ngClass",4,"ngIf"],["class","overlay-card-content",3,"ngClass",4,"ngIf"],["class","resize-handle corner","cdkDrag","",3,"hidden","cdkDragMoved",4,"ngIf"],["cdkDragHandle","",1,"card-header","d-flex","justify-content-between",3,"ngClass"],["class","align-self-center card-icon",4,"ngIf"],[1,"align-self-center","m-0","px-2"],["matTooltip","Expand / Collapse","matTooltipPosition","right",1,"align-self-center","card-icon","btn-blank","expandCollapse",3,"click","ngClass"],["href","assets/icons/expand.svg#expand"],[1,"align-self-center","card-icon"],[1,"overlay-card-content",3,"ngClass"],["cdkDrag","",1,"resize-handle","corner",3,"cdkDragMoved","hidden"]],template:function(i,r){1&i&&(vh(),en(0,"div",2,0),Ss(2,B2e,7,8,"div",3)(3,P2e,2,3,"div",4)(4,R2e,2,1,"span",5),vn()),2&i&&(Qn("hidden",!r.active),qn(2),Qn("ngIf",r.overlayTitle),qn(),Qn("ngIf",r.showBody),qn(),Qn("ngIf",r.resizable))},dependencies:[og,qh,IL,b$,m1],styles:[".overlay-card.card{color:var(--phoenix-text-color);background:none;max-width:100vw;font-size:12px;min-width:300px;height:100%;max-height:70vh;box-shadow:none;border:none;position:relative;z-index:200}.overlay-card.card .card-header{width:12rem;background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);padding:.4rem .8rem;border-radius:10px;border:none;cursor:move;text-align:center;transition:all .2s}.overlay-card.card .card-header.with-body{border-bottom-left-radius:0;border-bottom-right-radius:0}.overlay-card.card .card-header .card-icon{display:flex;height:.7rem;width:.7rem}.overlay-card.card .card-header h5{font-size:.9rem}.overlay-card.card .card-header .expandCollapse{cursor:pointer;transition:all .2s}.overlay-card.card .card-header .expandCollapse.expand{transform:scaleY(-1)}.overlay-card.card .card-header .expandCollapse svg{width:100%;height:100%}.overlay-card.card .overlay-card-content{background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);border-radius:0 10px 10px;overflow:auto;height:100%}.overlay-card.card .overlay-card-content.transparent-bg{background:none}.overlay-card.card .list-group{color:var(--phoenix-text-color-secondary);background:var(--phoenix-background-color-secondary);max-height:40vh;overflow:auto}.overlay-card.card .list-group .list-group-item{background-color:var(--phoenix-background-color-secondary);border-color:var(--phoenix-border)}.overlay-card.card .resize-handle{width:1rem;height:1rem;cursor:nwse-resize;position:absolute}.overlay-card.card .resize-handle.corner{border-right:.2rem solid var(--phoenix-text-color);border-bottom:.2rem solid var(--phoenix-text-color)}\n"],encapsulation:2})}return n})();const k2e=(n,e,t)=>({"active-object":n,"is-cut":e,"d-none":t});function F2e(n,e){if(1&n&&(en(0,"option",15),Ji(1),vn()),2&n){const t=e.$implicit;Qn("value",t),qn(),Sl(" ",t," ")}}function O2e(n,e){if(1&n){const t=Uo();en(0,"mat-checkbox",16),gi("change",function(r){return vi(t),bi(br(3).toggleInvisible(r.checked))}),Ji(1," Hide Invisible Objects "),vn()}}function L2e(n,e){if(1&n){const t=Uo();en(0,"div",7)(1,"div",8)(2,"span"),Ji(3,"Choose a collection: "),vn(),en(4,"div",9)(5,"label",10),Ji(6,"Event"),vn(),en(7,"select",11),gi("change",function(r){return vi(t),bi(br(2).changeCollection(r.target.value))}),en(8,"option",12),Ji(9,"Choose Collection"),vn(),Ss(10,F2e,2,2,"option",13),vn()(),Ss(11,O2e,2,0,"mat-checkbox",14),vn()()}if(2&n){const t=br(2);qn(10),Qn("ngForOf",t.collections),qn(),Qn("ngIf",t.showingCollection)}}function N2e(n,e){if(1&n){const t=Uo();en(0,"th")(1,"div",20)(2,"div"),Ji(3),vn(),en(4,"div",21)(5,"button",22),gi("click",function(){const r=vi(t).$implicit;return bi(br(3).sort(r,"dec"))}),Ul(),en(6,"svg"),Er(7,"use",23),vn()(),kh(),en(8,"button",24),gi("click",function(){const r=vi(t).$implicit;return bi(br(3).sort(r,"asc"))}),Ul(),en(9,"svg"),Er(10,"use",23),vn()()()()()}if(2&n){const t=e.$implicit,i=br(3);qn(3),Sl(" ",i.getPrettySymbol(t)," ")}}function U2e(n,e){if(1&n){const t=Uo();en(0,"div",33)(1,"button",34),gi("click",function(){vi(t);const r=br().$implicit;return bi(br(3).lookAtObject(r.uuid))}),Ul(),en(2,"svg"),Er(3,"use",35),vn()(),kh(),en(4,"button",36),gi("click",function(){vi(t);const r=br().$implicit;return bi(br(3).highlightObject(r.uuid))}),Ul(),en(5,"svg"),Er(6,"use",37),vn()()()}}function z2e(n,e){if(1&n&&(en(0,"td"),Ji(1),vn()),2&n){const t=e.$implicit,i=br().$implicit;qn(),Sl(" ",i[t]," ")}}function H2e(n,e){if(1&n){const t=Uo();en(0,"tr",25)(1,"td"),Ji(2),vn(),en(3,"td"),Ss(4,U2e,7,0,"div",26),vn(),en(5,"td")(6,"div",27)(7,"div",28),Er(8,"input",29),vn(),en(9,"div",30)(10,"button",31),gi("click",function(){const r=vi(t),s=r.$implicit,o=r.index;return bi(br(3).addLabel(o,s.uuid))}),Ul(),en(11,"svg"),Er(12,"use",32),vn()()()()(),Ss(13,z2e,2,1,"td",18),vn()}if(2&n){const t=e.$implicit,i=e.index,r=br(3);Qn("ngClass",E8(6,k2e,r.activeObject&&r.activeObject.value===t.uuid,t.isCut,t.isCut&&r.hideInvisible)),ol("id",t.uuid),qn(2),Sl("#",i,""),qn(2),Qn("ngIf",t.uuid),qn(4),Qn("id","label"+i),qn(5),Qn("ngForOf",r.collectionColumns)}}function V2e(n,e){if(1&n&&(en(0,"table",17)(1,"thead")(2,"tr")(3,"th"),Ji(4,"No."),vn(),en(5,"th"),Ji(6,"Selection"),vn(),en(7,"th"),Ji(8,"Label"),vn(),Ss(9,N2e,11,1,"th",18),vn()(),en(10,"tbody"),Ss(11,H2e,14,10,"tr",19),vn()()),2&n){const t=br(2);qn(9),Qn("ngForOf",t.collectionColumns),qn(2),Qn("ngForOf",t.showingCollection)}}function G2e(n,e){1&n&&(en(0,"p",38),Ji(1," Load event data to be able to display information about the collections here. "),vn())}function q2e(n,e){if(1&n&&(en(0,"div",2),Ss(1,L2e,12,2,"div",3),en(2,"div",4),Ss(3,V2e,12,2,"table",5)(4,G2e,2,0,"p",6),vn()()),2&n){const t=br();qn(),Qn("ngIf",null!=t.collections),qn(2),Qn("ngIf",t.showingCollection),qn(),Qn("ngIf",!t.collections)}}let rX=(()=>{class n{elementRef;eventDisplay;showObjectsInfo;hideInvisible;collections;selectedCollection;showingCollection;collectionColumns;getPrettySymbol=Jy.getPrettySymbol;activeObject;constructor(t,i){this.elementRef=t,this.eventDisplay=i}ngOnInit(){this.eventDisplay.listenToDisplayedEventChange(t=>this.collections=this.eventDisplay.getCollections()),this.activeObject=this.eventDisplay.getActiveObjectId(),this.activeObject.onUpdate(t=>{document.getElementById(t)&&document.getElementById(t).scrollIntoView(!1)})}changeCollection(t){const i=this.getEventDataGroup();this.selectedCollection=t,this.showingCollection=this.eventDisplay.getCollection(t).map(r=>({...r,isCut:!i.getObjectByProperty("uuid",r.uuid)?.visible})),this.collectionColumns=Object.keys(this.showingCollection[0]).filter(r=>!["uuid","hits","isCut"].includes(r))}sort(t,i){this.showingCollection.sort("asc"===i?(r,s)=>r[t]<s[t]?-1:1:(r,s)=>r[t]>s[t]?-1:1)}lookAtObject(t){t&&(this.activeObject.update(t),this.eventDisplay.lookAtObject(t))}highlightObject(t){t&&(this.activeObject.update(t),this.eventDisplay.highlightObject(t))}enableHighlighting(){this.eventDisplay.enableHighlighting()}disableHighlighting(){this.eventDisplay.disableHighlighting()}toggleInvisible(t){this.hideInvisible=t}addLabel(t,i){const r=this.elementRef.nativeElement.querySelector(`#label${t}`).value;this.selectedCollection&&this.eventDisplay.addLabelToObject(r,this.selectedCollection,t,i)}getEventDataGroup(){return this.eventDisplay.getThreeManager().getSceneManager().getScene().getObjectByName(il.EVENT_DATA_ID)}static \u0275fac=function(i){return new(i||n)(Vt(Ws),Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-collections-info-overlay"]],inputs:{showObjectsInfo:"showObjectsInfo"},decls:2,vars:3,consts:[["overlayTitle","Collections Info","icon","info",3,"resizable","active"],["class","collectionsInfo m-2",4,"ngIf"],[1,"collectionsInfo","m-2"],["class","collectionSelector mb-2 d-flex align-items-center",4,"ngIf"],[1,"boxBody","table-responsive"],["id","collectionTable","class","table table-borderless table-sm",4,"ngIf"],["class","emptyBox",4,"ngIf"],[1,"collectionSelector","mb-2","d-flex","align-items-center"],[1,"d-flex","align-items-center"],[1,"eventSelector"],["for","event"],["id","collection","name","collection",3,"change"],["value","","selected","","disabled","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[3,"change",4,"ngIf"],[3,"value"],[3,"change"],["id","collectionTable",1,"table","table-borderless","table-sm"],[4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"head-wrapper"],[1,"sort-options"],[1,"icon-wrapper","icon-button","btn-blank","up",3,"click"],["href","assets/icons/expand.svg#expand"],[1,"icon-wrapper","icon-button","btn-blank",3,"click"],[3,"ngClass"],["class","row justify-content-center icon-wrapper",4,"ngIf"],[1,"row","m-0","add-label"],[1,"col-10","p-0"],["type","text",1,"form-control","form-control-sm",3,"id"],[1,"col-2","p-0","pl-2","text-center","icon-wrapper"],["matTooltip","Add, update or remove object label",1,"object-select","btn-blank",3,"click"],["href","assets/icons/update.svg#update"],[1,"row","justify-content-center","icon-wrapper"],["matTooltip","Move camera to object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/views.svg#views"],["matTooltip","Highlight object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/cursor.svg#cursor"],[1,"emptyBox"]],template:function(i,r){1&i&&(en(0,"app-overlay",0),Ss(1,q2e,5,3,"div",1),vn()),2&i&&(Qn("resizable",!0)("active",r.showObjectsInfo),qn(),Qn("ngIf",r.showObjectsInfo))},dependencies:[og,um,qh,m1,z2,H2,ky,eM],styles:[".collectionsInfo[_ngcontent-%COMP%]{height:95%}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]{height:15%;min-height:2rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);margin-right:1rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin-left:1rem}.boxBody[_ngcontent-%COMP%]{height:85%;overflow:scroll}.boxBody[_ngcontent-%COMP%]   p.emptyBox[_ngcontent-%COMP%]{max-width:21em}.boxBody[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]{min-width:8rem}.boxBody[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.1rem .3rem;font-size:.75rem}#collectionTable[_ngcontent-%COMP%]{position:relative;color:var(--phoenix-text-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:var(--phoenix-background-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]{display:flex;flex-direction:row}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;width:1rem;height:1rem;padding:.2rem}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper.up[_ngcontent-%COMP%]{transform:rotate(180deg)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{padding-right:1.2rem}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:last-child{padding-right:0}#collectionTable[_ngcontent-%COMP%]   tr.is-cut[_ngcontent-%COMP%]{opacity:.5}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]{color:var(--phoenix-background-color);background:var(--phoenix-text-color);box-shadow:0 0 15px var(--phoenix-text-color)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   div.icon-wrapper[_ngcontent-%COMP%]{--phoenix-options-icon-path: var(--phoenix-background-color);--phoenix-options-icon-bg: var(--phoenix-text-color-hover)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{--phoenix-text-color: var(--phoenix-background-color);--phoenix-background-color-tertiary: var( --phoenix-text-color-secondary );--phoenix-border: var(--phoenix-background-color)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]{position:relative;width:1.6rem;height:1.6rem;margin-right:.4em;text-align:center;background-color:var(--phoenix-options-icon-bg);border-radius:10px;cursor:pointer}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:last-child{margin-right:0}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:hover{border:1px solid var(--phoenix-options-icon-path)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:.4rem;width:100%;height:100%;vertical-align:top}.eventSelector[_ngcontent-%COMP%]{display:flex}.eventSelector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none;color:var(--phoenix-text-color-secondary)}.eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})(),gx=(()=>{class n{overlay;showObjectsInfo=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new h1(rX);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showObjectsInfo=this.showObjectsInfo}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showObjectsInfo=!this.showObjectsInfo,this.overlayWindow.instance.showObjectsInfo=this.showObjectsInfo,this.showObjectsInfo?this.overlayWindow.instance.enableHighlighting():this.overlayWindow.instance.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Vt(uu))};static \u0275cmp=Qr({type:n,selectors:[["app-collections-info"]],decls:1,vars:1,consts:[["tooltip","Event data collections info","icon","info",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleOverlay()}),vn()),2&i&&Qn("active",r.showObjectsInfo)},dependencies:[$c]})}return n})(),lv=(()=>{class n{eventDisplay;darkTheme=!1;constructor(t){this.eventDisplay=t}ngOnInit(){this.darkTheme=this.eventDisplay.getUIManager().getDarkTheme()}setDarkTheme(){this.darkTheme=!this.darkTheme,this.eventDisplay.getUIManager().setDarkTheme(this.darkTheme)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-dark-theme"]],decls:1,vars:1,consts:[["tooltip","Dark theme","icon","dark",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.setDarkTheme()}),vn()),2&i&&Qn("active",r.darkTheme)},dependencies:[$c]})}return n})();function J2e(n,e){if(1&n&&(en(0,"option",4),Ji(1),vn()),2&n){const t=e.$implicit;Qn("value",t),qn(),Sl(" ",t," ")}}function eCe(n,e){if(1&n){const t=Uo();en(0,"div",1)(1,"select",2),gi("change",function(r){return vi(t),bi(br().changeEvent(r))}),Ss(2,J2e,2,2,"option",3),vn()()}if(2&n){const t=br();qn(2),Qn("ngForOf",t.events)}}let _x=(()=>{class n{eventDisplay;events;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.listenToLoadedEventsChange(t=>this.events=t)}changeEvent(t){this.eventDisplay.loadEvent(t.target.value)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-event-selector"]],decls:1,vars:1,consts:[["class","eventSelector mx-2","matTooltip","Event selector","matTooltipPosition","above",4,"ngIf"],["matTooltip","Event selector","matTooltipPosition","above",1,"eventSelector","mx-2"],["name","event",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,r){1&i&&Ss(0,eCe,3,1,"div",0),2&i&&Qn("ngIf",null!=r.events)},dependencies:[um,qh,m1,z2,H2],styles:[".eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})();function tCe(n,e){if(1&n&&(en(0,"a",5),Er(1,"img",6),vn()),2&n){const t=br();Qn("href",t.url,ry),qn(),Qn("src",t.logo,ry)}}function nCe(n,e){if(1&n&&(en(0,"p")(1,"b"),Ji(2),vn()()),2&n){const t=br();qn(2),rg(t.tagline)}}function iCe(n,e){if(1&n&&(ng(0),en(1,"b"),Ji(2),vn(),Ji(3),ig()),2&n){const t=br().$implicit;qn(2),Sl("",t.label,": "),qn(),Sl("",t.value," ")}}function rCe(n,e){if(1&n&&(ng(0),Ji(1),ig()),2&n){const t=br().$implicit;qn(),Sl(" ",t," ")}}function sCe(n,e){if(1&n&&(en(0,"p"),Ss(1,iCe,4,2,"ng-container",3)(2,rCe,2,1,"ng-container",3),vn()),2&n){const t=e.$implicit;qn(),Qn("ngIf",t.label),qn(),Qn("ngIf",!t.label)}}let tM=(()=>{class n{eventDisplay;experimentInfo;url;logo;tagline;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.listenToDisplayedEventChange(()=>{this.experimentInfo=this.eventDisplay.getEventMetadata()})}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-experiment-info"]],inputs:{url:"url",logo:"logo",tagline:"tagline"},decls:5,vars:3,consts:[["id","experimentInfo","cdkDrag","","cdkDragBoundary","body",1,"experimentInfo"],["class","experimentLogoWrapper","target","_blank","rel","noopener noreferrer",3,"href",4,"ngIf"],[1,"textInfo"],[4,"ngIf"],[4,"ngFor","ngForOf"],["target","_blank","rel","noopener noreferrer",1,"experimentLogoWrapper",3,"href"],["alt","",1,"experimentLogo",3,"src"]],template:function(i,r){1&i&&(en(0,"div",0),Ss(1,tCe,2,2,"a",1),en(2,"div",2),Ss(3,nCe,3,1,"p",3)(4,sCe,3,2,"p",4),vn()()),2&i&&(qn(),Qn("ngIf",r.url),qn(2),Qn("ngIf",r.tagline),qn(),Qn("ngForOf",r.experimentInfo))},dependencies:[um,qh,IL],styles:[".experimentInfo[_ngcontent-%COMP%]{position:absolute;top:5rem;left:1rem;display:flex;flex-direction:row;justify-items:flex-end;justify-content:flex-end;align-items:center;align-content:center;font-family:Courier New,Lucida Console,monospace;cursor:move}.experimentLogoWrapper[_ngcontent-%COMP%]{width:6rem}.experimentLogoWrapper[_ngcontent-%COMP%]   .experimentLogo[_ngcontent-%COMP%]{width:100%;height:100%}.textInfo[_ngcontent-%COMP%]{margin-left:1rem}.textInfo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);font-size:.8rem;margin-bottom:.5rem;-webkit-user-select:none;user-select:none}@media screen and (max-width: 768px){.experimentInfo[_ngcontent-%COMP%]{top:4rem;max-width:40%}.experimentLogoWrapper[_ngcontent-%COMP%]{height:4rem}.textInfo[_ngcontent-%COMP%]{display:none}}"]})}return n})();function oCe(n,e){1&n&&(en(0,"li",2),Ji(1," No actions. "),vn())}function aCe(n,e){if(1&n&&(en(0,"li",2),Ji(1),vn()),2&n){const t=e.$implicit;qn(),Sl(" ",t," ")}}let aX=(()=>{class n{eventDisplay;showInfoPanel;actionsList=[];version="2.16.0";constructor(t){this.eventDisplay=t}ngOnInit(){this.actionsList=this.eventDisplay.getInfoLogger().getInfoLoggerList()}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-info-panel-overlay"]],inputs:{showInfoPanel:"showInfoPanel"},decls:6,vars:5,consts:[["overlayTitle","Info Panel","icon","info-panel",3,"resizable","active"],[1,"list-group","list-group-flush"],[1,"list-group-item"],["class","list-group-item",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(en(0,"app-overlay",0)(1,"ul",1)(2,"li",2),Ji(3),vn(),Ss(4,oCe,2,0,"li",3)(5,aCe,2,1,"li",4),vn()()),2&i&&(Qn("resizable",!0)("active",r.showInfoPanel),qn(3),Sl(" Phoenix Version: ",r.version," "),qn(),Qn("ngIf",0===r.actionsList.length),qn(),Qn("ngForOf",r.actionsList))},dependencies:[um,qh,eM],styles:[".list-group-item[_ngcontent-%COMP%]{font-size:.8rem;padding:.5rem 1rem}"]})}return n})(),yx=(()=>{class n{overlay;showInfoPanel=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new h1(aX);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showInfoPanel=this.showInfoPanel}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showInfoPanel=!this.showInfoPanel,this.overlayWindow.instance.showInfoPanel=this.showInfoPanel}static \u0275fac=function(i){return new(i||n)(Vt(uu))};static \u0275cmp=Qr({type:n,selectors:[["app-info-panel"]],decls:1,vars:1,consts:[["tooltip","Info panel","icon","info-panel",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleOverlay()}),vn()),2&i&&Qn("active",r.showInfoPanel)},dependencies:[$c]})}return n})();var Tp=function(n){return n.JSON="JSON",n.EDM4HEPJSON="EDM4HEPJSON",n.JIVEXML="JIVEXML",n.IG="IG",n.ZIP="ZIP",n}(Tp||{});class vx{format;fileType;handler;accept;constructor(e,t,i,r){this.format=e,this.fileType=t,this.handler=i,this.accept=r}}function lCe(n,e){if(1&n){const t=Uo();ng(0),en(1,"input",29,5),gi("change",function(r){return bi(vi(t).$implicit.handler(r.target.files))}),vn(),en(3,"button",13),gi("click",function(){return vi(t),bi(qa(2).click())}),Er(4,"img",30),Ji(5),vn(),ig()}if(2&n){const t=e.$implicit;qn(),Qn("accept",t.accept),qn(4),Sl(" Load ",t.fileType," ")}}function cCe(n,e){if(1&n&&(en(0,"div")(1,"p",10)(2,"b"),Ji(3,"Event data"),vn()(),en(4,"div",11),Ss(5,lCe,6,2,"ng-container",28),vn()()),2&n){const t=br();qn(5),Qn("ngForOf",t.eventDataOptionsWithHandler)}}let lX=(()=>{class n{eventDisplay;dialogRef;eventDataImportOptions=[Tp.JSON];eventDataOptionsWithHandler;supportedEventDataFormats=[new vx(Tp.JSON,".json",this.handleJSONEventDataInput.bind(this),"application/json"),new vx(Tp.EDM4HEPJSON,".edm4hep.json",this.handleEDM4HEPJSONEventDataInput.bind(this),"application/json"),new vx(Tp.JIVEXML,".xml",this.handleJiveXMLDataInput.bind(this),"text/xml"),new vx(Tp.ZIP,".zip",this.handleZipEventDataInput.bind(this),".zip"),new vx(Tp.IG,".ig",this.handleIgEventDataInput.bind(this),".ig")];constructor(t,i){this.eventDisplay=t,this.dialogRef=i}ngOnInit(){this.eventDataOptionsWithHandler=this.supportedEventDataFormats.filter(t=>this.eventDataImportOptions.includes(t.format)),this.eventDataImportOptions.forEach(t=>{if(t instanceof vx){const i=t.handler.bind(this);t.handler=r=>{i(r),this.onClose()},this.eventDataOptionsWithHandler.push(t)}})}getSupportedEventDataFormats(){return this.eventDataImportOptions.map(t=>t instanceof vx?t.format:t).filter(t=>"ZIP"!==t).join(", ")}onClose(){this.dialogRef.close()}handleJSONEventDataInput(t){this.handleFileInput(t[0],"json",r=>{const s="string"==typeof r?JSON.parse(r):r;this.eventDisplay.parsePhoenixEvents(s)})}handleEDM4HEPJSONEventDataInput(t){this.handleFileInput(t[0],"json",r=>{const s="string"==typeof r?JSON.parse(r):r,o=new Lve;o.setRawEventData(s),o.processEventData(),this.eventDisplay.parsePhoenixEvents(o.getEventData())})}handleJiveXMLDataInput(t){this.handleFileInput(t[0],"xml",r=>{const s=new sT;s.process(r);const o=s.getEventData();this.eventDisplay.buildEventDataFromJSON(o)})}handleOBJInput(t){this.handleFileInput(t[0],"obj",(r,s)=>{this.eventDisplay.parseOBJGeometry(r,s)})}handleSceneInput(t){this.handleFileInput(t[0],"phnx",r=>{this.eventDisplay.parsePhoenixDisplay(r)})}handleGLTFInput(t){this.handleFileInput(t[0],"gltf",(r,s)=>{this.eventDisplay.parseGLTFGeometry(r,s)})}handlePhoenixInput(t){this.handleFileInput(t[0],"phnx",r=>{this.eventDisplay.parsePhoenixDisplay(r)})}handleROOTInput(t){var i=this;return(0,ve.A)(function*(){const r=prompt("Enter object name in ROOT file");yield i.eventDisplay.loadRootGeometry(URL.createObjectURL(t[0]),r,t[0].name.split(".")[0]),i.onClose()})()}handleRootJSONInput(t){var i=this;return(0,ve.A)(function*(){if(!i.isFileOfExtension(t[0],"gz"))return;const r=t[0].name.split(".")[0];yield i.eventDisplay.loadRootJSONGeometry(URL.createObjectURL(t[0]),r),i.onClose()})()}handleIgEventDataInput(t){const i=new Ove;i.readIgArchive(t[0],r=>{const s=i.getAllEventsData(r);this.eventDisplay.parsePhoenixEvents(s),this.onClose()})}handleZipEventDataInput(t){var i=this;return(0,ve.A)(function*(){if(!i.isFileOfExtension(t[0],"zip"))return;const r={};let s;try{s=yield Rj(t[0])}catch(l){return console.error("Error while reading zip",l),void i.eventDisplay.getInfoLogger().add("Could not read zip file","Error")}Object.keys(s).filter(l=>l.endsWith(".json")).forEach(l=>{Object.assign(r,JSON.parse(s[l]))});const o=new sT;Object.keys(s).filter(l=>l.endsWith(".xml")||l.startsWith("JiveXML")).forEach(l=>{o.process(s[l]);const d=o.getEventData();Object.assign(r,{[l]:d})}),i.eventDisplay.parsePhoenixEvents(r),i.onClose()})()}handleFileInput(t,i,r){const s=new FileReader;this.isFileOfExtension(t,i)&&(s.onload=()=>{r(s.result.toString(),t.name.split(".")[0])},s.readAsText(t)),this.onClose()}isFileOfExtension(t,i){return t.name.split(".").pop()===i||(console.error("Error: Invalid file format!"),this.eventDisplay.getInfoLogger().add("Invalid file format!","Error"),!1)}saveScene(){this.eventDisplay.exportPhoenixDisplay()}exportOBJ(){this.eventDisplay.exportToOBJ()}static \u0275fac=function(i){return new(i||n)(Vt(Tl),Vt(px))};static \u0275cmp=Qr({type:n,selectors:[["app-io-options-dialog"]],inputs:{eventDataImportOptions:"eventDataImportOptions"},decls:47,vars:1,consts:[["objFileInput",""],["gltfFileInput",""],["rootFileInput",""],["rootJSONFileInput",""],["loadSceneInput",""],["eventDataFileInput",""],[1,"dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[4,"ngIf"],[1,"text-center"],[1,"row","centered"],["type","file","tabindex","-1","accept",".obj","name","image",1,"file-input",3,"change"],[1,"file-input-button",3,"click"],["src","assets/icons/obj.svg","alt",""],["type","file","tabindex","-1","accept",".gltf","name","image",1,"file-input",3,"change"],["src","assets/icons/gltf.svg","alt",""],["type","file","tabindex","-1","accept",".root",1,"file-input",3,"change"],["src","assets/icons/file-import.svg","alt",""],["type","file","tabindex","-1","accept",".json.gz",1,"file-input",3,"change"],["id","exportScene",1,"file-input-button","load-export",3,"click"],["src","assets/icons/save.svg","alt",""],["type","file","tabindex","-1","accept",".phnx","name","image",1,"file-input",3,"change"],["id","importScene",1,"file-input-button","load-export",3,"click"],["src","assets/icons/upload.svg","alt",""],["id","exportOBJ",1,"file-input-button","export-button",3,"click"],["mat-dialog-actions","","align","end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"],[4,"ngFor","ngForOf"],["type","file","tabindex","-1",1,"file-input",3,"change","accept"],["src","assets/icons/eventData.svg","alt","Event data icon"]],template:function(i,r){if(1&i){const s=Uo();en(0,"div",6)(1,"h1",7),Ji(2,"Import and export"),vn(),en(3,"div",8),Ss(4,cCe,6,1,"div",9),en(5,"p",10)(6,"b"),Ji(7,"Geometries"),vn()(),en(8,"div",11)(9,"input",12,0),gi("change",function(l){return vi(s),bi(r.handleOBJInput(l.target.files))}),vn(),en(11,"button",13),gi("click",function(){return vi(s),bi(qa(10).click())}),Er(12,"img",14),Ji(13," Load .obj "),vn(),en(14,"input",15,1),gi("change",function(l){return vi(s),bi(r.handleGLTFInput(l.target.files))}),vn(),en(16,"button",13),gi("click",function(){return vi(s),bi(qa(15).click())}),Er(17,"img",16),Ji(18," Load .gltf "),vn(),en(19,"input",17,2),gi("change",function(l){return vi(s),bi(r.handleROOTInput(l.target.files))}),vn(),en(21,"button",13),gi("click",function(){return vi(s),bi(qa(20).click())}),Er(22,"img",18),Ji(23," Load .root "),vn(),en(24,"input",19,3),gi("change",function(l){return vi(s),bi(r.handleRootJSONInput(l.target.files))}),vn(),en(26,"button",13),gi("click",function(){return vi(s),bi(qa(25).click())}),Er(27,"img",18),Ji(28," Load .json.gz "),vn()(),en(29,"p",10)(30,"b"),Ji(31,"Scene"),vn()(),en(32,"div",11)(33,"button",20),gi("click",function(){return vi(s),bi(r.saveScene())}),Er(34,"img",21),Ji(35," Save scene "),vn(),en(36,"input",22,4),gi("change",function(l){return vi(s),bi(r.handlePhoenixInput(l.target.files))}),vn(),en(38,"button",23),gi("click",function(){return vi(s),bi(qa(37).click())}),Er(39,"img",24),Ji(40," Load scene "),vn(),en(41,"button",25),gi("click",function(){return vi(s),bi(r.exportOBJ())}),Er(42,"img",14),Ji(43," Save OBJ "),vn()()(),en(44,"div",26)(45,"button",27),gi("click",function(){return vi(s),bi(r.onClose())}),Ji(46," Close "),vn()()()}2&i&&(qn(4),Qn("ngIf",r.eventDataImportOptions.length>0))},dependencies:[um,qh,mT,gT,AT,G2],styles:[".row[_ngcontent-%COMP%]{justify-content:center;margin:1rem 0}.file-input[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.file-input-button[_ngcontent-%COMP%]{font-size:1em;font-weight:700;color:#fff;background-color:#6eaece;padding:1em .5em;border:none;border-radius:10px;width:8rem;margin:0 .4rem}.file-input-button.load-export[_ngcontent-%COMP%]{padding:.8em .2em;width:7rem}.file-input-button.load-export[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:1.2em}.file-input-button.export-button[_ngcontent-%COMP%]{background-color:#cb7133}.file-input-button.export-button[_ngcontent-%COMP%]:hover{background-color:#ad5b2d}.file-input-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:2em;display:block;width:100%}.file-input-button[_ngcontent-%COMP%]:hover{background-color:#118ab2}#exportScene[_ngcontent-%COMP%]{background-color:#5bd99e}#exportScene[_ngcontent-%COMP%]:hover{background-color:#05c292}#importScene[_ngcontent-%COMP%]{background-color:#ecc25e}#importScene[_ngcontent-%COMP%]:hover{background-color:#d6b44d}"]})}return n})(),bx=(()=>{class n{dialog;eventDataImportOptions=Object.values(Tp);constructor(t){this.dialog=t}openIODialog(){this.dialog.open(lX,{panelClass:"dialog"}).componentInstance.eventDataImportOptions=this.eventDataImportOptions}static \u0275fac=function(i){return new(i||n)(Vt(mx))};static \u0275cmp=Qr({type:n,selectors:[["app-io-options"]],inputs:{eventDataImportOptions:"eventDataImportOptions"},decls:1,vars:1,consts:[["tooltip","Import and export options","icon","import",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.openIODialog()}),vn()),2&i&&Qn("active",!1)},dependencies:[$c]})}return n})(),cv=(()=>{class n{eventDisplay;orthographicView=!1;constructor(t){this.eventDisplay=t}switchMainView(){this.orthographicView=!this.orthographicView,this.eventDisplay.getUIManager().toggleOrthographicView(this.orthographicView)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-main-view-toggle"]],decls:1,vars:2,consts:[[3,"click","icon","matTooltip"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.switchMainView()}),vn()),2&i&&Qn("icon",r.orthographicView?"perspective":"orthographic")("matTooltip","Switch to "+(r.orthographicView?"perspective":"orthographic")+" view")},dependencies:[m1,$c]})}return n})(),xx=(()=>{class n{eventDisplay;clippingEnabled;startClippingAngle;openingClippingAngle;constructor(t){this.eventDisplay=t;const i=this.eventDisplay.getStateManager();i.clippingEnabled.onUpdate(r=>this.clippingEnabled=r),i.startClippingAngle.onUpdate(r=>this.startClippingAngle=r),i.openingClippingAngle.onUpdate(r=>this.openingClippingAngle=r)}changeStartClippingAngle(t){this.eventDisplay.getUIManager().rotateStartAngleClipping(t)}changeOpeningClippingAngle(t){this.eventDisplay.getUIManager().rotateOpeningAngleClipping(t)}toggleClipping(t){const i=t.checked;this.eventDisplay.getUIManager().setClipping(i),this.clippingEnabled=i}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-object-clipping"]],decls:17,vars:5,consts:[["menu",""],["clippingCheckbox",""],["startingAngleSlider",""],["openingAngleSlider",""],[1,"mat-menu"],["mat-menu-item","",3,"click"],[3,"click","change","checked"],["mat-menu-item","",1,"slider-btn",3,"focus"],["min","0","max","360","step","1","thumbLabel",""],["matSliderThumb","",3,"valueChange","value"],["tooltip","Geometry clipping","icon","clipping",3,"matMenuTriggerFor","active"]],template:function(i,r){if(1&i){const s=Uo();en(0,"mat-menu",4,0)(2,"button",5),gi("click",function(l){vi(s);const d=qa(4);return l.stopPropagation(),bi(d._inputElement.nativeElement.click())}),en(3,"mat-checkbox",6,1),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.toggleClipping(l))}),Ji(5," Clipping "),vn()(),en(6,"button",7),gi("focus",function(){return vi(s),bi(qa(9).focus())}),en(7,"mat-slider",8)(8,"input",9,2),gi("valueChange",function(l){return vi(s),bi(r.changeStartClippingAngle(l))}),vn()(),Ji(10," Start Angle "),vn(),en(11,"button",7),gi("focus",function(){return vi(s),bi(qa(14).focus())}),en(12,"mat-slider",8)(13,"input",9,3),gi("valueChange",function(l){return vi(s),bi(r.changeOpeningClippingAngle(l))}),vn()(),Ji(15," Opening Angle "),vn()(),Er(16,"app-menu-toggle",10)}if(2&i){const s=qa(1);qn(3),Qn("checked",r.clippingEnabled),qn(5),Qn("value",r.startClippingAngle),qn(5),Qn("value",r.openingClippingAngle),qn(3),Qn("matMenuTriggerFor",s)("active",r.clippingEnabled)}},dependencies:[p1,f1,XC,jF,yE,ky,$c],styles:[".slider-btn[_ngcontent-%COMP%]{overflow:visible}mat-slider[_ngcontent-%COMP%]{margin-left:.75rem;margin-right:.75rem}"]})}return n})(),cX=(()=>{class n{transform(t,i){let r="";return Array.isArray(t)?(r+="\n",t.forEach(s=>r+=s+"\n")):r=t.toString(),r}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=Vc({name:"attributePipe",type:n,pure:!0})}return n})();function dCe(n,e){if(1&n&&(en(0,"div",4)(1,"strong"),Ji(2),vn(),Ji(3),bS(4,"attributePipe"),vn()),2&n){const t=e.$implicit;qn(2),rg(t.attributeName),qn(),Sl(" : ",function R8(n,e,t){const i=n+us,r=qi(),s=Nm(r,i);return xS(r,i)?T8(r,qc(),e,s.transform,t,s):s.transform(t)}(4,2,t.attributeValue)," ")}}function uCe(n,e){if(1&n&&(en(0,"div",2),Ss(1,dCe,5,4,"div",3),vn()),2&n){const t=br();qn(),Qn("ngForOf",t.selectedObject.attributes)}}let dX=(()=>{class n{eventDisplay;hiddenSelectedInfo;selectedObject={name:"Object",attributes:[]};constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.allowSelection(this.selectedObject)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-object-selection-overlay"]],inputs:{hiddenSelectedInfo:"hiddenSelectedInfo"},decls:2,vars:3,consts:[["icon","cursor",3,"overlayTitle","active"],["id","selectedObjectPanelBody","class","m-1",4,"ngIf"],["id","selectedObjectPanelBody",1,"m-1"],["class","attributeField",4,"ngFor","ngForOf"],[1,"attributeField"]],template:function(i,r){1&i&&(en(0,"app-overlay",0),Ss(1,uCe,2,1,"div",1),vn()),2&i&&(Qn("overlayTitle",r.selectedObject.name)("active",!r.hiddenSelectedInfo),qn(),Qn("ngIf",r.selectedObject.attributes.length>0))},dependencies:[um,qh,eM,cX],styles:["#selectedObjectPanelBody[_ngcontent-%COMP%]{padding:0 .8em;overflow:auto;max-width:300px;max-height:16rem;min-width:7rem}"]})}return n})(),wx=(()=>{class n{overlay;eventDisplay;hiddenSelectedInfo=!0;overlayWindow;constructor(t,i){this.overlay=t,this.eventDisplay=i}ngOnInit(){const t=this.overlay.create(),i=new h1(dX);this.overlayWindow=t.attach(i),this.overlayWindow.instance.hiddenSelectedInfo=this.hiddenSelectedInfo}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.hiddenSelectedInfo=!this.hiddenSelectedInfo,this.overlayWindow.instance.hiddenSelectedInfo=this.hiddenSelectedInfo,this.eventDisplay.enableSelecting(!this.hiddenSelectedInfo)}static \u0275fac=function(i){return new(i||n)(Vt(uu),Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-object-selection"]],decls:1,vars:1,consts:[["tooltip","Object selection","icon","cursor",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleOverlay()}),vn()),2&i&&Qn("active",!r.hiddenSelectedInfo)},dependencies:[$c]})}return n})();const hCe=["overlayWindow"];let uX=(()=>{class n{eventDisplay;showOverlay=!0;transparentBody=!1;orthographicView=!1;overlayViewFixed=!1;overlayWindow;constructor(t){this.eventDisplay=t}ngAfterViewInit(){const t=this.initializeCanvas(this.overlayWindow.nativeElement);this.eventDisplay.setOverlayRenderer(t)}initializeCanvas(t){const i=window.innerWidth/2.5,r=window.innerHeight/2.5;return t.width=i,t.height=r,t.style.width=i.toString()+" px",t.style.height=r.toString()+" px",t}switchOverlayView(){this.orthographicView=!this.orthographicView,this.eventDisplay.getUIManager().toggleOrthographicView(this.orthographicView)}fixOverlayView(){this.overlayViewFixed=!this.overlayViewFixed,this.eventDisplay.fixOverlayView(this.overlayViewFixed)}toggleBgTransparency(){this.transparentBody=!this.transparentBody}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-overlay-view-window"]],viewQuery:function(i,r){if(1&i&&vl(hCe,5),2&i){let s;ia(s=ra())&&(r.overlayWindow=s.first)}},inputs:{showOverlay:"showOverlay"},decls:8,vars:9,consts:[["overlayWindow",""],["overlayTitle","Overlay View","icon","overlay",3,"resizable","transparentBody","active","keepAspectRatioFixed"],[1,"overlay-view-wrapper"],["id","overlay-canvas",3,"hidden"],[1,"overlay-view-controls","position-absolute","d-flex","flex-row"],["icon","transparent","matTooltip","Toggle background transparency",1,"overlay-view-control",3,"click"],["icon","move-lock",1,"overlay-view-control",3,"click","matTooltip","active"],[1,"overlay-view-control",3,"click","icon","matTooltip"]],template:function(i,r){if(1&i){const s=Uo();en(0,"app-overlay",1)(1,"div",2),Er(2,"canvas",3,0),en(4,"div",4)(5,"app-menu-toggle",5),gi("click",function(){return vi(s),bi(r.toggleBgTransparency())}),vn(),en(6,"app-menu-toggle",6),gi("click",function(){return vi(s),bi(r.fixOverlayView())}),vn(),en(7,"app-menu-toggle",7),gi("click",function(){return vi(s),bi(r.switchOverlayView())}),vn()()()()}2&i&&(Qn("resizable",!0)("transparentBody",r.transparentBody)("active",r.showOverlay)("keepAspectRatioFixed",!0),qn(2),Qn("hidden",!r.showOverlay),qn(4),Qn("matTooltip",(r.overlayViewFixed?"Restore":"Fix")+" overlay view")("active",r.overlayViewFixed),qn(),Qn("icon",r.orthographicView?"orthographic":"perspective")("matTooltip","Switch to "+(r.orthographicView?"orthographic":"perspective")+" view"))},dependencies:[m1,$c,eM],styles:["#overlay-canvas[_ngcontent-%COMP%]{background-color:#0000001a;width:100%}.overlay-view-controls[_ngcontent-%COMP%]{bottom:1em;right:1em;opacity:0;transition:opacity .2s}.overlay-view-controls[_ngcontent-%COMP%]   .overlay-view-control[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);overflow:hidden;width:2.5rem;height:2.5rem;border-radius:50%;display:flex;justify-content:center;align-items:center}.overlay-view-wrapper[_ngcontent-%COMP%]:hover   .overlay-view-controls[_ngcontent-%COMP%]{opacity:1;transition:opacity .2s}"]})}return n})(),Cx=(()=>{class n{overlay;overlayWindow;showOverlay=!1;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new h1(uX);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showOverlay=this.showOverlay}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showOverlay=!this.showOverlay,this.overlayWindow.instance.showOverlay=this.showOverlay}static \u0275fac=function(i){return new(i||n)(Vt(uu))};static \u0275cmp=Qr({type:n,selectors:[["app-overlay-view"]],decls:1,vars:1,consts:[["tooltip","Overlay view","icon","overlay",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleOverlay()}),vn()),2&i&&Qn("active",r.showOverlay)},dependencies:[$c]})}return n})(),fX=(()=>{class n{data;dialogRef;eventDisplay;cartesianPos=new Rt;originChangedSub=null;stopShiftingSub=null;showCartesianGrid;gridConfig;scale;shiftGrid;constructor(t,i,r){this.data=t,this.dialogRef=i,this.eventDisplay=r}ngOnInit(){this.shiftGrid=this.eventDisplay.getThreeManager().shiftGrid,this.showCartesianGrid=this.data.gridVisible,this.scale=this.data.scale,this.gridConfig=this.eventDisplay.getUIManager().getCartesianGridConfig(),this.cartesianPos=this.eventDisplay.getThreeManager().origin}onClose(){this.dialogRef.close()}onSave(t,i,r){this.shiftCartesianGridByValues(new Rt(10*t,10*i,10*r))}shiftCartesianGridByPointer(){this.shiftGrid=!0,this.eventDisplay.getUIManager().shiftCartesianGridByPointer(),this.originChangedSub=this.eventDisplay.getThreeManager().originChanged.subscribe(t=>{this.translateGrid(t)}),this.stopShiftingSub=this.eventDisplay.getThreeManager().stopShifting.subscribe(t=>{t&&(this.originChangedSub.unsubscribe(),this.stopShiftingSub.unsubscribe())}),this.onClose()}shiftCartesianGridByValues(t){this.translateGrid(t),this.eventDisplay.getThreeManager().originChangedEmit(t)}translateGrid(t){const i=t,r=this.cartesianPos,s=new Rt(i.x-r.x,i.y-r.y,i.z-r.z);this.eventDisplay.getUIManager().translateCartesianGrid(s.clone()),this.eventDisplay.getUIManager().translateCartesianLabels(s.clone()),this.cartesianPos=i}addXYPlanes(t){this.gridConfig.zDistance=Number(t.target.value),this.callSetShowCartesianGrid()}addYZPlanes(t){this.gridConfig.xDistance=Number(t.target.value),this.callSetShowCartesianGrid()}addZXPlanes(t){this.gridConfig.yDistance=Number(t.target.value),this.callSetShowCartesianGrid()}changeSparsity(t){this.gridConfig.sparsity=Number(t.target.value),this.callSetShowCartesianGrid()}showXYPlanes(t){this.gridConfig.showXY=t.checked,this.callSetShowCartesianGrid()}showYZPlanes(t){this.gridConfig.showYZ=t.checked,this.callSetShowCartesianGrid()}showZXPlanes(t){this.gridConfig.showZX=t.checked,this.callSetShowCartesianGrid()}callSetShowCartesianGrid(){this.eventDisplay.getUIManager().setShowCartesianGrid(this.showCartesianGrid,this.scale,this.gridConfig)}calcPlanes(t){return Math.max(0,1+2*Math.floor(10*t/(this.scale*this.gridConfig.sparsity)))}static \u0275fac=function(i){return new(i||n)(Vt(OL),Vt(px),Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-cartesian-grid-config"]],decls:65,vars:28,consts:[["xPos",""],["yPos",""],["zPos",""],["showXYPlanesCheckbox",""],["xyPlaneSlider",""],["showYZPlanesCheckbox",""],["yzPlaneSlider",""],["showZXPlanesCheckbox",""],["zxPlaneSlider",""],["sparsitySlider",""],["mat-dialog-title",""],["mat-dialog-content","",1,"container","dialog-content"],[1,"item-config-single"],[1,"item-config-group"],["for","xPos",1,"item-config-label"],["type","number","placeholder","Origin X","name","xPos","id","xPos",1,"form-control",3,"value"],["for","yPos",1,"item-config-label"],["type","number","placeholder","Origin Y","name","yPos","id","yPos",1,"form-control",3,"value"],["for","zPos",1,"item-config-label"],["type","number","placeholder","Origin Z","name","zPos","id","zPos",1,"form-control",3,"value"],["mat-stroked-button","",3,"click","disabled"],["mat-menu-item","",1,"explain-button",2,"margin","0.5rem 0",3,"click","disabled"],[1,"explain-text"],["mat-menu-item","",3,"click"],[3,"ngModelChange","click","change","ngModel"],["mat-menu-item","",1,"slider-btn",3,"focus"],["min","-300","step","300","thumbLabel","",3,"max"],["matSliderThumb","",3,"input","value"],["min","1","max","5","step","1","thumbLabel",""],["mat-dialog-actions","","align","end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(i,r){if(1&i){const s=Uo();en(0,"div")(1,"h1",10),Ji(2,"Customize Cartesian Grid"),vn(),en(3,"div",11)(4,"div",12)(5,"div",13)(6,"label",14),Ji(7,"x (cm) : "),vn(),Er(8,"input",15,0),bS(10,"number"),vn(),en(11,"div",13)(12,"label",16),Ji(13,"y (cm) : "),vn(),Er(14,"input",17,1),bS(16,"number"),vn(),en(17,"div",13)(18,"label",18),Ji(19,"z (cm) : "),vn(),Er(20,"input",19,2),bS(22,"number"),vn(),en(23,"button",20),gi("click",function(){vi(s);const l=qa(9),d=qa(15),u=qa(21);return bi(r.onSave(l.value,d.value,u.value))}),Ji(24," Save "),vn(),en(25,"button",21),gi("click",function(l){return vi(s),l.stopPropagation(),bi(r.shiftCartesianGridByPointer())}),Ji(26," Shift Cartesian Grid on click "),en(27,"p",22),Ji(28," Click on a point to shift the grid. Keep clicking at various points to continue shifting. Right click to stop. "),vn()()(),en(29,"div")(30,"button",23),gi("click",function(){return vi(s),bi(qa(32)._inputElement.nativeElement.click())}),en(31,"mat-checkbox",24,3),u2("ngModelChange",function(l){return vi(s),yS(r.gridConfig.showXY,l)||(r.gridConfig.showXY=l),bi(l)}),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.showXYPlanes(l))}),Ji(33,"Show XY Planes "),vn()(),en(34,"button",25),gi("focus",function(){return vi(s),bi(qa(37).focus())}),en(35,"mat-slider",26)(36,"input",27,4),gi("input",function(l){return vi(s),bi(r.addXYPlanes(l))}),vn()(),Ji(38),vn(),en(39,"button",23),gi("click",function(){return vi(s),bi(qa(41)._inputElement.nativeElement.click())}),en(40,"mat-checkbox",24,5),u2("ngModelChange",function(l){return vi(s),yS(r.gridConfig.showYZ,l)||(r.gridConfig.showYZ=l),bi(l)}),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.showYZPlanes(l))}),Ji(42,"Show YZ Planes "),vn()(),en(43,"button",25),gi("focus",function(){return vi(s),bi(qa(46).focus())}),en(44,"mat-slider",26)(45,"input",27,6),gi("input",function(l){return vi(s),bi(r.addYZPlanes(l))}),vn()(),Ji(47),vn(),en(48,"button",23),gi("click",function(){return vi(s),bi(qa(50)._inputElement.nativeElement.click())}),en(49,"mat-checkbox",24,7),u2("ngModelChange",function(l){return vi(s),yS(r.gridConfig.showZX,l)||(r.gridConfig.showZX=l),bi(l)}),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.showZXPlanes(l))}),Ji(51,"Show ZX Planes "),vn()(),en(52,"button",25),gi("focus",function(){return vi(s),bi(qa(55).focus())}),en(53,"mat-slider",26)(54,"input",27,8),gi("input",function(l){return vi(s),bi(r.addZXPlanes(l))}),vn()(),Ji(56),vn(),en(57,"button",25),gi("focus",function(){return vi(s),bi(qa(60).focus())}),en(58,"mat-slider",28)(59,"input",27,9),gi("input",function(l){return vi(s),bi(r.changeSparsity(l))}),vn()(),Ji(61),vn()()(),en(62,"div",29)(63,"button",30),gi("click",function(){return vi(s),bi(r.onClose())}),Ji(64," Close "),vn()()()}2&i&&(qn(8),Qn("value",J3(10,19,r.cartesianPos.x/10,"1.2-2")),qn(6),Qn("value",J3(16,22,r.cartesianPos.y/10,"1.2-2")),qn(6),Qn("value",J3(22,25,r.cartesianPos.z/10,"1.2-2")),qn(3),Qn("disabled",r.shiftGrid),qn(2),Qn("disabled",r.shiftGrid),qn(6),d2("ngModel",r.gridConfig.showXY),qn(4),Qn("max",r.scale),qn(),Qn("value",r.gridConfig.zDistance),qn(2),Sl(" XY Plane (",r.calcPlanes(r.gridConfig.zDistance),") "),qn(2),d2("ngModel",r.gridConfig.showYZ),qn(4),Qn("max",r.scale),qn(),Qn("value",r.gridConfig.xDistance),qn(2),Sl(" YZ Plane (",r.calcPlanes(r.gridConfig.xDistance),") "),qn(2),d2("ngModel",r.gridConfig.showZX),qn(4),Qn("max",r.scale),qn(),Qn("value",r.gridConfig.yDistance),qn(2),Sl(" ZX Plane (",r.calcPlanes(r.gridConfig.yDistance),") "),qn(3),Qn("value",r.gridConfig.sparsity),qn(2),Sl(" Sparsity (",r.gridConfig.sparsity,") "))},dependencies:[mT,gT,AT,G2,DF,RI,f1,jF,yE,ky,A7],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.item-config-single[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]{margin:.1rem 2rem}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]   .item-config-label[_ngcontent-%COMP%]{display:inline;margin:1rem}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:60%;display:inline}.item-config-single[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:.5rem 4rem}.item-config-single[_ngcontent-%COMP%]   .explain-button[_ngcontent-%COMP%]{padding-top:1rem}.item-config-single[_ngcontent-%COMP%]   .explain-text[_ngcontent-%COMP%]{width:20rem;opacity:.7;margin-top:.5rem;font-size:.9rem}"]})}return n})();function _Ce(n,e){if(1&n&&(Ul(),en(0,"svg",15),Er(1,"use"),vn()),2&n){const t=br().$implicit;qn(),r2("href","assets/icons/",t.icon,".svg#",t.icon,"")}}function yCe(n,e){if(1&n){const t=Uo();en(0,"button",11),gi("click",function(r){const s=vi(t).$implicit;return bi(br().displayView(r,s))}),Ss(1,_Ce,2,3,"svg",14),Ji(2),vn()}if(2&n){const t=e.$implicit;qn(),Qn("ngIf",t.icon),qn(),Sl(" ",t.name," ")}}let Mx=(()=>{class n{eventDisplay;dialog;trigger;showCartesianGrid=!1;scale=3e3;views;show3DPoints;origin=new Rt(0,0,0);sub;constructor(t,i){this.eventDisplay=t,this.dialog=i}ngOnInit(){this.views=this.eventDisplay.getUIManager().getPresetViews(),this.sub=this.eventDisplay.getThreeManager().originChanged.subscribe(t=>{this.origin=t})}openCartesianGridConfigDialog(){this.dialog.open(fX,{data:{gridVisible:this.showCartesianGrid,scale:this.scale},position:{bottom:"5rem",left:"3rem"}})}displayView(t,i){t.stopPropagation(),this.eventDisplay.getUIManager().displayView(i)}setAxis(t){const i=t.checked;this.eventDisplay.getUIManager().setShowAxis(i)}setEtaPhiGrid(t){const i=t.checked;this.eventDisplay.getUIManager().setShowEtaPhiGrid(i)}setCartesianGrid(t){this.showCartesianGrid=t.checked,this.eventDisplay.getUIManager().setShowCartesianGrid(this.showCartesianGrid,this.scale)}showLabels(t){this.eventDisplay.getUIManager().showLabels(t.checked)}show3DMousePoints(t){this.show3DPoints=t.checked,this.eventDisplay.getUIManager().show3DMousePoints(this.show3DPoints)}toggleShowDistance(t){this.trigger.closeMenu(),this.eventDisplay.getUIManager().show3DDistance(t.checked)}ngOnDestroy(){this.sub.unsubscribe()}static \u0275fac=function(i){return new(i||n)(Vt(Tl),Vt(mx))};static \u0275cmp=Qr({type:n,selectors:[["app-view-options"]],viewQuery:function(i,r){if(1&i&&vl(XC,5),2&i){let s;ia(s=ra())&&(r.trigger=s.first)}},decls:31,vars:3,consts:[["viewOptions",""],["showCartesianGridCheckbox",""],["showEtaPhiGridCheckbox",""],["showAxisCheckbox",""],["showLabelsCheckbox",""],["showMouse3DPointsCheckbox",""],["show3DDistanceCheckbox",""],["mat-menu-item",""],[3,"click","change"],[1,"icon-wrapper","icon-button","btn-blank","item-settings",3,"click"],["href","assets/icons/gear.svg#gear"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["tooltip","View options and Tools","icon","views",3,"matMenuTriggerFor","active"],["class","view-icon",4,"ngIf"],[1,"view-icon"]],template:function(i,r){if(1&i){const s=Uo();en(0,"mat-menu",null,0)(2,"button",7)(3,"mat-checkbox",8,1),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.setCartesianGrid(l))}),Ji(5,"Show Cartesian Grid "),vn(),en(6,"button",9),gi("click",function(){return vi(s),bi(r.openCartesianGridConfigDialog())}),Ul(),en(7,"svg"),Er(8,"use",10),vn()()(),kh(),en(9,"button",11),gi("click",function(l){vi(s);const d=qa(11);return l.stopPropagation(),bi(d._inputElement.nativeElement.click())}),en(10,"mat-checkbox",8,2),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.setEtaPhiGrid(l))}),Ji(12,"Show Eta Phi Grid "),vn()(),en(13,"button",11),gi("click",function(l){vi(s);const d=qa(15);return l.stopPropagation(),bi(d._inputElement.nativeElement.click())}),en(14,"mat-checkbox",8,3),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.setAxis(l))}),Ji(16,"Show Axis "),vn()(),en(17,"button",11),gi("click",function(){return vi(s),bi(qa(19)._inputElement.nativeElement.click())}),en(18,"mat-checkbox",8,4),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.showLabels(l))}),Ji(20,"Show Labels "),vn()(),en(21,"button",11),gi("click",function(l){vi(s);const d=qa(23);return l.stopPropagation(),bi(d._inputElement.nativeElement.click())}),en(22,"mat-checkbox",8,5),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.show3DMousePoints(l))}),Ji(24,"Show 3D Coordinates "),vn()(),en(25,"button",11),gi("click",function(l){vi(s);const d=qa(27);return l.stopPropagation(),bi(d._inputElement.nativeElement.click())}),en(26,"mat-checkbox",8,6),gi("click",function(l){return vi(s),bi(l.stopPropagation())})("change",function(l){return vi(s),bi(r.toggleShowDistance(l))}),Ji(28,"Show 3D Distance "),vn()(),Ss(29,yCe,3,2,"button",12),vn(),Er(30,"app-menu-toggle",13)}if(2&i){const s=qa(1);qn(29),Qn("ngForOf",r.views),qn(),Qn("matMenuTriggerFor",s)("active",!1)}},dependencies:[um,qh,p1,f1,XC,ky,$c],styles:[".view-icon[_ngcontent-%COMP%]{width:1.2rem;height:1.2rem;margin-right:.5rem}.icon-wrapper[_ngcontent-%COMP%]{display:inline-block;width:1.5rem;height:1.5rem;padding:.23rem;transition:all .4s;transform:translateY(27%)}.icon-wrapper.icon-button[_ngcontent-%COMP%]:hover{background:var(--phoenix-options-icon-bg);border-radius:40%;cursor:pointer}.icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:top}.item-settings[_ngcontent-%COMP%]{margin-right:.2rem;margin-left:.5rem}"]})}return n})(),Sx=(()=>{class n{eventDisplay;allCameras;zoomFactor=1.1;zoomTimeout;zoomTime=200;constructor(t){this.eventDisplay=t}zoomTo(t){this.zoomTime=this.zoomTime>30?Math.floor(this.zoomTime/1.1):this.zoomTime,this.eventDisplay.zoomTo(t,this.zoomTime),this.zoomTimeout=setTimeout(()=>{this.zoomTo(t)},this.zoomTime)}zoomIn(t){t&&this.zoomTo(1/this.zoomFactor)}zoomOut(t){t&&this.zoomTo(this.zoomFactor)}clearZoom(){this.zoomTime=200,clearTimeout(this.zoomTimeout)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-zoom-controls"]],decls:3,vars:2,consts:[[1,"d-flex"],["tooltip","Zoom out (hold)","icon","zoom-out",3,"click","touchstart","mousedown","mouseup","mouseleave","touchend","touchcancel","touchmove","active"],["tooltip","Zoom in (hold)","icon","zoom-in",3,"click","touchstart","mousedown","mouseup","mouseleave","touchend","touchcancel","touchmove","active"]],template:function(i,r){1&i&&(en(0,"div",0)(1,"app-menu-toggle",1),gi("click",function(){return r.zoomOut(!0),r.clearZoom()})("touchstart",function(){return r.zoomOut(!0)})("mousedown",function(o){return r.zoomOut(0===o.button)})("mouseup",function(){return r.clearZoom()})("mouseleave",function(){return r.clearZoom()})("touchend",function(){return r.clearZoom()})("touchcancel",function(){return r.clearZoom()})("touchmove",function(){return r.clearZoom()}),vn(),en(2,"app-menu-toggle",2),gi("click",function(){return r.zoomIn(!0),r.clearZoom()})("touchstart",function(){return r.zoomIn(!0)})("mousedown",function(o){return r.zoomIn(0===o.button)})("mouseup",function(){return r.clearZoom()})("mouseleave",function(){return r.clearZoom()})("touchend",function(){return r.clearZoom()})("touchcancel",function(){return r.clearZoom()})("touchmove",function(){return r.clearZoom()}),vn()()),2&i&&(qn(),Qn("active",!1),qn(),Qn("active",!1))},dependencies:[$c]})}return n})(),Ex=(()=>{class n{ssMode=!1;ngOnInit(){document.onfullscreenchange=()=>{document.fullscreenElement||this.toggleSSMode()}}toggleSSMode(){this.ssMode=!this.ssMode,document.body.classList.toggle("ss-mode"),this.ssMode?(setTimeout(()=>{document.addEventListener("click",this.onDocumentClick),document.addEventListener("touchstart",this.onDocumentClick)},1),document.documentElement.requestFullscreen?.()):(document.removeEventListener("click",this.onDocumentClick),document.removeEventListener("touchstart",this.onDocumentClick))}onDocumentClick=()=>{document.exitFullscreen?.()};static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-ss-mode"]],decls:1,vars:1,consts:[["tooltip","Screenshot mode: phoenix will become fullscreen and the menu is suppressed","icon","ss-mode",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.toggleSSMode()}),vn()),2&i&&Qn("active",r.ssMode)},dependencies:[$c],styles:["#uiMenu,#phoenixMenu,#mainLogo,#statsElement{transition:opacity .4s}.ss-mode #uiMenu,.ss-mode #phoenixMenu,.ss-mode #mainLogo,.ss-mode #statsElement{visibility:hidden;opacity:0}\n"],encapsulation:2})}return n})(),Tx=(()=>{class n{eventDisplay;performanceMode=!1;constructor(t){this.eventDisplay=t}togglePerformance(){this.performanceMode=!this.performanceMode,this.eventDisplay.getThreeManager().setAntialiasing(!this.performanceMode)}static \u0275fac=function(i){return new(i||n)(Vt(Tl))};static \u0275cmp=Qr({type:n,selectors:[["app-performance-toggle"]],decls:1,vars:1,consts:[["tooltip","Performance mode","icon","performance",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.togglePerformance()}),vn()),2&i&&Qn("active",r.performanceMode)},dependencies:[$c]})}return n})();const wCe=["*"],CCe=n=>({"ui-menu-hidden":n});let Dx=(()=>{class n{hideUIMenu=!1;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Qr({type:n,selectors:[["app-ui-menu-wrapper"]],ngContentSelectors:wCe,decls:6,vars:5,consts:[["id","uiMenu"],["id","hideUIMenu","matTooltipPosition","above",3,"click","matTooltip","ngClass"],["href","assets/icons/expand.svg#expand"],["id","optionsPanel",3,"hidden"]],template:function(i,r){1&i&&(vh(),en(0,"div",0)(1,"button",1),gi("click",function(){return r.hideUIMenu=!r.hideUIMenu}),Ul(),en(2,"svg"),Er(3,"use",2),vn()(),kh(),en(4,"div",3),eu(5),vn()()),2&i&&(qn(),Qn("matTooltip",r.hideUIMenu?"Show toolbar":"Hide toolbar")("ngClass",Gh(3,CCe,r.hideUIMenu)),qn(3),Qn("hidden",r.hideUIMenu))},dependencies:[og,m1],styles:["#uiMenu[_ngcontent-%COMP%]{position:absolute;bottom:1rem;width:100%;box-sizing:border-box;display:flex;flex-direction:column;align-items:center}#optionsPanel[_ngcontent-%COMP%]{display:flex;align-items:center;background:var(--phoenix-background-color-secondary);border:1px solid var(--phoenix-background-color-tertiary);box-shadow:var(--phoenix-box-shadow);border-radius:30px;max-width:95%;padding:.3rem 1rem;overflow-x:scroll;z-index:90}#hideUIMenu[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);height:1.2rem;width:3rem;border:1px solid var(--phoenix-border);border-bottom:none;box-shadow:var(--phoenix-box-shadow);border-top-left-radius:15px;border-top-right-radius:15px;padding:3px}#hideUIMenu[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100%;width:100%;vertical-align:top;transition:all .3s}#hideUIMenu.ui-menu-hidden[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:scaleY(-1);transition:all .3s}"]})}return n})();const MCe=["qrcodeCanvas"];let gX=(()=>{class n{dialogRef;baseLink;shareLink;embedLink;urlOptions=Object.assign({},Pve);qrcodeCanvas;constructor(t){this.dialogRef=t;const i=window.location.href,r=-1===i.lastIndexOf("?")?i.length:i.lastIndexOf("?");this.baseLink=i.slice(0,r),this.shareLink=new qC(this.baseLink),this.embedLink=this.getEmbedLink()}ngAfterViewInit(){this.updateQRCode(this.shareLink.value),this.shareLink.onUpdate(this.updateQRCode.bind(this))}onClose(){this.dialogRef.close()}getEmbedLink(t=""){return`<iframe src="${this.baseLink}?embed=true${t?"&":""}${t}"></iframe>`}setOptionValue(t,i){this.urlOptions[t]=i,this.onOptionsChange()}onOptionsChange(){const t=Object.getOwnPropertyNames(this.urlOptions).reduce((i,r)=>(this.urlOptions[r]&&i.push(`${r}=${encodeURI(this.urlOptions[r])}`),i),[]).join("&");this.shareLink.update(this.baseLink+(t?"?":"")+t),this.embedLink=this.getEmbedLink(t)}copyText(t,i){const r=document.createElement("input");document.body.appendChild(r),r.value=t,r.select(),document.execCommand("copy"),document.body.removeChild(r),i.focus(),i.innerText="COPIED",setTimeout(()=>{i.innerText="COPY"},2e3)}updateQRCode(t){twe.toCanvas(this.qrcodeCanvas.nativeElement,t)}static \u0275fac=function(i){return new(i||n)(Vt(px))};static \u0275cmp=Qr({type:n,selectors:[["app-share-link-dialog"]],viewQuery:function(i,r){if(1&i&&vl(MCe,5),2&i){let s;ia(s=ra())&&(r.qrcodeCanvas=s.first)}},decls:49,vars:5,consts:[["qrcodeCanvas",""],[1,"dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[1,"form-group","mt-2"],["for","eventDataFile"],["type","text","id","eventDataFile","placeholder","assets/files/event_data/atlaseventdump2.json",1,"form-control",3,"input","value"],[1,"form-group"],["for","eventDataType"],["id","eventDataType",1,"form-control",3,"input"],["selected","","value",""],["value","jivexml"],["value","json"],["for","configuration"],["type","text","id","configuration","placeholder","assets/files/config/phoenix-config.json",1,"form-control",3,"input","value"],[3,"change","checked"],[1,"share-box","my-2"],[1,"share-box-copy",3,"click"],[1,"qrcode","d-flex","justify-content-center"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(i,r){if(1&i){const s=Uo();en(0,"div",1)(1,"h1",2),Ji(2,"Create shareable link"),vn(),en(3,"div",3)(4,"h5"),Ji(5,"URL options"),vn(),en(6,"div",4)(7,"label",5),Ji(8,"Event data file (URL or path)"),vn(),en(9,"input",6),gi("input",function(l){return vi(s),bi(r.setOptionValue("file",l.target.value))}),vn()(),en(10,"div",7)(11,"label",8),Ji(12,"Event data type"),vn(),en(13,"select",9),gi("input",function(l){return vi(s),bi(r.setOptionValue("type",l.target.value))}),en(14,"option",10),Ji(15,"Select"),vn(),en(16,"option",11),Ji(17,"JiveXML"),vn(),en(18,"option",12),Ji(19,"JSON"),vn()()(),en(20,"div",7)(21,"label",13),Ji(22,"Configuration (URL or path)"),vn(),en(23,"input",14),gi("input",function(l){return vi(s),bi(r.setOptionValue("config",l.target.value))}),vn()(),en(24,"div",7)(25,"mat-checkbox",15),gi("change",function(l){return vi(s),bi(r.setOptionValue("hideWidgets",l.checked))}),Ji(26," Hide all widgets "),vn()(),en(27,"h5"),Ji(28,"Share"),vn(),en(29,"div",16)(30,"span"),Ji(31),vn(),en(32,"button",17),gi("click",function(l){return vi(s),bi(r.copyText(r.shareLink.value,l.target))}),Ji(33," COPY "),vn()(),en(34,"h5"),Ji(35,"Embed"),vn(),en(36,"div",16)(37,"span"),Ji(38),vn(),en(39,"button",17),gi("click",function(l){return vi(s),bi(r.copyText(r.embedLink,l.target))}),Ji(40," COPY "),vn()(),en(41,"h5"),Ji(42,"QR Code"),vn(),en(43,"div",18),Er(44,"canvas",null,0),vn()(),en(46,"div",19)(47,"button",20),gi("click",function(){return vi(s),bi(r.onClose())}),Ji(48,"Close"),vn()()()}2&i&&(qn(9),Qn("value",r.urlOptions.file),qn(14),Qn("value",r.urlOptions.config),qn(2),Qn("checked",r.urlOptions.hideWidgets),qn(6),rg(r.shareLink.value),qn(7),rg(r.embedLink))},dependencies:[mT,gT,AT,G2,z2,H2,ky],styles:[".share-box[_ngcontent-%COMP%]{width:30rem;max-width:100%;position:relative;background:var(--phoenix-background-color-tertiary);border:1px solid var(--phoenix-border);border-radius:.5rem;padding:1.25rem;word-wrap:break-word}.share-box[_ngcontent-%COMP%]   .share-box-copy[_ngcontent-%COMP%]{position:absolute;top:-1px;right:-1px;background:transparent;color:inherit;cursor:pointer;padding:.25rem .5rem;font-size:.75rem;border:1px solid var(--phoenix-border);border-radius:.5rem}.share-box[_ngcontent-%COMP%]   .share-box-copy[_ngcontent-%COMP%]:hover{background:var(--phoenix-border)}"]})}return n})(),Ix=(()=>{class n{dialog;constructor(t){this.dialog=t}openShareLinkDialog(){this.dialog.open(gX)}static \u0275fac=function(i){return new(i||n)(Vt(mx))};static \u0275cmp=Qr({type:n,selectors:[["app-share-link"]],decls:1,vars:1,consts:[["tooltip","Create shareable link","icon","share",3,"click","active"]],template:function(i,r){1&i&&(en(0,"app-menu-toggle",0),gi("click",function(){return r.openShareLinkDialog()}),vn()),2&i&&Qn("active",!1)},dependencies:[$c]})}return n})(),vX=(()=>{class n{lastEventsURL="";lastEventsOptions=!1;unzip(t){return(0,ve.A)(function*(){const i=new Bj;yield i.loadAsync(t);let r="",s=!1;for(const o in i.files){if(s){console.error("Zip archive contains more than one file. Ignoring all but first");break}r=yield i.file(o).async("string"),s=!0}return r})()}makeRequest(t,i,r,s={}){return fetch(t,s).then(o=>o[i]()).then(o=>{"blob"===i?o.arrayBuffer().then(l=>this.unzip(l)).then(l=>r(l)):r(o)}).catch(o=>(console.error(o),!0)),!1}loadJSONEvent(t,i){i.parsePhoenixEvents(JSON.parse(t))}loadJiveXMLEvent(t,i){const r=new sT;r.process(t);const s=r.getEventData();i.buildEventDataFromJSON(s)}loadEvent(t,i,r={}){this.lastEventsURL=t,this.lastEventsOptions=r;const s="zip"===t.split(".").pop(),o=s?t.substring(0,t.length-4):t;return this.makeRequest(t,s?"blob":"text",l=>{switch(o.split(".").pop()){case"xml":this.loadJiveXMLEvent(l,i);break;case"json":this.loadJSONEvent(l,i)}},r)}reloadLastEvents(t){this.lastEventsURL.length>0&&this.loadEvent(this.lastEventsURL,t,this.lastEventsOptions)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const OCe=(n,e)=>({"active-icon":n,"reload-icon":e});let nM=(()=>{class n{eventDisplay;fileLoader;interval;tooltip;icon;active=!1;reloading=!1;intervalId;events;constructor(t,i){this.eventDisplay=t,this.fileLoader=i}ngOnInit(){this.eventDisplay.listenToLoadedEventsChange(t=>{this.events=t,this.active&&(clearInterval(this.intervalId),this.startCycleInterval())})}toggleCycle(){this.reloading=this.active&&!this.reloading,this.active=!this.active||this.reloading,console.log(this.active,this.reloading),clearInterval(this.intervalId),this.active&&this.startCycleInterval()}startCycleInterval(t=0){let i=t;this.eventDisplay.loadEvent(this.events[i]),i=i+1>=this.events.length?-1:i+1,this.intervalId=setInterval(()=>{-1==i&&(this.reloading&&this.fileLoader.reloadLastEvents(this.eventDisplay),i=0),this.eventDisplay.loadEvent(this.events[i]),i=i+1>=this.events.length?-1:i+1},this.interval)}static \u0275fac=function(i){return new(i||n)(Vt(Tl),Vt(vX))};static \u0275cmp=Qr({type:n,selectors:[["app-cycle-events"]],inputs:{interval:"interval",tooltip:"tooltip",icon:"icon"},decls:3,vars:4,consts:[["matTooltip","Cycle (off/on/on+reload)","matTooltipPosition","above","matTooltipTouchGestures","off",1,"cycle-events",3,"click"],[1,"cycle-events-icon",3,"ngClass"],["href","assets/icons/cycle-events.svg#cycle-events"]],template:function(i,r){1&i&&(en(0,"button",0),gi("click",function(){return r.toggleCycle()}),Ul(),en(1,"svg",1),Er(2,"use",2),vn()()),2&i&&(qn(),Qn("ngClass",function JP(n,e,t,i,r){return D8(qi(),qc(),n,e,t,i,r)}(1,OCe,r.active,r.reloading)))},dependencies:[og,m1],styles:["[_nghost-%COMP%]{display:flex;margin:0 .6rem}[_nghost-%COMP%]   .cycle-events[_ngcontent-%COMP%]{display:flex;background:unset;border:none;height:2.5rem;width:2.5rem;min-height:2.5rem;min-width:2.5rem;padding:.65rem;cursor:pointer;align-self:center;transition:all .4s}[_nghost-%COMP%]   .cycle-events-icon[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .cycle-events-icon.active-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #00bcd4}[_nghost-%COMP%]   .cycle-events-icon.reload-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #77dd77}[_nghost-%COMP%]   .cycle-events[_ngcontent-%COMP%]:hover{background-color:var(--phoenix-options-icon-bg);border-radius:40%;transition:all .4s}[_nghost-%COMP%]   .cycle-events.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.4}"]})}return n})(),QL=(()=>{class n{error=new qC;subscribeToError(t){this.error.onUpdate(t)}setError(t){this.error.update(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ci({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const LCe=n=>({"load-complete":n}),NCe=n=>({width:n});function UCe(n,e){if(1&n&&(en(0,"div",7),Er(1,"span"),vn()),2&n){const t=br(2);qn(),function JA(n){tg(d6,QY,n,!1)}(Gh(2,NCe,t.progress+"%"))}}function zCe(n,e){if(1&n&&(ng(0),Er(1,"img",3),en(2,"p",4),Ji(3," Loading..."),Er(4,"br"),en(5,"small",5),Ji(6,"(This may take a while)"),vn()(),Ss(7,UCe,2,4,"div",6),ig()),2&n){const t=br();qn(7),Qn("ngIf",void 0!==t.progress)}}function HCe(n,e){1&n&&(en(0,"p"),Ji(1," An error occurred while loading the application. Please try refreshing the page. "),vn())}let iM=(()=>{class n{errorMessageService;loaded=!1;progress;error;constructor(t){this.errorMessageService=t,this.errorMessageService.subscribeToError(i=>{this.loaded||(this.error=i)})}static \u0275fac=function(i){return new(i||n)(Vt(QL))};static \u0275cmp=Qr({type:n,selectors:[["app-loader"]],inputs:{loaded:"loaded",progress:"progress"},decls:4,vars:5,consts:[["errorContainer",""],[1,"loader-wrapper","d-flex","position-absolute","flex-column","justify-content-center","align-items-center","w-100","h-100","p-5","text-center",3,"ngClass"],[4,"ngIf","ngIfElse"],["src","assets/images/logo-small.svg","alt","Loader"],[1,"mt-5"],[1,"text-muted"],["class","loading-bar",4,"ngIf"],[1,"loading-bar"]],template:function(i,r){if(1&i&&(en(0,"div",1),Ss(1,zCe,8,1,"ng-container",2)(2,HCe,2,0,"ng-template",null,0,eR),vn()),2&i){const s=qa(3);Qn("ngClass",Gh(3,LCe,r.loaded)),qn(),Qn("ngIf",void 0===r.error)("ngIfElse",s)}},dependencies:[og,qh],styles:[".loader-wrapper[_ngcontent-%COMP%]{background:var(--phoenix-background-color);z-index:9998}.loader-wrapper.load-complete[_ngcontent-%COMP%]{display:none!important}.loader-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5rem;height:5rem;animation:loader 2s infinite}.loader-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color)}.loader-wrapper[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]{width:15rem;max-width:90%;height:.5rem;background:var(--phoenix-background-color-tertiary);border-radius:2.5rem;overflow:hidden}.loader-wrapper[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;height:100%;border-radius:2.5rem;background:linear-gradient(to right,var(--phoenix-primary),var(--phoenix-secondary));transition:all .5s}@keyframes _ngcontent-%COMP%_app-loader_loader{0%,to{transform:scale(.1) rotate(0)}95%{transform:scale(1) rotate(15deg)}}"]})}return n})(),VCe=(()=>{class n{injector;constructor(t){this.injector=t}handleError(t){console.error("ERROR IN PHOENIX APP","\n",t),this.injector.get(QL).setError(t)}static \u0275fac=function(i){return new(i||n)(pi(sl))};static \u0275prov=ci({token:n,factory:n.\u0275fac})}return n})(),GCe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Lo({type:n});static \u0275inj=os({providers:[Tl,QL,{provide:Cl,useClass:VCe}],imports:[DS,ZD,mxe,Bxe,ihe,Wbe,dT,Bue,Fbe,ewe,Wue,hhe,xhe,qxe,awe,$we]})}return n})(),qCe=[{path:"ILD_l5_v11",component:(()=>{class n{constructor(t){this.eventDisplay=t,this.phoenixMenuRoot=new ux("Phoenix Menu","pheonix-menu"),this.loaded=!1,this.loadingProgress=0,this.eventDataImportOptions=[Tp.EDM4HEPJSON]}ngOnInit(){const t={eventDataLoader:new vA,presetViews:[new Vf("Left View",[0,0,-1200],[0,0,0],"left-cube",Tu.On,340,120),new Vf("Center View",[-500,1200,0],[0,0,0],"top-cube",Tu.On,340,120),new Vf("Global View",[1800,1800,1800],[0,0,0],"perspective",Tu.On,340,120)],defaultView:[1800,1800,1800,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/jive_xml_event_data.xml",eventType:"jivexml"}};this.eventDisplay.init(t),this.eventDisplay.loadGLTFGeometry("assets/detectors/v11_edited.gltf",void 0,void 0,1,!0),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Tl))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-ild"]],decls:23,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["experiment","ild","logo","assets/images/ild_noback.png","url","https://www.ilcild.org/","tagline","ILD Experiment"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),en(2,"app-ui-menu-wrapper"),Er(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-ss-mode")(18,"app-io-options",2)(19,"app-share-link"),vn(),Er(20,"app-experiment-info",3)(21,"app-phoenix-menu",4)(22,"div",5)),2&i&&(Qn("loaded",r.loaded)("progress",r.loadingProgress),qn(4),Qn("interval",5e3),qn(14),Qn("eventDataImportOptions",r.eventDataImportOptions),qn(3),Qn("rootNode",r.phoenixMenuRoot))},dependencies:[ZC,Dx,gx,bx,Cx,wx,_x,xx,lv,av,Mx,tM,yx,cv,Sx,JC,ov,Ex,Tx,iM,Ix,nM]})}return n})()},{path:"ILD_l5_o1_v02",component:(()=>{class n{constructor(t){this.eventDisplay=t,this.phoenixMenuRoot=new ux("Phoenix Menu","pheonix-menu"),this.loaded=!1,this.loadingProgress=0,this.eventDataImportOptions=[Tp.EDM4HEPJSON]}ngOnInit(){const i={eventDataLoader:new vA,presetViews:[new Vf("Left View",[0,0,-1200],[0,0,0],"left-cube",Tu.On,340,120),new Vf("Center View",[-500,1200,0],[0,0,0],"top-cube",Tu.On,340,120),new Vf("Global View",[1800,1800,1800],[0,0,0],"perspective",Tu.On,340,120)],defaultView:[1800,1800,1800,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/jive_xml_event_data.xml",eventType:"jivexml"}};this.eventDisplay.init(i),this.eventDisplay.loadGLTFGeometry("assets/detectors/ILD_l5_v02_final.gltf",void 0,void 0,1,!0),this.eventDisplay.getLoadingManager().addProgressListener(r=>this.loadingProgress=r),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Tl))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-ild"]],decls:23,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["experiment","ild","logo","assets/images/ild_noback.png","url","https://www.ilcild.org/","tagline","ILD Experiment"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),en(2,"app-ui-menu-wrapper"),Er(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-ss-mode")(18,"app-io-options",2)(19,"app-share-link"),vn(),Er(20,"app-experiment-info",3)(21,"app-phoenix-menu",4)(22,"div",5)),2&i&&(Qn("loaded",r.loaded)("progress",r.loadingProgress),qn(4),Qn("interval",5e3),qn(14),Qn("eventDataImportOptions",r.eventDataImportOptions),qn(3),Qn("rootNode",r.phoenixMenuRoot))},dependencies:[ZC,Dx,gx,bx,Cx,wx,_x,xx,lv,av,Mx,tM,yx,cv,Sx,JC,ov,Ex,Tx,iM,Ix,nM]})}return n})()},{path:"ILD_l5_o2_v09",component:(()=>{class n{constructor(t){this.eventDisplay=t,this.phoenixMenuRoot=new ux("Phoenix Menu","pheonix-menu"),this.loaded=!1,this.loadingProgress=0,this.eventDataImportOptions=[Tp.EDM4HEPJSON]}ngOnInit(){const t={eventDataLoader:new vA,presetViews:[new Vf("Left View",[0,0,-1200],[0,0,0],"left-cube",Tu.On,340,120),new Vf("Center View",[-500,1200,0],[0,0,0],"top-cube",Tu.On,340,120),new Vf("Global View",[1800,1800,1800],[0,0,0],"perspective",Tu.On,340,120)],defaultView:[1800,1800,1800,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/jive_xml_event_data.xml",eventType:"jivexml"}};this.eventDisplay.init(t),this.eventDisplay.loadGLTFGeometry("assets/detectors/ILD_l5_o2_v09.gltf",void 0,void 0,1,!0),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Tl))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-ild"]],decls:23,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["experiment","ild","logo","assets/images/ild_noback.png","url","https://www.ilcild.org/","tagline","ILD Experiment"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),en(2,"app-ui-menu-wrapper"),Er(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-ss-mode")(18,"app-io-options",2)(19,"app-share-link"),vn(),Er(20,"app-experiment-info",3)(21,"app-phoenix-menu",4)(22,"div",5)),2&i&&(Qn("loaded",r.loaded)("progress",r.loadingProgress),qn(4),Qn("interval",5e3),qn(14),Qn("eventDataImportOptions",r.eventDataImportOptions),qn(3),Qn("rootNode",r.phoenixMenuRoot))},dependencies:[ZC,Dx,gx,bx,Cx,wx,_x,xx,lv,av,Mx,tM,yx,cv,Sx,JC,ov,Ex,Tx,iM,Ix,nM]})}return n})()},{path:"testing",component:(()=>{class n{constructor(t){this.eventDisplay=t,this.phoenixMenuRoot=new ux("Phoenix Menu","pheonix-menu"),this.loaded=!1,this.loadingProgress=0,this.eventDataImportOptions=[Tp.EDM4HEPJSON]}ngOnInit(){const i={eventDataLoader:new vA,presetViews:[new Vf("Left View",[0,0,-1200],[0,0,0],"left-cube",Tu.On,340,120),new Vf("Center View",[-500,1200,0],[0,0,0],"top-cube",Tu.On,340,120),new Vf("Global View",[1800,1800,1800],[0,0,0],"perspective",Tu.On,340,120)],defaultView:[1800,1800,1800,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/jive_xml_event_data.xml",eventType:"jivexml"}};this.eventDisplay.init(i),this.eventDisplay.loadGLTFGeometry("assets/detectors/testing_colors.gltf",void 0,void 0,1,!0),this.eventDisplay.getLoadingManager().addProgressListener(r=>this.loadingProgress=r),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Tl))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-ild"]],decls:23,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["experiment","testing","logo","assets/images/ild_noback.png","url","https://www.ilcild.org/","tagline","ILD Experiment"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),en(2,"app-ui-menu-wrapper"),Er(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-ss-mode")(18,"app-io-options",2)(19,"app-share-link"),vn(),Er(20,"app-experiment-info",3)(21,"app-phoenix-menu",4)(22,"div",5)),2&i&&(Qn("loaded",r.loaded)("progress",r.loadingProgress),qn(4),Qn("interval",5e3),qn(14),Qn("eventDataImportOptions",r.eventDataImportOptions),qn(3),Qn("rootNode",r.phoenixMenuRoot))},dependencies:[ZC,Dx,gx,bx,Cx,wx,_x,xx,lv,av,Mx,tM,yx,cv,Sx,JC,ov,Ex,Tx,iM,Ix,nM]})}return n})()},{path:"ILD_s2_v02",component:(()=>{class n{constructor(t){this.eventDisplay=t,this.phoenixMenuRoot=new ux("Phoenix Menu","pheonix-menu"),this.loaded=!1,this.loadingProgress=0,this.eventDataImportOptions=[Tp.EDM4HEPJSON]}ngOnInit(){const t={eventDataLoader:new vA,presetViews:[new Vf("Left View",[0,0,-1200],[0,0,0],"left-cube",Tu.On,340,120),new Vf("Center View",[-500,1200,0],[0,0,0],"top-cube",Tu.On,340,120),new Vf("Global View",[1800,1800,1800],[0,0,0],"perspective",Tu.On,340,120)],defaultView:[1800,1800,1800,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/jive_xml_event_data.xml",eventType:"jivexml"}};this.eventDisplay.init(t),this.eventDisplay.loadGLTFGeometry("assets/detectors/s2_v02_edited.gltf",void 0,void 0,1,!0),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Tl))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-ild"]],decls:23,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["experiment","ild","logo","assets/images/ild_noback.png","url","https://www.ilcild.org/","tagline","ILD Experiment"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),en(2,"app-ui-menu-wrapper"),Er(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-ss-mode")(18,"app-io-options",2)(19,"app-share-link"),vn(),Er(20,"app-experiment-info",3)(21,"app-phoenix-menu",4)(22,"div",5)),2&i&&(Qn("loaded",r.loaded)("progress",r.loadingProgress),qn(4),Qn("interval",5e3),qn(14),Qn("eventDataImportOptions",r.eventDataImportOptions),qn(3),Qn("rootNode",r.phoenixMenuRoot))},dependencies:[ZC,Dx,gx,bx,Cx,wx,_x,xx,lv,av,Mx,tM,yx,cv,Sx,JC,ov,Ex,Tx,iM,Ix,nM]})}return n})()},{path:"",component:(()=>{class n{constructor(t){this.eventDisplay=t,this.year=(new Date).getFullYear(),this.eventDisplay.getThreeManager().stopAnimationLoop()}ngOnInit(){}ngAfterViewInit(){this.eventDisplay.getUIManager().detectColorScheme()}static#e=this.\u0275fac=function(i){return new(i||n)(Vt(Tl))};static#t=this.\u0275cmp=Qr({type:n,selectors:[["app-main"]],decls:32,vars:0,consts:[[1,"container"],[1,"text-center","mt-3","mb-5"],["src","assets/images/logo-text.svg","alt","Phoenix@FCC","height","50"],[2,"font-size","50px","vertical-align","middle"],["src","assets/images/ildlogo.png","alt","ILC/ILD","height","70"],[1,"lead"],[1,"card"],["src","assets/images/ild_noback.png","alt","ILD Logo",1,"ild-image"],[1,"card-body","d-flex","flex-column","text-center"],[1,"card-title"],[1,"drop_down_menu"],[1,"btn","btn-primary"],[1,"dropdown-content"],["routerLink","/ILD_l5_v11","routerLinkActive","active",1,"btn","btn-primary"],["routerLink","/ILD_l5_o1_v02","routerLinkActive","active",1,"btn","btn-primary"],["routerLink","/ILD_l5_o2_v09","routerLinkActive","active",1,"btn","btn-primary"],["routerLink","/testing","routerLinkActive","active",1,"btn","btn-primary"],["routerLink","/ILD_s2_v02","routerLinkActive","active",1,"btn","btn-primary"]],template:function(i,r){1&i&&(en(0,"div",0)(1,"div",1),Er(2,"img",2),en(3,"span",3),Ji(4," @ "),vn(),Er(5,"img",4),en(6,"p",5),Ji(7,"Visualising Events at the International Large Detector (ILD)"),vn()(),en(8,"div",6),Er(9,"img",7)(10,"br"),en(11,"div",8)(12,"h5",9),Ji(13,"The ILD based at the International Linear Collider"),vn(),en(14,"div")(15,"p"),Ji(16,"Click below to choose the version:"),vn()(),en(17,"div",10)(18,"button",11),Ji(19,"Version Type"),vn(),en(20,"div",12)(21,"a",13),Ji(22,"ILD_l5_v11"),vn(),en(23,"a",14),Ji(24,"ILD_l5_o1_v02"),vn(),en(25,"a",15),Ji(26,"ILD_l5_o2_v09"),vn(),en(27,"a",16),Ji(28,"testing"),vn(),en(29,"a",17),Ji(30,"ILD_s2_v02"),vn(),Er(31,"router-outlet"),vn()()()()())},dependencies:[WD,eE,Ez],styles:["h1[_ngcontent-%COMP%]{font-family:Circular}.logo[_ngcontent-%COMP%]{margin-top:2em;max-width:24em}.row[_ngcontent-%COMP%]{justify-content:center}.card[_ngcontent-%COMP%]{justify-content:center;margin:auto;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-box-shadow);padding:1em;width:65%;background-color:var(--phoenix-background-color-secondary);border-radius:10px;position:center;place-content:center}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}.card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-family:Circular;color:var(--phoenix-text-color)}.card[_ngcontent-%COMP%]   .card-img-top[_ngcontent-%COMP%]{width:100%;height:10em;object-fit:contain;border-radius:10px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{justify-content:space-between}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border-radius:10px}.lead[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]{background-color:var(--phoenix-background-color);margin:5rem 1rem 3rem;color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--phoenix-text-color-secondary)}.drop_down_menu[_ngcontent-%COMP%]{position:relative;display:inline-block}.dropdown-content[_ngcontent-%COMP%]{display:none;margin:auto;background-color:None;min-width:160px;z-index:1;border-radius:12px;justify-content:center}.dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;padding:12px 16px;text-decoration:none;display:block}.dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ddd}.drop_down_menu[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.drop_down_menu[_ngcontent-%COMP%]:hover   .dropbtn[_ngcontent-%COMP%]{background-color:#3e8e41}"]})}return n})()}],QCe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Lo({type:n,bootstrap:[Tae]});static#n=this.\u0275inj=os({imports:[H7,Vre,Eae,xce,GCe,ZD.forRoot(qCe)]})}return n})();Sie().bootstrapModule(QCe).catch(n=>console.error(n))},1123:(Ur,vt,Ee)=>{Ur.exports={ResizeSensor:Ee(4718),ElementQueries:Ee(7240)}},7240:function(Ur,vt,Ee){"use strict";var ve,b,z;typeof window<"u"&&window,b=[Ee(4718)],void 0!==(z="function"==typeof(ve=function(ke){var xe=function(){var Je,Xe={},ot=[];function Re(x){x||(x=document.documentElement);var v=window.getComputedStyle(x,null).fontSize;return parseFloat(v)||16}function Ie(x,v){var _=v.split(/\d/),C=_[_.length-1];switch(v=parseFloat(v),C){case"px":default:return v;case"em":return v*Re(x);case"rem":return v*Re();case"vw":return v*document.documentElement.clientWidth/100;case"vh":return v*document.documentElement.clientHeight/100;case"vmin":case"vmax":var L=document.documentElement.clientWidth/100,F=document.documentElement.clientHeight/100;return v*(0,Math["vmin"===C?"min":"max"])(L,F)}}function O(x,v){this.element=x;var _,C,L,F,U,j,te,N,m=["min-width","min-height","max-width","max-height"];this.call=function(){for(_ in L=function He(x){if(!x.getBoundingClientRect)return{width:x.offsetWidth,height:x.offsetHeight};var v=x.getBoundingClientRect();return{width:Math.round(v.width),height:Math.round(v.height)}}(this.element),j={},Xe[v])Xe[v].hasOwnProperty(_)&&(F=Ie(this.element,(C=Xe[v][_]).value),U="width"===C.property?L.width:L.height,te="","min"===C.mode&&U>=F&&(te+=C.value),"max"===C.mode&&U<=F&&(te+=C.value),j[N=C.mode+"-"+C.property]||(j[N]=""),te&&-1===(" "+j[N]+" ").indexOf(" "+te+" ")&&(j[N]+=" "+te));for(var I in m)m.hasOwnProperty(I)&&(j[m[I]]?this.element.setAttribute(m[I],j[m[I]].substr(1)):this.element.removeAttribute(m[I]))}}function ce(x,v){x.elementQueriesSetupInformation||(x.elementQueriesSetupInformation=new O(x,v)),x.elementQueriesSensor||(x.elementQueriesSensor=new ke(x,function(){x.elementQueriesSetupInformation.call()}))}function ie(x,v,_,C){if(typeof Xe[x]>"u"){Xe[x]=[];var L=ot.length;Je.innerHTML+="\n"+x+" {animation: 0.1s element-queries;}",Je.innerHTML+="\n"+x+" > .resize-sensor {min-width: "+L+"px;}",ot.push(x)}Xe[x].push({mode:v,property:_,value:C})}function he(x){var v;if(document.querySelectorAll&&(v=x?x.querySelectorAll.bind(x):document.querySelectorAll.bind(document)),!v&&typeof $$<"u"&&(v=$$),!v&&typeof jQuery<"u"&&(v=jQuery),!v)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return v}function fe(x){var v=[],_=[],C=[],L=0,F=-1,U=[];for(var j in x.children)if(x.children.hasOwnProperty(j)&&x.children[j].tagName&&"img"===x.children[j].tagName.toLowerCase()){v.push(x.children[j]);var te=x.children[j].getAttribute("min-width")||x.children[j].getAttribute("data-min-width"),N=x.children[j].getAttribute("data-src")||x.children[j].getAttribute("url");C.push(N),_.push({minWidth:te}),te?x.children[j].style.display="none":(L=v.length-1,x.children[j].style.display="block")}function I(){var R,A=!1;for(R in v)v.hasOwnProperty(R)&&_[R].minWidth&&x.offsetWidth>_[R].minWidth&&(A=R);if(A||(A=L),F!==A)if(U[A])v[F].style.display="none",v[A].style.display="block",F=A;else{var k=new Image;k.onload=function(){v[A].src=C[A],v[F].style.display="none",v[A].style.display="block",U[A]=!0,F=A},k.src=C[A]}else v[A].src=C[A]}F=L,x.resizeSensorInstance=new ke(x,I),I()}var Y=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,V=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function D(x){var v,_,C,L;for(x=x.replace(/'/g,'"');null!==(v=Y.exec(x));)for(_=v[1]+v[3],C=v[2];null!==(L=V.exec(C));)ie(_,L[1],L[2],L[3])}function w(x){var v="";if(x)if("string"==typeof x)(-1!==(x=x.toLowerCase()).indexOf("min-width")||-1!==x.indexOf("max-width"))&&D(x);else for(var _=0,C=x.length;_<C;_++)1===x[_].type?(-1!==(v=x[_].selectorText||x[_].cssText).indexOf("min-height")||-1!==v.indexOf("max-height")||-1!==v.indexOf("min-width")||-1!==v.indexOf("max-width"))&&D(v):4===x[_].type?w(x[_].cssRules||x[_].rules):3===x[_].type&&x[_].styleSheet.hasOwnProperty("cssRules")&&w(x[_].styleSheet.cssRules)}var P=!1;this.init=function(){var x="animationstart";typeof document.documentElement.style.webkitAnimationName<"u"?x="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName<"u"?x="mozanimationstart":typeof document.documentElement.style.OAnimationName<"u"&&(x="oanimationstart"),document.body.addEventListener(x,function(C){var L=C.target,F=L&&window.getComputedStyle(L,null),U=F&&F.getPropertyValue("animation-name");if(U&&-1!==U.indexOf("element-queries")){L.elementQueriesSensor=new ke(L,function(){L.elementQueriesSetupInformation&&L.elementQueriesSetupInformation.call()});var N=window.getComputedStyle(L.resizeSensor,null).getPropertyValue("min-width");N=parseInt(N.replace("px","")),ce(C.target,ot[N])}}),P||((Je=document.createElement("style")).type="text/css",Je.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",Je.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(Je),P=!0);for(var v=0,_=document.styleSheets.length;v<_;v++)try{document.styleSheets[v].href&&0===document.styleSheets[v].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[v].href),w(document.styleSheets[v].cssRules||document.styleSheets[v].rules||document.styleSheets[v].cssText)}catch{}!function le(){for(var v=he()("[data-responsive-image],[responsive-image]"),_=0,C=v.length;_<C;_++)fe(v[_])}()},this.findElementQueriesElements=function(x){!function ue(x){var v=he(x);for(var _ in Xe)if(Xe.hasOwnProperty(_))for(var C=v(_,x),L=0,F=C.length;L<F;L++)ce(C[L],_)}(x)},this.update=function(){this.init()}};xe.update=function(){xe.instance.update()},xe.detach=function(Je){Je.elementQueriesSetupInformation?(Je.elementQueriesSensor.detach(),delete Je.elementQueriesSetupInformation,delete Je.elementQueriesSensor):Je.resizeSensorInstance&&(Je.resizeSensorInstance.detach(),delete Je.resizeSensorInstance)},xe.init=function(){xe.instance||(xe.instance=new xe),xe.instance.init()};return xe.findElementQueriesElements=function(Je){xe.instance.findElementQueriesElements(Je)},xe.listen=function(){!function(Je){if(document.addEventListener)document.addEventListener("DOMContentLoaded",Je,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var Xe=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(Je(),clearInterval(Xe))},10);else window.onload=Je}(xe.init)},xe})?ve.apply(vt,b):ve)&&(Ur.exports=z)},4718:function(Ur,vt,Ee){"use strict";var ve,b;typeof window<"u"&&window,void 0!==(b="function"==typeof(ve=function(){if(typeof window>"u")return null;var z=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")(),ke=z.requestAnimationFrame||z.mozRequestAnimationFrame||z.webkitRequestAnimationFrame||function(He){return z.setTimeout(He,20)},xe=z.cancelAnimationFrame||z.mozCancelAnimationFrame||z.webkitCancelAnimationFrame||function(He){z.clearTimeout(He)};function et(He,Ie){var O=Object.prototype.toString.call(He),ce="[object Array]"===O||"[object NodeList]"===O||"[object HTMLCollection]"===O||"[object Object]"===O||typeof jQuery<"u"&&He instanceof jQuery||typeof Elements<"u"&&He instanceof Elements,ie=0,he=He.length;if(ce)for(;ie<he;ie++)Ie(He[ie]);else Ie(He)}function Je(He){if(!He.getBoundingClientRect)return{width:He.offsetWidth,height:He.offsetHeight};var Ie=He.getBoundingClientRect();return{width:Math.round(Ie.width),height:Math.round(Ie.height)}}function Xe(He,Ie){Object.keys(Ie).forEach(function(O){He.style[O]=Ie[O]})}var ot=function(He,Ie){var O=0;function ce(){var ue,fe,he=[];this.add=function(le){he.push(le)},this.call=function(le){for(ue=0,fe=he.length;ue<fe;ue++)he[ue].call(this,le)},this.remove=function(le){var Y=[];for(ue=0,fe=he.length;ue<fe;ue++)he[ue]!==le&&Y.push(he[ue]);he=Y},this.length=function(){return he.length}}function ie(he,ue){if(he){if(he.resizedAttached)return void he.resizedAttached.add(ue);he.resizedAttached=new ce,he.resizedAttached.add(ue),he.resizeSensor=document.createElement("div"),he.resizeSensor.dir="ltr",he.resizeSensor.className="resize-sensor";var fe={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},le={position:"absolute",left:"0px",top:"0px",transition:"0s"};Xe(he.resizeSensor,fe);var Y=document.createElement("div");Y.className="resize-sensor-expand",Xe(Y,fe);var V=document.createElement("div");Xe(V,le),Y.appendChild(V);var D=document.createElement("div");D.className="resize-sensor-shrink",Xe(D,fe);var w=document.createElement("div");Xe(w,le),Xe(w,{width:"200%",height:"200%"}),D.appendChild(w),he.resizeSensor.appendChild(Y),he.resizeSensor.appendChild(D),he.appendChild(he.resizeSensor);var P=window.getComputedStyle(he),x=P?P.getPropertyValue("position"):null;"absolute"!==x&&"relative"!==x&&"fixed"!==x&&"sticky"!==x&&(he.style.position="relative");var v=!1,_=0,C=Je(he),L=0,F=0,U=!0;O=0;var te=function(){if(U){if(0===he.offsetWidth&&0===he.offsetHeight)return void(O||(O=ke(function(){O=0,te()})));U=!1}var A,R;R=he.offsetHeight,V.style.width=(A=he.offsetWidth)+10+"px",V.style.height=R+10+"px",Y.scrollLeft=A+10,Y.scrollTop=R+10,D.scrollLeft=A+10,D.scrollTop=R+10};he.resizeSensor.resetSensor=te;var N=function(){_=0,v&&(L=C.width,F=C.height,he.resizedAttached&&he.resizedAttached.call(C))},m=function(){C=Je(he),(v=C.width!==L||C.height!==F)&&!_&&(_=ke(N)),te()},I=function(A,R,k){A.attachEvent?A.attachEvent("on"+R,k):A.addEventListener(R,k)};I(Y,"scroll",m),I(D,"scroll",m),O=ke(function(){O=0,te()})}}et(He,function(he){ie(he,Ie)}),this.detach=function(he){O||(xe(O),O=0),ot.detach(He,he)},this.reset=function(){He.resizeSensor.resetSensor()}};if(ot.reset=function(He){et(He,function(Ie){Ie.resizeSensor.resetSensor()})},ot.detach=function(He,Ie){et(He,function(O){O&&(O.resizedAttached&&"function"==typeof Ie&&(O.resizedAttached.remove(Ie),O.resizedAttached.length())||O.resizeSensor&&(O.contains(O.resizeSensor)&&O.removeChild(O.resizeSensor),delete O.resizeSensor,delete O.resizedAttached))})},typeof MutationObserver<"u"){var Re=new MutationObserver(function(He){for(var Ie in He)if(He.hasOwnProperty(Ie))for(var O=He[Ie].addedNodes,ce=0;ce<O.length;ce++)O[ce].resizeSensor&&ot.reset(O[ce])});document.addEventListener("DOMContentLoaded",function(He){Re.observe(document.body,{childList:!0,subtree:!0})})}return ot})?ve.call(vt,Ee,vt,Ur):ve)&&(Ur.exports=b)},243:Ur=>{"use strict";var vt={single_source_shortest_paths:function(Ee,ve,b){var z={},ke={};ke[ve]=0;var et,Je,Xe,ot,Re,Ie,xe=vt.PriorityQueue.make();for(xe.push(ve,0);!xe.empty();)for(Xe in ot=(et=xe.pop()).cost,Re=Ee[Je=et.value]||{})Re.hasOwnProperty(Xe)&&(Ie=ot+Re[Xe],(typeof ke[Xe]>"u"||ke[Xe]>Ie)&&(ke[Xe]=Ie,xe.push(Xe,Ie),z[Xe]=Je));if(typeof b<"u"&&typeof ke[b]>"u"){var ie=["Could not find a path from ",ve," to ",b,"."].join("");throw new Error(ie)}return z},extract_shortest_path_from_predecessor_list:function(Ee,ve){for(var b=[],z=ve;z;)b.push(z),z=Ee[z];return b.reverse(),b},find_path:function(Ee,ve,b){var z=vt.single_source_shortest_paths(Ee,ve,b);return vt.extract_shortest_path_from_predecessor_list(z,b)},PriorityQueue:{make:function(Ee){var z,ve=vt.PriorityQueue,b={};for(z in Ee=Ee||{},ve)ve.hasOwnProperty(z)&&(b[z]=ve[z]);return b.queue=[],b.sorter=Ee.sorter||ve.default_sorter,b},default_sorter:function(Ee,ve){return Ee.cost-ve.cost},push:function(Ee,ve){this.queue.push({value:Ee,cost:ve}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Ur.exports=vt},3174:Ur=>{"use strict";Ur.exports=function(Ee){for(var ve=[],b=Ee.length,z=0;z<b;z++){var ke=Ee.charCodeAt(z);if(ke>=55296&&ke<=56319&&b>z+1){var xe=Ee.charCodeAt(z+1);xe>=56320&&xe<=57343&&(ke=1024*(ke-55296)+xe-56320+65536,z+=1)}ke<128?ve.push(ke):ke<2048?(ve.push(ke>>6|192),ve.push(63&ke|128)):ke<55296||ke>=57344&&ke<65536?(ve.push(ke>>12|224),ve.push(ke>>6&63|128),ve.push(63&ke|128)):ke>=65536&&ke<=1114111?(ve.push(ke>>18|240),ve.push(ke>>12&63|128),ve.push(ke>>6&63|128),ve.push(63&ke|128)):ve.push(239,191,189)}return new Uint8Array(ve).buffer}},7239:function(Ur){Ur.exports=function(){"use strict";var vt=function(ee,X){return(vt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ae,oe){ae.__proto__=oe}||function(ae,oe){for(var Ve in oe)Object.prototype.hasOwnProperty.call(oe,Ve)&&(ae[Ve]=oe[Ve])})(ee,X)};function Ee(ee,X){if("function"!=typeof X&&null!==X)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");function ae(){this.constructor=ee}vt(ee,X),ee.prototype=null===X?Object.create(X):(ae.prototype=X.prototype,new ae)}var ve=function(){return ve=Object.assign||function(X){for(var ae,oe=1,Ve=arguments.length;oe<Ve;oe++)for(var ft in ae=arguments[oe])Object.prototype.hasOwnProperty.call(ae,ft)&&(X[ft]=ae[ft]);return X},ve.apply(this,arguments)};function b(ee,X,ae,oe){return new(ae||(ae=Promise))(function(ft,kt){function an(ni){try{Yn(oe.next(ni))}catch(ii){kt(ii)}}function sn(ni){try{Yn(oe.throw(ni))}catch(ii){kt(ii)}}function Yn(ni){ni.done?ft(ni.value):function Ve(ft){return ft instanceof ae?ft:new ae(function(kt){kt(ft)})}(ni.value).then(an,sn)}Yn((oe=oe.apply(ee,X||[])).next())})}function z(ee,X){var oe,Ve,ft,kt,ae={label:0,sent:function(){if(1&ft[0])throw ft[1];return ft[1]},trys:[],ops:[]};return kt={next:an(0),throw:an(1),return:an(2)},"function"==typeof Symbol&&(kt[Symbol.iterator]=function(){return this}),kt;function an(Yn){return function(ni){return function sn(Yn){if(oe)throw new TypeError("Generator is already executing.");for(;ae;)try{if(oe=1,Ve&&(ft=2&Yn[0]?Ve.return:Yn[0]?Ve.throw||((ft=Ve.return)&&ft.call(Ve),0):Ve.next)&&!(ft=ft.call(Ve,Yn[1])).done)return ft;switch(Ve=0,ft&&(Yn=[2&Yn[0],ft.value]),Yn[0]){case 0:case 1:ft=Yn;break;case 4:return ae.label++,{value:Yn[1],done:!1};case 5:ae.label++,Ve=Yn[1],Yn=[0];continue;case 7:Yn=ae.ops.pop(),ae.trys.pop();continue;default:if(!(ft=(ft=ae.trys).length>0&&ft[ft.length-1])&&(6===Yn[0]||2===Yn[0])){ae=0;continue}if(3===Yn[0]&&(!ft||Yn[1]>ft[0]&&Yn[1]<ft[3])){ae.label=Yn[1];break}if(6===Yn[0]&&ae.label<ft[1]){ae.label=ft[1],ft=Yn;break}if(ft&&ae.label<ft[2]){ae.label=ft[2],ae.ops.push(Yn);break}ft[2]&&ae.ops.pop(),ae.trys.pop();continue}Yn=X.call(ee,ae)}catch(ni){Yn=[6,ni],Ve=0}finally{oe=ft=0}if(5&Yn[0])throw Yn[1];return{value:Yn[0]?Yn[1]:void 0,done:!0}}([Yn,ni])}}}function ke(ee,X,ae){if(ae||2===arguments.length)for(var ft,oe=0,Ve=X.length;oe<Ve;oe++)(ft||!(oe in X))&&(ft||(ft=Array.prototype.slice.call(X,0,oe)),ft[oe]=X[oe]);return ee.concat(ft||X)}for(var xe=function(){function ee(X,ae,oe,Ve){this.left=X,this.top=ae,this.width=oe,this.height=Ve}return ee.prototype.add=function(X,ae,oe,Ve){return new ee(this.left+X,this.top+ae,this.width+oe,this.height+Ve)},ee.fromClientRect=function(X,ae){return new ee(ae.left+X.windowBounds.left,ae.top+X.windowBounds.top,ae.width,ae.height)},ee.fromDOMRectList=function(X,ae){var oe=Array.from(ae).find(function(Ve){return 0!==Ve.width});return oe?new ee(oe.left+X.windowBounds.left,oe.top+X.windowBounds.top,oe.width,oe.height):ee.EMPTY},ee.EMPTY=new ee(0,0,0,0),ee}(),et=function(ee,X){return xe.fromClientRect(ee,X.getBoundingClientRect())},Xe=function(ee){for(var X=[],ae=0,oe=ee.length;ae<oe;){var Ve=ee.charCodeAt(ae++);if(Ve>=55296&&Ve<=56319&&ae<oe){var ft=ee.charCodeAt(ae++);56320==(64512&ft)?X.push(((1023&Ve)<<10)+(1023&ft)+65536):(X.push(Ve),ae--)}else X.push(Ve)}return X},ot=function(){for(var ee=[],X=0;X<arguments.length;X++)ee[X]=arguments[X];if(String.fromCodePoint)return String.fromCodePoint.apply(String,ee);var ae=ee.length;if(!ae)return"";for(var oe=[],Ve=-1,ft="";++Ve<ae;){var kt=ee[Ve];kt<=65535?oe.push(kt):oe.push(55296+((kt-=65536)>>10),kt%1024+56320),(Ve+1===ae||oe.length>16384)&&(ft+=String.fromCharCode.apply(String,oe),oe.length=0)}return ft},Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",He=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ie=0;Ie<64;Ie++)He[Re.charCodeAt(Ie)]=Ie;for(var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ce=typeof Uint8Array>"u"?[]:new Uint8Array(256),ie=0;ie<64;ie++)ce[O.charCodeAt(ie)]=ie;for(var N=function(ee,X,ae){return ee.slice?ee.slice(X,ae):new Uint16Array(Array.prototype.slice.call(ee,X,ae))},A=function(){function ee(X,ae,oe,Ve,ft,kt){this.initialValue=X,this.errorValue=ae,this.highStart=oe,this.highValueIndex=Ve,this.index=ft,this.data=kt}return ee.prototype.get=function(X){var ae;if(X>=0){if(X<55296||X>56319&&X<=65535)return this.data[ae=((ae=this.index[X>>5])<<2)+(31&X)];if(X<=65535)return this.data[ae=((ae=this.index[2048+(X-55296>>5)])<<2)+(31&X)];if(X<this.highStart)return ae=this.index[ae=2080+(X>>11)],this.data[ae=((ae=this.index[ae+=X>>5&63])<<2)+(31&X)];if(X<=1114111)return this.data[this.highValueIndex]}return this.errorValue},ee}(),R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=typeof Uint8Array>"u"?[]:new Uint8Array(256),J=0;J<64;J++)k[R.charCodeAt(J)]=J;var ae,oe,Ve,kt,an,Oe=10,ht=13,yt=15,Ot=17,It=18,An=19,on=20,pn=21,Qt=22,dn=24,yn=25,Tn=26,Hn=27,ti=28,ai=30,Or=32,Tr=33,ys=34,ds=35,W=37,pe=38,me=39,Fe=40,Et=42,xt=[9001,65288],jt="\xd7",ln=(ae=function(ee){var oe,ft,kt,an,sn,X=.75*ee.length,ae=ee.length,Ve=0;"="===ee[ee.length-1]&&(X--,"="===ee[ee.length-2]&&X--);var Yn=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(X):new Array(X),ni=Array.isArray(Yn)?Yn:new Uint8Array(Yn);for(oe=0;oe<ae;oe+=4)ft=ce[ee.charCodeAt(oe)],kt=ce[ee.charCodeAt(oe+1)],an=ce[ee.charCodeAt(oe+2)],sn=ce[ee.charCodeAt(oe+3)],ni[Ve++]=ft<<2|kt>>4,ni[Ve++]=(15&kt)<<4|an>>2,ni[Ve++]=(3&an)<<6|63&sn;return Yn}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),oe=Array.isArray(ae)?function(ee){for(var X=ee.length,ae=[],oe=0;oe<X;oe+=4)ae.push(ee[oe+3]<<24|ee[oe+2]<<16|ee[oe+1]<<8|ee[oe]);return ae}(ae):new Uint32Array(ae),Ve=Array.isArray(ae)?function(ee){for(var X=ee.length,ae=[],oe=0;oe<X;oe+=2)ae.push(ee[oe+1]<<8|ee[oe]);return ae}(ae):new Uint16Array(ae),kt=N(Ve,12,oe[4]/2),an=2===oe[5]?N(Ve,(24+oe[4])/2):function(ee,X,ae){return ee.slice?ee.slice(X,ae):new Uint32Array(Array.prototype.slice.call(ee,X,ae))}(oe,Math.ceil((24+oe[4])/4)),new A(oe[0],oe[1],oe[2],oe[3],kt,an)),Un=[ai,36],Ci=[1,2,3,5],Rn=[Oe,8],si=[Hn,Tn],Fn=Ci.concat(Rn),Zt=[pe,me,Fe,ys,ds],tr=[yt,ht],$=function(ee,X,ae,oe){var Ve=oe[ae];if(Array.isArray(ee)?-1!==ee.indexOf(Ve):ee===Ve)for(var ft=ae;ft<=oe.length;){if((kt=oe[++ft])===X)return!0;if(kt!==Oe)break}if(Ve===Oe)for(ft=ae;ft>0;){var an=oe[--ft];if(Array.isArray(ee)?-1!==ee.indexOf(an):ee===an)for(var sn=ae;sn<=oe.length;){var kt;if((kt=oe[++sn])===X)return!0;if(kt!==Oe)break}if(an!==Oe)break}return!1},S=function(ee,X){for(var ae=ee;ae>=0;){var oe=X[ae];if(oe!==Oe)return oe;ae--}return 0},Z=function(ee,X,ae,oe,Ve){if(0===ae[oe])return jt;var ft=oe-1;if(Array.isArray(Ve)&&!0===Ve[ft])return jt;var kt=ft-1,an=ft+1,sn=X[ft],Yn=kt>=0?X[kt]:0,ni=X[an];if(2===sn&&3===ni)return jt;if(-1!==Ci.indexOf(sn))return"!";if(-1!==Ci.indexOf(ni)||-1!==Rn.indexOf(ni))return jt;if(8===S(ft,X))return"\xf7";if(11===ln.get(ee[ft])||(sn===Or||sn===Tr)&&11===ln.get(ee[an])||7===sn||7===ni||9===sn||-1===[Oe,ht,yt].indexOf(sn)&&9===ni||-1!==[Ot,It,An,dn,ti].indexOf(ni)||S(ft,X)===Qt||$(23,Qt,ft,X)||$([Ot,It],pn,ft,X)||$(12,12,ft,X))return jt;if(sn===Oe)return"\xf7";if(23===sn||23===ni)return jt;if(16===ni||16===sn)return"\xf7";if(-1!==[ht,yt,pn].indexOf(ni)||14===sn||36===Yn&&-1!==tr.indexOf(sn)||sn===ti&&36===ni||ni===on||-1!==Un.indexOf(ni)&&sn===yn||-1!==Un.indexOf(sn)&&ni===yn||sn===Hn&&-1!==[W,Or,Tr].indexOf(ni)||-1!==[W,Or,Tr].indexOf(sn)&&ni===Tn||-1!==Un.indexOf(sn)&&-1!==si.indexOf(ni)||-1!==si.indexOf(sn)&&-1!==Un.indexOf(ni)||-1!==[Hn,Tn].indexOf(sn)&&(ni===yn||-1!==[Qt,yt].indexOf(ni)&&X[an+1]===yn)||-1!==[Qt,yt].indexOf(sn)&&ni===yn||sn===yn&&-1!==[yn,ti,dn].indexOf(ni))return jt;if(-1!==[yn,ti,dn,Ot,It].indexOf(ni))for(var ii=ft;ii>=0;){if((Gi=X[ii])===yn)return jt;if(-1===[ti,dn].indexOf(Gi))break;ii--}if(-1!==[Hn,Tn].indexOf(ni))for(ii=-1!==[Ot,It].indexOf(sn)?kt:ft;ii>=0;){var Gi;if((Gi=X[ii])===yn)return jt;if(-1===[ti,dn].indexOf(Gi))break;ii--}if(pe===sn&&-1!==[pe,me,ys,ds].indexOf(ni)||-1!==[me,ys].indexOf(sn)&&-1!==[me,Fe].indexOf(ni)||-1!==[Fe,ds].indexOf(sn)&&ni===Fe||-1!==Zt.indexOf(sn)&&-1!==[on,Tn].indexOf(ni)||-1!==Zt.indexOf(ni)&&sn===Hn||-1!==Un.indexOf(sn)&&-1!==Un.indexOf(ni)||sn===dn&&-1!==Un.indexOf(ni)||-1!==Un.concat(yn).indexOf(sn)&&ni===Qt&&-1===xt.indexOf(ee[an])||-1!==Un.concat(yn).indexOf(ni)&&sn===It)return jt;if(41===sn&&41===ni){for(var ms=ae[ft],Pr=1;ms>0&&41===X[--ms];)Pr++;if(Pr%2!=0)return jt}return sn===Or&&ni===Tr?jt:"\xf7"},Ae=function(ee,X){X||(X={lineBreak:"normal",wordBreak:"normal"});var ae=function(ee,X){void 0===X&&(X="strict");var ae=[],oe=[],Ve=[];return ee.forEach(function(ft,kt){var an=ln.get(ft);if(an>50?(Ve.push(!0),an-=50):Ve.push(!1),-1!==["normal","auto","loose"].indexOf(X)&&-1!==[8208,8211,12316,12448].indexOf(ft))return oe.push(kt),ae.push(16);if(4===an||11===an){if(0===kt)return oe.push(kt),ae.push(ai);var sn=ae[kt-1];return-1===Fn.indexOf(sn)?(oe.push(oe[kt-1]),ae.push(sn)):(oe.push(kt),ae.push(ai))}return oe.push(kt),31===an?ae.push("strict"===X?pn:W):an===Et||29===an?ae.push(ai):43===an?ae.push(ft>=131072&&ft<=196605||ft>=196608&&ft<=262141?W:ai):void ae.push(an)}),[oe,ae,Ve]}(ee,X.lineBreak),oe=ae[0],Ve=ae[1],ft=ae[2];return("break-all"===X.wordBreak||"break-word"===X.wordBreak)&&(Ve=Ve.map(function(an){return-1!==[yn,ai,Et].indexOf(an)?W:an})),[oe,Ve,"keep-all"===X.wordBreak?ft.map(function(an,sn){return an&&ee[sn]>=19968&&ee[sn]<=40959}):void 0]},Ce=function(){function ee(X,ae,oe,Ve){this.codePoints=X,this.required="!"===ae,this.start=oe,this.end=Ve}return ee.prototype.slice=function(){return ot.apply(void 0,this.codePoints.slice(this.start,this.end))},ee}(),Vo=function(ee){return ee>=48&&ee<=57},Cg=function(ee){return Vo(ee)||ee>=65&&ee<=70||ee>=97&&ee<=102},Mm=function(ee){return 10===ee||9===ee||32===ee},Sg=function(ee){return function(ee){return function(ee){return ee>=97&&ee<=122}(ee)||function(ee){return ee>=65&&ee<=90}(ee)}(ee)||function(ee){return ee>=128}(ee)||95===ee},tf=function(ee){return Sg(ee)||Vo(ee)||45===ee},Eg=function(ee){return ee>=0&&ee<=8||11===ee||ee>=14&&ee<=31||127===ee},Qf=function(ee,X){return 92===ee&&10!==X},ao=function(ee,X,ae){return 45===ee?Sg(X)||Qf(X,ae):!!Sg(ee)||!(92!==ee||!Qf(ee,X))},ja=function(ee,X,ae){return 43===ee||45===ee?!!Vo(X)||46===X&&Vo(ae):Vo(46===ee?X:ee)},rM=function(ee){var X=0,ae=1;(43===ee[X]||45===ee[X])&&(45===ee[X]&&(ae=-1),X++);for(var oe=[];Vo(ee[X]);)oe.push(ee[X++]);var Ve=oe.length?parseInt(ot.apply(void 0,oe),10):0;46===ee[X]&&X++;for(var ft=[];Vo(ee[X]);)ft.push(ee[X++]);var kt=ft.length,an=kt?parseInt(ot.apply(void 0,ft),10):0;(69===ee[X]||101===ee[X])&&X++;var sn=1;(43===ee[X]||45===ee[X])&&(45===ee[X]&&(sn=-1),X++);for(var Yn=[];Vo(ee[X]);)Yn.push(ee[X++]);var ni=Yn.length?parseInt(ot.apply(void 0,Yn),10):0;return ae*(Ve+an*Math.pow(10,-kt))*Math.pow(10,sn*ni)},kx={type:2},Fx={type:3},y1={type:4},W0={type:13},Tg={type:8},ua={type:21},CA={type:9},v1={type:10},jd={type:11},b1={type:12},Ox={type:14},MA={type:23},Dg={type:1},x1={type:25},j0={type:24},Lx={type:26},Nx={type:27},Ux={type:28},dv={type:29},SA={type:31},w1={type:32},xh=function(){function ee(){this._value=[]}return ee.prototype.write=function(X){this._value=this._value.concat(Xe(X))},ee.prototype.read=function(){for(var X=[],ae=this.consumeToken();ae!==w1;)X.push(ae),ae=this.consumeToken();return X},ee.prototype.consumeToken=function(){var X=this.consumeCodePoint();switch(X){case 34:return this.consumeStringToken(34);case 35:var ae=this.peekCodePoint(0),oe=this.peekCodePoint(1),Ve=this.peekCodePoint(2);if(tf(ae)||Qf(oe,Ve)){var ft=ao(ae,oe,Ve)?2:1;return{type:5,value:this.consumeName(),flags:ft}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),W0;break;case 39:return this.consumeStringToken(39);case 40:return kx;case 41:return Fx;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Ox;break;case 43:if(ja(X,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(X),this.consumeNumericToken();break;case 44:return y1;case 45:var an=X,sn=this.peekCodePoint(0),Yn=this.peekCodePoint(1);if(ja(an,sn,Yn))return this.reconsumeCodePoint(X),this.consumeNumericToken();if(ao(an,sn,Yn))return this.reconsumeCodePoint(X),this.consumeIdentLikeToken();if(45===sn&&62===Yn)return this.consumeCodePoint(),this.consumeCodePoint(),j0;break;case 46:if(ja(X,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(X),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var ni=this.consumeCodePoint();if(42===ni&&47===(ni=this.consumeCodePoint()))return this.consumeToken();if(-1===ni)return this.consumeToken()}break;case 58:return Lx;case 59:return Nx;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),x1;break;case 64:var ii=this.peekCodePoint(0),Gi=this.peekCodePoint(1),ms=this.peekCodePoint(2);if(ao(ii,Gi,ms))return{type:7,value:this.consumeName()};break;case 91:return Ux;case 92:if(Qf(X,this.peekCodePoint(0)))return this.reconsumeCodePoint(X),this.consumeIdentLikeToken();break;case 93:return dv;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Tg;break;case 123:return jd;case 125:return b1;case 117:case 85:var Pr=this.peekCodePoint(0),Dr=this.peekCodePoint(1);return 43===Pr&&(Cg(Dr)||63===Dr)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(X),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),CA;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),ua;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),v1;break;case-1:return w1}return Mm(X)?(this.consumeWhiteSpace(),SA):Vo(X)?(this.reconsumeCodePoint(X),this.consumeNumericToken()):Sg(X)?(this.reconsumeCodePoint(X),this.consumeIdentLikeToken()):{type:6,value:ot(X)}},ee.prototype.consumeCodePoint=function(){var X=this._value.shift();return typeof X>"u"?-1:X},ee.prototype.reconsumeCodePoint=function(X){this._value.unshift(X)},ee.prototype.peekCodePoint=function(X){return X>=this._value.length?-1:this._value[X]},ee.prototype.consumeUnicodeRangeToken=function(){for(var X=[],ae=this.consumeCodePoint();Cg(ae)&&X.length<6;)X.push(ae),ae=this.consumeCodePoint();for(var oe=!1;63===ae&&X.length<6;)X.push(ae),ae=this.consumeCodePoint(),oe=!0;if(oe)return{type:30,start:parseInt(ot.apply(void 0,X.map(function(sn){return 63===sn?48:sn})),16),end:parseInt(ot.apply(void 0,X.map(function(sn){return 63===sn?70:sn})),16)};var kt=parseInt(ot.apply(void 0,X),16);if(45===this.peekCodePoint(0)&&Cg(this.peekCodePoint(1))){this.consumeCodePoint(),ae=this.consumeCodePoint();for(var an=[];Cg(ae)&&an.length<6;)an.push(ae),ae=this.consumeCodePoint();return{type:30,start:kt,end:parseInt(ot.apply(void 0,an),16)}}return{type:30,start:kt,end:kt}},ee.prototype.consumeIdentLikeToken=function(){var X=this.consumeName();return"url"===X.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:X}):{type:20,value:X}},ee.prototype.consumeUrlToken=function(){var X=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var ae=this.peekCodePoint(0);if(39===ae||34===ae){var oe=this.consumeStringToken(this.consumeCodePoint());return 0===oe.type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:oe.value}):(this.consumeBadUrlRemnants(),MA)}for(;;){var Ve=this.consumeCodePoint();if(-1===Ve||41===Ve)return{type:22,value:ot.apply(void 0,X)};if(Mm(Ve))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:ot.apply(void 0,X)}):(this.consumeBadUrlRemnants(),MA);if(34===Ve||39===Ve||40===Ve||Eg(Ve))return this.consumeBadUrlRemnants(),MA;if(92===Ve){if(!Qf(Ve,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),MA;X.push(this.consumeEscapedCodePoint())}else X.push(Ve)}},ee.prototype.consumeWhiteSpace=function(){for(;Mm(this.peekCodePoint(0));)this.consumeCodePoint()},ee.prototype.consumeBadUrlRemnants=function(){for(;;){var X=this.consumeCodePoint();if(41===X||-1===X)return;Qf(X,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},ee.prototype.consumeStringSlice=function(X){for(var oe="";X>0;){var Ve=Math.min(5e4,X);oe+=ot.apply(void 0,this._value.splice(0,Ve)),X-=Ve}return this._value.shift(),oe},ee.prototype.consumeStringToken=function(X){for(var ae="",oe=0;;){var Ve=this._value[oe];if(-1===Ve||void 0===Ve||Ve===X)return{type:0,value:ae+=this.consumeStringSlice(oe)};if(10===Ve)return this._value.splice(0,oe),Dg;if(92===Ve){var ft=this._value[oe+1];-1!==ft&&void 0!==ft&&(10===ft?(ae+=this.consumeStringSlice(oe),oe=-1,this._value.shift()):Qf(Ve,ft)&&(ae+=this.consumeStringSlice(oe),ae+=ot(this.consumeEscapedCodePoint()),oe=-1))}oe++}},ee.prototype.consumeNumber=function(){var X=[],ae=4,oe=this.peekCodePoint(0);for((43===oe||45===oe)&&X.push(this.consumeCodePoint());Vo(this.peekCodePoint(0));)X.push(this.consumeCodePoint());oe=this.peekCodePoint(0);var Ve=this.peekCodePoint(1);if(46===oe&&Vo(Ve))for(X.push(this.consumeCodePoint(),this.consumeCodePoint()),ae=8;Vo(this.peekCodePoint(0));)X.push(this.consumeCodePoint());oe=this.peekCodePoint(0),Ve=this.peekCodePoint(1);var ft=this.peekCodePoint(2);if((69===oe||101===oe)&&((43===Ve||45===Ve)&&Vo(ft)||Vo(Ve)))for(X.push(this.consumeCodePoint(),this.consumeCodePoint()),ae=8;Vo(this.peekCodePoint(0));)X.push(this.consumeCodePoint());return[rM(X),ae]},ee.prototype.consumeNumericToken=function(){var X=this.consumeNumber(),ae=X[0],oe=X[1],Ve=this.peekCodePoint(0),ft=this.peekCodePoint(1),kt=this.peekCodePoint(2);return ao(Ve,ft,kt)?{type:15,number:ae,flags:oe,unit:this.consumeName()}:37===Ve?(this.consumeCodePoint(),{type:16,number:ae,flags:oe}):{type:17,number:ae,flags:oe}},ee.prototype.consumeEscapedCodePoint=function(){var X=this.consumeCodePoint();if(Cg(X)){for(var ae=ot(X);Cg(this.peekCodePoint(0))&&ae.length<6;)ae+=ot(this.consumeCodePoint());Mm(this.peekCodePoint(0))&&this.consumeCodePoint();var oe=parseInt(ae,16);return 0===oe||function(ee){return ee>=55296&&ee<=57343}(oe)||oe>1114111?65533:oe}return-1===X?65533:X},ee.prototype.consumeName=function(){for(var X="";;){var ae=this.consumeCodePoint();if(tf(ae))X+=ot(ae);else{if(!Qf(ae,this.peekCodePoint(0)))return this.reconsumeCodePoint(ae),X;X+=ot(this.consumeEscapedCodePoint())}}},ee}(),Ig=function(){function ee(X){this._tokens=X}return ee.create=function(X){var ae=new xh;return ae.write(X),new ee(ae.read())},ee.parseValue=function(X){return ee.create(X).parseComponentValue()},ee.parseValues=function(X){return ee.create(X).parseComponentValues()},ee.prototype.parseComponentValue=function(){for(var X=this.consumeToken();31===X.type;)X=this.consumeToken();if(32===X.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(X);var ae=this.consumeComponentValue();do{X=this.consumeToken()}while(31===X.type);if(32===X.type)return ae;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},ee.prototype.parseComponentValues=function(){for(var X=[];;){var ae=this.consumeComponentValue();if(32===ae.type)return X;X.push(ae),X.push()}},ee.prototype.consumeComponentValue=function(){var X=this.consumeToken();switch(X.type){case 11:case 28:case 2:return this.consumeSimpleBlock(X.type);case 19:return this.consumeFunction(X)}return X},ee.prototype.consumeSimpleBlock=function(X){for(var ae={type:X,values:[]},oe=this.consumeToken();;){if(32===oe.type||Gl(oe,X))return ae;this.reconsumeToken(oe),ae.values.push(this.consumeComponentValue()),oe=this.consumeToken()}},ee.prototype.consumeFunction=function(X){for(var ae={name:X.value,values:[],type:18};;){var oe=this.consumeToken();if(32===oe.type||3===oe.type)return ae;this.reconsumeToken(oe),ae.values.push(this.consumeComponentValue())}},ee.prototype.consumeToken=function(){var X=this._tokens.shift();return typeof X>"u"?w1:X},ee.prototype.reconsumeToken=function(X){this._tokens.unshift(X)},ee}(),pi=function(ee){return 15===ee.type},wh=function(ee){return 17===ee.type},li=function(ee){return 20===ee.type},Cc=function(ee){return 0===ee.type},Sm=function(ee,X){return li(ee)&&ee.value===X},fu=function(ee){return 31!==ee.type},Bu=function(ee){return 31!==ee.type&&4!==ee.type},Yl=function(ee){var X=[],ae=[];return ee.forEach(function(oe){if(4===oe.type){if(0===ae.length)throw new Error("Error parsing function args, zero tokens for arg");return X.push(ae),void(ae=[])}31!==oe.type&&ae.push(oe)}),ae.length&&X.push(ae),X},Gl=function(ee,X){return 11===X&&12===ee.type||28===X&&29===ee.type||2===X&&3===ee.type},Ku=function(ee){return 17===ee.type||15===ee.type},fl=function(ee){return 16===ee.type||Ku(ee)},$0=function(ee){return ee.length>1?[ee[0],ee[1]]:[ee[0]]},bl={type:17,number:0,flags:4},Bg={type:16,number:50,flags:4},dd={type:16,number:100,flags:4},Em=function(ee,X,ae){var oe=ee[0],Ve=ee[1];return[Ko(oe,X),Ko(typeof Ve<"u"?Ve:oe,ae)]},Ko=function(ee,X){if(16===ee.type)return ee.number/100*X;if(pi(ee))switch(ee.unit){case"rem":case"em":return 16*ee.number;default:return ee.number}return ee.number},Pu_parse=function(ee,X){if(15===X.type)switch(X.unit){case"deg":return Math.PI*X.number/180;case"grad":return Math.PI/200*X.number;case"rad":return X.number;case"turn":return 2*Math.PI*X.number}throw new Error("Unsupported angle type")},C1=function(ee){return 15===ee.type&&("deg"===ee.unit||"grad"===ee.unit||"rad"===ee.unit||"turn"===ee.unit)},Zu=function(ee){switch(ee.filter(li).map(function(ae){return ae.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[bl,bl];case"to top":case"bottom":return Ju(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[bl,dd];case"to right":case"left":return Ju(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[dd,dd];case"to bottom":case"top":return Ju(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[dd,bl];case"to left":case"right":return Ju(270)}return 0},Ju=function(ee){return Math.PI*ee/180},Ll_parse=function(ee,X){if(18===X.type){var ae=$f[X.name];if(typeof ae>"u")throw new Error('Attempting to parse an unsupported color function "'+X.name+'"');return ae(ee,X.values)}if(5===X.type){if(3===X.value.length){var oe=X.value.substring(0,1),Ve=X.value.substring(1,2),ft=X.value.substring(2,3);return mo(parseInt(oe+oe,16),parseInt(Ve+Ve,16),parseInt(ft+ft,16),1)}if(4===X.value.length){oe=X.value.substring(0,1),Ve=X.value.substring(1,2),ft=X.value.substring(2,3);var kt=X.value.substring(3,4);return mo(parseInt(oe+oe,16),parseInt(Ve+Ve,16),parseInt(ft+ft,16),parseInt(kt+kt,16)/255)}if(6===X.value.length)return oe=X.value.substring(0,2),Ve=X.value.substring(2,4),ft=X.value.substring(4,6),mo(parseInt(oe,16),parseInt(Ve,16),parseInt(ft,16),1);if(8===X.value.length)return oe=X.value.substring(0,2),Ve=X.value.substring(2,4),ft=X.value.substring(4,6),kt=X.value.substring(6,8),mo(parseInt(oe,16),parseInt(Ve,16),parseInt(ft,16),parseInt(kt,16)/255)}if(20===X.type){var an=Zc[X.value.toUpperCase()];if(typeof an<"u")return an}return Zc.TRANSPARENT},eh=function(ee){return!(255&ee)},Zo=function(ee){var X=255&ee,ae=255&ee>>8,oe=255&ee>>16,Ve=255&ee>>24;return X<255?"rgba("+Ve+","+oe+","+ae+","+X/255+")":"rgb("+Ve+","+oe+","+ae+")"},mo=function(ee,X,ae,oe){return(ee<<24|X<<16|ae<<8|Math.round(255*oe))>>>0},EA=function(ee,X){if(17===ee.type)return ee.number;if(16===ee.type){var ae=3===X?1:255;return 3===X?ee.number/100*ae:Math.round(ee.number/100*ae)}return 0},th=function(ee,X){var ae=X.filter(Bu);if(3===ae.length){var oe=ae.map(EA);return mo(oe[0],oe[1],oe[2],1)}if(4===ae.length){var an=ae.map(EA);return mo(an[0],an[1],an[2],an[3])}return 0};function Si(ee,X,ae){return ae<0&&(ae+=1),ae>=1&&(ae-=1),ae<1/6?(X-ee)*ae*6+ee:ae<.5?X:ae<2/3?6*(X-ee)*(2/3-ae)+ee:ee}var vo=function(ee,X){var ae=X.filter(Bu),oe=ae[0],Ve=ae[1],ft=ae[2],kt=ae[3],an=(17===oe.type?Ju(oe.number):Pu_parse(ee,oe))/(2*Math.PI),sn=fl(Ve)?Ve.number/100:0,Yn=fl(ft)?ft.number/100:0,ni=typeof kt<"u"&&fl(kt)?Ko(kt,1):1;if(0===sn)return mo(255*Yn,255*Yn,255*Yn,1);var ii=Yn<=.5?Yn*(sn+1):Yn+sn-Yn*sn,Gi=2*Yn-ii,ms=Si(Gi,ii,an+1/3),Pr=Si(Gi,ii,an),Dr=Si(Gi,ii,an-1/3);return mo(255*ms,255*Pr,255*Dr,ni)},$f={hsl:vo,hsla:vo,rgb:th,rgba:th},Ch=function(ee,X){return Ll_parse(ee,Ig.create(X).parseComponentValue())},Zc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},nf={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(ee,X){return X.map(function(ae){if(li(ae))switch(ae.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Ed={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},mi=function(ee,X){var ae=Ll_parse(ee,X[0]),oe=X[1];return oe&&fl(oe)?{color:ae,stop:oe}:{color:ae,stop:null}},TA=function(ee,X){var ae=ee[0],oe=ee[ee.length-1];null===ae.stop&&(ae.stop=bl),null===oe.stop&&(oe.stop=dd);for(var Ve=[],ft=0,kt=0;kt<ee.length;kt++){var an=ee[kt].stop;if(null!==an){var sn=Ko(an,X);Ve.push(sn>ft?sn:ft),ft=sn}else Ve.push(null)}var Yn=null;for(kt=0;kt<Ve.length;kt++){var ni=Ve[kt];if(null===ni)null===Yn&&(Yn=kt);else if(null!==Yn){for(var ii=kt-Yn,ms=(ni-Ve[Yn-1])/(ii+1),Pr=1;Pr<=ii;Pr++)Ve[Yn+Pr-1]=ms*Pr;Yn=null}}return ee.map(function(Dr,Do){return{color:Dr.color,stop:Math.max(Math.min(1,Ve[Do]/X),0)}})},X0=function(ee,X,ae){var oe="number"==typeof ee?ee:function(ee,X,ae){var oe=X/2,Ve=ae/2,ft=Ko(ee[0],X)-oe,kt=Ve-Ko(ee[1],ae);return(Math.atan2(kt,ft)+2*Math.PI)%(2*Math.PI)}(ee,X,ae),Ve=Math.abs(X*Math.sin(oe))+Math.abs(ae*Math.cos(oe)),ft=X/2,kt=ae/2,an=Ve/2,sn=Math.sin(oe-Math.PI/2)*an,Yn=Math.cos(oe-Math.PI/2)*an;return[Ve,ft-Yn,ft+Yn,kt-sn,kt+sn]},pu=function(ee,X){return Math.sqrt(ee*ee+X*X)},rf=function(ee,X,ae,oe,Ve){return[[0,0],[0,X],[ee,0],[ee,X]].reduce(function(kt,an){var ni=pu(ae-an[0],oe-an[1]);return(Ve?ni<kt.optimumDistance:ni>kt.optimumDistance)?{optimumCorner:an,optimumDistance:ni}:kt},{optimumDistance:Ve?1/0:-1/0,optimumCorner:null}).optimumCorner},sf=function(ee,X){var ae=Ju(180),oe=[];return Yl(X).forEach(function(Ve,ft){if(0===ft){var kt=Ve[0];if(20===kt.type&&-1!==["top","left","right","bottom"].indexOf(kt.value))return void(ae=Zu(Ve));if(C1(kt))return void(ae=(Pu_parse(ee,kt)+Ju(270))%Ju(360))}var an=mi(ee,Ve);oe.push(an)}),{angle:ae,stops:oe,type:1}},Ip="closest-side",kg="farthest-side",Ru="closest-corner",Tm="farthest-corner",Dm="ellipse",Za="contain",ku=function(ee,X){var ae=0,oe=3,Ve=[],ft=[];return Yl(X).forEach(function(kt,an){var sn=!0;if(0===an?sn=kt.reduce(function(ni,ii){if(li(ii))switch(ii.value){case"center":return ft.push(Bg),!1;case"top":case"left":return ft.push(bl),!1;case"right":case"bottom":return ft.push(dd),!1}else if(fl(ii)||Ku(ii))return ft.push(ii),!1;return ni},sn):1===an&&(sn=kt.reduce(function(ni,ii){if(li(ii))switch(ii.value){case"circle":return ae=0,!1;case Dm:return ae=1,!1;case Za:case Ip:return oe=0,!1;case kg:return oe=1,!1;case Ru:return oe=2,!1;case"cover":case Tm:return oe=3,!1}else if(Ku(ii)||fl(ii))return Array.isArray(oe)||(oe=[]),oe.push(ii),!1;return ni},sn)),sn){var Yn=mi(ee,kt);Ve.push(Yn)}}),{size:oe,shape:ae,stops:Ve,position:ft,type:2}},Bp_parse=function(ee,X){if(22===X.type){var ae={url:X.value,type:0};return ee.cache.addImage(X.value),ae}if(18===X.type){var oe=to[X.name];if(typeof oe>"u")throw new Error('Attempting to parse an unsupported image function "'+X.name+'"');return oe(ee,X.values)}throw new Error("Unsupported image type "+X.type)};for(var to={"linear-gradient":function(ee,X){var ae=Ju(180),oe=[];return Yl(X).forEach(function(Ve,ft){if(0===ft){var kt=Ve[0];if(20===kt.type&&"to"===kt.value)return void(ae=Zu(Ve));if(C1(kt))return void(ae=Pu_parse(ee,kt))}var an=mi(ee,Ve);oe.push(an)}),{angle:ae,stops:oe,type:1}},"-moz-linear-gradient":sf,"-ms-linear-gradient":sf,"-o-linear-gradient":sf,"-webkit-linear-gradient":sf,"radial-gradient":function(ee,X){var ae=0,oe=3,Ve=[],ft=[];return Yl(X).forEach(function(kt,an){var sn=!0;if(0===an){var Yn=!1;sn=kt.reduce(function(ii,Gi){if(Yn)if(li(Gi))switch(Gi.value){case"center":return ft.push(Bg),ii;case"top":case"left":return ft.push(bl),ii;case"right":case"bottom":return ft.push(dd),ii}else(fl(Gi)||Ku(Gi))&&ft.push(Gi);else if(li(Gi))switch(Gi.value){case"circle":return ae=0,!1;case Dm:return ae=1,!1;case"at":return Yn=!0,!1;case Ip:return oe=0,!1;case"cover":case kg:return oe=1,!1;case Za:case Ru:return oe=2,!1;case Tm:return oe=3,!1}else if(Ku(Gi)||fl(Gi))return Array.isArray(oe)||(oe=[]),oe.push(Gi),!1;return ii},sn)}if(sn){var ni=mi(ee,kt);Ve.push(ni)}}),{size:oe,shape:ae,stops:Ve,position:ft,type:2}},"-moz-radial-gradient":ku,"-ms-radial-gradient":ku,"-o-radial-gradient":ku,"-webkit-radial-gradient":ku,"-webkit-gradient":function(ee,X){var ae=Ju(180),oe=[],Ve=1;return Yl(X).forEach(function(sn,Yn){var ni=sn[0];if(0===Yn){if(li(ni)&&"linear"===ni.value)return void(Ve=1);if(li(ni)&&"radial"===ni.value)return void(Ve=2)}if(18===ni.type)if("from"===ni.name){var ii=Ll_parse(ee,ni.values[0]);oe.push({stop:bl,color:ii})}else if("to"===ni.name)ii=Ll_parse(ee,ni.values[0]),oe.push({stop:dd,color:ii});else if("color-stop"===ni.name){var Gi=ni.values.filter(Bu);if(2===Gi.length){ii=Ll_parse(ee,Gi[1]);var ms=Gi[0];wh(ms)&&oe.push({stop:{type:16,number:100*ms.number,flags:ms.flags},color:ii})}}}),1===Ve?{angle:(ae+Ju(180))%Ju(360),stops:oe,type:Ve}:{size:3,shape:0,stops:oe,position:[],type:Ve}}},ud={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(ee,X){if(0===X.length)return[];var ae=X[0];return 20===ae.type&&"none"===ae.value?[]:X.filter(function(oe){return Bu(oe)&&function Qr(ee){return!(20===ee.type&&"none"===ee.value||18===ee.type&&!to[ee.name])}(oe)}).map(function(oe){return Bp_parse(ee,oe)})}},Lo={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(ee,X){return X.map(function(ae){if(li(ae))switch(ae.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Dn={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(ee,X){return Yl(X).map(function(ae){return ae.filter(fl)}).map($0)}},Sr={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(ee,X){return Yl(X).map(function(ae){return ae.filter(li).map(function(oe){return oe.value}).join(" ")}).map(Vc)}},Vc=function(ee){switch(ee){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},Ys=function(ee){return ee.AUTO="auto",ee.CONTAIN="contain",ee.COVER="cover",ee}(Ys||{}),ul={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(ee,X){return Yl(X).map(function(ae){return ae.filter(hl)})}},hl=function(ee){return li(ee)||fl(ee)},Gc=function(ee){return{name:"border-"+ee+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},rc=Gc("top"),Pp=Gc("right"),Rp=Gc("bottom"),Kl=Gc("left"),Mc=function(ee){return{name:"border-radius-"+ee,initialValue:"0 0",prefix:!1,type:1,parse:function(X,ae){return $0(ae.filter(fl))}}},Yf=Mc("top-left"),Mh=Mc("top-right"),IA=Mc("bottom-right"),kp=Mc("bottom-left"),Sh=function(ee){return{name:"border-"+ee+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(X,ae){switch(ae){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Kf=Sh("top"),zx=Sh("right"),Fp=Sh("bottom"),Y0=Sh("left"),sc=function(ee){return{name:"border-"+ee+"-width",initialValue:"0",type:0,prefix:!1,parse:function(X,ae){return pi(ae)?ae.number:0}}},Op=sc("top"),E1=sc("right"),Lp=sc("bottom"),Zf=sc("left"),af={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Jc={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(ee,X){return"rtl"===X?1:0}},BA={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(ee,X){return X.filter(li).reduce(function(ae,oe){return ae|lo(oe.value)},0)}},lo=function(ee){switch(ee){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},nh={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(ee,X){switch(X){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},xl={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(ee,X){return 20===X.type&&"normal"===X.value?0:17===X.type||15===X.type?X.number:0}},Jf=function(ee){return ee.NORMAL="normal",ee.STRICT="strict",ee}(Jf||{}),Fg={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(ee,X){return"strict"===X?Jf.STRICT:Jf.NORMAL}},mu={name:"line-height",initialValue:"normal",prefix:!1,type:4},Np=function(ee,X){return li(ee)&&"normal"===ee.value?1.2*X:17===ee.type?X*ee.number:fl(ee)?Ko(ee,X):X},Td={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(ee,X){return 20===X.type&&"none"===X.value?null:Bp_parse(ee,X)}},lf={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(ee,X){return"inside"===X?0:1}},Og={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(ee,X){switch(X){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},Dd=function(ee){return{name:"margin-"+ee,initialValue:"0",prefix:!1,type:4}},hv=Dd("top"),ed=Dd("right"),hd=Dd("bottom"),fv=Dd("left"),K0={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(ee,X){return X.filter(li).map(function(ae){switch(ae.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},Il={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(ee,X){return"break-word"===X?"break-word":"normal"}},Up=function(ee){return{name:"padding-"+ee,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},pl=Up("top"),Sc=Up("right"),Id=Up("bottom"),T1=Up("left"),Lg={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(ee,X){switch(X){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},D1={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(ee,X){switch(X){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Hx={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(ee,X){return 1===X.length&&Sm(X[0],"none")?[]:Yl(X).map(function(ae){for(var oe={color:Zc.TRANSPARENT,offsetX:bl,offsetY:bl,blur:bl},Ve=0,ft=0;ft<ae.length;ft++){var kt=ae[ft];Ku(kt)?(0===Ve?oe.offsetX=kt:1===Ve?oe.offsetY=kt:oe.blur=kt,Ve++):oe.color=Ll_parse(ee,kt)}return oe})}},Im={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(ee,X){switch(X){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Z0={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(ee,X){if(20===X.type&&"none"===X.value)return null;if(18===X.type){var ae=zp[X.name];if(typeof ae>"u")throw new Error('Attempting to parse an unsupported transform function "'+X.name+'"');return ae(X.values)}return null}},zp={matrix:function(ee){var X=ee.filter(function(ae){return 17===ae.type}).map(function(ae){return ae.number});return 6===X.length?X:null},matrix3d:function(ee){var X=ee.filter(function(sn){return 17===sn.type}).map(function(sn){return sn.number});return 16===X.length?[X[0],X[1],X[4],X[5],X[12],X[13]]:null}},Ec={type:16,number:50,flags:4},wl=[Ec,Ec],Rr={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(ee,X){var ae=X.filter(fl);return 2!==ae.length?wl:[ae[0],ae[1]]}},Ks={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(ee,X){switch(X){case"hidden":return 1;case"collapse":return 2;default:return 0}}},Na=function(ee){return ee.NORMAL="normal",ee.BREAK_ALL="break-all",ee.KEEP_ALL="keep-all",ee}(Na||{}),oc={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(ee,X){switch(X){case"break-all":return Na.BREAK_ALL;case"keep-all":return Na.KEEP_ALL;default:return Na.NORMAL}}},Tc={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(ee,X){if(20===X.type)return{auto:!0,order:0};if(wh(X))return{auto:!1,order:X.number};throw new Error("Invalid z-index number parsed")}},Dc={name:"time",parse:function(ee,X){if(15===X.type)switch(X.unit.toLowerCase()){case"s":return 1e3*X.number;case"ms":return X.number}throw new Error("Unsupported time type")}},Bm={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(ee,X){return wh(X)?X.number:1}},ml={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Zl={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(ee,X){return X.filter(li).map(function(ae){switch(ae.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(ae){return 0!==ae})}},Au={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(ee,X){var ae=[],oe=[];return X.forEach(function(Ve){switch(Ve.type){case 20:case 0:ae.push(Ve.value);break;case 17:ae.push(Ve.number.toString());break;case 4:oe.push(ae.join(" ")),ae.length=0}}),ae.length&&oe.push(ae.join(" ")),oe.map(function(Ve){return-1===Ve.indexOf(" ")?Ve:"'"+Ve+"'"})}},Ao={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Pm={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(ee,X){return wh(X)?X.number:li(X)&&"bold"===X.value?700:400}},B1={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(ee,X){return X.filter(li).map(function(ae){return ae.value})}},ih={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(ee,X){switch(X){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},ko=function(ee,X){return!!(ee&X)},Nl={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(ee,X){if(0===X.length)return[];var ae=X[0];return 20===ae.type&&"none"===ae.value?[]:X}},Rm={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(ee,X){if(0===X.length)return null;var ae=X[0];if(20===ae.type&&"none"===ae.value)return null;for(var oe=[],Ve=X.filter(fu),ft=0;ft<Ve.length;ft++){var kt=Ve[ft],an=Ve[ft+1];if(20===kt.type){var sn=an&&wh(an)?an.number:1;oe.push({counter:kt.value,increment:sn})}}return oe}},Ac={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(ee,X){if(0===X.length)return[];for(var ae=[],oe=X.filter(fu),Ve=0;Ve<oe.length;Ve++){var ft=oe[Ve],kt=oe[Ve+1];if(li(ft)&&"none"!==ft.value){var an=kt&&wh(kt)?kt.number:0;ae.push({counter:ft.value,reset:an})}}return ae}},Hp={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(ee,X){return X.filter(pi).map(function(ae){return Dc.parse(ee,ae)})}},Vp={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(ee,X){if(0===X.length)return null;var ae=X[0];if(20===ae.type&&"none"===ae.value)return null;var oe=[],Ve=X.filter(Cc);if(Ve.length%2!=0)return null;for(var ft=0;ft<Ve.length;ft+=2)oe.push({open:Ve[ft].value,close:Ve[ft+1].value});return oe}},ac=function(ee,X,ae){if(!ee)return"";var oe=ee[Math.min(X,ee.length-1)];return oe?ae?oe.open:oe.close:""},Bd={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(ee,X){return 1===X.length&&Sm(X[0],"none")?[]:Yl(X).map(function(ae){for(var oe={color:255,offsetX:bl,offsetY:bl,blur:bl,spread:bl,inset:!1},Ve=0,ft=0;ft<ae.length;ft++){var kt=ae[ft];Sm(kt,"inset")?oe.inset=!0:Ku(kt)?(0===Ve?oe.offsetX=kt:1===Ve?oe.offsetY=kt:2===Ve?oe.blur=kt:oe.spread=kt,Ve++):oe.color=Ll_parse(ee,kt)}return oe})}},Bl={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(ee,X){var oe=[];return X.filter(li).forEach(function(Ve){switch(Ve.value){case"stroke":oe.push(1);break;case"fill":oe.push(0);break;case"markers":oe.push(2)}}),[0,1,2].forEach(function(Ve){-1===oe.indexOf(Ve)&&oe.push(Ve)}),oe}},us={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Eh={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(ee,X){return pi(X)?X.number:0}},Th=function(){function ee(X,ae){var oe,Ve;this.animationDuration=Xr(X,Hp,ae.animationDuration),this.backgroundClip=Xr(X,nf,ae.backgroundClip),this.backgroundColor=Xr(X,Ed,ae.backgroundColor),this.backgroundImage=Xr(X,ud,ae.backgroundImage),this.backgroundOrigin=Xr(X,Lo,ae.backgroundOrigin),this.backgroundPosition=Xr(X,Dn,ae.backgroundPosition),this.backgroundRepeat=Xr(X,Sr,ae.backgroundRepeat),this.backgroundSize=Xr(X,ul,ae.backgroundSize),this.borderTopColor=Xr(X,rc,ae.borderTopColor),this.borderRightColor=Xr(X,Pp,ae.borderRightColor),this.borderBottomColor=Xr(X,Rp,ae.borderBottomColor),this.borderLeftColor=Xr(X,Kl,ae.borderLeftColor),this.borderTopLeftRadius=Xr(X,Yf,ae.borderTopLeftRadius),this.borderTopRightRadius=Xr(X,Mh,ae.borderTopRightRadius),this.borderBottomRightRadius=Xr(X,IA,ae.borderBottomRightRadius),this.borderBottomLeftRadius=Xr(X,kp,ae.borderBottomLeftRadius),this.borderTopStyle=Xr(X,Kf,ae.borderTopStyle),this.borderRightStyle=Xr(X,zx,ae.borderRightStyle),this.borderBottomStyle=Xr(X,Fp,ae.borderBottomStyle),this.borderLeftStyle=Xr(X,Y0,ae.borderLeftStyle),this.borderTopWidth=Xr(X,Op,ae.borderTopWidth),this.borderRightWidth=Xr(X,E1,ae.borderRightWidth),this.borderBottomWidth=Xr(X,Lp,ae.borderBottomWidth),this.borderLeftWidth=Xr(X,Zf,ae.borderLeftWidth),this.boxShadow=Xr(X,Bd,ae.boxShadow),this.color=Xr(X,af,ae.color),this.direction=Xr(X,Jc,ae.direction),this.display=Xr(X,BA,ae.display),this.float=Xr(X,nh,ae.cssFloat),this.fontFamily=Xr(X,Au,ae.fontFamily),this.fontSize=Xr(X,Ao,ae.fontSize),this.fontStyle=Xr(X,ih,ae.fontStyle),this.fontVariant=Xr(X,B1,ae.fontVariant),this.fontWeight=Xr(X,Pm,ae.fontWeight),this.letterSpacing=Xr(X,xl,ae.letterSpacing),this.lineBreak=Xr(X,Fg,ae.lineBreak),this.lineHeight=Xr(X,mu,ae.lineHeight),this.listStyleImage=Xr(X,Td,ae.listStyleImage),this.listStylePosition=Xr(X,lf,ae.listStylePosition),this.listStyleType=Xr(X,Og,ae.listStyleType),this.marginTop=Xr(X,hv,ae.marginTop),this.marginRight=Xr(X,ed,ae.marginRight),this.marginBottom=Xr(X,hd,ae.marginBottom),this.marginLeft=Xr(X,fv,ae.marginLeft),this.opacity=Xr(X,Bm,ae.opacity);var ft=Xr(X,K0,ae.overflow);this.overflowX=ft[0],this.overflowY=ft[ft.length>1?1:0],this.overflowWrap=Xr(X,Il,ae.overflowWrap),this.paddingTop=Xr(X,pl,ae.paddingTop),this.paddingRight=Xr(X,Sc,ae.paddingRight),this.paddingBottom=Xr(X,Id,ae.paddingBottom),this.paddingLeft=Xr(X,T1,ae.paddingLeft),this.paintOrder=Xr(X,Bl,ae.paintOrder),this.position=Xr(X,D1,ae.position),this.textAlign=Xr(X,Lg,ae.textAlign),this.textDecorationColor=Xr(X,ml,null!==(oe=ae.textDecorationColor)&&void 0!==oe?oe:ae.color),this.textDecorationLine=Xr(X,Zl,null!==(Ve=ae.textDecorationLine)&&void 0!==Ve?Ve:ae.textDecoration),this.textShadow=Xr(X,Hx,ae.textShadow),this.textTransform=Xr(X,Im,ae.textTransform),this.transform=Xr(X,Z0,ae.transform),this.transformOrigin=Xr(X,Rr,ae.transformOrigin),this.visibility=Xr(X,Ks,ae.visibility),this.webkitTextStrokeColor=Xr(X,us,ae.webkitTextStrokeColor),this.webkitTextStrokeWidth=Xr(X,Eh,ae.webkitTextStrokeWidth),this.wordBreak=Xr(X,oc,ae.wordBreak),this.zIndex=Xr(X,Tc,ae.zIndex)}return ee.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},ee.prototype.isTransparent=function(){return eh(this.backgroundColor)},ee.prototype.isTransformed=function(){return null!==this.transform},ee.prototype.isPositioned=function(){return 0!==this.position},ee.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},ee.prototype.isFloating=function(){return 0!==this.float},ee.prototype.isInlineLevel=function(){return ko(this.display,4)||ko(this.display,33554432)||ko(this.display,268435456)||ko(this.display,536870912)||ko(this.display,67108864)||ko(this.display,134217728)},ee}(),rh=function(){return function ee(X,ae){this.content=Xr(X,Nl,ae.content),this.quotes=Xr(X,Vp,ae.quotes)}}(),Ic=function(){return function ee(X,ae){this.counterIncrement=Xr(X,Rm,ae.counterIncrement),this.counterReset=Xr(X,Ac,ae.counterReset)}}(),Xr=function(ee,X,ae){var oe=new xh,Ve=null!==ae&&typeof ae<"u"?ae.toString():X.initialValue;oe.write(Ve);var ft=new Ig(oe.read());switch(X.type){case 2:var kt=ft.parseComponentValue();return X.parse(ee,li(kt)?kt.value:X.initialValue);case 0:return X.parse(ee,ft.parseComponentValue());case 1:return X.parse(ee,ft.parseComponentValues());case 4:return ft.parseComponentValue();case 3:switch(X.format){case"angle":return Pu_parse(ee,ft.parseComponentValue());case"color":return Ll_parse(ee,ft.parseComponentValue());case"image":return Bp_parse(ee,ft.parseComponentValue());case"length":var an=ft.parseComponentValue();return Ku(an)?an:bl;case"length-percentage":var sn=ft.parseComponentValue();return fl(sn)?sn:bl;case"time":return Dc.parse(ee,ft.parseComponentValue())}}},Bc=function(ee,X){var ae=function(ee){switch(ee.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(ee);return 1===ae||X===ae},Al=function(){return function ee(X,ae){this.context=X,this.textNodes=[],this.elements=[],this.flags=0,Bc(ae,3),this.styles=new Th(X,window.getComputedStyle(ae,null)),o_(ae)&&(this.styles.animationDuration.some(function(oe){return oe>0})&&(ae.style.animationDuration="0s"),null!==this.styles.transform&&(ae.style.transform="none")),this.bounds=et(this.context,ae),Bc(ae,4)&&(this.flags|=16)}}(),cf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pc=typeof Uint8Array>"u"?[]:new Uint8Array(256),ql=0;ql<64;ql++)Pc[cf.charCodeAt(ql)]=ql;for(var gu=function(ee,X,ae){return ee.slice?ee.slice(X,ae):new Uint16Array(Array.prototype.slice.call(ee,X,ae))},oh=function(){function ee(X,ae,oe,Ve,ft,kt){this.initialValue=X,this.errorValue=ae,this.highStart=oe,this.highValueIndex=Ve,this.index=ft,this.data=kt}return ee.prototype.get=function(X){var ae;if(X>=0){if(X<55296||X>56319&&X<=65535)return this.data[ae=((ae=this.index[X>>5])<<2)+(31&X)];if(X<=65535)return this.data[ae=((ae=this.index[2048+(X-55296>>5)])<<2)+(31&X)];if(X<this.highStart)return ae=this.index[ae=2080+(X>>11)],this.data[ae=((ae=this.index[ae+=X>>5&63])<<2)+(31&X)];if(X<=1114111)return this.data[this.highValueIndex]}return this.errorValue},ee}(),Hg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",km=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ih=0;Ih<64;Ih++)km[Hg.charCodeAt(Ih)]=Ih;var jp=8,Fm=9,Ph=11,rp=12,mv=function(){for(var ee=[],X=0;X<arguments.length;X++)ee[X]=arguments[X];if(String.fromCodePoint)return String.fromCodePoint.apply(String,ee);var ae=ee.length;if(!ae)return"";for(var oe=[],Ve=-1,ft="";++Ve<ae;){var kt=ee[Ve];kt<=65535?oe.push(kt):oe.push(55296+((kt-=65536)>>10),kt%1024+56320),(Ve+1===ae||oe.length>16384)&&(ft+=String.fromCharCode.apply(String,oe),oe.length=0)}return ft},Om=function(ee,X){var ae=function(ee){var oe,ft,kt,an,sn,X=.75*ee.length,ae=ee.length,Ve=0;"="===ee[ee.length-1]&&(X--,"="===ee[ee.length-2]&&X--);var Yn=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(X):new Array(X),ni=Array.isArray(Yn)?Yn:new Uint8Array(Yn);for(oe=0;oe<ae;oe+=4)ft=Pc[ee.charCodeAt(oe)],kt=Pc[ee.charCodeAt(oe+1)],an=Pc[ee.charCodeAt(oe+2)],sn=Pc[ee.charCodeAt(oe+3)],ni[Ve++]=ft<<2|kt>>4,ni[Ve++]=(15&kt)<<4|an>>2,ni[Ve++]=(3&an)<<6|63&sn;return Yn}(ee),oe=Array.isArray(ae)?function(ee){for(var X=ee.length,ae=[],oe=0;oe<X;oe+=4)ae.push(ee[oe+3]<<24|ee[oe+2]<<16|ee[oe+1]<<8|ee[oe]);return ae}(ae):new Uint32Array(ae),Ve=Array.isArray(ae)?function(ee){for(var X=ee.length,ae=[],oe=0;oe<X;oe+=2)ae.push(ee[oe+1]<<8|ee[oe]);return ae}(ae):new Uint16Array(ae),kt=gu(Ve,12,oe[4]/2),an=2===oe[5]?gu(Ve,(24+oe[4])/2):function(ee,X,ae){return ee.slice?ee.slice(X,ae):new Uint32Array(Array.prototype.slice.call(ee,X,ae))}(oe,Math.ceil((24+oe[4])/4));return new oh(oe[0],oe[1],oe[2],oe[3],kt,an)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),OA=function(ee){return Om.get(ee)},Pd=function(ee,X,ae){var oe=ae-2,Ve=X[oe],ft=X[ae-1],kt=X[ae];if(2===ft&&3===kt)return"\xd7";if(2===ft||3===ft||4===ft||2===kt||3===kt||4===kt)return"\xf7";if(ft===jp&&-1!==[jp,Fm,Ph,rp].indexOf(kt)||(ft===Ph||ft===Fm)&&(kt===Fm||10===kt)||(ft===rp||10===ft)&&10===kt||13===kt||5===kt||7===kt||1===ft)return"\xd7";if(13===ft&&14===kt){for(;5===Ve;)Ve=X[--oe];if(14===Ve)return"\xd7"}if(15===ft&&15===kt){for(var an=0;15===Ve;)an++,Ve=X[--oe];if(an%2==0)return"\xd7"}return"\xf7"},Lm=function(ee){var X=function(ee){for(var X=[],ae=0,oe=ee.length;ae<oe;){var Ve=ee.charCodeAt(ae++);if(Ve>=55296&&Ve<=56319&&ae<oe){var ft=ee.charCodeAt(ae++);56320==(64512&ft)?X.push(((1023&Ve)<<10)+(1023&ft)+65536):(X.push(Ve),ae--)}else X.push(Ve)}return X}(ee),ae=X.length,oe=0,Ve=0,ft=X.map(OA);return{next:function(){if(oe>=ae)return{done:!0,value:null};for(var kt="\xd7";oe<ae&&"\xd7"===(kt=Pd(0,ft,++oe)););if("\xd7"!==kt||oe===ae){var an=mv.apply(null,X.slice(Ve,oe));return Ve=oe,{value:an,done:!1}}return{done:!0,value:null}}}},Lu=function(ee){return 0===ee[0]&&255===ee[1]&&0===ee[2]&&255===ee[3]},n_=function(ee,X,ae,oe,Ve){var ft="http://www.w3.org/2000/svg",kt=document.createElementNS(ft,"svg"),an=document.createElementNS(ft,"foreignObject");return kt.setAttributeNS(null,"width",ee.toString()),kt.setAttributeNS(null,"height",X.toString()),an.setAttributeNS(null,"width","100%"),an.setAttributeNS(null,"height","100%"),an.setAttributeNS(null,"x",ae.toString()),an.setAttributeNS(null,"y",oe.toString()),an.setAttributeNS(null,"externalResourcesRequired","true"),kt.appendChild(an),an.appendChild(Ve),kt},i_=function(ee){return new Promise(function(X,ae){var oe=new Image;oe.onload=function(){return X(oe)},oe.onerror=ae,oe.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(ee))})},Rc={get SUPPORT_RANGE_BOUNDS(){var ee=function(ee){if(ee.createRange){var ae=ee.createRange();if(ae.getBoundingClientRect){var oe=ee.createElement("boundtest");oe.style.height="123px",oe.style.display="block",ee.body.appendChild(oe),ae.selectNode(oe);var Ve=ae.getBoundingClientRect(),ft=Math.round(Ve.height);if(ee.body.removeChild(oe),123===ft)return!0}}return!1}(document);return Object.defineProperty(Rc,"SUPPORT_RANGE_BOUNDS",{value:ee}),ee},get SUPPORT_WORD_BREAKING(){var ee=Rc.SUPPORT_RANGE_BOUNDS&&function(ee){var X=ee.createElement("boundtest");X.style.width="50px",X.style.display="block",X.style.fontSize="12px",X.style.letterSpacing="0px",X.style.wordSpacing="0px",ee.body.appendChild(X);var ae=ee.createRange();X.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var oe=X.firstChild,Ve=Xe(oe.data).map(function(sn){return ot(sn)}),ft=0,kt={},an=Ve.every(function(sn,Yn){ae.setStart(oe,ft),ae.setEnd(oe,ft+sn.length);var ni=ae.getBoundingClientRect();ft+=sn.length;var ii=ni.x>kt.x||ni.y>kt.y;return kt=ni,0===Yn||ii});return ee.body.removeChild(X),an}(document);return Object.defineProperty(Rc,"SUPPORT_WORD_BREAKING",{value:ee}),ee},get SUPPORT_SVG_DRAWING(){var ee=function(ee){var X=new Image,ae=ee.createElement("canvas"),oe=ae.getContext("2d");if(!oe)return!1;X.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{oe.drawImage(X,0,0),ae.toDataURL()}catch{return!1}return!0}(document);return Object.defineProperty(Rc,"SUPPORT_SVG_DRAWING",{value:ee}),ee},get SUPPORT_FOREIGNOBJECT_DRAWING(){var ee="function"==typeof Array.from&&"function"==typeof window.fetch?function(ee){var X=ee.createElement("canvas"),ae=100;X.width=ae,X.height=ae;var oe=X.getContext("2d");if(!oe)return Promise.reject(!1);oe.fillStyle="rgb(0, 255, 0)",oe.fillRect(0,0,ae,ae);var Ve=new Image,ft=X.toDataURL();Ve.src=ft;var kt=n_(ae,ae,0,0,Ve);return oe.fillStyle="red",oe.fillRect(0,0,ae,ae),i_(kt).then(function(an){oe.drawImage(an,0,0);var sn=oe.getImageData(0,0,ae,ae).data;oe.fillStyle="red",oe.fillRect(0,0,ae,ae);var Yn=ee.createElement("div");return Yn.style.backgroundImage="url("+ft+")",Yn.style.height="100px",Lu(sn)?i_(n_(ae,ae,0,0,Yn)):Promise.reject(!1)}).then(function(an){return oe.drawImage(an,0,0),Lu(oe.getImageData(0,0,ae,ae).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(Rc,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:ee}),ee},get SUPPORT_CORS_IMAGES(){var ee=typeof(new Image).crossOrigin<"u";return Object.defineProperty(Rc,"SUPPORT_CORS_IMAGES",{value:ee}),ee},get SUPPORT_RESPONSE_TYPE(){var ee="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(Rc,"SUPPORT_RESPONSE_TYPE",{value:ee}),ee},get SUPPORT_CORS_XHR(){var ee="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Rc,"SUPPORT_CORS_XHR",{value:ee}),ee},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var ee=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Rc,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:ee}),ee}},pf=function(){return function ee(X,ae){this.text=X,this.bounds=ae}}(),op=function(ee,X){var ae=X.ownerDocument;if(ae){var oe=ae.createElement("html2canvaswrapper");oe.appendChild(X.cloneNode(!0));var Ve=X.parentNode;if(Ve){Ve.replaceChild(oe,X);var ft=et(ee,oe);return oe.firstChild&&Ve.replaceChild(oe.firstChild,oe),ft}}return xe.EMPTY},Vg=function(ee,X,ae){var oe=ee.ownerDocument;if(!oe)throw new Error("Node has no owner document");var Ve=oe.createRange();return Ve.setStart(ee,X),Ve.setEnd(ee,X+ae),Ve},Rh=function(ee){if(Rc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var X=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(X.segment(ee)).map(function(ae){return ae.segment})}return function(ee){for(var oe,X=Lm(ee),ae=[];!(oe=X.next()).done;)oe.value&&ae.push(oe.value.slice());return ae}(ee)},k1=function(ee,X){return 0!==X.letterSpacing?Rh(ee):function(ee,X){if(Rc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var ae=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(ae.segment(ee)).map(function(oe){return oe.segment})}return $a(ee,X)}(ee,X)},Vx=[32,160,4961,65792,65793,4153,4241],$a=function(ee,X){for(var Ve,ae=function(ee,X){var ae=Xe(ee),oe=Ae(ae,X),Ve=oe[0],ft=oe[1],kt=oe[2],an=ae.length,sn=0,Yn=0;return{next:function(){if(Yn>=an)return{done:!0,value:null};for(var ni=jt;Yn<an&&(ni=Z(ae,ft,Ve,++Yn,kt))===jt;);if(ni!==jt||Yn===an){var ii=new Ce(ae,ni,sn,Yn);return sn=Yn,{value:ii,done:!1}}return{done:!0,value:null}}}}(ee,{lineBreak:X.lineBreak,wordBreak:"break-word"===X.overflowWrap?"break-word":X.wordBreak}),oe=[],ft=function(){if(Ve.value){var kt=Ve.value.slice(),an=Xe(kt),sn="";an.forEach(function(Yn){-1===Vx.indexOf(Yn)?sn+=ot(Yn):(sn.length&&oe.push(sn),oe.push(ot(Yn)),sn="")}),sn.length&&oe.push(sn)}};!(Ve=ae.next()).done;)ft();return oe},Av=function(){return function ee(X,ae,oe){this.text=NA(ae.data,oe.textTransform),this.textBounds=function(ee,X,ae,oe){var Ve=k1(X,ae),ft=[],kt=0;return Ve.forEach(function(an){if(ae.textDecorationLine.length||an.trim().length>0)if(Rc.SUPPORT_RANGE_BOUNDS){var sn=Vg(oe,kt,an.length).getClientRects();if(sn.length>1){var Yn=Rh(an),ni=0;Yn.forEach(function(Gi){ft.push(new pf(Gi,xe.fromDOMRectList(ee,Vg(oe,ni+kt,Gi.length).getClientRects()))),ni+=Gi.length})}else ft.push(new pf(an,xe.fromDOMRectList(ee,sn)))}else{var ii=oe.splitText(an.length);ft.push(new pf(an,op(ee,oe))),oe=ii}else Rc.SUPPORT_RANGE_BOUNDS||(oe=oe.splitText(an.length));kt+=an.length}),ft}(X,this.text,oe,ae)}}(),NA=function(ee,X){switch(X){case 1:return ee.toLowerCase();case 3:return ee.replace(Um,zm);case 2:return ee.toUpperCase();default:return ee}},Um=/(^|\s|:|-|\(|\))([a-z])/g,zm=function(ee,X,ae){return ee.length>0?X+ae.toUpperCase():ee},F1=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve.src=oe.currentSrc||oe.src,Ve.intrinsicWidth=oe.naturalWidth,Ve.intrinsicHeight=oe.naturalHeight,Ve.context.cache.addImage(Ve.src),Ve}return Ee(X,ee),X}(Al),O1=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve.canvas=oe,Ve.intrinsicWidth=oe.width,Ve.intrinsicHeight=oe.height,Ve}return Ee(X,ee),X}(Al),L1=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this,ft=new XMLSerializer,kt=et(ae,oe);return oe.setAttribute("width",kt.width+"px"),oe.setAttribute("height",kt.height+"px"),Ve.svg="data:image/svg+xml,"+encodeURIComponent(ft.serializeToString(oe)),Ve.intrinsicWidth=oe.width.baseVal.value,Ve.intrinsicHeight=oe.height.baseVal.value,Ve.context.cache.addImage(Ve.svg),Ve}return Ee(X,ee),X}(Al),N1=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve.value=oe.value,Ve}return Ee(X,ee),X}(Al),Gg=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve.start=oe.start,Ve.reversed="boolean"==typeof oe.reversed&&!0===oe.reversed,Ve}return Ee(X,ee),X}(Al),qi=[{type:15,flags:0,unit:"px",number:3}],ma=[{type:16,flags:0,number:50}],Ua="checkbox",UA="radio",Hm="password",lh=707406591,zA=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;switch(Ve.type=oe.type.toLowerCase(),Ve.checked=oe.checked,Ve.value=function(ee){var X=ee.type===Hm?new Array(ee.value.length+1).join("\u2022"):ee.value;return 0===X.length?ee.placeholder||"":X}(oe),(Ve.type===Ua||Ve.type===UA)&&(Ve.styles.backgroundColor=3739148031,Ve.styles.borderTopColor=Ve.styles.borderRightColor=Ve.styles.borderBottomColor=Ve.styles.borderLeftColor=2779096575,Ve.styles.borderTopWidth=Ve.styles.borderRightWidth=Ve.styles.borderBottomWidth=Ve.styles.borderLeftWidth=1,Ve.styles.borderTopStyle=Ve.styles.borderRightStyle=Ve.styles.borderBottomStyle=Ve.styles.borderLeftStyle=1,Ve.styles.backgroundClip=[0],Ve.styles.backgroundOrigin=[0],Ve.bounds=function(ee){return ee.width>ee.height?new xe(ee.left+(ee.width-ee.height)/2,ee.top,ee.height,ee.height):ee.width<ee.height?new xe(ee.left,ee.top+(ee.height-ee.width)/2,ee.width,ee.width):ee}(Ve.bounds)),Ve.type){case Ua:Ve.styles.borderTopRightRadius=Ve.styles.borderTopLeftRadius=Ve.styles.borderBottomRightRadius=Ve.styles.borderBottomLeftRadius=qi;break;case UA:Ve.styles.borderTopRightRadius=Ve.styles.borderTopLeftRadius=Ve.styles.borderBottomRightRadius=Ve.styles.borderBottomLeftRadius=ma}return Ve}return Ee(X,ee),X}(Al),qg=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this,ft=oe.options[oe.selectedIndex||0];return Ve.value=ft&&ft.text||"",Ve}return Ee(X,ee),X}(Al),U1=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve.value=oe.value,Ve}return Ee(X,ee),X}(Al),gv=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;Ve.src=oe.src,Ve.width=parseInt(oe.width,10)||0,Ve.height=parseInt(oe.height,10)||0,Ve.backgroundColor=Ve.styles.backgroundColor;try{if(oe.contentWindow&&oe.contentWindow.document&&oe.contentWindow.document.documentElement){Ve.tree=r_(ae,oe.contentWindow.document.documentElement);var ft=oe.contentWindow.document.documentElement?Ch(ae,getComputedStyle(oe.contentWindow.document.documentElement).backgroundColor):Zc.TRANSPARENT,kt=oe.contentWindow.document.body?Ch(ae,getComputedStyle(oe.contentWindow.document.body).backgroundColor):Zc.TRANSPARENT;Ve.backgroundColor=eh(ft)?eh(kt)?Ve.styles.backgroundColor:kt:ft}}catch{}return Ve}return Ee(X,ee),X}(Al),z1=["OL","UL","MENU"],qc=function(ee,X,ae,oe){for(var Ve=X.firstChild,ft=void 0;Ve;Ve=ft)if(ft=Ve.nextSibling,s_(Ve)&&Ve.data.trim().length>0)ae.textNodes.push(new Av(ee,Ve,ae.styles));else if(Xp(Ve))if(ap(Ve)&&Ve.assignedNodes)Ve.assignedNodes().forEach(function(an){return qc(ee,an,ae,oe)});else{var kt=ch(ee,Ve);kt.styles.isVisible()&&(dh(Ve,kt,oe)?kt.flags|=4:mf(kt.styles)&&(kt.flags|=2),-1!==z1.indexOf(Ve.tagName)&&(kt.flags|=8),ae.elements.push(kt),Ve.shadowRoot?qc(ee,Ve.shadowRoot,kt,oe):!VA(Ve)&&!H1(Ve)&&!kc(Ve)&&qc(ee,Ve,kt,oe))}},ch=function(ee,X){return $g(X)?new F1(ee,X):jg(X)?new O1(ee,X):H1(X)?new L1(ee,X):a_(X)?new N1(ee,X):l_(X)?new Gg(ee,X):c_(X)?new zA(ee,X):kc(X)?new qg(ee,X):VA(X)?new U1(ee,X):u_(X)?new gv(ee,X):new Al(ee,X)},r_=function(ee,X){var ae=ch(ee,X);return ae.flags|=4,qc(ee,X,ae,ae),ae},dh=function(ee,X,ae){return X.styles.isPositionedWithZIndex()||X.styles.opacity<1||X.styles.isTransformed()||Wg(ee)&&ae.styles.isTransparent()},mf=function(ee){return ee.isPositioned()||ee.isFloating()},s_=function(ee){return ee.nodeType===Node.TEXT_NODE},Xp=function(ee){return ee.nodeType===Node.ELEMENT_NODE},o_=function(ee){return Xp(ee)&&typeof ee.style<"u"&&!Qg(ee)},Qg=function(ee){return"object"==typeof ee.className},a_=function(ee){return"LI"===ee.tagName},l_=function(ee){return"OL"===ee.tagName},c_=function(ee){return"INPUT"===ee.tagName},H1=function(ee){return"svg"===ee.tagName},Wg=function(ee){return"BODY"===ee.tagName},jg=function(ee){return"CANVAS"===ee.tagName},d_=function(ee){return"VIDEO"===ee.tagName},$g=function(ee){return"IMG"===ee.tagName},u_=function(ee){return"IFRAME"===ee.tagName},h_=function(ee){return"STYLE"===ee.tagName},VA=function(ee){return"TEXTAREA"===ee.tagName},kc=function(ee){return"SELECT"===ee.tagName},ap=function(ee){return"SLOT"===ee.tagName},_l=function(ee){return ee.tagName.indexOf("-")>0},Ul=function(){function ee(){this.counters={}}return ee.prototype.getCounterValue=function(X){var ae=this.counters[X];return ae&&ae.length?ae[ae.length-1]:1},ee.prototype.getCounterValues=function(X){return this.counters[X]||[]},ee.prototype.pop=function(X){var ae=this;X.forEach(function(oe){return ae.counters[oe].pop()})},ee.prototype.parse=function(X){var ae=this,oe=X.counterIncrement,Ve=X.counterReset,ft=!0;null!==oe&&oe.forEach(function(an){var sn=ae.counters[an.counter];sn&&0!==an.increment&&(ft=!1,sn.length||sn.push(1),sn[Math.max(0,sn.length-1)]+=an.increment)});var kt=[];return ft&&Ve.forEach(function(an){var sn=ae.counters[an.counter];kt.push(an.counter),sn||(sn=ae.counters[an.counter]=[]),sn.push(an.reset)}),kt},ee}(),V1={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},kh={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054f","\u054e","\u054d","\u054c","\u054b","\u054a","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053f","\u053e","\u053d","\u053c","\u053b","\u053a","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},_v={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05d9\u05f3","\u05d8\u05f3","\u05d7\u05f3","\u05d6\u05f3","\u05d5\u05f3","\u05d4\u05f3","\u05d3\u05f3","\u05d2\u05f3","\u05d1\u05f3","\u05d0\u05f3","\u05ea","\u05e9","\u05e8","\u05e7","\u05e6","\u05e4","\u05e2","\u05e1","\u05e0","\u05de","\u05dc","\u05db","\u05d9\u05d8","\u05d9\u05d7","\u05d9\u05d6","\u05d8\u05d6","\u05d8\u05d5","\u05d9","\u05d8","\u05d7","\u05d6","\u05d5","\u05d4","\u05d3","\u05d2","\u05d1","\u05d0"]},G1={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10f5","\u10f0","\u10ef","\u10f4","\u10ee","\u10ed","\u10ec","\u10eb","\u10ea","\u10e9","\u10e8","\u10e7","\u10e6","\u10e5","\u10e4","\u10f3","\u10e2","\u10e1","\u10e0","\u10df","\u10de","\u10dd","\u10f2","\u10dc","\u10db","\u10da","\u10d9","\u10d8","\u10d7","\u10f1","\u10d6","\u10d5","\u10d4","\u10d3","\u10d2","\u10d1","\u10d0"]},Yp=function(ee,X,ae,oe,Ve,ft){return ee<X||ee>ae?Gm(ee,Ve,ft.length>0):oe.integers.reduce(function(kt,an,sn){for(;ee>=an;)ee-=an,kt+=oe.values[sn];return kt},"")+ft},Vm=function(ee,X,ae,oe){var Ve="";do{ae||ee--,Ve=oe(ee)+Ve,ee/=X}while(ee*X>=X);return Ve},Ja=function(ee,X,ae,oe,Ve){var ft=ae-X+1;return(ee<0?"-":"")+(Vm(Math.abs(ee),ft,oe,function(kt){return ot(Math.floor(kt%ft)+X)})+Ve)},Kp=function(ee,X,ae){void 0===ae&&(ae=". ");var oe=X.length;return Vm(Math.abs(ee),oe,!1,function(Ve){return X[Math.floor(Ve%oe)]})+ae},Fh=function(ee,X,ae,oe,Ve,ft){if(ee<-9999||ee>9999)return Gm(ee,4,Ve.length>0);var kt=Math.abs(ee),an=Ve;if(0===kt)return X[0]+an;for(var sn=0;kt>0&&sn<=4;sn++){var Yn=kt%10;0===Yn&&ko(ft,1)&&""!==an?an=X[Yn]+an:Yn>1||1===Yn&&0===sn||1===Yn&&1===sn&&ko(ft,2)||1===Yn&&1===sn&&ko(ft,4)&&ee>100||1===Yn&&sn>1&&ko(ft,8)?an=X[Yn]+(sn>0?ae[sn-1]:"")+an:1===Yn&&sn>0&&(an=ae[sn-1]+an),kt=Math.floor(kt/10)}return(ee<0?oe:"")+an},cp="\ub9c8\uc774\ub108\uc2a4",Gm=function(ee,X,ae){var oe=ae?". ":"",Ve=ae?"\u3001":"",ft=ae?", ":"",kt=ae?" ":"";switch(X){case 0:return"\u2022"+kt;case 1:return"\u25e6"+kt;case 2:return"\u25fe"+kt;case 5:var an=Ja(ee,48,57,!0,oe);return an.length<4?"0"+an:an;case 4:return Kp(ee,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d",Ve);case 6:return Yp(ee,1,3999,V1,3,oe).toLowerCase();case 7:return Yp(ee,1,3999,V1,3,oe);case 8:return Ja(ee,945,969,!1,oe);case 9:return Ja(ee,97,122,!1,oe);case 10:return Ja(ee,65,90,!1,oe);case 11:return Ja(ee,1632,1641,!0,oe);case 12:case 49:return Yp(ee,1,9999,kh,3,oe);case 35:return Yp(ee,1,9999,kh,3,oe).toLowerCase();case 13:return Ja(ee,2534,2543,!0,oe);case 14:case 30:return Ja(ee,6112,6121,!0,oe);case 15:return Kp(ee,"\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\u7533\u9149\u620c\u4ea5",Ve);case 16:return Kp(ee,"\u7532\u4e59\u4e19\u4e01\u620a\u5df1\u5e9a\u8f9b\u58ec\u7678",Ve);case 17:case 48:return Fh(ee,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8ca0",Ve,14);case 47:return Fh(ee,"\u96f6\u58f9\u8cb3\u53c3\u8086\u4f0d\u9678\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8ca0",Ve,15);case 42:return Fh(ee,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8d1f",Ve,14);case 41:return Fh(ee,"\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8d1f",Ve,15);case 26:return Fh(ee,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",Ve,0);case 25:return Fh(ee,"\u96f6\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",Ve,7);case 31:return Fh(ee,"\uc601\uc77c\uc774\uc0bc\uc0ac\uc624\uc721\uce60\ud314\uad6c","\uc2ed\ubc31\ucc9c\ub9cc",cp,ft,7);case 33:return Fh(ee,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c",cp,ft,0);case 32:return Fh(ee,"\u96f6\u58f9\u8cb3\u53c3\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343",cp,ft,7);case 18:return Ja(ee,2406,2415,!0,oe);case 20:return Yp(ee,1,19999,G1,3,oe);case 21:return Ja(ee,2790,2799,!0,oe);case 22:return Ja(ee,2662,2671,!0,oe);case 22:return Yp(ee,1,10999,_v,3,oe);case 23:return Kp(ee,"\u3042\u3044\u3046\u3048\u304a\u304b\u304d\u304f\u3051\u3053\u3055\u3057\u3059\u305b\u305d\u305f\u3061\u3064\u3066\u3068\u306a\u306b\u306c\u306d\u306e\u306f\u3072\u3075\u3078\u307b\u307e\u307f\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308a\u308b\u308c\u308d\u308f\u3090\u3091\u3092\u3093");case 24:return Kp(ee,"\u3044\u308d\u306f\u306b\u307b\u3078\u3068\u3061\u308a\u306c\u308b\u3092\u308f\u304b\u3088\u305f\u308c\u305d\u3064\u306d\u306a\u3089\u3080\u3046\u3090\u306e\u304a\u304f\u3084\u307e\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304d\u3086\u3081\u307f\u3057\u3091\u3072\u3082\u305b\u3059");case 27:return Ja(ee,3302,3311,!0,oe);case 28:return Kp(ee,"\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f0\u30f1\u30f2\u30f3",Ve);case 29:return Kp(ee,"\u30a4\u30ed\u30cf\u30cb\u30db\u30d8\u30c8\u30c1\u30ea\u30cc\u30eb\u30f2\u30ef\u30ab\u30e8\u30bf\u30ec\u30bd\u30c4\u30cd\u30ca\u30e9\u30e0\u30a6\u30f0\u30ce\u30aa\u30af\u30e4\u30de\u30b1\u30d5\u30b3\u30a8\u30c6\u30a2\u30b5\u30ad\u30e6\u30e1\u30df\u30b7\u30f1\u30d2\u30e2\u30bb\u30b9",Ve);case 34:return Ja(ee,3792,3801,!0,oe);case 37:return Ja(ee,6160,6169,!0,oe);case 38:return Ja(ee,4160,4169,!0,oe);case 39:return Ja(ee,2918,2927,!0,oe);case 40:return Ja(ee,1776,1785,!0,oe);case 43:return Ja(ee,3046,3055,!0,oe);case 44:return Ja(ee,3174,3183,!0,oe);case 45:return Ja(ee,3664,3673,!0,oe);case 46:return Ja(ee,3872,3881,!0,oe);default:return Ja(ee,48,57,!0,oe)}},gf="data-html2canvas-ignore",Xg=function(){function ee(X,ae,oe){if(this.context=X,this.options=oe,this.scrolledElements=[],this.referenceElement=ae,this.counters=new Ul,this.quoteDepth=0,!ae.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(ae.ownerDocument.documentElement,!1)}return ee.prototype.toIFrame=function(X,ae){var oe=this,Ve=Kg(X,ae);if(!Ve.contentWindow)return Promise.reject("Unable to find iframe window");var ft=X.defaultView.pageXOffset,kt=X.defaultView.pageYOffset,an=Ve.contentWindow,sn=an.document,Yn=Zg(Ve).then(function(){return b(oe,void 0,void 0,function(){var ni,ii;return z(this,function(Gi){switch(Gi.label){case 0:return this.scrolledElements.forEach(A_),an&&(an.scrollTo(ae.left,ae.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(an.scrollY!==ae.top||an.scrollX!==ae.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(an.scrollX-ae.left,an.scrollY-ae.top,0,0))),ni=this.options.onclone,typeof(ii=this.clonedReferenceElement)>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:sn.fonts&&sn.fonts.ready?[4,sn.fonts.ready]:[3,2];case 1:Gi.sent(),Gi.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Gx(sn)]:[3,4];case 3:Gi.sent(),Gi.label=4;case 4:return"function"==typeof ni?[2,Promise.resolve().then(function(){return ni(sn,ii)}).then(function(){return Ve})]:[2,Ve]}})})});return sn.open(),sn.write(Jg(document.doctype)+"<html></html>"),m_(this.referenceElement.ownerDocument,ft,kt),sn.replaceChild(sn.adoptNode(this.documentElement),sn.documentElement),sn.close(),Yn},ee.prototype.createElementClone=function(X){if(Bc(X,2),jg(X))return this.createCanvasClone(X);if(d_(X))return this.createVideoClone(X);if(h_(X))return this.createStyleClone(X);var ae=X.cloneNode(!1);return $g(ae)&&($g(X)&&X.currentSrc&&X.currentSrc!==X.src&&(ae.src=X.currentSrc,ae.srcset=""),"lazy"===ae.loading&&(ae.loading="eager")),_l(ae)?this.createCustomElementClone(ae):ae},ee.prototype.createCustomElementClone=function(X){var ae=document.createElement("html2canvascustomelement");return Q1(X.style,ae),ae},ee.prototype.createStyleClone=function(X){try{var ae=X.sheet;if(ae&&ae.cssRules){var oe=[].slice.call(ae.cssRules,0).reduce(function(ft,kt){return kt&&"string"==typeof kt.cssText?ft+kt.cssText:ft},""),Ve=X.cloneNode(!1);return Ve.textContent=oe,Ve}}catch(ft){if(this.context.logger.error("Unable to access cssRules property",ft),"SecurityError"!==ft.name)throw ft}return X.cloneNode(!1)},ee.prototype.createCanvasClone=function(X){var ae;if(this.options.inlineImages&&X.ownerDocument){var oe=X.ownerDocument.createElement("img");try{return oe.src=X.toDataURL(),oe}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",X)}}var Ve=X.cloneNode(!1);try{Ve.width=X.width,Ve.height=X.height;var ft=X.getContext("2d"),kt=Ve.getContext("2d");if(kt)if(!this.options.allowTaint&&ft)kt.putImageData(ft.getImageData(0,0,X.width,X.height),0,0);else{var an=null!==(ae=X.getContext("webgl2"))&&void 0!==ae?ae:X.getContext("webgl");if(an){var sn=an.getContextAttributes();!1===sn?.preserveDrawingBuffer&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",X)}kt.drawImage(X,0,0)}return Ve}catch{this.context.logger.info("Unable to clone canvas as it is tainted",X)}return Ve},ee.prototype.createVideoClone=function(X){var ae=X.ownerDocument.createElement("canvas");ae.width=X.offsetWidth,ae.height=X.offsetHeight;var oe=ae.getContext("2d");try{return oe&&(oe.drawImage(X,0,0,ae.width,ae.height),this.options.allowTaint||oe.getImageData(0,0,ae.width,ae.height)),ae}catch{this.context.logger.info("Unable to clone video as it is tainted",X)}var Ve=X.ownerDocument.createElement("canvas");return Ve.width=X.offsetWidth,Ve.height=X.offsetHeight,Ve},ee.prototype.appendChildNode=function(X,ae,oe){(!Xp(ae)||!function(ee){return"SCRIPT"===ee.tagName}(ae)&&!ae.hasAttribute(gf)&&("function"!=typeof this.options.ignoreElements||!this.options.ignoreElements(ae)))&&(!this.options.copyStyles||!Xp(ae)||!h_(ae))&&X.appendChild(this.cloneNode(ae,oe))},ee.prototype.cloneChildNodes=function(X,ae,oe){for(var Ve=this,ft=X.shadowRoot?X.shadowRoot.firstChild:X.firstChild;ft;ft=ft.nextSibling)if(Xp(ft)&&ap(ft)&&"function"==typeof ft.assignedNodes){var kt=ft.assignedNodes();kt.length&&kt.forEach(function(an){return Ve.appendChildNode(ae,an,oe)})}else this.appendChildNode(ae,ft,oe)},ee.prototype.cloneNode=function(X,ae){if(s_(X))return document.createTextNode(X.data);if(!X.ownerDocument)return X.cloneNode(!1);var oe=X.ownerDocument.defaultView;if(oe&&Xp(X)&&(o_(X)||Qg(X))){var Ve=this.createElementClone(X);Ve.style.transitionProperty="none";var ft=oe.getComputedStyle(X),kt=oe.getComputedStyle(X,":before"),an=oe.getComputedStyle(X,":after");this.referenceElement===X&&o_(Ve)&&(this.clonedReferenceElement=Ve),Wg(Ve)&&oM(Ve);var sn=this.counters.parse(new Ic(this.context,ft)),Yn=this.resolvePseudoContent(X,Ve,kt,Yg.BEFORE);_l(X)&&(ae=!0),d_(X)||this.cloneChildNodes(X,Ve,ae),Yn&&Ve.insertBefore(Yn,Ve.firstChild);var ni=this.resolvePseudoContent(X,Ve,an,Yg.AFTER);return ni&&Ve.appendChild(ni),this.counters.pop(sn),(ft&&(this.options.copyStyles||Qg(X))&&!u_(X)||ae)&&Q1(ft,Ve),(0!==X.scrollTop||0!==X.scrollLeft)&&this.scrolledElements.push([Ve,X.scrollLeft,X.scrollTop]),(VA(X)||kc(X))&&(VA(Ve)||kc(Ve))&&(Ve.value=X.value),Ve}return X.cloneNode(!1)},ee.prototype.resolvePseudoContent=function(X,ae,oe,Ve){var ft=this;if(oe){var kt=oe.content,an=ae.ownerDocument;if(an&&kt&&"none"!==kt&&"-moz-alt-content"!==kt&&"none"!==oe.display){this.counters.parse(new Ic(this.context,oe));var sn=new rh(this.context,oe),Yn=an.createElement("html2canvaspseudoelement");Q1(oe,Yn),sn.content.forEach(function(ii){if(0===ii.type)Yn.appendChild(an.createTextNode(ii.value));else if(22===ii.type){var Gi=an.createElement("img");Gi.src=ii.value,Gi.style.opacity="1",Yn.appendChild(Gi)}else if(18===ii.type){if("attr"===ii.name){var ms=ii.values.filter(li);ms.length&&Yn.appendChild(an.createTextNode(X.getAttribute(ms[0].value)||""))}else if("counter"===ii.name){var Pr=ii.values.filter(Bu),Do=Pr[1];if((Dr=Pr[0])&&li(Dr)){var Fs=ft.counters.getCounterValue(Dr.value),Ms=Do&&li(Do)?Og.parse(ft.context,Do.value):3;Yn.appendChild(an.createTextNode(Gm(Fs,Ms,!1)))}}else if("counters"===ii.name){var Dr,za=ii.values.filter(Bu),qo=za[1];if(Do=za[2],(Dr=za[0])&&li(Dr)){var Co=ft.counters.getCounterValues(Dr.value),hs=Do&&li(Do)?Og.parse(ft.context,Do.value):3,Ta=qo&&0===qo.type?qo.value:"",ba=Co.map(function(Xa){return Gm(Xa,hs,!1)}).join(Ta);Yn.appendChild(an.createTextNode(ba))}}}else if(20===ii.type)switch(ii.value){case"open-quote":Yn.appendChild(an.createTextNode(ac(sn.quotes,ft.quoteDepth++,!0)));break;case"close-quote":Yn.appendChild(an.createTextNode(ac(sn.quotes,--ft.quoteDepth,!1)));break;default:Yn.appendChild(an.createTextNode(ii.value))}}),Yn.className=g_+" "+e0;var ni=Ve===Yg.BEFORE?" "+g_:" "+e0;return Qg(ae)?ae.className.baseValue+=ni:ae.className+=ni,Yn}}},ee.destroy=function(X){return!!X.parentNode&&(X.parentNode.removeChild(X),!0)},ee}(),Yg=function(ee){return ee[ee.BEFORE=0]="BEFORE",ee[ee.AFTER=1]="AFTER",ee}(Yg||{}),Kg=function(ee,X){var ae=ee.createElement("iframe");return ae.className="html2canvas-container",ae.style.visibility="hidden",ae.style.position="fixed",ae.style.left="-10000px",ae.style.top="0px",ae.style.border="0",ae.width=X.width.toString(),ae.height=X.height.toString(),ae.scrolling="no",ae.setAttribute(gf,"true"),ee.body.appendChild(ae),ae},yv=function(ee){return new Promise(function(X){ee.complete?X():ee.src?(ee.onload=X,ee.onerror=X):X()})},Gx=function(ee){return Promise.all([].slice.call(ee.images,0).map(yv))},Zg=function(ee){return new Promise(function(X,ae){var oe=ee.contentWindow;if(!oe)return ae("No window assigned for iframe");var Ve=oe.document;oe.onload=ee.onload=function(){oe.onload=ee.onload=null;var ft=setInterval(function(){Ve.body.childNodes.length>0&&"complete"===Ve.readyState&&(clearInterval(ft),X(ee))},50)}})},GA=["all","d","content"],Q1=function(ee,X){for(var ae=ee.length-1;ae>=0;ae--){var oe=ee.item(ae);-1===GA.indexOf(oe)&&X.style.setProperty(oe,ee.getPropertyValue(oe))}return X},Jg=function(ee){var X="";return ee&&(X+="<!DOCTYPE ",ee.name&&(X+=ee.name),ee.internalSubset&&(X+=ee.internalSubset),ee.publicId&&(X+='"'+ee.publicId+'"'),ee.systemId&&(X+='"'+ee.systemId+'"'),X+=">"),X},m_=function(ee,X,ae){ee&&ee.defaultView&&(X!==ee.defaultView.pageXOffset||ae!==ee.defaultView.pageYOffset)&&ee.defaultView.scrollTo(X,ae)},A_=function(ee){var X=ee[0],oe=ee[2];X.scrollLeft=ee[1],X.scrollTop=oe},g_="___html2canvas___pseudoelement_before",e0="___html2canvas___pseudoelement_after",Oh='{\n    content: "" !important;\n    display: none !important;\n}',oM=function(ee){qm(ee,"."+g_+":before"+Oh+"\n         ."+e0+":after"+Oh)},qm=function(ee,X){var ae=ee.ownerDocument;if(ae){var oe=ae.createElement("style");oe.textContent=X,ee.appendChild(oe)}},Lh=function(){function ee(){}return ee.getOrigin=function(X){var ae=ee._link;return ae?(ae.href=X,ae.href=ae.href,ae.protocol+ae.hostname+ae.port):"about:blank"},ee.isSameOrigin=function(X){return ee.getOrigin(X)===ee._origin},ee.setContext=function(X){ee._link=X.document.createElement("a"),ee._origin=ee.getOrigin(X.location.href)},ee._origin="about:blank",ee}(),vv=function(){function ee(X,ae){this.context=X,this._options=ae,this._cache={}}return ee.prototype.addImage=function(X){var ae=Promise.resolve();return this.has(X)||(v_(X)||qx(X))&&(this._cache[X]=this.loadImage(X)).catch(function(){}),ae},ee.prototype.match=function(X){return this._cache[X]},ee.prototype.loadImage=function(X){return b(this,void 0,void 0,function(){var ae,oe,Ve,ft,kt=this;return z(this,function(an){switch(an.label){case 0:return ae=Lh.isSameOrigin(X),oe=!y_(X)&&!0===this._options.useCORS&&Rc.SUPPORT_CORS_IMAGES&&!ae,Ve=!y_(X)&&!ae&&!v_(X)&&"string"==typeof this._options.proxy&&Rc.SUPPORT_CORS_XHR&&!oe,ae||!1!==this._options.allowTaint||y_(X)||v_(X)||Ve||oe?(ft=X,Ve?[4,this.proxy(ft)]:[3,2]):[2];case 1:ft=an.sent(),an.label=2;case 2:return this.context.logger.debug("Added image "+X.substring(0,256)),[4,new Promise(function(sn,Yn){var ni=new Image;ni.onload=function(){return sn(ni)},ni.onerror=Yn,(t0(ft)||oe)&&(ni.crossOrigin="anonymous"),ni.src=ft,!0===ni.complete&&setTimeout(function(){return sn(ni)},500),kt._options.imageTimeout>0&&setTimeout(function(){return Yn("Timed out ("+kt._options.imageTimeout+"ms) loading image")},kt._options.imageTimeout)})];case 3:return[2,an.sent()]}})})},ee.prototype.has=function(X){return typeof this._cache[X]<"u"},ee.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},ee.prototype.proxy=function(X){var ae=this,oe=this._options.proxy;if(!oe)throw new Error("No proxy defined");var Ve=X.substring(0,256);return new Promise(function(ft,kt){var an=Rc.SUPPORT_RESPONSE_TYPE?"blob":"text",sn=new XMLHttpRequest;sn.onload=function(){if(200===sn.status)if("text"===an)ft(sn.response);else{var ii=new FileReader;ii.addEventListener("load",function(){return ft(ii.result)},!1),ii.addEventListener("error",function(Gi){return kt(Gi)},!1),ii.readAsDataURL(sn.response)}else kt("Failed to proxy resource "+Ve+" with status code "+sn.status)},sn.onerror=kt;var Yn=oe.indexOf("?")>-1?"&":"?";if(sn.open("GET",""+oe+Yn+"url="+encodeURIComponent(X)+"&responseType="+an),"text"!==an&&sn instanceof XMLHttpRequest&&(sn.responseType=an),ae._options.imageTimeout){var ni=ae._options.imageTimeout;sn.timeout=ni,sn.ontimeout=function(){return kt("Timed out ("+ni+"ms) proxying "+Ve)}}sn.send()})},ee}(),__=/^data:image\/svg\+xml/i,j1=/^data:image\/.*;base64,/i,bv=/^data:image\/.*/i,qx=function(ee){return Rc.SUPPORT_SVG_DRAWING||!Qx(ee)},y_=function(ee){return bv.test(ee)},t0=function(ee){return j1.test(ee)},v_=function(ee){return"blob"===ee.substr(0,4)},Qx=function(ee){return"svg"===ee.substr(-3).toLowerCase()||__.test(ee)},as=function(){function ee(X,ae){this.type=0,this.x=X,this.y=ae}return ee.prototype.add=function(X,ae){return new ee(this.x+X,this.y+ae)},ee}(),Nu=function(ee,X,ae){return new as(ee.x+(X.x-ee.x)*ae,ee.y+(X.y-ee.y)*ae)},$1=function(){function ee(X,ae,oe,Ve){this.type=1,this.start=X,this.startControl=ae,this.endControl=oe,this.end=Ve}return ee.prototype.subdivide=function(X,ae){var oe=Nu(this.start,this.startControl,X),Ve=Nu(this.startControl,this.endControl,X),ft=Nu(this.endControl,this.end,X),kt=Nu(oe,Ve,X),an=Nu(Ve,ft,X),sn=Nu(kt,an,X);return ae?new ee(this.start,oe,kt,sn):new ee(sn,an,ft,this.end)},ee.prototype.add=function(X,ae){return new ee(this.start.add(X,ae),this.startControl.add(X,ae),this.endControl.add(X,ae),this.end.add(X,ae))},ee.prototype.reverse=function(){return new ee(this.end,this.endControl,this.startControl,this.start)},ee}(),Fc=function(ee){return 1===ee.type},X1=function(){return function ee(X){var ae=X.styles,oe=X.bounds,Ve=Em(ae.borderTopLeftRadius,oe.width,oe.height),ft=Ve[0],kt=Ve[1],an=Em(ae.borderTopRightRadius,oe.width,oe.height),sn=an[0],Yn=an[1],ni=Em(ae.borderBottomRightRadius,oe.width,oe.height),ii=ni[0],Gi=ni[1],ms=Em(ae.borderBottomLeftRadius,oe.width,oe.height),Pr=ms[0],Dr=ms[1],Do=[];Do.push((ft+sn)/oe.width),Do.push((Pr+ii)/oe.width),Do.push((kt+Dr)/oe.height),Do.push((Yn+Gi)/oe.height);var Fs=Math.max.apply(Math,Do);Fs>1&&(ft/=Fs,kt/=Fs,sn/=Fs,Yn/=Fs,ii/=Fs,Gi/=Fs,Pr/=Fs,Dr/=Fs);var Ms=oe.width-sn,za=oe.height-Gi,qo=oe.width-ii,Co=oe.height-Dr,hs=ae.borderTopWidth,Ta=ae.borderRightWidth,ba=ae.borderBottomWidth,So=ae.borderLeftWidth,Rl=Ko(ae.paddingTop,X.bounds.width),Xa=Ko(ae.paddingRight,X.bounds.width),el=Ko(ae.paddingBottom,X.bounds.width),Ya=Ko(ae.paddingLeft,X.bounds.width);this.topLeftBorderDoubleOuterBox=ft>0||kt>0?ka(oe.left+So/3,oe.top+hs/3,ft-So/3,kt-hs/3,wo.TOP_LEFT):new as(oe.left+So/3,oe.top+hs/3),this.topRightBorderDoubleOuterBox=ft>0||kt>0?ka(oe.left+Ms,oe.top+hs/3,sn-Ta/3,Yn-hs/3,wo.TOP_RIGHT):new as(oe.left+oe.width-Ta/3,oe.top+hs/3),this.bottomRightBorderDoubleOuterBox=ii>0||Gi>0?ka(oe.left+qo,oe.top+za,ii-Ta/3,Gi-ba/3,wo.BOTTOM_RIGHT):new as(oe.left+oe.width-Ta/3,oe.top+oe.height-ba/3),this.bottomLeftBorderDoubleOuterBox=Pr>0||Dr>0?ka(oe.left+So/3,oe.top+Co,Pr-So/3,Dr-ba/3,wo.BOTTOM_LEFT):new as(oe.left+So/3,oe.top+oe.height-ba/3),this.topLeftBorderDoubleInnerBox=ft>0||kt>0?ka(oe.left+2*So/3,oe.top+2*hs/3,ft-2*So/3,kt-2*hs/3,wo.TOP_LEFT):new as(oe.left+2*So/3,oe.top+2*hs/3),this.topRightBorderDoubleInnerBox=ft>0||kt>0?ka(oe.left+Ms,oe.top+2*hs/3,sn-2*Ta/3,Yn-2*hs/3,wo.TOP_RIGHT):new as(oe.left+oe.width-2*Ta/3,oe.top+2*hs/3),this.bottomRightBorderDoubleInnerBox=ii>0||Gi>0?ka(oe.left+qo,oe.top+za,ii-2*Ta/3,Gi-2*ba/3,wo.BOTTOM_RIGHT):new as(oe.left+oe.width-2*Ta/3,oe.top+oe.height-2*ba/3),this.bottomLeftBorderDoubleInnerBox=Pr>0||Dr>0?ka(oe.left+2*So/3,oe.top+Co,Pr-2*So/3,Dr-2*ba/3,wo.BOTTOM_LEFT):new as(oe.left+2*So/3,oe.top+oe.height-2*ba/3),this.topLeftBorderStroke=ft>0||kt>0?ka(oe.left+So/2,oe.top+hs/2,ft-So/2,kt-hs/2,wo.TOP_LEFT):new as(oe.left+So/2,oe.top+hs/2),this.topRightBorderStroke=ft>0||kt>0?ka(oe.left+Ms,oe.top+hs/2,sn-Ta/2,Yn-hs/2,wo.TOP_RIGHT):new as(oe.left+oe.width-Ta/2,oe.top+hs/2),this.bottomRightBorderStroke=ii>0||Gi>0?ka(oe.left+qo,oe.top+za,ii-Ta/2,Gi-ba/2,wo.BOTTOM_RIGHT):new as(oe.left+oe.width-Ta/2,oe.top+oe.height-ba/2),this.bottomLeftBorderStroke=Pr>0||Dr>0?ka(oe.left+So/2,oe.top+Co,Pr-So/2,Dr-ba/2,wo.BOTTOM_LEFT):new as(oe.left+So/2,oe.top+oe.height-ba/2),this.topLeftBorderBox=ft>0||kt>0?ka(oe.left,oe.top,ft,kt,wo.TOP_LEFT):new as(oe.left,oe.top),this.topRightBorderBox=sn>0||Yn>0?ka(oe.left+Ms,oe.top,sn,Yn,wo.TOP_RIGHT):new as(oe.left+oe.width,oe.top),this.bottomRightBorderBox=ii>0||Gi>0?ka(oe.left+qo,oe.top+za,ii,Gi,wo.BOTTOM_RIGHT):new as(oe.left+oe.width,oe.top+oe.height),this.bottomLeftBorderBox=Pr>0||Dr>0?ka(oe.left,oe.top+Co,Pr,Dr,wo.BOTTOM_LEFT):new as(oe.left,oe.top+oe.height),this.topLeftPaddingBox=ft>0||kt>0?ka(oe.left+So,oe.top+hs,Math.max(0,ft-So),Math.max(0,kt-hs),wo.TOP_LEFT):new as(oe.left+So,oe.top+hs),this.topRightPaddingBox=sn>0||Yn>0?ka(oe.left+Math.min(Ms,oe.width-Ta),oe.top+hs,Ms>oe.width+Ta?0:Math.max(0,sn-Ta),Math.max(0,Yn-hs),wo.TOP_RIGHT):new as(oe.left+oe.width-Ta,oe.top+hs),this.bottomRightPaddingBox=ii>0||Gi>0?ka(oe.left+Math.min(qo,oe.width-So),oe.top+Math.min(za,oe.height-ba),Math.max(0,ii-Ta),Math.max(0,Gi-ba),wo.BOTTOM_RIGHT):new as(oe.left+oe.width-Ta,oe.top+oe.height-ba),this.bottomLeftPaddingBox=Pr>0||Dr>0?ka(oe.left+So,oe.top+Math.min(Co,oe.height-ba),Math.max(0,Pr-So),Math.max(0,Dr-ba),wo.BOTTOM_LEFT):new as(oe.left+So,oe.top+oe.height-ba),this.topLeftContentBox=ft>0||kt>0?ka(oe.left+So+Ya,oe.top+hs+Rl,Math.max(0,ft-(So+Ya)),Math.max(0,kt-(hs+Rl)),wo.TOP_LEFT):new as(oe.left+So+Ya,oe.top+hs+Rl),this.topRightContentBox=sn>0||Yn>0?ka(oe.left+Math.min(Ms,oe.width+So+Ya),oe.top+hs+Rl,Ms>oe.width+So+Ya?0:sn-So+Ya,Yn-(hs+Rl),wo.TOP_RIGHT):new as(oe.left+oe.width-(Ta+Xa),oe.top+hs+Rl),this.bottomRightContentBox=ii>0||Gi>0?ka(oe.left+Math.min(qo,oe.width-(So+Ya)),oe.top+Math.min(za,oe.height+hs+Rl),Math.max(0,ii-(Ta+Xa)),Gi-(ba+el),wo.BOTTOM_RIGHT):new as(oe.left+oe.width-(Ta+Xa),oe.top+oe.height-(ba+el)),this.bottomLeftContentBox=Pr>0||Dr>0?ka(oe.left+So+Ya,oe.top+Co,Math.max(0,Pr-(So+Ya)),Dr-(ba+el),wo.BOTTOM_LEFT):new as(oe.left+So+Ya,oe.top+oe.height-(ba+el))}}(),wo=function(ee){return ee[ee.TOP_LEFT=0]="TOP_LEFT",ee[ee.TOP_RIGHT=1]="TOP_RIGHT",ee[ee.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",ee[ee.BOTTOM_LEFT=3]="BOTTOM_LEFT",ee}(wo||{}),ka=function(ee,X,ae,oe,Ve){var ft=(Math.sqrt(2)-1)/3*4,kt=ae*ft,an=oe*ft,sn=ee+ae,Yn=X+oe;switch(Ve){case wo.TOP_LEFT:return new $1(new as(ee,Yn),new as(ee,Yn-an),new as(sn-kt,X),new as(sn,X));case wo.TOP_RIGHT:return new $1(new as(ee,X),new as(ee+kt,X),new as(sn,Yn-an),new as(sn,Yn));case wo.BOTTOM_RIGHT:return new $1(new as(sn,X),new as(sn,X+an),new as(ee+kt,Yn),new as(ee,Yn));default:return new $1(new as(sn,Yn),new as(sn-kt,Yn),new as(ee,X+an),new as(ee,X))}},lc=function(ee){return[ee.topLeftBorderBox,ee.topRightBorderBox,ee.bottomRightBorderBox,ee.bottomLeftBorderBox]},Aa=function(ee){return[ee.topLeftPaddingBox,ee.topRightPaddingBox,ee.bottomRightPaddingBox,ee.bottomLeftPaddingBox]},Jp=function(){return function ee(X,ae,oe){this.offsetX=X,this.offsetY=ae,this.matrix=oe,this.type=0,this.target=6}}(),pd=function(){return function ee(X,ae){this.path=X,this.target=ae,this.type=1}}(),qA=function(){return function ee(X){this.opacity=X,this.type=2,this.target=6}}(),xv=function(ee){return 1===ee.type},n0=function(ee,X){return ee.length===X.length&&ee.some(function(ae,oe){return ae===X[oe]})},K1=function(){return function ee(X){this.element=X,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}(),$o=function(){function ee(X,ae){if(this.container=X,this.parent=ae,this.effects=[],this.curves=new X1(this.container),this.container.styles.opacity<1&&this.effects.push(new qA(this.container.styles.opacity)),null!==this.container.styles.transform&&this.effects.push(new Jp(this.container.bounds.left+this.container.styles.transformOrigin[0].number,this.container.bounds.top+this.container.styles.transformOrigin[1].number,this.container.styles.transform)),0!==this.container.styles.overflowX){var kt=lc(this.curves),an=Aa(this.curves);n0(kt,an)?this.effects.push(new pd(kt,6)):(this.effects.push(new pd(kt,2)),this.effects.push(new pd(an,4)))}}return ee.prototype.getEffects=function(X){for(var ae=-1===[2,3].indexOf(this.container.styles.position),oe=this.parent,Ve=this.effects.slice(0);oe;){var ft=oe.effects.filter(function(sn){return!xv(sn)});if(ae||0!==oe.container.styles.position||!oe.parent){if(Ve.unshift.apply(Ve,ft),ae=-1===[2,3].indexOf(oe.container.styles.position),0!==oe.container.styles.overflowX){var kt=lc(oe.curves),an=Aa(oe.curves);n0(kt,an)||Ve.unshift(new pd(an,6))}}else Ve.unshift.apply(Ve,ft);oe=oe.parent}return Ve.filter(function(sn){return ko(sn.target,X)})},ee}(),qr=function(ee,X,ae,oe){ee.container.elements.forEach(function(Ve){var ft=ko(Ve.flags,4),kt=ko(Ve.flags,2),an=new $o(Ve,ee);ko(Ve.styles.display,2048)&&oe.push(an);var sn=ko(Ve.flags,8)?[]:oe;if(ft||kt){var Yn=ft||Ve.styles.isPositioned()?ae:X,ni=new K1(an);if(Ve.styles.isPositioned()||Ve.styles.opacity<1||Ve.styles.isTransformed()){var ii=Ve.styles.zIndex.order;if(ii<0){var Gi=0;Yn.negativeZIndex.some(function(Pr,Dr){return ii>Pr.element.container.styles.zIndex.order?(Gi=Dr,!1):Gi>0}),Yn.negativeZIndex.splice(Gi,0,ni)}else if(ii>0){var ms=0;Yn.positiveZIndex.some(function(Pr,Dr){return ii>=Pr.element.container.styles.zIndex.order?(ms=Dr+1,!1):ms>0}),Yn.positiveZIndex.splice(ms,0,ni)}else Yn.zeroOrAutoZIndexOrTransformedOrOpacity.push(ni)}else Ve.styles.isFloating()?Yn.nonPositionedFloats.push(ni):Yn.nonPositionedInlineLevel.push(ni);qr(an,ni,ft?ni:ae,sn)}else Ve.styles.isInlineLevel()?X.inlineLevel.push(an):X.nonInlineLevel.push(an),qr(an,X,ae,sn);ko(Ve.flags,8)&&fh(Ve,sn)})},fh=function(ee,X){for(var ae=ee instanceof Gg?ee.start:1,oe=ee instanceof Gg&&ee.reversed,Ve=0;Ve<X.length;Ve++){var ft=X[Ve];ft.container instanceof N1&&"number"==typeof ft.container.value&&0!==ft.container.value&&(ae=ft.container.value),ft.listValue=Gm(ae,ft.container.styles.listStyleType,!0),ae+=oe?-1:1}},dp=function(ee,X){switch(X){case 0:return td(ee.topLeftBorderBox,ee.topLeftPaddingBox,ee.topRightBorderBox,ee.topRightPaddingBox);case 1:return td(ee.topRightBorderBox,ee.topRightPaddingBox,ee.bottomRightBorderBox,ee.bottomRightPaddingBox);case 2:return td(ee.bottomRightBorderBox,ee.bottomRightPaddingBox,ee.bottomLeftBorderBox,ee.bottomLeftPaddingBox);default:return td(ee.bottomLeftBorderBox,ee.bottomLeftPaddingBox,ee.topLeftBorderBox,ee.topLeftPaddingBox)}},em=function(ee,X){var ae=[];return Fc(ee)?ae.push(ee.subdivide(.5,!1)):ae.push(ee),Fc(X)?ae.push(X.subdivide(.5,!0)):ae.push(X),ae},td=function(ee,X,ae,oe){var Ve=[];return Fc(ee)?Ve.push(ee.subdivide(.5,!1)):Ve.push(ee),Fc(ae)?Ve.push(ae.subdivide(.5,!0)):Ve.push(ae),Fc(oe)?Ve.push(oe.subdivide(.5,!0).reverse()):Ve.push(oe),Fc(X)?Ve.push(X.subdivide(.5,!1).reverse()):Ve.push(X),Ve},r0=function(ee){var ae=ee.styles;return ee.bounds.add(ae.borderLeftWidth,ae.borderTopWidth,-(ae.borderRightWidth+ae.borderLeftWidth),-(ae.borderTopWidth+ae.borderBottomWidth))},sl=function(ee){var X=ee.styles,ae=ee.bounds,oe=Ko(X.paddingLeft,ae.width),Ve=Ko(X.paddingRight,ae.width),ft=Ko(X.paddingTop,ae.width),kt=Ko(X.paddingBottom,ae.width);return ae.add(oe+X.borderLeftWidth,ft+X.borderTopWidth,-(X.borderRightWidth+X.borderLeftWidth+oe+Ve),-(X.borderTopWidth+X.borderBottomWidth+ft+kt))},_f=function(ee,X,ae){var oe=function(ee,X){return 0===ee?X.bounds:2===ee?sl(X):r0(X)}(yu(ee.styles.backgroundOrigin,X),ee),Ve=function(ee,X){return 0===ee?X.bounds:2===ee?sl(X):r0(X)}(yu(ee.styles.backgroundClip,X),ee),ft=up(yu(ee.styles.backgroundSize,X),ae,oe),kt=ft[0],an=ft[1],sn=Em(yu(ee.styles.backgroundPosition,X),oe.width-kt,oe.height-an);return[s0(yu(ee.styles.backgroundRepeat,X),sn,ft,oe,Ve),Math.round(oe.left+sn[0]),Math.round(oe.top+sn[1]),kt,an]},yl=function(ee){return li(ee)&&ee.value===Ys.AUTO},Cl=function(ee){return"number"==typeof ee},up=function(ee,X,ae){var oe=X[0],Ve=X[1],ft=X[2],kt=ee[0],an=ee[1];if(!kt)return[0,0];if(fl(kt)&&an&&fl(an))return[Ko(kt,ae.width),Ko(an,ae.height)];var sn=Cl(ft);if(li(kt)&&(kt.value===Ys.CONTAIN||kt.value===Ys.COVER))return Cl(ft)?ae.width/ae.height<ft!=(kt.value===Ys.COVER)?[ae.width,ae.width/ft]:[ae.height*ft,ae.height]:[ae.width,ae.height];var ni=Cl(oe),ii=Cl(Ve),Gi=ni||ii;if(yl(kt)&&(!an||yl(an)))return ni&&ii?[oe,Ve]:sn||Gi?Gi&&sn?[ni?oe:Ve*ft,ii?Ve:oe/ft]:[ni?oe:ae.width,ii?Ve:ae.height]:[ae.width,ae.height];if(sn){var Fs=0,Ms=0;return fl(kt)?Fs=Ko(kt,ae.width):fl(an)&&(Ms=Ko(an,ae.height)),yl(kt)?Fs=Ms*ft:(!an||yl(an))&&(Ms=Fs/ft),[Fs,Ms]}var za=null,qo=null;if(fl(kt)?za=Ko(kt,ae.width):an&&fl(an)&&(qo=Ko(an,ae.height)),null!==za&&(!an||yl(an))&&(qo=ni&&ii?za/oe*Ve:ae.height),null!==qo&&yl(kt)&&(za=ni&&ii?qo/Ve*oe:ae.width),null!==za&&null!==qo)return[za,qo];throw new Error("Unable to calculate background-size for element")},yu=function(ee,X){var ae=ee[X];return typeof ae>"u"?ee[0]:ae},s0=function(ee,X,ae,oe,Ve){var ft=X[0],kt=X[1],an=ae[0],sn=ae[1];switch(ee){case 2:return[new as(Math.round(oe.left),Math.round(oe.top+kt)),new as(Math.round(oe.left+oe.width),Math.round(oe.top+kt)),new as(Math.round(oe.left+oe.width),Math.round(sn+oe.top+kt)),new as(Math.round(oe.left),Math.round(sn+oe.top+kt))];case 3:return[new as(Math.round(oe.left+ft),Math.round(oe.top)),new as(Math.round(oe.left+ft+an),Math.round(oe.top)),new as(Math.round(oe.left+ft+an),Math.round(oe.height+oe.top)),new as(Math.round(oe.left+ft),Math.round(oe.height+oe.top))];case 1:return[new as(Math.round(oe.left+ft),Math.round(oe.top+kt)),new as(Math.round(oe.left+ft+an),Math.round(oe.top+kt)),new as(Math.round(oe.left+ft+an),Math.round(oe.top+kt+sn)),new as(Math.round(oe.left+ft),Math.round(oe.top+kt+sn))];default:return[new as(Math.round(Ve.left),Math.round(Ve.top)),new as(Math.round(Ve.left+Ve.width),Math.round(Ve.top)),new as(Math.round(Ve.left+Ve.width),Math.round(Ve.height+Ve.top)),new as(Math.round(Ve.left),Math.round(Ve.height+Ve.top))]}},a0="Hidden Text",x_=function(){function ee(X){this._data={},this._document=X}return ee.prototype.parseMetrics=function(X,ae){var oe=this._document.createElement("div"),Ve=this._document.createElement("img"),ft=this._document.createElement("span"),kt=this._document.body;oe.style.visibility="hidden",oe.style.fontFamily=X,oe.style.fontSize=ae,oe.style.margin="0",oe.style.padding="0",oe.style.whiteSpace="nowrap",kt.appendChild(oe),Ve.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Ve.width=1,Ve.height=1,Ve.style.margin="0",Ve.style.padding="0",Ve.style.verticalAlign="baseline",ft.style.fontFamily=X,ft.style.fontSize=ae,ft.style.margin="0",ft.style.padding="0",ft.appendChild(this._document.createTextNode(a0)),oe.appendChild(ft),oe.appendChild(Ve);var an=Ve.offsetTop-ft.offsetTop+2;oe.removeChild(ft),oe.appendChild(this._document.createTextNode(a0)),oe.style.lineHeight="normal",Ve.style.verticalAlign="super";var sn=Ve.offsetTop-oe.offsetTop+2;return kt.removeChild(oe),{baseline:an,middle:sn}},ee.prototype.getMetrics=function(X,ae){var oe=X+" "+ae;return typeof this._data[oe]>"u"&&(this._data[oe]=this.parseMetrics(X,ae)),this._data[oe]},ee}(),tm=function(){return function ee(X,ae){this.context=X,this.options=ae}}(),jm=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve._activeEffects=[],Ve.canvas=oe.canvas?oe.canvas:document.createElement("canvas"),Ve.ctx=Ve.canvas.getContext("2d"),oe.canvas||(Ve.canvas.width=Math.floor(oe.width*oe.scale),Ve.canvas.height=Math.floor(oe.height*oe.scale),Ve.canvas.style.width=oe.width+"px",Ve.canvas.style.height=oe.height+"px"),Ve.fontMetrics=new x_(document),Ve.ctx.scale(Ve.options.scale,Ve.options.scale),Ve.ctx.translate(-oe.x,-oe.y),Ve.ctx.textBaseline="bottom",Ve._activeEffects=[],Ve.context.logger.debug("Canvas renderer initialized ("+oe.width+"x"+oe.height+") with scale "+oe.scale),Ve}return Ee(X,ee),X.prototype.applyEffects=function(ae){for(var oe=this;this._activeEffects.length;)this.popEffect();ae.forEach(function(Ve){return oe.applyEffect(Ve)})},X.prototype.applyEffect=function(ae){this.ctx.save(),function(ee){return 2===ee.type}(ae)&&(this.ctx.globalAlpha=ae.opacity),function(ee){return 0===ee.type}(ae)&&(this.ctx.translate(ae.offsetX,ae.offsetY),this.ctx.transform(ae.matrix[0],ae.matrix[1],ae.matrix[2],ae.matrix[3],ae.matrix[4],ae.matrix[5]),this.ctx.translate(-ae.offsetX,-ae.offsetY)),xv(ae)&&(this.path(ae.path),this.ctx.clip()),this._activeEffects.push(ae)},X.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},X.prototype.renderStack=function(ae){return b(this,void 0,void 0,function(){return z(this,function(Ve){switch(Ve.label){case 0:return ae.element.container.styles.isVisible()?[4,this.renderStackContent(ae)]:[3,2];case 1:Ve.sent(),Ve.label=2;case 2:return[2]}})})},X.prototype.renderNode=function(ae){return b(this,void 0,void 0,function(){return z(this,function(oe){switch(oe.label){case 0:return ko(ae.container.flags,16),ae.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(ae)]:[3,3];case 1:return oe.sent(),[4,this.renderNodeContent(ae)];case 2:oe.sent(),oe.label=3;case 3:return[2]}})})},X.prototype.renderTextWithLetterSpacing=function(ae,oe,Ve){var ft=this;0===oe?this.ctx.fillText(ae.text,ae.bounds.left,ae.bounds.top+Ve):Rh(ae.text).reduce(function(an,sn){return ft.ctx.fillText(sn,an,ae.bounds.top+Ve),an+ft.ctx.measureText(sn).width},ae.bounds.left)},X.prototype.createFontStyle=function(ae){var oe=ae.fontVariant.filter(function(kt){return"normal"===kt||"small-caps"===kt}).join(""),Ve=jA(ae.fontFamily).join(", "),ft=pi(ae.fontSize)?""+ae.fontSize.number+ae.fontSize.unit:ae.fontSize.number+"px";return[[ae.fontStyle,oe,ae.fontWeight,ft,Ve].join(" "),Ve,ft]},X.prototype.renderTextNode=function(ae,oe){return b(this,void 0,void 0,function(){var Ve,kt,an,sn,Yn,ni,ii,Gi=this;return z(this,function(ms){return Ve=this.createFontStyle(oe),kt=Ve[1],an=Ve[2],this.ctx.font=Ve[0],this.ctx.direction=1===oe.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",sn=this.fontMetrics.getMetrics(kt,an),Yn=sn.baseline,ni=sn.middle,ii=oe.paintOrder,ae.textBounds.forEach(function(Pr){ii.forEach(function(Dr){switch(Dr){case 0:Gi.ctx.fillStyle=Zo(oe.color),Gi.renderTextWithLetterSpacing(Pr,oe.letterSpacing,Yn);var Do=oe.textShadow;Do.length&&Pr.text.trim().length&&(Do.slice(0).reverse().forEach(function(Fs){Gi.ctx.shadowColor=Zo(Fs.color),Gi.ctx.shadowOffsetX=Fs.offsetX.number*Gi.options.scale,Gi.ctx.shadowOffsetY=Fs.offsetY.number*Gi.options.scale,Gi.ctx.shadowBlur=Fs.blur.number,Gi.renderTextWithLetterSpacing(Pr,oe.letterSpacing,Yn)}),Gi.ctx.shadowColor="",Gi.ctx.shadowOffsetX=0,Gi.ctx.shadowOffsetY=0,Gi.ctx.shadowBlur=0),oe.textDecorationLine.length&&(Gi.ctx.fillStyle=Zo(oe.textDecorationColor||oe.color),oe.textDecorationLine.forEach(function(Fs){switch(Fs){case 1:Gi.ctx.fillRect(Pr.bounds.left,Math.round(Pr.bounds.top+Yn),Pr.bounds.width,1);break;case 2:Gi.ctx.fillRect(Pr.bounds.left,Math.round(Pr.bounds.top),Pr.bounds.width,1);break;case 3:Gi.ctx.fillRect(Pr.bounds.left,Math.ceil(Pr.bounds.top+ni),Pr.bounds.width,1)}}));break;case 1:oe.webkitTextStrokeWidth&&Pr.text.trim().length&&(Gi.ctx.strokeStyle=Zo(oe.webkitTextStrokeColor),Gi.ctx.lineWidth=oe.webkitTextStrokeWidth,Gi.ctx.lineJoin=window.chrome?"miter":"round",Gi.ctx.strokeText(Pr.text,Pr.bounds.left,Pr.bounds.top+Yn)),Gi.ctx.strokeStyle="",Gi.ctx.lineWidth=0,Gi.ctx.lineJoin="miter"}})}),[2]})})},X.prototype.renderReplacedElement=function(ae,oe,Ve){if(Ve&&ae.intrinsicWidth>0&&ae.intrinsicHeight>0){var ft=sl(ae),kt=Aa(oe);this.path(kt),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(Ve,0,0,ae.intrinsicWidth,ae.intrinsicHeight,ft.left,ft.top,ft.width,ft.height),this.ctx.restore()}},X.prototype.renderNodeContent=function(ae){return b(this,void 0,void 0,function(){var oe,Ve,ft,kt,an,ni,ii,Gi,Pr,Dr,Do,Fs,Ms,za,qo,Co;return z(this,function(hs){switch(hs.label){case 0:this.applyEffects(ae.getEffects(4)),Ve=ae.curves,ft=(oe=ae.container).styles,kt=0,an=oe.textNodes,hs.label=1;case 1:return kt<an.length?[4,this.renderTextNode(an[kt],ft)]:[3,4];case 2:hs.sent(),hs.label=3;case 3:return kt++,[3,1];case 4:if(!(oe instanceof F1))return[3,8];hs.label=5;case 5:return hs.trys.push([5,7,,8]),[4,this.context.cache.match(oe.src)];case 6:return Ms=hs.sent(),this.renderReplacedElement(oe,Ve,Ms),[3,8];case 7:return hs.sent(),this.context.logger.error("Error loading image "+oe.src),[3,8];case 8:if(oe instanceof O1&&this.renderReplacedElement(oe,Ve,oe.canvas),!(oe instanceof L1))return[3,12];hs.label=9;case 9:return hs.trys.push([9,11,,12]),[4,this.context.cache.match(oe.svg)];case 10:return Ms=hs.sent(),this.renderReplacedElement(oe,Ve,Ms),[3,12];case 11:return hs.sent(),this.context.logger.error("Error loading svg "+oe.svg.substring(0,255)),[3,12];case 12:return oe instanceof gv&&oe.tree?[4,new X(this.context,{scale:this.options.scale,backgroundColor:oe.backgroundColor,x:0,y:0,width:oe.width,height:oe.height}).render(oe.tree)]:[3,14];case 13:ni=hs.sent(),oe.width&&oe.height&&this.ctx.drawImage(ni,0,0,oe.width,oe.height,oe.bounds.left,oe.bounds.top,oe.bounds.width,oe.bounds.height),hs.label=14;case 14:if(oe instanceof zA&&(ii=Math.min(oe.bounds.width,oe.bounds.height),oe.type===Ua?oe.checked&&(this.ctx.save(),this.path([new as(oe.bounds.left+.39363*ii,oe.bounds.top+.79*ii),new as(oe.bounds.left+.16*ii,oe.bounds.top+.5549*ii),new as(oe.bounds.left+.27347*ii,oe.bounds.top+.44071*ii),new as(oe.bounds.left+.39694*ii,oe.bounds.top+.5649*ii),new as(oe.bounds.left+.72983*ii,oe.bounds.top+.23*ii),new as(oe.bounds.left+.84*ii,oe.bounds.top+.34085*ii),new as(oe.bounds.left+.39363*ii,oe.bounds.top+.79*ii)]),this.ctx.fillStyle=Zo(lh),this.ctx.fill(),this.ctx.restore()):oe.type===UA&&oe.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(oe.bounds.left+ii/2,oe.bounds.top+ii/2,ii/4,0,2*Math.PI,!0),this.ctx.fillStyle=Zo(lh),this.ctx.fill(),this.ctx.restore())),l0(oe)&&oe.value.length){switch(Gi=this.createFontStyle(ft),Pr=this.fontMetrics.getMetrics(qo=Gi[0],Gi[1]).baseline,this.ctx.font=qo,this.ctx.fillStyle=Zo(ft.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=hp(oe.styles.textAlign),Co=sl(oe),Dr=0,oe.styles.textAlign){case 1:Dr+=Co.width/2;break;case 2:Dr+=Co.width}Do=Co.add(Dr,0,0,-Co.height/2+1),this.ctx.save(),this.path([new as(Co.left,Co.top),new as(Co.left+Co.width,Co.top),new as(Co.left+Co.width,Co.top+Co.height),new as(Co.left,Co.top+Co.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new pf(oe.value,Do),ft.letterSpacing,Pr),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!ko(oe.styles.display,2048))return[3,20];if(null===oe.styles.listStyleImage)return[3,19];if(0!==(Fs=oe.styles.listStyleImage).type)return[3,18];Ms=void 0,za=Fs.url,hs.label=15;case 15:return hs.trys.push([15,17,,18]),[4,this.context.cache.match(za)];case 16:return Ms=hs.sent(),this.ctx.drawImage(Ms,oe.bounds.left-(Ms.width+10),oe.bounds.top),[3,18];case 17:return hs.sent(),this.context.logger.error("Error loading list-style-image "+za),[3,18];case 18:return[3,20];case 19:ae.listValue&&-1!==oe.styles.listStyleType&&(qo=this.createFontStyle(ft)[0],this.ctx.font=qo,this.ctx.fillStyle=Zo(ft.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Co=new xe(oe.bounds.left,oe.bounds.top+Ko(oe.styles.paddingTop,oe.bounds.width),oe.bounds.width,Np(ft.lineHeight,ft.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new pf(ae.listValue,Co),ft.letterSpacing,Np(ft.lineHeight,ft.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),hs.label=20;case 20:return[2]}})})},X.prototype.renderStackContent=function(ae){return b(this,void 0,void 0,function(){var oe,Ve,ft,kt,an,sn,Yn,ni,ii,Gi,ms,Pr,Dr,Do;return z(this,function(Ms){switch(Ms.label){case 0:return ko(ae.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(ae.element)];case 1:Ms.sent(),oe=0,Ve=ae.negativeZIndex,Ms.label=2;case 2:return oe<Ve.length?[4,this.renderStack(Ve[oe])]:[3,5];case 3:Ms.sent(),Ms.label=4;case 4:return oe++,[3,2];case 5:return[4,this.renderNodeContent(ae.element)];case 6:Ms.sent(),ft=0,kt=ae.nonInlineLevel,Ms.label=7;case 7:return ft<kt.length?[4,this.renderNode(kt[ft])]:[3,10];case 8:Ms.sent(),Ms.label=9;case 9:return ft++,[3,7];case 10:an=0,sn=ae.nonPositionedFloats,Ms.label=11;case 11:return an<sn.length?[4,this.renderStack(sn[an])]:[3,14];case 12:Ms.sent(),Ms.label=13;case 13:return an++,[3,11];case 14:Yn=0,ni=ae.nonPositionedInlineLevel,Ms.label=15;case 15:return Yn<ni.length?[4,this.renderStack(ni[Yn])]:[3,18];case 16:Ms.sent(),Ms.label=17;case 17:return Yn++,[3,15];case 18:ii=0,Gi=ae.inlineLevel,Ms.label=19;case 19:return ii<Gi.length?[4,this.renderNode(Gi[ii])]:[3,22];case 20:Ms.sent(),Ms.label=21;case 21:return ii++,[3,19];case 22:ms=0,Pr=ae.zeroOrAutoZIndexOrTransformedOrOpacity,Ms.label=23;case 23:return ms<Pr.length?[4,this.renderStack(Pr[ms])]:[3,26];case 24:Ms.sent(),Ms.label=25;case 25:return ms++,[3,23];case 26:Dr=0,Do=ae.positiveZIndex,Ms.label=27;case 27:return Dr<Do.length?[4,this.renderStack(Do[Dr])]:[3,30];case 28:Ms.sent(),Ms.label=29;case 29:return Dr++,[3,27];case 30:return[2]}})})},X.prototype.mask=function(ae){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(ae.slice(0).reverse()),this.ctx.closePath()},X.prototype.path=function(ae){this.ctx.beginPath(),this.formatPath(ae),this.ctx.closePath()},X.prototype.formatPath=function(ae){var oe=this;ae.forEach(function(Ve,ft){var kt=Fc(Ve)?Ve.start:Ve;0===ft?oe.ctx.moveTo(kt.x,kt.y):oe.ctx.lineTo(kt.x,kt.y),Fc(Ve)&&oe.ctx.bezierCurveTo(Ve.startControl.x,Ve.startControl.y,Ve.endControl.x,Ve.endControl.y,Ve.end.x,Ve.end.y)})},X.prototype.renderRepeat=function(ae,oe,Ve,ft){this.path(ae),this.ctx.fillStyle=oe,this.ctx.translate(Ve,ft),this.ctx.fill(),this.ctx.translate(-Ve,-ft)},X.prototype.resizeImage=function(ae,oe,Ve){var ft;if(ae.width===oe&&ae.height===Ve)return ae;var an=(null!==(ft=this.canvas.ownerDocument)&&void 0!==ft?ft:document).createElement("canvas");return an.width=Math.max(1,oe),an.height=Math.max(1,Ve),an.getContext("2d").drawImage(ae,0,0,ae.width,ae.height,0,0,oe,Ve),an},X.prototype.renderBackgroundImage=function(ae){return b(this,void 0,void 0,function(){var oe,Ve,ft,kt,an;return z(this,function(Yn){switch(Yn.label){case 0:oe=ae.styles.backgroundImage.length-1,Ve=function(ni){var ii,Gi,ms,Pr,Dr,Do,Fs,Ms,za,qo,Co,hs,Ta,ba,So,Rl,Xa,el,Ya,Qc,xf,nd,kd,fp,mh,wf,im,rm,Cf,sm,Uh;return z(this,function($A){switch($A.label){case 0:if(0!==ni.type)return[3,5];ii=void 0,Gi=ni.url,$A.label=1;case 1:return $A.trys.push([1,3,,4]),[4,ft.context.cache.match(Gi)];case 2:return ii=$A.sent(),[3,4];case 3:return $A.sent(),ft.context.logger.error("Error loading background-image "+Gi),[3,4];case 4:return ii&&(ms=_f(ae,oe,[ii.width,ii.height,ii.width/ii.height]),Rl=ms[0],nd=ms[1],kd=ms[2],ba=ft.ctx.createPattern(ft.resizeImage(ii,Ya=ms[3],Qc=ms[4]),"repeat"),ft.renderRepeat(Rl,ba,nd,kd)),[3,6];case 5:!function(ee){return 1===ee.type}(ni)?function(ee){return 2===ee.type}(ni)&&(So=_f(ae,oe,[null,null,null]),Rl=So[0],Xa=So[1],el=So[2],Qc=So[4],nd=Ko((xf=0===ni.position.length?[Bg]:ni.position)[0],Ya=So[3]),kd=Ko(xf[xf.length-1],Qc),fp=function(ee,X,ae,oe,Ve){var ft=0,kt=0;switch(ee.size){case 0:0===ee.shape?ft=kt=Math.min(Math.abs(X),Math.abs(X-oe),Math.abs(ae),Math.abs(ae-Ve)):1===ee.shape&&(ft=Math.min(Math.abs(X),Math.abs(X-oe)),kt=Math.min(Math.abs(ae),Math.abs(ae-Ve)));break;case 2:if(0===ee.shape)ft=kt=Math.min(pu(X,ae),pu(X,ae-Ve),pu(X-oe,ae),pu(X-oe,ae-Ve));else if(1===ee.shape){var an=Math.min(Math.abs(ae),Math.abs(ae-Ve))/Math.min(Math.abs(X),Math.abs(X-oe)),sn=rf(oe,Ve,X,ae,!0);kt=an*(ft=pu(sn[0]-X,(sn[1]-ae)/an))}break;case 1:0===ee.shape?ft=kt=Math.max(Math.abs(X),Math.abs(X-oe),Math.abs(ae),Math.abs(ae-Ve)):1===ee.shape&&(ft=Math.max(Math.abs(X),Math.abs(X-oe)),kt=Math.max(Math.abs(ae),Math.abs(ae-Ve)));break;case 3:if(0===ee.shape)ft=kt=Math.max(pu(X,ae),pu(X,ae-Ve),pu(X-oe,ae),pu(X-oe,ae-Ve));else if(1===ee.shape){an=Math.max(Math.abs(ae),Math.abs(ae-Ve))/Math.max(Math.abs(X),Math.abs(X-oe));var ii=rf(oe,Ve,X,ae,!1);kt=an*(ft=pu(ii[0]-X,(ii[1]-ae)/an))}}return Array.isArray(ee.size)&&(ft=Ko(ee.size[0],oe),kt=2===ee.size.length?Ko(ee.size[1],Ve):ft),[ft,kt]}(ni,nd,kd,Ya,Qc),wf=fp[1],(mh=fp[0])>0&&wf>0&&(im=ft.ctx.createRadialGradient(Xa+nd,el+kd,0,Xa+nd,el+kd,mh),TA(ni.stops,2*mh).forEach(function($m){return im.addColorStop($m.stop,Zo($m.color))}),ft.path(Rl),ft.ctx.fillStyle=im,mh!==wf?(rm=ae.bounds.left+.5*ae.bounds.width,Cf=ae.bounds.top+.5*ae.bounds.height,Uh=1/(sm=wf/mh),ft.ctx.save(),ft.ctx.translate(rm,Cf),ft.ctx.transform(1,0,0,sm,0,0),ft.ctx.translate(-rm,-Cf),ft.ctx.fillRect(Xa,Uh*(el-Cf)+Cf,Ya,Qc*Uh),ft.ctx.restore()):ft.ctx.fill())):(Pr=_f(ae,oe,[null,null,null]),Rl=Pr[0],nd=Pr[1],kd=Pr[2],Dr=X0(ni.angle,Ya=Pr[3],Qc=Pr[4]),Do=Dr[0],Fs=Dr[1],Ms=Dr[2],za=Dr[3],qo=Dr[4],(Co=document.createElement("canvas")).width=Ya,Co.height=Qc,hs=Co.getContext("2d"),Ta=hs.createLinearGradient(Fs,za,Ms,qo),TA(ni.stops,Do).forEach(function($m){return Ta.addColorStop($m.stop,Zo($m.color))}),hs.fillStyle=Ta,hs.fillRect(0,0,Ya,Qc),Ya>0&&Qc>0&&(ba=ft.ctx.createPattern(Co,"repeat"),ft.renderRepeat(Rl,ba,nd,kd))),$A.label=6;case 6:return oe--,[2]}})},ft=this,kt=0,an=ae.styles.backgroundImage.slice(0).reverse(),Yn.label=1;case 1:return kt<an.length?[5,Ve(an[kt])]:[3,4];case 2:Yn.sent(),Yn.label=3;case 3:return kt++,[3,1];case 4:return[2]}})})},X.prototype.renderSolidBorder=function(ae,oe,Ve){return b(this,void 0,void 0,function(){return z(this,function(ft){return this.path(dp(Ve,oe)),this.ctx.fillStyle=Zo(ae),this.ctx.fill(),[2]})})},X.prototype.renderDoubleBorder=function(ae,oe,Ve,ft){return b(this,void 0,void 0,function(){var kt,an;return z(this,function(sn){switch(sn.label){case 0:return oe<3?[4,this.renderSolidBorder(ae,Ve,ft)]:[3,2];case 1:return sn.sent(),[2];case 2:return kt=function(ee,X){switch(X){case 0:return td(ee.topLeftBorderBox,ee.topLeftBorderDoubleOuterBox,ee.topRightBorderBox,ee.topRightBorderDoubleOuterBox);case 1:return td(ee.topRightBorderBox,ee.topRightBorderDoubleOuterBox,ee.bottomRightBorderBox,ee.bottomRightBorderDoubleOuterBox);case 2:return td(ee.bottomRightBorderBox,ee.bottomRightBorderDoubleOuterBox,ee.bottomLeftBorderBox,ee.bottomLeftBorderDoubleOuterBox);default:return td(ee.bottomLeftBorderBox,ee.bottomLeftBorderDoubleOuterBox,ee.topLeftBorderBox,ee.topLeftBorderDoubleOuterBox)}}(ft,Ve),this.path(kt),this.ctx.fillStyle=Zo(ae),this.ctx.fill(),an=function(ee,X){switch(X){case 0:return td(ee.topLeftBorderDoubleInnerBox,ee.topLeftPaddingBox,ee.topRightBorderDoubleInnerBox,ee.topRightPaddingBox);case 1:return td(ee.topRightBorderDoubleInnerBox,ee.topRightPaddingBox,ee.bottomRightBorderDoubleInnerBox,ee.bottomRightPaddingBox);case 2:return td(ee.bottomRightBorderDoubleInnerBox,ee.bottomRightPaddingBox,ee.bottomLeftBorderDoubleInnerBox,ee.bottomLeftPaddingBox);default:return td(ee.bottomLeftBorderDoubleInnerBox,ee.bottomLeftPaddingBox,ee.topLeftBorderDoubleInnerBox,ee.topLeftPaddingBox)}}(ft,Ve),this.path(an),this.ctx.fill(),[2]}})})},X.prototype.renderNodeBackgroundAndBorders=function(ae){return b(this,void 0,void 0,function(){var oe,Ve,ft,kt,an,sn,Yn,ni,ii=this;return z(this,function(Gi){switch(Gi.label){case 0:return this.applyEffects(ae.getEffects(2)),Ve=!eh((oe=ae.container.styles).backgroundColor)||oe.backgroundImage.length,ft=[{style:oe.borderTopStyle,color:oe.borderTopColor,width:oe.borderTopWidth},{style:oe.borderRightStyle,color:oe.borderRightColor,width:oe.borderRightWidth},{style:oe.borderBottomStyle,color:oe.borderBottomColor,width:oe.borderBottomWidth},{style:oe.borderLeftStyle,color:oe.borderLeftColor,width:oe.borderLeftWidth}],kt=w_(yu(oe.backgroundClip,0),ae.curves),Ve||oe.boxShadow.length?(this.ctx.save(),this.path(kt),this.ctx.clip(),eh(oe.backgroundColor)||(this.ctx.fillStyle=Zo(oe.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(ae.container)]):[3,2];case 1:Gi.sent(),this.ctx.restore(),oe.boxShadow.slice(0).reverse().forEach(function(ms){ii.ctx.save();var Pr=lc(ae.curves),Dr=ms.inset?0:1e4,Do=function(ee,X,ae,oe,Ve){return ee.map(function(ft,kt){switch(kt){case 0:return ft.add(X,ae);case 1:return ft.add(X+oe,ae);case 2:return ft.add(X+oe,ae+Ve);case 3:return ft.add(X,ae+Ve)}return ft})}(Pr,(ms.inset?1:-1)*ms.spread.number-Dr,(ms.inset?1:-1)*ms.spread.number,ms.spread.number*(ms.inset?-2:2),ms.spread.number*(ms.inset?-2:2));ms.inset?(ii.path(Pr),ii.ctx.clip(),ii.mask(Do)):(ii.mask(Pr),ii.ctx.clip(),ii.path(Do)),ii.ctx.shadowOffsetX=ms.offsetX.number+Dr,ii.ctx.shadowOffsetY=ms.offsetY.number,ii.ctx.shadowColor=Zo(ms.color),ii.ctx.shadowBlur=ms.blur.number,ii.ctx.fillStyle=ms.inset?Zo(ms.color):"rgba(0,0,0,1)",ii.ctx.fill(),ii.ctx.restore()}),Gi.label=2;case 2:an=0,sn=0,Yn=ft,Gi.label=3;case 3:return sn<Yn.length?0!==(ni=Yn[sn]).style&&!eh(ni.color)&&ni.width>0?2!==ni.style?[3,5]:[4,this.renderDashedDottedBorder(ni.color,ni.width,an,ae.curves,2)]:[3,11]:[3,13];case 4:return Gi.sent(),[3,11];case 5:return 3!==ni.style?[3,7]:[4,this.renderDashedDottedBorder(ni.color,ni.width,an,ae.curves,3)];case 6:return Gi.sent(),[3,11];case 7:return 4!==ni.style?[3,9]:[4,this.renderDoubleBorder(ni.color,ni.width,an,ae.curves)];case 8:return Gi.sent(),[3,11];case 9:return[4,this.renderSolidBorder(ni.color,an,ae.curves)];case 10:Gi.sent(),Gi.label=11;case 11:an++,Gi.label=12;case 12:return sn++,[3,3];case 13:return[2]}})})},X.prototype.renderDashedDottedBorder=function(ae,oe,Ve,ft,kt){return b(this,void 0,void 0,function(){var an,sn,Yn,ni,ii,Gi,ms,Pr,Dr,Do,Fs,Ms,za,qo,Co,hs;return z(this,function(Ta){return this.ctx.save(),an=function(ee,X){switch(X){case 0:return em(ee.topLeftBorderStroke,ee.topRightBorderStroke);case 1:return em(ee.topRightBorderStroke,ee.bottomRightBorderStroke);case 2:return em(ee.bottomRightBorderStroke,ee.bottomLeftBorderStroke);default:return em(ee.bottomLeftBorderStroke,ee.topLeftBorderStroke)}}(ft,Ve),sn=dp(ft,Ve),2===kt&&(this.path(sn),this.ctx.clip()),Fc(sn[0])?(Yn=sn[0].start.x,ni=sn[0].start.y):(Yn=sn[0].x,ni=sn[0].y),Fc(sn[1])?(ii=sn[1].end.x,Gi=sn[1].end.y):(ii=sn[1].x,Gi=sn[1].y),ms=0===Ve||2===Ve?Math.abs(Yn-ii):Math.abs(ni-Gi),this.ctx.beginPath(),this.formatPath(3===kt?an:sn.slice(0,2)),Pr=oe<3?3*oe:2*oe,Dr=oe<3?2*oe:oe,3===kt&&(Pr=oe,Dr=oe),Do=!0,ms<=2*Pr?Do=!1:ms<=2*Pr+Dr?(Pr*=Fs=ms/(2*Pr+Dr),Dr*=Fs):(Ms=Math.floor((ms+Dr)/(Pr+Dr)),za=(ms-Ms*Pr)/(Ms-1),Dr=(qo=(ms-(Ms+1)*Pr)/Ms)<=0||Math.abs(Dr-za)<Math.abs(Dr-qo)?za:qo),Do&&this.ctx.setLineDash(3===kt?[0,Pr+Dr]:[Pr,Dr]),3===kt?(this.ctx.lineCap="round",this.ctx.lineWidth=oe):this.ctx.lineWidth=2*oe+1.1,this.ctx.strokeStyle=Zo(ae),this.ctx.stroke(),this.ctx.setLineDash([]),2===kt&&(Fc(sn[0])&&(Co=sn[3],hs=sn[0],this.ctx.beginPath(),this.formatPath([new as(Co.end.x,Co.end.y),new as(hs.start.x,hs.start.y)]),this.ctx.stroke()),Fc(sn[1])&&(Co=sn[1],hs=sn[2],this.ctx.beginPath(),this.formatPath([new as(Co.end.x,Co.end.y),new as(hs.start.x,hs.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},X.prototype.render=function(ae){return b(this,void 0,void 0,function(){var oe;return z(this,function(Ve){switch(Ve.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Zo(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),oe=function(ee){var X=new $o(ee,null),ae=new K1(X),oe=[];return qr(X,ae,ae,oe),fh(X.container,oe),ae}(ae),[4,this.renderStack(oe)];case 1:return Ve.sent(),this.applyEffects([]),[2,this.canvas]}})})},X}(tm),l0=function(ee){return ee instanceof U1||ee instanceof qg||ee instanceof zA&&ee.type!==UA&&ee.type!==Ua},w_=function(ee,X){switch(ee){case 0:return lc(X);case 2:return function(ee){return[ee.topLeftContentBox,ee.topRightContentBox,ee.bottomRightContentBox,ee.bottomLeftContentBox]}(X);default:return Aa(X)}},hp=function(ee){switch(ee){case 1:return"center";case 2:return"right";default:return"left"}},Ws=["-apple-system","system-ui"],jA=function(ee){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?ee.filter(function(X){return-1===Ws.indexOf(X)}):ee},yf=function(ee){function X(ae,oe){var Ve=ee.call(this,ae,oe)||this;return Ve.canvas=oe.canvas?oe.canvas:document.createElement("canvas"),Ve.ctx=Ve.canvas.getContext("2d"),Ve.options=oe,Ve.canvas.width=Math.floor(oe.width*oe.scale),Ve.canvas.height=Math.floor(oe.height*oe.scale),Ve.canvas.style.width=oe.width+"px",Ve.canvas.style.height=oe.height+"px",Ve.ctx.scale(Ve.options.scale,Ve.options.scale),Ve.ctx.translate(-oe.x,-oe.y),Ve.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+oe.width+"x"+oe.height+" at "+oe.x+","+oe.y+") with scale "+oe.scale),Ve}return Ee(X,ee),X.prototype.render=function(ae){return b(this,void 0,void 0,function(){var oe,Ve;return z(this,function(ft){switch(ft.label){case 0:return oe=n_(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,ae),[4,Nh(oe)];case 1:return Ve=ft.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Zo(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(Ve,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},X}(tm),Nh=function(ee){return new Promise(function(X,ae){var oe=new Image;oe.onload=function(){X(oe)},oe.onerror=ae,oe.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(ee))})},xs=function(){function ee(X){var oe=X.enabled;this.id=X.id,this.enabled=oe,this.start=Date.now()}return ee.prototype.debug=function(){for(var X=[],ae=0;ae<arguments.length;ae++)X[ae]=arguments[ae];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.debug?console.debug.apply(console,ke([this.id,this.getTime()+"ms"],X)):this.info.apply(this,X))},ee.prototype.getTime=function(){return Date.now()-this.start},ee.prototype.info=function(){for(var X=[],ae=0;ae<arguments.length;ae++)X[ae]=arguments[ae];this.enabled&&typeof window<"u"&&window.console&&"function"==typeof console.info&&console.info.apply(console,ke([this.id,this.getTime()+"ms"],X))},ee.prototype.warn=function(){for(var X=[],ae=0;ae<arguments.length;ae++)X[ae]=arguments[ae];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.warn?console.warn.apply(console,ke([this.id,this.getTime()+"ms"],X)):this.info.apply(this,X))},ee.prototype.error=function(){for(var X=[],ae=0;ae<arguments.length;ae++)X[ae]=arguments[ae];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.error?console.error.apply(console,ke([this.id,this.getTime()+"ms"],X)):this.info.apply(this,X))},ee.instances={},ee}(),C_=function(){function ee(X,ae){var oe;this.windowBounds=ae,this.instanceName="#"+ee.instanceCount++,this.logger=new xs({id:this.instanceName,enabled:X.logging}),this.cache=null!==(oe=X.cache)&&void 0!==oe?oe:new vv(this,X)}return ee.instanceCount=1,ee}();typeof window<"u"&&Lh.setContext(window);var bf=function(ee,X){return b(void 0,void 0,void 0,function(){var ae,oe,Ve,ft,kt,an,sn,Yn,ni,ii,Gi,ms,Pr,Dr,Do,Fs,Ms,za,qo,Co,hs,ba,So,Rl,Xa,el,Ya,Qc,xf,nd,kd,fp,mh,wf,im,rm,Cf,sm;return z(this,function(Uh){switch(Uh.label){case 0:if(!ee||"object"!=typeof ee)return[2,Promise.reject("Invalid element provided as first argument")];if(!(ae=ee.ownerDocument))throw new Error("Element is not attached to a Document");if(!(oe=ae.defaultView))throw new Error("Document is not attached to a Window");return Ve={allowTaint:null!==(ba=X.allowTaint)&&void 0!==ba&&ba,imageTimeout:null!==(So=X.imageTimeout)&&void 0!==So?So:15e3,proxy:X.proxy,useCORS:null!==(Rl=X.useCORS)&&void 0!==Rl&&Rl},ft=ve({logging:null===(Xa=X.logging)||void 0===Xa||Xa,cache:X.cache},Ve),kt={windowWidth:null!==(el=X.windowWidth)&&void 0!==el?el:oe.innerWidth,windowHeight:null!==(Ya=X.windowHeight)&&void 0!==Ya?Ya:oe.innerHeight,scrollX:null!==(Qc=X.scrollX)&&void 0!==Qc?Qc:oe.pageXOffset,scrollY:null!==(xf=X.scrollY)&&void 0!==xf?xf:oe.pageYOffset},an=new xe(kt.scrollX,kt.scrollY,kt.windowWidth,kt.windowHeight),sn=new C_(ft,an),Yn=null!==(nd=X.foreignObjectRendering)&&void 0!==nd&&nd,ni={allowTaint:null!==(kd=X.allowTaint)&&void 0!==kd&&kd,onclone:X.onclone,ignoreElements:X.ignoreElements,inlineImages:Yn,copyStyles:Yn},sn.logger.debug("Starting document clone with size "+an.width+"x"+an.height+" scrolled to "+-an.left+","+-an.top),ii=new Xg(sn,ee,ni),(Gi=ii.clonedReferenceElement)?[4,ii.toIFrame(ae,an)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return ms=Uh.sent(),Pr=Wg(Gi)||function(ee){return"HTML"===ee.tagName}(Gi)?function(ee){var X=ee.body,ae=ee.documentElement;if(!X||!ae)throw new Error("Unable to get document size");var oe=Math.max(Math.max(X.scrollWidth,ae.scrollWidth),Math.max(X.offsetWidth,ae.offsetWidth),Math.max(X.clientWidth,ae.clientWidth)),Ve=Math.max(Math.max(X.scrollHeight,ae.scrollHeight),Math.max(X.offsetHeight,ae.offsetHeight),Math.max(X.clientHeight,ae.clientHeight));return new xe(0,0,oe,Ve)}(Gi.ownerDocument):et(sn,Gi),Dr=Pr.width,Do=Pr.height,Fs=Pr.left,Ms=Pr.top,za=nm(sn,Gi,X.backgroundColor),qo={canvas:X.canvas,backgroundColor:za,scale:null!==(mh=null!==(fp=X.scale)&&void 0!==fp?fp:oe.devicePixelRatio)&&void 0!==mh?mh:1,x:(null!==(wf=X.x)&&void 0!==wf?wf:0)+Fs,y:(null!==(im=X.y)&&void 0!==im?im:0)+Ms,width:null!==(rm=X.width)&&void 0!==rm?rm:Math.ceil(Dr),height:null!==(Cf=X.height)&&void 0!==Cf?Cf:Math.ceil(Do)},Yn?(sn.logger.debug("Document cloned, using foreign object rendering"),[4,new yf(sn,qo).render(Gi)]):[3,3];case 2:return Co=Uh.sent(),[3,5];case 3:return sn.logger.debug("Document cloned, element located at "+Fs+","+Ms+" with size "+Dr+"x"+Do+" using computed rendering"),sn.logger.debug("Starting DOM parsing"),hs=r_(sn,Gi),za===hs.styles.backgroundColor&&(hs.styles.backgroundColor=Zc.TRANSPARENT),sn.logger.debug("Starting renderer for element at "+qo.x+","+qo.y+" with size "+qo.width+"x"+qo.height),[4,new jm(sn,qo).render(hs)];case 4:Co=Uh.sent(),Uh.label=5;case 5:return(!(null!==(sm=X.removeContainer)&&void 0!==sm)||sm)&&(Xg.destroy(ms)||sn.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),sn.logger.debug("Finished rendering"),[2,Co]}})})},nm=function(ee,X,ae){var oe=X.ownerDocument,Ve=oe.documentElement?Ch(ee,getComputedStyle(oe.documentElement).backgroundColor):Zc.TRANSPARENT,ft=oe.body?Ch(ee,getComputedStyle(oe.body).backgroundColor):Zc.TRANSPARENT,kt="string"==typeof ae?Ch(ee,ae):null===ae?Zc.TRANSPARENT:4294967295;return X===oe.documentElement?eh(Ve)?eh(ft)?kt:ft:Ve:kt};return function(ee,X){return void 0===X&&(X={}),bf(ee,X)}}()},7247:Ur=>{Ur.exports=function vt(Ee,ve,b){function z(et,Je){if(!ve[et]){if(!Ee[et]){if(ke)return ke(et,!0);var ot=new Error("Cannot find module '"+et+"'");throw ot.code="MODULE_NOT_FOUND",ot}var Re=ve[et]={exports:{}};Ee[et][0].call(Re.exports,function(He){return z(Ee[et][1][He]||He)},Re,Re.exports,vt,Ee,ve,b)}return ve[et].exports}for(var ke=void 0,xe=0;xe<b.length;xe++)z(b[xe]);return z}({1:[function(vt,Ee,ve){"use strict";var b=vt("./utils"),z=vt("./support"),ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";ve.encode=function(xe){for(var et,Je,Xe,Re,He,Ie,O=[],ce=0,ie=xe.length,he=ie,ue="string"!==b.getTypeOf(xe);ce<xe.length;)he=ie-ce,Xe=ue?(et=xe[ce++],Je=ce<ie?xe[ce++]:0,ce<ie?xe[ce++]:0):(et=xe.charCodeAt(ce++),Je=ce<ie?xe.charCodeAt(ce++):0,ce<ie?xe.charCodeAt(ce++):0),Re=(3&et)<<4|Je>>4,He=1<he?(15&Je)<<2|Xe>>6:64,Ie=2<he?63&Xe:64,O.push(ke.charAt(et>>2)+ke.charAt(Re)+ke.charAt(He)+ke.charAt(Ie));return O.join("")},ve.decode=function(xe){var et,Je,Xe,ot,Re,He,Ie=0,O=0;if("data:"===xe.substr(0,5))throw new Error("Invalid base64 input, it looks like a data url.");var ie,he=3*(xe=xe.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(xe.charAt(xe.length-1)===ke.charAt(64)&&he--,xe.charAt(xe.length-2)===ke.charAt(64)&&he--,he%1!=0)throw new Error("Invalid base64 input, bad content length.");for(ie=z.uint8array?new Uint8Array(0|he):new Array(0|he);Ie<xe.length;)et=ke.indexOf(xe.charAt(Ie++))<<2|(ot=ke.indexOf(xe.charAt(Ie++)))>>4,Je=(15&ot)<<4|(Re=ke.indexOf(xe.charAt(Ie++)))>>2,Xe=(3&Re)<<6|(He=ke.indexOf(xe.charAt(Ie++))),ie[O++]=et,64!==Re&&(ie[O++]=Je),64!==He&&(ie[O++]=Xe);return ie}},{"./support":30,"./utils":32}],2:[function(vt,Ee,ve){"use strict";var b=vt("./external"),z=vt("./stream/DataWorker"),ke=vt("./stream/Crc32Probe"),xe=vt("./stream/DataLengthProbe");function et(Je,Xe,ot,Re,He){this.compressedSize=Je,this.uncompressedSize=Xe,this.crc32=ot,this.compression=Re,this.compressedContent=He}et.prototype={getContentWorker:function(){var Je=new z(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new xe("data_length")),Xe=this;return Je.on("end",function(){if(this.streamInfo.data_length!==Xe.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),Je},getCompressedWorker:function(){return new z(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},et.createWorkerFrom=function(Je,Xe,ot){return Je.pipe(new ke).pipe(new xe("uncompressedSize")).pipe(Xe.compressWorker(ot)).pipe(new xe("compressedSize")).withStreamInfo("compression",Xe)},Ee.exports=et},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(vt,Ee,ve){"use strict";var b=vt("./stream/GenericWorker");ve.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},ve.DEFLATE=vt("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(vt,Ee,ve){"use strict";var b=vt("./utils"),z=function(){for(var ke,xe=[],et=0;et<256;et++){ke=et;for(var Je=0;Je<8;Je++)ke=1&ke?3988292384^ke>>>1:ke>>>1;xe[et]=ke}return xe}();Ee.exports=function(ke,xe){return void 0!==ke&&ke.length?"string"!==b.getTypeOf(ke)?function(et,Je,Xe,ot){var Re=z,He=0+Xe;et^=-1;for(var Ie=0;Ie<He;Ie++)et=et>>>8^Re[255&(et^Je[Ie])];return~et}(0|xe,ke,ke.length):function(et,Je,Xe,ot){var Re=z,He=0+Xe;et^=-1;for(var Ie=0;Ie<He;Ie++)et=et>>>8^Re[255&(et^Je.charCodeAt(Ie))];return~et}(0|xe,ke,ke.length):0}},{"./utils":32}],5:[function(vt,Ee,ve){"use strict";ve.base64=!1,ve.binary=!1,ve.dir=!1,ve.createFolders=!0,ve.date=null,ve.compression=null,ve.compressionOptions=null,ve.comment=null,ve.unixPermissions=null,ve.dosPermissions=null},{}],6:[function(vt,Ee,ve){"use strict";var b;b=typeof Promise<"u"?Promise:vt("lie"),Ee.exports={Promise:b}},{lie:37}],7:[function(vt,Ee,ve){"use strict";var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",z=vt("pako"),ke=vt("./utils"),xe=vt("./stream/GenericWorker"),et=b?"uint8array":"array";function Je(Xe,ot){xe.call(this,"FlateWorker/"+Xe),this._pako=null,this._pakoAction=Xe,this._pakoOptions=ot,this.meta={}}ve.magic="\b\0",ke.inherits(Je,xe),Je.prototype.processChunk=function(Xe){this.meta=Xe.meta,null===this._pako&&this._createPako(),this._pako.push(ke.transformTo(et,Xe.data),!1)},Je.prototype.flush=function(){xe.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Je.prototype.cleanUp=function(){xe.prototype.cleanUp.call(this),this._pako=null},Je.prototype._createPako=function(){this._pako=new z[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var Xe=this;this._pako.onData=function(ot){Xe.push({data:ot,meta:Xe.meta})}},ve.compressWorker=function(Xe){return new Je("Deflate",Xe)},ve.uncompressWorker=function(){return new Je("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(vt,Ee,ve){"use strict";function b(Re,He){var Ie,O="";for(Ie=0;Ie<He;Ie++)O+=String.fromCharCode(255&Re),Re>>>=8;return O}function z(Re,He,Ie,O,ce,ie){var he,ue,fe=Re.file,le=Re.compression,Y=ie!==et.utf8encode,V=ke.transformTo("string",ie(fe.name)),D=ke.transformTo("string",et.utf8encode(fe.name)),w=fe.comment,P=ke.transformTo("string",ie(w)),x=ke.transformTo("string",et.utf8encode(w)),v=D.length!==fe.name.length,_=x.length!==w.length,C="",L="",F="",U=fe.dir,j=fe.date,te={crc32:0,compressedSize:0,uncompressedSize:0};He&&!Ie||(te.crc32=Re.crc32,te.compressedSize=Re.compressedSize,te.uncompressedSize=Re.uncompressedSize);var N=0;He&&(N|=8),Y||!v&&!_||(N|=2048);var R,J,m=0,I=0;U&&(m|=16),"UNIX"===ce?(I=798,m|=(J=R=fe.unixPermissions,R||(J=U?16893:33204),(65535&J)<<16)):(I=20,m|=function(R){return 63&(R||0)}(fe.dosPermissions)),he=j.getUTCHours(),he<<=6,he|=j.getUTCMinutes(),he<<=5,he|=j.getUTCSeconds()/2,ue=j.getUTCFullYear()-1980,ue<<=4,ue|=j.getUTCMonth()+1,ue<<=5,ue|=j.getUTCDate(),v&&(L=b(1,1)+b(Je(V),4)+D,C+="up"+b(L.length,2)+L),_&&(F=b(1,1)+b(Je(P),4)+x,C+="uc"+b(F.length,2)+F);var A="";return A+="\n\0",A+=b(N,2),A+=le.magic,A+=b(he,2),A+=b(ue,2),A+=b(te.crc32,4),A+=b(te.compressedSize,4),A+=b(te.uncompressedSize,4),A+=b(V.length,2),A+=b(C.length,2),{fileRecord:Xe.LOCAL_FILE_HEADER+A+V+C,dirRecord:Xe.CENTRAL_FILE_HEADER+b(I,2)+A+b(P.length,2)+"\0\0\0\0"+b(m,4)+b(O,4)+V+C+P}}var ke=vt("../utils"),xe=vt("../stream/GenericWorker"),et=vt("../utf8"),Je=vt("../crc32"),Xe=vt("../signature");function ot(Re,He,Ie,O){xe.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=He,this.zipPlatform=Ie,this.encodeFileName=O,this.streamFiles=Re,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}ke.inherits(ot,xe),ot.prototype.push=function(Re){var He=Re.meta.percent||0,Ie=this.entriesCount,O=this._sources.length;this.accumulate?this.contentBuffer.push(Re):(this.bytesWritten+=Re.data.length,xe.prototype.push.call(this,{data:Re.data,meta:{currentFile:this.currentFile,percent:Ie?(He+100*(Ie-O-1))/Ie:100}}))},ot.prototype.openedSource=function(Re){this.currentSourceOffset=this.bytesWritten,this.currentFile=Re.file.name;var He=this.streamFiles&&!Re.file.dir;if(He){var Ie=z(Re,He,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:Ie.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ot.prototype.closedSource=function(Re){this.accumulate=!1;var O,He=this.streamFiles&&!Re.file.dir,Ie=z(Re,He,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(Ie.dirRecord),He)this.push({data:(O=Re,Xe.DATA_DESCRIPTOR+b(O.crc32,4)+b(O.compressedSize,4)+b(O.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:Ie.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ot.prototype.flush=function(){for(var Re=this.bytesWritten,He=0;He<this.dirRecords.length;He++)this.push({data:this.dirRecords[He],meta:{percent:100}});var ce,ie,he,le,O=(ce=this.dirRecords.length,ie=this.bytesWritten-Re,he=Re,le=ke.transformTo("string",(0,this.encodeFileName)(this.zipComment)),Xe.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(ce,2)+b(ce,2)+b(ie,4)+b(he,4)+b(le.length,2)+le);this.push({data:O,meta:{percent:100}})},ot.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ot.prototype.registerPrevious=function(Re){this._sources.push(Re);var He=this;return Re.on("data",function(Ie){He.processChunk(Ie)}),Re.on("end",function(){He.closedSource(He.previous.streamInfo),He._sources.length?He.prepareNextSource():He.end()}),Re.on("error",function(Ie){He.error(Ie)}),this},ot.prototype.resume=function(){return!!xe.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ot.prototype.error=function(Re){var He=this._sources;if(!xe.prototype.error.call(this,Re))return!1;for(var Ie=0;Ie<He.length;Ie++)try{He[Ie].error(Re)}catch{}return!0},ot.prototype.lock=function(){xe.prototype.lock.call(this);for(var Re=this._sources,He=0;He<Re.length;He++)Re[He].lock()},Ee.exports=ot},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(vt,Ee,ve){"use strict";var b=vt("../compressions"),z=vt("./ZipFileWorker");ve.generateWorker=function(ke,xe,et){var Je=new z(xe.streamFiles,et,xe.platform,xe.encodeFileName),Xe=0;try{ke.forEach(function(ot,Re){Xe++;var He=function(ie,he){var ue=ie||he,fe=b[ue];if(!fe)throw new Error(ue+" is not a valid compression method !");return fe}(Re.options.compression,xe.compression),O=Re.dir,ce=Re.date;Re._compressWorker(He,Re.options.compressionOptions||xe.compressionOptions||{}).withStreamInfo("file",{name:ot,dir:O,date:ce,comment:Re.comment||"",unixPermissions:Re.unixPermissions,dosPermissions:Re.dosPermissions}).pipe(Je)}),Je.entriesCount=Xe}catch(ot){Je.error(ot)}return Je}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(vt,Ee,ve){"use strict";function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var z=new b;for(var ke in this)"function"!=typeof this[ke]&&(z[ke]=this[ke]);return z}}(b.prototype=vt("./object")).loadAsync=vt("./load"),b.support=vt("./support"),b.defaults=vt("./defaults"),b.version="3.10.1",b.loadAsync=function(z,ke){return(new b).loadAsync(z,ke)},b.external=vt("./external"),Ee.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(vt,Ee,ve){"use strict";var b=vt("./utils"),z=vt("./external"),ke=vt("./utf8"),xe=vt("./zipEntries"),et=vt("./stream/Crc32Probe"),Je=vt("./nodejsUtils");function Xe(ot){return new z.Promise(function(Re,He){var Ie=ot.decompressed.getContentWorker().pipe(new et);Ie.on("error",function(O){He(O)}).on("end",function(){Ie.streamInfo.crc32!==ot.decompressed.crc32?He(new Error("Corrupted zip : CRC32 mismatch")):Re()}).resume()})}Ee.exports=function(ot,Re){var He=this;return Re=b.extend(Re||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:ke.utf8decode}),Je.isNode&&Je.isStream(ot)?z.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",ot,!0,Re.optimizedBinaryString,Re.base64).then(function(Ie){var O=new xe(Re);return O.load(Ie),O}).then(function(Ie){var O=[z.Promise.resolve(Ie)],ce=Ie.files;if(Re.checkCRC32)for(var ie=0;ie<ce.length;ie++)O.push(Xe(ce[ie]));return z.Promise.all(O)}).then(function(Ie){for(var O=Ie.shift(),ce=O.files,ie=0;ie<ce.length;ie++){var he=ce[ie],ue=he.fileNameStr,fe=b.resolve(he.fileNameStr);He.file(fe,he.decompressed,{binary:!0,optimizedBinaryString:!0,date:he.date,dir:he.dir,comment:he.fileCommentStr.length?he.fileCommentStr:null,unixPermissions:he.unixPermissions,dosPermissions:he.dosPermissions,createFolders:Re.createFolders}),he.dir||(He.file(fe).unsafeOriginalName=ue)}return O.zipComment.length&&(He.comment=O.zipComment),He})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(vt,Ee,ve){"use strict";var b=vt("../utils"),z=vt("../stream/GenericWorker");function ke(xe,et){z.call(this,"Nodejs stream input adapter for "+xe),this._upstreamEnded=!1,this._bindStream(et)}b.inherits(ke,z),ke.prototype._bindStream=function(xe){var et=this;(this._stream=xe).pause(),xe.on("data",function(Je){et.push({data:Je,meta:{percent:0}})}).on("error",function(Je){et.isPaused?this.generatedError=Je:et.error(Je)}).on("end",function(){et.isPaused?et._upstreamEnded=!0:et.end()})},ke.prototype.pause=function(){return!!z.prototype.pause.call(this)&&(this._stream.pause(),!0)},ke.prototype.resume=function(){return!!z.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Ee.exports=ke},{"../stream/GenericWorker":28,"../utils":32}],13:[function(vt,Ee,ve){"use strict";var b=vt("readable-stream").Readable;function z(ke,xe,et){b.call(this,xe),this._helper=ke;var Je=this;ke.on("data",function(Xe,ot){Je.push(Xe)||Je._helper.pause(),et&&et(ot)}).on("error",function(Xe){Je.emit("error",Xe)}).on("end",function(){Je.push(null)})}vt("../utils").inherits(z,b),z.prototype._read=function(){this._helper.resume()},Ee.exports=z},{"../utils":32,"readable-stream":16}],14:[function(vt,Ee,ve){"use strict";Ee.exports={isNode:typeof Buffer<"u",newBufferFrom:function(b,z){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(b,z);if("number"==typeof b)throw new Error('The "data" argument must not be a number');return new Buffer(b,z)},allocBuffer:function(b){if(Buffer.alloc)return Buffer.alloc(b);var z=new Buffer(b);return z.fill(0),z},isBuffer:function(b){return Buffer.isBuffer(b)},isStream:function(b){return b&&"function"==typeof b.on&&"function"==typeof b.pause&&"function"==typeof b.resume}}},{}],15:[function(vt,Ee,ve){"use strict";function b(fe,le,Y){var V,D=ke.getTypeOf(le),w=ke.extend(Y||{},Je);w.date=w.date||new Date,null!==w.compression&&(w.compression=w.compression.toUpperCase()),"string"==typeof w.unixPermissions&&(w.unixPermissions=parseInt(w.unixPermissions,8)),w.unixPermissions&&16384&w.unixPermissions&&(w.dir=!0),w.dosPermissions&&16&w.dosPermissions&&(w.dir=!0),w.dir&&(fe=ce(fe)),w.createFolders&&(V=O(fe))&&ie.call(this,V,!0),Y&&void 0!==Y.binary||(w.binary=!("string"===D&&!1===w.binary&&!1===w.base64)),(le instanceof Xe&&0===le.uncompressedSize||w.dir||!le||0===le.length)&&(w.base64=!1,w.binary=!0,le="",w.compression="STORE",D="string");var x;x=le instanceof Xe||le instanceof xe?le:He.isNode&&He.isStream(le)?new Ie(fe,le):ke.prepareContent(fe,le,w.binary,w.optimizedBinaryString,w.base64);var v=new ot(fe,x,w);this.files[fe]=v}var z=vt("./utf8"),ke=vt("./utils"),xe=vt("./stream/GenericWorker"),et=vt("./stream/StreamHelper"),Je=vt("./defaults"),Xe=vt("./compressedObject"),ot=vt("./zipObject"),Re=vt("./generate"),He=vt("./nodejsUtils"),Ie=vt("./nodejs/NodejsStreamInputAdapter"),O=function(fe){"/"===fe.slice(-1)&&(fe=fe.substring(0,fe.length-1));var le=fe.lastIndexOf("/");return 0<le?fe.substring(0,le):""},ce=function(fe){return"/"!==fe.slice(-1)&&(fe+="/"),fe},ie=function(fe,le){return le=void 0!==le?le:Je.createFolders,fe=ce(fe),this.files[fe]||b.call(this,fe,null,{dir:!0,createFolders:le}),this.files[fe]};function he(fe){return"[object RegExp]"===Object.prototype.toString.call(fe)}var ue={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(fe){var le,Y,V;for(le in this.files)V=this.files[le],(Y=le.slice(this.root.length,le.length))&&le.slice(0,this.root.length)===this.root&&fe(Y,V)},filter:function(fe){var le=[];return this.forEach(function(Y,V){fe(Y,V)&&le.push(V)}),le},file:function(fe,le,Y){if(1!==arguments.length)return b.call(this,fe=this.root+fe,le,Y),this;if(he(fe)){var V=fe;return this.filter(function(w,P){return!P.dir&&V.test(w)})}var D=this.files[this.root+fe];return D&&!D.dir?D:null},folder:function(fe){if(!fe)return this;if(he(fe))return this.filter(function(D,w){return w.dir&&fe.test(D)});var Y=ie.call(this,this.root+fe),V=this.clone();return V.root=Y.name,V},remove:function(fe){var le=this.files[fe=this.root+fe];if(le||("/"!==fe.slice(-1)&&(fe+="/"),le=this.files[fe]),le&&!le.dir)delete this.files[fe];else for(var Y=this.filter(function(D,w){return w.name.slice(0,fe.length)===fe}),V=0;V<Y.length;V++)delete this.files[Y[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(fe){var le,Y={};try{if((Y=ke.extend(fe||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:z.utf8encode})).type=Y.type.toLowerCase(),Y.compression=Y.compression.toUpperCase(),"binarystring"===Y.type&&(Y.type="string"),!Y.type)throw new Error("No output type specified.");ke.checkSupport(Y.type),"darwin"!==Y.platform&&"freebsd"!==Y.platform&&"linux"!==Y.platform&&"sunos"!==Y.platform||(Y.platform="UNIX"),"win32"===Y.platform&&(Y.platform="DOS"),le=Re.generateWorker(this,Y,Y.comment||this.comment||"")}catch(D){(le=new xe("error")).error(D)}return new et(le,Y.type||"string",Y.mimeType)},generateAsync:function(fe,le){return this.generateInternalStream(fe).accumulate(le)},generateNodeStream:function(fe,le){return(fe=fe||{}).type||(fe.type="nodebuffer"),this.generateInternalStream(fe).toNodejsStream(le)}};Ee.exports=ue},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(vt,Ee,ve){"use strict";Ee.exports=vt("stream")},{stream:void 0}],17:[function(vt,Ee,ve){"use strict";var b=vt("./DataReader");function z(ke){b.call(this,ke);for(var xe=0;xe<this.data.length;xe++)ke[xe]=255&ke[xe]}vt("../utils").inherits(z,b),z.prototype.byteAt=function(ke){return this.data[this.zero+ke]},z.prototype.lastIndexOfSignature=function(ke){for(var xe=ke.charCodeAt(0),et=ke.charCodeAt(1),Je=ke.charCodeAt(2),Xe=ke.charCodeAt(3),ot=this.length-4;0<=ot;--ot)if(this.data[ot]===xe&&this.data[ot+1]===et&&this.data[ot+2]===Je&&this.data[ot+3]===Xe)return ot-this.zero;return-1},z.prototype.readAndCheckSignature=function(ke){var xe=ke.charCodeAt(0),et=ke.charCodeAt(1),Je=ke.charCodeAt(2),Xe=ke.charCodeAt(3),ot=this.readData(4);return xe===ot[0]&&et===ot[1]&&Je===ot[2]&&Xe===ot[3]},z.prototype.readData=function(ke){if(this.checkOffset(ke),0===ke)return[];var xe=this.data.slice(this.zero+this.index,this.zero+this.index+ke);return this.index+=ke,xe},Ee.exports=z},{"../utils":32,"./DataReader":18}],18:[function(vt,Ee,ve){"use strict";var b=vt("../utils");function z(ke){this.data=ke,this.length=ke.length,this.index=0,this.zero=0}z.prototype={checkOffset:function(ke){this.checkIndex(this.index+ke)},checkIndex:function(ke){if(this.length<this.zero+ke||ke<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+ke+"). Corrupted zip ?")},setIndex:function(ke){this.checkIndex(ke),this.index=ke},skip:function(ke){this.setIndex(this.index+ke)},byteAt:function(){},readInt:function(ke){var xe,et=0;for(this.checkOffset(ke),xe=this.index+ke-1;xe>=this.index;xe--)et=(et<<8)+this.byteAt(xe);return this.index+=ke,et},readString:function(ke){return b.transformTo("string",this.readData(ke))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var ke=this.readInt(4);return new Date(Date.UTC(1980+(ke>>25&127),(ke>>21&15)-1,ke>>16&31,ke>>11&31,ke>>5&63,(31&ke)<<1))}},Ee.exports=z},{"../utils":32}],19:[function(vt,Ee,ve){"use strict";var b=vt("./Uint8ArrayReader");function z(ke){b.call(this,ke)}vt("../utils").inherits(z,b),z.prototype.readData=function(ke){this.checkOffset(ke);var xe=this.data.slice(this.zero+this.index,this.zero+this.index+ke);return this.index+=ke,xe},Ee.exports=z},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(vt,Ee,ve){"use strict";var b=vt("./DataReader");function z(ke){b.call(this,ke)}vt("../utils").inherits(z,b),z.prototype.byteAt=function(ke){return this.data.charCodeAt(this.zero+ke)},z.prototype.lastIndexOfSignature=function(ke){return this.data.lastIndexOf(ke)-this.zero},z.prototype.readAndCheckSignature=function(ke){return ke===this.readData(4)},z.prototype.readData=function(ke){this.checkOffset(ke);var xe=this.data.slice(this.zero+this.index,this.zero+this.index+ke);return this.index+=ke,xe},Ee.exports=z},{"../utils":32,"./DataReader":18}],21:[function(vt,Ee,ve){"use strict";var b=vt("./ArrayReader");function z(ke){b.call(this,ke)}vt("../utils").inherits(z,b),z.prototype.readData=function(ke){if(this.checkOffset(ke),0===ke)return new Uint8Array(0);var xe=this.data.subarray(this.zero+this.index,this.zero+this.index+ke);return this.index+=ke,xe},Ee.exports=z},{"../utils":32,"./ArrayReader":17}],22:[function(vt,Ee,ve){"use strict";var b=vt("../utils"),z=vt("../support"),ke=vt("./ArrayReader"),xe=vt("./StringReader"),et=vt("./NodeBufferReader"),Je=vt("./Uint8ArrayReader");Ee.exports=function(Xe){var ot=b.getTypeOf(Xe);return b.checkSupport(ot),"string"!==ot||z.uint8array?"nodebuffer"===ot?new et(Xe):z.uint8array?new Je(b.transformTo("uint8array",Xe)):new ke(b.transformTo("array",Xe)):new xe(Xe)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(vt,Ee,ve){"use strict";ve.LOCAL_FILE_HEADER="PK\x03\x04",ve.CENTRAL_FILE_HEADER="PK\x01\x02",ve.CENTRAL_DIRECTORY_END="PK\x05\x06",ve.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",ve.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",ve.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(vt,Ee,ve){"use strict";var b=vt("./GenericWorker"),z=vt("../utils");function ke(xe){b.call(this,"ConvertWorker to "+xe),this.destType=xe}z.inherits(ke,b),ke.prototype.processChunk=function(xe){this.push({data:z.transformTo(this.destType,xe.data),meta:xe.meta})},Ee.exports=ke},{"../utils":32,"./GenericWorker":28}],25:[function(vt,Ee,ve){"use strict";var b=vt("./GenericWorker"),z=vt("../crc32");function ke(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}vt("../utils").inherits(ke,b),ke.prototype.processChunk=function(xe){this.streamInfo.crc32=z(xe.data,this.streamInfo.crc32||0),this.push(xe)},Ee.exports=ke},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(vt,Ee,ve){"use strict";var b=vt("../utils"),z=vt("./GenericWorker");function ke(xe){z.call(this,"DataLengthProbe for "+xe),this.propName=xe,this.withStreamInfo(xe,0)}b.inherits(ke,z),ke.prototype.processChunk=function(xe){xe&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+xe.data.length),z.prototype.processChunk.call(this,xe)},Ee.exports=ke},{"../utils":32,"./GenericWorker":28}],27:[function(vt,Ee,ve){"use strict";var b=vt("../utils"),z=vt("./GenericWorker");function ke(xe){z.call(this,"DataWorker");var et=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,xe.then(function(Je){et.dataIsReady=!0,et.data=Je,et.max=Je&&Je.length||0,et.type=b.getTypeOf(Je),et.isPaused||et._tickAndRepeat()},function(Je){et.error(Je)})}b.inherits(ke,z),ke.prototype.cleanUp=function(){z.prototype.cleanUp.call(this),this.data=null},ke.prototype.resume=function(){return!!z.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},ke.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},ke.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var xe=null,et=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":xe=this.data.substring(this.index,et);break;case"uint8array":xe=this.data.subarray(this.index,et);break;case"array":case"nodebuffer":xe=this.data.slice(this.index,et)}return this.index=et,this.push({data:xe,meta:{percent:this.max?this.index/this.max*100:0}})},Ee.exports=ke},{"../utils":32,"./GenericWorker":28}],28:[function(vt,Ee,ve){"use strict";function b(z){this.name=z||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(z){this.emit("data",z)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(z){this.emit("error",z)}return!0},error:function(z){return!this.isFinished&&(this.isPaused?this.generatedError=z:(this.isFinished=!0,this.emit("error",z),this.previous&&this.previous.error(z),this.cleanUp()),!0)},on:function(z,ke){return this._listeners[z].push(ke),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(z,ke){if(this._listeners[z])for(var xe=0;xe<this._listeners[z].length;xe++)this._listeners[z][xe].call(this,ke)},pipe:function(z){return z.registerPrevious(this)},registerPrevious:function(z){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=z.streamInfo,this.mergeStreamInfo(),this.previous=z;var ke=this;return z.on("data",function(xe){ke.processChunk(xe)}),z.on("end",function(){ke.end()}),z.on("error",function(xe){ke.error(xe)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var z=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),z=!0),this.previous&&this.previous.resume(),!z},flush:function(){},processChunk:function(z){this.push(z)},withStreamInfo:function(z,ke){return this.extraStreamInfo[z]=ke,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var z in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,z)&&(this.streamInfo[z]=this.extraStreamInfo[z])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var z="Worker "+this.name;return this.previous?this.previous+" -> "+z:z}},Ee.exports=b},{}],29:[function(vt,Ee,ve){"use strict";var b=vt("../utils"),z=vt("./ConvertWorker"),ke=vt("./GenericWorker"),xe=vt("../base64"),et=vt("../support"),Je=vt("../external"),Xe=null;if(et.nodestream)try{Xe=vt("../nodejs/NodejsStreamOutputAdapter")}catch{}function Re(He,Ie,O){var ce=Ie;switch(Ie){case"blob":case"arraybuffer":ce="uint8array";break;case"base64":ce="string"}try{this._internalType=ce,this._outputType=Ie,this._mimeType=O,b.checkSupport(ce),this._worker=He.pipe(new z(ce)),He.lock()}catch(ie){this._worker=new ke("error"),this._worker.error(ie)}}Re.prototype={accumulate:function(He){return function ot(He,Ie){return new Je.Promise(function(O,ce){var ie=[],he=He._internalType,ue=He._outputType,fe=He._mimeType;He.on("data",function(le,Y){ie.push(le),Ie&&Ie(Y)}).on("error",function(le){ie=[],ce(le)}).on("end",function(){try{var le=function(Y,V,D){switch(Y){case"blob":return b.newBlob(b.transformTo("arraybuffer",V),D);case"base64":return xe.encode(V);default:return b.transformTo(Y,V)}}(ue,function(Y,V){var D,w=0,P=null,x=0;for(D=0;D<V.length;D++)x+=V[D].length;switch(Y){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(P=new Uint8Array(x),D=0;D<V.length;D++)P.set(V[D],w),w+=V[D].length;return P;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+Y+"'")}}(he,ie),fe);O(le)}catch(Y){ce(Y)}ie=[]}).resume()})}(this,He)},on:function(He,Ie){var O=this;return this._worker.on(He,"data"===He?function(ce){Ie.call(O,ce.data,ce.meta)}:function(){b.delay(Ie,arguments,O)}),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(He){if(b.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Xe(this,{objectMode:"nodebuffer"!==this._outputType},He)}},Ee.exports=Re},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(vt,Ee,ve){"use strict";if(ve.base64=!0,ve.array=!0,ve.string=!0,ve.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",ve.nodebuffer=typeof Buffer<"u",ve.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")ve.blob=!1;else{var b=new ArrayBuffer(0);try{ve.blob=0===new Blob([b],{type:"application/zip"}).size}catch{try{var z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);z.append(b),ve.blob=0===z.getBlob("application/zip").size}catch{ve.blob=!1}}}try{ve.nodestream=!!vt("readable-stream").Readable}catch{ve.nodestream=!1}},{"readable-stream":16}],31:[function(vt,Ee,ve){"use strict";for(var b=vt("./utils"),z=vt("./support"),ke=vt("./nodejsUtils"),xe=vt("./stream/GenericWorker"),et=new Array(256),Je=0;Je<256;Je++)et[Je]=252<=Je?6:248<=Je?5:240<=Je?4:224<=Je?3:192<=Je?2:1;function Xe(){xe.call(this,"utf-8 decode"),this.leftOver=null}function ot(){xe.call(this,"utf-8 encode")}et[254]=et[254]=1,ve.utf8encode=function(Re){return z.nodebuffer?ke.newBufferFrom(Re,"utf-8"):function(He){var Ie,O,ce,ie,he,ue=He.length,fe=0;for(ie=0;ie<ue;ie++)55296==(64512&(O=He.charCodeAt(ie)))&&ie+1<ue&&56320==(64512&(ce=He.charCodeAt(ie+1)))&&(O=65536+(O-55296<<10)+(ce-56320),ie++),fe+=O<128?1:O<2048?2:O<65536?3:4;for(Ie=z.uint8array?new Uint8Array(fe):new Array(fe),ie=he=0;he<fe;ie++)55296==(64512&(O=He.charCodeAt(ie)))&&ie+1<ue&&56320==(64512&(ce=He.charCodeAt(ie+1)))&&(O=65536+(O-55296<<10)+(ce-56320),ie++),O<128?Ie[he++]=O:(O<2048?Ie[he++]=192|O>>>6:(O<65536?Ie[he++]=224|O>>>12:(Ie[he++]=240|O>>>18,Ie[he++]=128|O>>>12&63),Ie[he++]=128|O>>>6&63),Ie[he++]=128|63&O);return Ie}(Re)},ve.utf8decode=function(Re){return z.nodebuffer?b.transformTo("nodebuffer",Re).toString("utf-8"):function(He){var Ie,O,ce,ie,he=He.length,ue=new Array(2*he);for(Ie=O=0;Ie<he;)if((ce=He[Ie++])<128)ue[O++]=ce;else if(4<(ie=et[ce]))ue[O++]=65533,Ie+=ie-1;else{for(ce&=2===ie?31:3===ie?15:7;1<ie&&Ie<he;)ce=ce<<6|63&He[Ie++],ie--;1<ie?ue[O++]=65533:ce<65536?ue[O++]=ce:(ue[O++]=55296|(ce-=65536)>>10&1023,ue[O++]=56320|1023&ce)}return ue.length!==O&&(ue.subarray?ue=ue.subarray(0,O):ue.length=O),b.applyFromCharCode(ue)}(Re=b.transformTo(z.uint8array?"uint8array":"array",Re))},b.inherits(Xe,xe),Xe.prototype.processChunk=function(Re){var He=b.transformTo(z.uint8array?"uint8array":"array",Re.data);if(this.leftOver&&this.leftOver.length){if(z.uint8array){var Ie=He;(He=new Uint8Array(Ie.length+this.leftOver.length)).set(this.leftOver,0),He.set(Ie,this.leftOver.length)}else He=this.leftOver.concat(He);this.leftOver=null}var O=function(ie,he){var ue;for((he=he||ie.length)>ie.length&&(he=ie.length),ue=he-1;0<=ue&&128==(192&ie[ue]);)ue--;return ue<0||0===ue?he:ue+et[ie[ue]]>he?ue:he}(He),ce=He;O!==He.length&&(z.uint8array?(ce=He.subarray(0,O),this.leftOver=He.subarray(O,He.length)):(ce=He.slice(0,O),this.leftOver=He.slice(O,He.length))),this.push({data:ve.utf8decode(ce),meta:Re.meta})},Xe.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:ve.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},ve.Utf8DecodeWorker=Xe,b.inherits(ot,xe),ot.prototype.processChunk=function(Re){this.push({data:ve.utf8encode(Re.data),meta:Re.meta})},ve.Utf8EncodeWorker=ot},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(vt,Ee,ve){"use strict";var b=vt("./support"),z=vt("./base64"),ke=vt("./nodejsUtils"),xe=vt("./external");function et(Ie){return Ie}function Je(Ie,O){for(var ce=0;ce<Ie.length;++ce)O[ce]=255&Ie.charCodeAt(ce);return O}vt("setimmediate"),ve.newBlob=function(Ie,O){ve.checkSupport("blob");try{return new Blob([Ie],{type:O})}catch{try{var ce=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return ce.append(Ie),ce.getBlob(O)}catch{throw new Error("Bug : can't construct the Blob.")}}};var Xe={stringifyByChunk:function(Ie,O,ce){var ie=[],he=0,ue=Ie.length;if(ue<=ce)return String.fromCharCode.apply(null,Ie);for(;he<ue;)ie.push(String.fromCharCode.apply(null,"array"===O||"nodebuffer"===O?Ie.slice(he,Math.min(he+ce,ue)):Ie.subarray(he,Math.min(he+ce,ue)))),he+=ce;return ie.join("")},stringifyByChar:function(Ie){for(var O="",ce=0;ce<Ie.length;ce++)O+=String.fromCharCode(Ie[ce]);return O},applyCanBeUsed:{uint8array:function(){try{return b.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return b.nodebuffer&&1===String.fromCharCode.apply(null,ke.allocBuffer(1)).length}catch{return!1}}()}};function ot(Ie){var O=65536,ce=ve.getTypeOf(Ie),ie=!0;if("uint8array"===ce?ie=Xe.applyCanBeUsed.uint8array:"nodebuffer"===ce&&(ie=Xe.applyCanBeUsed.nodebuffer),ie)for(;1<O;)try{return Xe.stringifyByChunk(Ie,ce,O)}catch{O=Math.floor(O/2)}return Xe.stringifyByChar(Ie)}function Re(Ie,O){for(var ce=0;ce<Ie.length;ce++)O[ce]=Ie[ce];return O}ve.applyFromCharCode=ot;var He={};He.string={string:et,array:function(Ie){return Je(Ie,new Array(Ie.length))},arraybuffer:function(Ie){return He.string.uint8array(Ie).buffer},uint8array:function(Ie){return Je(Ie,new Uint8Array(Ie.length))},nodebuffer:function(Ie){return Je(Ie,ke.allocBuffer(Ie.length))}},He.array={string:ot,array:et,arraybuffer:function(Ie){return new Uint8Array(Ie).buffer},uint8array:function(Ie){return new Uint8Array(Ie)},nodebuffer:function(Ie){return ke.newBufferFrom(Ie)}},He.arraybuffer={string:function(Ie){return ot(new Uint8Array(Ie))},array:function(Ie){return Re(new Uint8Array(Ie),new Array(Ie.byteLength))},arraybuffer:et,uint8array:function(Ie){return new Uint8Array(Ie)},nodebuffer:function(Ie){return ke.newBufferFrom(new Uint8Array(Ie))}},He.uint8array={string:ot,array:function(Ie){return Re(Ie,new Array(Ie.length))},arraybuffer:function(Ie){return Ie.buffer},uint8array:et,nodebuffer:function(Ie){return ke.newBufferFrom(Ie)}},He.nodebuffer={string:ot,array:function(Ie){return Re(Ie,new Array(Ie.length))},arraybuffer:function(Ie){return He.nodebuffer.uint8array(Ie).buffer},uint8array:function(Ie){return Re(Ie,new Uint8Array(Ie.length))},nodebuffer:et},ve.transformTo=function(Ie,O){if(O=O||"",!Ie)return O;ve.checkSupport(Ie);var ce=ve.getTypeOf(O);return He[ce][Ie](O)},ve.resolve=function(Ie){for(var O=Ie.split("/"),ce=[],ie=0;ie<O.length;ie++){var he=O[ie];"."===he||""===he&&0!==ie&&ie!==O.length-1||(".."===he?ce.pop():ce.push(he))}return ce.join("/")},ve.getTypeOf=function(Ie){return"string"==typeof Ie?"string":"[object Array]"===Object.prototype.toString.call(Ie)?"array":b.nodebuffer&&ke.isBuffer(Ie)?"nodebuffer":b.uint8array&&Ie instanceof Uint8Array?"uint8array":b.arraybuffer&&Ie instanceof ArrayBuffer?"arraybuffer":void 0},ve.checkSupport=function(Ie){if(!b[Ie.toLowerCase()])throw new Error(Ie+" is not supported by this platform")},ve.MAX_VALUE_16BITS=65535,ve.MAX_VALUE_32BITS=-1,ve.pretty=function(Ie){var O,ce,ie="";for(ce=0;ce<(Ie||"").length;ce++)ie+="\\x"+((O=Ie.charCodeAt(ce))<16?"0":"")+O.toString(16).toUpperCase();return ie},ve.delay=function(Ie,O,ce){setImmediate(function(){Ie.apply(ce||null,O||[])})},ve.inherits=function(Ie,O){function ce(){}ce.prototype=O.prototype,Ie.prototype=new ce},ve.extend=function(){var Ie,O,ce={};for(Ie=0;Ie<arguments.length;Ie++)for(O in arguments[Ie])Object.prototype.hasOwnProperty.call(arguments[Ie],O)&&void 0===ce[O]&&(ce[O]=arguments[Ie][O]);return ce},ve.prepareContent=function(Ie,O,ce,ie,he){return xe.Promise.resolve(O).then(function(ue){return b.blob&&(ue instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(ue)))&&typeof FileReader<"u"?new xe.Promise(function(fe,le){var Y=new FileReader;Y.onload=function(V){fe(V.target.result)},Y.onerror=function(V){le(V.target.error)},Y.readAsArrayBuffer(ue)}):ue}).then(function(ue){var le,fe=ve.getTypeOf(ue);return fe?("arraybuffer"===fe?ue=ve.transformTo("uint8array",ue):"string"===fe&&(he?ue=z.decode(ue):ce&&!0!==ie&&(ue=Je(le=ue,b.uint8array?new Uint8Array(le.length):new Array(le.length)))),ue):xe.Promise.reject(new Error("Can't read the data of '"+Ie+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(vt,Ee,ve){"use strict";var b=vt("./reader/readerFor"),z=vt("./utils"),ke=vt("./signature"),xe=vt("./zipEntry"),et=vt("./support");function Je(Xe){this.files=[],this.loadOptions=Xe}Je.prototype={checkSignature:function(Xe){if(!this.reader.readAndCheckSignature(Xe)){this.reader.index-=4;var ot=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+z.pretty(ot)+", expected "+z.pretty(Xe)+")")}},isSignature:function(Xe,ot){var Re=this.reader.index;this.reader.setIndex(Xe);var He=this.reader.readString(4)===ot;return this.reader.setIndex(Re),He},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var Xe=this.reader.readData(this.zipCommentLength),Re=z.transformTo(et.uint8array?"uint8array":"array",Xe);this.zipComment=this.loadOptions.decodeFileName(Re)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var Xe,ot,Re,He=this.zip64EndOfCentralSize-44;0<He;)Xe=this.reader.readInt(2),ot=this.reader.readInt(4),Re=this.reader.readData(ot),this.zip64ExtensibleData[Xe]={id:Xe,length:ot,value:Re}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var Xe,ot;for(Xe=0;Xe<this.files.length;Xe++)this.reader.setIndex((ot=this.files[Xe]).localHeaderOffset),this.checkSignature(ke.LOCAL_FILE_HEADER),ot.readLocalPart(this.reader),ot.handleUTF8(),ot.processAttributes()},readCentralDir:function(){var Xe;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(ke.CENTRAL_FILE_HEADER);)(Xe=new xe({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(Xe);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var Xe=this.reader.lastIndexOfSignature(ke.CENTRAL_DIRECTORY_END);if(Xe<0)throw this.isSignature(0,ke.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(Xe);var ot=Xe;if(this.checkSignature(ke.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===z.MAX_VALUE_16BITS||this.diskWithCentralDirStart===z.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===z.MAX_VALUE_16BITS||this.centralDirRecords===z.MAX_VALUE_16BITS||this.centralDirSize===z.MAX_VALUE_32BITS||this.centralDirOffset===z.MAX_VALUE_32BITS){if(this.zip64=!0,(Xe=this.reader.lastIndexOfSignature(ke.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(Xe),this.checkSignature(ke.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,ke.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(ke.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ke.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Re=this.centralDirOffset+this.centralDirSize;this.zip64&&(Re+=20,Re+=12+this.zip64EndOfCentralSize);var He=ot-Re;if(0<He)this.isSignature(ot,ke.CENTRAL_FILE_HEADER)||(this.reader.zero=He);else if(He<0)throw new Error("Corrupted zip: missing "+Math.abs(He)+" bytes.")},prepareReader:function(Xe){this.reader=b(Xe)},load:function(Xe){this.prepareReader(Xe),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Ee.exports=Je},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(vt,Ee,ve){"use strict";var b=vt("./reader/readerFor"),z=vt("./utils"),ke=vt("./compressedObject"),xe=vt("./crc32"),et=vt("./utf8"),Je=vt("./compressions"),Xe=vt("./support");function ot(Re,He){this.options=Re,this.loadOptions=He}ot.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(Re){var He,Ie;if(Re.skip(22),this.fileNameLength=Re.readInt(2),Ie=Re.readInt(2),this.fileName=Re.readData(this.fileNameLength),Re.skip(Ie),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(He=function(O){for(var ce in Je)if(Object.prototype.hasOwnProperty.call(Je,ce)&&Je[ce].magic===O)return Je[ce];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+z.pretty(this.compressionMethod)+" unknown (inner file : "+z.transformTo("string",this.fileName)+")");this.decompressed=new ke(this.compressedSize,this.uncompressedSize,this.crc32,He,Re.readData(this.compressedSize))},readCentralPart:function(Re){this.versionMadeBy=Re.readInt(2),Re.skip(2),this.bitFlag=Re.readInt(2),this.compressionMethod=Re.readString(2),this.date=Re.readDate(),this.crc32=Re.readInt(4),this.compressedSize=Re.readInt(4),this.uncompressedSize=Re.readInt(4);var He=Re.readInt(2);if(this.extraFieldsLength=Re.readInt(2),this.fileCommentLength=Re.readInt(2),this.diskNumberStart=Re.readInt(2),this.internalFileAttributes=Re.readInt(2),this.externalFileAttributes=Re.readInt(4),this.localHeaderOffset=Re.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");Re.skip(He),this.readExtraFields(Re),this.parseZIP64ExtraField(Re),this.fileComment=Re.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var Re=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==Re&&(this.dosPermissions=63&this.externalFileAttributes),3==Re&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var Re=b(this.extraFields[1].value);this.uncompressedSize===z.MAX_VALUE_32BITS&&(this.uncompressedSize=Re.readInt(8)),this.compressedSize===z.MAX_VALUE_32BITS&&(this.compressedSize=Re.readInt(8)),this.localHeaderOffset===z.MAX_VALUE_32BITS&&(this.localHeaderOffset=Re.readInt(8)),this.diskNumberStart===z.MAX_VALUE_32BITS&&(this.diskNumberStart=Re.readInt(4))}},readExtraFields:function(Re){var He,Ie,O,ce=Re.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});Re.index+4<ce;)He=Re.readInt(2),Ie=Re.readInt(2),O=Re.readData(Ie),this.extraFields[He]={id:He,length:Ie,value:O};Re.setIndex(ce)},handleUTF8:function(){var Re=Xe.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=et.utf8decode(this.fileName),this.fileCommentStr=et.utf8decode(this.fileComment);else{var He=this.findExtraFieldUnicodePath();if(null!==He)this.fileNameStr=He;else{var Ie=z.transformTo(Re,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(Ie)}var O=this.findExtraFieldUnicodeComment();if(null!==O)this.fileCommentStr=O;else{var ce=z.transformTo(Re,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(ce)}}},findExtraFieldUnicodePath:function(){var Re=this.extraFields[28789];if(Re){var He=b(Re.value);return 1!==He.readInt(1)||xe(this.fileName)!==He.readInt(4)?null:et.utf8decode(He.readData(Re.length-5))}return null},findExtraFieldUnicodeComment:function(){var Re=this.extraFields[25461];if(Re){var He=b(Re.value);return 1!==He.readInt(1)||xe(this.fileComment)!==He.readInt(4)?null:et.utf8decode(He.readData(Re.length-5))}return null}},Ee.exports=ot},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(vt,Ee,ve){"use strict";function b(He,Ie,O){this.name=He,this.dir=O.dir,this.date=O.date,this.comment=O.comment,this.unixPermissions=O.unixPermissions,this.dosPermissions=O.dosPermissions,this._data=Ie,this._dataBinary=O.binary,this.options={compression:O.compression,compressionOptions:O.compressionOptions}}var z=vt("./stream/StreamHelper"),ke=vt("./stream/DataWorker"),xe=vt("./utf8"),et=vt("./compressedObject"),Je=vt("./stream/GenericWorker");b.prototype={internalStream:function(He){var Ie=null,O="string";try{if(!He)throw new Error("No output type specified.");var ce="string"===(O=He.toLowerCase())||"text"===O;"binarystring"!==O&&"text"!==O||(O="string"),Ie=this._decompressWorker();var ie=!this._dataBinary;ie&&!ce&&(Ie=Ie.pipe(new xe.Utf8EncodeWorker)),!ie&&ce&&(Ie=Ie.pipe(new xe.Utf8DecodeWorker))}catch(he){(Ie=new Je("error")).error(he)}return new z(Ie,O,"")},async:function(He,Ie){return this.internalStream(He).accumulate(Ie)},nodeStream:function(He,Ie){return this.internalStream(He||"nodebuffer").toNodejsStream(Ie)},_compressWorker:function(He,Ie){if(this._data instanceof et&&this._data.compression.magic===He.magic)return this._data.getCompressedWorker();var O=this._decompressWorker();return this._dataBinary||(O=O.pipe(new xe.Utf8EncodeWorker)),et.createWorkerFrom(O,He,Ie)},_decompressWorker:function(){return this._data instanceof et?this._data.getContentWorker():this._data instanceof Je?this._data:new ke(this._data)}};for(var Xe=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],ot=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Re=0;Re<Xe.length;Re++)b.prototype[Xe[Re]]=ot;Ee.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(vt,Ee,ve){(function(b){"use strict";var z,ke,xe=b.MutationObserver||b.WebKitMutationObserver;if(xe){var et=0,Je=new xe(He),Xe=b.document.createTextNode("");Je.observe(Xe,{characterData:!0}),z=function(){Xe.data=et=++et%2}}else if(b.setImmediate||void 0===b.MessageChannel)z="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var Ie=b.document.createElement("script");Ie.onreadystatechange=function(){He(),Ie.onreadystatechange=null,Ie.parentNode.removeChild(Ie),Ie=null},b.document.documentElement.appendChild(Ie)}:function(){setTimeout(He,0)};else{var ot=new b.MessageChannel;ot.port1.onmessage=He,z=function(){ot.port2.postMessage(0)}}var Re=[];function He(){var Ie,O;ke=!0;for(var ce=Re.length;ce;){for(O=Re,Re=[],Ie=-1;++Ie<ce;)O[Ie]();ce=Re.length}ke=!1}Ee.exports=function(Ie){1!==Re.push(Ie)||ke||z()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(vt,Ee,ve){"use strict";var b=vt("immediate");function z(){}var ke={},xe=["REJECTED"],et=["FULFILLED"],Je=["PENDING"];function Xe(ce){if("function"!=typeof ce)throw new TypeError("resolver must be a function");this.state=Je,this.queue=[],this.outcome=void 0,ce!==z&&Ie(this,ce)}function ot(ce,ie,he){this.promise=ce,"function"==typeof ie&&(this.onFulfilled=ie,this.callFulfilled=this.otherCallFulfilled),"function"==typeof he&&(this.onRejected=he,this.callRejected=this.otherCallRejected)}function Re(ce,ie,he){b(function(){var ue;try{ue=ie(he)}catch(fe){return ke.reject(ce,fe)}ue===ce?ke.reject(ce,new TypeError("Cannot resolve promise with itself")):ke.resolve(ce,ue)})}function He(ce){var ie=ce&&ce.then;if(ce&&("object"==typeof ce||"function"==typeof ce)&&"function"==typeof ie)return function(){ie.apply(ce,arguments)}}function Ie(ce,ie){var he=!1;function ue(Y){he||(he=!0,ke.reject(ce,Y))}function fe(Y){he||(he=!0,ke.resolve(ce,Y))}var le=O(function(){ie(fe,ue)});"error"===le.status&&ue(le.value)}function O(ce,ie){var he={};try{he.value=ce(ie),he.status="success"}catch(ue){he.status="error",he.value=ue}return he}(Ee.exports=Xe).prototype.finally=function(ce){if("function"!=typeof ce)return this;var ie=this.constructor;return this.then(function(he){return ie.resolve(ce()).then(function(){return he})},function(he){return ie.resolve(ce()).then(function(){throw he})})},Xe.prototype.catch=function(ce){return this.then(null,ce)},Xe.prototype.then=function(ce,ie){if("function"!=typeof ce&&this.state===et||"function"!=typeof ie&&this.state===xe)return this;var he=new this.constructor(z);return this.state!==Je?Re(he,this.state===et?ce:ie,this.outcome):this.queue.push(new ot(he,ce,ie)),he},ot.prototype.callFulfilled=function(ce){ke.resolve(this.promise,ce)},ot.prototype.otherCallFulfilled=function(ce){Re(this.promise,this.onFulfilled,ce)},ot.prototype.callRejected=function(ce){ke.reject(this.promise,ce)},ot.prototype.otherCallRejected=function(ce){Re(this.promise,this.onRejected,ce)},ke.resolve=function(ce,ie){var he=O(He,ie);if("error"===he.status)return ke.reject(ce,he.value);var ue=he.value;if(ue)Ie(ce,ue);else{ce.state=et,ce.outcome=ie;for(var fe=-1,le=ce.queue.length;++fe<le;)ce.queue[fe].callFulfilled(ie)}return ce},ke.reject=function(ce,ie){ce.state=xe,ce.outcome=ie;for(var he=-1,ue=ce.queue.length;++he<ue;)ce.queue[he].callRejected(ie);return ce},Xe.resolve=function(ce){return ce instanceof this?ce:ke.resolve(new this(z),ce)},Xe.reject=function(ce){var ie=new this(z);return ke.reject(ie,ce)},Xe.all=function(ce){var ie=this;if("[object Array]"!==Object.prototype.toString.call(ce))return this.reject(new TypeError("must be an array"));var he=ce.length,ue=!1;if(!he)return this.resolve([]);for(var fe=new Array(he),le=0,Y=-1,V=new this(z);++Y<he;)D(ce[Y],Y);return V;function D(w,P){ie.resolve(w).then(function(x){fe[P]=x,++le!==he||ue||(ue=!0,ke.resolve(V,fe))},function(x){ue||(ue=!0,ke.reject(V,x))})}},Xe.race=function(ce){if("[object Array]"!==Object.prototype.toString.call(ce))return this.reject(new TypeError("must be an array"));var he=ce.length,ue=!1;if(!he)return this.resolve([]);for(var fe=-1,le=new this(z);++fe<he;)this.resolve(ce[fe]).then(function(V){ue||(ue=!0,ke.resolve(le,V))},function(V){ue||(ue=!0,ke.reject(le,V))});return le}},{immediate:36}],38:[function(vt,Ee,ve){"use strict";var b={};(0,vt("./lib/utils/common").assign)(b,vt("./lib/deflate"),vt("./lib/inflate"),vt("./lib/zlib/constants")),Ee.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(vt,Ee,ve){"use strict";var b=vt("./zlib/deflate"),z=vt("./utils/common"),ke=vt("./utils/strings"),xe=vt("./zlib/messages"),et=vt("./zlib/zstream"),Je=Object.prototype.toString,Xe=0,ot=-1,Re=0,He=8;function Ie(ce){if(!(this instanceof Ie))return new Ie(ce);this.options=z.assign({level:ot,method:He,chunkSize:16384,windowBits:15,memLevel:8,strategy:Re,to:""},ce||{});var ie=this.options;ie.raw&&0<ie.windowBits?ie.windowBits=-ie.windowBits:ie.gzip&&0<ie.windowBits&&ie.windowBits<16&&(ie.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new et,this.strm.avail_out=0;var he=b.deflateInit2(this.strm,ie.level,ie.method,ie.windowBits,ie.memLevel,ie.strategy);if(he!==Xe)throw new Error(xe[he]);if(ie.header&&b.deflateSetHeader(this.strm,ie.header),ie.dictionary){var ue;if(ue="string"==typeof ie.dictionary?ke.string2buf(ie.dictionary):"[object ArrayBuffer]"===Je.call(ie.dictionary)?new Uint8Array(ie.dictionary):ie.dictionary,(he=b.deflateSetDictionary(this.strm,ue))!==Xe)throw new Error(xe[he]);this._dict_set=!0}}function O(ce,ie){var he=new Ie(ie);if(he.push(ce,!0),he.err)throw he.msg||xe[he.err];return he.result}Ie.prototype.push=function(ce,ie){var he,ue,fe=this.strm,le=this.options.chunkSize;if(this.ended)return!1;ue=ie===~~ie?ie:!0===ie?4:0,fe.input="string"==typeof ce?ke.string2buf(ce):"[object ArrayBuffer]"===Je.call(ce)?new Uint8Array(ce):ce,fe.next_in=0,fe.avail_in=fe.input.length;do{if(0===fe.avail_out&&(fe.output=new z.Buf8(le),fe.next_out=0,fe.avail_out=le),1!==(he=b.deflate(fe,ue))&&he!==Xe)return this.onEnd(he),!(this.ended=!0);0!==fe.avail_out&&(0!==fe.avail_in||4!==ue&&2!==ue)||this.onData("string"===this.options.to?ke.buf2binstring(z.shrinkBuf(fe.output,fe.next_out)):z.shrinkBuf(fe.output,fe.next_out))}while((0<fe.avail_in||0===fe.avail_out)&&1!==he);return 4===ue?(he=b.deflateEnd(this.strm),this.onEnd(he),this.ended=!0,he===Xe):2!==ue||(this.onEnd(Xe),!(fe.avail_out=0))},Ie.prototype.onData=function(ce){this.chunks.push(ce)},Ie.prototype.onEnd=function(ce){ce===Xe&&(this.result="string"===this.options.to?this.chunks.join(""):z.flattenChunks(this.chunks)),this.chunks=[],this.err=ce,this.msg=this.strm.msg},ve.Deflate=Ie,ve.deflate=O,ve.deflateRaw=function(ce,ie){return(ie=ie||{}).raw=!0,O(ce,ie)},ve.gzip=function(ce,ie){return(ie=ie||{}).gzip=!0,O(ce,ie)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(vt,Ee,ve){"use strict";var b=vt("./zlib/inflate"),z=vt("./utils/common"),ke=vt("./utils/strings"),xe=vt("./zlib/constants"),et=vt("./zlib/messages"),Je=vt("./zlib/zstream"),Xe=vt("./zlib/gzheader"),ot=Object.prototype.toString;function Re(Ie){if(!(this instanceof Re))return new Re(Ie);this.options=z.assign({chunkSize:16384,windowBits:0,to:""},Ie||{});var O=this.options;O.raw&&0<=O.windowBits&&O.windowBits<16&&(O.windowBits=-O.windowBits,0===O.windowBits&&(O.windowBits=-15)),!(0<=O.windowBits&&O.windowBits<16)||Ie&&Ie.windowBits||(O.windowBits+=32),15<O.windowBits&&O.windowBits<48&&!(15&O.windowBits)&&(O.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Je,this.strm.avail_out=0;var ce=b.inflateInit2(this.strm,O.windowBits);if(ce!==xe.Z_OK)throw new Error(et[ce]);this.header=new Xe,b.inflateGetHeader(this.strm,this.header)}function He(Ie,O){var ce=new Re(O);if(ce.push(Ie,!0),ce.err)throw ce.msg||et[ce.err];return ce.result}Re.prototype.push=function(Ie,O){var ce,ie,he,ue,fe,le,Y=this.strm,V=this.options.chunkSize,D=this.options.dictionary,w=!1;if(this.ended)return!1;ie=O===~~O?O:!0===O?xe.Z_FINISH:xe.Z_NO_FLUSH,Y.input="string"==typeof Ie?ke.binstring2buf(Ie):"[object ArrayBuffer]"===ot.call(Ie)?new Uint8Array(Ie):Ie,Y.next_in=0,Y.avail_in=Y.input.length;do{if(0===Y.avail_out&&(Y.output=new z.Buf8(V),Y.next_out=0,Y.avail_out=V),(ce=b.inflate(Y,xe.Z_NO_FLUSH))===xe.Z_NEED_DICT&&D&&(le="string"==typeof D?ke.string2buf(D):"[object ArrayBuffer]"===ot.call(D)?new Uint8Array(D):D,ce=b.inflateSetDictionary(this.strm,le)),ce===xe.Z_BUF_ERROR&&!0===w&&(ce=xe.Z_OK,w=!1),ce!==xe.Z_STREAM_END&&ce!==xe.Z_OK)return this.onEnd(ce),!(this.ended=!0);Y.next_out&&(0!==Y.avail_out&&ce!==xe.Z_STREAM_END&&(0!==Y.avail_in||ie!==xe.Z_FINISH&&ie!==xe.Z_SYNC_FLUSH)||("string"===this.options.to?(he=ke.utf8border(Y.output,Y.next_out),ue=Y.next_out-he,fe=ke.buf2string(Y.output,he),Y.next_out=ue,Y.avail_out=V-ue,ue&&z.arraySet(Y.output,Y.output,he,ue,0),this.onData(fe)):this.onData(z.shrinkBuf(Y.output,Y.next_out)))),0===Y.avail_in&&0===Y.avail_out&&(w=!0)}while((0<Y.avail_in||0===Y.avail_out)&&ce!==xe.Z_STREAM_END);return ce===xe.Z_STREAM_END&&(ie=xe.Z_FINISH),ie===xe.Z_FINISH?(ce=b.inflateEnd(this.strm),this.onEnd(ce),this.ended=!0,ce===xe.Z_OK):ie!==xe.Z_SYNC_FLUSH||(this.onEnd(xe.Z_OK),!(Y.avail_out=0))},Re.prototype.onData=function(Ie){this.chunks.push(Ie)},Re.prototype.onEnd=function(Ie){Ie===xe.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):z.flattenChunks(this.chunks)),this.chunks=[],this.err=Ie,this.msg=this.strm.msg},ve.Inflate=Re,ve.inflate=He,ve.inflateRaw=function(Ie,O){return(O=O||{}).raw=!0,He(Ie,O)},ve.ungzip=He},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(vt,Ee,ve){"use strict";var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";ve.assign=function(xe){for(var et=Array.prototype.slice.call(arguments,1);et.length;){var Je=et.shift();if(Je){if("object"!=typeof Je)throw new TypeError(Je+"must be non-object");for(var Xe in Je)Je.hasOwnProperty(Xe)&&(xe[Xe]=Je[Xe])}}return xe},ve.shrinkBuf=function(xe,et){return xe.length===et?xe:xe.subarray?xe.subarray(0,et):(xe.length=et,xe)};var z={arraySet:function(xe,et,Je,Xe,ot){if(et.subarray&&xe.subarray)xe.set(et.subarray(Je,Je+Xe),ot);else for(var Re=0;Re<Xe;Re++)xe[ot+Re]=et[Je+Re]},flattenChunks:function(xe){var et,Je,Xe,ot,Re,He;for(et=Xe=0,Je=xe.length;et<Je;et++)Xe+=xe[et].length;for(He=new Uint8Array(Xe),et=ot=0,Je=xe.length;et<Je;et++)He.set(Re=xe[et],ot),ot+=Re.length;return He}},ke={arraySet:function(xe,et,Je,Xe,ot){for(var Re=0;Re<Xe;Re++)xe[ot+Re]=et[Je+Re]},flattenChunks:function(xe){return[].concat.apply([],xe)}};ve.setTyped=function(xe){xe?(ve.Buf8=Uint8Array,ve.Buf16=Uint16Array,ve.Buf32=Int32Array,ve.assign(ve,z)):(ve.Buf8=Array,ve.Buf16=Array,ve.Buf32=Array,ve.assign(ve,ke))},ve.setTyped(b)},{}],42:[function(vt,Ee,ve){"use strict";var b=vt("./common"),z=!0,ke=!0;try{String.fromCharCode.apply(null,[0])}catch{z=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ke=!1}for(var xe=new b.Buf8(256),et=0;et<256;et++)xe[et]=252<=et?6:248<=et?5:240<=et?4:224<=et?3:192<=et?2:1;function Je(Xe,ot){if(ot<65537&&(Xe.subarray&&ke||!Xe.subarray&&z))return String.fromCharCode.apply(null,b.shrinkBuf(Xe,ot));for(var Re="",He=0;He<ot;He++)Re+=String.fromCharCode(Xe[He]);return Re}xe[254]=xe[254]=1,ve.string2buf=function(Xe){var ot,Re,He,Ie,O,ce=Xe.length,ie=0;for(Ie=0;Ie<ce;Ie++)55296==(64512&(Re=Xe.charCodeAt(Ie)))&&Ie+1<ce&&56320==(64512&(He=Xe.charCodeAt(Ie+1)))&&(Re=65536+(Re-55296<<10)+(He-56320),Ie++),ie+=Re<128?1:Re<2048?2:Re<65536?3:4;for(ot=new b.Buf8(ie),Ie=O=0;O<ie;Ie++)55296==(64512&(Re=Xe.charCodeAt(Ie)))&&Ie+1<ce&&56320==(64512&(He=Xe.charCodeAt(Ie+1)))&&(Re=65536+(Re-55296<<10)+(He-56320),Ie++),Re<128?ot[O++]=Re:(Re<2048?ot[O++]=192|Re>>>6:(Re<65536?ot[O++]=224|Re>>>12:(ot[O++]=240|Re>>>18,ot[O++]=128|Re>>>12&63),ot[O++]=128|Re>>>6&63),ot[O++]=128|63&Re);return ot},ve.buf2binstring=function(Xe){return Je(Xe,Xe.length)},ve.binstring2buf=function(Xe){for(var ot=new b.Buf8(Xe.length),Re=0,He=ot.length;Re<He;Re++)ot[Re]=Xe.charCodeAt(Re);return ot},ve.buf2string=function(Xe,ot){var Re,He,Ie,O,ce=ot||Xe.length,ie=new Array(2*ce);for(Re=He=0;Re<ce;)if((Ie=Xe[Re++])<128)ie[He++]=Ie;else if(4<(O=xe[Ie]))ie[He++]=65533,Re+=O-1;else{for(Ie&=2===O?31:3===O?15:7;1<O&&Re<ce;)Ie=Ie<<6|63&Xe[Re++],O--;1<O?ie[He++]=65533:Ie<65536?ie[He++]=Ie:(ie[He++]=55296|(Ie-=65536)>>10&1023,ie[He++]=56320|1023&Ie)}return Je(ie,He)},ve.utf8border=function(Xe,ot){var Re;for((ot=ot||Xe.length)>Xe.length&&(ot=Xe.length),Re=ot-1;0<=Re&&128==(192&Xe[Re]);)Re--;return Re<0||0===Re?ot:Re+xe[Xe[Re]]>ot?Re:ot}},{"./common":41}],43:[function(vt,Ee,ve){"use strict";Ee.exports=function(b,z,ke,xe){for(var et=65535&b,Je=b>>>16&65535,Xe=0;0!==ke;){for(ke-=Xe=2e3<ke?2e3:ke;Je=Je+(et=et+z[xe++]|0)|0,--Xe;);et%=65521,Je%=65521}return et|Je<<16}},{}],44:[function(vt,Ee,ve){"use strict";Ee.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(vt,Ee,ve){"use strict";var b=function(){for(var z,ke=[],xe=0;xe<256;xe++){z=xe;for(var et=0;et<8;et++)z=1&z?3988292384^z>>>1:z>>>1;ke[xe]=z}return ke}();Ee.exports=function(z,ke,xe,et){var Je=b,Xe=et+xe;z^=-1;for(var ot=et;ot<Xe;ot++)z=z>>>8^Je[255&(z^ke[ot])];return~z}},{}],46:[function(vt,Ee,ve){"use strict";var b,z=vt("../utils/common"),ke=vt("./trees"),xe=vt("./adler32"),et=vt("./crc32"),Je=vt("./messages"),Xe=0,Re=0,He=-2,ce=2,ie=8,ue=286,fe=30,le=19,Y=2*ue+1,V=15,D=3,w=258,P=w+D+1,x=42,v=113;function U(Q,Ke){return Q.msg=Je[Ke],Ke}function j(Q){return(Q<<1)-(4<Q?9:0)}function te(Q){for(var Ke=Q.length;0<=--Ke;)Q[Ke]=0}function N(Q){var Ke=Q.state,Ze=Ke.pending;Ze>Q.avail_out&&(Ze=Q.avail_out),0!==Ze&&(z.arraySet(Q.output,Ke.pending_buf,Ke.pending_out,Ze,Q.next_out),Q.next_out+=Ze,Ke.pending_out+=Ze,Q.total_out+=Ze,Q.avail_out-=Ze,Ke.pending-=Ze,0===Ke.pending&&(Ke.pending_out=0))}function m(Q,Ke){ke._tr_flush_block(Q,0<=Q.block_start?Q.block_start:-1,Q.strstart-Q.block_start,Ke),Q.block_start=Q.strstart,N(Q.strm)}function I(Q,Ke){Q.pending_buf[Q.pending++]=Ke}function A(Q,Ke){Q.pending_buf[Q.pending++]=Ke>>>8&255,Q.pending_buf[Q.pending++]=255&Ke}function R(Q,Ke){var Ze,Ue,Oe=Q.max_chain_length,lt=Q.strstart,gt=Q.prev_length,ht=Q.nice_match,st=Q.strstart>Q.w_size-P?Q.strstart-(Q.w_size-P):0,yt=Q.window,Kt=Q.w_mask,Ot=Q.prev,It=Q.strstart+w,An=yt[lt+gt-1],on=yt[lt+gt];Q.prev_length>=Q.good_match&&(Oe>>=2),ht>Q.lookahead&&(ht=Q.lookahead);do{if(yt[(Ze=Ke)+gt]===on&&yt[Ze+gt-1]===An&&yt[Ze]===yt[lt]&&yt[++Ze]===yt[lt+1]){lt+=2,Ze++;do{}while(yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&yt[++lt]===yt[++Ze]&&lt<It);if(Ue=w-(It-lt),lt=It-w,gt<Ue){if(Q.match_start=Ke,ht<=(gt=Ue))break;An=yt[lt+gt-1],on=yt[lt+gt]}}}while((Ke=Ot[Ke&Kt])>st&&0!=--Oe);return gt<=Q.lookahead?gt:Q.lookahead}function k(Q){var Ke,Ze,Ue,Oe,lt,gt,ht,st,yt,Kt,Ot=Q.w_size;do{if(Oe=Q.window_size-Q.lookahead-Q.strstart,Q.strstart>=Ot+(Ot-P)){for(z.arraySet(Q.window,Q.window,Ot,Ot,0),Q.match_start-=Ot,Q.strstart-=Ot,Q.block_start-=Ot,Ke=Ze=Q.hash_size;Ue=Q.head[--Ke],Q.head[Ke]=Ot<=Ue?Ue-Ot:0,--Ze;);for(Ke=Ze=Ot;Ue=Q.prev[--Ke],Q.prev[Ke]=Ot<=Ue?Ue-Ot:0,--Ze;);Oe+=Ot}if(0===Q.strm.avail_in)break;if(ht=Q.window,st=Q.strstart+Q.lookahead,Kt=void 0,(yt=Oe)<(Kt=(gt=Q.strm).avail_in)&&(Kt=yt),Ze=0===Kt?0:(gt.avail_in-=Kt,z.arraySet(ht,gt.input,gt.next_in,Kt,st),1===gt.state.wrap?gt.adler=xe(gt.adler,ht,Kt,st):2===gt.state.wrap&&(gt.adler=et(gt.adler,ht,Kt,st)),gt.next_in+=Kt,gt.total_in+=Kt,Kt),Q.lookahead+=Ze,Q.lookahead+Q.insert>=D)for(Q.ins_h=Q.window[lt=Q.strstart-Q.insert],Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[lt+1])&Q.hash_mask;Q.insert&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[lt+D-1])&Q.hash_mask,Q.prev[lt&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=lt,lt++,Q.insert--,!(Q.lookahead+Q.insert<D)););}while(Q.lookahead<P&&0!==Q.strm.avail_in)}function J(Q,Ke){for(var Ze,Ue;;){if(Q.lookahead<P){if(k(Q),Q.lookahead<P&&Ke===Xe)return 1;if(0===Q.lookahead)break}if(Ze=0,Q.lookahead>=D&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+D-1])&Q.hash_mask,Ze=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),0!==Ze&&Q.strstart-Ze<=Q.w_size-P&&(Q.match_length=R(Q,Ze)),Q.match_length>=D)if(Ue=ke._tr_tally(Q,Q.strstart-Q.match_start,Q.match_length-D),Q.lookahead-=Q.match_length,Q.match_length<=Q.max_lazy_match&&Q.lookahead>=D){for(Q.match_length--;Q.strstart++,Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+D-1])&Q.hash_mask,Ze=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart,0!=--Q.match_length;);Q.strstart++}else Q.strstart+=Q.match_length,Q.match_length=0,Q.ins_h=Q.window[Q.strstart],Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+1])&Q.hash_mask;else Ue=ke._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++;if(Ue&&(m(Q,!1),0===Q.strm.avail_out))return 1}return Q.insert=Q.strstart<D-1?Q.strstart:D-1,4===Ke?(m(Q,!0),0===Q.strm.avail_out?3:4):Q.last_lit&&(m(Q,!1),0===Q.strm.avail_out)?1:2}function _e(Q,Ke){for(var Ze,Ue,Oe;;){if(Q.lookahead<P){if(k(Q),Q.lookahead<P&&Ke===Xe)return 1;if(0===Q.lookahead)break}if(Ze=0,Q.lookahead>=D&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+D-1])&Q.hash_mask,Ze=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),Q.prev_length=Q.match_length,Q.prev_match=Q.match_start,Q.match_length=D-1,0!==Ze&&Q.prev_length<Q.max_lazy_match&&Q.strstart-Ze<=Q.w_size-P&&(Q.match_length=R(Q,Ze),Q.match_length<=5&&(1===Q.strategy||Q.match_length===D&&4096<Q.strstart-Q.match_start)&&(Q.match_length=D-1)),Q.prev_length>=D&&Q.match_length<=Q.prev_length){for(Oe=Q.strstart+Q.lookahead-D,Ue=ke._tr_tally(Q,Q.strstart-1-Q.prev_match,Q.prev_length-D),Q.lookahead-=Q.prev_length-1,Q.prev_length-=2;++Q.strstart<=Oe&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+D-1])&Q.hash_mask,Ze=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),0!=--Q.prev_length;);if(Q.match_available=0,Q.match_length=D-1,Q.strstart++,Ue&&(m(Q,!1),0===Q.strm.avail_out))return 1}else if(Q.match_available){if((Ue=ke._tr_tally(Q,0,Q.window[Q.strstart-1]))&&m(Q,!1),Q.strstart++,Q.lookahead--,0===Q.strm.avail_out)return 1}else Q.match_available=1,Q.strstart++,Q.lookahead--}return Q.match_available&&(Ue=ke._tr_tally(Q,0,Q.window[Q.strstart-1]),Q.match_available=0),Q.insert=Q.strstart<D-1?Q.strstart:D-1,4===Ke?(m(Q,!0),0===Q.strm.avail_out?3:4):Q.last_lit&&(m(Q,!1),0===Q.strm.avail_out)?1:2}function be(Q,Ke,Ze,Ue,Oe){this.good_length=Q,this.max_lazy=Ke,this.nice_length=Ze,this.max_chain=Ue,this.func=Oe}function Te(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ie,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new z.Buf16(2*Y),this.dyn_dtree=new z.Buf16(2*(2*fe+1)),this.bl_tree=new z.Buf16(2*(2*le+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new z.Buf16(V+1),this.heap=new z.Buf16(2*ue+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new z.Buf16(2*ue+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Pe(Q){var Ke;return Q&&Q.state?(Q.total_in=Q.total_out=0,Q.data_type=ce,(Ke=Q.state).pending=0,Ke.pending_out=0,Ke.wrap<0&&(Ke.wrap=-Ke.wrap),Ke.status=Ke.wrap?x:v,Q.adler=2===Ke.wrap?0:1,Ke.last_flush=Xe,ke._tr_init(Ke),Re):U(Q,He)}function We(Q){var Ze,Ke=Pe(Q);return Ke===Re&&((Ze=Q.state).window_size=2*Ze.w_size,te(Ze.head),Ze.max_lazy_match=b[Ze.level].max_lazy,Ze.good_match=b[Ze.level].good_length,Ze.nice_match=b[Ze.level].nice_length,Ze.max_chain_length=b[Ze.level].max_chain,Ze.strstart=0,Ze.block_start=0,Ze.lookahead=0,Ze.insert=0,Ze.match_length=Ze.prev_length=D-1,Ze.match_available=0,Ze.ins_h=0),Ke}function dt(Q,Ke,Ze,Ue,Oe,lt){if(!Q)return He;var gt=1;if(-1===Ke&&(Ke=6),Ue<0?(gt=0,Ue=-Ue):15<Ue&&(gt=2,Ue-=16),Oe<1||9<Oe||Ze!==ie||Ue<8||15<Ue||Ke<0||9<Ke||lt<0||4<lt)return U(Q,He);8===Ue&&(Ue=9);var ht=new Te;return(Q.state=ht).strm=Q,ht.wrap=gt,ht.gzhead=null,ht.w_bits=Ue,ht.w_size=1<<ht.w_bits,ht.w_mask=ht.w_size-1,ht.hash_bits=Oe+7,ht.hash_size=1<<ht.hash_bits,ht.hash_mask=ht.hash_size-1,ht.hash_shift=~~((ht.hash_bits+D-1)/D),ht.window=new z.Buf8(2*ht.w_size),ht.head=new z.Buf16(ht.hash_size),ht.prev=new z.Buf16(ht.w_size),ht.lit_bufsize=1<<Oe+6,ht.pending_buf_size=4*ht.lit_bufsize,ht.pending_buf=new z.Buf8(ht.pending_buf_size),ht.d_buf=1*ht.lit_bufsize,ht.l_buf=3*ht.lit_bufsize,ht.level=Ke,ht.strategy=lt,ht.method=Ze,We(Q)}b=[new be(0,0,0,0,function(Q,Ke){var Ze=65535;for(Ze>Q.pending_buf_size-5&&(Ze=Q.pending_buf_size-5);;){if(Q.lookahead<=1){if(k(Q),0===Q.lookahead&&Ke===Xe)return 1;if(0===Q.lookahead)break}Q.strstart+=Q.lookahead,Q.lookahead=0;var Ue=Q.block_start+Ze;if((0===Q.strstart||Q.strstart>=Ue)&&(Q.lookahead=Q.strstart-Ue,Q.strstart=Ue,m(Q,!1),0===Q.strm.avail_out)||Q.strstart-Q.block_start>=Q.w_size-P&&(m(Q,!1),0===Q.strm.avail_out))return 1}return Q.insert=0,4===Ke?(m(Q,!0),0===Q.strm.avail_out?3:4):(Q.strstart>Q.block_start&&m(Q,!1),1)}),new be(4,4,8,4,J),new be(4,5,16,8,J),new be(4,6,32,32,J),new be(4,4,16,16,_e),new be(8,16,32,32,_e),new be(8,16,128,128,_e),new be(8,32,128,256,_e),new be(32,128,258,1024,_e),new be(32,258,258,4096,_e)],ve.deflateInit=function(Q,Ke){return dt(Q,Ke,ie,15,8,0)},ve.deflateInit2=dt,ve.deflateReset=We,ve.deflateResetKeep=Pe,ve.deflateSetHeader=function(Q,Ke){return Q&&Q.state?2!==Q.state.wrap?He:(Q.state.gzhead=Ke,Re):He},ve.deflate=function(Q,Ke){var Ze,Ue,Oe,lt;if(!Q||!Q.state||5<Ke||Ke<0)return Q?U(Q,He):He;if(Ue=Q.state,!Q.output||!Q.input&&0!==Q.avail_in||666===Ue.status&&4!==Ke)return U(Q,0===Q.avail_out?-5:He);if(Ue.strm=Q,Ze=Ue.last_flush,Ue.last_flush=Ke,Ue.status===x)if(2===Ue.wrap)Q.adler=0,I(Ue,31),I(Ue,139),I(Ue,8),Ue.gzhead?(I(Ue,(Ue.gzhead.text?1:0)+(Ue.gzhead.hcrc?2:0)+(Ue.gzhead.extra?4:0)+(Ue.gzhead.name?8:0)+(Ue.gzhead.comment?16:0)),I(Ue,255&Ue.gzhead.time),I(Ue,Ue.gzhead.time>>8&255),I(Ue,Ue.gzhead.time>>16&255),I(Ue,Ue.gzhead.time>>24&255),I(Ue,9===Ue.level?2:2<=Ue.strategy||Ue.level<2?4:0),I(Ue,255&Ue.gzhead.os),Ue.gzhead.extra&&Ue.gzhead.extra.length&&(I(Ue,255&Ue.gzhead.extra.length),I(Ue,Ue.gzhead.extra.length>>8&255)),Ue.gzhead.hcrc&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending,0)),Ue.gzindex=0,Ue.status=69):(I(Ue,0),I(Ue,0),I(Ue,0),I(Ue,0),I(Ue,0),I(Ue,9===Ue.level?2:2<=Ue.strategy||Ue.level<2?4:0),I(Ue,3),Ue.status=v);else{var gt=ie+(Ue.w_bits-8<<4)<<8;gt|=(2<=Ue.strategy||Ue.level<2?0:Ue.level<6?1:6===Ue.level?2:3)<<6,0!==Ue.strstart&&(gt|=32),gt+=31-gt%31,Ue.status=v,A(Ue,gt),0!==Ue.strstart&&(A(Ue,Q.adler>>>16),A(Ue,65535&Q.adler)),Q.adler=1}if(69===Ue.status)if(Ue.gzhead.extra){for(Oe=Ue.pending;Ue.gzindex<(65535&Ue.gzhead.extra.length)&&(Ue.pending!==Ue.pending_buf_size||(Ue.gzhead.hcrc&&Ue.pending>Oe&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending-Oe,Oe)),N(Q),Oe=Ue.pending,Ue.pending!==Ue.pending_buf_size));)I(Ue,255&Ue.gzhead.extra[Ue.gzindex]),Ue.gzindex++;Ue.gzhead.hcrc&&Ue.pending>Oe&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending-Oe,Oe)),Ue.gzindex===Ue.gzhead.extra.length&&(Ue.gzindex=0,Ue.status=73)}else Ue.status=73;if(73===Ue.status)if(Ue.gzhead.name){Oe=Ue.pending;do{if(Ue.pending===Ue.pending_buf_size&&(Ue.gzhead.hcrc&&Ue.pending>Oe&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending-Oe,Oe)),N(Q),Oe=Ue.pending,Ue.pending===Ue.pending_buf_size)){lt=1;break}lt=Ue.gzindex<Ue.gzhead.name.length?255&Ue.gzhead.name.charCodeAt(Ue.gzindex++):0,I(Ue,lt)}while(0!==lt);Ue.gzhead.hcrc&&Ue.pending>Oe&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending-Oe,Oe)),0===lt&&(Ue.gzindex=0,Ue.status=91)}else Ue.status=91;if(91===Ue.status)if(Ue.gzhead.comment){Oe=Ue.pending;do{if(Ue.pending===Ue.pending_buf_size&&(Ue.gzhead.hcrc&&Ue.pending>Oe&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending-Oe,Oe)),N(Q),Oe=Ue.pending,Ue.pending===Ue.pending_buf_size)){lt=1;break}lt=Ue.gzindex<Ue.gzhead.comment.length?255&Ue.gzhead.comment.charCodeAt(Ue.gzindex++):0,I(Ue,lt)}while(0!==lt);Ue.gzhead.hcrc&&Ue.pending>Oe&&(Q.adler=et(Q.adler,Ue.pending_buf,Ue.pending-Oe,Oe)),0===lt&&(Ue.status=103)}else Ue.status=103;if(103===Ue.status&&(Ue.gzhead.hcrc?(Ue.pending+2>Ue.pending_buf_size&&N(Q),Ue.pending+2<=Ue.pending_buf_size&&(I(Ue,255&Q.adler),I(Ue,Q.adler>>8&255),Q.adler=0,Ue.status=v)):Ue.status=v),0!==Ue.pending){if(N(Q),0===Q.avail_out)return Ue.last_flush=-1,Re}else if(0===Q.avail_in&&j(Ke)<=j(Ze)&&4!==Ke)return U(Q,-5);if(666===Ue.status&&0!==Q.avail_in)return U(Q,-5);if(0!==Q.avail_in||0!==Ue.lookahead||Ke!==Xe&&666!==Ue.status){var ht=2===Ue.strategy?function(st,yt){for(var Kt;;){if(0===st.lookahead&&(k(st),0===st.lookahead)){if(yt===Xe)return 1;break}if(st.match_length=0,Kt=ke._tr_tally(st,0,st.window[st.strstart]),st.lookahead--,st.strstart++,Kt&&(m(st,!1),0===st.strm.avail_out))return 1}return st.insert=0,4===yt?(m(st,!0),0===st.strm.avail_out?3:4):st.last_lit&&(m(st,!1),0===st.strm.avail_out)?1:2}(Ue,Ke):3===Ue.strategy?function(st,yt){for(var Kt,Ot,It,An,on=st.window;;){if(st.lookahead<=w){if(k(st),st.lookahead<=w&&yt===Xe)return 1;if(0===st.lookahead)break}if(st.match_length=0,st.lookahead>=D&&0<st.strstart&&(Ot=on[It=st.strstart-1])===on[++It]&&Ot===on[++It]&&Ot===on[++It]){An=st.strstart+w;do{}while(Ot===on[++It]&&Ot===on[++It]&&Ot===on[++It]&&Ot===on[++It]&&Ot===on[++It]&&Ot===on[++It]&&Ot===on[++It]&&Ot===on[++It]&&It<An);st.match_length=w-(An-It),st.match_length>st.lookahead&&(st.match_length=st.lookahead)}if(st.match_length>=D?(Kt=ke._tr_tally(st,1,st.match_length-D),st.lookahead-=st.match_length,st.strstart+=st.match_length,st.match_length=0):(Kt=ke._tr_tally(st,0,st.window[st.strstart]),st.lookahead--,st.strstart++),Kt&&(m(st,!1),0===st.strm.avail_out))return 1}return st.insert=0,4===yt?(m(st,!0),0===st.strm.avail_out?3:4):st.last_lit&&(m(st,!1),0===st.strm.avail_out)?1:2}(Ue,Ke):b[Ue.level].func(Ue,Ke);if(3!==ht&&4!==ht||(Ue.status=666),1===ht||3===ht)return 0===Q.avail_out&&(Ue.last_flush=-1),Re;if(2===ht&&(1===Ke?ke._tr_align(Ue):5!==Ke&&(ke._tr_stored_block(Ue,0,0,!1),3===Ke&&(te(Ue.head),0===Ue.lookahead&&(Ue.strstart=0,Ue.block_start=0,Ue.insert=0))),N(Q),0===Q.avail_out))return Ue.last_flush=-1,Re}return 4!==Ke?Re:Ue.wrap<=0?1:(2===Ue.wrap?(I(Ue,255&Q.adler),I(Ue,Q.adler>>8&255),I(Ue,Q.adler>>16&255),I(Ue,Q.adler>>24&255),I(Ue,255&Q.total_in),I(Ue,Q.total_in>>8&255),I(Ue,Q.total_in>>16&255),I(Ue,Q.total_in>>24&255)):(A(Ue,Q.adler>>>16),A(Ue,65535&Q.adler)),N(Q),0<Ue.wrap&&(Ue.wrap=-Ue.wrap),0!==Ue.pending?Re:1)},ve.deflateEnd=function(Q){var Ke;return Q&&Q.state?(Ke=Q.state.status)!==x&&69!==Ke&&73!==Ke&&91!==Ke&&103!==Ke&&Ke!==v&&666!==Ke?U(Q,He):(Q.state=null,Ke===v?U(Q,-3):Re):He},ve.deflateSetDictionary=function(Q,Ke){var Ze,Ue,Oe,lt,gt,ht,st,yt,Kt=Ke.length;if(!Q||!Q.state||2===(lt=(Ze=Q.state).wrap)||1===lt&&Ze.status!==x||Ze.lookahead)return He;for(1===lt&&(Q.adler=xe(Q.adler,Ke,Kt,0)),Ze.wrap=0,Kt>=Ze.w_size&&(0===lt&&(te(Ze.head),Ze.strstart=0,Ze.block_start=0,Ze.insert=0),yt=new z.Buf8(Ze.w_size),z.arraySet(yt,Ke,Kt-Ze.w_size,Ze.w_size,0),Ke=yt,Kt=Ze.w_size),gt=Q.avail_in,ht=Q.next_in,st=Q.input,Q.avail_in=Kt,Q.next_in=0,Q.input=Ke,k(Ze);Ze.lookahead>=D;){for(Ue=Ze.strstart,Oe=Ze.lookahead-(D-1);Ze.ins_h=(Ze.ins_h<<Ze.hash_shift^Ze.window[Ue+D-1])&Ze.hash_mask,Ze.prev[Ue&Ze.w_mask]=Ze.head[Ze.ins_h],Ze.head[Ze.ins_h]=Ue,Ue++,--Oe;);Ze.strstart=Ue,Ze.lookahead=D-1,k(Ze)}return Ze.strstart+=Ze.lookahead,Ze.block_start=Ze.strstart,Ze.insert=Ze.lookahead,Ze.lookahead=0,Ze.match_length=Ze.prev_length=D-1,Ze.match_available=0,Q.next_in=ht,Q.input=st,Q.avail_in=gt,Ze.wrap=lt,Re},ve.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(vt,Ee,ve){"use strict";Ee.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(vt,Ee,ve){"use strict";Ee.exports=function(b,z){var ke,xe,et,Je,Xe,ot,Re,He,Ie,O,ce,ie,he,ue,fe,le,Y,V,D,w,P,x,v,_,C;_=b.input,et=(xe=b.next_in)+(b.avail_in-5),C=b.output,Xe=(Je=b.next_out)-(z-b.avail_out),ot=Je+(b.avail_out-257),Re=(ke=b.state).dmax,He=ke.wsize,Ie=ke.whave,O=ke.wnext,ce=ke.window,ie=ke.hold,he=ke.bits,ue=ke.lencode,fe=ke.distcode,le=(1<<ke.lenbits)-1,Y=(1<<ke.distbits)-1;e:do{he<15&&(ie+=_[xe++]<<he,ie+=_[xe++]<<(he+=8),he+=8),V=ue[ie&le];t:for(;;){if(ie>>>=D=V>>>24,he-=D,0==(D=V>>>16&255))C[Je++]=65535&V;else{if(!(16&D)){if(!(64&D)){V=ue[(65535&V)+(ie&(1<<D)-1)];continue t}if(32&D){ke.mode=12;break e}b.msg="invalid literal/length code",ke.mode=30;break e}w=65535&V,(D&=15)&&(he<D&&(ie+=_[xe++]<<he,he+=8),w+=ie&(1<<D)-1,ie>>>=D,he-=D),he<15&&(ie+=_[xe++]<<he,ie+=_[xe++]<<(he+=8),he+=8),V=fe[ie&Y];n:for(;;){if(ie>>>=D=V>>>24,he-=D,!(16&(D=V>>>16&255))){if(!(64&D)){V=fe[(65535&V)+(ie&(1<<D)-1)];continue n}b.msg="invalid distance code",ke.mode=30;break e}if(P=65535&V,he<(D&=15)&&(ie+=_[xe++]<<he,(he+=8)<D&&(ie+=_[xe++]<<he,he+=8)),Re<(P+=ie&(1<<D)-1)){b.msg="invalid distance too far back",ke.mode=30;break e}if(ie>>>=D,he-=D,(D=Je-Xe)<P){if(Ie<(D=P-D)&&ke.sane){b.msg="invalid distance too far back",ke.mode=30;break e}if(v=ce,(x=0)===O){if(x+=He-D,D<w){for(w-=D;C[Je++]=ce[x++],--D;);x=Je-P,v=C}}else if(O<D){if(x+=He+O-D,(D-=O)<w){for(w-=D;C[Je++]=ce[x++],--D;);if(x=0,O<w){for(w-=D=O;C[Je++]=ce[x++],--D;);x=Je-P,v=C}}}else if(x+=O-D,D<w){for(w-=D;C[Je++]=ce[x++],--D;);x=Je-P,v=C}for(;2<w;)C[Je++]=v[x++],C[Je++]=v[x++],C[Je++]=v[x++],w-=3;w&&(C[Je++]=v[x++],1<w&&(C[Je++]=v[x++]))}else{for(x=Je-P;C[Je++]=C[x++],C[Je++]=C[x++],C[Je++]=C[x++],2<(w-=3););w&&(C[Je++]=C[x++],1<w&&(C[Je++]=C[x++]))}break}}break}}while(xe<et&&Je<ot);xe-=w=he>>3,ie&=(1<<(he-=w<<3))-1,b.next_in=xe,b.next_out=Je,b.avail_in=xe<et?et-xe+5:5-(xe-et),b.avail_out=Je<ot?ot-Je+257:257-(Je-ot),ke.hold=ie,ke.bits=he}},{}],49:[function(vt,Ee,ve){"use strict";var b=vt("../utils/common"),z=vt("./adler32"),ke=vt("./crc32"),xe=vt("./inffast"),et=vt("./inftrees"),ot=0,Re=-2,He=1,Ie=852,O=592;function ce(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function ie(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function he(x){var v;return x&&x.state?(x.total_in=x.total_out=(v=x.state).total=0,x.msg="",v.wrap&&(x.adler=1&v.wrap),v.mode=He,v.last=0,v.havedict=0,v.dmax=32768,v.head=null,v.hold=0,v.bits=0,v.lencode=v.lendyn=new b.Buf32(Ie),v.distcode=v.distdyn=new b.Buf32(O),v.sane=1,v.back=-1,ot):Re}function ue(x){var v;return x&&x.state?((v=x.state).wsize=0,v.whave=0,v.wnext=0,he(x)):Re}function fe(x,v){var _,C;return x&&x.state?(C=x.state,v<0?(_=0,v=-v):(_=1+(v>>4),v<48&&(v&=15)),v&&(v<8||15<v)?Re:(null!==C.window&&C.wbits!==v&&(C.window=null),C.wrap=_,C.wbits=v,ue(x))):Re}function le(x,v){var _,C;return x?(C=new ie,(x.state=C).window=null,(_=fe(x,v))!==ot&&(x.state=null),_):Re}var Y,V,D=!0;function w(x){if(D){var v;for(Y=new b.Buf32(512),V=new b.Buf32(32),v=0;v<144;)x.lens[v++]=8;for(;v<256;)x.lens[v++]=9;for(;v<280;)x.lens[v++]=7;for(;v<288;)x.lens[v++]=8;for(et(1,x.lens,0,288,Y,0,x.work,{bits:9}),v=0;v<32;)x.lens[v++]=5;et(2,x.lens,0,32,V,0,x.work,{bits:5}),D=!1}x.lencode=Y,x.lenbits=9,x.distcode=V,x.distbits=5}function P(x,v,_,C){var L,F=x.state;return null===F.window&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new b.Buf8(F.wsize)),C>=F.wsize?(b.arraySet(F.window,v,_-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):(C<(L=F.wsize-F.wnext)&&(L=C),b.arraySet(F.window,v,_-C,L,F.wnext),(C-=L)?(b.arraySet(F.window,v,_-C,C,0),F.wnext=C,F.whave=F.wsize):(F.wnext+=L,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=L))),0}ve.inflateReset=ue,ve.inflateReset2=fe,ve.inflateResetKeep=he,ve.inflateInit=function(x){return le(x,15)},ve.inflateInit2=le,ve.inflate=function(x,v){var _,C,L,F,U,j,te,N,m,I,A,R,k,J,_e,be,Te,Pe,We,dt,Q,Ke,Ze,Ue,Oe=0,lt=new b.Buf8(4),gt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&0!==x.avail_in)return Re;12===(_=x.state).mode&&(_.mode=13),U=x.next_out,L=x.output,F=x.next_in,C=x.input,N=_.hold,m=_.bits,I=j=x.avail_in,A=te=x.avail_out,Ke=ot;e:for(;;)switch(_.mode){case He:if(0===_.wrap){_.mode=13;break}for(;m<16;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(2&_.wrap&&35615===N){lt[_.check=0]=255&N,lt[1]=N>>>8&255,_.check=ke(_.check,lt,2,0),m=N=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&N)<<8)+(N>>8))%31){x.msg="incorrect header check",_.mode=30;break}if(8!=(15&N)){x.msg="unknown compression method",_.mode=30;break}if(m-=4,Q=8+(15&(N>>>=4)),0===_.wbits)_.wbits=Q;else if(Q>_.wbits){x.msg="invalid window size",_.mode=30;break}_.dmax=1<<Q,x.adler=_.check=1,_.mode=512&N?10:12,m=N=0;break;case 2:for(;m<16;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(_.flags=N,8!=(255&_.flags)){x.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){x.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=N>>8&1),512&_.flags&&(lt[0]=255&N,lt[1]=N>>>8&255,_.check=ke(_.check,lt,2,0)),m=N=0,_.mode=3;case 3:for(;m<32;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}_.head&&(_.head.time=N),512&_.flags&&(lt[0]=255&N,lt[1]=N>>>8&255,lt[2]=N>>>16&255,lt[3]=N>>>24&255,_.check=ke(_.check,lt,4,0)),m=N=0,_.mode=4;case 4:for(;m<16;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}_.head&&(_.head.xflags=255&N,_.head.os=N>>8),512&_.flags&&(lt[0]=255&N,lt[1]=N>>>8&255,_.check=ke(_.check,lt,2,0)),m=N=0,_.mode=5;case 5:if(1024&_.flags){for(;m<16;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}_.length=N,_.head&&(_.head.extra_len=N),512&_.flags&&(lt[0]=255&N,lt[1]=N>>>8&255,_.check=ke(_.check,lt,2,0)),m=N=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(j<(R=_.length)&&(R=j),R&&(_.head&&(Q=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),b.arraySet(_.head.extra,C,F,R,Q)),512&_.flags&&(_.check=ke(_.check,C,R,F)),j-=R,F+=R,_.length-=R),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(0===j)break e;for(R=0;Q=C[F+R++],_.head&&Q&&_.length<65536&&(_.head.name+=String.fromCharCode(Q)),Q&&R<j;);if(512&_.flags&&(_.check=ke(_.check,C,R,F)),j-=R,F+=R,Q)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(0===j)break e;for(R=0;Q=C[F+R++],_.head&&Q&&_.length<65536&&(_.head.comment+=String.fromCharCode(Q)),Q&&R<j;);if(512&_.flags&&(_.check=ke(_.check,C,R,F)),j-=R,F+=R,Q)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;m<16;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(N!==(65535&_.check)){x.msg="header crc mismatch",_.mode=30;break}m=N=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),x.adler=_.check=0,_.mode=12;break;case 10:for(;m<32;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}x.adler=_.check=ce(N),m=N=0,_.mode=11;case 11:if(0===_.havedict)return x.next_out=U,x.avail_out=te,x.next_in=F,x.avail_in=j,_.hold=N,_.bits=m,2;x.adler=_.check=1,_.mode=12;case 12:if(5===v||6===v)break e;case 13:if(_.last){N>>>=7&m,m-=7&m,_.mode=27;break}for(;m<3;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}switch(_.last=1&N,m-=1,3&(N>>>=1)){case 0:_.mode=14;break;case 1:if(w(_),_.mode=20,6!==v)break;N>>>=2,m-=2;break e;case 2:_.mode=17;break;case 3:x.msg="invalid block type",_.mode=30}N>>>=2,m-=2;break;case 14:for(N>>>=7&m,m-=7&m;m<32;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if((65535&N)!=(N>>>16^65535)){x.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&N,m=N=0,_.mode=15,6===v)break e;case 15:_.mode=16;case 16:if(R=_.length){if(j<R&&(R=j),te<R&&(R=te),0===R)break e;b.arraySet(L,C,F,R,U),j-=R,F+=R,te-=R,U+=R,_.length-=R;break}_.mode=12;break;case 17:for(;m<14;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(_.nlen=257+(31&N),m-=5,_.ndist=1+(31&(N>>>=5)),m-=5,_.ncode=4+(15&(N>>>=5)),N>>>=4,m-=4,286<_.nlen||30<_.ndist){x.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;m<3;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}_.lens[gt[_.have++]]=7&N,N>>>=3,m-=3}for(;_.have<19;)_.lens[gt[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,Ke=et(0,_.lens,0,19,_.lencode,0,_.work,Ze={bits:_.lenbits}),_.lenbits=Ze.bits,Ke){x.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;be=(Oe=_.lencode[N&(1<<_.lenbits)-1])>>>16&255,Te=65535&Oe,!((_e=Oe>>>24)<=m);){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(Te<16)N>>>=_e,m-=_e,_.lens[_.have++]=Te;else{if(16===Te){for(Ue=_e+2;m<Ue;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(N>>>=_e,m-=_e,0===_.have){x.msg="invalid bit length repeat",_.mode=30;break}Q=_.lens[_.have-1],R=3+(3&N),N>>>=2,m-=2}else if(17===Te){for(Ue=_e+3;m<Ue;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}m-=_e,Q=0,R=3+(7&(N>>>=_e)),N>>>=3,m-=3}else{for(Ue=_e+7;m<Ue;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}m-=_e,Q=0,R=11+(127&(N>>>=_e)),N>>>=7,m-=7}if(_.have+R>_.nlen+_.ndist){x.msg="invalid bit length repeat",_.mode=30;break}for(;R--;)_.lens[_.have++]=Q}}if(30===_.mode)break;if(0===_.lens[256]){x.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,Ke=et(1,_.lens,0,_.nlen,_.lencode,0,_.work,Ze={bits:_.lenbits}),_.lenbits=Ze.bits,Ke){x.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,Ke=et(2,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,Ze={bits:_.distbits}),_.distbits=Ze.bits,Ke){x.msg="invalid distances set",_.mode=30;break}if(_.mode=20,6===v)break e;case 20:_.mode=21;case 21:if(6<=j&&258<=te){x.next_out=U,x.avail_out=te,x.next_in=F,x.avail_in=j,_.hold=N,_.bits=m,xe(x,A),U=x.next_out,L=x.output,te=x.avail_out,F=x.next_in,C=x.input,j=x.avail_in,N=_.hold,m=_.bits,12===_.mode&&(_.back=-1);break}for(_.back=0;be=(Oe=_.lencode[N&(1<<_.lenbits)-1])>>>16&255,Te=65535&Oe,!((_e=Oe>>>24)<=m);){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(be&&!(240&be)){for(Pe=_e,We=be,dt=Te;be=(Oe=_.lencode[dt+((N&(1<<Pe+We)-1)>>Pe)])>>>16&255,Te=65535&Oe,!(Pe+(_e=Oe>>>24)<=m);){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}N>>>=Pe,m-=Pe,_.back+=Pe}if(N>>>=_e,m-=_e,_.back+=_e,_.length=Te,0===be){_.mode=26;break}if(32&be){_.back=-1,_.mode=12;break}if(64&be){x.msg="invalid literal/length code",_.mode=30;break}_.extra=15&be,_.mode=22;case 22:if(_.extra){for(Ue=_.extra;m<Ue;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}_.length+=N&(1<<_.extra)-1,N>>>=_.extra,m-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;be=(Oe=_.distcode[N&(1<<_.distbits)-1])>>>16&255,Te=65535&Oe,!((_e=Oe>>>24)<=m);){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(!(240&be)){for(Pe=_e,We=be,dt=Te;be=(Oe=_.distcode[dt+((N&(1<<Pe+We)-1)>>Pe)])>>>16&255,Te=65535&Oe,!(Pe+(_e=Oe>>>24)<=m);){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}N>>>=Pe,m-=Pe,_.back+=Pe}if(N>>>=_e,m-=_e,_.back+=_e,64&be){x.msg="invalid distance code",_.mode=30;break}_.offset=Te,_.extra=15&be,_.mode=24;case 24:if(_.extra){for(Ue=_.extra;m<Ue;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}_.offset+=N&(1<<_.extra)-1,N>>>=_.extra,m-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){x.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(0===te)break e;if(_.offset>(R=A-te)){if((R=_.offset-R)>_.whave&&_.sane){x.msg="invalid distance too far back",_.mode=30;break}k=R>_.wnext?_.wsize-(R-=_.wnext):_.wnext-R,R>_.length&&(R=_.length),J=_.window}else J=L,k=U-_.offset,R=_.length;for(te<R&&(R=te),te-=R,_.length-=R;L[U++]=J[k++],--R;);0===_.length&&(_.mode=21);break;case 26:if(0===te)break e;L[U++]=_.length,te--,_.mode=21;break;case 27:if(_.wrap){for(;m<32;){if(0===j)break e;j--,N|=C[F++]<<m,m+=8}if(x.total_out+=A-=te,_.total+=A,A&&(x.adler=_.check=_.flags?ke(_.check,L,A,U-A):z(_.check,L,A,U-A)),A=te,(_.flags?N:ce(N))!==_.check){x.msg="incorrect data check",_.mode=30;break}m=N=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;m<32;){if(0===j)break e;j--,N+=C[F++]<<m,m+=8}if(N!==(4294967295&_.total)){x.msg="incorrect length check",_.mode=30;break}m=N=0}_.mode=29;case 29:Ke=1;break e;case 30:Ke=-3;break e;case 31:return-4;default:return Re}return x.next_out=U,x.avail_out=te,x.next_in=F,x.avail_in=j,_.hold=N,_.bits=m,(_.wsize||A!==x.avail_out&&_.mode<30&&(_.mode<27||4!==v))&&P(x,x.output,x.next_out,A-x.avail_out)?(_.mode=31,-4):(A-=x.avail_out,x.total_in+=I-=x.avail_in,x.total_out+=A,_.total+=A,_.wrap&&A&&(x.adler=_.check=_.flags?ke(_.check,L,A,x.next_out-A):z(_.check,L,A,x.next_out-A)),x.data_type=_.bits+(_.last?64:0)+(12===_.mode?128:0)+(20===_.mode||15===_.mode?256:0),(0==I&&0===A||4===v)&&Ke===ot&&(Ke=-5),Ke)},ve.inflateEnd=function(x){if(!x||!x.state)return Re;var v=x.state;return v.window&&(v.window=null),x.state=null,ot},ve.inflateGetHeader=function(x,v){var _;return x&&x.state&&2&(_=x.state).wrap?((_.head=v).done=!1,ot):Re},ve.inflateSetDictionary=function(x,v){var _,C=v.length;return x&&x.state?0!==(_=x.state).wrap&&11!==_.mode?Re:11===_.mode&&z(1,v,C,0)!==_.check?-3:P(x,v,C,C)?(_.mode=31,-4):(_.havedict=1,ot):Re},ve.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(vt,Ee,ve){"use strict";var b=vt("../utils/common"),z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ke=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],et=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Ee.exports=function(Je,Xe,ot,Re,He,Ie,O,ce){var ie,he,ue,fe,le,Y,V,D,w,P=ce.bits,x=0,v=0,_=0,C=0,L=0,F=0,U=0,j=0,te=0,N=0,m=null,I=0,A=new b.Buf16(16),R=new b.Buf16(16),k=null,J=0;for(x=0;x<=15;x++)A[x]=0;for(v=0;v<Re;v++)A[Xe[ot+v]]++;for(L=P,C=15;1<=C&&0===A[C];C--);if(C<L&&(L=C),0===C)return He[Ie++]=20971520,He[Ie++]=20971520,ce.bits=1,0;for(_=1;_<C&&0===A[_];_++);for(L<_&&(L=_),x=j=1;x<=15;x++)if(j<<=1,(j-=A[x])<0)return-1;if(0<j&&(0===Je||1!==C))return-1;for(R[1]=0,x=1;x<15;x++)R[x+1]=R[x]+A[x];for(v=0;v<Re;v++)0!==Xe[ot+v]&&(O[R[Xe[ot+v]]++]=v);if(Y=0===Je?(m=k=O,19):1===Je?(m=z,I-=257,k=ke,J-=257,256):(m=xe,k=et,-1),x=_,le=Ie,U=v=N=0,ue=-1,fe=(te=1<<(F=L))-1,1===Je&&852<te||2===Je&&592<te)return 1;for(;;){for(V=x-U,w=O[v]<Y?(D=0,O[v]):O[v]>Y?(D=k[J+O[v]],m[I+O[v]]):(D=96,0),ie=1<<x-U,_=he=1<<F;He[le+(N>>U)+(he-=ie)]=V<<24|D<<16|w,0!==he;);for(ie=1<<x-1;N&ie;)ie>>=1;if(0!==ie?(N&=ie-1,N+=ie):N=0,v++,0==--A[x]){if(x===C)break;x=Xe[ot+O[v]]}if(L<x&&(N&fe)!==ue){for(0===U&&(U=L),le+=_,j=1<<(F=x-U);F+U<C&&!((j-=A[F+U])<=0);)F++,j<<=1;if(te+=1<<F,1===Je&&852<te||2===Je&&592<te)return 1;He[ue=N&fe]=L<<24|F<<16|le-Ie}}return 0!==N&&(He[le+N]=x-U<<24|64<<16),ce.bits=L,0}},{"../utils/common":41}],51:[function(vt,Ee,ve){"use strict";Ee.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(vt,Ee,ve){"use strict";var b=vt("../utils/common");function xe(Oe){for(var lt=Oe.length;0<=--lt;)Oe[lt]=0}var O=15,ce=16,Y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=new Array(576);xe(P);var x=new Array(60);xe(x);var v=new Array(512);xe(v);var _=new Array(256);xe(_);var C=new Array(29);xe(C);var L,F,U,j=new Array(30);function te(Oe,lt,gt,ht,st){this.static_tree=Oe,this.extra_bits=lt,this.extra_base=gt,this.elems=ht,this.max_length=st,this.has_stree=Oe&&Oe.length}function N(Oe,lt){this.dyn_tree=Oe,this.max_code=0,this.stat_desc=lt}function m(Oe){return Oe<256?v[Oe]:v[256+(Oe>>>7)]}function I(Oe,lt){Oe.pending_buf[Oe.pending++]=255&lt,Oe.pending_buf[Oe.pending++]=lt>>>8&255}function A(Oe,lt,gt){Oe.bi_valid>ce-gt?(Oe.bi_buf|=lt<<Oe.bi_valid&65535,I(Oe,Oe.bi_buf),Oe.bi_buf=lt>>ce-Oe.bi_valid,Oe.bi_valid+=gt-ce):(Oe.bi_buf|=lt<<Oe.bi_valid&65535,Oe.bi_valid+=gt)}function R(Oe,lt,gt){A(Oe,gt[2*lt],gt[2*lt+1])}function k(Oe,lt){for(var gt=0;gt|=1&Oe,Oe>>>=1,gt<<=1,0<--lt;);return gt>>>1}function J(Oe,lt,gt){var ht,st,yt=new Array(O+1),Kt=0;for(ht=1;ht<=O;ht++)yt[ht]=Kt=Kt+gt[ht-1]<<1;for(st=0;st<=lt;st++){var Ot=Oe[2*st+1];0!==Ot&&(Oe[2*st]=k(yt[Ot]++,Ot))}}function _e(Oe){var lt;for(lt=0;lt<286;lt++)Oe.dyn_ltree[2*lt]=0;for(lt=0;lt<30;lt++)Oe.dyn_dtree[2*lt]=0;for(lt=0;lt<19;lt++)Oe.bl_tree[2*lt]=0;Oe.dyn_ltree[512]=1,Oe.opt_len=Oe.static_len=0,Oe.last_lit=Oe.matches=0}function be(Oe){8<Oe.bi_valid?I(Oe,Oe.bi_buf):0<Oe.bi_valid&&(Oe.pending_buf[Oe.pending++]=Oe.bi_buf),Oe.bi_buf=0,Oe.bi_valid=0}function Te(Oe,lt,gt,ht){var st=2*lt,yt=2*gt;return Oe[st]<Oe[yt]||Oe[st]===Oe[yt]&&ht[lt]<=ht[gt]}function Pe(Oe,lt,gt){for(var ht=Oe.heap[gt],st=gt<<1;st<=Oe.heap_len&&(st<Oe.heap_len&&Te(lt,Oe.heap[st+1],Oe.heap[st],Oe.depth)&&st++,!Te(lt,ht,Oe.heap[st],Oe.depth));)Oe.heap[gt]=Oe.heap[st],gt=st,st<<=1;Oe.heap[gt]=ht}function We(Oe,lt,gt){var ht,st,yt,Kt,Ot=0;if(0!==Oe.last_lit)for(;ht=Oe.pending_buf[Oe.d_buf+2*Ot]<<8|Oe.pending_buf[Oe.d_buf+2*Ot+1],st=Oe.pending_buf[Oe.l_buf+Ot],Ot++,0===ht?R(Oe,st,lt):(R(Oe,(yt=_[st])+256+1,lt),0!==(Kt=Y[yt])&&A(Oe,st-=C[yt],Kt),R(Oe,yt=m(--ht),gt),0!==(Kt=V[yt])&&A(Oe,ht-=j[yt],Kt)),Ot<Oe.last_lit;);R(Oe,256,lt)}function dt(Oe,lt){var gt,ht,st,yt=lt.dyn_tree,Kt=lt.stat_desc.static_tree,Ot=lt.stat_desc.has_stree,It=lt.stat_desc.elems,An=-1;for(Oe.heap_len=0,Oe.heap_max=573,gt=0;gt<It;gt++)0!==yt[2*gt]?(Oe.heap[++Oe.heap_len]=An=gt,Oe.depth[gt]=0):yt[2*gt+1]=0;for(;Oe.heap_len<2;)yt[2*(st=Oe.heap[++Oe.heap_len]=An<2?++An:0)]=1,Oe.depth[st]=0,Oe.opt_len--,Ot&&(Oe.static_len-=Kt[2*st+1]);for(lt.max_code=An,gt=Oe.heap_len>>1;1<=gt;gt--)Pe(Oe,yt,gt);for(st=It;gt=Oe.heap[1],Oe.heap[1]=Oe.heap[Oe.heap_len--],Pe(Oe,yt,1),ht=Oe.heap[1],Oe.heap[--Oe.heap_max]=gt,Oe.heap[--Oe.heap_max]=ht,yt[2*st]=yt[2*gt]+yt[2*ht],Oe.depth[st]=(Oe.depth[gt]>=Oe.depth[ht]?Oe.depth[gt]:Oe.depth[ht])+1,yt[2*gt+1]=yt[2*ht+1]=st,Oe.heap[1]=st++,Pe(Oe,yt,1),2<=Oe.heap_len;);Oe.heap[--Oe.heap_max]=Oe.heap[1],function(on,pn){var Qt,Bn,dn,yn,Tn,Hn,ti=pn.dyn_tree,hi=pn.max_code,ai=pn.stat_desc.static_tree,Xi=pn.stat_desc.has_stree,Or=pn.stat_desc.extra_bits,Tr=pn.stat_desc.extra_base,ys=pn.stat_desc.max_length,ds=0;for(yn=0;yn<=O;yn++)on.bl_count[yn]=0;for(ti[2*on.heap[on.heap_max]+1]=0,Qt=on.heap_max+1;Qt<573;Qt++)ys<(yn=ti[2*ti[2*(Bn=on.heap[Qt])+1]+1]+1)&&(yn=ys,ds++),ti[2*Bn+1]=yn,hi<Bn||(on.bl_count[yn]++,Tn=0,Tr<=Bn&&(Tn=Or[Bn-Tr]),on.opt_len+=(Hn=ti[2*Bn])*(yn+Tn),Xi&&(on.static_len+=Hn*(ai[2*Bn+1]+Tn)));if(0!==ds){do{for(yn=ys-1;0===on.bl_count[yn];)yn--;on.bl_count[yn]--,on.bl_count[yn+1]+=2,on.bl_count[ys]--,ds-=2}while(0<ds);for(yn=ys;0!==yn;yn--)for(Bn=on.bl_count[yn];0!==Bn;)hi<(dn=on.heap[--Qt])||(ti[2*dn+1]!==yn&&(on.opt_len+=(yn-ti[2*dn+1])*ti[2*dn],ti[2*dn+1]=yn),Bn--)}}(Oe,lt),J(yt,An,Oe.bl_count)}function Q(Oe,lt,gt){var ht,st,yt=-1,Kt=lt[1],Ot=0,It=7,An=4;for(0===Kt&&(It=138,An=3),lt[2*(gt+1)+1]=65535,ht=0;ht<=gt;ht++)st=Kt,Kt=lt[2*(ht+1)+1],++Ot<It&&st===Kt||(Ot<An?Oe.bl_tree[2*st]+=Ot:0!==st?(st!==yt&&Oe.bl_tree[2*st]++,Oe.bl_tree[32]++):Ot<=10?Oe.bl_tree[34]++:Oe.bl_tree[36]++,yt=st,An=(Ot=0)===Kt?(It=138,3):st===Kt?(It=6,3):(It=7,4))}function Ke(Oe,lt,gt){var ht,st,yt=-1,Kt=lt[1],Ot=0,It=7,An=4;for(0===Kt&&(It=138,An=3),ht=0;ht<=gt;ht++)if(st=Kt,Kt=lt[2*(ht+1)+1],!(++Ot<It&&st===Kt)){if(Ot<An)for(;R(Oe,st,Oe.bl_tree),0!=--Ot;);else 0!==st?(st!==yt&&(R(Oe,st,Oe.bl_tree),Ot--),R(Oe,16,Oe.bl_tree),A(Oe,Ot-3,2)):Ot<=10?(R(Oe,17,Oe.bl_tree),A(Oe,Ot-3,3)):(R(Oe,18,Oe.bl_tree),A(Oe,Ot-11,7));yt=st,An=(Ot=0)===Kt?(It=138,3):st===Kt?(It=6,3):(It=7,4)}}xe(j);var Ze=!1;function Ue(Oe,lt,gt,ht){var st,yt,Kt;A(Oe,0+(ht?1:0),3),yt=lt,Kt=gt,be(st=Oe),I(st,Kt),I(st,~Kt),b.arraySet(st.pending_buf,st.window,yt,Kt,st.pending),st.pending+=Kt}ve._tr_init=function(Oe){Ze||(function(){var lt,gt,ht,st,yt,Kt=new Array(O+1);for(st=ht=0;st<28;st++)for(C[st]=ht,lt=0;lt<1<<Y[st];lt++)_[ht++]=st;for(_[ht-1]=st,st=yt=0;st<16;st++)for(j[st]=yt,lt=0;lt<1<<V[st];lt++)v[yt++]=st;for(yt>>=7;st<30;st++)for(j[st]=yt<<7,lt=0;lt<1<<V[st]-7;lt++)v[256+yt++]=st;for(gt=0;gt<=O;gt++)Kt[gt]=0;for(lt=0;lt<=143;)P[2*lt+1]=8,lt++,Kt[8]++;for(;lt<=255;)P[2*lt+1]=9,lt++,Kt[9]++;for(;lt<=279;)P[2*lt+1]=7,lt++,Kt[7]++;for(;lt<=287;)P[2*lt+1]=8,lt++,Kt[8]++;for(J(P,287,Kt),lt=0;lt<30;lt++)x[2*lt+1]=5,x[2*lt]=k(lt,5);L=new te(P,Y,257,286,O),F=new te(x,V,0,30,O),U=new te(new Array(0),D,0,19,7)}(),Ze=!0),Oe.l_desc=new N(Oe.dyn_ltree,L),Oe.d_desc=new N(Oe.dyn_dtree,F),Oe.bl_desc=new N(Oe.bl_tree,U),Oe.bi_buf=0,Oe.bi_valid=0,_e(Oe)},ve._tr_stored_block=Ue,ve._tr_flush_block=function(Oe,lt,gt,ht){var st,yt,Kt=0;0<Oe.level?(2===Oe.strm.data_type&&(Oe.strm.data_type=function(Ot){var It,An=4093624447;for(It=0;It<=31;It++,An>>>=1)if(1&An&&0!==Ot.dyn_ltree[2*It])return 0;if(0!==Ot.dyn_ltree[18]||0!==Ot.dyn_ltree[20]||0!==Ot.dyn_ltree[26])return 1;for(It=32;It<256;It++)if(0!==Ot.dyn_ltree[2*It])return 1;return 0}(Oe)),dt(Oe,Oe.l_desc),dt(Oe,Oe.d_desc),Kt=function(Ot){var It;for(Q(Ot,Ot.dyn_ltree,Ot.l_desc.max_code),Q(Ot,Ot.dyn_dtree,Ot.d_desc.max_code),dt(Ot,Ot.bl_desc),It=18;3<=It&&0===Ot.bl_tree[2*w[It]+1];It--);return Ot.opt_len+=3*(It+1)+5+5+4,It}(Oe),(yt=Oe.static_len+3+7>>>3)<=(st=Oe.opt_len+3+7>>>3)&&(st=yt)):st=yt=gt+5,gt+4<=st&&-1!==lt?Ue(Oe,lt,gt,ht):4===Oe.strategy||yt===st?(A(Oe,2+(ht?1:0),3),We(Oe,P,x)):(A(Oe,4+(ht?1:0),3),function(Ot,It,An,on){var pn;for(A(Ot,It-257,5),A(Ot,An-1,5),A(Ot,on-4,4),pn=0;pn<on;pn++)A(Ot,Ot.bl_tree[2*w[pn]+1],3);Ke(Ot,Ot.dyn_ltree,It-1),Ke(Ot,Ot.dyn_dtree,An-1)}(Oe,Oe.l_desc.max_code+1,Oe.d_desc.max_code+1,Kt+1),We(Oe,Oe.dyn_ltree,Oe.dyn_dtree)),_e(Oe),ht&&be(Oe)},ve._tr_tally=function(Oe,lt,gt){return Oe.pending_buf[Oe.d_buf+2*Oe.last_lit]=lt>>>8&255,Oe.pending_buf[Oe.d_buf+2*Oe.last_lit+1]=255&lt,Oe.pending_buf[Oe.l_buf+Oe.last_lit]=255&gt,Oe.last_lit++,0===lt?Oe.dyn_ltree[2*gt]++:(Oe.matches++,lt--,Oe.dyn_ltree[2*(_[gt]+256+1)]++,Oe.dyn_dtree[2*m(lt)]++),Oe.last_lit===Oe.lit_bufsize-1},ve._tr_align=function(Oe){var lt;A(Oe,2,3),R(Oe,256,P),16===(lt=Oe).bi_valid?(I(lt,lt.bi_buf),lt.bi_buf=0,lt.bi_valid=0):8<=lt.bi_valid&&(lt.pending_buf[lt.pending++]=255&lt.bi_buf,lt.bi_buf>>=8,lt.bi_valid-=8)}},{"../utils/common":41}],53:[function(vt,Ee,ve){"use strict";Ee.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(vt,Ee,ve){(function(b){!function(z,ke){"use strict";if(!z.setImmediate){var xe,et,Je,Xe,ot=1,Re={},He=!1,Ie=z.document,O=Object.getPrototypeOf&&Object.getPrototypeOf(z);O=O&&O.setTimeout?O:z,xe="[object process]"==={}.toString.call(z.process)?function(ue){process.nextTick(function(){ie(ue)})}:function(){if(z.postMessage&&!z.importScripts){var ue=!0,fe=z.onmessage;return z.onmessage=function(){ue=!1},z.postMessage("","*"),z.onmessage=fe,ue}}()?(Xe="setImmediate$"+Math.random()+"$",z.addEventListener?z.addEventListener("message",he,!1):z.attachEvent("onmessage",he),function(ue){z.postMessage(Xe+ue,"*")}):z.MessageChannel?((Je=new MessageChannel).port1.onmessage=function(ue){ie(ue.data)},function(ue){Je.port2.postMessage(ue)}):Ie&&"onreadystatechange"in Ie.createElement("script")?(et=Ie.documentElement,function(ue){var fe=Ie.createElement("script");fe.onreadystatechange=function(){ie(ue),fe.onreadystatechange=null,et.removeChild(fe),fe=null},et.appendChild(fe)}):function(ue){setTimeout(ie,0,ue)},O.setImmediate=function(ue){"function"!=typeof ue&&(ue=new Function(""+ue));for(var fe=new Array(arguments.length-1),le=0;le<fe.length;le++)fe[le]=arguments[le+1];return Re[ot]={callback:ue,args:fe},xe(ot),ot++},O.clearImmediate=ce}function ce(ue){delete Re[ue]}function ie(ue){if(He)setTimeout(ie,0,ue);else{var fe=Re[ue];if(fe){He=!0;try{!function(le){var Y=le.callback,V=le.args;switch(V.length){case 0:Y();break;case 1:Y(V[0]);break;case 2:Y(V[0],V[1]);break;case 3:Y(V[0],V[1],V[2]);break;default:Y.apply(ke,V)}}(fe)}finally{ce(ue),He=!1}}}}function he(ue){ue.source===z&&"string"==typeof ue.data&&0===ue.data.indexOf(Xe)&&ie(+ue.data.slice(Xe.length))}}(typeof self>"u"?void 0===b?this:b:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},8314:(Ur,vt,Ee)=>{const ve=Ee(2836),b=Ee(9460),z=Ee(7030),ke=Ee(6511);function xe(et,Je,Xe,ot,Re){const He=[].slice.call(arguments,1),Ie=He.length,O="function"==typeof He[Ie-1];if(!O&&!ve())throw new Error("Callback required as last argument");if(!O){if(Ie<1)throw new Error("Too few arguments provided");return 1===Ie?(Xe=Je,Je=ot=void 0):2===Ie&&!Je.getContext&&(ot=Xe,Xe=Je,Je=void 0),new Promise(function(ce,ie){try{const he=b.create(Xe,ot);ce(et(he,Je,ot))}catch(he){ie(he)}})}if(Ie<2)throw new Error("Too few arguments provided");2===Ie?(Re=Xe,Xe=Je,Je=ot=void 0):3===Ie&&(Je.getContext&&typeof Re>"u"?(Re=ot,ot=void 0):(Re=ot,ot=Xe,Xe=Je,Je=void 0));try{const ce=b.create(Xe,ot);Re(null,et(ce,Je,ot))}catch(ce){Re(ce)}}vt.create=b.create,vt.toCanvas=xe.bind(null,z.render),vt.toDataURL=xe.bind(null,z.renderToDataURL),vt.toString=xe.bind(null,function(et,Je,Xe){return ke.render(et,Xe)})},2836:Ur=>{Ur.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},6214:(Ur,vt,Ee)=>{const ve=Ee(9089).getSymbolSize;vt.getRowColCoords=function(z){if(1===z)return[];const ke=Math.floor(z/7)+2,xe=ve(z),et=145===xe?26:2*Math.ceil((xe-13)/(2*ke-2)),Je=[xe-7];for(let Xe=1;Xe<ke-1;Xe++)Je[Xe]=Je[Xe-1]-et;return Je.push(6),Je.reverse()},vt.getPositions=function(z){const ke=[],xe=vt.getRowColCoords(z),et=xe.length;for(let Je=0;Je<et;Je++)for(let Xe=0;Xe<et;Xe++)0===Je&&0===Xe||0===Je&&Xe===et-1||Je===et-1&&0===Xe||ke.push([xe[Je],xe[Xe]]);return ke}},1018:(Ur,vt,Ee)=>{const ve=Ee(1677),b=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function z(ke){this.mode=ve.ALPHANUMERIC,this.data=ke}z.getBitsLength=function(xe){return 11*Math.floor(xe/2)+xe%2*6},z.prototype.getLength=function(){return this.data.length},z.prototype.getBitsLength=function(){return z.getBitsLength(this.data.length)},z.prototype.write=function(xe){let et;for(et=0;et+2<=this.data.length;et+=2){let Je=45*b.indexOf(this.data[et]);Je+=b.indexOf(this.data[et+1]),xe.put(Je,11)}this.data.length%2&&xe.put(b.indexOf(this.data[et]),6)},Ur.exports=z},4662:Ur=>{function vt(){this.buffer=[],this.length=0}vt.prototype={get:function(Ee){const ve=Math.floor(Ee/8);return 1==(this.buffer[ve]>>>7-Ee%8&1)},put:function(Ee,ve){for(let b=0;b<ve;b++)this.putBit(1==(Ee>>>ve-b-1&1))},getLengthInBits:function(){return this.length},putBit:function(Ee){const ve=Math.floor(this.length/8);this.buffer.length<=ve&&this.buffer.push(0),Ee&&(this.buffer[ve]|=128>>>this.length%8),this.length++}},Ur.exports=vt},5941:Ur=>{function vt(Ee){if(!Ee||Ee<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=Ee,this.data=new Uint8Array(Ee*Ee),this.reservedBit=new Uint8Array(Ee*Ee)}vt.prototype.set=function(Ee,ve,b,z){const ke=Ee*this.size+ve;this.data[ke]=b,z&&(this.reservedBit[ke]=!0)},vt.prototype.get=function(Ee,ve){return this.data[Ee*this.size+ve]},vt.prototype.xor=function(Ee,ve,b){this.data[Ee*this.size+ve]^=b},vt.prototype.isReserved=function(Ee,ve){return this.reservedBit[Ee*this.size+ve]},Ur.exports=vt},4969:(Ur,vt,Ee)=>{const ve=Ee(3174),b=Ee(1677);function z(ke){this.mode=b.BYTE,"string"==typeof ke&&(ke=ve(ke)),this.data=new Uint8Array(ke)}z.getBitsLength=function(xe){return 8*xe},z.prototype.getLength=function(){return this.data.length},z.prototype.getBitsLength=function(){return z.getBitsLength(this.data.length)},z.prototype.write=function(ke){for(let xe=0,et=this.data.length;xe<et;xe++)ke.put(this.data[xe],8)},Ur.exports=z},3677:(Ur,vt,Ee)=>{const ve=Ee(7424),b=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],z=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];vt.getBlocksCount=function(xe,et){switch(et){case ve.L:return b[4*(xe-1)+0];case ve.M:return b[4*(xe-1)+1];case ve.Q:return b[4*(xe-1)+2];case ve.H:return b[4*(xe-1)+3];default:return}},vt.getTotalCodewordsCount=function(xe,et){switch(et){case ve.L:return z[4*(xe-1)+0];case ve.M:return z[4*(xe-1)+1];case ve.Q:return z[4*(xe-1)+2];case ve.H:return z[4*(xe-1)+3];default:return}}},7424:(Ur,vt)=>{vt.L={bit:1},vt.M={bit:0},vt.Q={bit:3},vt.H={bit:2},vt.isValid=function(b){return b&&typeof b.bit<"u"&&b.bit>=0&&b.bit<4},vt.from=function(b,z){if(vt.isValid(b))return b;try{return function Ee(ve){if("string"!=typeof ve)throw new Error("Param is not a string");switch(ve.toLowerCase()){case"l":case"low":return vt.L;case"m":case"medium":return vt.M;case"q":case"quartile":return vt.Q;case"h":case"high":return vt.H;default:throw new Error("Unknown EC Level: "+ve)}}(b)}catch{return z}}},6269:(Ur,vt,Ee)=>{const ve=Ee(9089).getSymbolSize;vt.getPositions=function(ke){const xe=ve(ke);return[[0,0],[xe-7,0],[0,xe-7]]}},6254:(Ur,vt,Ee)=>{const ve=Ee(9089),ke=ve.getBCHDigit(1335);vt.getEncodedBits=function(et,Je){const Xe=et.bit<<3|Je;let ot=Xe<<10;for(;ve.getBCHDigit(ot)-ke>=0;)ot^=1335<<ve.getBCHDigit(ot)-ke;return 21522^(Xe<<10|ot)}},6686:(Ur,vt)=>{const Ee=new Uint8Array(512),ve=new Uint8Array(256);(function(){let z=1;for(let ke=0;ke<255;ke++)Ee[ke]=z,ve[z]=ke,z<<=1,256&z&&(z^=285);for(let ke=255;ke<512;ke++)Ee[ke]=Ee[ke-255]})(),vt.log=function(z){if(z<1)throw new Error("log("+z+")");return ve[z]},vt.exp=function(z){return Ee[z]},vt.mul=function(z,ke){return 0===z||0===ke?0:Ee[ve[z]+ve[ke]]}},3264:(Ur,vt,Ee)=>{const ve=Ee(1677),b=Ee(9089);function z(ke){this.mode=ve.KANJI,this.data=ke}z.getBitsLength=function(xe){return 13*xe},z.prototype.getLength=function(){return this.data.length},z.prototype.getBitsLength=function(){return z.getBitsLength(this.data.length)},z.prototype.write=function(ke){let xe;for(xe=0;xe<this.data.length;xe++){let et=b.toSJIS(this.data[xe]);if(et>=33088&&et<=40956)et-=33088;else{if(!(et>=57408&&et<=60351))throw new Error("Invalid SJIS character: "+this.data[xe]+"\nMake sure your charset is UTF-8");et-=49472}et=192*(et>>>8&255)+(255&et),ke.put(et,13)}},Ur.exports=z},3361:(Ur,vt)=>{vt.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function ve(b,z,ke){switch(b){case vt.Patterns.PATTERN000:return(z+ke)%2==0;case vt.Patterns.PATTERN001:return z%2==0;case vt.Patterns.PATTERN010:return ke%3==0;case vt.Patterns.PATTERN011:return(z+ke)%3==0;case vt.Patterns.PATTERN100:return(Math.floor(z/2)+Math.floor(ke/3))%2==0;case vt.Patterns.PATTERN101:return z*ke%2+z*ke%3==0;case vt.Patterns.PATTERN110:return(z*ke%2+z*ke%3)%2==0;case vt.Patterns.PATTERN111:return(z*ke%3+(z+ke)%2)%2==0;default:throw new Error("bad maskPattern:"+b)}}vt.isValid=function(z){return null!=z&&""!==z&&!isNaN(z)&&z>=0&&z<=7},vt.from=function(z){return vt.isValid(z)?parseInt(z,10):void 0},vt.getPenaltyN1=function(z){const ke=z.size;let xe=0,et=0,Je=0,Xe=null,ot=null;for(let Re=0;Re<ke;Re++){et=Je=0,Xe=ot=null;for(let He=0;He<ke;He++){let Ie=z.get(Re,He);Ie===Xe?et++:(et>=5&&(xe+=et-5+3),Xe=Ie,et=1),Ie=z.get(He,Re),Ie===ot?Je++:(Je>=5&&(xe+=Je-5+3),ot=Ie,Je=1)}et>=5&&(xe+=et-5+3),Je>=5&&(xe+=Je-5+3)}return xe},vt.getPenaltyN2=function(z){const ke=z.size;let xe=0;for(let et=0;et<ke-1;et++)for(let Je=0;Je<ke-1;Je++){const Xe=z.get(et,Je)+z.get(et,Je+1)+z.get(et+1,Je)+z.get(et+1,Je+1);(4===Xe||0===Xe)&&xe++}return 3*xe},vt.getPenaltyN3=function(z){const ke=z.size;let xe=0,et=0,Je=0;for(let Xe=0;Xe<ke;Xe++){et=Je=0;for(let ot=0;ot<ke;ot++)et=et<<1&2047|z.get(Xe,ot),ot>=10&&(1488===et||93===et)&&xe++,Je=Je<<1&2047|z.get(ot,Xe),ot>=10&&(1488===Je||93===Je)&&xe++}return 40*xe},vt.getPenaltyN4=function(z){let ke=0;const xe=z.data.length;for(let Je=0;Je<xe;Je++)ke+=z.data[Je];return 10*Math.abs(Math.ceil(100*ke/xe/5)-10)},vt.applyMask=function(z,ke){const xe=ke.size;for(let et=0;et<xe;et++)for(let Je=0;Je<xe;Je++)ke.isReserved(Je,et)||ke.xor(Je,et,ve(z,Je,et))},vt.getBestMask=function(z,ke){const xe=Object.keys(vt.Patterns).length;let et=0,Je=1/0;for(let Xe=0;Xe<xe;Xe++){ke(Xe),vt.applyMask(Xe,z);const ot=vt.getPenaltyN1(z)+vt.getPenaltyN2(z)+vt.getPenaltyN3(z)+vt.getPenaltyN4(z);vt.applyMask(Xe,z),ot<Je&&(Je=ot,et=Xe)}return et}},1677:(Ur,vt,Ee)=>{const ve=Ee(377),b=Ee(9359);vt.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},vt.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},vt.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},vt.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},vt.MIXED={bit:-1},vt.getCharCountIndicator=function(xe,et){if(!xe.ccBits)throw new Error("Invalid mode: "+xe);if(!ve.isValid(et))throw new Error("Invalid version: "+et);return et>=1&&et<10?xe.ccBits[0]:et<27?xe.ccBits[1]:xe.ccBits[2]},vt.getBestModeForData=function(xe){return b.testNumeric(xe)?vt.NUMERIC:b.testAlphanumeric(xe)?vt.ALPHANUMERIC:b.testKanji(xe)?vt.KANJI:vt.BYTE},vt.toString=function(xe){if(xe&&xe.id)return xe.id;throw new Error("Invalid mode")},vt.isValid=function(xe){return xe&&xe.bit&&xe.ccBits},vt.from=function(xe,et){if(vt.isValid(xe))return xe;try{return function z(ke){if("string"!=typeof ke)throw new Error("Param is not a string");switch(ke.toLowerCase()){case"numeric":return vt.NUMERIC;case"alphanumeric":return vt.ALPHANUMERIC;case"kanji":return vt.KANJI;case"byte":return vt.BYTE;default:throw new Error("Unknown mode: "+ke)}}(xe)}catch{return et}}},6628:(Ur,vt,Ee)=>{const ve=Ee(1677);function b(z){this.mode=ve.NUMERIC,this.data=z.toString()}b.getBitsLength=function(ke){return 10*Math.floor(ke/3)+(ke%3?ke%3*3+1:0)},b.prototype.getLength=function(){return this.data.length},b.prototype.getBitsLength=function(){return b.getBitsLength(this.data.length)},b.prototype.write=function(ke){let xe,et,Je;for(xe=0;xe+3<=this.data.length;xe+=3)et=this.data.substr(xe,3),Je=parseInt(et,10),ke.put(Je,10);const Xe=this.data.length-xe;Xe>0&&(et=this.data.substr(xe),Je=parseInt(et,10),ke.put(Je,3*Xe+1))},Ur.exports=b},1744:(Ur,vt,Ee)=>{const ve=Ee(6686);vt.mul=function(z,ke){const xe=new Uint8Array(z.length+ke.length-1);for(let et=0;et<z.length;et++)for(let Je=0;Je<ke.length;Je++)xe[et+Je]^=ve.mul(z[et],ke[Je]);return xe},vt.mod=function(z,ke){let xe=new Uint8Array(z);for(;xe.length-ke.length>=0;){const et=xe[0];for(let Xe=0;Xe<ke.length;Xe++)xe[Xe]^=ve.mul(ke[Xe],et);let Je=0;for(;Je<xe.length&&0===xe[Je];)Je++;xe=xe.slice(Je)}return xe},vt.generateECPolynomial=function(z){let ke=new Uint8Array([1]);for(let xe=0;xe<z;xe++)ke=vt.mul(ke,new Uint8Array([1,ve.exp(xe)]));return ke}},9460:(Ur,vt,Ee)=>{const ve=Ee(9089),b=Ee(7424),z=Ee(4662),ke=Ee(5941),xe=Ee(6214),et=Ee(6269),Je=Ee(3361),Xe=Ee(3677),ot=Ee(6289),Re=Ee(1252),He=Ee(6254),Ie=Ee(1677),O=Ee(2868);function fe(w,P,x){const v=w.size,_=He.getEncodedBits(P,x);let C,L;for(C=0;C<15;C++)L=1==(_>>C&1),w.set(C<6?C:C<8?C+1:v-15+C,8,L,!0),w.set(8,C<8?v-C-1:C<9?15-C-1+1:15-C-1,L,!0);w.set(v-8,8,1,!0)}function D(w,P,x,v){let _;if(Array.isArray(w))_=O.fromArray(w);else{if("string"!=typeof w)throw new Error("Invalid data");{let j=P;if(!j){const te=O.rawSplit(w);j=Re.getBestVersionForData(te,x)}_=O.fromString(w,j||40)}}const C=Re.getBestVersionForData(_,x);if(!C)throw new Error("The amount of data is too big to be stored in a QR Code");if(P){if(P<C)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+C+".\n")}else P=C;const L=function Y(w,P,x){const v=new z;x.forEach(function(U){v.put(U.mode.bit,4),v.put(U.getLength(),Ie.getCharCountIndicator(U.mode,w)),U.write(v)});const L=8*(ve.getSymbolTotalCodewords(w)-Xe.getTotalCodewordsCount(w,P));for(v.getLengthInBits()+4<=L&&v.put(0,4);v.getLengthInBits()%8!=0;)v.putBit(0);const F=(L-v.getLengthInBits())/8;for(let U=0;U<F;U++)v.put(U%2?17:236,8);return function V(w,P,x){const v=ve.getSymbolTotalCodewords(P),C=v-Xe.getTotalCodewordsCount(P,x),L=Xe.getBlocksCount(P,x),U=L-v%L,j=Math.floor(v/L),te=Math.floor(C/L),N=te+1,m=j-te,I=new ot(m);let A=0;const R=new Array(L),k=new Array(L);let J=0;const _e=new Uint8Array(w.buffer);for(let dt=0;dt<L;dt++){const Q=dt<U?te:N;R[dt]=_e.slice(A,A+Q),k[dt]=I.encode(R[dt]),A+=Q,J=Math.max(J,Q)}const be=new Uint8Array(v);let Pe,We,Te=0;for(Pe=0;Pe<J;Pe++)for(We=0;We<L;We++)Pe<R[We].length&&(be[Te++]=R[We][Pe]);for(Pe=0;Pe<m;Pe++)for(We=0;We<L;We++)be[Te++]=k[We][Pe];return be}(v,w,P)}(P,x,_),F=ve.getSymbolSize(P),U=new ke(F);return function ce(w,P){const x=w.size,v=et.getPositions(P);for(let _=0;_<v.length;_++){const C=v[_][0],L=v[_][1];for(let F=-1;F<=7;F++)if(!(C+F<=-1||x<=C+F))for(let U=-1;U<=7;U++)L+U<=-1||x<=L+U||w.set(C+F,L+U,F>=0&&F<=6&&(0===U||6===U)||U>=0&&U<=6&&(0===F||6===F)||F>=2&&F<=4&&U>=2&&U<=4,!0)}}(U,P),function ie(w){const P=w.size;for(let x=8;x<P-8;x++){const v=x%2==0;w.set(x,6,v,!0),w.set(6,x,v,!0)}}(U),function he(w,P){const x=xe.getPositions(P);for(let v=0;v<x.length;v++){const _=x[v][0],C=x[v][1];for(let L=-2;L<=2;L++)for(let F=-2;F<=2;F++)w.set(_+L,C+F,-2===L||2===L||-2===F||2===F||0===L&&0===F,!0)}}(U,P),fe(U,x,0),P>=7&&function ue(w,P){const x=w.size,v=Re.getEncodedBits(P);let _,C,L;for(let F=0;F<18;F++)_=Math.floor(F/3),C=F%3+x-8-3,L=1==(v>>F&1),w.set(_,C,L,!0),w.set(C,_,L,!0)}(U,P),function le(w,P){const x=w.size;let v=-1,_=x-1,C=7,L=0;for(let F=x-1;F>0;F-=2)for(6===F&&F--;;){for(let U=0;U<2;U++)if(!w.isReserved(_,F-U)){let j=!1;L<P.length&&(j=1==(P[L]>>>C&1)),w.set(_,F-U,j),C--,-1===C&&(L++,C=7)}if(_+=v,_<0||x<=_){_-=v,v=-v;break}}}(U,L),isNaN(v)&&(v=Je.getBestMask(U,fe.bind(null,U,x))),Je.applyMask(v,U),fe(U,x,v),{modules:U,version:P,errorCorrectionLevel:x,maskPattern:v,segments:_}}vt.create=function(P,x){if(typeof P>"u"||""===P)throw new Error("No input text");let _,C,v=b.M;return typeof x<"u"&&(v=b.from(x.errorCorrectionLevel,b.M),_=Re.from(x.version),C=Je.from(x.maskPattern),x.toSJISFunc&&ve.setToSJISFunction(x.toSJISFunc)),D(P,_,v,C)}},6289:(Ur,vt,Ee)=>{const ve=Ee(1744);function b(z){this.genPoly=void 0,this.degree=z,this.degree&&this.initialize(this.degree)}b.prototype.initialize=function(ke){this.degree=ke,this.genPoly=ve.generateECPolynomial(this.degree)},b.prototype.encode=function(ke){if(!this.genPoly)throw new Error("Encoder not initialized");const xe=new Uint8Array(ke.length+this.degree);xe.set(ke);const et=ve.mod(xe,this.genPoly),Je=this.degree-et.length;if(Je>0){const Xe=new Uint8Array(this.degree);return Xe.set(et,Je),Xe}return et},Ur.exports=b},9359:(Ur,vt)=>{let b="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";b=b.replace(/u/g,"\\u");const z="(?:(?![A-Z0-9 $%*+\\-./:]|"+b+")(?:.|[\r\n]))+";vt.KANJI=new RegExp(b,"g"),vt.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),vt.BYTE=new RegExp(z,"g"),vt.NUMERIC=new RegExp("[0-9]+","g"),vt.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const ke=new RegExp("^"+b+"$"),xe=new RegExp("^[0-9]+$"),et=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");vt.testKanji=function(Xe){return ke.test(Xe)},vt.testNumeric=function(Xe){return xe.test(Xe)},vt.testAlphanumeric=function(Xe){return et.test(Xe)}},2868:(Ur,vt,Ee)=>{const ve=Ee(1677),b=Ee(6628),z=Ee(1018),ke=Ee(4969),xe=Ee(3264),et=Ee(9359),Je=Ee(9089),Xe=Ee(243);function ot(ue){return unescape(encodeURIComponent(ue)).length}function Re(ue,fe,le){const Y=[];let V;for(;null!==(V=ue.exec(le));)Y.push({data:V[0],index:V.index,mode:fe,length:V[0].length});return Y}function He(ue){const fe=Re(et.NUMERIC,ve.NUMERIC,ue),le=Re(et.ALPHANUMERIC,ve.ALPHANUMERIC,ue);let Y,V;return Je.isKanjiModeEnabled()?(Y=Re(et.BYTE,ve.BYTE,ue),V=Re(et.KANJI,ve.KANJI,ue)):(Y=Re(et.BYTE_KANJI,ve.BYTE,ue),V=[]),fe.concat(le,Y,V).sort(function(w,P){return w.index-P.index}).map(function(w){return{data:w.data,mode:w.mode,length:w.length}})}function Ie(ue,fe){switch(fe){case ve.NUMERIC:return b.getBitsLength(ue);case ve.ALPHANUMERIC:return z.getBitsLength(ue);case ve.KANJI:return xe.getBitsLength(ue);case ve.BYTE:return ke.getBitsLength(ue)}}function he(ue,fe){let le;const Y=ve.getBestModeForData(ue);if(le=ve.from(fe,Y),le!==ve.BYTE&&le.bit<Y.bit)throw new Error('"'+ue+'" cannot be encoded with mode '+ve.toString(le)+".\n Suggested mode is: "+ve.toString(Y));switch(le===ve.KANJI&&!Je.isKanjiModeEnabled()&&(le=ve.BYTE),le){case ve.NUMERIC:return new b(ue);case ve.ALPHANUMERIC:return new z(ue);case ve.KANJI:return new xe(ue);case ve.BYTE:return new ke(ue)}}vt.fromArray=function(fe){return fe.reduce(function(le,Y){return"string"==typeof Y?le.push(he(Y,null)):Y.data&&le.push(he(Y.data,Y.mode)),le},[])},vt.fromString=function(fe,le){const V=function ce(ue){const fe=[];for(let le=0;le<ue.length;le++){const Y=ue[le];switch(Y.mode){case ve.NUMERIC:fe.push([Y,{data:Y.data,mode:ve.ALPHANUMERIC,length:Y.length},{data:Y.data,mode:ve.BYTE,length:Y.length}]);break;case ve.ALPHANUMERIC:fe.push([Y,{data:Y.data,mode:ve.BYTE,length:Y.length}]);break;case ve.KANJI:fe.push([Y,{data:Y.data,mode:ve.BYTE,length:ot(Y.data)}]);break;case ve.BYTE:fe.push([{data:Y.data,mode:ve.BYTE,length:ot(Y.data)}])}}return fe}(He(fe,Je.isKanjiModeEnabled())),D=function ie(ue,fe){const le={},Y={start:{}};let V=["start"];for(let D=0;D<ue.length;D++){const w=ue[D],P=[];for(let x=0;x<w.length;x++){const v=w[x],_=""+D+x;P.push(_),le[_]={node:v,lastCount:0},Y[_]={};for(let C=0;C<V.length;C++){const L=V[C];le[L]&&le[L].node.mode===v.mode?(Y[L][_]=Ie(le[L].lastCount+v.length,v.mode)-Ie(le[L].lastCount,v.mode),le[L].lastCount+=v.length):(le[L]&&(le[L].lastCount=v.length),Y[L][_]=Ie(v.length,v.mode)+4+ve.getCharCountIndicator(v.mode,fe))}}V=P}for(let D=0;D<V.length;D++)Y[V[D]].end=0;return{map:Y,table:le}}(V,le),w=Xe.find_path(D.map,"start","end"),P=[];for(let x=1;x<w.length-1;x++)P.push(D.table[w[x]].node);return vt.fromArray(function O(ue){return ue.reduce(function(fe,le){const Y=fe.length-1>=0?fe[fe.length-1]:null;return Y&&Y.mode===le.mode?(fe[fe.length-1].data+=le.data,fe):(fe.push(le),fe)},[])}(P))},vt.rawSplit=function(fe){return vt.fromArray(He(fe,Je.isKanjiModeEnabled()))}},9089:(Ur,vt)=>{let Ee;const ve=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];vt.getSymbolSize=function(z){if(!z)throw new Error('"version" cannot be null or undefined');if(z<1||z>40)throw new Error('"version" should be in range from 1 to 40');return 4*z+17},vt.getSymbolTotalCodewords=function(z){return ve[z]},vt.getBCHDigit=function(b){let z=0;for(;0!==b;)z++,b>>>=1;return z},vt.setToSJISFunction=function(z){if("function"!=typeof z)throw new Error('"toSJISFunc" is not a valid function.');Ee=z},vt.isKanjiModeEnabled=function(){return typeof Ee<"u"},vt.toSJIS=function(z){return Ee(z)}},377:(Ur,vt)=>{vt.isValid=function(ve){return!isNaN(ve)&&ve>=1&&ve<=40}},1252:(Ur,vt,Ee)=>{const ve=Ee(9089),b=Ee(3677),z=Ee(7424),ke=Ee(1677),xe=Ee(377),Je=ve.getBCHDigit(7973);function ot(Ie,O){return ke.getCharCountIndicator(Ie,O)+4}function Re(Ie,O){let ce=0;return Ie.forEach(function(ie){const he=ot(ie.mode,O);ce+=he+ie.getBitsLength()}),ce}vt.from=function(O,ce){return xe.isValid(O)?parseInt(O,10):ce},vt.getCapacity=function(O,ce,ie){if(!xe.isValid(O))throw new Error("Invalid QR Code version");typeof ie>"u"&&(ie=ke.BYTE);const fe=8*(ve.getSymbolTotalCodewords(O)-b.getTotalCodewordsCount(O,ce));if(ie===ke.MIXED)return fe;const le=fe-ot(ie,O);switch(ie){case ke.NUMERIC:return Math.floor(le/10*3);case ke.ALPHANUMERIC:return Math.floor(le/11*2);case ke.KANJI:return Math.floor(le/13);default:return Math.floor(le/8)}},vt.getBestVersionForData=function(O,ce){let ie;const he=z.from(ce,z.M);if(Array.isArray(O)){if(O.length>1)return function He(Ie,O){for(let ce=1;ce<=40;ce++)if(Re(Ie,ce)<=vt.getCapacity(ce,O,ke.MIXED))return ce}(O,he);if(0===O.length)return 1;ie=O[0]}else ie=O;return function Xe(Ie,O,ce){for(let ie=1;ie<=40;ie++)if(O<=vt.getCapacity(ie,ce,Ie))return ie}(ie.mode,ie.getLength(),he)},vt.getEncodedBits=function(O){if(!xe.isValid(O)||O<7)throw new Error("Invalid QR Code version");let ce=O<<12;for(;ve.getBCHDigit(ce)-Je>=0;)ce^=7973<<ve.getBCHDigit(ce)-Je;return O<<12|ce}},7030:(Ur,vt,Ee)=>{const ve=Ee(7077);vt.render=function(xe,et,Je){let Xe=Je,ot=et;typeof Xe>"u"&&(!et||!et.getContext)&&(Xe=et,et=void 0),et||(ot=function z(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),Xe=ve.getOptions(Xe);const Re=ve.getImageWidth(xe.modules.size,Xe),He=ot.getContext("2d"),Ie=He.createImageData(Re,Re);return ve.qrToImageData(Ie.data,xe,Xe),function b(ke,xe,et){ke.clearRect(0,0,xe.width,xe.height),xe.style||(xe.style={}),xe.height=et,xe.width=et,xe.style.height=et+"px",xe.style.width=et+"px"}(He,ot,Re),He.putImageData(Ie,0,0),ot},vt.renderToDataURL=function(xe,et,Je){let Xe=Je;return typeof Xe>"u"&&(!et||!et.getContext)&&(Xe=et,et=void 0),Xe||(Xe={}),vt.render(xe,et,Xe).toDataURL(Xe.type||"image/png",(Xe.rendererOpts||{}).quality)}},6511:(Ur,vt,Ee)=>{const ve=Ee(7077);function b(xe,et){const Je=xe.a/255,Xe=et+'="'+xe.hex+'"';return Je<1?Xe+" "+et+'-opacity="'+Je.toFixed(2).slice(1)+'"':Xe}function z(xe,et,Je){let Xe=xe+et;return typeof Je<"u"&&(Xe+=" "+Je),Xe}vt.render=function(et,Je,Xe){const ot=ve.getOptions(Je),Re=et.modules.size,He=et.modules.data,Ie=Re+2*ot.margin,O=ot.color.light.a?"<path "+b(ot.color.light,"fill")+' d="M0 0h'+Ie+"v"+Ie+'H0z"/>':"",ce="<path "+b(ot.color.dark,"stroke")+' d="'+function ke(xe,et,Je){let Xe="",ot=0,Re=!1,He=0;for(let Ie=0;Ie<xe.length;Ie++){const O=Math.floor(Ie%et),ce=Math.floor(Ie/et);!O&&!Re&&(Re=!0),xe[Ie]?(He++,Ie>0&&O>0&&xe[Ie-1]||(Xe+=Re?z("M",O+Je,.5+ce+Je):z("m",ot,0),ot=0,Re=!1),O+1<et&&xe[Ie+1]||(Xe+=z("h",He),He=0)):ot++}return Xe}(He,Re,ot.margin)+'"/>',ue='<svg xmlns="http://www.w3.org/2000/svg" '+(ot.width?'width="'+ot.width+'" height="'+ot.width+'" ':"")+'viewBox="0 0 '+Ie+" "+Ie+'" shape-rendering="crispEdges">'+O+ce+"</svg>\n";return"function"==typeof Xe&&Xe(null,ue),ue}},7077:(Ur,vt)=>{function Ee(ve){if("number"==typeof ve&&(ve=ve.toString()),"string"!=typeof ve)throw new Error("Color should be defined as hex string");let b=ve.slice().replace("#","").split("");if(b.length<3||5===b.length||b.length>8)throw new Error("Invalid hex color: "+ve);(3===b.length||4===b.length)&&(b=Array.prototype.concat.apply([],b.map(function(ke){return[ke,ke]}))),6===b.length&&b.push("F","F");const z=parseInt(b.join(""),16);return{r:z>>24&255,g:z>>16&255,b:z>>8&255,a:255&z,hex:"#"+b.slice(0,6).join("")}}vt.getOptions=function(b){b||(b={}),b.color||(b.color={});const ke=b.width&&b.width>=21?b.width:void 0;return{width:ke,scale:ke?4:b.scale||4,margin:typeof b.margin>"u"||null===b.margin||b.margin<0?4:b.margin,color:{dark:Ee(b.color.dark||"#000000ff"),light:Ee(b.color.light||"#ffffffff")},type:b.type,rendererOpts:b.rendererOpts||{}}},vt.getScale=function(b,z){return z.width&&z.width>=b+2*z.margin?z.width/(b+2*z.margin):z.scale},vt.getImageWidth=function(b,z){const ke=vt.getScale(b,z);return Math.floor((b+2*z.margin)*ke)},vt.qrToImageData=function(b,z,ke){const xe=z.modules.size,et=z.modules.data,Je=vt.getScale(xe,ke),Xe=Math.floor((xe+2*ke.margin)*Je),ot=ke.margin*Je,Re=[ke.color.light,ke.color.dark];for(let He=0;He<Xe;He++)for(let Ie=0;Ie<Xe;Ie++){let O=4*(He*Xe+Ie),ce=ke.color.light;He>=ot&&Ie>=ot&&He<Xe-ot&&Ie<Xe-ot&&(ce=Re[et[Math.floor((He-ot)/Je)*xe+Math.floor((Ie-ot)/Je)]?1:0]),b[O++]=ce.r,b[O++]=ce.g,b[O++]=ce.b,b[O]=ce.a}}},39:function(Ur){Ur.exports=function(){"use strict";var vt=function(){var Ee=0,ve=document.createElement("div");function b(Re){return ve.appendChild(Re.dom),Re}function z(Re){for(var He=0;He<ve.children.length;He++)ve.children[He].style.display=He===Re?"block":"none";Ee=Re}ve.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",ve.addEventListener("click",function(Re){Re.preventDefault(),z(++Ee%ve.children.length)},!1);var ke=(performance||Date).now(),xe=ke,et=0,Je=b(new vt.Panel("FPS","#0ff","#002")),Xe=b(new vt.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var ot=b(new vt.Panel("MB","#f08","#201"));return z(0),{REVISION:16,dom:ve,addPanel:b,showPanel:z,begin:function(){ke=(performance||Date).now()},end:function(){et++;var Re=(performance||Date).now();if(Xe.update(Re-ke,200),xe+1e3<=Re&&(Je.update(1e3*et/(Re-xe),100),xe=Re,et=0,ot)){var He=performance.memory;ot.update(He.usedJSHeapSize/1048576,He.jsHeapSizeLimit/1048576)}return Re},update:function(){ke=this.end()},domElement:ve,setMode:z}};return vt.Panel=function(Ee,ve,b){var z=1/0,ke=0,xe=Math.round,et=xe(window.devicePixelRatio||1),Je=80*et,Xe=48*et,ot=3*et,Re=2*et,He=3*et,Ie=15*et,O=74*et,ce=30*et,ie=document.createElement("canvas");ie.width=Je,ie.height=Xe,ie.style.cssText="width:80px;height:48px";var he=ie.getContext("2d");return he.font="bold "+9*et+"px Helvetica,Arial,sans-serif",he.textBaseline="top",he.fillStyle=b,he.fillRect(0,0,Je,Xe),he.fillStyle=ve,he.fillText(Ee,ot,Re),he.fillRect(He,Ie,O,ce),he.fillStyle=b,he.globalAlpha=.9,he.fillRect(He,Ie,O,ce),{dom:ie,update:function(ue,fe){z=Math.min(z,ue),ke=Math.max(ke,ue),he.fillStyle=b,he.globalAlpha=1,he.fillRect(0,0,Je,Ie),he.fillStyle=ve,he.fillText(xe(ue)+" "+Ee+" ("+xe(z)+"-"+xe(ke)+")",ot,Re),he.drawImage(ie,He+et,Ie,O-et,ce,He,Ie,O-et,ce),he.fillRect(He+O-et,Ie,et,ce),he.fillStyle=b,he.globalAlpha=.9,he.fillRect(He+O-et,Ie,et,xe((1-ue/fe)*ce))}}},vt}()},9041:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Mw:()=>Ie,NM:()=>O,Ru:()=>fe,Vm:()=>V,YF:()=>He,b8:()=>ce,bk:()=>ue,ic:()=>w,lf:()=>ie,lg:()=>ot,md:()=>Xe,nC:()=>Re,xh:()=>Je});var ve=Ee(467),b=Ee(5680),z=Ee(6998),ke=Ee(528),xe=Ee(1969),et=Ee(6823);function Je(P,x){if(!P||P.empty())return{x:0,y:0,width:0,height:0};if((0,z.isNodeJs)()&&"bbox"!==x||P.property("_batch_mode"))return{x:0,y:0,width:parseInt(P.attr("width")),height:parseInt(P.attr("height"))};const v=L=>{let F=P.style(L);return F&&(0,z.isStr)(F)?(F=parseFloat(F.replace("px","")),Number.isFinite(F)?Math.round(F):0):0};let _=P.node().getBoundingClientRect();"bbox"===x&&parseFloat(_.width)>0&&(_=P.node().getBBox());const C={x:0,y:0,width:parseInt(_.width),height:parseInt(_.height)};return void 0!==_.left?(C.x=parseInt(_.left),C.y=parseInt(_.top)):void 0!==_.x&&(C.x=parseInt(_.x),C.y=parseInt(_.y)),(void 0===x||"nopadding"===x)&&(C.width-=v("padding-left")+v("padding-right"),C.height-=v("padding-top")+v("padding-bottom")),C}function Xe(P,x){if(!x)return x;for(;!P.empty()&&!P.classed("root_canvas");){const v=P.attr("class");v&&(v.indexOf("root_frame")>=0||v.indexOf("__root_pad_")>=0)&&(x.x+=P.property("draw_x")||0,x.y+=P.property("draw_y")||0),P=(0,b.Lt)(P.node().parentNode)}return x}function ot(P,x,v){x||(x="6.4g");const _=(x=x.trim()).length;if(_<2)return v?[P.toFixed(4),"6.4f"]:P.toFixed(4);const C=x[_-1];let L,F=(x=x.slice(0,_-1)).indexOf(".");F=F<0?4:parseInt(x.slice(F+1)),(!Number.isInteger(F)||F<=0)&&(F=4);let U=!1;if("e"===C||"E"===C)L=!0;else if("Q"===C)L=!0,U=!0;else if("f"===C||"F"===C)L=!1;else if("W"===C)L=!1,U=!0;else{if("g"===C||"G"===C){const te=ot(P,x+"Q",!0);let N=ot(P,x+"W",!0);return te[0].length<N[0].length&&(N=te),v?N:N[0]}L=!1,F=4}if(L){U&&F--,F<0&&(F=0);const te=P.toExponential(F);return v?[te,`5.${F}e`]:te}let j=P.toFixed(F);if(U){0!==P&&0===Number(j)&&F>0&&(F=20,j=P.toFixed(F));let te=0;for(;te<j.length&&("0"===j[te]||"-"===j[te]||"."===j[te]);)te++;let N=j.length-te-F;j.indexOf(".")>te&&N--,0!==N&&(F-=N,F<0?F=0:F>20&&(F=20),j=P.toFixed(F))}return v?[j,"5."+F+"f"]:j}class Re{constructor(x){this.opt=(0,z.isStr)(x)?x.toUpperCase().trim():"",this.part=""}empty(){return 0===this.opt.length||0===this.opt.replace(/[ ;_,]/g,"").length}remain(){return this.opt}check(x,v){const _=this.opt.indexOf(x);if(_<0)return!1;if(this.opt=this.opt.slice(0,_)+this.opt.slice(_+x.length),this.part="",!v)return!0;let C=_;for(;C<this.opt.length&&" "!==this.opt[C]&&","!==this.opt[C]&&";"!==this.opt[C];)C++;if(C>_&&(this.part=this.opt.slice(_,C),this.opt=this.opt.slice(0,_)+this.opt.slice(C)),"color"!==v||(this.color=this.partAsInt(1)-1,this.color>=0))return!0;for(let L=0;L<8;++L)if((0,et.oU)(L).toUpperCase()===this.part)return this.color=L,!0;return!1}partAsInt(x,v){let _=1;const C=this.part?this.part[this.part.length-1]:"";"K"===C?_=1e3:"M"===C?_=1e6:"G"===C&&(_=1e9);let L=this.part.replace(/^\D+/g,"");return L=L?parseInt(L,10):Number.NaN,Number.isInteger(L)?_*L+(x||0):v||0}partAsFloat(x,v){let _=this.part.replace(/^\D+/g,"");return _=_?parseFloat(_):Number.NaN,Number.isFinite(_)?_+(x||0):v||0}}class He{constructor(x){void 0!==x&&this.seed(x)}seed(x){(x=Math.abs(x))>1e8?x=Math.abs(1e8*Math.sin(x)):x<1&&(x*=1e8),this.m_w=Math.round(x),this.m_z=987654321}random(){if(void 0===this.m_z)return Math.random();this.m_z=36969*(65535&this.m_z)+(this.m_z>>16)&4294967295,this.m_w=18e3*(65535&this.m_w)+(this.m_w>>16)&4294967295;let x=(this.m_z<<16)+this.m_w&4294967295;return x/=4294967296,x+.5}}function Ie(P,x){x||(x={}),x.line?void 0===x.ndig&&(x.ndig=0):x.calc=!0;let v=P.length;if(v<3&&(x.line=!0),x.t=x.t??.2,void 0===x.ndig||x.height){x.maxy=P[0].gry,x.mindiff=100;for(let F=1;F<v;F++)x.maxy=Math.max(x.maxy,P[F].gry),x.mindiff=Math.min(x.mindiff,Math.abs(P[F].grx-P[F-1].grx),Math.abs(P[F].gry-P[F-1].gry));void 0===x.ndig&&(x.ndig=x.mindiff>20?0:x.mindiff>5?1:2)}const _=(F,U,j)=>{const te=Math.sqrt((U.gry-F.gry)**2+(U.grx-F.grx)**2)*x.t,N=Math.atan2(U.dgry,U.dgrx),m=Math.atan2(j*(U.gry-F.gry),j*(U.grx-F.grx));F.dgrx=te*Math.cos(2*m-N),F.dgry=te*Math.sin(2*m-N)},C=F=>{if(!x.ndig||Math.round(F)===F)return F.toFixed(0);let U=F.toFixed(x.ndig),j=U.length-1;for(;"0"===U[j];)j--;return"."===U[j]&&j--,U=U.slice(0,j+1),"-0"===U?"0":U};if(x.calc){for(let F=1;F<v-1;F++)P[F].dgrx=(P[F+1].grx-P[F-1].grx)*x.t,P[F].dgry=(P[F+1].gry-P[F-1].gry)*x.t;v>2?(_(P[0],P[1],1),_(P[v-1],P[v-2],-1)):2===P.length&&(P[0].dgrx=(P[1].grx-P[0].grx)*x.t,P[0].dgry=(P[1].gry-P[0].gry)*x.t,P[1].dgrx=-P[0].dgrx,P[1].dgry=-P[0].dgry)}let L=`${x.cmd??"M"}${C(P[0].grx)},${C(P[0].gry)}`;if(x.line)if(v<1e4){let F=0,U=0,j=Math.round(P[0].grx),te=Math.round(P[0].gry);const N=()=>{F&&(L+="h"+F,F=0),U&&(L+="v"+U,U=0)};for(let m=1;m<v;++m){const I=P[m],A=Math.round(I.grx)-j,R=Math.round(I.gry)-te;A&&R?(N(),L+=`l${A},${R}`):!A&&R?((0===U||R<0!=U<0)&&N(),U+=R):A&&!R&&((0===F||A<0!=F<0)&&N(),F+=A),j+=A,te+=R}N()}else{let F=Math.round(P[0].grx),U=Math.round(P[0].gry),j=U,te=U,N=U;for(let m=1;m<v;++m){const I=P[m],A=Math.round(I.grx),R=Math.round(I.gry),k=A-F;if(0===k){j=Math.min(j,R),te=Math.max(te,R),N=R;continue}j!==te&&(j!==U&&(L+="v"+(j-U)),L+="v"+(te-j),te!==N&&(L+="v"+(N-te)),U=N);const J=R-U;L+=J?`l${k},${J}`:`h${k}`,F=A,U=R,N=j=te=R}j!==te&&(j!==U&&(L+="v"+(j-U)),L+="v"+(te-j),te!==N&&(L+="v"+(N-te)))}else{let F=1;x.qubic&&(v--,F++,L+=`Q${C(P[1].grx-P[1].dgrx)},${C(P[1].gry-P[1].dgry)},${C(P[1].grx)},${C(P[1].gry)}`),L+=`C${C(P[F-1].grx+P[F-1].dgrx)},${C(P[F-1].gry+P[F-1].dgry)},${C(P[F].grx-P[F].dgrx)},${C(P[F].gry-P[F].dgry)},${C(P[F].grx)},${C(P[F].gry)}`;for(let U=F+1;U<v;U++)L+=`S${C(P[U].grx-P[U].dgrx)},${C(P[U].gry-P[U].dgry)},${C(P[U].grx)},${C(P[U].gry)}`;x.qubic&&(L+=`Q${C(P[v].grx-P[v].dgrx)},${C(P[v].gry-P[v].dgry)},${C(P[v].grx)},${C(P[v].gry)}`)}return x.height&&(x.close=`L${C(P[P.length-1].grx)},${C(Math.max(x.maxy,x.height))}H${C(P[0].grx)}Z`),L}function O(P){return(P=P.replace(/url\(&quot;#(\w+)&quot;\)/g,"url(#$1)").replace(/ class="\w*"/g,"").replace(/ pad="\w*"/g,"").replace(/ title=""/g,"").replace(/<g objname="\w*" objtype="\w*"/g,"<g").replace(/<g transform="translate\(\d+,\d+\)"><\/g>/g,"").replace(/<g transform="translate\(\d+,\d+\)" style="display: none;"><\/g>/g,"").replace(/<g><\/g>/g,"")).replace(/<svg x="0" y="0" overflow="hidden" width="\d+" height="\d+" viewBox="0 0 \d+ \d+"><\/svg>/g,"")}class ce{constructor(x){this.divid=null,x&&this.setDom(x)}setDom(x){void 0!==x&&(this.divid=x,delete this._selected_main)}getDom(){return this.divid}selectDom(x){if(!this.divid)return(0,b.Lt)(null);let v=this._selected_main;if(!v){if((0,z.isStr)(this.divid)){let F=this.divid;"#"!==F[0]&&(F="#"+F),v=(0,b.Lt)(F),v.empty()||(this.divid=v.node())}else v=(0,b.Lt)(this.divid);this._selected_main=v}if(!v||v.empty()||"origin"===x)return v;const _=v.property("use_enlarge"),L="simple"===(v.property("layout")||"simple")?"":v.property("layout_selector");return L&&(v=v.select(L)),!x&&!v.empty()&&_&&(v=(0,b.Lt)((0,z.getDocument)().getElementById("jsroot_enlarge_div"))),v}_accessTopPainter(x){const v=this.selectDom().node()?.firstChild;return v?(!0===x?v.painter=this:!1===x&&delete v.painter,v.painter):null}setTopPainter(){this._accessTopPainter(!0)}getTopPainter(){return this._accessTopPainter()}clearTopPainter(){this._accessTopPainter(!1)}cleanup(x){this.clearTopPainter();const v=this.selectDom("origin");!v.empty()&&!x&&v.html(""),this.divid=null,delete this._selected_main,(0,z.isFunc)(this._hpainter?.removePainter)&&this._hpainter.removePainter(this),delete this._hitemname,delete this._hdrawopt,delete this._hpainter}checkResize(){}testMainResize(x,v,_){const C=this.enlargeMain("state"),L=this.selectDom("origin"),F=this.selectDom();"on"!==C&&v?.width&&v?.height&&L.style("width",v.width+"px").style("height",v.height+"px");const j=Je(L,!0),te=L.attr("can_resize");let N=!1;"height"===te&&_&&Math.abs(j.width*_-j.height)>.1*j.width&&(N=!0),(j.height<=5||j.width<=5)&&te&&"false"!==te&&(N=!0),N&&"on"!==C&&(j.width>5?(_=_||.66,L.style("height",Math.round(j.width*_)+"px")):"height"!==te&&L.style("width","200px").style("height","100px"));const m=Je(F),I=F.property("_jsroot_height"),A=F.property("_jsroot_width");return m.changed=!1,I&&A&&I>0&&A>0?(I!==m.height||A!==m.width)&&(m.changed=x>1||m.width/A<.99||m.width/A>1.01||m.height/I<.99||m.height/I>1.01):m.changed=!0,m.changed&&F.property("_jsroot_height",m.height).property("_jsroot_width",m.width),L.property("did_enlarge")&&(m.changed=!0,L.property("did_enlarge",!1)),m}enlargeMain(x,v){const _=this.selectDom(!0),C=this.selectDom("origin"),L=(0,z.getDocument)();if(_.empty()||!z.settings.CanEnlarge||!1===C.property("can_enlarge"))return!1;if(void 0===x||"verify"===x)return!0;const F=C.property("use_enlarge")?"on":"off";if("state"===x)return F;"toggle"===x&&(x="off"===F);let U=(0,b.Lt)(L.getElementById("jsroot_enlarge_div"));if(!0===x&&"on"!==F){if(!U.empty())return!1;U=(0,b.Lt)(L.body).append("div").attr("id","jsroot_enlarge_div").attr("style","position: fixed; margin: 0px; border: 0px; padding: 0px; left: 1px; top: 1px; bottom: 1px; right: 1px; background: white; opacity: 0.95; z-index: 100; overflow: hidden;");const j=Je(_),te=Je(U);if((te.width<=j.width||te.height<=j.height)&&te.width*te.height<j.width*j.height)return v||console.log(`Enlarged area ${te.width} x ${te.height} smaller then original drawing ${j.width} x ${j.height}`),U.remove(),!1;for(;_.node().childNodes.length>0;)U.node().appendChild(_.node().firstChild);return C.property("use_enlarge",!0),C.property("did_enlarge",!0),!0}if(!1===x&&"off"!==F){for(;U.node()&&U.node().childNodes.length>0;)_.node().appendChild(U.node().firstChild);return U.remove(),C.property("use_enlarge",!1),C.property("did_enlarge",!0),!0}return!1}setItemName(x,v,_){(0,z.isStr)(x)?this._hitemname=x:delete this._hitemname,(0,z.isStr)(v)&&(this._hdrawopt=v),this._hpainter=_}getItemName(){return this._hitemname??null}getItemDrawOpt(){return this._hdrawopt??""}}function ie(){return he.apply(this,arguments)}function he(){return(he=(0,ve.A)(function*(){return Ee.e(437).then(Ee.t.bind(Ee,7437,19)).then(P=>(z.internals.nodejs_window||(z.internals.nodejs_window=new P.JSDOM("<!DOCTYPE html>hello").window,z.internals.nodejs_document=z.internals.nodejs_window.document,z.internals.nodejs_body=(0,b.Lt)(z.internals.nodejs_document).select("body")),{JSDOM:P.JSDOM,doc:z.internals.nodejs_document,body:z.internals.nodejs_body}))})).apply(this,arguments)}function ue(P,x,v){(0,z.isObject)(P)||(v=x,x=P,P=null);const _=v?`translate(${x},${v})`:x?`translate(${x})`:null;return P?P.attr("transform",_):_}function fe(P,x){x?P.style("stroke","steelblue").style("fill-opacity","0.1"):P.style("stroke","#4572A7").style("fill","#4572A7").style("opacity","0")}function Y(){return(Y=(0,ve.A)(function*(P,x){const v=(0,z.isNodeJs)();let _,C,L=!1;const F=v?Ee.e(660).then(Ee.bind(Ee,3660)).then(I=>(_=I,Promise.all([Ee.e(660),Ee.e(709)]).then(Ee.bind(Ee,8709)))).then(I=>{C=I}):(0,z.loadScript)(z.source_dir+"scripts/jspdf.umd.min.js").then(()=>(0,z.loadScript)(z.source_dir+"scripts/svg2pdf.umd.min.js")).then(()=>{_=globalThis.jspdf,C=globalThis.svg2pdf}),U=[],j=[],te=[],N=P.node.getAttribute("transform"),m={};return P.reset_tranform&&P.node.removeAttribute("transform"),F.then(()=>{if((0,b.Lt)(P.node).selectAll("g").each(function(){this.hasAttribute("font-family")&&"Courier New"===this.getAttribute("font-family")&&(this.setAttribute("font-family","courier"),P.can_modify||U.push(this))}),(0,b.Lt)(P.node).selectAll("text").each(function(){this.hasAttribute("dominant-baseline")?(this.setAttribute("dy",".2em"),this.removeAttribute("dominant-baseline"),P.can_modify||j.push(this)):P.can_modify&&v&&".4em"===this.getAttribute("dy")&&this.setAttribute("dy",".2em"),(0,xe.cp)(this)&&(L=!0,P.can_modify||te.push(this))}),v){const R=z.internals.nodejs_document;R.oldFunc=R.createElementNS,globalThis.document=R,globalThis.CSSStyleSheet=z.internals.nodejs_window.CSSStyleSheet,globalThis.CSSStyleRule=z.internals.nodejs_window.CSSStyleRule,R.createElementNS=function(k,J){const _e=R.oldFunc(k,J);return _e.getBBox=function(){let be=50,Te=10;if("text"===this.tagName){const Pe=(0,ke.dj)(this);be=(0,xe.N7)(this.textContent,Pe),Te=Pe.size}return{x:0,y:0,width:be,height:Te}},_e}}const I=new _.jsPDF({orientation:"landscape",unit:"px",format:[P.width+10,P.height+10]});(0,b.Lt)(P.node).selectAll("style").each(function(){const R=this.$fonthandler;if(!R||m[R.name]||"ttf"!==R.format)return;const k=R.name.toLowerCase().replace(/\s/g,"")+".ttf";I.addFileToVFS(k,R.base64),I.addFont(k,R.name,"normal","normal","symbol"===R.name?"StandardEncoding":"Identity-H"),m[R.name]=!0});let A=Promise.resolve(!0);return L&&!m.symbol&&((0,ke.Zq)("symbol")||(A=v?Ee.e(231).then(Ee.t.bind(Ee,1231,19)).then(R=>{const k=R.readFileSync("../../fonts/symbol.ttf").toString("base64");console.log("reading symbol.ttf",k.length),(0,ke.uT)(25,"symbol","ttf",k)}):(0,z.httpRequest)(z.source_dir+"fonts/symbol.ttf","bin").then(R=>{const k=(0,z.btoa_func)(R);(0,ke.uT)(25,"symbol","ttf",k)})),A=A.then(()=>{const R=(0,ke.Zq)("symbol"),k=new ke.qg(1242,10);k.name="symbol",k.base64=R.base64,k.addCustomFontToSvg((0,b.Lt)(P.node)),I.addFileToVFS("symbol.ttf",R.base64),I.addFont("symbol.ttf","symbol","normal","normal","StandardEncoding")})),A.then(()=>C.svg2pdf(P.node,I,{x:5,y:5,width:P.width,height:P.height})).then(()=>{P.reset_tranform&&!P.can_modify&&N&&P.node.setAttribute("transform",N),U.forEach(k=>k.setAttribute("font-family","Courier New")),j.forEach(k=>{k.setAttribute("dominant-baseline","middle"),k.removeAttribute("dy")}),te.forEach(k=>{k.innerHTML=k.$originalHTML});const R=I.output(x?"arraybuffer":"dataurlstring");return v&&(globalThis.document=void 0,globalThis.CSSStyleSheet=void 0,globalThis.CSSStyleRule=void 0,z.internals.nodejs_document.createElementNS=z.internals.nodejs_document.oldFunc,x)?Buffer.from(R):R})})})).apply(this,arguments)}function V(P,x,v){return D.apply(this,arguments)}function D(){return D=(0,ve.A)(function*(P,x,v){if("svg"===x)return P;if("pdf"===x)return function le(P,x){return Y.apply(this,arguments)}(P,v);P=(P=encodeURIComponent('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+P)).replace(/%([0-9A-F]{2})/g,(L,F)=>{const U=String.fromCharCode("0x"+F);return"%"===U?"%25":U}),P=decodeURIComponent(P);const C="data:image/svg+xml;base64,"+(0,z.btoa_func)(P);return(0,z.isNodeJs)()?Ee.e(914).then(Ee.t.bind(Ee,1914,19)).then(function(){var L=(0,ve.A)(function*(F){return F.default.loadImage(C).then(U=>{const j=F.default.createCanvas(U.width,U.height);return j.getContext("2d").drawImage(U,0,0,U.width,U.height),v?j.toBuffer("image/"+x):x?j.toDataURL("image/"+x):j})});return function(F){return L.apply(this,arguments)}}()):new Promise(L=>{const F=document.createElement("img");F.onload=function(){const U=document.createElement("canvas");U.width=F.width,U.height=F.height,U.getContext("2d").drawImage(F,0,0),v&&x?U.toBlob(j=>j.arrayBuffer().then(L),"image/"+x):L(x?U.toDataURL("image/"+x):U)},F.onerror=function(U){console.log(`IMAGE ERROR ${U}`),L(null)},F.src=C})}),D.apply(this,arguments)}function w(P){let x="";if(z.settings.TimeZone&&(0,z.isStr)(z.settings.TimeZone))try{x=P.toLocaleString("en-GB",{timeZone:z.settings.TimeZone})}catch{x=""}return x||P.toLocaleString("en-GB")}},528:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Zq:()=>Re,dj:()=>He,qg:()=>Xe,uT:()=>ot});const ve="Arial",b="Times New Roman",z="Courier New",ke="Verdana",xe="Symbol",et="Wingdings",Je=[null,{n:b,s:"italic",aw:.5314},{n:b,w:"bold",aw:.5809},{n:b,s:"italic",w:"bold",aw:.554},{n:ve,aw:.5778},{n:ve,s:"oblique",aw:.5783},{n:ve,w:"bold",aw:.6034},{n:ve,s:"oblique",w:"bold",aw:.603},{n:z,aw:.6003},{n:z,s:"oblique",aw:.6004},{n:z,w:"bold",aw:.6003},{n:z,s:"oblique",w:"bold",aw:.6005},{n:xe,aw:.5521},{n:b,aw:.5521},{n:et,aw:.5664},{n:xe,s:"italic",aw:.5314},{n:ke,aw:.5664},{n:ke,s:"italic",aw:.5495},{n:ke,w:"bold",aw:.5748},{n:ke,s:"italic",w:"bold",aw:.5578}];class Xe{constructor(O,ce,ie){ie&&ce<1&&(ce*=ie,this.scaled=!0),this.size=Math.round(ce||11),this.scale=ie,this.func=this.setFont.bind(this);const he=O&&Number.isInteger(O)?Math.floor(O/10):0,ue=Je[he];ue?this.setNameStyleWeight(ue.n,ue.s,ue.w,ue.aw,ue.format,ue.base64):this.setNameStyleWeight(ve)}setNameStyleWeight(O,ce,ie,he,ue,fe){this.name=O,this.style=ce||null,this.weight=ie||null,this.aver_width=he||(ie?.58:.55),this.format=ue,this.base64=fe,this.name===xe||this.name===et?(this.isSymbol=this.name,this.name=b):this.isSymbol=""}setPainter(O){this.painter=O}addCustomFontToSvg(O){if(!this.base64||!this.name)return;const ce="custom_font_"+this.name;let he=O.selectChild(".canvas_defs");he.empty()&&(he=O.insert("svg:defs",":first-child").attr("class","canvas_defs")),he.selectChild("."+ce).empty()&&(console.log("Adding style entry for class",ce),he.append("style").attr("class",ce).property("$fonthandler",this).text(`@font-face { font-family: "${this.name}"; font-weight: normal; font-style: normal; src: url(data:application/font-ttf;charset=utf-8;base64,${this.base64}); }`))}setFont(O){this.base64&&this.painter&&this.addCustomFontToSvg(this.painter.getCanvSvg()),O.attr("font-family",this.name).attr("font-size",this.size).attr("xml:space","preserve").attr("font-weight",this.weight||null).attr("font-style",this.style||null)}setSize(O){this.size=Math.round(O)}setColor(O){this.color=O}setAlign(O){this.align=O}setAngle(O){this.angle=O}roundAngle(O,ce){this.angle=parseInt(this.angle||0),Number.isInteger(this.angle)||(this.angle=0),this.angle=Math.round(this.angle/O)*O+(ce||0),this.angle<0?this.angle+=360:this.angle>=360&&(this.angle-=360)}clearFont(O){O.attr("font-family",null).attr("font-size",null).attr("xml:space",null).attr("font-weight",null).attr("font-style",null)}isMonospace(){const O=this.name.toLowerCase();return 0===O.indexOf("courier")||"monospace"===O||"monaco"===O}getFontHtml(){let O=Math.round(this.size)+"pt "+this.name;return this.weight&&(O+=" "+this.weight),this.style&&(O+=" "+this.style),O}getFontName(){return this.isSymbol||this.name||"none"}}function ot(Ie,O,ce,ie){Number.isInteger(Ie)?Je[Ie]={n:O,format:ce,base64:ie}:console.error(`Wrong index ${Ie} for custom font`)}function Re(Ie){return Je.find(O=>O?.n===Ie&&O?.base64)}function He(Ie){const O=Ie.getAttribute("font-size"),ce=Ie.getAttribute("font-family"),ie=O.indexOf("px"),he=ie>0?Number.parseInt(O.slice(0,ie)):12;let ue=Ie.getAttribute("font-style"),fe=Ie.getAttribute("font-weight"),le=null,Y="";"normal"===fe?fe="":"bold"===fe&&(Y+="b"),"normal"===ue?ue="":"italic"===ue?Y+="i":"oblique"===ue&&(Y+="o"),"arial"===ce?Y+="Arial":"times"===ce?Y+="Times New Roman":"verdana"===ce&&(Y+="Verdana");for(let D=1;D<Je.length;++D)if(Y===Je[D]){le=10*D+2;break}const V=new Xe(le,he);return le||V.setNameStyleWeight(ce,ue,fe),V}},6224:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{rb:()=>D,JW:()=>Ie,tP:()=>V,as:()=>O,OZ:()=>le,m6:()=>ce,Nn:()=>ie,Z_:()=>x,ei:()=>w,UV:()=>P,Yu:()=>v,XR:()=>Y,QD:()=>fe});var ve=Ee(467),b=Ee(5680),z=Ee(6998),ke=Ee(1969),xe=Ee(9041),et=Ee(5284),Je=Ee(6823);class Xe{constructor(C){this.color="none",this.colorindx=0,this.pattern=0,this.used=!0,this.kind=C.kind||2,this.changed=!1,this.func=this.apply.bind(this),this.setArgs(C),this.changed=!1}setArgs(C){(0,z.isObject)(C.attr)&&(void 0===C.pattern&&void 0!==C.attr.fFillStyle&&(C.pattern=C.attr.fFillStyle),void 0===C.color&&void 0!==C.attr.fFillColor&&(C.color=C.attr.fFillColor));const L=this.changed;this.change(C.color,C.pattern,C.svg,C.color_as_svg,C.painter),this.changed=L}apply(C){this.used=!0,C.style("fill",this.getFillColor()),"opacity"in this&&C.style("opacity",this.opacity),"antialias"in this&&C.style("antialias",this.antialias)}getFillColor(){return this.pattern_url||this.color}getFillColorAlt(C){return this.color&&"none"!==this.color?this.color:C}empty(){const C=this.getFillColor();return!C||"none"===C}setUsed(C){this.used=C}hasColor(){return this.color&&"none"!==this.color}setSolidColor(C){delete this.pattern_url,this.color=C,this.pattern=1001}setOpacity(C){this.opacity=C}isSolid(C){return!(1001!==this.pattern||this.gradient||C&&C!==this.color)}verifyDirectChange(C){(0,z.isStr)(this.pattern)&&(this.pattern=parseInt(this.pattern)),Number.isInteger(this.pattern)||(this.pattern=0),this.change(this.color,this.pattern,C?C.getCanvSvg():null,!0,C)}change(C,L,F,U,j){if(delete this.pattern_url,delete this.gradient,this.changed=!0,void 0!==C&&Number.isInteger(parseInt(C))&&!U&&(this.colorindx=parseInt(C)),void 0!==L&&Number.isInteger(parseInt(L))&&(this.pattern=parseInt(L),delete this.opacity,delete this.antialias),1e3===this.pattern&&0===this.colorindx)return this.pattern_url="white",!0;if(1e3===this.pattern&&(this.pattern=1001),this.pattern<1001)return this.pattern_url="none",!0;if(this.isSolid()&&0===this.colorindx&&1===this.kind&&!U)return this.pattern_url="none",!0;let te=this.colorindx;if(U?(this.color=C,"none"!==C&&(te=(0,b.yW)(C).hex().slice(1))):this.color=j?j.getColor(te):(0,Je.oU)(te),(0,z.isStr)(this.color)||((0,z.isObject)(this.color)&&(this.color?._typename===Je.pX||this.color?._typename===Je.ho)&&(this.gradient=this.color),this.color="none"),this.isSolid())return!0;if(!this.gradient){if(this.pattern>=4e3&&this.pattern<=4100)return this.opacity=(this.pattern-4e3)/100,!0;if(this.pattern<3e3||"none"===this.color)return!1}if(!F||F.empty())return!1;let N="",m="",I=null,A="",R="",k=2,J=2;if(this.gradient)N=`grad_${this.gradient.fNumber}`;else{switch(N=`pat_${this.pattern}_${te}`,this.pattern){case 3001:k=J=2,A="M0,0h1v1h-1zM1,1h1v1h-1z";break;case 3002:k=4,J=2,A="M1,0h1v1h-1zM3,1h1v1h-1z";break;case 3003:k=J=4,A="M2,1h1v1h-1zM0,3h1v1h-1z";break;case 3004:k=J=8,m="M8,0L0,8";break;case 3005:k=J=8,m="M0,0L8,8";break;case 3006:k=J=4,m="M1,0v4";break;case 3007:k=J=4,m="M0,1h4";break;case 3008:k=J=10,A="M0,3v-3h3ZM7,0h3v3ZM0,7v3h3ZM7,10h3v-3ZM5,2l3,3l-3,3l-3,-3Z",m="M0,3l5,5M3,10l5,-5M10,7l-5,-5M7,0l-5,5";break;case 3009:k=12,J=12,m="M0,0A6,6,0,0,0,12,0M6,6A6,6,0,0,0,12,12M6,6A6,6,0,0,1,0,12",I="none";break;case 3010:k=J=10,m="M0,2h10M0,7h10M2,0v2M7,2v5M2,7v3";break;case 3011:k=9,J=18,m="M5,0v8M2,1l6,6M8,1l-6,6M9,9v8M6,10l3,3l-3,3M0,9v8M3,10l-3,3l3,3",I="none";break;case 3012:k=10,J=20,m="M5,1A4,4,0,0,0,5,9A4,4,0,0,0,5,1M0,11A4,4,0,0,1,0,19M10,11A4,4,0,0,0,10,19",I="none";break;case 3013:k=J=7,m="M0,0L7,7M7,0L0,7",I="none";break;case 3014:k=J=16,m="M0,0h16v16h-16v-16M0,12h16M12,0v16M4,0v8M4,4h8M0,8h8M8,4v8",I="none";break;case 3015:k=6,J=12,m="M2,1A2,2,0,0,0,2,5A2,2,0,0,0,2,1M0,7A2,2,0,0,1,0,11M6,7A2,2,0,0,0,6,11",I="none";break;case 3016:k=12,J=7,m="M0,1A3,2,0,0,1,3,3A3,2,0,0,0,9,3A3,2,0,0,1,12,1",I="none";break;case 3017:k=J=4,m="M3,1l-2,2";break;case 3018:k=J=4,m="M1,1l2,2";break;case 3019:k=J=12,m="M1,6A5,5,0,0,0,11,6A5,5,0,0,0,1,6h-1h1A5,5,0,0,1,6,11v1v-1A5,5,0,0,1,11,6h1h-1A5,5,0,0,1,6,1v-1v1A5,5,0,0,1,1,6",I="none";break;case 3020:k=7,J=12,m="M1,0A2,3,0,0,0,3,3A2,3,0,0,1,3,9A2,3,0,0,0,1,12",I="none";break;case 3021:k=J=8,m="M8,2h-2v4h-4v2M2,0v2h-2",I="none";break;case 3022:k=J=8,m="M0,2h2v4h4v2M6,0v2h2",I="none";break;case 3023:k=J=8,A="M4,0h4v4zM8,4v4h-4z",R="M4,0L0,4L4,8L8,4Z";break;case 3024:k=J=16,A="M0,8v8h2v-8zM8,0v8h2v-8M4,14v2h12v-2z",R="M0,2h8v6h4v-6h4v12h-12v-6h-4z";break;case 3025:k=J=18,A="M5,13v-8h8ZM18,0v18h-18l5,-5h8v-8Z";break;default:{if(this.pattern>3025&&this.pattern<3100){k=4,J=2,A="M1,0h1v1h-1zM3,1h1v1h-1z";break}const be=this.pattern%1e3,Te=be%10,Pe=(be-Te)%100/10,We=(be-10*Pe-Te)/100;if(!We)break;const dt=Pe===Te||0===Pe||5===Pe||9===Pe||0===Te||5===Te||9===Te,Q=j?.getPadPainter(),Ke=Q?Math.max(Q.getPadWidth(),Q.getPadHeight()):600,Ze=Math.max(.1,z.gStyle.fHatchesSpacing*Ke*.001),Ue=6*Math.max(1,Math.round(Ze)),Oe=We*Ue;N+=dt?`_hn${Math.round(100*Ze)}`:`_ho${Ue}`,k=J=6*Oe;const ht=dt?(Kt,Ot,It,An)=>{if(0===It||90===It){const ti=Math.round(J/(We*Ze*3)),hi=J/ti;let ai=hi/2;for(;ai<J;)m+=0===It?`M0,${Math.round(ai)}h${k}`:`M${Math.round(ai)},0v${J}`,ai+=hi;return}const on=It/180*Math.PI,pn=We*Ze*3/Math.cos(on),Qt=Math.tan(on)*k,dn=Qt/Math.round(Qt/pn),yn=Math.floor(J/dn);J=Math.round(yn*dn);let Tn=yn*dn;for(;Math.abs(Tn-J)<.1;)Tn-=dn;for(;Tn+Qt>0;){let Hn=0,ti=Tn,hi=k,ai=Tn+Qt;ti<-1e-5?(Hn=-ti/Qt*k,ti=0):ai>J&&(hi=(J-ti)/Qt*k,ai=J),An&&(Hn=k-Hn,hi=k-hi),m+=`M${Math.round(Hn)},${Math.round(ti)}L${Math.round(hi)},${Math.round(ai)}`,Tn-=dn}}:(Kt,Ot)=>{const It=[];let Qt,Bn,dn,An=Oe,on=0,pn=J;for(Math.abs(Kt)<3&&(An=Math.round(Oe/12*9)),0===Kt?(An=Math.round(Oe/12*8),on=An/2):Kt>0?pn-=An:on=An;on<=pn;)Qt=on+Kt*An,Qt<0?(dn=Math.round(on/(on-Qt)*k),It.push(0,on,dn,0),It.push(k,J-on,k-dn,J)):Qt>J?(dn=Math.round((J-on)/(Qt-on)*k),It.push(0,on,dn,J),It.push(k,J-on,k-dn,0)):It.push(0,on,k,Qt),on+=An;for(let yn=0;yn<It.length;yn+=4)Ot?(Bn=It[yn+1],on=It[yn],dn=It[yn+3],Qt=It[yn+2]):(Bn=It[yn],on=It[yn+1],dn=It[yn+2],Qt=It[yn+3]),m+=`M${Bn},${on}`,m+=Qt===on?"h"+(dn-Bn):dn===Bn?"v"+(Qt-on):`L${dn},${Qt}`};let st=!1,yt=!1;switch(Pe){case 0:st=!0;break;case 1:ht(1,!1,10);break;case 2:ht(2,!1,20);break;case 3:ht(3,!1,30);break;case 4:ht(6,!1,45);break;case 6:ht(3,!0,60);break;case 7:ht(2,!0,70);break;case 8:ht(1,!0,80);break;case 9:yt=!0}switch(Te){case 0:st=!0;break;case 1:ht(-1,!1,10,!0);break;case 2:ht(-2,!1,20,!0);break;case 3:ht(-3,!1,30,!0);break;case 4:ht(-6,!1,45,!0);break;case 6:ht(-3,!0,60,!0);break;case 7:ht(-2,!0,70,!0);break;case 8:ht(-1,!0,80,!0);break;case 9:yt=!0}st&&ht(0,!1,0),yt&&ht(0,!0,90);break}}if(!A&&!m)return!1}this.pattern_url=`url(#${N})`,this.antialias=!1;let _e=F.selectChild(".canvas_defs");if(_e.empty()&&(_e=F.insert("svg:defs",":first-child").attr("class","canvas_defs")),_e.selectChild("."+N).empty())if(this.gradient){const be=this.gradient._typename===Je.pX,Te=_e.append(be?"svg:linearGradient":"svg:radialGradient").attr("id",N).attr("class",N),Pe=We=>We===Math.round(We)?We.toFixed(0):We.toFixed(2);be?Te.attr("x1",Pe(this.gradient.fStart.fX)).attr("y1",Pe(1-this.gradient.fStart.fY)).attr("x2",Pe(this.gradient.fEnd.fX)).attr("y2",Pe(1-this.gradient.fEnd.fY)):Te.attr("cx",Pe(this.gradient.fStart.fX)).attr("cy",Pe(1-this.gradient.fStart.fY)).attr("cr",Pe(this.gradient.fR1));for(let We=0;We<this.gradient.fColorPositions.length;++We){const dt=this.gradient.fColorPositions[We],Q="#"+(0,Je.nj)(this.gradient.fColors[4*We])+(0,Je.nj)(this.gradient.fColors[4*We+1])+(0,Je.nj)(this.gradient.fColors[4*We+2]);Te.append("svg:stop").attr("offset",`${Math.round(100*dt)}%`).attr("stop-color",Q).attr("stop-opacity",`${Math.round(100*this.gradient.fColors[4*We+3])}%`)}}else{const be=_e.append("svg:pattern").attr("id",N).attr("class",N).attr("patternUnits","userSpaceOnUse").attr("width",k).attr("height",J);if(R){const Te=(0,b.Qh)(this.color);Te.r=Math.round((Te.r+255)/2),Te.g=Math.round((Te.g+255)/2),Te.b=Math.round((Te.b+255)/2),be.append("svg:path").attr("d",R).style("fill",Te)}A&&be.append("svg:path").attr("d",A).style("fill",this.color),m&&be.append("svg:path").attr("d",m).style("stroke",this.color).style("stroke-width",z.gStyle.fHatchesLineWidth||1).style("fill",I)}return!0}createSample(C,L,F,U){U&&(C=(0,b.Lt)(C));const j=new Xe({svg:C,pattern:this.pattern,color:this.color,color_as_svg:!0});C.append("path").attr("d",`M0,0h${L}v${F}h${-L}z`).call(j.func)}saveToStyle(C,L){if(C){const F=this.colorindx??(0,Je.vB)(this.color);F>=0&&(z.gStyle[C]=F)}L&&(z.gStyle[L]=this.pattern)}}var ot=Ee(8732);class Re{constructor(C){this.used=!0,C._typename&&void 0!==C.fTextFont&&(C={attr:C}),this.setArgs(C)}setArgs(C){C.attr?(C.font=C.attr.fTextFont||C.attr_alt?.fTextFont||0,C.size=C.attr.fTextSize||C.attr_alt?.fTextSize||0,this.color_index=C.attr.fTextColor||C.attr_alt?.fTextColor||0,C.color=C.painter?.getColor(this.color_index)??(0,Je.oU)(this.color_index),C.align=C.attr.fTextAlign||C.attr_alt?.fTextAlign||0,C.angle=C.attr.fTextAngle||C.attr_alt?.fTextAngle||0):"number"==typeof C.color&&(this.color_index=C.color,C.color=C.painter?.getColor(C.color)??(0,Je.oU)(C.color)),this.font=C.font,this.size=C.size,this.color=C.color,this.align=C.align,this.angle=C.angle,this.can_rotate=C.can_rotate??!0,this.angle_used=!1,this.align_used=!1}empty(){return"none"===this.color}change(C,L,F,U,j){void 0!==C&&(this.font=C),void 0!==L&&(this.size=L),void 0!==F&&(this.color!==F&&delete this.color_index,this.color=F),void 0!==U&&(this.align=U),void 0!==j&&(this.angle=j),this.changed=!0}verifyDirectChange(){this.change(parseInt(this.font),parseFloat(this.size),this.color,parseInt(this.align),parseInt(this.angle))}createArg(C){return C||(C={}),this.align_used=!C.noalign&&!C.align,this.align_used&&(C.align=this.align),this.angle_used=!C.norotate&&this.can_rotate,this.angle_used&&this.angle&&(C.rotate=-this.angle),C.color=this.color||"black",C}getSize(C,L,F,U){return this.size>=1?Math.round(this.size):(C||(C=1e3),L||(L=C),F||(F=1),Math.round((this.size||U||0)*Math.min(C,L)*F))}getAltSize(C,L){return C||(C=this.size),Math.round(C>=1?C:C*L)}getGedFont(){return Math.floor(this.font/10)}setGedFont(C){const L=parseInt(C);return L>0&&L<17&&this.change(10*L+this.font%10),this.font}}var He=Ee(528);class Ie extends xe.b8{constructor(C,L,F){super(C),this.pad_name=C?this.selectCurrentPad():"",this.assignObject(L),(0,z.isStr)(F)&&(this.options={original:F})}assignObject(C){(0,z.isObject)(C)?this.draw_object=C:delete this.draw_object}setPadName(C){this.pad_name=(0,z.isStr)(C)?C:this.selectCurrentPad()}getPadName(){return this.pad_name||""}isBatchMode(){return!!(0,z.isBatchMode)()||(this.getCanvPainter()?.isBatchMode()??!1)}assignSnapId(C){this.snapid=C}cleanup(){this.removeG();let C=!0;if(this.isMainPainter()){const L=this.getPadPainter();(!L||!1===L.normal_canvas)&&(C=!1)}delete this.pad_name,delete this._main_painter,this.draw_object=null,delete this.snapid,delete this.fillatt,delete this.lineatt,delete this.markeratt,delete this.bins,delete this.root_colors,delete this.options,delete this.options_store,delete this.rstyle,delete this.csstype,super.cleanup(C)}getObject(){return this.draw_object}getObjectName(){return this.getObject()?.fName??""}getClassName(){return this.getObject()?._typename??""}matchObjectType(C){const L=this.getClassName();return!(!C||!L)&&((0,z.isStr)(C)?C===L:(0,z.isStr)(C._typename)?C._typename===L:L.match(C))}setItemName(C,L,F){if(super.setItemName(C,L,F),this.no_default_title||!C)return;const U=this.getCanvSvg();U.empty()?this.selectDom().attr("title",C):U.select("title").text(C);const j=this.getCanvPainter();j&&(j===this||this.isMainPainter()&&j===this.getPadPainter())&&j.drawItemNameOnCanvas(C)}storeDrawOpt(C){if(!this.options)return;C||(C="");const L=C.indexOf(";;");L>=0&&(C=C.slice(0,L)),this.options.original=C,this.options_store=Object.assign({},this.options)}getDrawOpt(C){if(!this.options)return"";if((0,z.isFunc)(this.options.asString)){let L=!1;const F=this.getPadPainter();if(!this.options_store||F?._interactively_changed)L=!0;else for(const U in this.options_store)this.options[U]!==this.options_store[U]&&"_"!==U[0]&&"$"!==U[0]&&U[0].toLowerCase()!==U[0]&&(L=!0);if(L&&(0,z.isFunc)(this.options.asString))return this.options.asString(this.isMainPainter(),C?null:F?.getRootPad())}return this.options.original||""}getSupportedDrawOptions(){const C=this.getPadPainter(),L=this.getClassName();return L&&(0,z.isFunc)(C?.getObjectDrawSettings)?C.getObjectDrawSettings(z.prROOT+L,"nosame")?.opts:[]}redrawObject(C,L){if(!this.updateObject(C,L))return!1;const F=(0,z.getDocument)(),U=F.body.style.cursor;document.body.style.cursor="wait";const j=this.redrawPad();return F.body.style.cursor=U,j}updateObject(C){return!!this.matchObjectType(C)&&(Object.assign(this.getObject(),C),!0)}getObjectHint(){const C=this.getItemName();return C?C.length>20?"..."+C.slice(C.length-17):C:this.getObjectName()||this.getClassName()||""}getColor(C){return this.root_colors||(this.root_colors=this.getCanvPainter()?.root_colors||(0,Je.HG)()),this.root_colors[C]}addColor(C){this.root_colors||(this.root_colors=this.getCanvPainter()?.root_colors||(0,Je.HG)());const L=this.root_colors.indexOf(C);return L>=0?L:(this.root_colors.push(C),this.root_colors.length-1)}isTooltipAllowed(){return(this.getCanvPainter()||this).tooltip_allowed}setTooltipAllowed(C){void 0===C&&(C=!0);const L=this.getCanvPainter()||this;L.tooltip_allowed="toggle"===C?!L.tooltip_allowed:C}checkResize(C){return this.getCanvPainter()?.checkCanvasResize(C)}removeG(){this.draw_g?.remove(),delete this.draw_g}getG(){return this.draw_g}createG(C){let L;if(C){const j=this.getFrameSvg();if(j.empty())return console.error("Not found frame to create g element inside"),j;(0,z.isStr)(C)||(C="main_layer"),L=j.selectChild("."+C)}else L=this.getLayerSvg("primitives_layer");this.draw_g&&this.draw_g.node().parentNode!==L.node()&&(console.log("g element changes its layer!!"),this.removeG()),this.draw_g?this.draw_g.selectAll("*").remove():(this.draw_g=L.append("svg:g"),C||L.selectChildren(".most_upper_primitives").raise());const F=this.getClassName(),U=this.getObjectName();return(U||F)&&this.draw_g.attr("objname",(U||"name").replace(/[^\w]/g,"_")).attr("objtype",(F||"type").replace(/[^\w]/g,"_")),this.draw_g.property("in_frame",!!C),this.draw_g}bringToFront(C){if(!this.draw_g||(this.draw_g.node().parentNode?.appendChild(this.draw_g.node()),!C||!this.snapid))return;const F=this.getPadPainter();F?.snapid&&this.getCanvPainter()?.sendWebsocket("POPOBJ:"+JSON.stringify([F.snapid.toString(),this.snapid.toString()]))}getCanvSvg(){return this.selectDom().select(".root_canvas")}getPadSvg(C){void 0===C&&(C=this.pad_name);let L=this.getCanvSvg();if(!C||L.empty())return L;const F=L.property("pad_painter");return F?.pads_cache&&F.pads_cache[C]?(0,b.Lt)(F.pads_cache[C]):(L=L.select(".primitives_layer .__root_pad_"+C),F&&(F.pads_cache||(F.pads_cache={}),F.pads_cache[C]=L.node()),L)}getUniqueId(C=!1){return!C&&void 0===this._unique_painter_id&&(this._unique_painter_id=z.internals.id_counter++),this._unique_painter_id}setSecondaryId(C,L){this._main_painter_id=C.getUniqueId(),this._secondary_id=L}isSecondary(C){return void 0!==this._main_painter_id&&(!(0,z.isObject)(C)||this._main_painter_id===C.getUniqueId(!0))}getSnapId(C){return this.snapid?this.snapid.toString()+(C?"#"+C:""):""}getLayerSvg(C,L){let F=this.getPadSvg(L);return F.empty()?F:(0===C.indexOf("prim#")&&(F=F.selectChild(".primitives_layer"),C=C.slice(5)),F.selectChild("."+C))}selectCurrentPad(C){const L=this.getCanvSvg();if(L.empty())return"";const F=L.property("current_pad");return void 0!==C&&L.property("current_pad",C),F}getPadPainter(C){const L=this.getPadSvg((0,z.isStr)(C)?C:void 0);return L.empty()?null:L.property("pad_painter")}getCanvPainter(){const C=this.getCanvSvg();return C.empty()?null:C.property("pad_painter")}getAxisToSvgFunc(C,L,F){const U={isndc:C,nornd:L},j=this.draw_g?.property("in_frame");if((j||F&&!C)&&(U.main=this.getFramePainter()),U.main?.grx&&U.main?.gry)U.x0=F&&!C?U.main.getFrameX():0,U.y0=F&&!C?U.main.getFrameY():0,L?(U.x=function(te){return this.x0+this.main.grx(te)},U.y=function(te){return this.y0+this.main.gry(te)}):(U.x=function(te){return this.x0+Math.round(this.main.grx(te))},U.y=function(te){return this.y0+Math.round(this.main.gry(te))});else if(j)console.error(`Problem to create functor for ${this.getClassName()}`),U.x=()=>0,U.y=()=>0;else{const te=this.getPadPainter();C||(U.pad=te?.getRootPad(!0)),U.padw=te?.getPadWidth()??10,U.x=function(N){return this.pad&&(this.pad.fLogx&&(N=N>0?Math.log10(N):this.pad.fUxmin),N=(N-this.pad.fX1)/(this.pad.fX2-this.pad.fX1)),N*=this.padw,this.nornd?N:Math.round(N)},U.padh=te?.getPadHeight()??10,U.y=function(N){return this.pad&&(this.pad.fLogy&&(N=N>0?Math.log10(N):this.pad.fUymin),N=(N-this.pad.fY1)/(this.pad.fY2-this.pad.fY1)),N=(1-N)*this.padh,this.nornd?N:Math.round(N)}}return U}axisToSvg(C,L,F,U){return this.getAxisToSvgFunc(F,U)[C](L)}svgToAxis(C,L,F){if(this.draw_g?.property("in_frame"))return this.getFramePainter()?.revertAxis(C,L)??0;const j=this.getPadPainter(),te=F||!j?null:j.getRootPad(!0);let N=j?"y"===C?1-L/j.getPadHeight():L/j.getPadWidth():0;return te&&("y"===C?(N=te.fY1+N*(te.fY2-te.fY1),te.fLogy&&(N=Math.pow(10,N))):(N=te.fX1+N*(te.fX2-te.fX1),te.fLogx&&(N=Math.pow(10,N)))),N}getFrameSvg(C){const L=this.getLayerSvg("primitives_layer",C);if(L.empty())return L;let F=L.node().firstChild;for(;F;){const U=(0,b.Lt)(F);if(U.classed("root_frame"))return U;F=F.nextSibling}return(0,b.Lt)(null)}getFramePainter(){return this.getPadPainter()?.getFramePainter()}getMainPainter(C){let L=this._main_painter;if(!L){const F=this.getPadPainter();L=F?F.getMainPainter():this.getTopPainter(),L||(L=null),C||(this._main_painter=L)}return L}isMainPainter(){return this===this.getMainPainter()}setAsMainPainter(C){const L=this.getPadPainter();L?L.setMainPainter(this,C):this.setTopPainter()}addToPadPrimitives(C){void 0!==C&&this.setPadName(C);const L=this.getPadPainter(C);return!(!L||L===this||(L.painters.indexOf(this)<0&&L.painters.push(this),!this.rstyle&&L.next_rstyle&&(this.rstyle=L.next_rstyle),0))}removeFromPadPrimitives(){const C=this.getPadPainter();if(!C||C===this)return!1;const L=C.painters.indexOf(this);return L>=0&&C.painters.splice(L,1),!0}createAttMarker(C){(0,z.isObject)(C)?void 0!==C.fMarkerColor&&void 0!==C.fMarkerStyle&&void 0!==C.fMarkerSize&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0),void 0===C.painter&&(C.painter=this);let L=C.std?this.markeratt:null;return L?(!L.changed||C.force)&&L.setArgs(C):L=new et.e(C),C.std&&(this.markeratt=L),L}createAttLine(C){(0,z.isObject)(C)?void 0!==C.fLineColor&&void 0!==C.fLineStyle&&void 0!==C.fLineWidth&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0),void 0===C.painter&&(C.painter=this);let L=C.std?this.lineatt:null;return L?(!L.changed||C.force)&&L.setArgs(C):L=new ot.gx(C),C.std&&(this.lineatt=L),L}createAttText(C){(0,z.isObject)(C)?void 0!==C.fTextFont&&void 0!==C.fTextSize&&void 0!==C.fTextColor&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0),void 0===C.painter&&(C.painter=this);let L=C.std?this.textatt:null;return L?(!L.changed||C.force)&&L.setArgs(C):L=new Re(C),C.std&&(this.textatt=L),L}createAttFill(C){(0,z.isObject)(C)?C._typename&&void 0!==C.fFillColor&&void 0!==C.fFillStyle&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0);let L=C.std?this.fillatt:null;return C.svg||(C.svg=this.getCanvSvg()),void 0===C.painter&&(C.painter=this),L?(!L.changed||C.force)&&L.setArgs(C):L=new Xe(C),C.std&&(this.fillatt=L),L}forEachPainter(C,L){const F=this.getPadPainter();if(F)F.forEachPainterInPad(C,L);else{const U=this.getTopPainter();U&&"pads"!==L&&C(U)}}interactiveRedraw(C,L,F){var U=this;return(0,ve.A)(function*(){let j,te;return(0,z.isStr)(L)&&0!==L.indexOf("exec:")&&(j=L),"pad"===C?te=U.redrawPad(j):!1!==C&&(te=U.redraw(j)),(0,z.getPromise)(te).then(()=>{const N=U.getCanvPainter();return(0,z.isFunc)(N?.producePadEvent)&&N.producePadEvent("redraw",U.getPadPainter(),U,null,F),(0,z.isFunc)(N?.processChanges)&&N.processChanges(L,U,F),U})})()}redrawPad(C){var L=this;return(0,ve.A)(function*(){return L.getPadPainter()?.redrawPad(C)??!1})()}executeMenuCommand(C){return"Inspect"===C.fName&&this.showInspector()}submitCanvExec(C,L){if(!C||!(0,z.isStr)(C))return;const F=this.getCanvPainter();(0,z.isFunc)(F?.submitExec)&&F.submitExec(this,C,L)}deleteAttr(){delete this.lineatt,delete this.fillatt,delete this.markeratt}showInspector(){return!1}fillContextMenu(C){const L=this.getObjectName();let F=this.getClassName();const U=F.lastIndexOf("::");U>0&&(F=F.slice(U+2)),C.add(`header:${F&&L?`${F}:${L}`:F||L||"object"}`);const te=C.size();return(0,z.isFunc)(this.fillContextMenuItems)&&this.fillContextMenuItems(C),C.size()>te&&this.showInspector("check")&&C.add("Inspect",this.showInspector),C.addAttributesMenu(this),C.size()>te}showObjectStatus(C,L,F,U){let j=this.getCanvPainter();if(j&&!(0,z.isFunc)(j.showCanvasStatus)&&(j=null),!j&&!(0,z.isFunc)(z.internals.showStatus)||"on"===this.enlargeMain("state"))return!1;if(void 0===C&&void 0===L){const te=this.getObject();if(!te)return;C=this.getItemName()||te.fName,L=te.fTitle||te._typename,F=te._typename}j?j.showCanvasStatus(C,L,F,U):z.internals.showStatus(C,L,F,U)}redraw(){}startTextDrawing(C,L,F,U){if(F||(F=this.draw_g),!F||F.empty())return;const j="font"===L?C:new He.qg(C,L);j.setPainter(this),F.call(j.func),F.property("draw_text_completed",!1).property("all_args",[]).property("text_font",j).property("text_factor",0).property("max_text_width",0).property("max_font_size",U).property("_fast_drawing",this.getPadPainter()?._fast_drawing??!1),F.property("_fast_drawing")&&F.property("_font_too_small",U&&U<5||j.size<4)}scaleTextDrawing(C,L){L||(L=this.draw_g),L&&!L.empty()&&C&&C>L.property("text_factor")&&L.property("text_factor",C)}_checkAllTextDrawing(C,L,F){let U=C.property("all_args"),j=0;if(U||(console.log("Text drawing is finished - why calling _checkAllTextDrawing?????"),U=[]),U.forEach(J=>{J.ready||j++}),j>0)return void((0,z.isFunc)(L)&&(C.node().textResolveFunc=L,C.node().try_optimize=F));C.property("all_args",null);const te=C.property("text_factor"),N=C.property("text_font"),m=C.property("max_font_size");let I=N.size,A=!1,R=!0;te>0&&(te<.9||te>1)&&(N.size=Math.max(1,Math.floor(N.size/te))),m&&N.size>m&&(N.size=m),N.size!==I&&(C.call(N.func),I=N.size),U.forEach(J=>{if(J.mj_node&&J.applyAttributesToMathJax){const _e=J.mj_node.select("svg");J.applyAttributesToMathJax(this,J.mj_node,_e,J,I,te),delete J.mj_node,R=!1}else J.txt_g&&(R=!1)}),L||(L=C.node().textResolveFunc,F=C.node().try_optimize,delete C.node().textResolveFunc,delete C.node().try_optimize);const k=F&&R?[]:null;U.forEach(J=>{let _e,be,Te=1;if(J.txt_node)_e=J.txt_node,delete J.txt_node,be=!0,null!==k&&k.push(_e);else{if(!J.txt_g)return;_e=J.txt_g,delete J.txt_g,be=!1}_e.attr("visibility",null),A=!0,J.width&&("middle"===J.align[0]?J.x+=J.width/2:"end"===J.align[0]&&(J.x+=J.width)),J.height&&(0===J.align[1].indexOf("bottom")?J.y+=J.height:"middle"===J.align[1]&&(J.y+=J.height/2));let Pe=0,We=0;if(be)(0,z.isNodeJs)()?J.scale&&te>0&&(J.box.width*=1/te,J.box.height*=1/te):!J.plain&&!J.fast&&(J.box=(0,xe.xh)(_e,"bbox")),J.plain?(_e.attr("text-anchor",J.align[0]),"top"===J.align[1]?_e.attr("dy",".8em"):"middle"===J.align[1]&&((0,z.isNodeJs)()?_e.attr("dy",".4em"):_e.attr("dominant-baseline","middle"))):(_e.attr("text-anchor","start"),Pe=("middle"===J.align[0]?-.5:"end"===J.align[0]?-1:0)*J.box.width,We=("top"===J.align[1]?J.top_shift||1:"middle"===J.align[1]?J.mid_shift||.5:0)*J.box.height);else if(J.text_rect){const Ze=J.text_rect;Te=te>0&&Math.abs(1-te)>.01?1/te:1,Pe=("middle"===J.align[0]?-.5:"end"===J.align[0]?-1:0)*Ze.width*Te,"top"===J.align[1]?We=-Ze.y1*Te:"bottom"===J.align[1]?We=-Ze.y2*Te:"middle"===J.align[1]&&(We=-.5*(Ze.y1+Ze.y2)*Te)}else console.error("text rect not calcualted - please check code");J.rotate||(J.x+=Pe,J.y+=We,Pe=We=0);let dt=(0,xe.bk)(Math.round(J.x),Math.round(J.y))||"";const Q=(0,xe.bk)(Math.round(Pe),Math.round(We)),Ke=Ze=>{dt&&(dt+=" "),dt+=Ze};J.rotate&&Ke(`rotate(${Math.round(J.rotate)})`),1!==Te&&Ke(`scale(${Te.toFixed(3)})`),Q&&Ke(Q),dt&&_e.attr("transform",dt)}),A||N.clearFont(C),null!==k&&k.length>1&&["fill","text-anchor"].forEach(J=>{let _e=k[0].attr(J);k.forEach(be=>{const Te=be.attr(J);(!Te||Te!==_e)&&(_e=void 0)}),_e&&(C.attr(J,_e),k.forEach(be=>{be.attr(J,null)}))}),L&&L(this)}_postprocessDrawText(C,L){return C.box=(0,z.isNodeJs)()||z.settings.ApproxTextSize||C.fast?C.text_rect||{height:1.2*C.font_size,width:C.text.length*C.font_size*C.font.aver_width}:(0,xe.xh)(L,"bbox"),L.attr("visibility","hidden"),C.box.width>C.draw_g.property("max_text_width")&&C.draw_g.property("max_text_width",C.box.width),C.scale&&this.scaleTextDrawing(Math.max(1.05*C.box.width/C.width,C.box.height/C.height),C.draw_g),C.result_width=C.box.width,C.result_height=C.box.height,(0,z.isFunc)(C.post_process)&&C.post_process(this),C.box.width}drawText(C){if(C.text||(C.text=""),C.draw_g=C.draw_g||this.draw_g,!C.draw_g||C.draw_g.empty())return;const L=C.draw_g.property("text_font");C.font=L,L&&(L.color&&!C.color&&(C.color=L.color),L.align&&!C.align&&(C.align=L.align),L.angle&&!C.rotate&&(C.rotate=L.angle));let F=["start","middle"];if((0,z.isStr)(C.align)?(F=C.align.split(";"),1===F.length&&F.push("middle")):"number"==typeof C.align?(C.align/10>=3?F[0]="end":C.align/10>=2&&(F[0]="middle"),C.align%10==0?F[1]="bottom":C.align%10==1?F[1]="bottom-base":C.align%10==3&&(F[1]="top")):(0,z.isObject)(C.align)&&2===C.align.length&&(F=C.align),void 0===C.latex&&(C.latex=1),C.align=F,C.x=C.x||0,C.y=C.y||0,!1!==C.scale&&(C.scale=C.width&&C.height&&!C.font_size),C.width=C.width||0,C.height=C.height||0,C.draw_g.property("_fast_drawing"))if(C.scale){if(C.height<4)return 0}else if(C.font_size){if(C.font_size<4)return 0}else if(C.draw_g.property("_font_too_small"))return 0;C.draw_g.property("all_args").push(C),C.ready=!1;let U=2===C.latex;const j=z.constants.Latex;return 1===C.latex&&(U=z.settings.Latex===j.AlwaysMathJax||z.settings.Latex===j.MathJax&&C.text.match(/[#{\\]/g)||C.text.match(/[\\]/g)),!U||C.nomathjax?(C.txt_node=C.draw_g.append("svg:text"),C.color&&C.txt_node.attr("fill",C.color),C.font_size?C.txt_node.attr("font-size",C.font_size):C.font_size=L.size,C.plain=!C.latex||z.settings.Latex===j.Off||z.settings.Latex===j.Symbols,C.simple_latex=C.latex&&z.settings.Latex===j.Symbols,!C.plain||C.simple_latex||C.font&&C.font.isSymbol?(C.simple_latex||(0,ke.KA)(C.text)||C.plain?(C.simple_latex=!0,(0,ke.eN)(this,C.txt_node,C)):(C.txt_node.remove(),delete C.txt_node,C.txt_g=C.draw_g.append("svg:g"),(0,ke.Bm)(this,C.txt_g,C)),C.ready=!0,this._postprocessDrawText(C,C.txt_g||C.txt_node),C.draw_g.property("draw_text_completed")&&this._checkAllTextDrawing(C.draw_g),0):(C.plain=!0,C.txt_node.text(C.text),C.ready=!0,this._postprocessDrawText(C,C.txt_node))):(C.mj_node=C.draw_g.append("svg:g").attr("visibility","hidden"),(0,ke._o)(this,C.mj_node,C).then(()=>{C.ready=!0,C.draw_g.property("draw_text_completed")&&this._checkAllTextDrawing(C.draw_g)}),0)}finishTextDrawing(C,L){var F=this;return(0,ve.A)(function*(){return C||(C=F.draw_g),!(!C||C.empty())&&(C.property("draw_text_completed",!0),new Promise(U=>{F._checkAllTextDrawing(C,U,L)}))})()}configureUserContextMenu(C){C&&(0,z.isFunc)(C)?this._userContextMenuFunc=C:delete this._userContextMenuFunc}fillObjectExecMenu(C,L){var F=this;return(0,ve.A)(function*(){if((0,z.isFunc)(F._userContextMenuFunc))return F._userContextMenuFunc(C,L);const U=F.getCanvPainter();if(!F.snapid||!U||U?._readonly||!U?._websocket)return C;function j(m){const I=C.exec_painter||this,A=I.getCanvPainter(),R=C.exec_items[parseInt(m)];if(R?.fName){if("Show:Editor"===R.fExec)return void((0,z.isFunc)(A?.activateGed)&&A.activateGed(I));if((!(0,z.isFunc)(A?.executeObjectMethod)||!A.executeObjectMethod(I,R,R.$execid))&&(R.fClassName=I.getClassName(),(R.$execid.indexOf("#x")>0||R.$execid.indexOf("#y")>0||R.$execid.indexOf("#z")>0)&&(R.fClassName=z.clTAxis),!I.executeMenuCommand(R)&&R.$execid)){if(!R.fArgs)return A?.v7canvas?A.submitExec(I,R.fExec,L):I.submitCanvExec(R.fExec,R.$execid);C.showMethodArgsDialog(R).then(k=>{if(!k||I.executeMenuCommand(R,k))return;const J=R.fExec.slice(0,R.fExec.length-1)+k+")";A?.v7canvas?A.submitExec(I,J,L):A?.sendWebsocket(`OBJEXEC:${R.$execid}:${J}`)})}}}const te=(m,I,A,R)=>{if(!C._got_menu){if(C._got_menu=!0,R&&I!==R.fId&&console.error(`missmatch between request ${I} and reply ${R.fId} identifiers`),C.exec_items=R?.fItems,C.exec_items?.length){let k;m.size()>0&&m.add("separator");for(let J=0;J<C.exec_items.length;++J){const _e=C.exec_items[J];if(_e.$execid=R.fId,_e.$menu=C,_e.fClassName&&k&&k!==_e.fClassName&&(m.add("endsub:"),k=""),k!==_e.fClassName){k=_e.fClassName;const be=k.lastIndexOf("::"),Te=be>0?k.slice(be+2):k;m.add("sub:"+Te.replace(/[<>]/g,"_"))}void 0===_e.fChecked||_e.fChecked<0?m.add(_e.fName,J,j):m.addchk(_e.fChecked,_e.fName,J,j)}k&&m.add("endsub:")}A(m)}},N=F.getSnapId(L);return C._got_menu=!1,C.painter&&(C.exec_painter=C.painter!==F?F:void 0),new Promise(m=>{let I=!1;function A(R){I||(I=!0,m(R))}setTimeout(()=>te(C,N,A),2e3),U.submitMenuRequest(F,L,N).then(R=>te(C,N,A,R))})})()}configureUserTooltipHandler(C,L){C&&(0,z.isFunc)(C)?(this._user_tooltip_handler=C,this._user_tooltip_timeout=L||100):(delete this._user_tooltip_handler,delete this._user_tooltip_timeout)}configureUserClickHandler(C){const L=this.getFramePainter();(0,z.isFunc)(L?.configureUserClickHandler)&&L.configureUserClickHandler(C)}configureUserDblclickHandler(C){const L=this.getFramePainter();(0,z.isFunc)(L?.configureUserDblclickHandler)&&L.configureUserDblclickHandler(C)}hasUserTooltip(){return(0,z.isFunc)(this._user_tooltip_handler)}provideUserTooltip(C){if(this.hasUserTooltip()){if(this._user_tooltip_timeout<=0)return this._user_tooltip_handler(C);if(this._user_tooltip_handle&&(clearTimeout(this._user_tooltip_handle),delete this._user_tooltip_handle),!C)return this._user_tooltip_handler(C);this._user_tooltip_handle=setTimeout(()=>{delete this._user_tooltip_handle,this._user_tooltip_handler&&this._user_tooltip_handler(C)},this._user_tooltip_timeout)}}provideSpecialDrawArea(C){var L=this;return(0,ve.A)(function*(){return C===L._special_draw_area||L.getCanvPainter().toggleProjection(C).then(()=>(L._special_draw_area=C,!0))})()}drawInSpecialArea(C,L,F){var U=this;return(0,ve.A)(function*(){const j=U.getCanvPainter();return!(!U._special_draw_area||!(0,z.isFunc)(j?.drawProjection))&&j.drawProjection(F||U._special_draw_area,C,L)})()}getToolTip(C){if(void 0===C?.clientX||void 0===C?.clientY)return null;const L=this.getFrameSvg();if(L.empty())return null;const F=L.selectChild(".main_layer");if(F.empty())return null;const U=(0,b.Wn)(C,F.node()),j={touch:!1,x:U[0],y:U[1]};if((0,z.isFunc)(this.extractToolTip))return this.extractToolTip(j);j.disabled=!0;const te=(0,z.isFunc)(this.processTooltipEvent)?this.processTooltipEvent(j):null;return te?.user_info||te}}function O(_,C){const L=new xe.b8(_);return L.txt=C,L.redrawObject=function(F){return this.txt=F,this.drawText(),!0},L.drawText=(0,ve.A)(function*(){let F=this.txt._typename===z.clTObjString?this.txt.fString:this.txt.value;(0,z.isStr)(F)||(F="<undefined>");const U=this.txt.mathjax||z.settings.Latex===z.constants.Latex.AlwaysMathJax;if(!U&&!("as_is"in this.txt)){const N=F.split("\n");F="";for(let m=0;m<N.length;++m)F+=`<pre style='margin:0'>${N[m]}</pre>`}const j=this.selectDom();let te=j.select("div");return te.empty()&&(te=j.append("div").attr("style","max-width:100%;max-height:100%;overflow:auto")),te.html(F),this.setTopPainter(),U&&(0,ke.s7)(j.node()),this}),L.drawText()}function ce(_){return new Ie(_).getCanvPainter()}function ie(_){return new Ie(_).getMainPainter(!0)}let ue=null;function fe(_){_.active?(ue?.getFramePainter()?.setFrameActive(!1),ue=_.pp,ue?.getFramePainter()?.setFrameActive(!0)):ue===_.pp&&(ue=null)}function le(){return ue}function Y(_,C){!0===C?C={force:!0}:(0,z.isObject)(C)||(C=null);let L=!1;return new Ie(_).forEachPainter(F=>{!L&&(0,z.isFunc)(F.checkResize)&&(L=F.checkResize(C))}),L}function V(_){const C=new Ie(_),L=[];return C.forEachPainter(F=>{L.indexOf(F)<0&&L.push(F)}),L.forEach(F=>F.cleanup()),C.selectDom().html(""),L}const D={kDecimals:(0,z.BIT)(7),kTickPlus:(0,z.BIT)(9),kTickMinus:(0,z.BIT)(10),kAxisRange:(0,z.BIT)(11),kCenterTitle:(0,z.BIT)(12),kCenterLabels:(0,z.BIT)(14),kRotateTitle:(0,z.BIT)(15),kPalette:(0,z.BIT)(16),kNoExponent:(0,z.BIT)(17),kLabelsHori:(0,z.BIT)(18),kLabelsVert:(0,z.BIT)(19),kLabelsDown:(0,z.BIT)(20),kLabelsUp:(0,z.BIT)(21),kIsInteger:(0,z.BIT)(22),kMoreLogLabels:(0,z.BIT)(23),kOppositeTitle:(0,z.BIT)(32)},w="labels",P="normal",x="func",v="time"},8732:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Ov:()=>et,gx:()=>xe});var ve=Ee(5680),b=Ee(6998),z=Ee(6823);const ke=["","","3,3","1,2","3,4,1,4","5,3,1,3","5,3,1,3,1,3,1,3","5,5","5,3,1,3,1,3","20,5","20,10,1,10","1,3"];class xe{constructor(Xe){this.func=this.apply.bind(this),this.used=!0,Xe._typename&&void 0!==Xe.fLineStyle&&(Xe={attr:Xe}),this.setArgs(Xe)}setArgs(Xe){Xe.attr?(this.color_index=Xe.attr.fLineColor,Xe.color=Xe.color0||(Xe.painter?.getColor(this.color_index)??(0,z.oU)(this.color_index)),void 0===Xe.width&&(Xe.width=Xe.attr.fLineWidth),void 0===Xe.style&&(Xe.style=Xe.attr.fLineStyle)):(0,b.isStr)(Xe.color)?"none"!==Xe.color&&!Xe.width&&(Xe.width=1):"number"==typeof Xe.color&&(this.color_index=Xe.color,Xe.color=Xe.painter?.getColor(Xe.color)??(0,z.oU)(Xe.color)),void 0===Xe.width&&(Xe.width=Xe.color&&"none"!==Xe.color?1:0),this.color=0===Xe.width?"none":Xe.color,this.width=Xe.width,this.style=Xe.style,this.pattern=Xe.pattern||ke[this.style]||null,Xe.can_excl&&(this.excl_side=this.excl_width=0,Math.abs(this.width)>99&&(this.excl_side=this.width<0?-1:1,this.excl_width=5*Math.floor(this.width/100),this.width=Math.abs(this.width%100))),!this.color&&this.width>0&&(this.color="lightgrey")}changeExcl(Xe,ot){void 0!==ot&&(this.excl_width=ot),void 0!==Xe&&(this.excl_side=Xe,0===this.excl_width&&0!==this.excl_side&&(this.excl_width=20)),this.changed=!0}empty(){return"none"===this.color}setUsed(Xe){this.used=Xe}setBorder(Xe,ot){this.rx=Xe,this.ry=ot,this.func=this.applyBorder.bind(this)}apply(Xe){this.used=!0,this.empty()?Xe.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null):Xe.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",this.pattern)}applyBorder(Xe){this.used=!0,this.empty()?Xe.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null).attr("rx",null).attr("ry",null):Xe.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",this.pattern).attr("rx",this.rx||null).attr("ry",this.ry||null)}change(Xe,ot,Re){void 0!==Xe&&(this.color!==Xe&&delete this.color_index,this.color=Xe),void 0!==ot&&(this.width=ot),void 0!==Re&&(this.style=Re,this.pattern=ke[this.style]||null),this.changed=!0}verifyDirectChange(){this.change(this.color,parseInt(this.width),parseInt(this.style))}createSample(Xe,ot,Re,He){He&&(Xe=(0,ve.Lt)(Xe)),Xe.append("path").attr("d",`M0,${Re/2}h${ot}`).call(this.func)}saveToStyle(Xe,ot,Re){if(Xe){const He=void 0!==this.color_index?this.color_index:(0,z.vB)(this.color);He>=0&&(b.gStyle[Xe]=He)}ot&&(b.gStyle[ot]=this.width),Re&&(b.gStyle[Re]=this.style)}}function et(Je){return(Je<0||Je>=ke.length)&&(Je=11),ke[Je]}},5284:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{e:()=>xe});var ve=Ee(6998),b=Ee(5680),z=Ee(6823);const ke=[0,1,2,3,4,5,106,107,104,1,1,1,1,1,1,1,1,1,1,1,104,125,126,132,4,25,26,27,28,130,30,3,32,127,128,35,36,37,38,137,40,140,42,142,44,144,46,146,148,149];class xe{constructor(Je){this.x0=this.y0=0,this.color="black",this.style=1,this.size=8,this.scale=1,this.stroke=!0,this.fill=!0,this.marker="",this.ndig=0,this.used=!0,this.changed=!1,this.func=this.apply.bind(this),this.setArgs(Je),this.changed=!1}setArgs(Je){(0,ve.isObject)(Je)&&"number"==typeof Je.fMarkerStyle&&(Je={attr:Je}),Je.attr&&(void 0===Je.color&&(Je.color=Je.painter?Je.painter.getColor(Je.attr.fMarkerColor):(0,z.oU)(Je.attr.fMarkerColor)),(!Je.style||Je.style<0)&&(Je.style=Je.attr.fMarkerStyle),Je.size||(Je.size=Je.attr.fMarkerSize)),this.color=Je.color,this.style=Je.style,this.size=Je.size,this.refsize=Je.refsize,this._configure()}setUsed(Je){this.used=Je}resetPos(){this.lastx=this.lasty=null}create(Je,Xe){if(!this.optimized)return`M${(Je+this.x0).toFixed(this.ndig)},${(Xe+this.y0).toFixed(this.ndig)}${this.marker}`;const ot=Math.round(Je),Re=Math.round(Xe);let He=`M${ot},${Re}`;if(null!==this.lastx)if(ot===this.lastx&&Re===this.lasty)He="";else{const Ie=`m${ot-this.lastx},${Re-this.lasty}`;Ie.length<He.length&&(He=Ie)}return this.lastx=ot+1,this.lasty=Re,He+"h1"}getFullSize(){return this.scale*this.size}getMarkerLength(){return this.marker?this.marker.length:10}change(Je,Xe,ot){this.changed=!0,void 0!==Je&&(this.color=Je),void 0!==Xe&&Xe>=0&&(this.style=Xe),void 0!==ot&&(this.size=ot),this._configure()}_configure(){if(this.x0=this.y0=0,1===this.style||777===this.style)return this.fill=!1,this.marker="h1",this.size=1,this.optimized=!0,this.resetPos(),!0;this.optimized=!1;const Je=ke[this.style]??104,Xe=Je%100;this.fill=Je>=100,this.scale=this.refsize||8;const ot=this.getFullSize();this.ndig=ot>7?0:ot>2?1:2,30===Xe&&this.ndig++;let Re=ot.toFixed(this.ndig);const He=(ot/2).toFixed(this.ndig),Ie=(ot/3).toFixed(this.ndig),O=(ot/4).toFixed(this.ndig),ce=(ot/8).toFixed(this.ndig),ie=(3*ot/8).toFixed(this.ndig);switch(Xe){case 1:this.marker="h1";break;case 2:this.y0=-ot/2,this.marker=`v${Re}m-${He},-${He}h${Re}`;break;case 3:this.x0=this.y0=-ot/2,this.marker=`l${Re},${Re}m0,-${Re}l-${Re},${Re}m0,-${He}h${Re}m-${He},-${He}v${Re}`;break;case 4:this.x0=-parseFloat(He),Re=(2*parseFloat(He)).toFixed(this.ndig),this.marker=`a${He},${He},0,1,0,${Re},0a${He},${He},0,1,0,-${Re},0z`;break;case 5:this.x0=this.y0=-ot/2,this.marker=`l${Re},${Re}m0,-${Re}l-${Re},${Re}`;break;case 6:this.x0=-1,this.marker="a1,1,0,1,0,2,0a1,1,0,1,0,-2,0z";break;case 7:this.x0=-1.5,this.marker="a1.5,1.5,0,1,0,3,0a1.5,1.5,0,1,0,-3,0z";break;case 25:this.x0=this.y0=-ot/2,this.marker=`v${Re}h${Re}v-${Re}z`;break;case 26:this.y0=-ot/2,this.marker=`l-${He},${Re}h${Re}z`;break;case 27:default:this.y0=-ot/2,this.marker=`l${Ie},${He}l-${Ie},${He}l-${Ie},-${He}z`;break;case 28:this.x0=this.y0=ot/6,this.marker=`h${Ie}v-${Ie}h-${Ie}v-${Ie}h-${Ie}v${Ie}h-${Ie}v${Ie}h${Ie}v${Ie}h${Ie}z`;break;case 30:{this.y0=-ot/2;const he=(5*ot/6).toFixed(this.ndig),ue=(5*ot/8).toFixed(this.ndig);this.marker=`l${Ie},${Re}l-${he},-${ue}h${Re}l-${he},${ue}z`;break}case 32:this.y0=ot/2,this.marker=`l-${He},-${Re}h${Re}z`;break;case 35:this.x0=-ot/2,this.marker=`l${He},${He}l${He},-${He}l-${He},-${He}zh${Re}m-${He},-${He}v${Re}`;break;case 36:this.x0=this.y0=-ot/2,this.marker=`h${Re}v${Re}h-${Re}zl${Re},${Re}m0,-${Re}l-${Re},${Re}`;break;case 37:this.x0=-ot/2,this.marker=`h${Re}l-${O},-${He}l-${He},${Re}h${He}l-${He},-${Re}z`;break;case 38:this.x0=-ot/4,this.y0=-ot/2,this.marker=`h${He}l${O},${O}v${He}l-${O},${O}h-${He}l-${O},-${O}v-${He}zm${O},0v${Re}m-${He},-${He}h${Re}`;break;case 40:this.x0=-ot/4,this.y0=-ot/2,this.marker=`l${He},${Re}l${O},-${O}l-${Re},-${He}zm${He},0l-${He},${Re}l-${O},-${O}l${Re},-${He}z`;break;case 42:this.y0=-ot/2,this.marker=`l${ce},${ie}l${ie},${ce}l-${ie},${ce}l-${ce},${ie}l-${ce},-${ie}l-${ie},-${ce}l${ie},-${ce}z`;break;case 44:this.x0=-ot/4,this.y0=-ot/2,this.marker=`h${He}l-${ce},${ie}l${ie},-${ce}v${He}l-${ie},-${ce}l${ce},${ie}h-${He}l${ce},-${ie}l-${ie},${ce}v-${He}l${ie},${ce}z`;break;case 46:this.x0=-ot/4,this.y0=-ot/2,this.marker=`l${O},${O}l${O},-${O}l${O},${O}l-${O},${O}l${O},${O}l-${O},${O}l-${O},-${O}l-${O},${O}l-${O},-${O}l${O},-${O}l-${O},-${O}z`;break;case 48:this.x0=-ot/4,this.y0=-ot/2,this.marker=`l${O},${O}l-${O},${O}l-${O},-${O}zm${He},0l${O},${O}l-${O},${O}l-${O},-${O}zm0,${He}l${O},${O}l-${O},${O}l-${O},-${O}zm-${He},0l${O},${O}l-${O},${O}l-${O},-${O}z`;break;case 49:this.x0=-ot/6,this.y0=-ot/2,this.marker=`h${Ie}v${Ie}h-${Ie}zm${Ie},${Ie}h${Ie}v${Ie}h-${Ie}zm-${Ie},${Ie}h${Ie}v${Ie}h-${Ie}zm-${Ie},-${Ie}h${Ie}v${Ie}h-${Ie}z`}return!0}getStrokeColor(){return this.stroke?this.color:"none"}getFillColor(){return this.fill?this.color:"none"}empty(){return"none"===this.color||!this.fill&&!this.stroke}apply(Je){this.used=!0,Je.style("stroke",this.stroke?this.color:"none").style("fill",this.fill?this.color:"none")}verifyDirectChange(){this.change(this.color,parseInt(this.style),parseFloat(this.size))}createSample(Je,Xe,ot,Re){Re&&(Je=(0,b.Lt)(Je)),this.resetPos(),Je.append("path").attr("d",this.create(Xe/2,ot/2)).call(this.func)}}},1069:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Bx:()=>He,DH:()=>L,DJ:()=>x,Fc:()=>P,G1:()=>w,KG:()=>v,LR:()=>ie,Sc:()=>D,Te:()=>Re,Yw:()=>he,_l:()=>C,ke:()=>O,mZ:()=>Ie,oE:()=>Y,rv:()=>le,yW:()=>fe});var ve=Ee(467),b=Ee(5680),z=Ee(357),ke=Ee(5193),xe=Ee(6998),et=Ee(9041),Je=Ee(5284),Xe=Ee(8732);const Re=new function ot(){const F={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},\u03bf:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},\u03a4:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},\u03a0:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},\u0390:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},\u039a:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},\u0192:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},\u03cc:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},\u03ce:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},\u00ff:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},\u00b5:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},\u0399:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},\u038e:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},\u039d:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},\u03c2:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},\u03a8:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},\u03b9:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},\u0386:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},\u03b5:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},\u0394:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},\u03c1:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},\u0397:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},\u0391:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},\u03bd:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},\u03b2:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},\u039c:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},\u038c:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},\u0389:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},\u03b3:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},\u03b1:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},\u03a7:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},\u039e:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{x_min:0,x_max:0,ha:853},\u03ab:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},\u038a:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},\u0392:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},\u03c5:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},\u03c7:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},\u03af:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},\u0396:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},\u03b4:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},\u03ad:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},\u03c9:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},\u03cb:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},\u03a9:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},\u03cd:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},\u03ae:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},\u0398:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},\u0395:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},\u03c3:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},\u03b6:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},\u03b8:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},\u039f:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},\u0393:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},\u0388:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},\u038f:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},\u03aa:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},\u03a1:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},\u00aa:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},\u03a6:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},\u03a3:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},\u03bb:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},\u03c4:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},\u03be:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},\u039b:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},\u03b0:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},\u03a5:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},\u03bc:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},\u03c6:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},\u03ca:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},\u03c0:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},\u03ac:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},\u03ba:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},\u03c8:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},\u03b7:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},U="normal",N="normal",m={yMin:-334,xMin:-111,yMax:1189,xMax:1672},A={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) \u039cagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"\u039cagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"\u039cagenta ltd",font_sub_family_name:"Regular"},k="Helvetiker";return new ke.KQ({ascender:1189,boundingBox:m,cssFontStyle:N,cssFontWeight:U,default:{glyphs:F,cssFontWeight:U,ascender:1189,underlinePosition:-100,cssFontStyle:N,boundingBox:m,resolution:1e3,original_font_information:A,descender:-334,familyName:k,lineHeight:1522,underlineThickness:50},descender:-334,familyName:k,glyphs:F,lineHeight:1522,original_font_information:A,resolution:1e3,underlinePosition:-100,underlineThickness:50})};function He(F,U){if((!U||!(0,xe.isObject)(U))&&(U={}),(0,xe.isStr)(F)&&("#"===F[0]&&9===F.length||F.indexOf("rgba")>=0)){const j=(0,b.yW)(F);U.color=new z.Q1f(j.r,j.g,j.b),U.opacity=j.opacity??1,U.transparent=U.opacity<1}else U.color=new z.Q1f(F);return U}function Ie(F,U,j){if(F){void 0!==j&&(globalThis.docuemnt=j);const R=new ke.w4;return R.setPrecision(U),R}const m={svg_attr:{},svg_style:{},path_attr:{},accPath:"",createElementNS(R,k){return"path"===k?{_wrapper:this,setAttribute(J,_e){if("style"===J&&_e){const be=_e.indexOf(";stroke-opacity:1;stroke-width:1;stroke-linecap:round");be>=0&&be===_e.length-53&&(_e=_e.slice(0,_e.length-53));const Te=_e.indexOf(";fill-opacity:1");Te>=0&&Te===_e.length-15&&(_e=_e.slice(0,_e.length-15))}this._wrapper.path_attr[J]=_e}}:"svg"!==k?(console.error(`not supported element for SVGRenderer ${k}`),null):{_wrapper:this,childNodes:[],style:this.svg_style,setAttribute(J,_e){this._wrapper.svg_attr[J]=_e},appendChild(J){this._wrapper.accPath+=`<path style="${this._wrapper.path_attr.style}" d="${this._wrapper.path_attr.d}"/>`,this._wrapper.path_attr={}},removeChild(J){this.childNodes=[]}}}};let I;(0,xe.isNodeJs)()&&(I=globalThis.document,globalThis.document=m);const A=new ke.w4;return(0,xe.isNodeJs)()&&(globalThis.document=I),A.doc_wrapper=m,A.originalRender=A.render,A.render=function(R,k){const J=globalThis.document;(0,xe.isNodeJs)()&&(globalThis.document=this.doc_wrapper),this.originalRender(R,k),(0,xe.isNodeJs)()&&(globalThis.document=J)},A.clearHTML=function(){this.doc_wrapper.accPath=""},A.makeOuterHTML=function(){const R=this.doc_wrapper;return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${R.svg_attr.viewBox}" width="${R.svg_attr.width}" height="${R.svg_attr.height}"${R.svg_style.backgroundColor?` style="background:${R.svg_style.backgroundColor}"`:""}>${R.accPath}</svg>`},A.fillTargetSVG=function(R){if((0,xe.isNodeJs)()){const k=this.doc_wrapper;R.setAttribute("viewBox",k.svg_attr.viewBox),R.setAttribute("width",k.svg_attr.width),R.setAttribute("height",k.svg_attr.height),R.style.background=k.svg_style.backgroundColor||"",R.innerHTML=k.accPath}else{const k=this.domElement;for(R.setAttribute("viewBox",k.getAttribute("viewBox")),R.setAttribute("width",k.getAttribute("width")),R.setAttribute("height",k.getAttribute("height")),R.style.background=k.style.backgroundColor;k.firstChild;){const J=k.firstChild;k.removeChild(J),R.appendChild(J)}}},A.setPrecision(U),A}function O(F,U){void 0===U&&(U=(0,xe.isBatchMode)()),F||(F=U?xe.settings.Render3DBatch:xe.settings.Render3D);const j=xe.constants.Render3D;return F===j.Default&&(F=U?j.WebGLImage:j.WebGL),U&&F===j.WebGL&&(F=j.WebGLImage),F}const ce={access3dKind(F){const U=this.getPadSvg();if(U.empty())return-1;const j=U.property("can3d");return void 0!==F&&U.property("can3d",F),j??-1},getSizeFor3d(F){void 0===F&&(F=(F=O())!==xe.constants.Render3D.WebGL?xe.constants.Embed3D.EmbedSVG:xe.settings.Embed3D!==xe.constants.Embed3D.Default?xe.settings.Embed3D:xe.browser.isFirefox||xe.browser.chromeVersion>95?xe.constants.Embed3D.Embed:xe.constants.Embed3D.Overlay);const U=this.getPadSvg(),j="draw3d_"+(this.getPadName()||"canvas");if(U.empty()){const A=(0,et.xh)(this.selectDom());return A.height<10&&A.width>10&&(A.height=Math.round(.66*A.width),this.selectDom().style("height",A.height+"px")),A.x=0,A.y=0,A.clname=j,A.can3d=-1,A}const te=this.getFramePainter(),N=this.getPadPainter();let m;if(te?.mode3d&&F>0)m=te.getFrameRect();else{let A=F>0?U:this.getCanvSvg();m={x:0,y:0,width:A.property("draw_width"),height:A.property("draw_height")},Number.isNaN(m.width)||Number.isNaN(m.height)?(m.width=N.getPadWidth(),m.height=N.getPadHeight()):te&&!te.mode3d&&(A=this.getFrameSvg(),m.x=A.property("draw_x"),m.y=A.property("draw_y"))}m.clname=j,m.can3d=F;const I=N?.getPadRect();if(I){const A=Math.round(.07*m.width),R=Math.round(.05*m.height);m.x=Math.max(0,m.x-A),m.y=Math.max(0,m.y-R),m.width=Math.min(m.width+2*A,I.width-m.x),m.height=Math.min(m.height+2*R,I.height-m.y)}return 1===F&&(m=(0,et.md)(this.getPadSvg(),m)),m},clear3dCanvas(){const F=this.access3dKind(null);if(F<0){const j=this.selectDom().node();let te=j?.firstChild;return te&&!te.$jsroot&&(te=te.nextSibling),te?.$jsroot&&(delete te.painter,j.removeChild(te)),F}const U=this.getSizeFor3d(F);if(0===U.can3d)(0,b.Lt)(this.getCanvSvg().node().nextSibling).remove(),this.getCanvSvg().style("display",null);else{if(this.getPadSvg().empty())return;this.apply3dSize(U).remove(),this.getFrameSvg().style("display",null)}return F},add3dCanvas(F,U,j){if(U&&!(F.can3d<-1)){if(-1===F.can3d){const te=this.selectDom().node();return void(null!==te&&(te.appendChild(U),U.painter=this,U.$jsroot=!0))}if(F.can3d>0&&!j&&(F.can3d=xe.constants.Embed3D.EmbedSVG),this.access3dKind(F.can3d),0===F.can3d)this.getCanvSvg().style("display","none"),this.getCanvSvg().node().parentNode.appendChild(U);else{if(this.getPadSvg().empty())return;this.getFrameSvg().style("display","none"),this.apply3dSize(F).attr("title","").node().appendChild(U)}}},apply3dSize(F,U){if(F.can3d<0)return(0,b.Lt)(null);let j;if(F.can3d>1){if(j=this.getLayerSvg(F.clname),U)return j;const te=this.getPadSvg();F.can3d===xe.constants.Embed3D.EmbedSVG?(j.empty()&&(j=te.insert("g",".primitives_layer").attr("class",F.clname)),(0,et.bk)(j,F.x,F.y)):(j.empty()&&(j=te.insert("foreignObject",".primitives_layer").attr("class",F.clname)),j.attr("x",F.x).attr("y",F.y).attr("width",F.width).attr("height",F.height).attr("viewBox",`0 0 ${F.width} ${F.height}`).attr("preserveAspectRatio","xMidYMid"))}else{let te=this.getCanvSvg().node().parentNode;if(j=(0,b.Lt)(te).select("."+F.clname),U)return j;this.getCanvSvg().property("redraw_by_resize",!0),j.empty()&&(j=(0,b.Lt)(te).append("div").attr("class",F.clname).style("user-select","none"));const N=te.getBoundingClientRect(),m=(0,xe.getDocument)();for(;te;){if(te===m){te=null;break}try{if("static"!==getComputedStyle(te).position)break}catch{break}te=te.parentNode}const I=te?.getBoundingClientRect()??{top:0,left:0},A=Math.round(N.left-I.left),R=Math.round(N.top-I.top);j.style("position","absolute").style("left",F.x+A+"px").style("top",F.y+R+"px").style("width",F.width+"px").style("height",F.height+"px")}return j}};function ie(F){Object.assign(F,ce)}function he(F,U,j,te){return ue.apply(this,arguments)}function ue(){return(ue=(0,ve.A)(function*(F,U,j,te){const N=xe.constants.Render3D,m=(0,xe.getDocument)();let I;if(j=O(j),te||(te={antialias:!0,alpha:!0}),j===N.SVG){const A=Ie(!1,0,m);A.jsroot_dom=m.createElementNS("http://www.w3.org/2000/svg","svg"),I=Promise.resolve(A)}else if((0,xe.isNodeJs)())I=Ee.e(914).then(Ee.t.bind(Ee,1914,19)).then(A=>(te.canvas=A.default.createCanvas(F,U),te.canvas.addEventListener=()=>{},te.canvas.removeEventListener=()=>{},te.canvas.style={},Ee.e(979).then(Ee.t.bind(Ee,2979,19)))).then(A=>{const R=A.default(F,U,{preserveDrawingBuffer:!0});if(!R)throw Error("Fail to create headless-gl");te.context=R,R.canvas=te.canvas;const k=new z.JeP(te);return k.jsroot_output=new z.nWS(F,U),k.setRenderTarget(k.jsroot_output),k.jsroot_dom=m.createElementNS("http://www.w3.org/2000/svg","image"),k});else if(j===N.WebGL)I=Promise.resolve(new z.JeP(te));else{const A=new z.JeP(te);A.jsroot_dom=m.createElementNS("http://www.w3.org/2000/svg","image"),I=Promise.resolve(A)}return I.then(A=>(A.jsroot_dom?A.jsroot_custom_dom=!0:A.jsroot_dom=A.domElement,A.jsroot_render3d=j,A.jsroot_image_format="png",A.originalSetSize=A.setSize,A.setSize=function(R,k,J){this.jsroot_custom_dom&&(this.jsroot_dom.setAttribute("width",R),this.jsroot_dom.setAttribute("height",k)),this.originalSetSize(R,k,J)},A.setSize(F,U),A))})).apply(this,arguments)}function fe(F){if(F)if((0,xe.isNodeJs)()){const U=(0,xe.isFunc)(F.getContext)?F.getContext():null,j=U?.getExtension("STACKGL_destroy_context");(0,xe.isFunc)(j?.destroy)&&j.destroy()}else xe.browser.isChrome&&(0,xe.isFunc)(F.forceContextLoss)&&F.forceContextLoss(),(0,xe.isFunc)(F.dispose)&&F.dispose()}function le(F){(0,xe.isFunc)(F.clearHTML)&&F.clearHTML()}function Y(F){const U=xe.constants.Render3D;if(F.jsroot_render3d!==U.WebGL)if(F.jsroot_render3d===U.SVG)F.fillTargetSVG(F.jsroot_dom);else if((0,xe.isNodeJs)()){const j=F.domElement,te=j.getContext("2d"),N=new Uint8Array(4*j.width*j.height);F.readRenderTargetPixels(F.jsroot_output,0,0,j.width,j.height,N);let A,R,m=0,I=4*(j.height-1)*j.width;for(;m<I;){for(A=0;A<4*j.width;++A)R=N[m+A],N[m+A]=N[I+A],N[I+A]=R;m+=4*j.width,I-=4*j.width}const k=te.createImageData(j.width,j.height);k.data.set(N),te.putImageData(k,0,0);const _e=j.toDataURL("image/"+F.jsroot_image_format);F.jsroot_dom.setAttribute("href",_e)}else{const j=F.domElement.toDataURL("image/"+F.jsroot_image_format);F.jsroot_dom.setAttribute("href",j)}}class V{constructor(U,j){this.tt=null,this.cont=null,this.lastlbl="",this.parent=U||(0,xe.getDocument)().body,this.canvas=j,this.abspos=!U}checkParent(U){U&&this.parent!==U&&(this.hide(),this.parent=U)}extract_pos(U){if((0,xe.isObject)(U)&&void 0!==U.u&&void 0!==U.l)return U;const j={u:0,l:0};return this.abspos?(j.l=U.pageX,j.u=U.pageY):(j.l=U.offsetX,j.u=U.offsetY),j}pos(U){if(!this.tt)return;const j=this.extract_pos(U);if(!this.abspos){const te=this.parent.getBoundingClientRect(),N=this.canvas.getBoundingClientRect();void 0!==te.left&&void 0!==N.left&&(j.l+=N.left-te.left),void 0!==te.top&&void 0!==N.top&&(j.u+=N.top-te.top),j.l+this.tt.offsetWidth+3>=this.parent.offsetWidth&&(j.l=this.parent.offsetWidth-this.tt.offsetWidth-3),j.u+this.tt.offsetHeight+15>=this.parent.offsetHeight&&(j.u=this.parent.offsetHeight-this.tt.offsetHeight-15);let m=this.parent;for(;m;){const I=getComputedStyle(m);if(!I||"static"!==I.position||!m.parentNode||1!==m.parentNode.nodeType)break;m=m.parentNode}if(m&&m!==this.parent){const I=m.getBoundingClientRect();j.l+=te.left-I.left,j.u+=te.top-I.top}}this.tt.style.top=`${j.u+15}px`,this.tt.style.left=`${j.l+3}px`}show(U){if(!U)return this.hide();if((0,xe.isObject)(U)&&(U.lines||U.line)){if(U.only_status)return this.hide();if(U.line)U=U.line;else{let j=U.lines[0];for(let te=1;te<U.lines.length;++te)j+="<br/>"+U.lines[te];U=j}}if(null===this.tt){const j=(0,xe.getDocument)();this.tt=j.createElement("div"),this.tt.setAttribute("style","opacity: 1; filter: alpha(opacity=1); position: absolute; display: block; overflow: hidden; z-index: 101;"),this.cont=j.createElement("div"),this.cont.setAttribute("style","display: block; padding: 2px 12px 3px 7px; margin-left: 5px; font-size: 11px; background: #777; color: #fff;"),this.tt.appendChild(this.cont),this.parent.appendChild(this.tt)}this.lastlbl!==U&&(this.cont.innerHTML=U,this.lastlbl=U,this.tt.style.width="auto")}hide(){null!==this.tt&&this.parent.removeChild(this.tt),this.tt=null,this.lastlbl=""}}function D(F,U,j,te,N){const m=xe.settings.Zooming&&xe.settings.ZoomMouse,I=(0,xe.isFunc)(F.processMouseClick);let A=null;function R(be){if(A){if(A.mouse_zoom_mesh)return be.stopImmediatePropagation(),void be.stopPropagation();if(!(void 0!==be.button&&0!==be.button||void 0!==be.buttons&&1!==be.buttons)){if(A.enable_zoom&&(A.mouse_zoom_mesh=A.detectZoomMesh(be),A.mouse_zoom_mesh))return be.stopImmediatePropagation(),void be.stopPropagation();A.enable_select&&(A.mouse_select_pnt=A.getMousePos(be,{}))}}}function k(be){if(A){if(A.mouse_zoom_mesh&&A.mouse_zoom_mesh.point2&&A.painter.get3dZoomCoord){let Te=A.mouse_zoom_mesh.object.zoom,Pe=A.painter.get3dZoomCoord(A.mouse_zoom_mesh.point,Te),We=A.painter.get3dZoomCoord(A.mouse_zoom_mesh.point2,Te);Pe>We&&([Pe,We]=[We,Pe]),"z"===Te&&A.mouse_zoom_mesh.object.use_y_for_z&&(Te="y"),Pe<We&&A.painter.zoom(Te,Pe,We)&&(A.mouse_zoom_mesh=null)}if(A.enable_zoom&&A.removeZoomMesh(),A.enable_select&&A.mouse_select_pnt){const Te=A.getMousePos(be,{}),Pe=Te.x===A.mouse_select_pnt.x&&Te.y===A.mouse_select_pnt.y;if(delete A.mouse_select_pnt,Pe){const We=A.getMouseIntersects(Te);A.painter.processMouseClick(Te,We,be)}}}}function _e(be){if(!A)return;if(function J(be){return!(!be||void 0===be.renderer)&&void 0!==be.render_tmout}(A.painter)||A.mouse_zoom_mesh)return be.preventDefault(),be.stopPropagation(),void be.stopImmediatePropagation();const Te=A.detectZoomMesh(be);if(Te&&(be.preventDefault(),be.stopPropagation(),be.stopImmediatePropagation(),(0,xe.isFunc)(A.painter?.analyzeMouseWheelEvent))){let Pe=Te.object.zoom,We=Te.point[Pe];const dt={name:Pe,ignore:!1};switch(Pe){case"x":We=(We+A.painter.size_x3d)/2/A.painter.size_x3d;break;case"y":We=(We+A.painter.size_y3d)/2/A.painter.size_y3d;break;case"z":We=We/2/A.painter.size_z3d}A.painter.analyzeMouseWheelEvent(be,dt,We,!1),"z"===Pe&&Te.object.use_y_for_z&&(Pe="y"),A.painter.zoom(Pe,dt.min,dt.max)}}return xe.settings.Zooming&&xe.settings.ZoomWheel&&te.domElement.addEventListener("wheel",_e),(m||I)&&(te.domElement.addEventListener("pointerdown",R),te.domElement.addEventListener("pointerup",k)),A=new ke.NU(U,te.domElement),A.enableDamping=!1,A.dampingFactor=1,A.enableZoom=!0,A.enableKeys=xe.settings.HandleKeys,N&&(A.target.copy(N),A.target0.copy(N),A.update()),A.tooltip=new V(F.selectDom().node(),te.domElement),A.painter=F,A.camera=U,A.scene=j,A.renderer=te,A.raycaster=new z.tBo,A.raycaster.params.Line.threshold=10,A.raycaster.params.Points.threshold=5,A.mouse_zoom_mesh=null,A.block_ctxt=!1,A.block_mousemove=!1,A.cursor_changed=!1,A.control_changed=!1,A.control_active=!1,A.mouse_ctxt={x:0,y:0,on:!1},A.enable_zoom=m,A.enable_select=I,A.cleanup=function(){xe.settings.Zooming&&xe.settings.ZoomWheel&&this.domElement.removeEventListener("wheel",_e),(this.enable_zoom||this.enable_select)&&(this.domElement.removeEventListener("pointerdown",R),this.domElement.removeEventListener("pointerup",k)),this.domElement.removeEventListener("click",this.lstn_click),this.domElement.removeEventListener("dblclick",this.lstn_dblclick),this.domElement.removeEventListener("contextmenu",this.lstn_contextmenu),this.domElement.removeEventListener("mousemove",this.lstn_mousemove),this.domElement.removeEventListener("mouseleave",this.lstn_mouseleave),this.dispose(),this.tooltip.hide(),delete this.tooltip,delete this.painter,delete this.camera,delete this.scene,delete this.renderer,delete this.raycaster,delete this.mouse_zoom_mesh},A.HideTooltip=function(){this.tooltip.hide()},A.getMousePos=function(be,Te){return Te.x="offsetX"in be?be.offsetX:be.layerX,Te.y="offsetY"in be?be.offsetY:be.layerY,Te.clientX=be.clientX,Te.clientY=be.clientY,Te},A.getOriginDirectionIntersects=function(be,Te){this.raycaster.set(be,Te);let Pe=this.raycaster.intersectObjects(this.scene.children,!0);return(0,xe.isFunc)(this.painter.filterIntersects)&&(Pe=this.painter.filterIntersects(Pe)),Pe},A.getMouseIntersects=function(be){if(!this.renderer)return[];const Te=this.renderer instanceof ke.w4?this.renderer.domElement:this.renderer.getSize(new z.I9Y),Pe={x:be.x/Te.width*2-1,y:-be.y/Te.height*2+1};this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.raycaster.setFromCamera(Pe,this.camera);let We=this.raycaster.intersectObjects(this.scene.children,!0);return(0,xe.isFunc)(this.painter.filterIntersects)&&(We=this.painter.filterIntersects(We)),We},A.detectZoomMesh=function(be){const Te=this.getMousePos(be,{}),Pe=this.getMouseIntersects(Te);if(Pe)for(let We=0;We<Pe.length;++We)if(Pe[We].object.zoom&&!Pe[We].object.zoom_disabled)return Pe[We];return null},A.getInfoAtMousePosition=function(be){const Te=this.getMouseIntersects(be);let Pe=null,We=null;for(let dt=0;dt<Te.length;++dt)if(Te[dt].object.tooltip){Pe=Te[dt].object.tooltip(Te[dt]),We=Te[dt].object.painter;break}if(Pe&&We)return{obj:We.getObject(),name:We.getObject().fName,bin:Pe.bin,cont:Pe.value,binx:Pe.ix,biny:Pe.iy,binz:Pe.iz,grx:(Pe.x1+Pe.x2)/2,gry:(Pe.y1+Pe.y2)/2,grz:(Pe.z1+Pe.z2)/2}},A.processDblClick=function(be){const Te=this.detectZoomMesh(be);if(Te&&this.painter)return void this.painter.unzoom(Te.object.use_y_for_z?"y":Te.object.zoom);const Pe=this.painter?.getFramePainter();if((0,xe.isFunc)(Pe?._dblclick_handler)){const We=this.getInfoAtMousePosition(this.getMousePos(be,{}));if(We)return void Pe._dblclick_handler(We)}this.reset()},A.changeEvent=function(){this.mouse_ctxt.on=!1,this.painter.render3D(0),this.control_changed=!0},A.startEvent=function(){this.control_active=!0,this.block_ctxt=!1,this.mouse_ctxt.on=!1,this.tooltip.hide()},A.endEvent=function(){this.control_active=!1,this.mouse_ctxt.on&&(this.mouse_ctxt.on=!1,this.contextMenu(this.mouse_ctxt,this.getMouseIntersects(this.mouse_ctxt))),this.control_changed=!1},A.mainProcessContextMenu=function(be){be.preventDefault(),this.getMousePos(be,this.mouse_ctxt),this.control_active?this.mouse_ctxt.on=!0:this.block_ctxt?this.block_ctxt=!1:this.contextMenu(this.mouse_ctxt,this.getMouseIntersects(this.mouse_ctxt))},A.contextMenu=function(){},A.setTooltipEnabled=function(be){this.block_mousemove=!be,!1===be&&(this.tooltip.hide(),this.removeZoomMesh())},A.removeZoomMesh=function(){this.mouse_zoom_mesh?.object.showSelection()&&this.painter.render3D(),this.mouse_zoom_mesh=null},A.mainProcessMouseMove=function(be){if(this.painter&&(this.control_active&&be.buttons&&2&be.buttons&&(this.block_ctxt=!0),!this.control_active&&!this.block_mousemove&&(0,xe.isFunc)(this.processMouseMove))){if(this.mouse_zoom_mesh){const Te=this.detectZoomMesh(be),Pe=Te?.object===this.mouse_zoom_mesh.object?Te.point:this.mouse_zoom_mesh.object.globalIntersect(this.raycaster);return Pe&&(this.mouse_zoom_mesh.point2=Pe),Pe&&this.painter.enable_highlight&&this.mouse_zoom_mesh.object.showSelection(this.mouse_zoom_mesh.point,Pe)&&this.painter.render3D(0),void this.tooltip.hide()}be.preventDefault(),this.tmout_mouse=this.getMousePos(be,{}),this.tmout_ttpos=this.tooltip?.extract_pos(be),this.tmout_handle&&(clearTimeout(this.tmout_handle),delete this.tmout_handle),this.mouse_tmout?this.tmout_handle=setTimeout(()=>this.delayedProcessMouseMove(),this.mouse_tmout):this.delayedProcessMouseMove()}},A.delayedProcessMouseMove=function(){if(delete this.tmout_handle,!this.painter)return;const be=this.tmout_mouse,Te=this.getMouseIntersects(be),Pe=this.processMouseMove(Te);if(Pe){let We="",dt="",Q="",Ke="";be&&(Q=be.x.toFixed(0)+","+be.y.toFixed(0)),(0,xe.isStr)(Pe)?Ke=Pe:(We=Pe.name,dt=Pe.title,Pe.line?Ke=Pe.line:Pe.lines&&(Ke=Pe.lines.slice(1).join(" "),We=Pe.lines[0])),this.painter.showObjectStatus(We,dt,Ke,Q)}if(this.cursor_changed=!1,Pe&&this.painter?.isTooltipAllowed())this.tooltip.checkParent(this.painter.selectDom().node()),this.tooltip.show(Pe,be),this.tooltip.pos(this.tmout_ttpos);else if(this.tooltip.hide(),Te)for(let We=0;We<Te.length;++We)Te[We].object.zoom&&!Te[We].object.zoom_disabled&&(this.cursor_changed=!0);(0,xe.getDocument)().body.style.cursor=this.cursor_changed?"pointer":"auto"},A.mainProcessMouseLeave=function(){this.painter&&(this.tmout_handle&&(clearTimeout(this.tmout_handle),delete this.tmout_handle),this.tooltip.hide(),(0,xe.isFunc)(this.processMouseLeave)&&this.processMouseLeave(),this.cursor_changed&&((0,xe.getDocument)().body.style.cursor="auto",this.cursor_changed=!1))},A.mainProcessDblClick=function(be){this.single_click_tm&&(clearTimeout(this.single_click_tm),delete this.single_click_tm),this.processDblClick(be)},A.processClick=function(be,Te){if(delete this.single_click_tm,1===Te){const Pe=this.painter?.getFramePainter();if((0,xe.isFunc)(Pe?._click_handler)){const We=this.getInfoAtMousePosition(be);if(We)return void Pe._click_handler(We)}}if(2===Te&&(0,xe.isFunc)(this.processSingleClick)){const Pe=this.getMouseIntersects(be);this.processSingleClick(Pe)}},A.lstn_click=function(be){if(2===be.detail)return;this.single_click_tm&&(clearTimeout(this.single_click_tm),delete this.single_click_tm);let Te=0;(0,xe.isFunc)(this.painter?.getFramePainter()?._click_handler)?Te=1:this.processSingleClick&&this.painter?.options?.mouse_click&&(Te=2),Te&&(this.single_click_tm=setTimeout(this.processClick.bind(this,this.getMousePos(be,{}),Te),300))}.bind(A),A.addEventListener("change",()=>A.changeEvent()),A.addEventListener("start",()=>A.startEvent()),A.addEventListener("end",()=>A.endEvent()),A.lstn_contextmenu=be=>A.mainProcessContextMenu(be),A.lstn_dblclick=be=>A.mainProcessDblClick(be),A.lstn_mousemove=be=>A.mainProcessMouseMove(be),A.lstn_mouseleave=()=>A.mainProcessMouseLeave(),te.domElement.addEventListener("click",A.lstn_click),te.domElement.addEventListener("dblclick",A.lstn_dblclick),te.domElement.addEventListener("contextmenu",A.lstn_contextmenu),te.domElement.addEventListener("mousemove",A.lstn_mousemove),te.domElement.addEventListener("mouseleave",A.lstn_mouseleave),A}function w(F,U){if(F){if(F.children)for(let j=0;j<F.children.length;j++)w(F.children[j]);if(U)return void(F.children=[]);F.children=void 0,F.geometry&&(F.geometry.dispose(),F.geometry=void 0),F.material&&(F.material.map&&(F.material.map.dispose(),F.material.map=void 0),F.material.dispose(),F.material=void 0),delete F.painter,delete F.bins_index,delete F.tooltip,delete F.stack,delete F.drawn_highlight,F=void 0}}function P(F,U,j=void 0,te=!1){const N=new z.LoY;if(N.setAttribute("position",F instanceof Float32Array?new z.THS(F,3):new z.qtW(F,3)),j&&N.setIndex(new z.THS(j,1)),U.isLineDashedMaterial){const m=new z.Pq0,I=new z.Pq0;let A=0,R=null;if(j){R=new Float32Array(j.length);for(let k=0;k<j.length;k+=2){const J=j[k],_e=j[k+1];m.set(F[J],F[J+1],F[J+2]),I.set(F[_e],F[_e+1],F[_e+2]),R[k]=A,A+=I.distanceTo(m),R[k+1]=A}}else{R=new Float32Array(F.length/3);for(let k=0;k<F.length;k+=6)m.set(F[k],F[k+1],F[k+2]),I.set(F[k+3],F[k+4],F[k+5]),R[k/3]=A,A+=I.distanceTo(m),R[k/3+1]=A}N.setAttribute("lineDistance",new z.THS(R,1))}return te?N:new z.DXC(N,U)}const x={Vertices:[new z.Pq0(1,1,1),new z.Pq0(1,1,0),new z.Pq0(1,0,1),new z.Pq0(1,0,0),new z.Pq0(0,1,0),new z.Pq0(0,1,1),new z.Pq0(0,0,0),new z.Pq0(0,0,1)],Indexes:[0,2,1,2,3,1,4,6,5,6,7,5,4,5,1,5,0,1,7,6,2,6,3,2,5,7,0,7,2,0,1,3,4,3,6,4],Normals:[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],Segments:[0,2,2,7,7,5,5,0,1,3,3,6,6,4,4,1,1,0,3,2,6,7,4,5],MeshSegments:void 0};x.MeshSegments=function(){const F=new Int32Array(x.Segments.length);for(let U=0;U<F.length;++U)for(let j=0;j<x.Indexes.length;++j)if(x.Segments[U]===x.Indexes[j]){F[U]=j;break}return F}();class v{cleanup(){}extractIndex(){}setSelected(){}setHighlight(){}checkHighlightIndex(){}}class C{constructor(U,j=!0,te=1){this.webgl=j,this.scale=te||1,this.pos=new Float32Array(3*U),this.geom=new z.LoY,this.geom.setAttribute("position",new z.THS(this.pos,3)),this.indx=0}addPoint(U,j,te){this.pos[this.indx]=U,this.pos[this.indx+1]=j,this.pos[this.indx+2]=te,this.indx+=3}createPoints(U){(0,xe.isObject)(U)||(U={color:U}),U.color||(U.color="black");let j=1;U.style?1===U.style?j=.3:6===U.style?j=.5:7===U.style&&(j=.7):j=1.1;const te=k=>{const J={size:3*this.scale*j};k?(J.map=k,J.transparent=!0):J.color=U.color||"black";const _e=new z.ONl(this.geom,new z.BH$(J));return _e.nvertex=1,_e};if(1!==j){const k=te();return this.noPromise?k:Promise.resolve(k)}const N=new Je.e({style:U.style,color:U.color,size:7}),m=N.fill?1:7,I=`<svg width="64" height="64" xmlns="http://www.w3.org/2000/svg"><path d="${N.create(32,32)}" style="stroke: ${N.getStrokeColor()}; stroke-width: ${m}; fill: ${N.getFillColor()}"></path></svg>`,A="data:image/svg+xml;charset=utf8,"+((0,xe.isNodeJs)()?I:encodeURIComponent(I));let R;if((0,xe.isNodeJs)())R=Ee.e(914).then(Ee.t.bind(Ee,1914,19)).then(k=>k.default.loadImage(A).then(J=>{const _e=k.default.createCanvas(64,64);return _e.getContext("2d").drawImage(J,0,0,64,64),new z.GOR(_e)}));else{if(this.noPromise)return te((new z.Tap).load(A));R=new Promise((k,J)=>{(new z.Tap).load(A,be=>k(be),void 0,()=>J())})}return R.then(te)}}function L(F,U,j=!1){if(!F||!U)return null;let te,N,m;(0,xe.isStr)(U)||j?(te=F.v7EvalColor(U+"color","black"),N=parseInt(F.v7EvalAttr(U+"style",0)),m=parseInt(F.v7EvalAttr(U+"width",1))):(te=F.getColor(U.fLineColor),N=U.fLineStyle,m=U.fLineWidth);const I=N?(0,Xe.Ov)(N):"",A=I?I.split(","):[],R=A&&A.length>=2?new z.Fvt({color:te,dashSize:parseInt(A[0]),gapSize:parseInt(A[1])}):new z.mrM({color:te});return m&&m>1&&(R.linewidth=m),R}},6823:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{$q:()=>xe,HG:()=>he,LQ:()=>C,TZ:()=>le,d_:()=>ue,ho:()=>ke,jh:()=>_,nM:()=>w,nj:()=>O,np:()=>Y,oU:()=>V,pX:()=>z,rE:()=>P,tA:()=>et,uw:()=>fe,vB:()=>D});var ve=Ee(6998),b=Ee(5680);const z="TLinearGradient",ke="TRadialGradient",xe=0,et=1;function O(L,F=255){const U=Math.round(L*F).toString(16);return 1===U.length?"0"+U:U}let ce=[];function he(){return ce}function ue(L){if(L?._typename!==ve.clTColor)return null;let F="#"+O(L.fRed)+O(L.fGreen)+O(L.fBlue);switch(void 0!==L.fAlpha&&1!==L.fAlpha&&(F+=O(L.fAlpha)),F){case"#ffffff":return"white";case"#000000":return"black";case"#ff0000":return"red";case"#00ff00":return"green";case"#0000ff":return"blue";case"#ffff00":return"yellow";case"#ff00ff":return"magenta";case"#00ffff":return"cyan"}return F}function fe(L){const F=[];L||(L=he());for(let U=0;U<L.length;++U){if(!L[U])continue;const j=(0,b.yW)(L[U]);j.r=j.g=j.b=.299*j.r+.587*j.g+.114*j.b,F[U]=j.hex()}return F}function le(L,F,U){if(!L){L=[];for(let te=0;te<ce.length;++te)L[te]=ce[te]}if(!F)return L;let j=F;if(F._typename&&F.arr){j=[];for(let te=0;te<F.arr.length;++te){const N=F.arr[te];N?._typename!==z&&N?._typename!==ke?N?._typename===ve.clTColor&&N.fNumber>=0&&N.fNumber<=1e4&&(j[N.fNumber]=ue(N)):(j[N.fNumber]=N,N.toString=()=>"white")}}for(let te=0;te<j.length;++te)j[te]&&L[te]!==j[te]&&(L[te]=j[te]);return U?fe(L):L}function Y(L){le(ce,L)}function V(L){return ce[L]}function D(L){if(!L)return-1;for(let F=0;F<ce.length;++F)if(ce[F]===L)return F;return-1}function w(L,F){F||(F=ce);const U=F.indexOf(L);return U>=0?U:(F.push(L),F.length-1)}class P{constructor(F,U){this.palette=U?fe(F):F}calcColorIndex(F,U){const j=this.palette.length,te=Math.floor((F+.99)*j/(U-1));return te>j-1?j-1:te}getColor(F){return this.palette[F]}getLength(){return this.palette.length}calcColor(F,U){return this.getColor(this.calcColorIndex(F,U))}}function x(L){const F=(I,A,R)=>(R<0&&(R+=1),R>1&&(R-=1),R<.16666666666666666?I+6*(A-I)*R:R<.5?A:R<.6666666666666666?I+(A-I)*(.6666666666666666-R)*6:I),U=(I,A,R)=>{const k=A<.5?A*(1+R):A+R-A*R,J=2*A-k,_e=F(J,k,I+1/3),be=F(J,k,I),Te=F(J,k,I-1/3);return"#"+O(_e)+O(be)+O(Te)},m=[];for(let I=0;I<50;++I)m.push(U((280-5.6*(I+1))/360,.5,1));return new P(m,L)}function _(L,F){if((L=L||ve.settings.Palette)>0&&L<10)return function v(){const L=[];for(let F=0;F<50;++F){const U=O((F+2)/60);L.push("#"+U+U+U)}return new P(L)}();if(L<51)return x(F);L>113&&(L=57);const U=[0,.125,.25,.375,.5,.625,.75,.875,1];let j;switch(L){case 51:j=[[0,9,13,17,24,32,27,25,29],[0,0,0,2,37,74,113,160,221],[28,42,59,78,98,129,154,184,221]];break;case 52:j=[[0,32,64,96,128,160,192,224,255],[0,32,64,96,128,160,192,224,255],[0,32,64,96,128,160,192,224,255]];break;case 53:j=[[0,45,99,156,212,230,237,234,242],[0,0,0,45,101,168,238,238,243],[0,1,1,3,9,8,11,95,230]];break;case 54:j=[[0,22,44,68,93,124,160,192,237],[0,16,41,67,93,125,162,194,241],[97,100,99,99,93,68,44,26,74]];break;case 55:j=[[0,5,15,35,102,196,208,199,110],[0,48,124,192,206,226,97,16,0],[99,142,198,201,90,22,13,8,2]];break;case 56:j=[[242,234,237,230,212,156,99,45,0],[243,238,238,168,101,45,0,0,0],[230,95,11,8,9,3,1,1,0]];break;case 57:j=[[53.091,15.096,19.89,5.916,45.951,135.1755,208.743,253.878,248.982],[42.432,91.7745,128.5455,163.6845,183.039,191.046,186.864,200.481,250.716],[134.9715,221.442,213.8175,201.807,163.8375,118.881,89.2245,50.184,13.7445]];break;case 58:j=[[0,24,2,54,176,236,202,194,255],[0,29,92,129,117,120,176,236,255],[0,68,80,34,57,172,252,245,255]];break;case 59:j=[[13,23,25,63,76,104,137,161,206],[95,67,37,21,0,12,35,52,79],[4,3,2,6,11,22,49,98,208]];break;case 60:j=[[0,61,89,122,143,160,185,204,231],[0,0,0,0,14,37,72,132,235],[0,140,224,144,4,5,6,9,13]];break;case 61:j=[[14,7,2,0,5,11,55,131,229],[105,56,26,1,42,74,131,171,229],[2,21,35,60,92,113,160,185,229]];break;case 62:j=[[0,0,0,70,148,231,235,237,244],[0,0,0,0,0,69,67,216,244],[0,102,228,231,177,124,137,20,244]];break;case 63:j=[[50,56,63,68,93,121,165,192,241],[66,81,91,96,111,128,155,189,241],[97,91,75,65,77,103,143,167,217]];break;case 64:j=[[145,166,167,156,131,114,101,112,132],[158,178,179,181,163,154,144,152,159],[190,199,201,192,176,169,160,166,190]];break;case 65:j=[[93,91,99,108,130,125,132,155,174],[126,124,128,129,131,121,119,153,173],[103,94,87,85,80,85,107,120,146]];break;case 66:j=[[24,40,69,90,104,114,120,132,103],[29,52,94,127,150,162,159,151,101],[29,52,96,132,162,181,184,186,131]];break;case 67:j=[[46,38,61,92,113,121,132,150,191],[46,36,40,69,110,135,131,92,34],[46,80,74,70,81,105,165,211,225]];break;case 68:j=[[0,4,12,30,52,101,142,190,237],[0,40,86,121,140,172,187,213,240],[0,9,14,18,21,23,27,35,101]];break;case 69:j=[[198,206,206,211,198,181,161,171,244],[103,133,150,172,178,174,163,175,244],[49,54,55,66,91,130,184,224,244]];break;case 70:j=[[243,243,240,240,241,239,186,151,129],[0,46,99,149,194,220,183,166,147],[6,8,36,91,169,235,246,240,233]];break;case 71:j=[[22,19,19,25,35,53,88,139,210],[0,32,69,108,135,159,183,198,215],[77,96,110,116,110,100,90,78,70]];break;case 72:j=[[68,116,165,182,189,180,145,111,71],[37,82,135,178,204,225,221,202,147],[16,55,105,147,196,226,232,224,178]];break;case 73:j=[[61,99,136,181,213,225,198,136,24],[149,140,96,83,132,178,190,135,22],[214,203,168,135,110,100,111,113,22]];break;case 74:j=[[76,120,156,183,197,180,162,154,140],[34,35,42,69,102,137,164,188,197],[64,69,78,105,142,177,205,217,198]];break;case 75:j=[[37,102,157,188,196,214,223,235,251],[37,29,25,37,67,91,132,185,251],[37,32,33,45,66,98,137,187,251]];break;case 76:j=[[79,100,119,137,153,172,192,205,250],[63,79,93,103,115,135,167,196,250],[51,59,66,61,62,70,110,160,250]];break;case 77:j=[[43,44,50,66,125,172,178,155,157],[63,63,85,101,138,163,122,51,39],[121,101,58,44,47,55,57,44,43]];break;case 78:j=[[0,41,62,79,90,87,99,140,228],[0,57,81,93,85,70,71,125,228],[95,91,91,82,60,43,44,112,228]];break;case 79:j=[[49,59,72,88,114,141,176,205,222],[78,72,66,57,59,75,106,142,173],[78,55,46,40,39,39,40,41,47]];break;case 80:j=[[243,222,201,185,165,158,166,187,219],[94,108,132,135,125,96,68,51,61],[7,9,12,19,45,89,118,146,118]];break;case 81:j=[[19,44,74,105,137,166,194,206,220],[19,28,40,55,82,110,159,181,220],[19,42,68,96,129,157,188,203,220]];break;case 82:j=[[33,44,70,99,140,165,199,211,216],[38,50,76,105,140,165,191,189,167],[55,67,97,124,140,166,163,129,52]];break;case 83:j=[[0,33,73,124,136,152,159,171,223],[0,43,92,124,134,126,121,144,223],[0,43,68,76,73,64,72,114,223]];break;case 84:j=[[5,18,45,124,193,223,205,128,49],[48,134,207,230,193,113,28,0,7],[6,15,41,121,193,226,208,130,49]];break;case 85:j=[[180,106,104,135,164,188,189,165,144],[72,126,154,184,198,207,205,190,179],[41,120,158,188,194,181,145,100,62]];break;case 86:j=[[57,72,94,117,136,154,174,192,215],[0,33,68,109,140,171,192,196,209],[116,137,173,201,200,201,203,190,187]];break;case 87:j=[[31,71,123,160,210,222,214,199,183],[40,117,171,211,231,220,190,132,65],[234,214,228,222,210,160,105,60,34]];break;case 88:j=[[123,108,109,126,154,172,188,196,218],[184,138,130,133,154,175,188,196,218],[208,130,109,99,110,122,150,171,218]];break;case 89:j=[[105,106,122,143,159,172,176,181,207],[252,197,194,187,174,162,153,136,125],[146,133,144,155,163,167,166,162,174]];break;case 90:j=[[171,141,145,152,154,159,163,158,177],[236,143,100,63,53,55,44,31,6],[59,48,46,44,42,54,82,112,179]];break;case 91:j=[[180,190,209,223,204,228,205,152,91],[93,125,147,172,181,224,233,198,158],[236,218,160,133,114,132,162,220,218]];break;case 92:j=[[225,183,162,135,115,111,119,145,211],[205,177,166,135,124,117,117,132,172],[186,165,155,135,126,130,150,178,226]];break;case 93:j=[[39,43,59,63,80,116,153,177,223],[39,43,59,74,91,114,139,165,223],[39,50,59,70,85,115,151,176,223]];break;case 94:j=[[0,38,60,76,84,89,101,128,204],[0,10,15,23,35,57,83,123,199],[0,11,22,40,63,86,97,94,85]];break;case 95:j=[[94,112,141,165,167,140,91,49,27],[27,46,88,135,166,161,135,97,58],[42,52,81,106,139,158,155,137,116]];break;case 96:j=[[30,49,79,117,135,151,146,138,147],[63,60,72,90,94,94,68,46,16],[18,28,41,56,62,63,50,36,21]];break;case 97:j=[[0,30,63,101,143,152,169,187,230],[0,14,28,42,58,61,67,74,91],[39,26,21,18,15,14,14,13,13]];break;case 98:j=[[149,140,164,179,182,181,131,87,61],[62,70,107,136,144,138,117,87,74],[40,38,45,49,49,49,38,32,34]];break;case 99:j=[[99,112,148,165,179,182,183,183,208],[39,40,57,79,104,127,148,161,198],[15,16,18,33,51,79,103,129,177]];break;case 100:j=[[99,116,154,174,200,196,201,201,230],[0,0,8,32,58,83,119,136,173],[5,6,7,9,9,14,17,19,24]];break;case 101:j=[[82,106,126,141,155,163,142,107,66],[62,44,69,107,135,152,149,132,119],[39,25,31,60,73,68,49,72,188]];break;case 102:j=[[18,29,44,72,116,158,184,208,221],[27,46,71,105,146,177,189,190,183],[39,55,80,108,130,133,124,100,76]];break;case 103:j=[[0,48,119,173,212,224,228,228,245],[0,13,30,47,79,127,167,205,245],[0,68,75,43,16,22,55,128,245]];break;case 104:j=[[34,70,129,187,225,226,216,193,179],[48,91,147,194,226,229,196,110,12],[234,212,216,224,206,110,53,40,29]];break;case 105:j=[[30,55,103,147,174,203,188,151,105],[0,65,138,182,187,175,121,53,9],[191,202,212,208,171,140,97,57,30]];break;case 106:j=[[112,97,113,125,138,159,178,188,225],[16,17,24,37,56,81,110,136,189],[38,35,46,59,78,103,130,152,201]];break;case 107:j=[[18,72,5,23,29,201,200,98,29],[0,0,43,167,211,117,0,0,0],[51,203,177,26,10,9,8,3,0]];break;case 108:j=[[19,42,64,88,118,147,175,187,205],[19,55,89,125,154,169,161,129,70],[19,32,47,70,100,128,145,130,75]];break;case 109:j=[[33,31,42,68,86,111,141,172,227],[255,175,145,106,88,55,15,0,0],[255,205,202,203,208,205,203,206,231]];break;case 110:j=[[0,25,50,79,110,145,181,201,254],[0,16,30,46,63,82,101,124,179],[0,12,21,29,39,49,61,74,103]];break;case 111:j=[[0,13,30,44,72,120,156,200,247],[0,36,84,117,141,153,151,158,247],[0,94,100,82,56,66,76,131,247]];break;case 112:j=[[26,51,43,33,28,35,74,144,246],[9,24,55,87,118,150,180,200,222],[30,96,112,114,112,101,72,35,0]];break;case 113:j=[[0,5,65,97,124,156,189,224,255],[32,54,77,100,123,148,175,203,234],[77,110,107,111,120,119,111,94,70]];break;default:return x()}const N=j[0],m=j[1],I=j[2],A=[];for(let R=1;R<U.length;R++){const k=Math.round(Math.floor(255*U[R])-Math.floor(255*U[R-1]));for(let J=0;J<k;J++){const _e="#"+O(N[R-1]+J*(N[R]-N[R-1])/k,1)+O(m[R-1]+J*(m[R]-m[R-1])/k,1)+O(I[R-1]+J*(I[R]-I[R-1])/k,1);A.push(_e)}}return new P(A,F)}function C(L){const F=[],U=L.split(";");for(let j=0;j<U.length;++j){const te=U[j];let N=te.indexOf(":");if(N>0){F[parseInt(te.slice(0,N))]=(0,b.yW)(`rgb(${te.slice(N+1)})`).formatHex();continue}if(N=te.indexOf("="),N>0){F[parseInt(te.slice(0,N))]=(0,b.yW)(`rgba(${te.slice(N+1)})`).formatHex8();continue}if(N=te.indexOf("#"),N<0)continue;const m=parseInt(te.slice(0,N)),I=JSON.parse(te.slice(N+1)),A={_typename:10===I[0]?z:ke,fNumber:m,fType:I[0]};let R=1;A.fCoordinateMode=Math.round(I[R++]);const k=Math.round(I[R++]);A.fColorPositions=I.slice(R,R+k),R+=k,A.fColors=I.slice(R,R+4*k),R+=4*k,A.fStart={fX:I[R++],fY:I[R++]},A.fEnd={fX:I[R++],fY:I[R++]},A._typename===ke&&R<I.length&&(A.fR1=I[R++],A.fR2=I[R++]),F[m]=A}return F}!function ie(){const L=["white","black","red","green","blue","yellow","magenta","cyan","#59d454","#5954d9","white"];L[110]="white",[{n:11,s:"c1b7ad4d4d4d6666668080809a9a9ab3b3b3cdcdcde6e6e6f3f3f3cdc8accdc8acc3c0a9bbb6a4b3a697b8a49cae9a8d9c8f83886657b1cfc885c3a48aa9a1839f8daebdc87b8f9a768a926983976e7b857d9ad280809caca6c0d4cf88dfbb88bd9f83c89a7dc08378cf5f61ac8f94a6787b946971d45a549300ff7b00ff6300ff4b00ff3300ff1b00ff0300ff0014ff002cff0044ff005cff0074ff008cff00a4ff00bcff00d4ff00ecff00fffd00ffe500ffcd00ffb500ff9d00ff8500ff6d00ff5500ff3d00ff2600ff0e0aff0022ff003aff0052ff006aff0082ff009aff00b1ff00c9ff00e1ff00f9ff00ffef00ffd700ffbf00ffa700ff8f00ff7700ff6000ff4800ff3000ff1800ff0000"},{n:201,s:"5c5c5c7b7b7bb8b8b8d7d7d78a0f0fb81414ec4848f176760f8a0f14b81448ec4876f1760f0f8a1414b84848ec7676f18a8a0fb8b814ecec48f1f1768a0f8ab814b8ec48ecf176f10f8a8a14b8b848ecec76f1f1"},{n:390,s:"ffffcdffff9acdcd9affff66cdcd669a9a66ffff33cdcd339a9a33666633ffff00cdcd009a9a00666600333300"},{n:406,s:"cdffcd9aff9a9acd9a66ff6666cd66669a6633ff3333cd33339a3333663300ff0000cd00009a00006600003300"},{n:422,s:"cdffff9affff9acdcd66ffff66cdcd669a9a33ffff33cdcd339a9a33666600ffff00cdcd009a9a006666003333"},{n:590,s:"cdcdff9a9aff9a9acd6666ff6666cd66669a3333ff3333cd33339a3333660000ff0000cd00009a000066000033"},{n:606,s:"ffcdffff9affcd9acdff66ffcd66cd9a669aff33ffcd33cd9a339a663366ff00ffcd00cd9a009a660066330033"},{n:622,s:"ffcdcdff9a9acd9a9aff6666cd66669a6666ff3333cd33339a3333663333ff0000cd00009a0000660000330000"},{n:791,s:"ffcd9acd9a669a66339a6600cd9a33ffcd66ff9a00ffcd33cd9a00ffcd00ff9a33cd66006633009a3300cd6633ff9a66ff6600ff6633cd3300ff33009aff3366cd00336600339a0066cd339aff6666ff0066ff3333cd0033ff00cdff9a9acd66669a33669a009acd33cdff669aff00cdff339acd00cdff009affcd66cd9a339a66009a6633cd9a66ffcd00ff6633ffcd00cd9a00ffcd33ff9a00cd66006633009a3333cd6666ff9a00ff9a33ff6600cd3300ff339acdff669acd33669a00339a3366cd669aff0066ff3366ff0033cd0033ff339aff0066cd00336600669a339acd66cdff009aff33cdff009acd00cdffcd9aff9a66cd66339a66009a9a33cdcd66ff9a00ffcd33ff9a00cdcd00ff9a33ff6600cd33006633009a6633cd9a66ff6600ff6633ff3300cd3300ffff339acd00666600339a0033cd3366ff669aff0066ff3366cd0033ff0033ff9acdcd669a9a33669a0066cd339aff66cdff009acd009aff33cdff009a"},{n:920,s:"cdcdcd9a9a9a666666333333"}].forEach(U=>{const j=U.s;for(let te=0;te<j.length;te+=6)L[U.n+te/6]="#"+j.slice(te,te+6)}),ce=L}()},3693:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Dx:()=>z,YI:()=>ke,rr:()=>xe});var ve=Ee(6998),b=Ee(8977);function z(et,Je){et.$math=b;let Xe=et.fTitle,ot=!1,Re="[";if("gaus"===Xe&&(Xe="gaus(0)"),(0,ve.isStr)(et.fFormula?.fFormula)&&(0===et.fFormula.fFormula.indexOf("[](double*x,double*p)")?(ot=!0,Re="p[",Xe=et.fFormula.fFormula.slice(21)):(Xe=et.fFormula.fFormula,Re="[p"),et.fFormula.fClingParameters&&et.fFormula.fParams&&et.fFormula.fParams.forEach(He=>{const Ie=new RegExp(`(\\[${He.first}\\])`,"g"),O=et.fFormula.fClingParameters[He.second];Xe=Xe.replace(Ie,O<0?`(${O})`:O)})),!Xe)return!Je||et.fSave?.length>2;if(et.formulas?.forEach(He=>{Xe=Xe.replaceAll(He.fName,He.fTitle)}),Xe=Xe.replace(/\b(TMath::SinH)\b/g,"Math.sinh").replace(/\b(TMath::CosH)\b/g,"Math.cosh").replace(/\b(TMath::TanH)\b/g,"Math.tanh").replace(/\b(TMath::ASinH)\b/g,"Math.asinh").replace(/\b(TMath::ACosH)\b/g,"Math.acosh").replace(/\b(TMath::ATanH)\b/g,"Math.atanh").replace(/\b(TMath::ASin)\b/g,"Math.asin").replace(/\b(TMath::ACos)\b/g,"Math.acos").replace(/\b(TMath::Atan)\b/g,"Math.atan").replace(/\b(TMath::ATan2)\b/g,"Math.atan2").replace(/\b(sin|SIN|TMath::Sin)\b/g,"Math.sin").replace(/\b(cos|COS|TMath::Cos)\b/g,"Math.cos").replace(/\b(tan|TAN|TMath::Tan)\b/g,"Math.tan").replace(/\b(exp|EXP|TMath::Exp)\b/g,"Math.exp").replace(/\b(log|LOG|TMath::Log)\b/g,"Math.log").replace(/\b(log10|LOG10|TMath::Log10)\b/g,"Math.log10").replace(/\b(pow|POW|TMath::Power)\b/g,"Math.pow").replace(/\b(pi|PI)\b/g,"Math.PI").replace(/\b(abs|ABS|TMath::Abs)\b/g,"Math.abs").replace(/\bsqrt\(/g,"Math.sqrt(").replace(/\bxygaus\(/g,"this.$math.gausxy(this, x, y, ").replace(/\bgaus\(/g,"this.$math.gaus(this, x, ").replace(/\bgausn\(/g,"this.$math.gausn(this, x, ").replace(/\bexpo\(/g,"this.$math.expo(this, x, ").replace(/\blandau\(/g,"this.$math.landau(this, x, ").replace(/\blandaun\(/g,"this.$math.landaun(this, x, ").replace(/\b(TMath::|ROOT::Math::)/g,"this.$math."),Xe.match(/^pol[0-9]$/)&&parseInt(Xe[3])===et.fNpar-1){Xe="[0]";for(let He=1;He<et.fNpar;++He)Xe+=` + [${He}] * `+(1===He?"x":`Math.pow(x,${He})`)}if(Xe.match(/^chebyshev[0-9]$/)&&parseInt(Xe[9])===et.fNpar-1){Xe=`this.$math.ChebyshevN(${et.fNpar-1}, x, `;for(let He=0;He<et.fNpar;++He)Xe+=(0===He?"[":", ")+`[${He}]`;Xe+="])"}for(let He=0;He<et.fNpar;++He)Xe=Xe.replaceAll(Re+He+"]",`(${et.GetParValue(He)})`);for(let He=2;He<10;++He)Xe=Xe.replaceAll(`x^${He}`,`Math.pow(x,${He})`);return ot?(Xe=Xe.replace(/x\[0\]/g,"x"),et._typename===ve.clTF3?(Xe=Xe.replace(/x\[1\]/g,"y"),Xe=Xe.replace(/x\[2\]/g,"z"),et.evalPar=new Function("x","y","z",Xe).bind(et)):et._typename===ve.clTF2?(Xe=Xe.replace(/x\[1\]/g,"y"),et.evalPar=new Function("x","y",Xe).bind(et)):et.evalPar=new Function("x",Xe).bind(et)):et.evalPar=et._typename===ve.clTF3?new Function("x","y","z","return "+Xe).bind(et):et._typename===ve.clTF2?new Function("x","y","return "+Xe).bind(et):new Function("x","return "+Xe).bind(et),!0}function ke(et,Je){const Xe=et.fSave.length-3,ot=et.fSave[Xe+1],Re=et.fSave[Xe+2],He=(Re-ot)/Xe;if(Je<ot)return et.fSave[0];if(Je>Re)return et.fSave[Xe];const Ie=Math.min(Xe-1,Math.floor((Je-ot)/He));let O=ot+Ie*He,ce=O+He,ie=et.fSave[Ie],he=et.fSave[Ie+1];return!Number.isFinite(ie)&&Ie<Xe-1?(O+=He,ce+=He,ie=he,he=et.fSave[Ie+2]):!Number.isFinite(he)&&Ie>0&&(ce-=He,O-=He,he=ie,ie=et.fSave[Ie-1]),(ce*ie-O*he+Je*(he-ie))/He}function xe(et,Je,Xe=void 0){let ot=0,Re=!1;if(!et)return 0;if(!Xe&&!et.evalPar)try{z(et)||(Re=!0)}catch{Re=!0}if(et.evalPar&&!Re)try{return ot=et.evalPar(Je),ot}catch{ot=0}const He=et.fSave.length-3;return He<2||et.fSave[He+1]===et.fSave[He+2]?0:ke(et,Je)}},1969:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Bm:()=>V,KA:()=>le,N7:()=>Re,_o:()=>j,cp:()=>he,eN:()=>fe,s7:()=>N,xV:()=>Je});var ve=Ee(467),b=Ee(6998),z=Ee(9041),ke=Ee(528);const xe={"#alpha":"\u03b1","#beta":"\u03b2","#chi":"\u03c7","#delta":"\u03b4","#varepsilon":"\u03b5","#phi":"\u03c6","#gamma":"\u03b3","#eta":"\u03b7","#iota":"\u03b9","#varphi":"\u03c6","#kappa":"\u03ba","#lambda":"\u03bb","#mu":"\u03bc","#nu":"\u03bd","#omicron":"\u03bf","#pi":"\u03c0","#theta":"\u03b8","#rho":"\u03c1","#sigma":"\u03c3","#tau":"\u03c4","#upsilon":"\u03c5","#varomega":"\u03d6","#omega":"\u03c9","#xi":"\u03be","#psi":"\u03c8","#zeta":"\u03b6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03a7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03a6","#Gamma":"\u0393","#Eta":"\u0397","#Iota":"\u0399","#vartheta":"\u03d1","#Kappa":"\u039a","#Lambda":"\u039b","#Mu":"\u039c","#Nu":"\u039d","#Omicron":"\u039f","#Pi":"\u03a0","#Theta":"\u0398","#Rho":"\u03a1","#Sigma":"\u03a3","#Tau":"\u03a4","#Upsilon":"\u03a5","#varsigma":"\u03c2","#Omega":"\u03a9","#Xi":"\u039e","#Psi":"\u03a8","#Zeta":"\u0396","#varUpsilon":"\u03d2","#epsilon":"\u03b5","#leq":"\u2264","#/":"\u2044","#infty":"\u221e","#voidb":"\u0192","#club":"\u2663","#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u2e30","#pm":"\xb1","#doublequote":"\u2033","#geq":"\u2265","#times":"\xd7","#propto":"\u221d","#partial":"\u2202","#bullet":"\u2022","#divide":"\xf7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"|","#topbar":"\xaf","#downleftarrow":"\u21b5","#aleph":"\u2135","#Jgothic":"\u2111","#Rgothic":"\u211c","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222a","#supset":"\u2283","#supseteq":"\u2287","#notsubset":"\u2284","#subset":"\u2282","#subseteq":"\u2286","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\xae","#ocopyright":"\xa9","#trademark":"\u2122","#prod":"\u220f","#surd":"\u221a","#upoint":"\u2027","#corner":"\xac","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21d4","#Leftarrow":"\u21d0","#Uparrow":"\u21d1","#Rightarrow":"\u21d2","#Downarrow":"\u21d3","#void2":"","#LT":"<","#void1":"\xae","#copyright":"\xa9","#void3":"\u2122","#sum":"\u2211","#arctop":"\u239b","#lbar":"\u23a2","#arcbottom":"\u239d","#void4":"","#void8":"\u23a2","#bottombar":"\u230a","#arcbar":"\u23a7","#ltbar":"\u23a8","#AA":"\u212b","#aa":"\xe5","#void06":"","#GT":">","#int":"\u222b","#forall":"\u2200","#exists":"\u2203","#koppa":"\u03df","#sampi":"\u03e1","#stigma":"\u03db","#san":"\u03fb","#sho":"\u03f8","#varcoppa":"\u03d9","#digamma":"\u03dd","#Digamma":"\u03dc","#Koppa":"\u03de","#varKoppa":"\u03d8","#Sampi":"\u03e0","#Stigma":"\u03da","#San":"\u03fa","#Sho":"\u03f7","#vec":"","#dot":"\u22c5","#hat":"\xb7","#ddot":"","#acute":"","#grave":"","#check":"\u2713","#tilde":"\u02dc","#slash":"\u2044","#hbar":"\u0127","#box":"\u25fd","#Box":"\u2610","#parallel":"\u2225","#perp":"\u22a5","#odot":"\u2299","#left":"","#right":"","{}":"","#mp":"\u2213","#P":"\xb6","#sqrt":"\u221a","#bar":"","#overline":"","#underline":"","#strike":""},et=new RegExp(Object.keys(xe).sort((I,A)=>I.length<A.length?1:I.length>A.length?-1:0).join("|"),"g"),Je=I=>{for(;I.length>2&&"{"===I[0]&&"}"===I[I.length-1];)I=I.slice(1,I.length-1);return I.replace(et,A=>xe[A]).replace(/\{\}/g,"")},Xe=[453,535,661,973,955,1448,1242,324,593,596,778,1011,431,570,468,492,947,885,947,947,947,947,947,947,947,947,511,495,980,1010,987,893,1624,1185,1147,1193,1216,1080,1028,1270,1274,531,910,1177,1004,1521,1252,1276,1111,1276,1164,1056,1073,1215,1159,1596,1150,1124,1065,540,591,540,837,874,572,929,972,879,973,901,569,967,973,453,458,903,453,1477,973,970,972,976,638,846,548,973,870,1285,884,864,835,656,430,656,1069],ot={945:1002,946:996,967:917,948:953,949:834,966:1149,947:847,951:989,953:516,954:951,955:913,956:1003,957:862,959:967,960:1070,952:954,961:973,963:1017,964:797,965:944,982:1354,969:1359,958:803,968:1232,950:825,913:1194,914:1153,935:1162,916:1178,917:1086,934:1358,915:1016,919:1275,921:539,977:995,922:1189,923:1170,924:1523,925:1253,927:1281,928:1281,920:1285,929:1102,931:1041,932:1069,933:1135,962:848,937:1279,926:1092,936:1334,918:1067,978:1154,8730:986,8804:940,8260:476,8734:1453,402:811,9827:1170,9830:931,9829:1067,9824:965,8596:1768,8592:1761,8593:895,8594:1761,8595:895,710:695,177:955,8243:680,8805:947,215:995,8733:1124,8706:916,8226:626,247:977,8800:969,8801:1031,8776:976,8230:1552,175:883,8629:1454,8501:1095,8465:1002,8476:1490,8472:1493,8855:1417,8853:1417,8709:1205,8745:1276,8746:1404,8839:1426,8835:1426,8836:1426,8838:1426,8834:1426,8747:480,8712:1426,8713:1426,8736:1608,8711:1551,174:1339,169:1339,8482:1469,8719:1364,729:522,172:1033,8743:1383,8744:1383,8660:1768,8656:1496,8657:1447,8658:1496,8659:1447,8721:1182,9115:882,9144:1e3,9117:882,8970:749,9127:1322,9128:1322,8491:1150,229:929,8704:1397,8707:1170,8901:524,183:519,10003:1477,732:692,295:984,9725:1780,9744:1581,8741:737,8869:1390,8857:1421};function Re(I,A,R){const k=I.length,J=(R||A.size)*A.aver_width;if(A.isMonospace())return k*J;let _e=0;for(let be=0;be<k;++be){const Te=I.charCodeAt(be);_e+=Te>=32&&Te<127?Xe[Te-32]:ot[Te]||1e3}return _e/1e3*J}const He=[{name:"#it{"},{name:"#bf{"},{name:"#underline{",deco:"underline"},{name:"#overline{",deco:"overline"},{name:"#strike{",deco:"line-through"},{name:"#kern[",arg:"float"},{name:"#lower[",arg:"float"},{name:"#scale[",arg:"float"},{name:"#color[",arg:"int"},{name:"#font[",arg:"int"},{name:"_{",low_up:"low"},{name:"^{",low_up:"up"},{name:"#bar{",deco:"overline"},{name:"#hat{",accent:"\u02c6",hasw:!0},{name:"#check{",accent:"\u02c7",hasw:!0},{name:"#acute{",accent:"\u02ca"},{name:"#grave{",accent:"\u02cb"},{name:"#dot{",accent:"\u02d9"},{name:"#ddot{",accent:"\u02ba",hasw:!0},{name:"#tilde{",accent:"\u02dc",hasw:!0},{name:"#slash{",accent:"\u2215"},{name:"#vec{",accent:"\u02ed",hasw:!0},{name:"#frac{",twolines:"line"},{name:"#splitline{",twolines:!0},{name:"#sqrt[",arg:"int",sqrt:!0},{name:"#sqrt{",sqrt:!0},{name:"#sum",special:"\u2211",w:.8,h:.9},{name:"#int",special:"\u222b",w:.3,h:1},{name:"#left[",right:"#right]",braces:"[]"},{name:"#left(",right:"#right)",braces:"()"},{name:"#left{",right:"#right}",braces:"{}"},{name:"#left|",right:"#right|",braces:"||"},{name:"#[]{",braces:"[]"},{name:"#(){",braces:"()"},{name:"#{}{",braces:"{}"},{name:"#||{",braces:"||"}],Ie=[0,8704,0,8707,0,0,8717,0,0,8727,0,0,8722,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8773,913,914,935,916,917,934,915,919,921,977,922,923,924,925,927,928,920,929,931,932,933,962,937,926,936,918,0,8756,0,8869,0,0,945,946,967,948,949,966,947,951,953,981,954,955,956,957,959,960,952,961,963,964,965,982,969,958,968,950,0,402,0,8764,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,978,8242,8804,8260,8734,0,9827,9830,9829,9824,8596,8592,8593,8594,8595,0,0,8243,8805,0,8733,8706,8729,0,8800,8801,8776,8230,0,0,8629,8501,8465,8476,8472,8855,8853,8709,8745,8746,8835,8839,8836,8834,8838,8712,8713,8736,8711,0,0,8482,8719,8730,8901,0,8743,8744,8660,8656,8657,8658,8659,9674,9001,0,0,8482,8721,0,0,0,0,0,0,0,0,0,0,8364,9002,8747,8992,0,8993],O=[128393,9986,9985,128083,128365,128366,128367,128383,9990,128386,128387,128234,128235,128236,128237,128193,128194,128196,128463,128464,128452,8987,128430,128432,128434,128435,128436,128427,128428,9991,9997,128398,9996,128076,128077,128078,9756,9758,9757,9759,128400,9786,128528,9785,128163,9760,127987,127985,9992,9788,128167,10052,128326,10014,128328,10016,10017,9770,9775,2384,9784,9800,9801,9802,9803,9804,9805,9806,9807,9808,9809,9810,9811,128624,128629,9679,128318,9632,9633,128912,10065,10066,11047,10731,9670,10070,11045,8999,11193,8984,127989,127990,128630,128631,0,9450,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9471,10102,10103,10104,10105,10106,10107,10108,10109,10110,10111,128610,128608,128609,128611,128606,128604,128605,128607,183,8226,9642,9898,128902,128904,9673,9678,128319,9642,9723,128962,10022,9733,10038,10036,10041,10037,11216,8982,10209,8977,11217,10026,10032,128336,128337,128338,128339,128340,128341,128342,128343,128344,128345,128346,128347,11184,11185,11186,11187,11188,11189,11190,11191,128618,128619,128597,128596,128599,128598,128592,128593,128594,128595,9003,8998,11160,11162,11161,11163,11144,11146,11145,11147,129128,129130,129129,129131,129132,129133,129135,129134,129144,129146,129145,129147,129148,129149,129151,129150,8678,8680,8679,8681,11012,8691,11008,11009,11011,11010,129196,129197,128502,10004,128503,128505],ce={};function ie(I){if(!ce[945]){let A=0;for(const R in xe){const k=xe[R];if(1===k.length){let J=0;if(A<54)J=97+A,A>25&&(J-=58),52===A&&(J=161),53===A&&(J=206);else{const be=A-54;switch(J=163+be,be){case 75:J=197;break;case 76:J=229;break;case 80:J=34;break;case 81:J=36}}const _e=k.charCodeAt(0);_e>128&&(ce[_e]=J)}if(++A>136)break}}return ce[I]??I}function he(I){if(1!==I.childNodes.length)return!1;const A=I.textContent;if(!A)return!1;let R="",k=-1;for(let J=0;J<A.length;J++){const _e=A.charCodeAt(J),be=ie(_e);_e!==be&&(R+=A.slice(k+1,J)+'<tspan font-family="symbol" font-style="normal" font-weight="normal">'+String.fromCharCode(be)+"</tspan>",k=J)}return!(k<0||(k<A.length-1&&(R+=A.slice(k+1,A.length)),I.$originalHTML=I.innerHTML,I.innerHTML=R,0))}function ue(I,A){const R="Wingdings"===A?O:Ie;let k="";for(let J=0;J<I.length;++J){const _e=I.charCodeAt(J);k+=String.fromCodePoint((_e>32?R[_e-33]:0)||_e)}return k}function fe(I,A,R){R.plain=!0,R.simple_latex&&(R.text=Je(R.text)),A.text(R.font&&R.font.isSymbol?ue(R.text,R.font.isSymbol):R.text)}function le(I){return!I||I.indexOf("#")<0&&I.indexOf("{")<0}function Y(I,A,R,k){let J=0;const _e=()=>(k.g||(k.g=I.append("svg:g")),k.g),be=Ue=>{k.x+=Math.round(Ue)},Te=(Ue,Oe,lt,gt)=>{k.rect?(k.rect.x1=Math.min(k.rect.x1,Ue),k.rect.y1=Math.min(k.rect.y1,Oe),k.rect.x2=Math.max(k.rect.x2,lt),k.rect.y2=Math.max(k.rect.y2,gt)):k.rect={x1:Ue,y1:Oe,x2:lt,y2:gt},k.rect.last_y1=Oe,k.rect.width=k.rect.x2-k.rect.x1,k.rect.height=k.rect.y2-k.rect.y1,k.parent||(A.text_rect=k.rect)},Pe=Ue=>{Te(k.x,k.y,k.x+Ue*k.fsize*.4,k.y),be(Ue*k.fsize*.4)},We=(Ue,Oe,lt,gt)=>{Oe=Math.round(Oe),lt=Math.round(lt),(0,z.bk)(Ue.g,Oe,lt),Ue.rect.x1+=Oe,Ue.rect.x2+=Oe,Ue.rect.y1+=lt,Ue.rect.y2+=lt,gt?Te(k.x+Ue.rect.x1,k.y+Ue.rect.y1,k.x+Ue.rect.x2,k.y+Ue.rect.y2):Te(Ue.rect.x1,Ue.rect.y1,Ue.rect.x2,Ue.rect.y2)},dt=()=>{const Ue=_e();return 1!==J||R||k.x||k.y?(0,z.bk)(Ue.append("svg:g"),k.x,k.y):Ue},Q=(Ue,Oe,lt)=>{let gt=0,ht=1,st=!1;Oe||(Oe="{"),lt||(lt="}");const yt=Ot=>gt+Ot.length<=R.length&&R.slice(gt,gt+Ot.length)===Ot;if(Ue){if(!yt(Oe))return console.log(`not starting with ${Oe} in ${R}`),-1;R=R.slice(Oe.length)}for(;0!==ht&&gt<R.length;)yt(Oe)?(ht++,gt+=Oe.length):yt(lt)?(ht--,gt+=lt.length,0===ht&&"string"==typeof Ue&&yt(Ue+Oe)&&(ht++,gt+=Oe.length+Ue.length,Ue=!0,st=!0)):gt++;if(0!==ht)return console.log(`mismatch with open ${Oe} and closing ${lt} in ${R}`),-1;let Kt=R.slice(0,gt-lt.length);return st&&(Kt=Oe+Kt+lt),R=R.slice(gt),Kt},Ke=(Ue,Oe,lt)=>Ue.append("svg:path").style("stroke",lt?"none":k.color||A.color).style("stroke-width",lt?null:Math.max(1,Math.round(k.fsize*(k.font.weight?.1:.07)))).style("fill",lt?k.color||A.color:"none").attr("d",Oe??null),Ze=Ue=>({lvl:k.lvl+1,x:0,y:0,fsize:k.fsize*(Ue||1),color:k.color,font:k.font,parent:k,painter:k.painter});for(;R;){let Ue=R.length,Oe=null;for(let ht=0;ht<He.length;++ht){const st=R.indexOf(He[ht].name);st>=0&&st<Ue&&(Ue=st,Oe=He[ht])}if(Ue>0){const ht=Ue===R.length&&0===J&&!Oe;J++;let st=Je(R.slice(0,Ue)),yt=0,Kt=0;for(;yt<st.length&&" "===st[yt];)yt++;for(yt>0&&(Pe(yt),st=st.slice(yt));Kt<st.length&&" "===st[st.length-1-Kt];)Kt++;if(Kt>0&&(st=st.slice(0,st.length-Kt)),st||ht){const It=(k.g||(ht?I:_e())).append("svg:text");ht&&!k.g&&(k.g=It),k.ufont&&(k.font.setPainter(A.painter),k.font.setFont(k.g)),void 0!==k.bold&&k.g.attr("font-weight",k.bold?"bold":"normal"),void 0!==k.italic&&k.g.attr("font-style",k.italic?"italic":"normal"),It.attr("fill",k.color||A.color||null),k.fisze!==k.font.size&&It.attr("font-size",Math.round(k.fsize)),It.text(k.font&&k.font.isSymbol?ue(st,k.font.isSymbol):st);const An=(0,b.isNodeJs)()||b.settings.ApproxTextSize||A.fast?{height:1.2*k.fsize,width:Re(st,k.font,k.fsize)}:(0,z.xh)(It,"nopadding");k.x&&It.attr("x",k.x),k.y&&It.attr("y",k.y);const on=1===st.length&&!k.font.isMonospace()&&"lfij".indexOf(st)>=0?.1*k.fsize:0;Te(k.x,k.y-.8*An.height,k.x+An.width,k.y+.2*An.height),ht?k.deco?(It.attr("text-decoration",k.deco),delete k.deco):k.xgap=on:(be(An.width+on),Pe(Kt),k.xgap=0)}else Pe(Kt)}if(!Oe)return!0;if(R=R.slice(Ue+Oe.name.length),J++,Oe.accent){const ht=Q();if(-1===ht)return!1;const st=dt(),yt=Ze(),Kt=1!==ht.length?1:ht>="a"&&ht<="z"&&"tdbfhkli".indexOf(ht)<0?.75:.9;Y(st,A,ht,yt);const Ot=.6*k.fsize,It=Math.round(yt.rect.y1*Kt),An=Math.round(.1*k.fsize),on=2*An,pn=`a${An},${An},0,0,1,${on},0a${An},${An},0,0,1,${-on},0z`;let Qt=0,Bn=yt.rect.width;Oe.hasw&&Bn<Ot&&(Bn=Ot,Qt=(Ot-yt.rect.width)/2);const dn=Math.round(.5*Bn),yn=Math.round(.3*Bn),Tn=dn-yn,Hn=dn+yn;switch(Bn=2*dn,We(yt,Qt,0,!0),Oe.name){case"#check{":Ke(st,`M${Tn},${It-on}L${dn},${It}L${Hn},${It-on}`);break;case"#acute{":Ke(st,`M${dn},${It}l${on},${-on}`);break;case"#grave{":Ke(st,`M${dn},${It}l${-on},${-on}`);break;case"#dot{":Ke(st,`M${dn-An},${It}${pn}`,!0);break;case"#ddot{":Ke(st,`M${dn-3*An},${It}${pn} M${dn+An},${It}${pn}`,!0);break;case"#tilde{":Ke(st,`M${Tn},${It} a${yn},${on},0,0,1,${yn},0 a${yn},${on},0,0,0,${yn},0`);break;case"#slash{":Ke(st,`M${Bn},${It}L0,${Math.round(yt.rect.y2)}`);break;case"#vec{":Ke(st,`M${Tn},${It}H${Hn}M${Hn-on},${It-on}l${on},${on}l${-on},${on}`);break;default:Ke(st,`M${Tn},${It}L${dn},${It-on}L${Hn},${It}`)}be(yt.rect.width+(yt.xgap??0));continue}if(Oe.twolines){k.twolines=!0;const ht=Q(),st=Q(!0);if(-1===ht||-1===st)return!1;const yt=dt(),Kt=k.parent&&k.parent.twolines?.7:1,Ot=Ze(Kt);Y(yt,A,ht,Ot);const It="line"===Oe.twolines?Ke(yt):null,An=Ze(Kt);Y(yt,A,st,An);const on=Math.max(Ot.rect.width,An.rect.width),pn=Ot.rect.width-An.rect.width,Qt=.35*-k.fsize;We(Ot,pn<0?-pn/2:0,Qt-Ot.rect.y2,!0),We(An,pn>0?pn/2:0,Qt-An.rect.y1,!0),It&&It.attr("d",`M0,${Math.round(Qt)}h${Math.round(on-.1*k.fsize)}`),be(on),delete k.twolines;continue}const lt=ht=>{const st={};if(ht&&(R="{"+R,st[ht]=Q("low"===ht?"_":"^"),-1===st[ht]))return!1;for(;R;)if("_"===R[0]){if(R=R.slice(1),st.low=st.low?-1:Q("_"),-1===st.low)return console.log(`error with ${Oe.name} low limit`),!1}else{if("^"!==R[0])break;if(R=R.slice(1),st.up=st.up?-1:Q("^"),-1===st.up)return console.log(`error with ${Oe.name} upper limit ${R}`),!1}return st};if(Oe.low_up){const ht=lt(Oe.low_up);if(!ht)return!1;const st=k.x,yt=.03*k.fsize,Kt=.25*k.fsize;let Ot,It,An=0,on=0,pn=-k.fsize;ht.up&&(Ot=Ze(.6),Y(_e(),A,ht.up,Ot)),ht.low&&(It=Ze(.6),Y(_e(),A,ht.low,It)),Ot&&(It||(pn=Math.min(pn,k.rect.last_y1)),We(Ot,st+yt,pn-Ot.rect.y1-.1*k.fsize),An=Ot.rect.width),It&&(We(It,st+yt,Kt-It.rect.y2+.1*k.fsize),on=It.rect.width),be(yt+Math.max(An,on));continue}if(Oe.special){const ht=lt()||{},st=dt(),yt=Ke(st),Kt=Math.round(1.7*k.fsize),Ot=Math.round(k.fsize),It=Math.round(.1*Kt);let An,on;if("#sum"===Oe.name?(An=on=Ot/2,yt.attr("d",`M${Ot},${Math.round(-.75*Kt)}h${-Ot}l${Math.round(.4*Ot)},${Math.round(.3*Kt)}l${Math.round(-.4*Ot)},${Math.round(.7*Kt)}h${Ot}`)):(An=3*It,on=It,yt.attr("d",`M0,${Math.round(.25*Kt-It)}a${It},${It},0,0,0,${2*It},0v${2*It-Kt}a${It},${It},0,1,1,${2*It},0`)),Te(k.x,k.y-.6*Kt,k.x+Ot,k.y+.4*Kt),ht.low){const pn=Ze(.6);Y(st,A,ht.low,pn),We(pn,on-pn.rect.width/2,.25*Kt-pn.rect.y1,!0)}if(ht.up){const pn=Ze(.6);Y(st,A,ht.up,pn),We(pn,An-pn.rect.width/2,-.75*Kt-pn.rect.y2,!0)}be(Ot);continue}if(Oe.braces){const ht=Oe.right,yt=Q(!1,ht?Oe.name:"{",ht),Kt=dt(),Ot=Ze(),It=Ke(Kt);Y(Kt,A,yt,Ot);const An=Ke(Kt),on=Math.max(2,Math.round(.2*k.fsize)),pn=Ot.rect,Qt=Math.round(pn.y2-pn.y1),Bn=Math.round(pn.y1),dn=Math.round(pn.width);switch(Oe.braces){case"||":It.attr("d",`M${on},${Bn}v${Qt}`),An.attr("d",`M${3*on+dn},${Bn}v${Qt}`);break;case"[]":It.attr("d",`M${2*on},${Bn}h${-on}v${Qt}h${on}`),An.attr("d",`M${2*on+dn},${Bn}h${on}v${Qt}h${-on}`);break;case"{}":It.attr("d",`M${2*on},${Bn}a${on},${on},0,0,0,${-on},${on}v${Qt/2-2*on}a${on},${on},0,0,1,${-on},${on}a${on},${on},0,0,1,${on},${on}v${Qt/2-2*on}a${on},${on},0,0,0,${on},${on}`),An.attr("d",`M${2*on+dn},${Bn}a${on},${on},0,0,1,${on},${on}v${Qt/2-2*on}a${on},${on},0,0,0,${on},${on}a${on},${on},0,0,0,${-on},${on}v${Qt/2-2*on}a${on},${on},0,0,1,${-on},${on}`);break;default:It.attr("d",`M${on},${Bn}a${4*Qt},${4*Qt},0,0,0,0,${Qt}`),An.attr("d",`M${3*on+dn},${Bn}a${4*Qt},${4*Qt},0,0,1,0,${Qt}`)}We(Ot,2*on,0,!0),Te(k.x,k.y+pn.y1,k.x+4*on+pn.width,k.y+pn.y2),be(4*on+pn.width);continue}if(Oe.deco){const ht=Q(),st=dt(),yt=Ze();yt.deco=Oe.deco,Y(st,A,ht,yt);const Kt=yt.rect;if(yt.deco){const Ot=Ke(st),It=Math.round(Kt.width);switch(yt.deco){case"underline":Ot.attr("d",`M0,${Math.round(Kt.y2)}h${It}`);break;case"overline":Ot.attr("d",`M0,${Math.round(Kt.y1)}h${It}`);break;case"line-through":Ot.attr("d",`M0,${Math.round(.45*Kt.y1+.55*Kt.y2)}h${It}`)}}We(yt,0,0,!0),be(Kt.width);continue}if("#bf{"===Oe.name||"#it{"===Oe.name){const ht=Q();if(-1===ht)return!1;const st=Ze();"#bf{"===Oe.name?st.bold=!st.bold:st.italic=!st.italic,Y(_e(),A,ht,st),We(st,k.x,k.y),be(st.rect.width);continue}let gt=0;if(Oe.arg){const ht=R.indexOf("]{");if(ht<0)return console.log("missing argument for ",Oe.name),!1;if(gt=R.slice(0,ht),"int"===Oe.arg){if(gt=parseInt(gt),!Number.isInteger(gt))return console.log("wrong int argument",R.slice(0,ht)),!1}else if("float"===Oe.arg&&(gt=parseFloat(gt),!Number.isFinite(gt)))return console.log("wrong float argument",R.slice(0,ht)),!1;R=R.slice(ht+2)}if("#kern["!==Oe.name&&"#lower["!==Oe.name)if("#color["!==Oe.name&&"#scale["!==Oe.name&&"#font["!==Oe.name){if(Oe.sqrt){const ht=Q();if(-1===ht)return!1;const st=dt(),yt=Ze();let Kt;Oe.arg&&(Kt=Ze(.7),Y(st,A,gt.toString(),Kt));const Ot=Ke(st);Y(st,A,ht,yt);const It=yt.rect,An=Math.round(It.height),on=Math.round(.1*It.height),pn=Math.round(It.width),Qt=Math.round((It.y1+It.y2)/2),Bn=Math.round(.2*k.fsize),dn=Math.round(It.y2);Kt&&We(Kt,0,Qt-.3*Kt.fsize,!0),Ot.attr("d",`M0,${Qt}h${on}l${on},${dn-Qt-Bn}l${on},${-An+Bn}h${Math.round(.2*An+pn)}v${on}`),We(yt,.4*An,0,!0),Te(k.x,k.y+It.y1-.1*k.fsize,k.x+pn+.6*An,k.y+It.y2),be(pn+.6*An)}}else{const ht=Q();if(-1===ht)return!1;const st=Ze();"#color["===Oe.name?st.color=k.painter.getColor(gt):"#font["===Oe.name?(st.font=new ke.qg(gt),st.ufont=!0):st.fsize*=gt,Y(_e(),A,ht,st),We(st,k.x,k.y),be(st.rect.width)}else{const ht=Q();if(-1===ht)return!1;const st=Ze();Y(_e(),A,ht,st);let yt=0,Kt=0;"kern["===Oe.name?yt=gt:Kt=gt,We(st,k.x+yt*st.rect.width,k.y+Kt*st.rect.height),be(st.rect.width*(yt>0?1+gt:1))}}return!0}function V(I,A,R){return Y(A,R,R.text,{lvl:0,g:A,x:0,y:0,dx:0,dy:-.1,fsize:R.font_size,font:R.font,parent:null,painter:I})}let D;function w(){return P.apply(this,arguments)}function P(){return(P=(0,ve.A)(function*(){const I=void 0!==D;if(!I&&typeof globalThis.MathJax<"u")return globalThis.MathJax;I||(D=[]);const A=new Promise(J=>{D?D.push(J):J(globalThis.MathJax)});if(I)return A;const R={scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipAttributes:{},exFactor:.5,displayAlign:"center",displayIndent:"0",fontCache:"local",localID:null,internalSpeechTitles:!0,titleID:0};if(!(0,b.isNodeJs)()){window.MathJax={options:{enableMenu:!1},loader:{load:["[tex]/color","[tex]/upgreek","[tex]/mathtools","[tex]/physics"]},tex:{packages:{"[+]":["color","upgreek","mathtools","physics"]}},svg:R,startup:{ready(){MathJax.startup.defaultReady();const _e=D;D=void 0,_e.forEach(be=>be(globalThis.MathJax))}}};let J="../mathjax/3.2.0";return b.browser.webwindow&&b.source_dir.indexOf("https://root.cern/js")<0&&b.source_dir.indexOf("https://jsroot.gsi.de")<0&&(J="mathjax"),(0,b.loadScript)(b.source_dir+J+"/es5/tex-svg.js").catch(()=>(0,b.loadScript)("https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-svg.js")).then(()=>A)}let k;return(0,z.lf)().then(J=>(k=J.JSDOM,Ee.e(925).then(Ee.t.bind(Ee,925,19)))).then(J=>(J.init({loader:{load:["input/tex","output/svg","[tex]/color","[tex]/upgreek","[tex]/mathtools","[tex]/physics"]},tex:{packages:{"[+]":["color","upgreek","mathtools","physics"]}},svg:R,config:{JSDOM:k},startup:{typeset:!1,ready(){const _e=MathJax;_e.startup.registerConstructor("jsdomAdaptor",()=>new _e._.adaptors.HTMLAdaptor.HTMLAdaptor((new _e.config.config.JSDOM).window)),_e.startup.useAdaptor("jsdomAdaptor",!0),_e.startup.defaultReady();const be=D;D=void 0,be.forEach(Te=>Te(_e))}}}),A))})).apply(this,arguments)}const x={"#LT":"\\langle","#GT":"\\rangle","#club":"\\clubsuit","#spade":"\\spadesuit","#heart":"\\heartsuit","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re","#doublequote":'"',"#plus":"+","#minus":"-","#/":"/","#upoint":".","#aa":"\\mathring{a}","#AA":"\\mathring{A}","#omicron":"o","#Alpha":"A","#Beta":"B","#Epsilon":"E","#Zeta":"Z","#Eta":"H","#Iota":"I","#Kappa":"K","#Mu":"M","#Nu":"N","#Omicron":"O","#Rho":"P","#Tau":"T","#Chi":"X","#varomega":"\\varpi","#corner":"?","#ltbar":"?","#bottombar":"?","#notsubset":"?","#arcbottom":"?","#cbar":"?","#arctop":"?","#topbar":"?","#arcbar":"?","#downleftarrow":"?","#splitline":"\\genfrac{}{}{0pt}{}","#it":"\\textit","#bf":"\\textbf","#frac":"\\frac","#left{":"\\lbrace","#right}":"\\rbrace","#left\\[":"\\lbrack","#right\\]":"\\rbrack","#\\[\\]{":"\\lbrack"," } ":"\\rbrack","#\\[":"\\lbrack","#\\]":"\\rbrack","#{":"\\lbrace","#}":"\\rbrace"," ":"\\;"},v={upDelta:"Updelta",upGamma:"Upgamma",upLambda:"Uplambda",upOmega:"Upomega",upPhi:"Upphi",upPi:"Uppi",upPsi:"Uppsi",upSigma:"Upsigma",upTheta:"Uptheta",upUpsilon:"Upupsilon",upXi:"Upxi",notcong:"ncong",notgeq:"ngeq",notgr:"ngtr",notless:"nless",notleq:"nleq",notsucc:"nsucc",notprec:"nprec",notsubseteq:"nsubseteq",notsupseteq:"nsupseteq",openclubsuit:"clubsuit",openspadesuit:"spadesuit",dasharrow:"dashrightarrow",comp:"circ",iiintop:"iiint",iintop:"iint",ointop:"oint"},_={Digamma:988,upDigamma:988,digamma:989,updigamma:989,Koppa:990,koppa:991,upkoppa:991,upKoppa:990,VarKoppa:984,upVarKoppa:984,varkoppa:985,upvarkoppa:985,varkappa:954,upvarkappa:954,varbeta:976,upvarbeta:976,Sampi:992,upSampi:992,sampi:993,upsampi:993,Stigma:986,upStigma:986,stigma:987,upstigma:987,San:1018,upSan:1018,san:1019,upsan:1019,Sho:1015,upSho:1015,sho:1016,upsho:1016,P:182,aa:176,bulletdashcirc:8887,circdashbullet:8886,downuparrows:8693,updownarrows:8645,dashdownarrow:8675,dashuparrow:8673,complement:8705,dbar:396,ddddot:8943,dddot:8943,ddots:8945,defineequal:8797,defineeq:8797,downdownharpoons:10597,downupharpoons:10607,updownharpoons:10606,upupharpoons:10595,hateq:8793,ldbrack:10214,rdbrack:10215,leadsfrom:8604,leftsquigarrow:8668,lightning:9735,napprox:8777,nasymp:8813,nequiv:8802,nsimeq:8772,nsubseteq:8840,nsubset:8836,notapprox:8777,notasymp:8813,notequiv:8802,notni:8716,notsimeq:8772,notsubseteq:8840,notsubset:8836,notsupseteq:8841,notsupset:8837,nsupset:8837,setdif:8726,simarrow:10610,t:8256,u:711,v:711,undercurvearrowright:10555,updbar:396,wwbar:8213,awointop:8754,awoint:8755,barintop:10780,barint:10779,cwintop:8753,cwint:8753,cwointop:8755,cwoint:8754,oiiintop:8752,oiiint:8752,oiintop:8751,oiint:8751,slashintop:10767,slashint:10767},C=['"',"'","`","=","~"];function U(I,A,R,k,J,_e){let be=parseInt(R.attr("width")),Te=parseInt(R.attr("height"));if(Number.isInteger(Te)&&Number.isInteger(be))_e>0&&(be/=_e,Te/=_e,R.attr("width",Math.round(be)).attr("height",Math.round(Te)));else{const Ke=(0,z.xh)(A,"bbox");be=Ke.width||be||100,Te=Ke.height||Te||10}_e>0&&k.valign&&(k.valign=k.valign/_e),null===k.valign&&(k.valign=(J-Te)/2);const Pe={x:1,y:1};let We="x",dt="y";180===k.rotate?Pe.x=Pe.y=-1:(270===k.rotate||90===k.rotate)&&(Pe.x=270===k.rotate?-1:1,Pe.y=-Pe.x,We="y",dt="x"),"middle"===k.align[0]?k[We]+=Pe.x*(k.width-be)/2:"end"===k.align[0]&&(k[We]+=Pe.x*(k.width-be)),"middle"===k.align[1]?k[dt]+=Pe.y*(k.height-Te)/2:"bottom"===k.align[1]?k[dt]+=Pe.y*(k.height-Te):"bottom-base"===k.align[1]&&(k[dt]+=Pe.y*(k.height-Te-k.valign));let Q=(0,z.bk)(k.x,k.y)||"";k.rotate&&(Q&&(Q+=" "),Q+=`rotate(${k.rotate})`),A.attr("transform",Q||null).attr("visibility",null)}function j(I,A,R){return te.apply(this,arguments)}function te(){return(te=(0,ve.A)(function*(I,A,R){const k=function L(I,A,R,k){if(2!==A){for(const be in x)I=I.replace(new RegExp(be,"g"),x[be]);for(const be in xe)be.length>2&&(I=I.replace(new RegExp(be,"g"),"\\"+be.slice(1)));let J="",_e=!0;for(;I;){let be=I.indexOf("#color[");if(be<0&&_e){J=I;break}if(_e=!1,0!==be&&(J+=be<0?I:I.slice(0,be),be<0))break;if(be=(I=I.slice(be+7)).indexOf("]{"),be<=0)break;const Te=parseInt(I.slice(0,be));if(!Number.isInteger(Te))break;const Pe=k.getColor(Te);let We=1;for(I=I.slice(be+2),be=-1;We&&++be<I.length;)"{"===I[be]?We++:"}"===I[be]&&We--;if(0!==We)break;const dt=I.slice(0,be);I=I.slice(be+1),dt&&(J+=`\\color{${Pe}}{${dt}}`)}I=J}else{"\\^"===I&&(I="\\unicode{0x5E}"),"\\vec"===I&&(I="\\unicode{0x2192}"),I=I.replace(/\\\./g,"\\unicode{0x2E}").replace(/\\\^/g,"\\hat");for(const J in _)I=I.replace(new RegExp(`\\\\\\b${J}\\b`,"g"),`\\unicode{0x${_[J].toString(16)}}`);C.forEach(J=>{I=I.replace(new RegExp(`(\\\\${J})`,"g"),`\\unicode{0x${J.charCodeAt(0).toString(16)}}`)});for(const J in v)I=I.replace(new RegExp(`\\\\\\b${J}\\b`,"g"),`\\${v[J]}`)}return(0,b.isStr)(R)?`\\color{${R}}{${I}}`:I}(R.text,R.latex,R.color,I),J={em:R.font.size,ex:R.font.size/2,family:R.font.name,scale:1,containerWidth:-1,lineWidth:1e5};return w().then(_e=>_e.tex2svgPromise(k,J)).then(_e=>{const be=_e.querySelector("svg");return A.append(()=>be),function F(I,A,R,k){const J=Pe=>{if(!Pe||!(0,b.isStr)(Pe)||Pe.length<3)return null;const We=Pe.indexOf("ex");return We<0||We!==Pe.length-2?null:(Pe=parseFloat(Pe.slice(0,We)),Number.isFinite(Pe)?Pe*k.font.size*.5:null)};let _e=J(R.getAttribute("width")),be=J(R.getAttribute("height")),Te=R.getAttribute("style");if(Te&&Te.length>18&&0===Te.indexOf("vertical-align:")){const Pe=Te.indexOf("ex;");Te=Pe>0&&Pe===Te.length-3?J(Te.slice(16,Te.length-1)):null}else Te=null;if(_e=!_e||_e<=.5?1:Math.round(_e),be=!be||be<=.5?1:Math.round(be),R.setAttribute("width",_e),R.setAttribute("height",be),R.removeAttribute("style"),!(0,b.isNodeJs)()){const Pe=(0,z.xh)(A,"bbox");_e=1.05*Pe.width,be=1.05*Pe.height}k.valign=Te,k.scale&&I.scaleTextDrawing(Math.max(_e/k.width,be/k.height),k.draw_g)}(I,A,be,R),R.applyAttributesToMathJax=U,!0})})).apply(this,arguments)}function N(I){return m.apply(this,arguments)}function m(){return(m=(0,ve.A)(function*(I){return w().then(A=>A.typesetPromise(I?[I]:void 0))})).apply(this,arguments)}},8977:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{Beta:()=>Tn,BetaDist:()=>Tr,BetaDistI:()=>ys,BetaIncomplete:()=>be,BreitWigner:()=>yn,Chebyshev0:()=>Cn,Chebyshev1:()=>ln,Chebyshev10:()=>$,Chebyshev2:()=>Un,Chebyshev3:()=>Ci,Chebyshev4:()=>Rn,Chebyshev5:()=>si,Chebyshev6:()=>Fn,Chebyshev7:()=>Zt,Chebyshev8:()=>tr,Chebyshev9:()=>Ne,ChebyshevN:()=>jt,FDist:()=>on,FDistI:()=>Qt,Gamma:()=>V,GammaDist:()=>Hn,Gaus:()=>dn,InvPi:()=>gn,Landau:()=>L,LaplaceDist:()=>ti,LaplaceDistI:()=>hi,LogNormal:()=>Or,Pi:()=>zt,PiOver2:()=>nn,PiOver4:()=>Wt,Polynomial1eval:()=>Re,Polynomialeval:()=>ot,Prob:()=>Bn,Sq:()=>ct,Student:()=>ai,StudentI:()=>Xi,TwoPi:()=>at,beta:()=>N,beta_cdf_c:()=>Pe,beta_pdf:()=>te,beta_quantile:()=>Te,breitwigner_cdf:()=>Ze,breitwigner_cdf_c:()=>Ke,cauchy_cdf:()=>Oe,cauchy_cdf_c:()=>Ue,cauchy_pdf:()=>lt,chisquared_cdf:()=>We,chisquared_cdf_c:()=>m,chisquared_pdf:()=>An,crystalball_cdf:()=>xt,crystalball_cdf_c:()=>En,crystalball_function:()=>At,crystalball_pdf:()=>Et,erf:()=>ce,erfc:()=>O,expo:()=>pe,exponential_cdf:()=>It,exponential_cdf_c:()=>Ot,fdistribution_cdf:()=>Qt,fdistribution_cdf_c:()=>pn,fdistribution_pdf:()=>on,gamma:()=>V,gamma_pdf:()=>ht,gamma_quantile:()=>Q,gamma_quantile_c:()=>dt,gaus:()=>ds,gausn:()=>wt,gaussian_cdf:()=>fe,gaussian_cdf_c:()=>ue,gaussian_pdf:()=>gt,gausxy:()=>W,getTEfficiencyBoundaryFunc:()=>rt,igam:()=>v,igamc:()=>x,igami:()=>_,inc_beta:()=>_e,inc_gamma:()=>U,inc_gamma_c:()=>F,incbet:()=>k,incbi:()=>J,landau:()=>me,landau_pdf:()=>C,landaun:()=>Fe,lgam:()=>He,lgamma:()=>j,lognormal_cdf:()=>he,lognormal_cdf_c:()=>ie,lognormal_pdf:()=>le,ndtri:()=>D,normal_cdf:()=>fe,normal_cdf_c:()=>ue,normal_pdf:()=>Y,normal_quantile:()=>w,normal_quantile_c:()=>P,pseries:()=>R,stirf:()=>Ie,tdistribution_cdf:()=>yt,tdistribution_cdf_c:()=>st,tdistribution_pdf:()=>Kt,tgamma:()=>V});const ve=11102230246251565e-32,b=-708.3964185322641,z=709.782712893384,ke=108.11685576785767,xe=4503599627370496,et=2220446049250313e-31,Je=1.4142135623730951,Xe=3.141592653589793;function ot(ze,Qe,ut){if(!ut)return Qe[0];let _t=Qe[0];for(let Lt=1;Lt<=ut;++Lt)_t=_t*ze+Qe[Lt];return _t}function Re(ze,Qe,ut){if(!ut)return Qe[0];let _t=ze+Qe[0];for(let Lt=1;Lt<ut;++Lt)_t=_t*ze+Qe[Lt];return _t}function He(ze){let Qe,ut,_t,Lt,xn;const Pn=[-1378.2515256912086,-38801.631513463784,-331612.9927388712,-1162370.974927623,-1721737.0082083966,-853555.6642457654],Zn=[-351.81570143652345,-17064.210665188115,-220528.59055385445,-1139334.4436798252,-2532523.0717758294,-2018891.4143353277];if(ze>=Number.MAX_VALUE||ze==Number.POSITIVE_INFINITY)return Number.POSITIVE_INFINITY;if(ze<-34)return ut=-ze,Lt=He(ut),Qe=Math.floor(ut),Qe===ut||(xn=ut-Qe,xn>.5&&(Qe+=1,xn=Qe-ut),xn=ut*Math.sin(Math.PI*xn),xn<1e-300)?Number.POSITIVE_INFINITY:(xn=Math.log(Math.PI)-Math.log(xn)-Lt,xn);if(ze<13){for(xn=1,Qe=0,_t=ze;_t>=3;)Qe-=1,_t=ze+Qe,xn*=_t;for(;_t<2;){if(_t<1e-300)return Number.POSITIVE_INFINITY;xn/=_t,Qe+=1,_t=ze+Qe}return xn<0&&(xn=-xn),2===_t?Math.log(xn):(Qe-=2,Qe=(ze+=Qe)*ot(ze,Pn,5)/Re(ze,Zn,6),Math.log(xn)+Qe)}return ze>2556348e299?Number.POSITIVE_INFINITY:(ut=(ze-.5)*Math.log(ze)-ze+.9189385332046728,ze>1e8||(Qe=1/(ze*ze),ut+=ze>=1e3?((.0007936507936507937*Qe-.002777777777777778)*Qe+.08333333333333333)/ze:ot(Qe,[.0008116141674705085,-.0005950619042843014,.0007936503404577169,-.002777777777300997,.08333333333333319],4)/ze),ut)}function Ie(ze){let Qe,ut,_t;const xn=Math.sqrt(2*Math.PI);return ut=1/ze,ut=1+ut*ot(ut,[.0007873113957930937,-.00022954996161337813,-.0026813261780578124,.0034722222160545866,.08333333333334822],4),Qe=Math.exp(ze),ze>ke?(_t=Math.pow(ze,.5*ze-.25),Qe=_t*(_t/Qe)):Qe=Math.pow(ze,ze-.5)/Qe,Qe=xn*Qe*ut,Qe}function O(ze){let xn,rn,Xt,cn,Pn;return Xt=ze<0?-ze:ze,Xt<1?1-ce(ze):(Pn=-ze*ze,Pn<-z||(Pn=Math.exp(Pn),Xt<8?(xn=ot(Xt,[2.461969814735305e-10,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],8),rn=Re(Xt,[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],8)):(xn=ot(Xt,[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],5),rn=Re(Xt,[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],6)),cn=Pn*xn/rn,ze<0&&(cn=2-cn),0==cn)?ze<0?2:0:cn)}function ce(ze){if(Math.abs(ze)>1)return 1-O(ze);const _t=ze*ze;return ze*ot(_t,[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],4)/Re(_t,[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],5)}function ie(ze,Qe,ut,_t){void 0===_t&&(_t=0);const Lt=(Math.log(ze-_t)-Qe)/(ut*Je);return Lt>1?.5*O(Lt):.5*(1-ce(Lt))}function he(ze,Qe,ut,_t=0){const Lt=(Math.log(ze-_t)-Qe)/(ut*Je);return Lt<-1?.5*O(-Lt):.5*(1+ce(Lt))}function ue(ze,Qe,ut=0){const _t=(ze-ut)/(Qe*Je);return _t>1?.5*O(_t):.5*(1-ce(_t))}function fe(ze,Qe,ut=0){const _t=(ze-ut)/(Qe*Je);return _t<-1?.5*O(-_t):.5*(1+ce(_t))}function le(ze,Qe,ut,_t=0){if(ze-_t<=0)return 0;const Lt=(Math.log(ze-_t)-Qe)/ut;return 1/((ze-_t)*Math.abs(ut)*Math.sqrt(2*Xe))*Math.exp(-Lt*Lt/2)}function Y(ze,Qe=1,ut=0){const _t=(ze-ut)/Qe;return 1/(Math.sqrt(2*Xe)*Math.abs(Qe))*Math.exp(-_t*_t/2)}function V(ze){let Qe,ut,_t,Lt,xn=1;if(ze>=Number.MAX_VALUE)return ze;if(ut=Math.abs(ze),ut>33){if(ze<0){if(Qe=Math.floor(ut),Qe==ut)return Number.POSITIVE_INFINITY;if(Lt=Math.round(Qe),1&Lt||(xn=-1),_t=ut-Qe,_t>.5&&(Qe+=1,_t=ut-Qe),_t=ut*Math.sin(Math.PI*_t),0==_t)return xn>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;_t=Math.abs(_t),_t=Math.PI/(_t*Ie(ut))}else _t=Ie(ze);return xn*_t}for(_t=1;ze>=3;)_t*=ze-=1;let rn=!1;for(;ze<0&&!rn;)ze>-1e-9?rn=!0:(_t/=ze,ze+=1);for(;ze<2&&!rn;)ze<1e-9?rn=!0:(_t/=ze,ze+=1);return rn?0==ze?Number.POSITIVE_INFINITY:_t/((1+.5772156649015329*ze)*ze):2==ze?_t:(Qe=ot(ze-=2,[.00016011952247675185,.0011913514700658638,.010421379756176158,.04763678004571372,.20744822764843598,.4942148268014971,1],6),ut=ot(ze,[-23158187332412014e-21,.0005396055804933034,-.004456419138517973,.011813978522206043,.035823639860549865,-.23459179571824335,.0714304917030273,1],7),_t*Qe/ut)}function D(ze){if(ze<=0)return Number.NEGATIVE_INFINITY;if(ze>=1)return Number.POSITIVE_INFINITY;const cn=.1353352832366127;let Ui,Ki,Ii,Pn=1,Zn=ze;if(Zn>1-cn&&(Zn=1-Zn,Pn=0),Zn>cn)return Zn-=.5,Ki=Zn*Zn,Ui=Zn+Zn*(Ki*ot(Ki,[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],4)/Re(Ki,[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],8)),Ui*=2.5066282746310007,Ui;Ui=Math.sqrt(-2*Math.log(Zn));const vr=Ui-Math.log(Ui)/Ui,$r=1/Ui;return Ii=Ui<8?$r*ot($r,[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],8)/Re($r,[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],8):$r*ot($r,[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6.239745391849833e-9],8)/Re($r,[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6.790194080099813e-9],8),Ui=vr-Ii,0!=Pn&&(Ui=-Ui),Ui}function w(ze,Qe){return Qe*D(ze)}function P(ze,Qe){return-Qe*D(ze)}function x(ze,Qe){if(ze<=0)return 0;if(Qe<=0)return 1;if(Qe<1||Qe<ze)return 1-v(ze,Qe);let ut=ze*Math.log(Qe)-Qe-He(ze);if(ut<-z)return 0;ut=Math.exp(ut);let Ui,Ki,Ii,vr,$r,_t=1-ze,Lt=Qe+_t+1,xn=0,rn=1,Xt=Qe,cn=Qe+1,Pn=Lt*Qe,Zn=cn/Pn;do{xn+=1,_t+=1,Lt+=2,Ui=_t*xn,vr=cn*Lt-rn*Ui,$r=Pn*Lt-Xt*Ui,$r?(Ki=vr/$r,Ii=Math.abs((Zn-Ki)/Ki),Zn=Ki):Ii=1,rn=cn,cn=vr,Xt=Pn,Pn=$r,Math.abs(vr)>xe&&(rn*=et,cn*=et,Xt*=et,Pn*=et)}while(Ii>ve);return Zn*ut}function v(ze,Qe){if(ze<=0)return 1;if(Qe<=0)return 0;if(Qe>1&&Qe>ze)return 1-x(ze,Qe);let ut=ze*Math.log(Qe)-Qe-He(ze);if(ut<-z)return 0;ut=Math.exp(ut);let _t=ze,Lt=1,xn=1;do{_t+=1,Lt*=Qe/_t,xn+=Lt}while(Lt/xn>ve);return xn*ut/ze}function _(ze,Qe){if(ze<=0)return console.error(`igami : Wrong domain for parameter a = ${ze} (must be > 0)`),0;if(Qe<=0)return Number.POSITIVE_INFINITY;if(Qe>=1)return 0;const ut=Number.MAX_VALUE,_t=5*ve;let rn,Pn,Zn,Ui,Ki,Ii,Lt=ut,xn=0,Xt=0,cn=1;for(Zn=1/(9*ze),Pn=1-Zn-D(Qe)*Math.sqrt(Zn),rn=ze*Pn*Pn*Pn,Ui=He(ze),Ki=0;Ki<10&&!(rn>Lt||rn<xn||(Pn=x(ze,rn),Pn<Xt||Pn>cn)||(Pn<Qe?(Lt=rn,Xt=Pn):(xn=rn,cn=Pn),Zn=(ze-1)*Math.log(rn)-rn-Ui,Zn<-z));++Ki){if(Zn=-Math.exp(Zn),Zn=(Pn-Qe)/Zn,Math.abs(Zn/rn)<ve)return rn;rn-=Zn}if(Zn=.0625,Lt==ut)for(rn<=0&&(rn=1);Lt==ut;){if(rn*=1+Zn,Pn=x(ze,rn),Pn<Qe){Lt=rn,Xt=Pn;break}Zn+=Zn}for(Zn=.5,Ii=0,Ki=0;Ki<400&&(rn=xn+Zn*(Lt-xn),Pn=x(ze,rn),Ui=(Lt-xn)/(xn+Lt),!(Math.abs(Ui)<_t||(Ui=(Pn-Qe)/Qe,Math.abs(Ui)<_t)||rn<=0));++Ki)Pn>=Qe?(xn=rn,cn=Pn,Ii<0?(Ii=0,Zn=.5):Zn=Ii>1?.5*Zn+.5:(Qe-Xt)/(cn-Xt),Ii+=1):(Lt=rn,Xt=Pn,Ii>0?(Ii=0,Zn=.5):Ii<-1?Zn*=.5:Zn=(Qe-Xt)/(cn-Xt),Ii-=1);return rn}function C(ze,Qe,ut=0){if(Qe<=0)return 0;const _t=(ze-ut)/Qe;let Lt,xn,rn,Xt;const cn=[.4259894875,-.124976255,.039842437,-.006298287635,.001511162253],Pn=[1,-.3388260629,.09594393323,-.01608042283,.003778942063],Zn=[.1788541609,.1173957403,.01488850518,-.001394989411,.0001283617211],Ui=[1,.7428795082,.3153932961,.06694219548,.008790609714],Ki=[.1788544503,.09359161662,.006325387654,6611667319e-14,-2031049101e-15],Ii=[1,.6097809921,.2560616665,.04746722384,.006957301675],vr=[.9874054407,118.6723273,849.279436,-743.7792444,427.0262186],$r=[1,106.8615961,337.6496214,2016.712389,1597.063511],yo=[1.003675074,167.5702434,4789.711289,21217.86767,-22324.9491],Ho=[1,156.9424537,3745.310488,9834.698876,66924.28357],vs=[1.000827619,664.9143136,62972.92665,475554.6998,-5743609.109],Us=[1,651.4101098,56974.73333,165917.4725,-2815759.939],mn=[.04166666667,-.01996527778,.02709538966],jn=[-1.84556867,-4.284640743];if(_t<-5.5){if(Lt=Math.exp(_t+1),Lt<1e-10)return 0;xn=Math.exp(-1/Lt),rn=Math.sqrt(Lt),Xt=xn/rn*.3989422803*(1+(mn[0]+(mn[1]+mn[2]*Lt)*Lt)*Lt)}else _t<-1?(Lt=Math.exp(-_t-1),Xt=Math.exp(-Lt)*Math.sqrt(Lt)*(cn[0]+(cn[1]+(cn[2]+(cn[3]+cn[4]*_t)*_t)*_t)*_t)/(Pn[0]+(Pn[1]+(Pn[2]+(Pn[3]+Pn[4]*_t)*_t)*_t)*_t)):_t<1?Xt=(Zn[0]+(Zn[1]+(Zn[2]+(Zn[3]+Zn[4]*_t)*_t)*_t)*_t)/(Ui[0]+(Ui[1]+(Ui[2]+(Ui[3]+Ui[4]*_t)*_t)*_t)*_t):_t<5?Xt=(Ki[0]+(Ki[1]+(Ki[2]+(Ki[3]+Ki[4]*_t)*_t)*_t)*_t)/(Ii[0]+(Ii[1]+(Ii[2]+(Ii[3]+Ii[4]*_t)*_t)*_t)*_t):_t<12?(Lt=1/_t,Xt=Lt*Lt*(vr[0]+(vr[1]+(vr[2]+(vr[3]+vr[4]*Lt)*Lt)*Lt)*Lt)/($r[0]+($r[1]+($r[2]+($r[3]+$r[4]*Lt)*Lt)*Lt)*Lt)):_t<50?(Lt=1/_t,Xt=Lt*Lt*(yo[0]+(yo[1]+(yo[2]+(yo[3]+yo[4]*Lt)*Lt)*Lt)*Lt)/(Ho[0]+(Ho[1]+(Ho[2]+(Ho[3]+Ho[4]*Lt)*Lt)*Lt)*Lt)):_t<300?(Lt=1/_t,Xt=Lt*Lt*(vs[0]+(vs[1]+(vs[2]+(vs[3]+vs[4]*Lt)*Lt)*Lt)*Lt)/(Us[0]+(Us[1]+(Us[2]+(Us[3]+Us[4]*Lt)*Lt)*Lt)*Lt)):(Lt=1/(_t-_t*Math.log(_t)/(_t+1)),Xt=Lt*Lt*(1+(jn[0]+jn[1]*Lt)*Lt));return Xt/Qe}function L(ze,Qe,ut,_t){if(ut<=0)return 0;const Lt=C((ze-Qe)/ut,1,0);return _t?Lt/ut:Lt}function F(ze,Qe){return x(ze,Qe)}function U(ze,Qe){return v(ze,Qe)}function j(ze){return He(ze)}function te(ze,Qe,ut){if(ze<0||ze>1)return 0;if(0==ze){if(Qe<1)return Number.POSITIVE_INFINITY;if(Qe>1)return 0;if(1==Qe)return ut}if(1==ze){if(ut<1)return Number.POSITIVE_INFINITY;if(ut>1)return 0;if(1==ut)return Qe}return Math.exp(j(Qe+ut)-j(Qe)-j(ut)+Math.log(ze)*(Qe-1)+Math.log1p(-ze)*(ut-1))}function N(ze,Qe){return Math.exp(j(ze)+j(Qe)-j(ze+Qe))}function m(ze,Qe,ut=0){return F(.5*Qe,.5*(ze-ut))}function R(ze,Qe,ut){let _t,Lt,xn,rn,Xt;const cn=1/ze;xn=(1-Qe)*ut,rn=xn/(ze+1);const Pn=rn;Lt=xn,Xt=2,_t=0;const Zn=ve*cn;for(;Math.abs(rn)>Zn;)xn=(Xt-Qe)*ut/Xt,Lt*=xn,rn=Lt/(ze+Xt),_t+=rn,Xt+=1;return _t+=Pn,_t+=cn,xn=ze*Math.log(ut),ze+Qe<ke&&Math.abs(xn)<z?(Lt=V(ze+Qe)/(V(ze)*V(Qe)),_t=_t*Lt*Math.pow(ut,ze)):(Lt=He(ze+Qe)-He(ze)-He(Qe)+xn+Math.log(_t),_t=Lt<b?0:Math.exp(Lt)),_t}function k(ze,Qe,ut){let _t,Lt,xn,rn,Xt,cn,Pn,Zn;return ze<=0||Qe<=0||ut<=0?0:ut>=1?1:(Zn=0,cn=1-ut,ut>ze/(ze+Qe)?(Zn=1,_t=Qe,Lt=ze,Xt=ut,rn=cn):(_t=ze,Lt=Qe,Xt=cn,rn=ut),1==Zn&&Lt*rn<=1&&rn<=.95?xn=R(_t,Lt,rn):(Pn=rn*(_t+Lt-2)-(_t-1),cn=Pn<0?function I(ze,Qe,ut){let _t,Lt,xn,rn,Xt,cn,Pn,Zn,Ui,Ki,Ii,vr,$r,yo,Ho,vs,Us,mn,jn;const Ht=3*ve;Zn=ze,Ui=ze+Qe,Ki=ze,Ii=ze+1,vr=1,$r=Qe-1,yo=Ii,Ho=ze+2,rn=0,Pn=1,xn=1,cn=1,mn=1,vs=1,jn=0;do{if(_t=-ut*Zn*Ui/(Ki*Ii),Lt=xn+rn*_t,Xt=cn+Pn*_t,rn=xn,xn=Lt,Pn=cn,cn=Xt,_t=ut*vr*$r/(yo*Ho),Lt=xn+rn*_t,Xt=cn+Pn*_t,rn=xn,xn=Lt,Pn=cn,cn=Xt,0!=Xt&&(vs=Lt/Xt),0!=vs?(Us=Math.abs((mn-vs)/vs),mn=vs):Us=1,Us<Ht)break;Zn+=1,Ui+=1,Ki+=2,Ii+=2,vr+=1,$r-=1,yo+=2,Ho+=2,Math.abs(Xt)+Math.abs(Lt)>xe&&(rn*=et,xn*=et,Pn*=et,cn*=et),(Math.abs(Xt)<et||Math.abs(Lt)<et)&&(rn*=xe,xn*=xe,Pn*=xe,cn*=xe)}while(++jn<300);return mn}(_t,Lt,rn):function A(ze,Qe,ut){const _t=ut/(1-ut),Lt=3*ve;let xn,rn,Xt,cn,Pn,Zn,Ui,Ki,Ii,vr,$r,yo,Ho,vs,Us,mn,jn,Ht,Oi;Ki=ze,Ii=Qe-1,vr=ze,$r=ze+1,yo=1,Ho=ze+Qe,vs=ze+1,Us=ze+2,cn=0,Ui=1,Xt=1,Zn=1,Ht=1,mn=1,Oi=0;do{if(xn=-_t*Ki*Ii/(vr*$r),rn=Xt+cn*xn,Pn=Zn+Ui*xn,cn=Xt,Xt=rn,Ui=Zn,Zn=Pn,xn=_t*yo*Ho/(vs*Us),rn=Xt+cn*xn,Pn=Zn+Ui*xn,cn=Xt,Xt=rn,Ui=Zn,Zn=Pn,0!=Pn&&(mn=rn/Pn),0!=mn?(jn=Math.abs((Ht-mn)/mn),Ht=mn):jn=1,jn<Lt)break;Ki+=1,Ii-=1,vr+=2,$r+=2,yo+=1,Ho+=1,vs+=2,Us+=2,Math.abs(Pn)+Math.abs(rn)>xe&&(cn*=et,Xt*=et,Ui*=et,Zn*=et),(Math.abs(Pn)<et||Math.abs(rn)<et)&&(cn*=xe,Xt*=xe,Ui*=xe,Zn*=xe)}while(++Oi<300);return Ht}(_t,Lt,rn)/Xt,Pn=_t*Math.log(rn),xn=Lt*Math.log(Xt),_t+Lt<ke&&Math.abs(Pn)<z&&Math.abs(xn)<z?(xn=Math.pow(Xt,Lt),xn*=Math.pow(rn,_t),xn/=_t,xn*=cn,xn*=V(_t+Lt)/(V(_t)*V(Lt))):(Pn+=xn+He(_t+Lt)-He(_t)-He(Lt),Pn+=Math.log(cn/_t),xn=Pn<b?0:Math.exp(Pn))),1==Zn&&(xn=xn<=ve?1-ve:1-xn),xn)}function J(ze,Qe,ut){let _t,Lt,xn,rn,Xt,cn,Pn,Zn,Ui,Ki,Ii,vr,$r,yo,Ho,vs,Us,mn,jn,Ht=!0;if(ze<=0||Qe<=0)return 0;const Oi=()=>(Us&&(cn=cn<=ve?1-ve:1-cn),cn);if(vs=0,ut<=0)return 0;if(ut>=1)return 1;if(Pn=0,$r=0,Zn=1,yo=1,jn=0,ze<=1||Qe<=1)vr=1e-6,Us=0,_t=ze,Lt=Qe,xn=ut,cn=_t/(_t+Lt),Xt=k(_t,Lt,cn);else{if(vr=1e-4,Ki=-D(ut),ut>.5?(Us=1,_t=Qe,Lt=ze,xn=1-ut,Ki=-Ki):(Us=0,_t=ze,Lt=Qe,xn=ut),Ui=(Ki*Ki-3)/6,cn=2/(1/(2*_t-1)+1/(2*Lt-1)),rn=Ki*Math.sqrt(cn+Ui)/cn-(1/(2*Lt-1)-1/(2*_t-1))*(Ui+5/6-2/(3*cn)),rn*=2,rn<b)return cn=0,Oi();cn=_t/(_t+Lt*Math.exp(rn)),Xt=k(_t,Lt,cn),Ki=(Xt-xn)/xn,Math.abs(Ki)<.2&&(Ht=!1)}let Sn=1e3;for(;Sn-- >0;){if(Ht){for(mn=0,Ii=.5,vs=0;vs<100;vs++){if(0!=vs){if(cn=Pn+Ii*(Zn-Pn),1==cn&&(cn=1-ve),0==cn&&(Ii=.5,cn=Pn+Ii*(Zn-Pn),0==cn))return Oi();if(Xt=k(_t,Lt,cn),Ki=(Zn-Pn)/(Zn+Pn),Math.abs(Ki)<vr||(Ki=(Xt-xn)/xn,Math.abs(Ki)<vr))break}if(Xt<xn){if(Pn=cn,$r=Xt,mn<0?(mn=0,Ii=.5):Ii=mn>3?1-(1-Ii)*(1-Ii):mn>1?.5*Ii+.5:(xn-Xt)/(yo-$r),mn+=1,Pn>.75){1==Us?(Us=0,_t=ze,Lt=Qe,xn=ut):(Us=1,_t=Qe,Lt=ze,xn=1-ut),cn=1-cn,Xt=k(_t,Lt,cn),Pn=0,$r=0,Zn=1,yo=1;continue}}else{if(Zn=cn,1==Us&&Zn<ve)return cn=0,Oi();yo=Xt,mn>0?(mn=0,Ii=.5):mn<-3?Ii*=Ii:mn<-1?Ii*=.5:Ii=(Xt-xn)/(yo-$r),mn-=1}}if(Pn>=1)return cn=1-ve,Oi();if(cn<=0)return cn=0,Oi();break}if(Ht=!0,jn)return Oi();for(jn=1,Ui=He(_t+Lt)-He(_t)-He(Lt),vs=0;vs<8&&(0!=vs&&(Xt=k(_t,Lt,cn)),Xt<$r?(cn=Pn,Xt=$r):Xt>yo?(cn=Zn,Xt=yo):Xt<xn?(Pn=cn,$r=Xt):(Zn=cn,yo=Xt),1!=cn&&0!=cn);vs++){if(rn=(_t-1)*Math.log(cn)+(Lt-1)*Math.log(1-cn)+Ui,rn<b)return Oi();if(rn>z||(rn=Math.exp(rn),rn=(Xt-xn)/rn,Ho=cn-rn,Ho<=Pn&&(Xt=(cn-Pn)/(Zn-Pn),Ho=Pn+.5*Xt*(cn-Pn),Ho<=0))||Ho>=Zn&&(Xt=(Zn-cn)/(Zn-Pn),Ho=Zn-.5*Xt*(Zn-cn),Ho>=1))break;if(cn=Ho,Math.abs(rn/cn)<128*ve)return Oi()}vr=256*ve}return Oi()}function _e(ze,Qe,ut){return k(Qe,ut,ze)}const be=_e;function Te(ze,Qe,ut){return J(Qe,ut,ze)}function Pe(ze,Qe,ut){return _e(1-ze,ut,Qe)}function We(ze,Qe,ut=0){return U(.5*Qe,.5*(ze-ut))}function dt(ze,Qe,ut){return ut*_(Qe,ze)}function Q(ze,Qe,ut){return ut*_(Qe,1-ze)}function Ke(ze,Qe,ut=0){return.5-Math.atan(2*(ze-ut)/Qe)/Xe}function Ze(ze,Qe,ut=0){return.5+Math.atan(2*(ze-ut)/Qe)/Xe}function Ue(ze,Qe,ut=0){return.5-Math.atan((ze-ut)/Qe)/Xe}function Oe(ze,Qe,ut=0){return.5+Math.atan((ze-ut)/Qe)/Xe}function lt(ze,Qe=1,ut=0){return Qe/(Xe*((ze-ut)*(ze-ut)+Qe*Qe))}function gt(ze,Qe=1,ut=0){const _t=(ze-ut)/Qe;return 1/(Math.sqrt(2*Xe)*Math.abs(Qe))*Math.exp(-_t*_t/2)}function ht(ze,Qe,ut,_t=0){return ze-_t<0?0:ze-_t==0?1==Qe?1/ut:0:1==Qe?Math.exp(-(ze-_t)/ut)/ut:Math.exp((Qe-1)*Math.log((ze-_t)/ut)-(ze-_t)/ut-j(Qe))/ut}function st(ze,Qe,ut=0){const _t=ze-ut,Lt=_t>0?1:-1;return.5-.5*_e(_t*_t/(Qe+_t*_t),.5,.5*Qe)*Lt}function yt(ze,Qe,ut=0){const _t=ze-ut,Lt=_t>0?1:-1;return.5+.5*_e(_t*_t/(Qe+_t*_t),.5,.5*Qe)*Lt}function Kt(ze,Qe,ut=0){return Math.exp(j((Qe+1)/2)-j(Qe/2))/Math.sqrt(Xe*Qe)*Math.pow(1+(ze-ut)*(ze-ut)/Qe,-(Qe+1)/2)}function Ot(ze,Qe,ut=0){return ze-ut<0?1:Math.exp(-Qe*(ze-ut))}function It(ze,Qe,ut=0){return ze-ut<0?0:-Math.expm1(-Qe*(ze-ut))}function An(ze,Qe,ut=0){return ze-ut<0?0:ze==ut&&0==Qe/2-1?.5:Math.exp((Qe/2-1)*Math.log((ze-ut)/2)-(ze-ut)/2-j(Qe/2))/2}function on(ze,Qe,ut,_t=0){return Qe<0||ut<0?Number.NaN:ze-_t<0?0:Math.exp(Qe/2*Math.log(Qe)+ut/2*Math.log(ut)+j((Qe+ut)/2)-j(Qe/2)-j(ut/2)+(Qe/2-1)*Math.log(ze-_t)-(Qe+ut)/2*Math.log(ut+Qe*(ze-_t)))}function pn(ze,Qe,ut,_t=0){return Qe<0||ut<0?Number.NaN:ut/(ut+Qe*(ze-_t))>.9&&Qe>1&&ut>1?1-Qt(ze,Qe,ut,_t):_e(ut/(ut+Qe*(ze-_t)),.5*ut,.5*Qe)}function Qt(ze,Qe,ut,_t=0){if(Qe<0||ut<0)return Number.NaN;const Lt=Qe*(ze-_t)/(ut+Qe*(ze-_t));return Lt>.9&&Qe>1&&ut>1?1-pn(ze,Qe,ut,_t):_e(Lt,.5*Qe,.5*ut)}function Bn(ze,Qe){return Qe<=0?0:ze<=0?ze<0?0:1:m(ze,Qe,0)}function dn(ze,Qe,ut,_t){if(!ut)return 1e30;const Lt=(ze-Qe)/ut;if(Lt<-39||Lt>39)return 0;const xn=Math.exp(-.5*Lt*Lt);return _t?xn/(2.5066282746310002*ut):xn}function yn(ze,Qe,ut){return ut/((ze-Qe)*(ze-Qe)+ut*ut/4)/2/Math.PI}function Tn(ze,Qe){return Math.exp(j(ze)+j(Qe)-j(ze+Qe))}function Hn(ze,Qe,ut=0,_t=1){return ze<ut||Qe<=0||_t<=0?0:ht(ze,Qe,_t,ut)}function ti(ze,Qe=0,ut=1){return Math.exp(-Math.abs((ze-Qe)/ut))/(2*ut)}function hi(ze,Qe=0,ut=1){return ze<=Qe?.5*Math.exp(-Math.abs((ze-Qe)/ut)):1-.5*Math.exp(-Math.abs((ze-Qe)/ut))}function ai(ze,Qe){if(Qe<1)return 0;const ut=Qe,_t=.5*ut,Lt=_t+.5,xn=Math.sqrt(ut*Math.PI)*V(_t)*Math.pow(1+ze*ze/ut,Lt);return V(Lt)/xn}function Xi(ze,Qe){const ut=Qe;return ze>0?1-.5*be(ut/(ut+ze*ze),.5*ut,.5):.5*be(ut/(ut+ze*ze),.5*ut,.5)}function Or(ze,Qe,ut=0,_t=1){return ze<ut||Qe<=0||_t<=0?0:le(ze,Math.log(_t),Qe,ut)}function Tr(ze,Qe,ut){if(ze<0||ze>1||Qe<=0||ut<=0)return 0;const _t=Tn(Qe,ut);return Math.pow(ze,Qe-1)*Math.pow(1-ze,ut-1)/_t}function ys(ze,Qe,ut){return ze<0||ze>1||Qe<=0||ut<=0?0:be(ze,Qe,ut)}function ds(ze,Qe,ut){return ze.GetParValue(ut+0)*Math.exp(-.5*Math.pow((Qe-ze.GetParValue(ut+1))/ze.GetParValue(ut+2),2))}function wt(ze,Qe,ut){return ds(ze,Qe,ut)/(Math.sqrt(2*Math.PI)*ze.GetParValue(ut+2))}function W(ze,Qe,ut,_t){return ze.GetParValue(_t+0)*Math.exp(-.5*Math.pow((Qe-ze.GetParValue(_t+1))/ze.GetParValue(_t+2),2))*Math.exp(-.5*Math.pow((ut-ze.GetParValue(_t+3))/ze.GetParValue(_t+4),2))}function pe(ze,Qe,ut){return Math.exp(ze.GetParValue(ut+0)+ze.GetParValue(ut+1)*Qe)}function me(ze,Qe,ut){return L(Qe,ze.GetParValue(ut+1),ze.GetParValue(ut+2),!1)}function Fe(ze,Qe,ut){return L(Qe,ze.GetParValue(ut+1),ze.GetParValue(ut+2),!0)}function At(ze,Qe,ut,_t,Lt=0){if(_t<0)return 0;let xn=(ze-Lt)/_t;Qe<0&&(xn=-xn);const rn=Math.abs(Qe);if(xn>-rn)return Math.exp(-.5*xn*xn);const Xt=ut/rn;return Math.exp(-.5*rn*rn)*Math.pow(Xt/(Xt-rn-xn),ut)}function Et(ze,Qe,ut,_t,Lt=0){if(_t<0)return 0;if(ut<=1)return Number.NaN;const xn=Math.abs(Qe);return 1/(_t*(ut/xn*1/(ut-1)*Math.exp(-Qe*Qe/2)+Math.sqrt(Xe/2)*(1+ce(xn/Math.sqrt(2)))))*At(ze,Qe,ut,_t,Lt)}function St(ze,Qe,ut,_t,Lt=0){if(0==_t||0==Qe)return 0;const xn=1==ut,rn=Math.abs(Qe);let Xt=(ze-Lt)/_t,cn=0,Pn=0;Qe<0&&(Xt=-Xt);const Zn=Math.sqrt(Xe/2),Ui=Math.sqrt(2*Xe),Ki=1/Math.sqrt(2);if(Xt<=-rn){const Ii=Math.pow(ut/rn,ut)*Math.exp(-.5*Qe*Qe),vr=ut/rn-rn;Pn=xn?-Ii*Math.log(ut/rn)+Ii*Math.log(vr-Xt):ut/rn*(1/(ut-1))*Math.exp(-Qe*Qe/2)-Ii/(ut-1)*Math.pow(vr-Xt,1-ut),cn=Zn*(1+ce(rn*Ki))}else cn=ue(Xt,1),cn*=Ui,Pn=0;return _t*(cn+Pn)}function xt(ze,Qe,ut,_t,Lt=0){if(ut<=1)return Number.NaN;const xn=Math.abs(Qe),cn=_t*(ut/xn*1/(ut-1)*Math.exp(-Qe*Qe/2)+Math.sqrt(Xe/2)*(1+ce(xn/Math.sqrt(2)))),Pn=St(ze,Qe,ut,_t,Lt);return Qe>0?1-Pn/cn:Pn/cn}function En(ze,Qe,ut,_t,Lt=0){if(ut<=1)return Number.NaN;const xn=Math.abs(Qe),cn=_t*(ut/xn*1/(ut-1)*Math.exp(-Qe*Qe/2)+Math.sqrt(Xe/2)*(1+ce(xn/Math.sqrt(2)))),Pn=St(ze,Qe,ut,_t,Lt);return Qe>0?Pn/cn:1-Pn/cn}function jt(ze,Qe,ut){let _t=0,Lt=0;const xn=2*Qe;for(let rn=ze;rn>=1;rn--){const Xt=_t;_t=xn*_t-Lt+ut[rn],Lt=Xt}return Qe*_t-Lt+ut[0]}function Cn(ze,Qe){return Qe}function ln(ze,Qe,ut){return Qe+ut*ze}function Un(ze,Qe,ut,_t){return Qe+ut*ze+_t*(2*ze*ze-1)}function Ci(ze,...Qe){return jt(3,ze,Qe)}function Rn(ze,...Qe){return jt(4,ze,Qe)}function si(ze,...Qe){return jt(5,ze,Qe)}function Fn(ze,...Qe){return jt(6,ze,Qe)}function Zt(ze,...Qe){return jt(7,ze,Qe)}function tr(ze,...Qe){return jt(8,ze,Qe)}function Ne(ze,...Qe){return jt(9,ze,Qe)}function $(ze,...Qe){return jt(10,ze,Qe)}function S(ze,Qe,ut,_t){const Lt=(1-ut)/2;return _t?Qe==ze?1:Te(1-Lt,Qe+1,ze-Qe):0==Qe?0:Te(Lt,Qe,ze-Qe+1)}function Z(ze,Qe,ut,_t){if(0==ze)return _t?1:0;const xn=Qe/ze,Xt=w(1-(1-ut)/2,Math.sqrt(xn*(1-xn)/ze));return _t?xn+Xt>1?1:xn+Xt:xn-Xt<0?0:xn-Xt}function Ae(ze,Qe,ut,_t){if(0==ze)return _t?1:0;const xn=Qe/ze,rn=w(1-(1-ut)/2,1),Xt=(Qe+.5*rn*rn)/(ze+rn*rn),cn=rn/(ze+rn*rn)*Math.sqrt(ze*xn*(1-xn)+rn*rn/4);return _t?Xt+cn>1?1:Xt+cn:Xt-cn<0?0:Xt-cn}function Ce(ze,Qe,ut,_t){const xn=w(1-(1-ut)/2,1),rn=(Qe+.5*xn*xn)/(ze+xn*xn),Xt=xn*Math.sqrt(rn*(1-rn)/(ze+xn*xn));return _t?rn+Xt>1?1:rn+Xt:rn-Xt<0?0:rn-Xt}function $e(ze,Qe,ut,_t){const rn=(1-ut)/2;let cn=0,Pn=1,Zn=0;if(Qe>0&&Qe<1){const Ui=$e(ze,0,ut,_t);return Zn=($e(ze,1,ut,_t)-Ui)*Qe+Ui,Zn}for(;Math.abs(Pn-cn)>1e-9;){Zn=(cn+Pn)/2;let Ui=.5*te(Zn,Qe+1,ze-Qe+1)/(ze+1);Qe-1>=0&&(Ui+=Pe(Zn,Qe,ze-Qe+1)),Ui>(_t?rn:1-rn)?cn=Zn:Pn=Zn}return Zn}function nt(ze,Qe,ut,_t,Lt,xn){const rn=Qe+Lt,Xt=ze-Qe+xn;return _t?rn>0&&Xt>0?Te((1+ut)/2,rn,Xt):1:rn>0&&Xt>0?Te((1-ut)/2,rn,Xt):0}function rt(ze,Qe){if(Qe)return nt;switch(ze){case 0:return S;case 1:return Z;case 2:return Ae;case 3:return Ce;case 4:return console.log("Feldman-Cousins interval kFFC not supported; using kFCP"),S;case 8:return $e}return console.log(`Not recognized stat option ${ze}, using kFCP`),S}function ct(ze){return ze*ze}function zt(){return Math.PI}function at(){return 2*Math.PI}function nn(){return Math.PI/2}function Wt(){return Math.PI/4}function gn(){return 1/Math.PI}},6998:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{BIT:()=>x,_ensureJSROOT:()=>vs,addMethods:()=>C,atob_func:()=>O,browser:()=>ie,btoa_func:()=>ce,clTAnnotation:()=>ds,clTAttCanvas:()=>jt,clTAttFill:()=>Ue,clTAttLine:()=>Ze,clTAttMarker:()=>Oe,clTAttText:()=>lt,clTAxis:()=>Un,clTBox:()=>pe,clTCanvas:()=>xt,clTClonesArray:()=>Ke,clTColor:()=>wt,clTCutG:()=>yt,clTDiamond:()=>Hn,clTF1:()=>S,clTF2:()=>Z,clTF3:()=>Ae,clTFile:()=>Te,clTFrame:()=>En,clTGaxis:()=>Cn,clTGeoNode:()=>ct,clTGeoNodeMatrix:()=>zt,clTGeoVolume:()=>rt,clTGraph:()=>ht,clTGraph2DAsymmErrors:()=>Ot,clTGraph2DErrors:()=>Kt,clTGraphPolar:()=>It,clTGraphPolargram:()=>An,clTGraphTime:()=>on,clTH1:()=>Rn,clTH1D:()=>Fn,clTH1I:()=>si,clTH2:()=>Zt,clTH2F:()=>Ne,clTH2I:()=>tr,clTH3:()=>$,clTHStack:()=>gt,clTHashList:()=>We,clTImagePalette:()=>Xi,clTKey:()=>be,clTLatex:()=>Tr,clTLegend:()=>ti,clTLegendEntry:()=>hi,clTLine:()=>W,clTList:()=>Pe,clTMap:()=>dt,clTMathText:()=>ys,clTMultiGraph:()=>st,clTNamed:()=>k,clTObjArray:()=>Q,clTObjString:()=>_e,clTObject:()=>R,clTPad:()=>St,clTPaletteAxis:()=>ai,clTPave:()=>pn,clTPaveClass:()=>Tn,clTPaveLabel:()=>yn,clTPaveStats:()=>Bn,clTPaveText:()=>Qt,clTPavesText:()=>dn,clTPolyLine:()=>me,clTPolyLine3D:()=>Fe,clTPolyMarker3D:()=>At,clTProfile:()=>Ce,clTProfile2D:()=>$e,clTProfile3D:()=>nt,clTString:()=>J,clTStyle:()=>Ci,clTText:()=>Or,clone:()=>v,constants:()=>ue,create:()=>Qe,createHistogram:()=>ut,createHttpRequest:()=>N,createTGraph:()=>xn,createTHStack:()=>rn,createTMultiGraph:()=>Xt,createTPolyLine:()=>Lt,decodeUrl:()=>j,findFunction:()=>te,gStyle:()=>le,getDocument:()=>Y,getMethods:()=>Pn,getPromise:()=>Ho,httpRequest:()=>m,injectCode:()=>V,internals:()=>et,isArrayProto:()=>he,isBatchMode:()=>Re,isFunc:()=>Ii,isNodeJs:()=>Ie,isObject:()=>Ki,isPromise:()=>$r,isRootCollection:()=>Ui,isStr:()=>vr,kInspect:()=>gn,kNoStats:()=>Wt,kNoZoom:()=>nn,kTitle:()=>ze,loadScript:()=>w,nsREX:()=>at,parse:()=>L,parseMulti:()=>F,postponePromise:()=>yo,prROOT:()=>A,registerMethods:()=>Zn,setBatchMode:()=>He,setHistogramTitle:()=>_t,settings:()=>fe,source_dir:()=>Xe,toJSON:()=>U,version:()=>ke,version_date:()=>z,version_id:()=>b});var ve=Ee(467);const b="7.7.2",z="19/06/2024",ke=b+" "+z,xe=!!("object"==typeof process&&Ki(process.versions)&&process.versions.node&&process.versions.v8),et={id_counter:1},Je="file:///home/runner/work/Phoenix-ILD/Phoenix-ILD/node_modules/jsroot/modules/core.mjs";let Xe="";if(Je&&vr(Je)){const mn=Je.indexOf("modules/core.mjs");mn>=0?(Xe=Je.slice(0,mn),xe||console.log(`Set jsroot source_dir to ${Xe}, ${ke}`)):(xe||console.log(`jsroot bundle, ${ke}`),et.ignore_v6=!0)}let ot=xe;function Re(){return ot}function He(mn){ot=!!mn}function Ie(){return xe}const O=Ie()?mn=>Buffer.from(mn,"base64").toString("latin1"):globalThis?.atob,ce=Ie()?mn=>Buffer.from(mn,"latin1").toString("base64"):globalThis?.btoa,ie={isFirefox:!0,isSafari:!1,isChrome:!1,isWin:!1,touches:!1,screenWidth:1200};function he(mn){if(mn.length<14||0!==mn.indexOf("[object "))return 0;const jn=mn.indexOf("Array]");return jn<0||jn!==mn.length-6?0:14===mn.length?1:2}typeof document<"u"&&typeof window<"u"&&typeof navigator<"u"&&(navigator.userAgentData?.brands?.forEach(mn=>{"HeadlessChrome"===mn.brand?(ie.isChromeHeadless=!0,ie.chromeVersion=parseInt(mn.version)):"Chromium"===mn.brand&&(ie.isChrome=!0,ie.chromeVersion=parseInt(mn.version))}),ie.chromeVersion?(ie.isFirefox=!1,ie.isWin="Windows"===navigator.userAgentData.platform):(ie.isFirefox=navigator.userAgent.indexOf("Firefox")>=0,ie.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,ie.isChrome=!!window.chrome,ie.isChromeHeadless=navigator.userAgent.indexOf("HeadlessChrome")>=0,ie.chromeVersion=ie.isChrome||ie.isChromeHeadless?parseInt(navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/)[1]):0,ie.isWin=navigator.userAgent.indexOf("Windows")>=0),ie.touches="ontouchend"in document,ie.screenWidth=window.screen?.width??1200);const ue={Render3D:{Default:0,WebGL:1,WebGLImage:2,SVG:3,fromString(mn){return"webgl"===mn||"gl"===mn?this.WebGL:"img"===mn?this.WebGLImage:"svg"===mn?this.SVG:this.Default}},Embed3D:{NoEmbed:-1,Default:0,Overlay:1,Embed:2,EmbedSVG:3,fromString(mn){return"embed"===mn?this.Embed:"overlay"===mn?this.Overlay:this.Default}},Latex:{Off:0,Symbols:1,Normal:2,MathJax:3,AlwaysMathJax:4,fromString(mn){if(!mn||!vr(mn))return this.Normal;switch(mn){case"off":return this.Off;case"symbols":return this.Symbols;case"normal":case"latex":case"exp":case"experimental":return this.Normal;case"MathJax":case"mathjax":case"math":return this.MathJax;case"AlwaysMathJax":case"alwaysmath":case"alwaysmathjax":return this.AlwaysMathJax}const jn=parseInt(mn);return Number.isInteger(jn)&&jn>=this.Off&&jn<=this.AlwaysMathJax?jn:this.Normal}}},fe={Render3D:ue.Render3D.Default,Render3DBatch:ue.Render3D.Default,Embed3D:ue.Embed3D.Default,Tooltip:!xe,TooltipAnimation:500,ContextMenu:!xe,Zooming:!xe,ZoomMouse:!xe,ZoomWheel:!xe,ZoomTouch:!xe,MoveResize:!ie.touches&&!xe,HandleKeys:!xe,DragAndDrop:!xe,DragGraphs:!0,ProgressBox:!xe,ToolBar:!xe&&"popup",ToolBarSide:"left",ToolBarVert:!1,CanEnlarge:!0,CanAdjustFrame:!1,ApproxTextSize:!1,OptimizeDraw:1,AutoStat:!0,FrameNDC:{},SmallPad:{width:150,height:100},Palette:57,Latex:ue.Latex.Normal,GeoGradPerSegm:6,GeoCompressComp:!0,IgnoreUrlOptions:!1,HierarchyLimit:250,DislpayKind:"simple",BrowserWidth:250,XValuesFormat:void 0,YValuesFormat:void 0,ZValuesFormat:void 0,HandleWrongHttpResponse:!1,UseStamp:!0,MaxRanges:200,WithCredentials:!1,SkipStreamerInfos:!1,OnlyLastCycle:!1,DarkMode:!1,PreferSavedPoints:!1,AxisTiltAngle:25,StripAxisLabels:!0,FuncAsCurve:!1,TimeZone:"",NewTabUrl:"",NewTabUrlPars:"",NewTabUrlExportSettings:!1},le={fName:"Modern",fOptLogx:0,fOptLogy:0,fOptLogz:0,fOptDate:0,fOptFile:0,fDateX:.01,fDateY:.01,fOptTitle:1,fCanvasColor:0,fPadColor:0,fPadBottomMargin:.1,fPadTopMargin:.1,fPadLeftMargin:.1,fPadRightMargin:.1,fPadGridX:!1,fPadGridY:!1,fPadTickX:0,fPadTickY:0,fPadBorderSize:2,fPadBorderMode:0,fCanvasBorderSize:2,fCanvasBorderMode:0,fStatColor:0,fStatStyle:1e3,fStatTextColor:1,fStatFontSize:0,fStatFont:42,fStatBorderSize:1,fStatFormat:"6.4g",fStatX:.98,fStatY:.935,fStatW:.2,fStatH:.16,fTitleAlign:23,fTitleColor:0,fTitleTextColor:1,fTitleBorderSize:0,fTitleFont:42,fTitleFontSize:.05,fTitleStyle:0,fTitleX:.5,fTitleY:.995,fTitleW:0,fTitleH:0,fFitFormat:"5.4g",fOptStat:1111,fOptFit:0,fNumberContours:20,fGridColor:0,fGridStyle:3,fGridWidth:1,fFrameFillColor:0,fFrameFillStyle:1001,fFrameLineColor:1,fFrameLineWidth:1,fFrameLineStyle:1,fFrameBorderSize:1,fFrameBorderMode:0,fEndErrorSize:2,fErrorX:.5,fHistMinimumZero:!1,fHistTopMargin:.05,fHistFillColor:0,fHistFillStyle:1001,fHistLineColor:602,fHistLineStyle:1,fHistLineWidth:1,fPaintTextFormat:"g",fTimeOffset:788918400,fLegendBorderSize:1,fLegendFont:42,fLegendTextSize:0,fLegendFillColor:0,fHatchesLineWidth:1,fHatchesSpacing:1,fCandleWhiskerRange:1,fCandleBoxRange:.5,fCandleScaled:!1,fViolinScaled:!0,fOrthoCamera:!1,fXAxisExpXOffset:0,fXAxisExpYOffset:0,fYAxisExpXOffset:0,fYAxisExpYOffset:0,fAxisMaxDigits:5,fStripDecimals:!0,fBarWidth:1};function Y(){return xe?et.nodejs_document:typeof document<"u"?document:"object"==typeof window?window.document:void 0}function V(mn){return D.apply(this,arguments)}function D(){return(D=(0,ve.A)(function*(mn){if(xe){let jn,Ht;return Ee.e(245).then(Ee.t.bind(Ee,6245,19)).then(Oi=>(jn=Oi.tmpNameSync()+".js",Ee.e(535).then(Ee.t.bind(Ee,8535,19)))).then(Oi=>(Ht=Oi,Ht.writeFileSync(jn,mn),import("file://"+jn))).finally(()=>Ht.unlinkSync(jn))}if(typeof document<"u"){const jn=document.getElementsByTagName("script");for(let Oi=0;Oi<jn.length;++Oi)if(jn[Oi].innerHTML===mn)return!0;return(mn.indexOf("JSROOT.require")>=0?vs():Promise.resolve(!0)).then(()=>{const Oi=document.createElement("script");return Oi.setAttribute("type","text/javascript"),Oi.innerHTML=mn,document.head.appendChild(Oi),yo(!0,10)})}return!1})).apply(this,arguments)}function w(mn){return P.apply(this,arguments)}function P(){return(P=(0,ve.A)(function*(mn){if(!mn)return!0;if(vr(mn)&&mn.indexOf(";")>=0&&(mn=mn.split(";")),!vr(mn)){const Sn=mn,Wn=()=>!Sn.length||w(Sn.shift()).then(Wn,Wn);return Wn()}0===mn.indexOf("$$$")&&(0===(mn=mn.slice(3)).indexOf("style/")&&mn.indexOf(".css")<0&&(mn+=".css"),mn=Xe+mn);const jn=mn.indexOf(".css")>0;if(xe)return jn?null:0===mn.indexOf("http:")||0===mn.indexOf("https:")?m(mn,"text").then(Sn=>V(Sn)):0===mn.indexOf("./")?Ee.e(535).then(Ee.t.bind(Ee,8535,19)).then(Sn=>V(Sn.readFileSync(mn))):import(mn);const Ht=Sn=>{if(Sn===mn)return!0;const Wn=Sn.indexOf(mn);return Wn>0&&Wn+mn.length===Sn.length&&"/"===Sn[Wn-1]};if(jn){const Sn=document.getElementsByTagName("link");for(let Wn=0;Wn<Sn.length;++Wn)if(Sn[Wn].href&&"text/css"===Sn[Wn].type&&"stylesheet"===Sn[Wn].rel&&Ht(Sn[Wn].href))return!0}else{const Sn=document.getElementsByTagName("script");for(let Wn=0;Wn<Sn.length;++Wn)if(Ht(Sn[Wn].src))return!0}let Oi;return jn?(Oi=document.createElement("link"),Oi.setAttribute("rel","stylesheet"),Oi.setAttribute("type","text/css"),Oi.setAttribute("href",mn)):(Oi=document.createElement("script"),Oi.setAttribute("type","text/javascript"),Oi.setAttribute("src",mn)),new Promise((Sn,Wn)=>{Oi.onload=()=>Sn(!0),Oi.onerror=()=>{Oi.remove(),Wn(Error(`Fail to load ${mn}`))},document.head.appendChild(Oi)})})).apply(this,arguments)}function x(mn){return 1<<mn}function v(mn,jn,Ht){if(!mn)return null;if(jn){const Wn=jn.obj.indexOf(mn);if(Wn>=0)return jn.clones[Wn]}else jn={obj:[],clones:[],nofunc:Ht};const Oi=he(Object.prototype.toString.apply(mn));if(1===Oi){const Wn=[];jn.obj.push(mn),jn.clones.push(Wn);for(let yr=0;yr<mn.length;++yr)Wn.push(Ki(mn[yr])?v(mn[yr],jn):mn[yr]);return Wn}if(2===Oi){const Wn=[];jn.obj.push(mn),jn.clones.push(Wn);for(let yr=0;yr<mn.length;++yr)Wn.push(mn[yr]);return Wn}const Sn={};jn.obj.push(mn),jn.clones.push(Sn);for(const Wn in mn)Ki(mn[Wn])?Sn[Wn]=v(mn[Wn],jn):(!jn.nofunc||!Ii(mn[Wn]))&&(Sn[Wn]=mn[Wn]);return Sn}const _=Object.assign;function C(mn,jn){_(mn,Pn(jn||mn._typename,mn))}function L(mn){if(!mn)return null;const jn=vr(mn)?JSON.parse(mn):mn,Ht=[];let Oi;const Sn=Wn=>{if(null==Wn)return;if(vr(Wn)){if(Oi||Wn.length<6||0!==Wn.indexOf("$ref:"))return;const Zr=parseInt(Wn.slice(5));return!Number.isInteger(Zr)||Zr<0||Zr>=Ht.length?void 0:(Oi=!1,Ht[Zr])}if("object"!=typeof Wn)return;if(he(Object.prototype.toString.apply(Wn))>0){for(let Zr=0;Zr<Wn.length;++Zr){const ci=Sn(Wn[Zr]);void 0!==ci&&(Wn[Zr]=ci)}return}const cr=Object.keys(Wn),Cs=cr.length;if(!1!==Oi&&1===Cs&&"$ref"===cr[0]){const Zr=parseInt(Wn.$ref);return!Number.isInteger(Zr)||Zr<0||Zr>=Ht.length?void 0:(Oi=!0,Ht[Zr])}if(!1!==Oi&&Cs>1&&"$arr"===cr[0]&&"len"===cr[1]){let Zr;switch(Wn.$arr){case"Int8":Zr=new Int8Array(Wn.len);break;case"Uint8":Zr=new Uint8Array(Wn.len);break;case"Int16":Zr=new Int16Array(Wn.len);break;case"Uint16":Zr=new Uint16Array(Wn.len);break;case"Int32":Zr=new Int32Array(Wn.len);break;case"Uint32":Zr=new Uint32Array(Wn.len);break;case"Float32":Zr=new Float32Array(Wn.len);break;case"Int64":case"Uint64":case"Float64":Zr=new Float64Array(Wn.len);break;default:Zr=new Array(Wn.len)}if(Zr.fill("Bool"!==Wn.$arr&&0),void 0!==Wn.b){const ci=O(Wn.b);if(!Zr.buffer)throw new Error("base64 coding supported only for native arrays with binary data");{const Gs=new DataView(Zr.buffer,Wn.o||0),os=Math.min(ci.length,Gs.byteLength);for(let Sa=0;Sa<os;++Sa)Gs.setUint8(Sa,ci.charCodeAt(Sa))}}else{let ci=2,Gs=0;for(;ci<Cs;){if("p"===cr[ci][0]&&(Gs=Wn[cr[ci++]]),"v"!==cr[ci][0])throw new Error(`Unexpected member ${cr[ci]} in array decoding`);const os=Wn[cr[ci++]];if("object"==typeof os)for(let Sa=0;Sa<os.length;++Sa)Zr[Gs++]=os[Sa];else if(Zr[Gs++]=os,ci<Cs&&"n"===cr[ci][0]){let Sa=Wn[cr[ci++]];for(;--Sa;)Zr[Gs++]=os}}}return Zr}if(!1!==Oi&&3===Cs&&"$pair"===cr[0]&&"first"===cr[1]&&"second"===cr[2]){Oi=!0;const Zr=Sn(Wn.first),ci=Sn(Wn.second);return void 0!==Zr&&(Wn.first=Zr),void 0!==ci&&(Wn.second=ci),Wn._typename=Wn.$pair,void delete Wn.$pair}if(!(Ht.indexOf(Wn)>=0)){Ht.push(Wn),Wn._typename&&C(Wn);for(let Zr=0;Zr<Cs;++Zr){const ci=cr[Zr],Gs=Sn(Wn[ci]);void 0!==Gs&&(Wn[ci]=Gs)}}};return Sn(jn),jn}function F(mn){if(!mn)return null;const jn=JSON.parse(mn);if(jn?.length)for(let Ht=0;Ht<jn.length;++Ht)jn[Ht]=L(jn[Ht]);return jn}function U(mn,jn){if(!Ki(mn))return"";const Ht=[],Oi=Wn=>{if(Ii(Wn))return;if(null==Wn||!Ki(Wn))return Wn;if(he(Object.prototype.toString.apply(Wn))>0){const ci=new Array(Wn.length);for(let Gs=0;Gs<Wn.length;++Gs)ci[Gs]=Oi(Wn[Gs]);return ci}const yr=Ht.indexOf(Wn);if(yr>=0)return{$ref:yr};const cr=Object.keys(Wn),Cs=cr.length,Zr={};if(3===Cs&&"$pair"===cr[0]&&"first"===cr[1]&&"second"===cr[2])return Zr.$pair=Wn.$pair,Zr.first=Oi(Wn.first),Zr.second=Oi(Wn.second),Zr;Ht.push(Wn);for(let ci=0;ci<Cs;++ci){const Gs=cr[ci];Gs&&"$"!==Gs[0]&&(Zr[Gs]=Oi(Wn[Gs]))}return Zr},Sn=Oi(mn);return JSON.stringify(Sn,null,jn)}function j(mn){const jn={opts:{},has(Oi){return void 0!==this.opts[Oi]},get(Oi,Sn){const Wn=this.opts[Oi];return void 0!==Wn?Wn:Sn}};if(!mn||!vr(mn)){if(fe.IgnoreUrlOptions||typeof document>"u")return jn;mn=document.URL}jn.url=mn;const Ht=mn.indexOf("?");if(Ht<0)return jn;for(mn=decodeURI(mn.slice(Ht+1));mn;){let Oi=0,Sn=0,Wn=-1,yr=-1;for(;Oi<mn.length&&(0!==Sn||"&"!==mn[Oi]&&"#"!==mn[Oi]);){switch(mn[Oi]){case"'":Sn>=0&&(Sn=(Sn+1)%2),yr<0&&(yr=Oi);break;case'"':Sn<=0&&(Sn=(Sn-1)%2),yr<0&&(yr=Oi);break;case"=":yr<0&&Wn<0&&(Wn=Oi)}Oi++}if(Wn<0&&yr<0)jn.opts[mn.slice(0,Oi)]="";else if(Wn>0){let cr=mn.slice(Wn+1,Oi);("'"===cr[0]||'"'===cr[0])&&cr[0]===cr[cr.length-1]&&(cr=cr.slice(1,cr.length-1)),jn.opts[mn.slice(0,Wn)]=cr}if(Oi>=mn.length||"#"===mn[Oi])break;mn=mn.slice(Oi+1)}return jn}function te(mn){if(Ii(mn))return mn;if(!vr(mn))return null;const jn=mn.split(".");let Ht=globalThis;for(let Oi=0;Ht&&Oi<jn.length;++Oi)Ht=Ht[jn[Oi]];return Ii(Ht)?Ht:null}function N(mn,jn,Ht,Oi,Sn){function Wn(cr){cr.http_callback=Ii(Ht)?Ht.bind(cr):()=>{},cr.error_callback=Ii(Oi)?Oi.bind(cr):function(Gs){console.warn(Gs.message),this.http_callback(null)}.bind(cr),jn||(jn="buf");let Cs="GET",Zr=!0;const ci=jn.indexOf(";sync");switch(ci>0&&(jn=jn.slice(0,ci),Zr=!1),jn){case"head":Cs="HEAD";break;case"posttext":Cs="POST",jn="text";break;case"postbuf":Cs="POST",jn="buf";break;case"post":case"multi":Cs="POST"}return cr.kind=jn,fe.WithCredentials&&(cr.withCredentials=!0),fe.HandleWrongHttpResponse&&"GET"===Cs&&Ii(cr.addEventListener)&&cr.addEventListener("progress",function(Gs){Gs.lengthComputable&&this.expected_size&&Gs.loaded>this.expected_size&&(this.did_abort=!0,this.abort(),this.error_callback(Error(`Server sends more bytes ${Gs.loaded} than expected ${this.expected_size}. Abort I/O operation`),598))}.bind(cr)),cr.onreadystatechange=function(){if(!this.did_abort){if(2===this.readyState&&this.expected_size){const Gs=parseInt(this.getResponseHeader("Content-Length"));if(Number.isInteger(Gs)&&Gs>this.expected_size&&!fe.HandleWrongHttpResponse)return this.did_abort=!0,this.abort(),this.error_callback(Error(`Server response size ${Gs} larger than expected ${this.expected_size}. Abort I/O operation`),599)}if(4===this.readyState){if(200!==this.status&&206!==this.status&&!ie.qt5&&(0!==this.status||0!==mn.indexOf("file://")&&0!==mn.indexOf("blob:")))return this.error_callback(Error(`Fail to load url ${mn}`),this.status);if(this.nodejs_checkzip&&"gzip"===this.getResponseHeader("content-encoding"))return Ee.e(397).then(Ee.t.bind(Ee,7397,19)).then(Gs=>{const os=Gs.unzipSync(Buffer.from(this.response)),Sa=JSON.parse(os);return this.http_callback(L(Sa))});switch(this.kind){case"xml":return this.http_callback(this.responseXML);case"text":return this.http_callback(this.responseText);case"object":return this.http_callback(L(this.responseText));case"multi":return this.http_callback(F(this.responseText));case"head":return this.http_callback(this)}if(void 0===this.responseType)return this.http_callback(this.responseText);if("bin"===this.kind&&"byteLength"in this.response){const Gs=new Uint8Array(this.response);let os="";for(let Sa=0;Sa<Gs.length;++Sa)os+=String.fromCharCode(Gs[Sa]);return this.http_callback(os)}this.http_callback(this.response)}}},cr.open(Cs,mn,Zr),("bin"===jn||"buf"===jn)&&(cr.responseType="arraybuffer"),xe&&"GET"===Cs&&"object"===jn&&mn.indexOf(".json.gz")>0&&(cr.nodejs_checkzip=!0,cr.responseType="arraybuffer"),cr}if(Ie()){if(!Sn)throw Error("Not allowed to create http requests in node.js without promise");return Ee.e(850).then(Ee.t.bind(Ee,4850,19)).then(cr=>Wn(new cr.default))}const yr=Wn(new XMLHttpRequest);return Sn?Promise.resolve(yr):yr}function m(mn,jn,Ht){return I.apply(this,arguments)}function I(){return(I=(0,ve.A)(function*(mn,jn,Ht){return new Promise((Oi,Sn)=>{N(mn,jn,Oi,Sn,!0).then(Wn=>Wn.send(Ht||null))})})).apply(this,arguments)}const A="ROOT.",R="TObject",k="TNamed",J="TString",_e="TObjString",be="TKey",Te="TFile",Pe="TList",We="THashList",dt="TMap",Q="TObjArray",Ke="TClonesArray",Ze="TAttLine",Ue="TAttFill",Oe="TAttMarker",lt="TAttText",gt="THStack",ht="TGraph",st="TMultiGraph",yt="TCutG",Kt="TGraph2DErrors",Ot="TGraph2DAsymmErrors",It="TGraphPolar",An="TGraphPolargram",on="TGraphTime",pn="TPave",Qt="TPaveText",Bn="TPaveStats",dn="TPavesText",yn="TPaveLabel",Tn="TPaveClass",Hn="TDiamond",ti="TLegend",hi="TLegendEntry",ai="TPaletteAxis",Xi="TImagePalette",Or="TText",Tr="TLatex",ys="TMathText",ds="TAnnotation",wt="TColor",W="TLine",pe="TBox",me="TPolyLine",Fe="TPolyLine3D",At="TPolyMarker3D",Et="TAttPad",St="TPad",xt="TCanvas",En="TFrame",jt="TAttCanvas",Cn="TGaxis",ln="TAttAxis",Un="TAxis",Ci="TStyle",Rn="TH1",si="TH1I",Fn="TH1D",Zt="TH2",tr="TH2I",Ne="TH2F",$="TH3",S="TF1",Z="TF2",Ae="TF3",Ce="TProfile",$e="TProfile2D",nt="TProfile3D",rt="TGeoVolume",ct="TGeoNode",zt="TGeoNodeMatrix",at="ROOT::Experimental::",nn=-1111,Wt=x(9),gn="inspect",ze="title";function Qe(mn,jn){const Ht=jn||{};switch(mn){case R:_(Ht,{fUniqueID:0,fBits:0});break;case k:_(Ht,{fUniqueID:0,fBits:0,fName:"",fTitle:""});break;case Pe:case We:_(Ht,{name:mn,arr:[],opt:[]});break;case ln:_(Ht,{fNdivisions:510,fAxisColor:1,fLabelColor:1,fLabelFont:42,fLabelOffset:.005,fLabelSize:.035,fTickLength:.03,fTitleOffset:1,fTitleSize:.035,fTitleColor:1,fTitleFont:42});break;case Un:Qe(k,Ht),Qe(ln,Ht),_(Ht,{fNbins:1,fXmin:0,fXmax:1,fXbins:[],fFirst:0,fLast:0,fBits2:0,fTimeDisplay:!1,fTimeFormat:"",fLabels:null,fModLabs:null});break;case Ze:_(Ht,{fLineColor:1,fLineStyle:1,fLineWidth:1});break;case Ue:_(Ht,{fFillColor:0,fFillStyle:0});break;case Oe:_(Ht,{fMarkerColor:1,fMarkerStyle:1,fMarkerSize:1});break;case W:Qe(R,Ht),Qe(Ze,Ht),_(Ht,{fX1:0,fX2:1,fY1:0,fY2:1});break;case pe:Qe(R,Ht),Qe(Ze,Ht),Qe(Ue,Ht),_(Ht,{fX1:0,fX2:1,fY1:0,fY2:1});break;case pn:Qe(pe,Ht),_(Ht,{fX1NDC:0,fY1NDC:0,fX2NDC:1,fY2NDC:1,fBorderSize:0,fInit:1,fShadowColor:1,fCornerRadius:0,fOption:"brNDC",fName:""});break;case lt:_(Ht,{fTextAngle:0,fTextSize:0,fTextAlign:22,fTextColor:1,fTextFont:42});break;case Qt:Qe(pn,Ht),Qe(lt,Ht),_(Ht,{fLabel:"",fLongest:27,fMargin:.05,fLines:Qe(Pe)});break;case Bn:Qe(Qt,Ht),_(Ht,{fFillColor:le.fStatColor,fFillStyle:le.fStatStyle,fTextFont:le.fStatFont,fTextSize:le.fStatFontSize,fTextColor:le.fStatTextColor,fBorderSize:le.fStatBorderSize,fOptFit:0,fOptStat:0,fFitFormat:"",fStatFormat:"",fParent:null});break;case ti:Qe(pn,Ht),Qe(lt,Ht),_(Ht,{fColumnSeparation:0,fEntrySeparation:.1,fMargin:.25,fNColumns:1,fPrimitives:Qe(Pe),fName:pn,fBorderSize:le.fLegendBorderSize,fTextFont:le.fLegendFont,fTextSize:le.fLegendTextSize,fFillColor:le.fLegendFillColor});break;case ai:Qe(pn,Ht),_(Ht,{fAxis:Qe(Cn),fH:null,fName:pn});break;case hi:Qe(R,Ht),Qe(lt,Ht),Qe(Ze,Ht),Qe(Ue,Ht),Qe(Oe,Ht),_(Ht,{fLabel:"",fObject:null,fOption:"",fTextAlign:0,fTextColor:0,fTextFont:0});break;case Or:Qe(k,Ht),Qe(lt,Ht),_(Ht,{fLimitFactorSize:3,fOriginSize:.04});break;case Tr:Qe(Or,Ht),Qe(Ze,Ht),_(Ht,{fX:0,fY:0});break;case _e:Qe(R,Ht),_(Ht,{fString:""});break;case Rn:Qe(k,Ht),Qe(Ze,Ht),Qe(Ue,Ht),Qe(Oe,Ht),_(Ht,{fBits:8,fNcells:0,fXaxis:Qe(Un),fYaxis:Qe(Un),fZaxis:Qe(Un),fFillColor:le.fHistFillColor,fFillStyle:le.fHistFillStyle,fLineColor:le.fHistLineColor,fLineStyle:le.fHistLineStyle,fLineWidth:le.fHistLineWidth,fBarOffset:0,fBarWidth:1e3,fEntries:0,fTsumw:0,fTsumw2:0,fTsumwx:0,fTsumwx2:0,fMaximum:nn,fMinimum:nn,fNormFactor:0,fContour:[],fSumw2:[],fOption:"",fFunctions:Qe(Pe),fBufferSize:0,fBuffer:[],fBinStatErrOpt:0,fStatOverflows:2});break;case si:case Fn:case"TH1L64":case"TH1F":case"TH1S":case"TH1C":Qe(Rn,Ht),Ht.fArray=[];break;case Zt:Qe(Rn,Ht),_(Ht,{fScalefactor:1,fTsumwy:0,fTsumwy2:0,fTsumwxy:0});break;case tr:case"TH2L64":case Ne:case"TH2D":case"TH2S":case"TH2C":Qe(Zt,Ht),Ht.fArray=[];break;case $:Qe(Rn,Ht),_(Ht,{fTsumwy:0,fTsumwy2:0,fTsumwz:0,fTsumwz2:0,fTsumwxy:0,fTsumwxz:0,fTsumwyz:0});break;case"TH3I":case"TH3L64":case"TH3F":case"TH3D":case"TH3S":case"TH3C":Qe($,Ht),Ht.fArray=[];break;case gt:Qe(k,Ht),_(Ht,{fHists:Qe(Pe),fHistogram:null,fMaximum:nn,fMinimum:nn});break;case ht:Qe(k,Ht),Qe(Ze,Ht),Qe(Ue,Ht),Qe(Oe,Ht),_(Ht,{fFunctions:Qe(Pe),fHistogram:null,fMaxSize:0,fMaximum:nn,fMinimum:nn,fNpoints:0,fX:[],fY:[]});break;case"TGraphAsymmErrors":Qe(ht,Ht),_(Ht,{fEXlow:[],fEXhigh:[],fEYlow:[],fEYhigh:[]});break;case st:Qe(k,Ht),_(Ht,{fFunctions:Qe(Pe),fGraphs:Qe(Pe),fHistogram:null,fMaximum:nn,fMinimum:nn});break;case An:Qe(k,Ht),Qe(lt,Ht),Qe(Ze,Ht),_(Ht,{fRadian:!0,fDegree:!1,fGrad:!1,fPolarLabelColor:1,fRadialLabelColor:1,fAxisAngle:0,fPolarOffset:.04,fPolarTextSize:.04,fRadialOffset:.025,fRadialTextSize:.035,fRwrmin:0,fRwrmax:1,fRwtmin:0,fRwtmax:2*Math.PI,fTickpolarSize:.02,fPolarLabelFont:62,fRadialLabelFont:62,fCutRadial:0,fNdivRad:508,fNdivPol:508});break;case me:Qe(R,Ht),Qe(Ze,Ht),Qe(Ue,Ht),_(Ht,{fLastPoint:-1,fN:0,fOption:"",fX:null,fY:null});break;case Cn:Qe(W,Ht),Qe(lt,Ht),_(Ht,{fChopt:"",fFunctionName:"",fGridLength:0,fLabelColor:1,fLabelFont:42,fLabelOffset:.005,fLabelSize:.035,fName:"",fNdiv:12,fTickSize:.02,fTimeFormat:"",fTitle:"",fTitleOffset:1,fTitleSize:.035,fWmax:100,fWmin:0});break;case Et:_(Ht,{fLeftMargin:le.fPadLeftMargin,fRightMargin:le.fPadRightMargin,fBottomMargin:le.fPadBottomMargin,fTopMargin:le.fPadTopMargin,fXfile:2,fYfile:2,fAfile:1,fXstat:.99,fYstat:.99,fAstat:2,fFrameFillColor:le.fFrameFillColor,fFrameFillStyle:le.fFrameFillStyle,fFrameLineColor:le.fFrameLineColor,fFrameLineWidth:le.fFrameLineWidth,fFrameLineStyle:le.fFrameLineStyle,fFrameBorderSize:le.fFrameBorderSize,fFrameBorderMode:le.fFrameBorderMode});break;case St:Qe(R,Ht),Qe(Ze,Ht),Qe(Ue,Ht),Qe(Et,Ht),_(Ht,{fFillColor:le.fPadColor,fFillStyle:1001,fX1:0,fY1:0,fX2:1,fY2:1,fXtoAbsPixelk:1,fXtoPixelk:1,fXtoPixel:1,fYtoAbsPixelk:1,fYtoPixelk:1,fYtoPixel:1,fUtoAbsPixelk:1,fUtoPixelk:1,fUtoPixel:1,fVtoAbsPixelk:1,fVtoPixelk:1,fVtoPixel:1,fAbsPixeltoXk:1,fPixeltoXk:1,fPixeltoX:1,fAbsPixeltoYk:1,fPixeltoYk:1,fPixeltoY:1,fXlowNDC:0,fYlowNDC:0,fXUpNDC:0,fYUpNDC:0,fWNDC:1,fHNDC:1,fAbsXlowNDC:0,fAbsYlowNDC:0,fAbsWNDC:1,fAbsHNDC:1,fUxmin:0,fUymin:0,fUxmax:0,fUymax:0,fTheta:30,fPhi:30,fAspectRatio:0,fNumber:0,fLogx:le.fOptLogx,fLogy:le.fOptLogy,fLogz:le.fOptLogz,fTickx:le.fPadTickX,fTicky:le.fPadTickY,fPadPaint:0,fCrosshair:0,fCrosshairPos:0,fBorderSize:le.fPadBorderSize,fBorderMode:le.fPadBorderMode,fModified:!1,fGridx:le.fPadGridX,fGridy:le.fPadGridY,fAbsCoord:!1,fEditable:!0,fFixedAspectRatio:!1,fPrimitives:Qe(Pe),fExecs:null,fName:"pad",fTitle:"canvas"});break;case jt:_(Ht,{fXBetween:2,fYBetween:2,fTitleFromTop:1.2,fXdate:.2,fYdate:.3,fAdate:1});break;case xt:Qe(St,Ht),_(Ht,{fFillColor:le.fCanvasColor,fFillStyle:1001,fNumPaletteColor:0,fNextPaletteColor:0,fDISPLAY:"$DISPLAY",fDoubleBuffer:0,fRetained:!0,fXsizeUser:0,fYsizeUser:0,fXsizeReal:20,fYsizeReal:10,fWindowTopX:0,fWindowTopY:0,fWindowWidth:0,fWindowHeight:0,fBorderSize:le.fCanvasBorderSize,fBorderMode:le.fCanvasBorderMode,fCw:500,fCh:300,fCatt:Qe(jt),kMoveOpaque:!0,kResizeOpaque:!0,fHighLightColor:5,fBatch:!0,kShowEventStatus:!1,kAutoExec:!0,kMenuBar:!0});break;case rt:Qe(k,Ht),Qe(Ze,Ht),Qe(Ue,Ht),_(Ht,{fGeoAtt:0,fFinder:null,fMedium:null,fNodes:null,fNtotal:0,fNumber:0,fRefCount:0,fShape:null,fVoxels:null});break;case ct:Qe(k,Ht),_(Ht,{fGeoAtt:0,fMother:null,fNovlp:0,fNumber:0,fOverlaps:null,fVolume:null});break;case zt:Qe(ct,Ht),_(Ht,{fMatrix:null});break;case"TGeoTrack":Qe(R,Ht),Qe(Ze,Ht),Qe(Oe,Ht),_(Ht,{fGeoAtt:0,fNpoints:0,fPoints:[]});break;case Fe:Qe(R,Ht),Qe(Ze,Ht),_(Ht,{fLastPoint:-1,fN:0,fOption:"",fP:[]});break;case At:Qe(R,Ht),Qe(Oe,Ht),_(Ht,{fLastPoint:-1,fN:0,fName:"",fOption:"",fP:[]})}return Ht._typename=mn,C(Ht,mn),Ht}function ut(mn,jn,Ht,Oi){const Sn=Qe(mn);if(!Sn.fXaxis||!Sn.fYaxis||!Sn.fZaxis)return null;switch(Sn.fName="hist",Sn.fTitle="title",jn&&_(Sn.fXaxis,{fNbins:jn,fXmin:0,fXmax:jn}),Ht&&_(Sn.fYaxis,{fNbins:Ht,fXmin:0,fXmax:Ht}),Oi&&_(Sn.fZaxis,{fNbins:Oi,fXmin:0,fXmax:Oi}),parseInt(mn[2])){case 1:jn&&(Sn.fNcells=jn+2);break;case 2:jn&&Ht&&(Sn.fNcells=(jn+2)*(Ht+2));break;case 3:jn&&Ht&&Oi&&(Sn.fNcells=(jn+2)*(Ht+2)*(Oi+2))}if(Sn.fNcells>0){switch(mn[3]){case"C":Sn.fArray=new Int8Array(Sn.fNcells);break;case"S":Sn.fArray=new Int16Array(Sn.fNcells);break;case"I":Sn.fArray=new Int32Array(Sn.fNcells);break;case"F":Sn.fArray=new Float32Array(Sn.fNcells);break;case"L":case"D":Sn.fArray=new Float64Array(Sn.fNcells);break;default:Sn.fArray=new Array(Sn.fNcells)}Sn.fArray.fill(0)}return Sn}function _t(mn,jn){if(mn)if(jn.indexOf(";")<0)mn.fTitle=jn;else{const Ht=jn.split(";");mn.fTitle=Ht[0],Ht.length>1&&(mn.fXaxis.fTitle=Ht[1]),Ht.length>2&&(mn.fYaxis.fTitle=Ht[2]),Ht.length>3&&(mn.fZaxis.fTitle=Ht[3])}}function Lt(mn,jn){const Ht=Qe(me);return mn&&(Ht.fN=mn,jn?(Ht.fX=new Int32Array(mn),Ht.fY=new Int32Array(mn)):(Ht.fX=new Float32Array(mn),Ht.fY=new Float32Array(mn))),Ht}function xn(mn,jn,Ht){const Oi=_(Qe(ht),{fBits:1032,fName:"graph",fTitle:"title"});if(mn>0){Oi.fMaxSize=Oi.fNpoints=mn;const Sn=Ki(jn)&&jn.length===mn,Wn=Ki(Ht)&&Ht.length===mn;for(let yr=0;yr<mn;++yr)Oi.fX.push(Sn?jn[yr]:yr/mn),Oi.fY.push(Wn?Ht[yr]:yr/mn)}return Oi}function rn(){const mn=Qe(gt);for(let jn=0;jn<arguments.length;++jn)mn.fHists.Add(arguments[jn],"");return mn}function Xt(){const mn=Qe(st);for(let jn=0;jn<arguments.length;++jn)mn.fGraphs.Add(arguments[jn],"");return mn}const cn={};function Pn(mn,jn){let Ht=cn[mn];const Oi=void 0!==Ht;return Oi||(Ht={}),(mn===R||mn===k||void 0!==jn?.fBits)&&typeof Ht.TestBit>"u"&&(Ht.TestBit=function(Sn){return!!(this.fBits&Sn)},Ht.InvertBit=function(Sn){this.fBits=this.fBits^16777215&Sn}),Oi||((mn===Pe||mn===We)&&(Ht.Clear=function(){this.arr=[],this.opt=[]},Ht.Add=function(Sn,Wn){this.arr.push(Sn),this.opt.push(vr(Wn)?Wn:"")},Ht.AddFirst=function(Sn,Wn){this.arr.unshift(Sn),this.opt.unshift(vr(Wn)?Wn:"")},Ht.RemoveAt=function(Sn){this.arr.splice(Sn,1),this.opt.splice(Sn,1)}),(mn===Qt||mn===Bn)&&(Ht.AddText=function(Sn){const Wn=Qe(Tr);Wn.fTitle=Sn,Wn.fTextAlign=0,Wn.fTextColor=0,Wn.fTextFont=0,Wn.fTextSize=0,this.fLines.Add(Wn)},Ht.Clear=function(){this.fLines.Clear()}),(0===mn.indexOf(S)||mn===Z)&&(Ht.addFormula=function(Sn){Sn&&(void 0===this.formulas&&(this.formulas=[]),this.formulas.push(Sn))},Ht.GetParName=function(Sn){if(this.fParams?.fParNames)return this.fParams.fParNames[Sn];if(this.fFormula?.fParams)for(let Wn=0,yr=this.fFormula.fParams;Wn<yr.length;++Wn)if(yr[Wn].second===Sn)return yr[Wn].first;return this.fNames&&this.fNames[Sn]?this.fNames[Sn]:`p${Sn}`},Ht.GetParValue=function(Sn){return this.fParams?.fParameters?this.fParams.fParameters[Sn]:this.fFormula?.fClingParameters?this.fFormula.fClingParameters[Sn]:this.fParams?this.fParams[Sn]:void 0},Ht.GetParError=function(Sn){return this.fParErrors?this.fParErrors[Sn]:void 0},Ht.GetNumPars=function(){return this.fNpar}),(0===mn.indexOf(ht)||mn===yt)&&mn!==An&&mn!==on&&(Ht.IsInside=function(Sn,Wn){const yr=this.fX,cr=this.fY;let Cs=0,Zr=this.fNpoints-1,ci=!1;for(;Cs<this.fNpoints;++Cs)(cr[Cs]<Wn&&cr[Zr]>=Wn||cr[Zr]<Wn&&cr[Cs]>=Wn)&&yr[Cs]+(Wn-cr[Cs])/(cr[Zr]-cr[Cs])*(yr[Zr]-yr[Cs])<Sn&&(ci=!ci),Zr=Cs;return ci}),(0===mn.indexOf(Rn)||0===mn.indexOf(Zt)||0===mn.indexOf($))&&(Ht.getBinError=function(Sn){return Sn>=this.fNcells&&(Sn=this.fNcells-1),Sn<0&&(Sn=0),Sn<this.fSumw2.length?Math.sqrt(this.fSumw2[Sn]):Math.sqrt(Math.abs(this.fArray[Sn]))},Ht.setBinContent=function(Sn,Wn){this.fEntries++,this.fTsumw=0,Sn>=0&&Sn<this.fArray.length&&(this.fArray[Sn]=Wn)}),0===mn.indexOf(Rn)&&(Ht.getBin=function(Sn){return Sn},Ht.getBinContent=function(Sn){return this.fArray[Sn]},Ht.Fill=function(Sn,Wn){const yr=this.fXaxis,cr=Math.max(0,1+Math.min(yr.fNbins,Math.floor((Sn-yr.fXmin)/(yr.fXmax-yr.fXmin)*yr.fNbins)));this.fArray[cr]+=Wn??1,this.fEntries++}),0===mn.indexOf(Zt)&&(Ht.getBin=function(Sn,Wn){return Sn+(this.fXaxis.fNbins+2)*Wn},Ht.getBinContent=function(Sn,Wn){return this.fArray[this.getBin(Sn,Wn)]},Ht.Fill=function(Sn,Wn,yr){const cr=this.fXaxis,Cs=this.fYaxis,Zr=Math.max(0,1+Math.min(cr.fNbins,Math.floor((Sn-cr.fXmin)/(cr.fXmax-cr.fXmin)*cr.fNbins))),ci=Math.max(0,1+Math.min(Cs.fNbins,Math.floor((Wn-Cs.fXmin)/(Cs.fXmax-Cs.fXmin)*Cs.fNbins)));this.fArray[Zr+(cr.fNbins+2)*ci]+=yr??1,this.fEntries++}),0===mn.indexOf($)&&(Ht.getBin=function(Sn,Wn,yr){return Sn+(this.fXaxis.fNbins+2)*(Wn+(this.fYaxis.fNbins+2)*yr)},Ht.getBinContent=function(Sn,Wn,yr){return this.fArray[this.getBin(Sn,Wn,yr)]},Ht.Fill=function(Sn,Wn,yr,cr){const Cs=this.fXaxis,Zr=this.fYaxis,ci=this.fZaxis,Gs=Math.max(0,1+Math.min(Cs.fNbins,Math.floor((Sn-Cs.fXmin)/(Cs.fXmax-Cs.fXmin)*Cs.fNbins))),os=Math.max(0,1+Math.min(Zr.fNbins,Math.floor((Wn-Zr.fXmin)/(Zr.fXmax-Zr.fXmin)*Zr.fNbins))),Sa=Math.max(0,1+Math.min(ci.fNbins,Math.floor((yr-ci.fXmin)/(ci.fXmax-ci.fXmin)*ci.fNbins)));this.fArray[Gs+(Cs.fNbins+2)*(os+(Zr.fNbins+2)*Sa)]+=cr??1,this.fEntries++}),(mn===St||mn===xt)&&(Ht.Divide=function(Sn,Wn,yr=.01,cr=.01){if(!Wn){const Gs=Sn;if(Gs<2)return this;(Sn=Wn=Math.round(Math.sqrt(Gs)))*Wn<Gs&&(Sn+=1)}if(Sn*Wn<2)return 0;this.fPrimitives.Clear();const Cs=1/Wn,Zr=1/Sn;let ci=0;for(let Gs=0;Gs<Wn;Gs++){const os=1-Gs*Cs-cr;let Sa=os-Cs+2*cr;if(Sa<0&&(Sa=0),!(Sa>os))for(let Md=0;Md<Sn;Md++){const hu=Md*Zr+yr,Yu=hu+Zr-2*yr;if(hu>Yu)continue;ci++;const da=Qe(St);da.fName=da.fTitle=`${this.fName}_${ci}`,da.fNumber=ci,this._typename!==xt?(da.fAbsWNDC=(Yu-hu)*this.fAbsWNDC,da.fAbsHNDC=(os-Sa)*this.fAbsHNDC,da.fAbsXlowNDC=this.fAbsXlowNDC+hu*this.fAbsWNDC,da.fAbsYlowNDC=this.fAbsYlowNDC+Sa*this.fAbsWNDC):(da.fAbsWNDC=Yu-hu,da.fAbsHNDC=os-Sa,da.fAbsXlowNDC=hu,da.fAbsYlowNDC=Sa),this.fPrimitives.Add(da)}}return Sn*Wn},Ht.GetPad=function(Sn){return this.fPrimitives.arr.find(Wn=>Wn._typename===St&&Wn.fNumber===Sn)}),0===mn.indexOf(Ce)&&(mn===nt?(Ht.getBin=function(Sn,Wn,yr){return Sn+(this.fXaxis.fNbins+2)*(Wn+(this.fYaxis.fNbins+2)*yr)},Ht.getBinContent=function(Sn,Wn,yr){const cr=this.getBin(Sn,Wn,yr);return cr<0||cr>=this.fNcells||this.fBinEntries[cr]<1e-300?0:this.fArray?this.fArray[cr]/this.fBinEntries[cr]:0},Ht.getBinEntries=function(Sn,Wn,yr){const cr=this.getBin(Sn,Wn,yr);return cr<0||cr>=this.fNcells?0:this.fBinEntries[cr]}):mn===$e?(Ht.getBin=function(Sn,Wn){return Sn+(this.fXaxis.fNbins+2)*Wn},Ht.getBinContent=function(Sn,Wn){const yr=this.getBin(Sn,Wn);return yr<0||yr>=this.fNcells||this.fBinEntries[yr]<1e-300||!this.fArray?0:this.fArray[yr]/this.fBinEntries[yr]},Ht.getBinEntries=function(Sn,Wn){const yr=this.getBin(Sn,Wn);return yr<0||yr>=this.fNcells?0:this.fBinEntries[yr]}):(Ht.getBin=function(Sn){return Sn},Ht.getBinContent=function(Sn){return Sn<0||Sn>=this.fNcells||this.fBinEntries[Sn]<1e-300||!this.fArray?0:this.fArray[Sn]/this.fBinEntries[Sn]}),Ht.getBinEffectiveEntries=function(Sn){if(Sn<0||Sn>=this.fNcells)return 0;const Wn=this.fBinEntries[Sn];if(!this.fBinSumw2||this.fBinSumw2.length!==this.fNcells)return Wn;const yr=this.fBinSumw2[Sn];return yr>0?Wn*Wn/yr:0},Ht.getBinError=function(Sn){if(Sn<0||Sn>=this.fNcells)return 0;const Wn=this.fArray[Sn],yr=this.fBinEntries[Sn],cr=this.fSumw2[Sn],Cs=this.getBinEffectiveEntries(Sn);if(yr<1e-300)return 0;if(3===this.fErrorMode)return 1/Math.sqrt(yr);const Gs=Math.sqrt(Math.abs(cr/yr-(Wn/yr)**2));return 2===this.fErrorMode?0!==Gs?Gs/Math.sqrt(Cs):1/Math.sqrt(12*Cs):1===this.fErrorMode?Gs:Gs/Math.sqrt(Cs)}),mn===Un&&(Ht.GetBinLowEdge=function(Sn){return this.fNbins<=0?0:this.fXbins.length>0&&Sn>0&&Sn<=this.fNbins?this.fXbins[Sn-1]:this.fXmin+(Sn-1)*(this.fXmax-this.fXmin)/this.fNbins},Ht.GetBinCenter=function(Sn){return this.fNbins<=0?0:this.fXbins.length>0&&Sn>0&&Sn<this.fNbins?(this.fXbins[Sn-1]+this.fXbins[Sn])/2:this.fXmin+(Sn-.5)*(this.fXmax-this.fXmin)/this.fNbins}),0===mn.indexOf("ROOT::Math::LorentzVector")&&(Ht.Px=Ht.X=function(){return this.fCoordinates.Px()},Ht.Py=Ht.Y=function(){return this.fCoordinates.Py()},Ht.Pz=Ht.Z=function(){return this.fCoordinates.Pz()},Ht.E=Ht.T=function(){return this.fCoordinates.E()},Ht.M2=function(){return this.fCoordinates.M2()},Ht.M=function(){return this.fCoordinates.M()},Ht.R=Ht.P=function(){return this.fCoordinates.R()},Ht.P2=function(){return this.P()*this.P()},Ht.Pt=Ht.pt=function(){return Math.sqrt(this.P2())},Ht.Phi=Ht.phi=function(){return Math.atan2(this.fCoordinates.Py(),this.fCoordinates.Px())},Ht.Eta=Ht.eta=function(){return Math.atanh(this.Pz()/this.P())}),0===mn.indexOf("ROOT::Math::PxPyPzE4D")&&(Ht.Px=Ht.X=function(){return this.fX},Ht.Py=Ht.Y=function(){return this.fY},Ht.Pz=Ht.Z=function(){return this.fZ},Ht.E=Ht.T=function(){return this.fT},Ht.P2=function(){return this.fX**2+this.fY**2+this.fZ**2},Ht.R=Ht.P=function(){return Math.sqrt(this.P2())},Ht.Mag2=Ht.M2=function(){return this.fT**2-this.fX**2-this.fY**2-this.fZ**2},Ht.Mag=Ht.M=function(){return this.M2()>=0?Math.sqrt(this.M2()):-Math.sqrt(-this.M2())},Ht.Perp2=Ht.Pt2=function(){return this.fX**2+this.fY**2},Ht.Pt=Ht.pt=function(){return Math.sqrt(this.P2())},Ht.Phi=Ht.phi=function(){return Math.atan2(this.fY,this.fX)},Ht.Eta=Ht.eta=function(){return Math.atanh(this.Pz/this.P())}),cn[mn]=Ht),Ht}function Zn(mn,jn){cn[mn]=jn}function Ui(mn,jn){if(Ki(mn)){if(mn.$kind===Pe||mn.$kind===Q)return!0;jn||(jn=mn._typename)}return jn===Pe||jn===We||jn===dt||jn===Q||jn===Ke}function Ki(mn){return mn&&"object"==typeof mn}function Ii(mn){return"function"==typeof mn}function vr(mn){return"string"==typeof mn}function $r(mn){return Ki(mn)&&Ii(mn.then)}function yo(mn,jn){return new Promise(Ht=>{setTimeout(()=>{const Oi=Ii(mn)?mn():mn;Ht(Oi)},jn)})}function Ho(mn){return $r(mn)?mn:Promise.resolve(mn)}function vs(){return Us.apply(this,arguments)}function Us(){return(Us=(0,ve.A)(function*(){return(globalThis.JSROOT?Promise.resolve(!0):w(Xe+"scripts/JSRoot.core.js")).then(()=>{if(globalThis.JSROOT?._complete_loading)return globalThis.JSROOT._complete_loading()}).then(()=>globalThis.JSROOT)})).apply(this,arguments)}le.fXaxis=Qe(ln),le.fYaxis=Qe(ln),le.fZaxis=Qe(ln)},5680:(Ur,vt,Ee)=>{"use strict";function b(y,G,ye){y.prototype=G.prototype=ye,ye.constructor=y}function z(y,G){var ye=Object.create(y.prototype);for(var we in G)ye[we]=G[we];return ye}function ke(){}Ee.d(vt,{$E:()=>M1,DC:()=>Xg,D_:()=>th,F6:()=>zt,JL:()=>Cv,JQ:()=>xt,Lt:()=>Zu,Qh:()=>v,Wn:()=>EA,ZE:()=>cf,aL:()=>Kg,aX:()=>RA,m4:()=>Bl,w7:()=>Oh,yW:()=>D});var et=1/.7,Je="\\s*([+-]?\\d+)\\s*",Xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Re=/^#([0-9a-f]{3,8})$/,He=new RegExp(`^rgb\\(${Je},${Je},${Je}\\)$`),Ie=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),O=new RegExp(`^rgba\\(${Je},${Je},${Je},${Xe}\\)$`),ce=new RegExp(`^rgba\\(${ot},${ot},${ot},${Xe}\\)$`),ie=new RegExp(`^hsl\\(${Xe},${ot},${ot}\\)$`),he=new RegExp(`^hsla\\(${Xe},${ot},${ot},${Xe}\\)$`),ue={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function fe(){return this.rgb().formatHex()}function V(){return this.rgb().formatRgb()}function D(y){var G,ye;return y=(y+"").trim().toLowerCase(),(G=Re.exec(y))?(ye=G[1].length,G=parseInt(G[1],16),6===ye?w(G):3===ye?new _(G>>8&15|G>>4&240,G>>4&15|240&G,(15&G)<<4|15&G,1):8===ye?P(G>>24&255,G>>16&255,G>>8&255,(255&G)/255):4===ye?P(G>>12&15|G>>8&240,G>>8&15|G>>4&240,G>>4&15|240&G,((15&G)<<4|15&G)/255):null):(G=He.exec(y))?new _(G[1],G[2],G[3],1):(G=Ie.exec(y))?new _(255*G[1]/100,255*G[2]/100,255*G[3]/100,1):(G=O.exec(y))?P(G[1],G[2],G[3],G[4]):(G=ce.exec(y))?P(255*G[1]/100,255*G[2]/100,255*G[3]/100,G[4]):(G=ie.exec(y))?N(G[1],G[2]/100,G[3]/100,1):(G=he.exec(y))?N(G[1],G[2]/100,G[3]/100,G[4]):ue.hasOwnProperty(y)?w(ue[y]):"transparent"===y?new _(NaN,NaN,NaN,0):null}function w(y){return new _(y>>16&255,y>>8&255,255&y,1)}function P(y,G,ye,we){return we<=0&&(y=G=ye=NaN),new _(y,G,ye,we)}function x(y){return y instanceof ke||(y=D(y)),y?new _((y=y.rgb()).r,y.g,y.b,y.opacity):new _}function v(y,G,ye,we){return 1===arguments.length?x(y):new _(y,G,ye,we??1)}function _(y,G,ye,we){this.r=+y,this.g=+G,this.b=+ye,this.opacity=+we}function C(){return`#${te(this.r)}${te(this.g)}${te(this.b)}`}function F(){const y=U(this.opacity);return`${1===y?"rgb(":"rgba("}${j(this.r)}, ${j(this.g)}, ${j(this.b)}${1===y?")":`, ${y})`}`}function U(y){return isNaN(y)?1:Math.max(0,Math.min(1,y))}function j(y){return Math.max(0,Math.min(255,Math.round(y)||0))}function te(y){return((y=j(y))<16?"0":"")+y.toString(16)}function N(y,G,ye,we){return we<=0?y=G=ye=NaN:ye<=0||ye>=1?y=G=NaN:G<=0&&(y=NaN),new A(y,G,ye,we)}function m(y){if(y instanceof A)return new A(y.h,y.s,y.l,y.opacity);if(y instanceof ke||(y=D(y)),!y)return new A;if(y instanceof A)return y;var G=(y=y.rgb()).r/255,ye=y.g/255,we=y.b/255,tt=Math.min(G,ye,we),pt=Math.max(G,ye,we),Ct=NaN,Pt=pt-tt,$t=(pt+tt)/2;return Pt?(Ct=G===pt?(ye-we)/Pt+6*(ye<we):ye===pt?(we-G)/Pt+2:(G-ye)/Pt+4,Pt/=$t<.5?pt+tt:2-pt-tt,Ct*=60):Pt=$t>0&&$t<1?0:Ct,new A(Ct,Pt,$t,y.opacity)}function A(y,G,ye,we){this.h=+y,this.s=+G,this.l=+ye,this.opacity=+we}function R(y){return(y=(y||0)%360)<0?y+360:y}function k(y){return Math.max(0,Math.min(1,y||0))}function J(y,G,ye){return 255*(y<60?G+(ye-G)*y/60:y<180?ye:y<240?G+(ye-G)*(240-y)/60:G)}b(ke,D,{copy(y){return Object.assign(new this.constructor,this,y)},displayable(){return this.rgb().displayable()},hex:fe,formatHex:fe,formatHex8:function le(){return this.rgb().formatHex8()},formatHsl:function Y(){return m(this).formatHsl()},formatRgb:V,toString:V}),b(_,v,z(ke,{brighter(y){return y=null==y?et:Math.pow(et,y),new _(this.r*y,this.g*y,this.b*y,this.opacity)},darker(y){return y=null==y?.7:Math.pow(.7,y),new _(this.r*y,this.g*y,this.b*y,this.opacity)},rgb(){return this},clamp(){return new _(j(this.r),j(this.g),j(this.b),U(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatHex8:function L(){return`#${te(this.r)}${te(this.g)}${te(this.b)}${te(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:F,toString:F})),b(A,function I(y,G,ye,we){return 1===arguments.length?m(y):new A(y,G,ye,we??1)},z(ke,{brighter(y){return y=null==y?et:Math.pow(et,y),new A(this.h,this.s,this.l*y,this.opacity)},darker(y){return y=null==y?.7:Math.pow(.7,y),new A(this.h,this.s,this.l*y,this.opacity)},rgb(){var y=this.h%360+360*(this.h<0),G=isNaN(y)||isNaN(this.s)?0:this.s,ye=this.l,we=ye+(ye<.5?ye:1-ye)*G,tt=2*ye-we;return new _(J(y>=240?y-240:y+120,tt,we),J(y,tt,we),J(y<120?y+240:y-120,tt,we),this.opacity)},clamp(){return new A(R(this.h),k(this.s),k(this.l),U(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const y=U(this.opacity);return`${1===y?"hsl(":"hsla("}${R(this.h)}, ${100*k(this.s)}%, ${100*k(this.l)}%${1===y?")":`, ${y})`}`}}));const _e=Math.PI/180,be=180/Math.PI,Pe=.96422,We=1,dt=.82521,Q=4/29,Ke=6/29,Ze=3*Ke*Ke,Ue=Ke*Ke*Ke;function Oe(y){if(y instanceof ht)return new ht(y.l,y.a,y.b,y.opacity);if(y instanceof pn)return Qt(y);y instanceof _||(y=x(y));var pt,Ct,G=Ot(y.r),ye=Ot(y.g),we=Ot(y.b),tt=st((.2225045*G+.7168786*ye+.0606169*we)/We);return G===ye&&ye===we?pt=Ct=tt:(pt=st((.4360747*G+.3850649*ye+.1430804*we)/Pe),Ct=st((.0139322*G+.0971045*ye+.7141733*we)/dt)),new ht(116*tt-16,500*(pt-tt),200*(tt-Ct),y.opacity)}function ht(y,G,ye,we){this.l=+y,this.a=+G,this.b=+ye,this.opacity=+we}function st(y){return y>Ue?Math.pow(y,1/3):y/Ze+Q}function yt(y){return y>Ke?y*y*y:Ze*(y-Q)}function Kt(y){return 255*(y<=.0031308?12.92*y:1.055*Math.pow(y,1/2.4)-.055)}function Ot(y){return(y/=255)<=.04045?y/12.92:Math.pow((y+.055)/1.055,2.4)}function pn(y,G,ye,we){this.h=+y,this.c=+G,this.l=+ye,this.opacity=+we}function Qt(y){if(isNaN(y.h))return new ht(y.l,0,0,y.opacity);var G=y.h*_e;return new ht(y.l,Math.cos(G)*y.c,Math.sin(G)*y.c,y.opacity)}b(ht,function gt(y,G,ye,we){return 1===arguments.length?Oe(y):new ht(y,G,ye,we??1)},z(ke,{brighter(y){return new ht(this.l+18*(y??1),this.a,this.b,this.opacity)},darker(y){return new ht(this.l-18*(y??1),this.a,this.b,this.opacity)},rgb(){var y=(this.l+16)/116,G=isNaN(this.a)?y:y+this.a/500,ye=isNaN(this.b)?y:y-this.b/200;return new _(Kt(3.1338561*(G=Pe*yt(G))-1.6168667*(y=We*yt(y))-.4906146*(ye=dt*yt(ye))),Kt(-.9787684*G+1.9161415*y+.033454*ye),Kt(.0719453*G-.2289914*y+1.4052427*ye),this.opacity)}})),b(pn,function on(y,G,ye,we){return 1===arguments.length?function It(y){if(y instanceof pn)return new pn(y.h,y.c,y.l,y.opacity);if(y instanceof ht||(y=Oe(y)),0===y.a&&0===y.b)return new pn(NaN,0<y.l&&y.l<100?0:NaN,y.l,y.opacity);var G=Math.atan2(y.b,y.a)*be;return new pn(G<0?G+360:G,Math.sqrt(y.a*y.a+y.b*y.b),y.l,y.opacity)}(y):new pn(y,G,ye,we??1)},z(ke,{brighter(y){return new pn(this.h,this.c,this.l+18*(y??1),this.opacity)},darker(y){return new pn(this.h,this.c,this.l-18*(y??1),this.opacity)},rgb(){return Qt(this).rgb()}}));var dn=1.78277,yn=-.29227,Tn=-.90649,Hn=1.97294,ti=Hn*Tn,hi=Hn*dn,ai=dn*yn- -.14861*Tn;function Tr(y,G,ye,we){this.h=+y,this.s=+G,this.l=+ye,this.opacity=+we}b(Tr,function Or(y,G,ye,we){return 1===arguments.length?function Xi(y){if(y instanceof Tr)return new Tr(y.h,y.s,y.l,y.opacity);y instanceof _||(y=x(y));var ye=y.g/255,we=y.b/255,tt=(ai*we+ti*(y.r/255)-hi*ye)/(ai+ti-hi),pt=we-tt,Ct=(Hn*(ye-tt)-yn*pt)/Tn,Pt=Math.sqrt(Ct*Ct+pt*pt)/(Hn*tt*(1-tt)),$t=Pt?Math.atan2(Ct,pt)*be-120:NaN;return new Tr($t<0?$t+360:$t,Pt,tt,y.opacity)}(y):new Tr(y,G,ye,we??1)},z(ke,{brighter(y){return y=null==y?et:Math.pow(et,y),new Tr(this.h,this.s,this.l*y,this.opacity)},darker(y){return y=null==y?.7:Math.pow(.7,y),new Tr(this.h,this.s,this.l*y,this.opacity)},rgb(){var y=isNaN(this.h)?0:(this.h+120)*_e,G=+this.l,ye=isNaN(this.s)?0:this.s*G*(1-G),we=Math.cos(y),tt=Math.sin(y);return new _(255*(G+ye*(-.14861*we+dn*tt)),255*(G+ye*(yn*we+Tn*tt)),255*(G+ye*(Hn*we)),this.opacity)}}));var ys=Math.abs,ds=Math.cos,wt=Math.sin,W=Math.PI,pe=W/2,me=2*W,Fe=Math.max,At=1e-12;function Et(y,G){return Array.from({length:G-y},(ye,we)=>y+we)}function xt(){return function Cn(y,G){var ye=0,we=null,tt=null,pt=null;function Ct(Pt){var wr,$t=Pt.length,Yt=new Array($t),hn=Et(0,$t),Kn=new Array($t*$t),Xn=new Array($t),xi=0;Pt=Float64Array.from({length:$t*$t},G?(ir,ur)=>Pt[ur%$t][ur/$t|0]:(ir,ur)=>Pt[ur/$t|0][ur%$t]);for(let ir=0;ir<$t;++ir){let ur=0;for(let ss=0;ss<$t;++ss)ur+=Pt[ir*$t+ss]+y*Pt[ss*$t+ir];xi+=Yt[ir]=ur}wr=(xi=Fe(0,me-ye*$t)/xi)?ye:me/$t;{let ir=0;we&&hn.sort((ur,ss)=>we(Yt[ur],Yt[ss]));for(const ur of hn){const ss=ir;if(y){const Io=Et(1+~$t,$t).filter(Ir=>Ir<0?Pt[~Ir*$t+ur]:Pt[ur*$t+Ir]);tt&&Io.sort((Ir,Wi)=>tt(Ir<0?-Pt[~Ir*$t+ur]:Pt[ur*$t+Ir],Wi<0?-Pt[~Wi*$t+ur]:Pt[ur*$t+Wi]));for(const Ir of Io)Ir<0?(Kn[~Ir*$t+ur]||(Kn[~Ir*$t+ur]={source:null,target:null})).target={index:ur,startAngle:ir,endAngle:ir+=Pt[~Ir*$t+ur]*xi,value:Pt[~Ir*$t+ur]}:(Kn[ur*$t+Ir]||(Kn[ur*$t+Ir]={source:null,target:null})).source={index:ur,startAngle:ir,endAngle:ir+=Pt[ur*$t+Ir]*xi,value:Pt[ur*$t+Ir]};Xn[ur]={index:ur,startAngle:ss,endAngle:ir,value:Yt[ur]}}else{const Io=Et(0,$t).filter(Ir=>Pt[ur*$t+Ir]||Pt[Ir*$t+ur]);tt&&Io.sort((Ir,Wi)=>tt(Pt[ur*$t+Ir],Pt[ur*$t+Wi]));for(const Ir of Io){let Wi;if(ur<Ir?(Wi=Kn[ur*$t+Ir]||(Kn[ur*$t+Ir]={source:null,target:null}),Wi.source={index:ur,startAngle:ir,endAngle:ir+=Pt[ur*$t+Ir]*xi,value:Pt[ur*$t+Ir]}):(Wi=Kn[Ir*$t+ur]||(Kn[Ir*$t+ur]={source:null,target:null}),Wi.target={index:ur,startAngle:ir,endAngle:ir+=Pt[ur*$t+Ir]*xi,value:Pt[ur*$t+Ir]},ur===Ir&&(Wi.source=Wi.target)),Wi.source&&Wi.target&&Wi.source.value<Wi.target.value){const Os=Wi.source;Wi.source=Wi.target,Wi.target=Os}}Xn[ur]={index:ur,startAngle:ss,endAngle:ir,value:Yt[ur]}}ir+=wr}}return(Kn=Object.values(Kn)).groups=Xn,pt?Kn.sort(pt):Kn}return Ct.padAngle=function(Pt){return arguments.length?(ye=Fe(0,Pt),Ct):ye},Ct.sortGroups=function(Pt){return arguments.length?(we=Pt,Ct):we},Ct.sortSubgroups=function(Pt){return arguments.length?(tt=Pt,Ct):tt},Ct.sortChords=function(Pt){return arguments.length?(null==Pt?pt=null:(pt=function St(y){return function(G,ye){return y(G.source.value+G.target.value,ye.source.value+ye.target.value)}}(Pt))._=Pt,Ct):pt&&pt._},Ct}(!1,!1)}const ln=Math.PI,Un=2*ln,Ci=1e-6,Rn=Un-Ci;function si(y){this._+=y[0];for(let G=1,ye=y.length;G<ye;++G)this._+=arguments[G]+y[G]}class Zt{constructor(G){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==G?si:function Fn(y){let G=Math.floor(y);if(!(G>=0))throw new Error(`invalid digits: ${y}`);if(G>15)return si;const ye=10**G;return function(we){this._+=we[0];for(let tt=1,pt=we.length;tt<pt;++tt)this._+=Math.round(arguments[tt]*ye)/ye+we[tt]}}(G)}moveTo(G,ye){this._append`M${this._x0=this._x1=+G},${this._y0=this._y1=+ye}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(G,ye){this._append`L${this._x1=+G},${this._y1=+ye}`}quadraticCurveTo(G,ye,we,tt){this._append`Q${+G},${+ye},${this._x1=+we},${this._y1=+tt}`}bezierCurveTo(G,ye,we,tt,pt,Ct){this._append`C${+G},${+ye},${+we},${+tt},${this._x1=+pt},${this._y1=+Ct}`}arcTo(G,ye,we,tt,pt){if(G=+G,ye=+ye,we=+we,tt=+tt,(pt=+pt)<0)throw new Error(`negative radius: ${pt}`);let Ct=this._x1,Pt=this._y1,$t=we-G,Yt=tt-ye,hn=Ct-G,Kn=Pt-ye,Xn=hn*hn+Kn*Kn;if(null===this._x1)this._append`M${this._x1=G},${this._y1=ye}`;else if(Xn>Ci)if(Math.abs(Kn*$t-Yt*hn)>Ci&&pt){let xi=we-Ct,wr=tt-Pt,ir=$t*$t+Yt*Yt,ur=xi*xi+wr*wr,ss=Math.sqrt(ir),Io=Math.sqrt(Xn),Ir=pt*Math.tan((ln-Math.acos((ir+Xn-ur)/(2*ss*Io)))/2),Wi=Ir/Io,Os=Ir/ss;Math.abs(Wi-1)>Ci&&this._append`L${G+Wi*hn},${ye+Wi*Kn}`,this._append`A${pt},${pt},0,0,${+(Kn*xi>hn*wr)},${this._x1=G+Os*$t},${this._y1=ye+Os*Yt}`}else this._append`L${this._x1=G},${this._y1=ye}`}arc(G,ye,we,tt,pt,Ct){if(G=+G,ye=+ye,Ct=!!Ct,(we=+we)<0)throw new Error(`negative radius: ${we}`);let Pt=we*Math.cos(tt),$t=we*Math.sin(tt),Yt=G+Pt,hn=ye+$t,Kn=1^Ct,Xn=Ct?tt-pt:pt-tt;null===this._x1?this._append`M${Yt},${hn}`:(Math.abs(this._x1-Yt)>Ci||Math.abs(this._y1-hn)>Ci)&&this._append`L${Yt},${hn}`,we&&(Xn<0&&(Xn=Xn%Un+Un),Xn>Rn?this._append`A${we},${we},0,1,${Kn},${G-Pt},${ye-$t}A${we},${we},0,1,${Kn},${this._x1=Yt},${this._y1=hn}`:Xn>Ci&&this._append`A${we},${we},0,${+(Xn>=ln)},${Kn},${this._x1=G+we*Math.cos(pt)},${this._y1=ye+we*Math.sin(pt)}`)}rect(G,ye,we,tt){this._append`M${this._x0=this._x1=+G},${this._y0=this._y1=+ye}h${we=+we}v${+tt}h${-we}Z`}toString(){return this._}}function tr(){return new Zt}tr.prototype=Zt.prototype;var Ne=Array.prototype.slice;function $(y){return function(){return y}}function S(y){return y.source}function Z(y){return y.target}function Ae(y){return y.radius}function Ce(y){return y.startAngle}function $e(y){return y.endAngle}function nt(){return 0}function zt(){return function ct(y){var G=S,ye=Z,we=Ae,tt=Ae,pt=Ce,Ct=$e,Pt=nt,$t=null;function Yt(){var hn,Kn=G.apply(this,arguments),Xn=ye.apply(this,arguments),xi=Pt.apply(this,arguments)/2,wr=Ne.call(arguments),ir=+we.apply(this,(wr[0]=Kn,wr)),ur=pt.apply(this,wr)-pe,ss=Ct.apply(this,wr)-pe,Io=+tt.apply(this,(wr[0]=Xn,wr)),Ir=pt.apply(this,wr)-pe,Wi=Ct.apply(this,wr)-pe;if($t||($t=hn=tr()),xi>At&&(ys(ss-ur)>2*xi+At?ss>ur?(ur+=xi,ss-=xi):(ur-=xi,ss+=xi):ur=ss=(ur+ss)/2,ys(Wi-Ir)>2*xi+At?Wi>Ir?(Ir+=xi,Wi-=xi):(Ir-=xi,Wi+=xi):Ir=Wi=(Ir+Wi)/2),$t.moveTo(ir*ds(ur),ir*wt(ur)),$t.arc(0,0,ir,ur,ss),ur!==Ir||ss!==Wi)if(y){var ls=Io-+y.apply(this,arguments),Bo=(Ir+Wi)/2;$t.quadraticCurveTo(0,0,ls*ds(Ir),ls*wt(Ir)),$t.lineTo(Io*ds(Bo),Io*wt(Bo)),$t.lineTo(ls*ds(Wi),ls*wt(Wi))}else $t.quadraticCurveTo(0,0,Io*ds(Ir),Io*wt(Ir)),$t.arc(0,0,Io,Ir,Wi);if($t.quadraticCurveTo(0,0,ir*ds(ur),ir*wt(ur)),$t.closePath(),hn)return $t=null,hn+""||null}return y&&(Yt.headRadius=function(hn){return arguments.length?(y="function"==typeof hn?hn:$(+hn),Yt):y}),Yt.radius=function(hn){return arguments.length?(we=tt="function"==typeof hn?hn:$(+hn),Yt):we},Yt.sourceRadius=function(hn){return arguments.length?(we="function"==typeof hn?hn:$(+hn),Yt):we},Yt.targetRadius=function(hn){return arguments.length?(tt="function"==typeof hn?hn:$(+hn),Yt):tt},Yt.startAngle=function(hn){return arguments.length?(pt="function"==typeof hn?hn:$(+hn),Yt):pt},Yt.endAngle=function(hn){return arguments.length?(Ct="function"==typeof hn?hn:$(+hn),Yt):Ct},Yt.padAngle=function(hn){return arguments.length?(Pt="function"==typeof hn?hn:$(+hn),Yt):Pt},Yt.source=function(hn){return arguments.length?(G=hn,Yt):G},Yt.target=function(hn){return arguments.length?(ye=hn,Yt):ye},Yt.context=function(hn){return arguments.length?($t=hn??null,Yt):$t},Yt}()}var nn={value:()=>{}};function Wt(){for(var we,y=0,G=arguments.length,ye={};y<G;++y){if(!(we=arguments[y]+"")||we in ye||/[\s.]/.test(we))throw new Error("illegal type: "+we);ye[we]=[]}return new gn(ye)}function gn(y){this._=y}function Qe(y,G){for(var tt,ye=0,we=y.length;ye<we;++ye)if((tt=y[ye]).name===G)return tt.value}function ut(y,G,ye){for(var we=0,tt=y.length;we<tt;++we)if(y[we].name===G){y[we]=nn,y=y.slice(0,we).concat(y.slice(we+1));break}return null!=ye&&y.push({name:G,value:ye}),y}gn.prototype=Wt.prototype={constructor:gn,on:function(y,G){var tt,ye=this._,we=function ze(y,G){return y.trim().split(/^|\s+/).map(function(ye){var we="",tt=ye.indexOf(".");if(tt>=0&&(we=ye.slice(tt+1),ye=ye.slice(0,tt)),ye&&!G.hasOwnProperty(ye))throw new Error("unknown type: "+ye);return{type:ye,name:we}})}(y+"",ye),pt=-1,Ct=we.length;if(!(arguments.length<2)){if(null!=G&&"function"!=typeof G)throw new Error("invalid callback: "+G);for(;++pt<Ct;)if(tt=(y=we[pt]).type)ye[tt]=ut(ye[tt],y.name,G);else if(null==G)for(tt in ye)ye[tt]=ut(ye[tt],y.name,null);return this}for(;++pt<Ct;)if((tt=(y=we[pt]).type)&&(tt=Qe(ye[tt],y.name)))return tt},copy:function(){var y={},G=this._;for(var ye in G)y[ye]=G[ye].slice();return new gn(y)},call:function(y,G){if((tt=arguments.length-2)>0)for(var tt,pt,ye=new Array(tt),we=0;we<tt;++we)ye[we]=arguments[we+2];if(!this._.hasOwnProperty(y))throw new Error("unknown type: "+y);for(we=0,tt=(pt=this._[y]).length;we<tt;++we)pt[we].value.apply(G,ye)},apply:function(y,G,ye){if(!this._.hasOwnProperty(y))throw new Error("unknown type: "+y);for(var we=this._[y],tt=0,pt=we.length;tt<pt;++tt)we[tt].value.apply(G,ye)}};var _t="http://www.w3.org/1999/xhtml",Lt={svg:"http://www.w3.org/2000/svg",xhtml:_t,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function xn(y){var G=y+="",ye=G.indexOf(":");return ye>=0&&"xmlns"!==(G=y.slice(0,ye))&&(y=y.slice(ye+1)),Lt.hasOwnProperty(G)?{space:Lt[G],local:y}:y}function rn(y){return function(){var G=this.ownerDocument,ye=this.namespaceURI;return ye===_t&&G.documentElement.namespaceURI===_t?G.createElement(y):G.createElementNS(ye,y)}}function Xt(y){return function(){return this.ownerDocument.createElementNS(y.space,y.local)}}function cn(y){var G=xn(y);return(G.local?Xt:rn)(G)}function Pn(){}function Zn(y){return null==y?Pn:function(){return this.querySelector(y)}}function Ii(){return[]}function vr(y){return null==y?Ii:function(){return this.querySelectorAll(y)}}function Ho(y){return function(){return this.matches(y)}}function vs(y){return function(G){return G.matches(y)}}var Us=Array.prototype.find;function jn(){return this.firstElementChild}var Oi=Array.prototype.filter;function Sn(){return Array.from(this.children)}function Cs(y){return new Array(y.length)}function ci(y,G){this.ownerDocument=y.ownerDocument,this.namespaceURI=y.namespaceURI,this._next=null,this._parent=y,this.__data__=G}function os(y,G,ye,we,tt,pt){for(var Pt,Ct=0,$t=G.length,Yt=pt.length;Ct<Yt;++Ct)(Pt=G[Ct])?(Pt.__data__=pt[Ct],we[Ct]=Pt):ye[Ct]=new ci(y,pt[Ct]);for(;Ct<$t;++Ct)(Pt=G[Ct])&&(tt[Ct]=Pt)}function Sa(y,G,ye,we,tt,pt,Ct){var Pt,$t,xi,Yt=new Map,hn=G.length,Kn=pt.length,Xn=new Array(hn);for(Pt=0;Pt<hn;++Pt)($t=G[Pt])&&(Xn[Pt]=xi=Ct.call($t,$t.__data__,Pt,G)+"",Yt.has(xi)?tt[Pt]=$t:Yt.set(xi,$t));for(Pt=0;Pt<Kn;++Pt)xi=Ct.call(y,pt[Pt],Pt,pt)+"",($t=Yt.get(xi))?(we[Pt]=$t,$t.__data__=pt[Pt],Yt.delete(xi)):ye[Pt]=new ci(y,pt[Pt]);for(Pt=0;Pt<hn;++Pt)($t=G[Pt])&&Yt.get(Xn[Pt])===$t&&(tt[Pt]=$t)}function Md(y){return y.__data__}function Yu(y){return"object"==typeof y&&"length"in y?y:Array.from(y)}function Mi(y,G){return y<G?-1:y>G?1:y>=G?0:NaN}function Vo(y){return function(){this.removeAttribute(y)}}function qf(y){return function(){this.removeAttributeNS(y.space,y.local)}}function Cg(y,G){return function(){this.setAttribute(y,G)}}function wA(y,G){return function(){this.setAttributeNS(y.space,y.local,G)}}function g1(y,G){return function(){var ye=G.apply(this,arguments);null==ye?this.removeAttribute(y):this.setAttribute(y,ye)}}function Mg(y,G){return function(){var ye=G.apply(this,arguments);null==ye?this.removeAttributeNS(y.space,y.local):this.setAttributeNS(y.space,y.local,ye)}}function Mm(y){return y.ownerDocument&&y.ownerDocument.defaultView||y.document&&y||y.defaultView}function Sg(y){return function(){this.style.removeProperty(y)}}function tf(y,G,ye){return function(){this.style.setProperty(y,G,ye)}}function Eg(y,G,ye){return function(){var we=G.apply(this,arguments);null==we?this.style.removeProperty(y):this.style.setProperty(y,we,ye)}}function ao(y,G){return y.style.getPropertyValue(G)||Mm(y).getComputedStyle(y,null).getPropertyValue(G)}function ja(y){return function(){delete this[y]}}function rM(y,G){return function(){this[y]=G}}function kx(y,G){return function(){var ye=G.apply(this,arguments);null==ye?delete this[y]:this[y]=ye}}function y1(y){return y.trim().split(/^|\s+/)}function W0(y){return y.classList||new Tg(y)}function Tg(y){this._node=y,this._names=y1(y.getAttribute("class")||"")}function ua(y,G){for(var ye=W0(y),we=-1,tt=G.length;++we<tt;)ye.add(G[we])}function CA(y,G){for(var ye=W0(y),we=-1,tt=G.length;++we<tt;)ye.remove(G[we])}function v1(y){return function(){ua(this,y)}}function jd(y){return function(){CA(this,y)}}function b1(y,G){return function(){(G.apply(this,arguments)?ua:CA)(this,y)}}function MA(){this.textContent=""}function Dg(y){return function(){this.textContent=y}}function x1(y){return function(){var G=y.apply(this,arguments);this.textContent=G??""}}function Lx(){this.innerHTML=""}function Nx(y){return function(){this.innerHTML=y}}function Ux(y){return function(){var G=y.apply(this,arguments);this.innerHTML=G??""}}function SA(){this.nextSibling&&this.parentNode.appendChild(this)}function xh(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wh(){return null}function Cc(){var y=this.parentNode;y&&y.removeChild(this)}function fu(){var y=this.cloneNode(!1),G=this.parentNode;return G?G.insertBefore(y,this.nextSibling):y}function Bu(){var y=this.cloneNode(!0),G=this.parentNode;return G?G.insertBefore(y,this.nextSibling):y}function $0(y){return function(){var G=this.__on;if(G){for(var pt,ye=0,we=-1,tt=G.length;ye<tt;++ye)pt=G[ye],y.type&&pt.type!==y.type||pt.name!==y.name?G[++we]=pt:this.removeEventListener(pt.type,pt.listener,pt.options);++we?G.length=we:delete this.__on}}}function bl(y,G,ye){return function(){var tt,we=this.__on,pt=function Ku(y){return function(G){y.call(this,G,this.__data__)}}(G);if(we)for(var Ct=0,Pt=we.length;Ct<Pt;++Ct)if((tt=we[Ct]).type===y.type&&tt.name===y.name)return this.removeEventListener(tt.type,tt.listener,tt.options),this.addEventListener(tt.type,tt.listener=pt,tt.options=ye),void(tt.value=G);this.addEventListener(y.type,pt,ye),tt={type:y.type,name:y.name,value:G,listener:pt,options:ye},we?we.push(tt):this.__on=[tt]}}function dd(y,G,ye){var we=Mm(y),tt=we.CustomEvent;"function"==typeof tt?tt=new tt(G,ye):(tt=we.document.createEvent("Event"),ye?(tt.initEvent(G,ye.bubbles,ye.cancelable),tt.detail=ye.detail):tt.initEvent(G,!1,!1)),y.dispatchEvent(tt)}function Em(y,G){return function(){return dd(this,y,G)}}function Ko(y,G){return function(){return dd(this,y,G.apply(this,arguments))}}ci.prototype={constructor:ci,appendChild:function(y){return this._parent.insertBefore(y,this._next)},insertBefore:function(y,G){return this._parent.insertBefore(y,G)},querySelector:function(y){return this._parent.querySelector(y)},querySelectorAll:function(y){return this._parent.querySelectorAll(y)}},Tg.prototype={add:function(y){this._names.indexOf(y)<0&&(this._names.push(y),this._node.setAttribute("class",this._names.join(" ")))},remove:function(y){var G=this._names.indexOf(y);G>=0&&(this._names.splice(G,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(y){return this._names.indexOf(y)>=0}};var jf=[null];function mc(y,G){this._groups=y,this._parents=G}function Pu(){return new mc([[document.documentElement]],jf)}function Zu(y){return"string"==typeof y?new mc([[document.querySelector(y)]],[document.documentElement]):new mc([[y]],jf)}mc.prototype=Pu.prototype={constructor:mc,select:function Ui(y){"function"!=typeof y&&(y=Zn(y));for(var G=this._groups,ye=G.length,we=new Array(ye),tt=0;tt<ye;++tt)for(var $t,Yt,pt=G[tt],Ct=pt.length,Pt=we[tt]=new Array(Ct),hn=0;hn<Ct;++hn)($t=pt[hn])&&(Yt=y.call($t,$t.__data__,hn,pt))&&("__data__"in $t&&(Yt.__data__=$t.__data__),Pt[hn]=Yt);return new mc(we,this._parents)},selectAll:function yo(y){y="function"==typeof y?function $r(y){return function(){return function Ki(y){return null==y?[]:Array.isArray(y)?y:Array.from(y)}(y.apply(this,arguments))}}(y):vr(y);for(var G=this._groups,ye=G.length,we=[],tt=[],pt=0;pt<ye;++pt)for(var $t,Ct=G[pt],Pt=Ct.length,Yt=0;Yt<Pt;++Yt)($t=Ct[Yt])&&(we.push(y.call($t,$t.__data__,Yt,Ct)),tt.push($t));return new mc(we,tt)},selectChild:function Ht(y){return this.select(null==y?jn:function mn(y){return function(){return Us.call(this.children,y)}}("function"==typeof y?y:vs(y)))},selectChildren:function yr(y){return this.selectAll(null==y?Sn:function Wn(y){return function(){return Oi.call(this.children,y)}}("function"==typeof y?y:vs(y)))},filter:function cr(y){"function"!=typeof y&&(y=Ho(y));for(var G=this._groups,ye=G.length,we=new Array(ye),tt=0;tt<ye;++tt)for(var $t,pt=G[tt],Ct=pt.length,Pt=we[tt]=[],Yt=0;Yt<Ct;++Yt)($t=pt[Yt])&&y.call($t,$t.__data__,Yt,pt)&&Pt.push($t);return new mc(we,this._parents)},data:function hu(y,G){if(!arguments.length)return Array.from(this,Md);var ye=G?Sa:os,we=this._parents,tt=this._groups;"function"!=typeof y&&(y=function Gs(y){return function(){return y}}(y));for(var pt=tt.length,Ct=new Array(pt),Pt=new Array(pt),$t=new Array(pt),Yt=0;Yt<pt;++Yt){var hn=we[Yt],Kn=tt[Yt],Xn=Kn.length,xi=Yu(y.call(hn,hn&&hn.__data__,Yt,we)),wr=xi.length,ir=Pt[Yt]=new Array(wr),ur=Ct[Yt]=new Array(wr);ye(hn,Kn,ir,ur,$t[Yt]=new Array(Xn),xi,G);for(var Wi,Os,Io=0,Ir=0;Io<wr;++Io)if(Wi=ir[Io]){for(Io>=Ir&&(Ir=Io+1);!(Os=ur[Ir])&&++Ir<wr;);Wi._next=Os||null}}return(Ct=new mc(Ct,we))._enter=Pt,Ct._exit=$t,Ct},enter:function Zr(){return new mc(this._enter||this._groups.map(Cs),this._parents)},exit:function da(){return new mc(this._exit||this._groups.map(Cs),this._parents)},join:function aa(y,G,ye){var we=this.enter(),tt=this,pt=this.exit();return"function"==typeof y?(we=y(we))&&(we=we.selection()):we=we.append(y+""),null!=G&&(tt=G(tt))&&(tt=tt.selection()),null==ye?pt.remove():ye(pt),we&&tt?we.merge(tt).order():tt},merge:function Sd(y){for(var G=y.selection?y.selection():y,ye=this._groups,we=G._groups,tt=ye.length,Ct=Math.min(tt,we.length),Pt=new Array(tt),$t=0;$t<Ct;++$t)for(var xi,Yt=ye[$t],hn=we[$t],Kn=Yt.length,Xn=Pt[$t]=new Array(Kn),wr=0;wr<Kn;++wr)(xi=Yt[wr]||hn[wr])&&(Xn[wr]=xi);for(;$t<tt;++$t)Pt[$t]=ye[$t];return new mc(Pt,this._parents)},selection:function C1(){return this},order:function ic(){for(var y=this._groups,G=-1,ye=y.length;++G<ye;)for(var Ct,we=y[G],tt=we.length-1,pt=we[tt];--tt>=0;)(Ct=we[tt])&&(pt&&4^Ct.compareDocumentPosition(pt)&&pt.parentNode.insertBefore(Ct,pt),pt=Ct);return this},sort:function Wd(y){function G(Kn,Xn){return Kn&&Xn?y(Kn.__data__,Xn.__data__):!Kn-!Xn}y||(y=Mi);for(var ye=this._groups,we=ye.length,tt=new Array(we),pt=0;pt<we;++pt){for(var Yt,Ct=ye[pt],Pt=Ct.length,$t=tt[pt]=new Array(Pt),hn=0;hn<Pt;++hn)(Yt=Ct[hn])&&($t[hn]=Yt);$t.sort(G)}return new mc(tt,this._parents).order()},call:function rl(){var y=arguments[0];return arguments[0]=this,y.apply(null,arguments),this},nodes:function Yc(){return Array.from(this)},node:function Iu(){for(var y=this._groups,G=0,ye=y.length;G<ye;++G)for(var we=y[G],tt=0,pt=we.length;tt<pt;++tt){var Ct=we[tt];if(Ct)return Ct}return null},size:function Kc(){let y=0;for(const G of this)++y;return y},empty:function ef(){return!this.node()},each:function Ra(y){for(var G=this._groups,ye=0,we=G.length;ye<we;++ye)for(var Pt,tt=G[ye],pt=0,Ct=tt.length;pt<Ct;++pt)(Pt=tt[pt])&&y.call(Pt,Pt.__data__,pt,tt);return this},attr:function _1(y,G){var ye=xn(y);if(arguments.length<2){var we=this.node();return ye.local?we.getAttributeNS(ye.space,ye.local):we.getAttribute(ye)}return this.each((null==G?ye.local?qf:Vo:"function"==typeof G?ye.local?Mg:g1:ye.local?wA:Cg)(ye,G))},style:function Qf(y,G,ye){return arguments.length>1?this.each((null==G?Sg:"function"==typeof G?Eg:tf)(y,G,ye??"")):ao(this.node(),y)},property:function Fx(y,G){return arguments.length>1?this.each((null==G?ja:"function"==typeof G?kx:rM)(y,G)):this.node()[y]},classed:function Ox(y,G){var ye=y1(y+"");if(arguments.length<2){for(var we=W0(this.node()),tt=-1,pt=ye.length;++tt<pt;)if(!we.contains(ye[tt]))return!1;return!0}return this.each(("function"==typeof G?b1:G?v1:jd)(ye,G))},text:function j0(y){return arguments.length?this.each(null==y?MA:("function"==typeof y?x1:Dg)(y)):this.node().textContent},html:function dv(y){return arguments.length?this.each(null==y?Lx:("function"==typeof y?Ux:Nx)(y)):this.node().innerHTML},raise:function w1(){return this.each(SA)},lower:function Ig(){return this.each(xh)},append:function pi(y){var G="function"==typeof y?y:cn(y);return this.select(function(){return this.appendChild(G.apply(this,arguments))})},insert:function li(y,G){var ye="function"==typeof y?y:cn(y),we=null==G?wh:"function"==typeof G?G:Zn(G);return this.select(function(){return this.insertBefore(ye.apply(this,arguments),we.apply(this,arguments)||null)})},remove:function Sm(){return this.each(Cc)},clone:function Yl(y){return this.select(y?Bu:fu)},datum:function Gl(y){return arguments.length?this.property("__data__",y):this.node().__data__},on:function Bg(y,G,ye){var tt,Ct,we=function fl(y){return y.trim().split(/^|\s+/).map(function(G){var ye="",we=G.indexOf(".");return we>=0&&(ye=G.slice(we+1),G=G.slice(0,we)),{type:G,name:ye}})}(y+""),pt=we.length;if(!(arguments.length<2)){for(Pt=G?bl:$0,tt=0;tt<pt;++tt)this.each(Pt(we[tt],G,ye));return this}var Pt=this.node().__on;if(Pt)for(var hn,$t=0,Yt=Pt.length;$t<Yt;++$t)for(tt=0,hn=Pt[$t];tt<pt;++tt)if((Ct=we[tt]).type===hn.type&&Ct.name===hn.name)return hn.value},dispatch:function Wf(y,G){return this.each(("function"==typeof G?Ko:Em)(y,G))},[Symbol.iterator]:function*Pg(){for(var y=this._groups,G=0,ye=y.length;G<ye;++G)for(var Ct,we=y[G],tt=0,pt=we.length;tt<pt;++tt)(Ct=we[tt])&&(yield Ct)}};var Ll=0;function Zo(){this._="@"+(++Ll).toString(36)}function mo(y){let G;for(;G=y.sourceEvent;)y=G;return y}function EA(y,G){if(y=mo(y),void 0===G&&(G=y.currentTarget),G){var ye=G.ownerSVGElement||G;if(ye.createSVGPoint){var we=ye.createSVGPoint();return we.x=y.clientX,we.y=y.clientY,[(we=we.matrixTransform(G.getScreenCTM().inverse())).x,we.y]}if(G.getBoundingClientRect){var tt=G.getBoundingClientRect();return[y.clientX-tt.left-G.clientLeft,y.clientY-tt.top-G.clientTop]}}return[y.pageX,y.pageY]}function th(y,G){return y.target&&(y=mo(y),void 0===G&&(G=y.currentTarget),y=y.touches||[y]),Array.from(y,ye=>EA(ye,G))}Zo.prototype=function eh(){return new Zo}.prototype={constructor:Zo,get:function(y){for(var G=this._;!(G in y);)if(!(y=y.parentNode))return;return y[G]},set:function(y,G){return y[this._]=G},remove:function(y){return this._ in y&&delete y[this._]},toString:function(){return this._}};const vo={passive:!1},$f={capture:!0,passive:!1};function Ch(y){y.stopImmediatePropagation()}function Zc(y){y.preventDefault(),y.stopImmediatePropagation()}var mi=y=>()=>y;function TA(y,{sourceEvent:G,subject:ye,target:we,identifier:tt,active:pt,x:Ct,y:Pt,dx:$t,dy:Yt,dispatch:hn}){Object.defineProperties(this,{type:{value:y,enumerable:!0,configurable:!0},sourceEvent:{value:G,enumerable:!0,configurable:!0},subject:{value:ye,enumerable:!0,configurable:!0},target:{value:we,enumerable:!0,configurable:!0},identifier:{value:tt,enumerable:!0,configurable:!0},active:{value:pt,enumerable:!0,configurable:!0},x:{value:Ct,enumerable:!0,configurable:!0},y:{value:Pt,enumerable:!0,configurable:!0},dx:{value:$t,enumerable:!0,configurable:!0},dy:{value:Yt,enumerable:!0,configurable:!0},_:{value:hn}})}function Rg(y){return!y.ctrlKey&&!y.button}function X0(){return this.parentNode}function pu(y,G){return G??{x:y.x,y:y.y}}function rf(){return navigator.maxTouchPoints||"ontouchstart"in this}function M1(){var Pt,$t,Yt,hn,y=Rg,G=X0,ye=pu,we=rf,tt={},pt=Wt("start","drag","end"),Ct=0,Kn=0;function Xn(Wi){Wi.on("mousedown.drag",xi).filter(we).on("touchstart.drag",ur).on("touchmove.drag",ss,vo).on("touchend.drag touchcancel.drag",Io).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function xi(Wi,Os){if(!hn&&y.call(this,Wi,Os)){var ls=Ir(this,G.call(this,Wi,Os),Wi,Os,"mouse");ls&&(Zu(Wi.view).on("mousemove.drag",wr,$f).on("mouseup.drag",ir,$f),function nf(y){var G=y.document.documentElement,ye=Zu(y).on("dragstart.drag",Zc,$f);"onselectstart"in G?ye.on("selectstart.drag",Zc,$f):(G.__noselect=G.style.MozUserSelect,G.style.MozUserSelect="none")}(Wi.view),Ch(Wi),Yt=!1,Pt=Wi.clientX,$t=Wi.clientY,ls("start",Wi))}}function wr(Wi){if(Zc(Wi),!Yt){var Os=Wi.clientX-Pt,ls=Wi.clientY-$t;Yt=Os*Os+ls*ls>Kn}tt.mouse("drag",Wi)}function ir(Wi){Zu(Wi.view).on("mousemove.drag mouseup.drag",null),function Ed(y,G){var ye=y.document.documentElement,we=Zu(y).on("dragstart.drag",null);G&&(we.on("click.drag",Zc,$f),setTimeout(function(){we.on("click.drag",null)},0)),"onselectstart"in ye?we.on("selectstart.drag",null):(ye.style.MozUserSelect=ye.__noselect,delete ye.__noselect)}(Wi.view,Yt),Zc(Wi),tt.mouse("end",Wi)}function ur(Wi,Os){if(y.call(this,Wi,Os)){var _c,cc,ls=Wi.changedTouches,Bo=G.call(this,Wi,Os),cl=ls.length;for(_c=0;_c<cl;++_c)(cc=Ir(this,Bo,Wi,Os,ls[_c].identifier,ls[_c]))&&(Ch(Wi),cc("start",Wi,ls[_c]))}}function ss(Wi){var Bo,cl,Os=Wi.changedTouches,ls=Os.length;for(Bo=0;Bo<ls;++Bo)(cl=tt[Os[Bo].identifier])&&(Zc(Wi),cl("drag",Wi,Os[Bo]))}function Io(Wi){var Bo,cl,Os=Wi.changedTouches,ls=Os.length;for(hn&&clearTimeout(hn),hn=setTimeout(function(){hn=null},500),Bo=0;Bo<ls;++Bo)(cl=tt[Os[Bo].identifier])&&(Ch(Wi),cl("end",Wi,Os[Bo]))}function Ir(Wi,Os,ls,Bo,cl,_c){var Ml,qs,Qo,cc=pt.copy(),js=EA(_c||ls,Os);if(null!=(Qo=ye.call(Wi,new TA("beforestart",{sourceEvent:ls,target:Xn,identifier:cl,active:Ct,x:js[0],y:js[1],dx:0,dy:0,dispatch:cc}),Bo)))return Ml=Qo.x-js[0]||0,qs=Qo.y-js[1]||0,function vu(Kd,id,Od){var pp,Jl=js;switch(Kd){case"start":tt[cl]=vu,pp=Ct++;break;case"end":delete tt[cl],--Ct;case"drag":js=EA(Od||id,Os),pp=Ct}cc.call(Kd,Wi,new TA(Kd,{sourceEvent:id,subject:Qo,target:Xn,identifier:cl,active:pp,x:js[0]+Ml,y:js[1]+qs,dx:js[0]-Jl[0],dy:js[1]-Jl[1],dispatch:cc}),Bo)}}return Xn.filter=function(Wi){return arguments.length?(y="function"==typeof Wi?Wi:mi(!!Wi),Xn):y},Xn.container=function(Wi){return arguments.length?(G="function"==typeof Wi?Wi:mi(Wi),Xn):G},Xn.subject=function(Wi){return arguments.length?(ye="function"==typeof Wi?Wi:mi(Wi),Xn):ye},Xn.touchable=function(Wi){return arguments.length?(we="function"==typeof Wi?Wi:mi(!!Wi),Xn):we},Xn.on=function(){var Wi=pt.on.apply(pt,arguments);return Wi===pt?Xn:Wi},Xn.clickDistance=function(Wi){return arguments.length?(Kn=(Wi=+Wi)*Wi,Xn):Math.sqrt(Kn)},Xn}function va(y,G){return null==y||null==G?NaN:y<G?-1:y>G?1:y>=G?0:NaN}function sf(y,G){return null==y||null==G?NaN:G<y?-1:G>y?1:G>=y?0:NaN}function Dp(y){let G,ye,we;function tt(Pt,$t,Yt=0,hn=Pt.length){if(Yt<hn){if(0!==G($t,$t))return hn;do{const Kn=Yt+hn>>>1;ye(Pt[Kn],$t)<0?Yt=Kn+1:hn=Kn}while(Yt<hn)}return Yt}return 2!==y.length?(G=va,ye=(Pt,$t)=>va(y(Pt),$t),we=(Pt,$t)=>y(Pt)-$t):(G=y===va||y===sf?y:Ip,ye=y,we=y),{left:tt,center:function Ct(Pt,$t,Yt=0,hn=Pt.length){const Kn=tt(Pt,$t,Yt,hn-1);return Kn>Yt&&we(Pt[Kn-1],$t)>-we(Pt[Kn],$t)?Kn-1:Kn},right:function pt(Pt,$t,Yt=0,hn=Pt.length){if(Yt<hn){if(0!==G($t,$t))return hn;do{const Kn=Yt+hn>>>1;ye(Pt[Kn],$t)<=0?Yt=Kn+1:hn=Kn}while(Yt<hn)}return Yt}}}function Ip(){return 0}TA.prototype.on=function(){var y=this._.on.apply(this._,arguments);return y===this._?this:y};const DA=Dp(va).right;Dp(function kg(y){return null===y?NaN:+y});var Dm=DA;Map;const Qr=Math.sqrt(50),to=Math.sqrt(10),ud=Math.sqrt(2);function Lo(y,G,ye){const we=(G-y)/Math.max(0,ye),tt=Math.floor(Math.log10(we)),pt=we/Math.pow(10,tt),Ct=pt>=Qr?10:pt>=to?5:pt>=ud?2:1;let Pt,$t,Yt;return tt<0?(Yt=Math.pow(10,-tt)/Ct,Pt=Math.round(y*Yt),$t=Math.round(G*Yt),Pt/Yt<y&&++Pt,$t/Yt>G&&--$t,Yt=-Yt):(Yt=Math.pow(10,tt)*Ct,Pt=Math.round(y/Yt),$t=Math.round(G/Yt),Pt*Yt<y&&++Pt,$t*Yt>G&&--$t),$t<Pt&&.5<=ye&&ye<2?Lo(y,G,2*ye):[Pt,$t,Yt]}function Dn(y,G,ye){if(!((ye=+ye)>0))return[];if((y=+y)==(G=+G))return[y];const we=G<y,[tt,pt,Ct]=we?Lo(G,y,ye):Lo(y,G,ye);if(!(pt>=tt))return[];const Pt=pt-tt+1,$t=new Array(Pt);if(we)if(Ct<0)for(let Yt=0;Yt<Pt;++Yt)$t[Yt]=(pt-Yt)/-Ct;else for(let Yt=0;Yt<Pt;++Yt)$t[Yt]=(pt-Yt)*Ct;else if(Ct<0)for(let Yt=0;Yt<Pt;++Yt)$t[Yt]=(tt+Yt)/-Ct;else for(let Yt=0;Yt<Pt;++Yt)$t[Yt]=(tt+Yt)*Ct;return $t}function Sr(y,G,ye){return Lo(y=+y,G=+G,ye=+ye)[2]}function Vc(y,G,ye){ye=+ye;const we=(G=+G)<(y=+y),tt=we?Sr(G,y,ye):Sr(y,G,ye);return(we?-1:1)*(tt<0?1/-tt:tt)}function Kl(y,G){switch(arguments.length){case 0:break;case 1:this.range(y);break;default:this.range(G).domain(y)}return this}Symbol("implicit");var Kf=y=>()=>y;function sc(y,G){var ye=G-y;return ye?function zx(y,G){return function(ye){return y+ye*G}}(y,ye):Kf(isNaN(y)?G:y)}var Op=function y(G){var ye=function Y0(y){return 1==(y=+y)?sc:function(G,ye){return ye-G?function Fp(y,G,ye){return y=Math.pow(y,ye),G=Math.pow(G,ye)-y,ye=1/ye,function(we){return Math.pow(y+we*G,ye)}}(G,ye,y):Kf(isNaN(G)?ye:G)}}(G);function we(tt,pt){var Ct=ye((tt=v(tt)).r,(pt=v(pt)).r),Pt=ye(tt.g,pt.g),$t=ye(tt.b,pt.b),Yt=sc(tt.opacity,pt.opacity);return function(hn){return tt.r=Ct(hn),tt.g=Pt(hn),tt.b=$t(hn),tt.opacity=Yt(hn),tt+""}}return we.gamma=y,we}(1);function E1(y,G){G||(G=[]);var tt,ye=y?Math.min(G.length,y.length):0,we=G.slice();return function(pt){for(tt=0;tt<ye;++tt)we[tt]=y[tt]*(1-pt)+G[tt]*pt;return we}}function Zf(y,G){var Ct,ye=G?G.length:0,we=y?Math.min(ye,y.length):0,tt=new Array(we),pt=new Array(ye);for(Ct=0;Ct<we;++Ct)tt[Ct]=mu(y[Ct],G[Ct]);for(;Ct<ye;++Ct)pt[Ct]=G[Ct];return function(Pt){for(Ct=0;Ct<we;++Ct)pt[Ct]=tt[Ct](Pt);return pt}}function af(y,G){var ye=new Date;return y=+y,G=+G,function(we){return ye.setTime(y*(1-we)+G*we),ye}}function Jc(y,G){return y=+y,G=+G,function(ye){return y*(1-ye)+G*ye}}function BA(y,G){var tt,ye={},we={};for(tt in(null===y||"object"!=typeof y)&&(y={}),(null===G||"object"!=typeof G)&&(G={}),G)tt in y?ye[tt]=mu(y[tt],G[tt]):we[tt]=G[tt];return function(pt){for(tt in ye)we[tt]=ye[tt](pt);return we}}var lo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nh=new RegExp(lo.source,"g");function Fg(y,G){var we,tt,pt,ye=lo.lastIndex=nh.lastIndex=0,Ct=-1,Pt=[],$t=[];for(y+="",G+="";(we=lo.exec(y))&&(tt=nh.exec(G));)(pt=tt.index)>ye&&(pt=G.slice(ye,pt),Pt[Ct]?Pt[Ct]+=pt:Pt[++Ct]=pt),(we=we[0])===(tt=tt[0])?Pt[Ct]?Pt[Ct]+=tt:Pt[++Ct]=tt:(Pt[++Ct]=null,$t.push({i:Ct,x:Jc(we,tt)})),ye=nh.lastIndex;return ye<G.length&&(pt=G.slice(ye),Pt[Ct]?Pt[Ct]+=pt:Pt[++Ct]=pt),Pt.length<2?$t[0]?function Jf(y){return function(G){return y(G)+""}}($t[0].x):function xl(y){return function(){return y}}(G):(G=$t.length,function(Yt){for(var Kn,hn=0;hn<G;++hn)Pt[(Kn=$t[hn]).i]=Kn.x(Yt);return Pt.join("")})}function mu(y,G){var we,ye=typeof G;return null==G||"boolean"===ye?Kf(G):("number"===ye?Jc:"string"===ye?(we=D(G))?(G=we,Op):Fg:G instanceof D?Op:G instanceof Date?af:function Lp(y){return ArrayBuffer.isView(y)&&!(y instanceof DataView)}(G)?E1:Array.isArray(G)?Zf:"function"!=typeof G.valueOf&&"function"!=typeof G.toString||isNaN(G)?BA:Jc)(y,G)}function Np(y,G){return y=+y,G=+G,function(ye){return Math.round(y*(1-ye)+G*ye)}}var Dd,Td=180/Math.PI,lf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Og(y,G,ye,we,tt,pt){var Ct,Pt,$t;return(Ct=Math.sqrt(y*y+G*G))&&(y/=Ct,G/=Ct),($t=y*ye+G*we)&&(ye-=y*$t,we-=G*$t),(Pt=Math.sqrt(ye*ye+we*we))&&(ye/=Pt,we/=Pt,$t/=Pt),y*we<G*ye&&(y=-y,G=-G,$t=-$t,Ct=-Ct),{translateX:tt,translateY:pt,rotate:Math.atan2(G,y)*Td,skewX:Math.atan($t)*Td,scaleX:Ct,scaleY:Pt}}function hd(y,G,ye,we){function tt(Yt){return Yt.length?Yt.pop()+" ":""}return function(Yt,hn){var Kn=[],Xn=[];return Yt=y(Yt),hn=y(hn),function pt(Yt,hn,Kn,Xn,xi,wr){if(Yt!==Kn||hn!==Xn){var ir=xi.push("translate(",null,G,null,ye);wr.push({i:ir-4,x:Jc(Yt,Kn)},{i:ir-2,x:Jc(hn,Xn)})}else(Kn||Xn)&&xi.push("translate("+Kn+G+Xn+ye)}(Yt.translateX,Yt.translateY,hn.translateX,hn.translateY,Kn,Xn),function Ct(Yt,hn,Kn,Xn){Yt!==hn?(Yt-hn>180?hn+=360:hn-Yt>180&&(Yt+=360),Xn.push({i:Kn.push(tt(Kn)+"rotate(",null,we)-2,x:Jc(Yt,hn)})):hn&&Kn.push(tt(Kn)+"rotate("+hn+we)}(Yt.rotate,hn.rotate,Kn,Xn),function Pt(Yt,hn,Kn,Xn){Yt!==hn?Xn.push({i:Kn.push(tt(Kn)+"skewX(",null,we)-2,x:Jc(Yt,hn)}):hn&&Kn.push(tt(Kn)+"skewX("+hn+we)}(Yt.skewX,hn.skewX,Kn,Xn),function $t(Yt,hn,Kn,Xn,xi,wr){if(Yt!==Kn||hn!==Xn){var ir=xi.push(tt(xi)+"scale(",null,",",null,")");wr.push({i:ir-4,x:Jc(Yt,Kn)},{i:ir-2,x:Jc(hn,Xn)})}else(1!==Kn||1!==Xn)&&xi.push(tt(xi)+"scale("+Kn+","+Xn+")")}(Yt.scaleX,Yt.scaleY,hn.scaleX,hn.scaleY,Kn,Xn),Yt=hn=null,function(xi){for(var ur,wr=-1,ir=Xn.length;++wr<ir;)Kn[(ur=Xn[wr]).i]=ur.x(xi);return Kn.join("")}}}var fv=hd(function hv(y){const G=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(y+"");return G.isIdentity?lf:Og(G.a,G.b,G.c,G.d,G.e,G.f)},"px, ","px)","deg)"),K0=hd(function ed(y){return null!=y&&(Dd||(Dd=document.createElementNS("http://www.w3.org/2000/svg","g")),Dd.setAttribute("transform",y),y=Dd.transform.baseVal.consolidate())?Og((y=y.matrix).a,y.b,y.c,y.d,y.e,y.f):lf},", ",")",")");function pl(y){return+y}var Sc=[0,1];function Id(y){return y}function T1(y,G){return(G-=y=+y)?function(ye){return(ye-y)/G}:function Up(y){return function(){return y}}(isNaN(G)?NaN:.5)}function D1(y,G,ye){var we=y[0],tt=y[1],pt=G[0],Ct=G[1];return tt<we?(we=T1(tt,we),pt=ye(Ct,pt)):(we=T1(we,tt),pt=ye(pt,Ct)),function(Pt){return pt(we(Pt))}}function Hx(y,G,ye){var we=Math.min(y.length,G.length)-1,tt=new Array(we),pt=new Array(we),Ct=-1;for(y[we]<y[0]&&(y=y.slice().reverse(),G=G.slice().reverse());++Ct<we;)tt[Ct]=T1(y[Ct],y[Ct+1]),pt[Ct]=ye(G[Ct],G[Ct+1]);return function(Pt){var $t=Dm(y,Pt,1,we)-1;return pt[$t](tt[$t](Pt))}}function Im(y,G){return G.domain(y.domain()).range(y.range()).interpolate(y.interpolate()).clamp(y.clamp()).unknown(y.unknown())}function Z0(){var we,tt,pt,Pt,$t,Yt,y=Sc,G=Sc,ye=mu,Ct=Id;function hn(){var Xn=Math.min(y.length,G.length);return Ct!==Id&&(Ct=function Lg(y,G){var ye;return y>G&&(ye=y,y=G,G=ye),function(we){return Math.max(y,Math.min(G,we))}}(y[0],y[Xn-1])),Pt=Xn>2?Hx:D1,$t=Yt=null,Kn}function Kn(Xn){return null==Xn||isNaN(Xn=+Xn)?pt:($t||($t=Pt(y.map(we),G,ye)))(we(Ct(Xn)))}return Kn.invert=function(Xn){return Ct(tt((Yt||(Yt=Pt(G,y.map(we),Jc)))(Xn)))},Kn.domain=function(Xn){return arguments.length?(y=Array.from(Xn,pl),hn()):y.slice()},Kn.range=function(Xn){return arguments.length?(G=Array.from(Xn),hn()):G.slice()},Kn.rangeRound=function(Xn){return G=Array.from(Xn),ye=Np,hn()},Kn.clamp=function(Xn){return arguments.length?(Ct=!!Xn||Id,hn()):Ct!==Id},Kn.interpolate=function(Xn){return arguments.length?(ye=Xn,hn()):ye},Kn.unknown=function(Xn){return arguments.length?(pt=Xn,Kn):pt},function(Xn,xi){return we=Xn,tt=xi,hn()}}function xo(){return Z0()(Id,Id)}function zp(y,G){if((ye=(y=G?y.toExponential(G-1):y.toExponential()).indexOf("e"))<0)return null;var ye,we=y.slice(0,ye);return[we.length>1?we[0]+we.slice(2):we,+y.slice(ye+1)]}function Ec(y){return(y=zp(Math.abs(y)))?y[1]:NaN}var Dc,Ks=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Na(y){if(!(G=Ks.exec(y)))throw new Error("invalid format: "+y);var G;return new oc({fill:G[1],align:G[2],sign:G[3],symbol:G[4],zero:G[5],width:G[6],comma:G[7],precision:G[8]&&G[8].slice(1),trim:G[9],type:G[10]})}function oc(y){this.fill=void 0===y.fill?" ":y.fill+"",this.align=void 0===y.align?">":y.align+"",this.sign=void 0===y.sign?"-":y.sign+"",this.symbol=void 0===y.symbol?"":y.symbol+"",this.zero=!!y.zero,this.width=void 0===y.width?void 0:+y.width,this.comma=!!y.comma,this.precision=void 0===y.precision?void 0:+y.precision,this.trim=!!y.trim,this.type=void 0===y.type?"":y.type+""}function ml(y,G){var ye=zp(y,G);if(!ye)return y+"";var we=ye[0],tt=ye[1];return tt<0?"0."+new Array(-tt).join("0")+we:we.length>tt+1?we.slice(0,tt+1)+"."+we.slice(tt+1):we+new Array(tt-we.length+2).join("0")}Na.prototype=oc.prototype,oc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Zl={"%":(y,G)=>(100*y).toFixed(G),b:y=>Math.round(y).toString(2),c:y=>y+"",d:function I1(y){return Math.abs(y=Math.round(y))>=1e21?y.toLocaleString("en").replace(/,/g,""):y.toString(10)},e:(y,G)=>y.toExponential(G),f:(y,G)=>y.toFixed(G),g:(y,G)=>y.toPrecision(G),o:y=>Math.round(y).toString(8),p:(y,G)=>ml(100*y,G),r:ml,s:function Bm(y,G){var ye=zp(y,G);if(!ye)return y+"";var we=ye[0],tt=ye[1],pt=tt-(Dc=3*Math.max(-8,Math.min(8,Math.floor(tt/3))))+1,Ct=we.length;return pt===Ct?we:pt>Ct?we+new Array(pt-Ct+1).join("0"):pt>0?we.slice(0,pt)+"."+we.slice(pt):"0."+new Array(1-pt).join("0")+zp(y,Math.max(0,G+pt-1))[0]},X:y=>Math.round(y).toString(16).toUpperCase(),x:y=>Math.round(y).toString(16)};function Au(y){return y}var ih,ko,Nl,Ao=Array.prototype.map,Pm=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Bd(y){var G=y.domain;return y.ticks=function(ye){var we=G();return Dn(we[0],we[we.length-1],ye??10)},y.tickFormat=function(ye,we){var tt=G();return function ac(y,G,ye,we){var pt,tt=Vc(y,G,ye);switch((we=Na(we??",f")).type){case"s":var Ct=Math.max(Math.abs(y),Math.abs(G));return null==we.precision&&!isNaN(pt=function Hp(y,G){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ec(G)/3)))-Ec(Math.abs(y)))}(tt,Ct))&&(we.precision=pt),Nl(we,Ct);case"":case"e":case"g":case"p":case"r":null==we.precision&&!isNaN(pt=function Vp(y,G){return y=Math.abs(y),G=Math.abs(G)-y,Math.max(0,Ec(G)-Ec(y))+1}(tt,Math.max(Math.abs(y),Math.abs(G))))&&(we.precision=pt-("e"===we.type));break;case"f":case"%":null==we.precision&&!isNaN(pt=function Ac(y){return Math.max(0,-Ec(Math.abs(y)))}(tt))&&(we.precision=pt-2*("%"===we.type))}return ko(we)}(tt[0],tt[tt.length-1],ye??10,we)},y.nice=function(ye){null==ye&&(ye=10);var $t,Yt,we=G(),tt=0,pt=we.length-1,Ct=we[tt],Pt=we[pt],hn=10;for(Pt<Ct&&(Yt=Ct,Ct=Pt,Pt=Yt,Yt=tt,tt=pt,pt=Yt);hn-- >0;){if((Yt=Sr(Ct,Pt,ye))===$t)return we[tt]=Ct,we[pt]=Pt,G(we);if(Yt>0)Ct=Math.floor(Ct/Yt)*Yt,Pt=Math.ceil(Pt/Yt)*Yt;else{if(!(Yt<0))break;Ct=Math.ceil(Ct*Yt)/Yt,Pt=Math.floor(Pt*Yt)/Yt}$t=Yt}return y},y}function Bl(){var y=xo();return y.copy=function(){return Im(y,Bl())},Kl.apply(y,arguments),Bd(y)}function Eh(y,G){var Ct,ye=0,we=(y=y.slice()).length-1,tt=y[ye],pt=y[we];return pt<tt&&(Ct=ye,ye=we,we=Ct,Ct=tt,tt=pt,pt=Ct),y[ye]=G.floor(tt),y[we]=G.ceil(pt),y}function Th(y){return Math.log(y)}function rh(y){return Math.exp(y)}function Ic(y){return-Math.log(-y)}function Xr(y){return-Math.exp(-y)}function Ea(y){return isFinite(y)?+("1e"+y):y<0?0:y}function Al(y){return(G,ye)=>-y(-G,ye)}function cf(){const y=function PA(y){const G=y(Th,rh),ye=G.domain;let tt,pt,we=10;function Ct(){return tt=function Bc(y){return y===Math.E?Math.log:10===y&&Math.log10||2===y&&Math.log2||(y=Math.log(y),G=>Math.log(G)/y)}(we),pt=function J0(y){return 10===y?Ea:y===Math.E?Math.exp:G=>Math.pow(y,G)}(we),ye()[0]<0?(tt=Al(tt),pt=Al(pt),y(Ic,Xr)):y(Th,rh),G}return G.base=function(Pt){return arguments.length?(we=+Pt,Ct()):we},G.domain=function(Pt){return arguments.length?(ye(Pt),Ct()):ye()},G.ticks=Pt=>{const $t=ye();let Yt=$t[0],hn=$t[$t.length-1];const Kn=hn<Yt;Kn&&([Yt,hn]=[hn,Yt]);let wr,ir,Xn=tt(Yt),xi=tt(hn);const ur=null==Pt?10:+Pt;let ss=[];if(!(we%1)&&xi-Xn<ur){if(Xn=Math.floor(Xn),xi=Math.ceil(xi),Yt>0){for(;Xn<=xi;++Xn)for(wr=1;wr<we;++wr)if(ir=Xn<0?wr/pt(-Xn):wr*pt(Xn),!(ir<Yt)){if(ir>hn)break;ss.push(ir)}}else for(;Xn<=xi;++Xn)for(wr=we-1;wr>=1;--wr)if(ir=Xn>0?wr/pt(-Xn):wr*pt(Xn),!(ir<Yt)){if(ir>hn)break;ss.push(ir)}2*ss.length<ur&&(ss=Dn(Yt,hn,ur))}else ss=Dn(Xn,xi,Math.min(xi-Xn,ur)).map(pt);return Kn?ss.reverse():ss},G.tickFormat=(Pt,$t)=>{if(null==Pt&&(Pt=10),null==$t&&($t=10===we?"s":","),"function"!=typeof $t&&(!(we%1)&&null==($t=Na($t)).precision&&($t.trim=!0),$t=ko($t)),Pt===1/0)return $t;const Yt=Math.max(1,we*Pt/G.ticks().length);return hn=>{let Kn=hn/pt(Math.round(tt(hn)));return Kn*we<we-.5&&(Kn*=we),Kn<=Yt?$t(hn):""}},G.nice=()=>ye(Eh(ye(),{floor:Pt=>pt(Math.floor(tt(Pt))),ceil:Pt=>pt(Math.ceil(tt(Pt)))})),G}(Z0()).domain([1,10]);return y.copy=()=>Im(y,cf()).base(y.base()),Kl.apply(y,arguments),y}function Pc(y){return function(G){return Math.sign(G)*Math.log1p(Math.abs(G/y))}}function ql(y){return function(G){return Math.sign(G)*Math.expm1(Math.abs(G))*y}}function RA(){var y=function Gp(y){var G=1,ye=y(Pc(G),ql(G));return ye.constant=function(we){return arguments.length?y(Pc(G=+we),ql(G)):G},Bd(ye)}(Z0());return y.copy=function(){return Im(y,RA()).constant(y.constant())},Kl.apply(y,arguments)}!function Rm(y){ih=function B1(y){var G=void 0===y.grouping||void 0===y.thousands?Au:function wl(y,G){return function(ye,we){for(var tt=ye.length,pt=[],Ct=0,Pt=y[0],$t=0;tt>0&&Pt>0&&($t+Pt+1>we&&(Pt=Math.max(1,we-$t)),pt.push(ye.substring(tt-=Pt,tt+Pt)),!(($t+=Pt+1)>we));)Pt=y[Ct=(Ct+1)%y.length];return pt.reverse().join(G)}}(Ao.call(y.grouping,Number),y.thousands+""),ye=void 0===y.currency?"":y.currency[0]+"",we=void 0===y.currency?"":y.currency[1]+"",tt=void 0===y.decimal?".":y.decimal+"",pt=void 0===y.numerals?Au:function Rr(y){return function(G){return G.replace(/[0-9]/g,function(ye){return y[+ye]})}}(Ao.call(y.numerals,String)),Ct=void 0===y.percent?"%":y.percent+"",Pt=void 0===y.minus?"\u2212":y.minus+"",$t=void 0===y.nan?"NaN":y.nan+"";function Yt(Kn){var Xn=(Kn=Na(Kn)).fill,xi=Kn.align,wr=Kn.sign,ir=Kn.symbol,ur=Kn.zero,ss=Kn.width,Io=Kn.comma,Ir=Kn.precision,Wi=Kn.trim,Os=Kn.type;"n"===Os?(Io=!0,Os="g"):Zl[Os]||(void 0===Ir&&(Ir=12),Wi=!0,Os="g"),(ur||"0"===Xn&&"="===xi)&&(ur=!0,Xn="0",xi="=");var ls="$"===ir?ye:"#"===ir&&/[boxX]/.test(Os)?"0"+Os.toLowerCase():"",Bo="$"===ir?we:/[%p]/.test(Os)?Ct:"",cl=Zl[Os],_c=/[defgprs%]/.test(Os);function cc(js){var Qo,vu,Kd,Ml=ls,qs=Bo;if("c"===Os)qs=cl(js)+qs,js="";else{var id=(js=+js)<0||1/js<0;if(js=isNaN(js)?$t:cl(Math.abs(js),Ir),Wi&&(js=function Tc(y){e:for(var tt,G=y.length,ye=1,we=-1;ye<G;++ye)switch(y[ye]){case".":we=tt=ye;break;case"0":0===we&&(we=ye),tt=ye;break;default:if(!+y[ye])break e;we>0&&(we=0)}return we>0?y.slice(0,we)+y.slice(tt+1):y}(js)),id&&0==+js&&"+"!==wr&&(id=!1),Ml=(id?"("===wr?wr:Pt:"-"===wr||"("===wr?"":wr)+Ml,qs=("s"===Os?Pm[8+Dc/3]:"")+qs+(id&&"("===wr?")":""),_c)for(Qo=-1,vu=js.length;++Qo<vu;)if(48>(Kd=js.charCodeAt(Qo))||Kd>57){qs=(46===Kd?tt+js.slice(Qo+1):js.slice(Qo))+qs,js=js.slice(0,Qo);break}}Io&&!ur&&(js=G(js,1/0));var Od=Ml.length+js.length+qs.length,Jl=Od<ss?new Array(ss-Od+1).join(Xn):"";switch(Io&&ur&&(js=G(Jl+js,Jl.length?ss-qs.length:1/0),Jl=""),xi){case"<":js=Ml+js+qs+Jl;break;case"=":js=Ml+Jl+js+qs;break;case"^":js=Jl.slice(0,Od=Jl.length>>1)+Ml+js+qs+Jl.slice(Od);break;default:js=Jl+Ml+js+qs}return pt(js)}return Ir=void 0===Ir?6:/[gprs]/.test(Os)?Math.max(1,Math.min(21,Ir)):Math.max(0,Math.min(20,Ir)),cc.toString=function(){return Kn+""},cc}return{format:Yt,formatPrefix:function hn(Kn,Xn){var xi=Yt(((Kn=Na(Kn)).type="f",Kn)),wr=3*Math.max(-8,Math.min(8,Math.floor(Ec(Xn)/3))),ir=Math.pow(10,-wr),ur=Pm[8+wr/3];return function(ss){return xi(ir*ss)+ur}}}}(y),ko=ih.format,Nl=ih.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Ug=new Date,zg=new Date;function gc(y,G,ye,we){function tt(pt){return y(pt=0===arguments.length?new Date:new Date(+pt)),pt}return tt.floor=pt=>(y(pt=new Date(+pt)),pt),tt.ceil=pt=>(y(pt=new Date(pt-1)),G(pt,1),y(pt),pt),tt.round=pt=>{const Ct=tt(pt),Pt=tt.ceil(pt);return pt-Ct<Pt-pt?Ct:Pt},tt.offset=(pt,Ct)=>(G(pt=new Date(+pt),null==Ct?1:Math.floor(Ct)),pt),tt.range=(pt,Ct,Pt)=>{const $t=[];if(pt=tt.ceil(pt),Pt=null==Pt?1:Math.floor(Pt),!(pt<Ct&&Pt>0))return $t;let Yt;do{$t.push(Yt=new Date(+pt)),G(pt,Pt),y(pt)}while(Yt<pt&&pt<Ct);return $t},tt.filter=pt=>gc(Ct=>{if(Ct>=Ct)for(;y(Ct),!pt(Ct);)Ct.setTime(Ct-1)},(Ct,Pt)=>{if(Ct>=Ct)if(Pt<0)for(;++Pt<=0;)for(;G(Ct,-1),!pt(Ct););else for(;--Pt>=0;)for(;G(Ct,1),!pt(Ct););}),ye&&(tt.count=(pt,Ct)=>(Ug.setTime(+pt),zg.setTime(+Ct),y(Ug),y(zg),Math.floor(ye(Ug,zg))),tt.every=pt=>(pt=Math.floor(pt),isFinite(pt)&&pt>0?pt>1?tt.filter(we?Ct=>we(Ct)%pt==0:Ct=>tt.count(0,Ct)%pt==0):tt:null)),tt}const Xd=gc(()=>{},(y,G)=>{y.setTime(+y+G)},(y,G)=>G-y);Xd.every=y=>(y=Math.floor(y),isFinite(y)&&y>0?y>1?gc(G=>{G.setTime(Math.floor(G/y)*y)},(G,ye)=>{G.setTime(+G+ye*y)},(G,ye)=>(ye-G)/y):Xd:null);const gu=1e3,Yd=6e4,fd=60*Yd,oh=24*fd,Hg=7*oh,km=30*oh,Ih=365*oh,Fu=gc(y=>{y.setTime(y-y.getMilliseconds())},(y,G)=>{y.setTime(+y+G*gu)},(y,G)=>(G-y)/gu,y=>y.getUTCSeconds()),tp=gc(y=>{y.setTime(y-y.getMilliseconds()-y.getSeconds()*gu)},(y,G)=>{y.setTime(+y+G*Yd)},(y,G)=>(G-y)/Yd,y=>y.getMinutes()),Pl=gc(y=>{y.setUTCSeconds(0,0)},(y,G)=>{y.setTime(+y+G*Yd)},(y,G)=>(G-y)/Yd,y=>y.getUTCMinutes()),np=gc(y=>{y.setTime(y-y.getMilliseconds()-y.getSeconds()*gu-y.getMinutes()*Yd)},(y,G)=>{y.setTime(+y+G*fd)},(y,G)=>(G-y)/fd,y=>y.getHours()),Wp=gc(y=>{y.setUTCMinutes(0,0,0)},(y,G)=>{y.setTime(+y+G*fd)},(y,G)=>(G-y)/fd,y=>y.getUTCHours()),ip=gc(y=>y.setHours(0,0,0,0),(y,G)=>y.setDate(y.getDate()+G),(y,G)=>(G-y-(G.getTimezoneOffset()-y.getTimezoneOffset())*Yd)/oh,y=>y.getDate()-1),jp=gc(y=>{y.setUTCHours(0,0,0,0)},(y,G)=>{y.setUTCDate(y.getUTCDate()+G)},(y,G)=>(G-y)/oh,y=>y.getUTCDate()-1),Fm=gc(y=>{y.setUTCHours(0,0,0,0)},(y,G)=>{y.setUTCDate(y.getUTCDate()+G)},(y,G)=>(G-y)/oh,y=>Math.floor(y/oh));function Bh(y){return gc(G=>{G.setDate(G.getDate()-(G.getDay()+7-y)%7),G.setHours(0,0,0,0)},(G,ye)=>{G.setDate(G.getDate()+7*ye)},(G,ye)=>(ye-G-(ye.getTimezoneOffset()-G.getTimezoneOffset())*Yd)/Hg)}const Ph=Bh(0),rp=Bh(1),Ou=(Bh(2),Bh(3),Bh(4));function Om(y){return gc(G=>{G.setUTCDate(G.getUTCDate()-(G.getUTCDay()+7-y)%7),G.setUTCHours(0,0,0,0)},(G,ye)=>{G.setUTCDate(G.getUTCDate()+7*ye)},(G,ye)=>(ye-G)/Hg)}Bh(5),Bh(6);const Go=Om(0),sp=Om(1),Lm=(Om(2),Om(3),Om(4)),Rd=(Om(5),Om(6),gc(y=>{y.setDate(1),y.setHours(0,0,0,0)},(y,G)=>{y.setMonth(y.getMonth()+G)},(y,G)=>G.getMonth()-y.getMonth()+12*(G.getFullYear()-y.getFullYear()),y=>y.getMonth())),t_=gc(y=>{y.setUTCDate(1),y.setUTCHours(0,0,0,0)},(y,G)=>{y.setUTCMonth(y.getUTCMonth()+G)},(y,G)=>G.getUTCMonth()-y.getUTCMonth()+12*(G.getUTCFullYear()-y.getUTCFullYear()),y=>y.getUTCMonth()),ah=gc(y=>{y.setMonth(0,1),y.setHours(0,0,0,0)},(y,G)=>{y.setFullYear(y.getFullYear()+G)},(y,G)=>G.getFullYear()-y.getFullYear(),y=>y.getFullYear());ah.every=y=>isFinite(y=Math.floor(y))&&y>0?gc(G=>{G.setFullYear(Math.floor(G.getFullYear()/y)*y),G.setMonth(0,1),G.setHours(0,0,0,0)},(G,ye)=>{G.setFullYear(G.getFullYear()+ye*y)}):null;const ff=gc(y=>{y.setUTCMonth(0,1),y.setUTCHours(0,0,0,0)},(y,G)=>{y.setUTCFullYear(y.getUTCFullYear()+G)},(y,G)=>G.getUTCFullYear()-y.getUTCFullYear(),y=>y.getUTCFullYear());function Lu(y,G,ye,we,tt,pt){const Ct=[[Fu,1,gu],[Fu,5,5e3],[Fu,15,15e3],[Fu,30,3e4],[pt,1,Yd],[pt,5,5*Yd],[pt,15,15*Yd],[pt,30,30*Yd],[tt,1,fd],[tt,3,3*fd],[tt,6,6*fd],[tt,12,12*fd],[we,1,oh],[we,2,2*oh],[ye,1,Hg],[G,1,km],[G,3,3*km],[y,1,Ih]];function $t(Yt,hn,Kn){const Xn=Math.abs(hn-Yt)/Kn,xi=Dp(([,,ur])=>ur).right(Ct,Xn);if(xi===Ct.length)return y.every(Vc(Yt/Ih,hn/Ih,Kn));if(0===xi)return Xd.every(Math.max(Vc(Yt,hn,Kn),1));const[wr,ir]=Ct[Xn/Ct[xi-1][2]<Ct[xi][2]/Xn?xi-1:xi];return wr.every(ir)}return[function Pt(Yt,hn,Kn){const Xn=hn<Yt;Xn&&([Yt,hn]=[hn,Yt]);const xi=Kn&&"function"==typeof Kn.range?Kn:$t(Yt,hn,Kn),wr=xi?xi.range(Yt,+hn+1):[];return Xn?wr.reverse():wr},$t]}ff.every=y=>isFinite(y=Math.floor(y))&&y>0?gc(G=>{G.setUTCFullYear(Math.floor(G.getUTCFullYear()/y)*y),G.setUTCMonth(0,1),G.setUTCHours(0,0,0,0)},(G,ye)=>{G.setUTCFullYear(G.getUTCFullYear()+ye*y)}):null;const[R1,n_]=Lu(ff,t_,Go,Fm,Wp,Pl),[i_,Rc]=Lu(ah,Rd,Ph,ip,np,tp);function pf(y){if(0<=y.y&&y.y<100){var G=new Date(-1,y.m,y.d,y.H,y.M,y.S,y.L);return G.setFullYear(y.y),G}return new Date(y.y,y.m,y.d,y.H,y.M,y.S,y.L)}function $p(y){if(0<=y.y&&y.y<100){var G=new Date(Date.UTC(-1,y.m,y.d,y.H,y.M,y.S,y.L));return G.setUTCFullYear(y.y),G}return new Date(Date.UTC(y.y,y.m,y.d,y.H,y.M,y.S,y.L))}function op(y,G,ye){return{y,m:G,d:ye,H:0,M:0,S:0,L:0}}var gf,Xg,Kg,yv,Rh={"-":"",_:" ",0:"0"},Ts=/^\s*\d+/,k1=/^%/,Vx=/[\\^$*+?|[\]().{}]/g;function $a(y,G,ye){var we=y<0?"-":"",tt=(we?-y:y)+"",pt=tt.length;return we+(pt<ye?new Array(ye-pt+1).join(G)+tt:tt)}function Av(y){return y.replace(Vx,"\\$&")}function NA(y){return new RegExp("^(?:"+y.map(Av).join("|")+")","i")}function Um(y){return new Map(y.map((G,ye)=>[G.toLowerCase(),ye]))}function zm(y,G,ye){var we=Ts.exec(G.slice(ye,ye+1));return we?(y.w=+we[0],ye+we[0].length):-1}function F1(y,G,ye){var we=Ts.exec(G.slice(ye,ye+1));return we?(y.u=+we[0],ye+we[0].length):-1}function O1(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.U=+we[0],ye+we[0].length):-1}function L1(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.V=+we[0],ye+we[0].length):-1}function N1(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.W=+we[0],ye+we[0].length):-1}function Gg(y,G,ye){var we=Ts.exec(G.slice(ye,ye+4));return we?(y.y=+we[0],ye+we[0].length):-1}function qi(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.y=+we[0]+(+we[0]>68?1900:2e3),ye+we[0].length):-1}function ma(y,G,ye){var we=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(G.slice(ye,ye+6));return we?(y.Z=we[1]?0:-(we[2]+(we[3]||"00")),ye+we[0].length):-1}function vi(y,G,ye){var we=Ts.exec(G.slice(ye,ye+1));return we?(y.q=3*we[0]-3,ye+we[0].length):-1}function bi(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.m=we[0]-1,ye+we[0].length):-1}function Ua(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.d=+we[0],ye+we[0].length):-1}function UA(y,G,ye){var we=Ts.exec(G.slice(ye,ye+3));return we?(y.m=0,y.d=+we[0],ye+we[0].length):-1}function Hm(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.H=+we[0],ye+we[0].length):-1}function lh(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.M=+we[0],ye+we[0].length):-1}function zA(y,G,ye){var we=Ts.exec(G.slice(ye,ye+2));return we?(y.S=+we[0],ye+we[0].length):-1}function qg(y,G,ye){var we=Ts.exec(G.slice(ye,ye+3));return we?(y.L=+we[0],ye+we[0].length):-1}function U1(y,G,ye){var we=Ts.exec(G.slice(ye,ye+6));return we?(y.L=Math.floor(we[0]/1e3),ye+we[0].length):-1}function gv(y,G,ye){var we=k1.exec(G.slice(ye,ye+1));return we?ye+we[0].length:-1}function z1(y,G,ye){var we=Ts.exec(G.slice(ye));return we?(y.Q=+we[0],ye+we[0].length):-1}function qc(y,G,ye){var we=Ts.exec(G.slice(ye));return we?(y.s=+we[0],ye+we[0].length):-1}function ch(y,G){return $a(y.getDate(),G,2)}function r_(y,G){return $a(y.getHours(),G,2)}function dh(y,G){return $a(y.getHours()%12||12,G,2)}function mf(y,G){return $a(1+ip.count(ah(y),y),G,3)}function s_(y,G){return $a(y.getMilliseconds(),G,3)}function Xp(y,G){return s_(y,G)+"000"}function o_(y,G){return $a(y.getMonth()+1,G,2)}function Qg(y,G){return $a(y.getMinutes(),G,2)}function a_(y,G){return $a(y.getSeconds(),G,2)}function l_(y){var G=y.getDay();return 0===G?7:G}function c_(y,G){return $a(Ph.count(ah(y)-1,y),G,2)}function HA(y){var G=y.getDay();return G>=4||0===G?Ou(y):Ou.ceil(y)}function H1(y,G){return y=HA(y),$a(Ou.count(ah(y),y)+(4===ah(y).getDay()),G,2)}function Wg(y){return y.getDay()}function jg(y,G){return $a(rp.count(ah(y)-1,y),G,2)}function d_(y,G){return $a(y.getFullYear()%100,G,2)}function $g(y,G){return $a((y=HA(y)).getFullYear()%100,G,2)}function u_(y,G){return $a(y.getFullYear()%1e4,G,4)}function h_(y,G){var ye=y.getDay();return $a((y=ye>=4||0===ye?Ou(y):Ou.ceil(y)).getFullYear()%1e4,G,4)}function f_(y){var G=y.getTimezoneOffset();return(G>0?"-":(G*=-1,"+"))+$a(G/60|0,"0",2)+$a(G%60,"0",2)}function VA(y,G){return $a(y.getUTCDate(),G,2)}function kc(y,G){return $a(y.getUTCHours(),G,2)}function ap(y,G){return $a(y.getUTCHours()%12||12,G,2)}function _l(y,G){return $a(1+jp.count(ff(y),y),G,3)}function Ul(y,G){return $a(y.getUTCMilliseconds(),G,3)}function V1(y,G){return Ul(y,G)+"000"}function kh(y,G){return $a(y.getUTCMonth()+1,G,2)}function _v(y,G){return $a(y.getUTCMinutes(),G,2)}function G1(y,G){return $a(y.getUTCSeconds(),G,2)}function Yp(y){var G=y.getUTCDay();return 0===G?7:G}function Vm(y,G){return $a(Go.count(ff(y)-1,y),G,2)}function Ja(y){var G=y.getUTCDay();return G>=4||0===G?Lm(y):Lm.ceil(y)}function Kp(y,G){return y=Ja(y),$a(Lm.count(ff(y),y)+(4===ff(y).getUTCDay()),G,2)}function Af(y){return y.getUTCDay()}function uh(y,G){return $a(sp.count(ff(y)-1,y),G,2)}function hh(y,G){return $a(y.getUTCFullYear()%100,G,2)}function Zp(y,G){return $a((y=Ja(y)).getUTCFullYear()%100,G,2)}function Fh(y,G){return $a(y.getUTCFullYear()%1e4,G,4)}function p_(y,G){var ye=y.getUTCDay();return $a((y=ye>=4||0===ye?Lm(y):Lm.ceil(y)).getUTCFullYear()%1e4,G,4)}function q1(){return"+0000"}function lp(){return"%"}function cp(y){return+y}function Gm(y){return Math.floor(+y/1e3)}!function Gx(y){gf=function Vg(y){var G=y.dateTime,ye=y.date,we=y.time,tt=y.periods,pt=y.days,Ct=y.shortDays,Pt=y.months,$t=y.shortMonths,Yt=NA(tt),hn=Um(tt),Kn=NA(pt),Xn=Um(pt),xi=NA(Ct),wr=Um(Ct),ir=NA(Pt),ur=Um(Pt),ss=NA($t),Io=Um($t),Ir={a:function id(Bs){return Ct[Bs.getDay()]},A:function Od(Bs){return pt[Bs.getDay()]},b:function Jl(Bs){return $t[Bs.getMonth()]},B:function pp(Bs){return Pt[Bs.getMonth()]},c:null,d:ch,e:ch,f:Xp,g:$g,G:h_,H:r_,I:dh,j:mf,L:s_,m:o_,M:Qg,p:function d0(Bs){return tt[+(Bs.getHours()>=12)]},q:function E_(Bs){return 1+~~(Bs.getMonth()/3)},Q:cp,s:Gm,S:a_,u:l_,U:c_,V:H1,w:Wg,W:jg,x:null,X:null,y:d_,Y:u_,Z:f_,"%":lp},Wi={a:function Ym(Bs){return Ct[Bs.getUTCDay()]},A:function Km(Bs){return pt[Bs.getUTCDay()]},b:function Ah(Bs){return $t[Bs.getUTCMonth()]},B:function u0(Bs){return Pt[Bs.getUTCMonth()]},c:null,d:VA,e:VA,f:V1,g:Zp,G:p_,H:kc,I:ap,j:_l,L:Ul,m:kh,M:_v,p:function h0(Bs){return tt[+(Bs.getUTCHours()>=12)]},q:function Sf(Bs){return 1+~~(Bs.getUTCMonth()/3)},Q:cp,s:Gm,S:G1,u:Yp,U:Vm,V:Kp,w:Af,W:uh,x:null,X:null,y:hh,Y:Fh,Z:q1,"%":lp},Os={a:function cc(Bs,ga,Ha){var kr=xi.exec(ga.slice(Ha));return kr?(Bs.w=wr.get(kr[0].toLowerCase()),Ha+kr[0].length):-1},A:function js(Bs,ga,Ha){var kr=Kn.exec(ga.slice(Ha));return kr?(Bs.w=Xn.get(kr[0].toLowerCase()),Ha+kr[0].length):-1},b:function Ml(Bs,ga,Ha){var kr=ss.exec(ga.slice(Ha));return kr?(Bs.m=Io.get(kr[0].toLowerCase()),Ha+kr[0].length):-1},B:function qs(Bs,ga,Ha){var kr=ir.exec(ga.slice(Ha));return kr?(Bs.m=ur.get(kr[0].toLowerCase()),Ha+kr[0].length):-1},c:function Qo(Bs,ga,Ha){return cl(Bs,G,ga,Ha)},d:Ua,e:Ua,f:U1,g:qi,G:Gg,H:Hm,I:Hm,j:UA,L:qg,m:bi,M:lh,p:function _c(Bs,ga,Ha){var kr=Yt.exec(ga.slice(Ha));return kr?(Bs.p=hn.get(kr[0].toLowerCase()),Ha+kr[0].length):-1},q:vi,Q:z1,s:qc,S:zA,u:F1,U:O1,V:L1,w:zm,W:N1,x:function vu(Bs,ga,Ha){return cl(Bs,ye,ga,Ha)},X:function Kd(Bs,ga,Ha){return cl(Bs,we,ga,Ha)},y:qi,Y:Gg,Z:ma,"%":gv};function ls(Bs,ga){return function(Ha){var gh,XA,Yx,kr=[],Uu=-1,ha=0,dc=Bs.length;for(Ha instanceof Date||(Ha=new Date(+Ha));++Uu<dc;)37===Bs.charCodeAt(Uu)&&(kr.push(Bs.slice(ha,Uu)),null!=(XA=Rh[gh=Bs.charAt(++Uu)])?gh=Bs.charAt(++Uu):XA="e"===gh?" ":"0",(Yx=ga[gh])&&(gh=Yx(Ha,XA)),kr.push(gh),ha=Uu+1);return kr.push(Bs.slice(ha,Uu)),kr.join("")}}function Bo(Bs,ga){return function(Ha){var ha,dc,kr=op(1900,void 0,1);if(cl(kr,Bs,Ha+="",0)!=Ha.length)return null;if("Q"in kr)return new Date(kr.Q);if("s"in kr)return new Date(1e3*kr.s+("L"in kr?kr.L:0));if(ga&&!("Z"in kr)&&(kr.Z=0),"p"in kr&&(kr.H=kr.H%12+12*kr.p),void 0===kr.m&&(kr.m="q"in kr?kr.q:0),"V"in kr){if(kr.V<1||kr.V>53)return null;"w"in kr||(kr.w=1),"Z"in kr?(dc=(ha=$p(op(kr.y,0,1))).getUTCDay(),ha=dc>4||0===dc?sp.ceil(ha):sp(ha),ha=jp.offset(ha,7*(kr.V-1)),kr.y=ha.getUTCFullYear(),kr.m=ha.getUTCMonth(),kr.d=ha.getUTCDate()+(kr.w+6)%7):(dc=(ha=pf(op(kr.y,0,1))).getDay(),ha=dc>4||0===dc?rp.ceil(ha):rp(ha),ha=ip.offset(ha,7*(kr.V-1)),kr.y=ha.getFullYear(),kr.m=ha.getMonth(),kr.d=ha.getDate()+(kr.w+6)%7)}else("W"in kr||"U"in kr)&&("w"in kr||(kr.w="u"in kr?kr.u%7:"W"in kr?1:0),dc="Z"in kr?$p(op(kr.y,0,1)).getUTCDay():pf(op(kr.y,0,1)).getDay(),kr.m=0,kr.d="W"in kr?(kr.w+6)%7+7*kr.W-(dc+5)%7:kr.w+7*kr.U-(dc+6)%7);return"Z"in kr?(kr.H+=kr.Z/100|0,kr.M+=kr.Z%100,$p(kr)):pf(kr)}}function cl(Bs,ga,Ha,kr){for(var gh,XA,Uu=0,ha=ga.length,dc=Ha.length;Uu<ha;){if(kr>=dc)return-1;if(37===(gh=ga.charCodeAt(Uu++))){if(gh=ga.charAt(Uu++),!(XA=Os[gh in Rh?ga.charAt(Uu++):gh])||(kr=XA(Bs,Ha,kr))<0)return-1}else if(gh!=Ha.charCodeAt(kr++))return-1}return kr}return Ir.x=ls(ye,Ir),Ir.X=ls(we,Ir),Ir.c=ls(G,Ir),Wi.x=ls(ye,Wi),Wi.X=ls(we,Wi),Wi.c=ls(G,Wi),{format:function(Bs){var ga=ls(Bs+="",Ir);return ga.toString=function(){return Bs},ga},parse:function(Bs){var ga=Bo(Bs+="",!1);return ga.toString=function(){return Bs},ga},utcFormat:function(Bs){var ga=ls(Bs+="",Wi);return ga.toString=function(){return Bs},ga},utcParse:function(Bs){var ga=Bo(Bs+="",!0);return ga.toString=function(){return Bs},ga}}}(y),Xg=gf.format,Kg=gf.utcFormat,yv=gf.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Zg="%Y-%m-%dT%H:%M:%S.%LZ";function W1(y){return new Date(y)}function g_(y){return y instanceof Date?+y:+new Date(+y)}function e0(y,G,ye,we,tt,pt,Ct,Pt,$t,Yt){var hn=xo(),Kn=hn.invert,Xn=hn.domain,xi=Yt(".%L"),wr=Yt(":%S"),ir=Yt("%I:%M"),ur=Yt("%I %p"),ss=Yt("%a %d"),Io=Yt("%b %d"),Ir=Yt("%B"),Wi=Yt("%Y");function Os(ls){return($t(ls)<ls?xi:Pt(ls)<ls?wr:Ct(ls)<ls?ir:pt(ls)<ls?ur:we(ls)<ls?tt(ls)<ls?ss:Io:ye(ls)<ls?Ir:Wi)(ls)}return hn.invert=function(ls){return new Date(Kn(ls))},hn.domain=function(ls){return arguments.length?Xn(Array.from(ls,g_)):Xn().map(W1)},hn.ticks=function(ls){var Bo=Xn();return y(Bo[0],Bo[Bo.length-1],ls??10)},hn.tickFormat=function(ls,Bo){return null==Bo?Os:Yt(Bo)},hn.nice=function(ls){var Bo=Xn();return(!ls||"function"!=typeof ls.range)&&(ls=G(Bo[0],Bo[Bo.length-1],ls??10)),ls?Xn(Eh(Bo,ls)):hn},hn.copy=function(){return Im(hn,e0(y,G,ye,we,tt,pt,Ct,Pt,$t,Yt))},hn}function Oh(){return Kl.apply(e0(i_,Rc,ah,Rd,Ph,ip,np,tp,Fu,Xg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Fc(y){return function(){return y}}Date.prototype.toISOString||Kg(Zg),+new Date("2000-01-01T00:00:00.000Z")||yv(Zg);const X1=Math.abs,wo=Math.atan2,ka=Math.cos,lc=Math.max,Y1=Math.min,Aa=Math.sin,Jp=Math.sqrt,pd=1e-12,qA=Math.PI,_u=qA/2,xv=2*qA;function n0(y){return y>=1?_u:y<=-1?-_u:Math.asin(y)}function K1(y){return y.innerRadius}function $o(y){return y.outerRadius}function qr(y){return y.startAngle}function fh(y){return y.endAngle}function QA(y){return y&&y.padAngle}function WA(y,G,ye,we,tt,pt,Ct){var Pt=y-ye,$t=G-we,Yt=(Ct?pt:-pt)/Jp(Pt*Pt+$t*$t),hn=Yt*$t,Kn=-Yt*Pt,Xn=y+hn,xi=G+Kn,wr=ye+hn,ir=we+Kn,ur=(Xn+wr)/2,ss=(xi+ir)/2,Io=wr-Xn,Ir=ir-xi,Wi=Io*Io+Ir*Ir,Os=tt-pt,ls=Xn*ir-wr*xi,Bo=(Ir<0?-1:1)*Jp(lc(0,Os*Os*Wi-ls*ls)),cl=(ls*Ir-Io*Bo)/Wi,_c=(-ls*Io-Ir*Bo)/Wi,cc=(ls*Ir+Io*Bo)/Wi,js=(-ls*Io+Ir*Bo)/Wi,Ml=cl-ur,qs=_c-ss,Qo=cc-ur,vu=js-ss;return Ml*Ml+qs*qs>Qo*Qo+vu*vu&&(cl=cc,_c=js),{cx:cl,cy:_c,x01:-hn,y01:-Kn,x11:cl*(tt/Os-1),y11:_c*(tt/Os-1)}}function Cv(){var y=K1,G=$o,ye=Fc(0),we=null,tt=qr,pt=fh,Ct=QA,Pt=null,$t=function b_(y){let G=3;return y.digits=function(ye){if(!arguments.length)return G;if(null==ye)G=null;else{const we=Math.floor(ye);if(!(we>=0))throw new RangeError(`invalid digits: ${ye}`);G=we}return y},()=>new Zt(G)}(Yt);function Yt(){var hn,Kn,Xn=+y.apply(this,arguments),xi=+G.apply(this,arguments),wr=tt.apply(this,arguments)-_u,ir=pt.apply(this,arguments)-_u,ur=X1(ir-wr),ss=ir>wr;if(Pt||(Pt=hn=$t()),xi<Xn&&(Kn=xi,xi=Xn,Xn=Kn),xi>pd)if(ur>xv-pd)Pt.moveTo(xi*ka(wr),xi*Aa(wr)),Pt.arc(0,0,xi,wr,ir,!ss),Xn>pd&&(Pt.moveTo(Xn*ka(ir),Xn*Aa(ir)),Pt.arc(0,0,Xn,ir,wr,ss));else{var qs,Qo,Io=wr,Ir=ir,Wi=wr,Os=ir,ls=ur,Bo=ur,cl=Ct.apply(this,arguments)/2,_c=cl>pd&&(we?+we.apply(this,arguments):Jp(Xn*Xn+xi*xi)),cc=Y1(X1(xi-Xn)/2,+ye.apply(this,arguments)),js=cc,Ml=cc;if(_c>pd){var vu=n0(_c/Xn*Aa(cl)),Kd=n0(_c/xi*Aa(cl));(ls-=2*vu)>pd?(Wi+=vu*=ss?1:-1,Os-=vu):(ls=0,Wi=Os=(wr+ir)/2),(Bo-=2*Kd)>pd?(Io+=Kd*=ss?1:-1,Ir-=Kd):(Bo=0,Io=Ir=(wr+ir)/2)}var id=xi*ka(Io),Od=xi*Aa(Io),Jl=Xn*ka(Os),pp=Xn*Aa(Os);if(cc>pd){var Ah,d0=xi*ka(Ir),E_=xi*Aa(Ir),Ym=Xn*ka(Wi),Km=Xn*Aa(Wi);if(ur<qA)if(Ah=function dp(y,G,ye,we,tt,pt,Ct,Pt){var $t=ye-y,Yt=we-G,hn=Ct-tt,Kn=Pt-pt,Xn=Kn*$t-hn*Yt;if(!(Xn*Xn<pd))return[y+(Xn=(hn*(G-pt)-Kn*(y-tt))/Xn)*$t,G+Xn*Yt]}(id,Od,Ym,Km,d0,E_,Jl,pp)){var u0=id-Ah[0],h0=Od-Ah[1],Sf=d0-Ah[0],Bs=E_-Ah[1],ga=1/Aa(function wv(y){return y>1?0:y<-1?qA:Math.acos(y)}((u0*Sf+h0*Bs)/(Jp(u0*u0+h0*h0)*Jp(Sf*Sf+Bs*Bs)))/2),Ha=Jp(Ah[0]*Ah[0]+Ah[1]*Ah[1]);js=Y1(cc,(Xn-Ha)/(ga-1)),Ml=Y1(cc,(xi-Ha)/(ga+1))}else js=Ml=0}Bo>pd?Ml>pd?(qs=WA(Ym,Km,id,Od,xi,Ml,ss),Qo=WA(d0,E_,Jl,pp,xi,Ml,ss),Pt.moveTo(qs.cx+qs.x01,qs.cy+qs.y01),Ml<cc?Pt.arc(qs.cx,qs.cy,Ml,wo(qs.y01,qs.x01),wo(Qo.y01,Qo.x01),!ss):(Pt.arc(qs.cx,qs.cy,Ml,wo(qs.y01,qs.x01),wo(qs.y11,qs.x11),!ss),Pt.arc(0,0,xi,wo(qs.cy+qs.y11,qs.cx+qs.x11),wo(Qo.cy+Qo.y11,Qo.cx+Qo.x11),!ss),Pt.arc(Qo.cx,Qo.cy,Ml,wo(Qo.y11,Qo.x11),wo(Qo.y01,Qo.x01),!ss))):(Pt.moveTo(id,Od),Pt.arc(0,0,xi,Io,Ir,!ss)):Pt.moveTo(id,Od),Xn>pd&&ls>pd?js>pd?(qs=WA(Jl,pp,d0,E_,Xn,-js,ss),Qo=WA(id,Od,Ym,Km,Xn,-js,ss),Pt.lineTo(qs.cx+qs.x01,qs.cy+qs.y01),js<cc?Pt.arc(qs.cx,qs.cy,js,wo(qs.y01,qs.x01),wo(Qo.y01,Qo.x01),!ss):(Pt.arc(qs.cx,qs.cy,js,wo(qs.y01,qs.x01),wo(qs.y11,qs.x11),!ss),Pt.arc(0,0,Xn,wo(qs.cy+qs.y11,qs.cx+qs.x11),wo(Qo.cy+Qo.y11,Qo.cx+Qo.x11),ss),Pt.arc(Qo.cx,Qo.cy,js,wo(Qo.y11,Qo.x11),wo(Qo.y01,Qo.x01),!ss))):Pt.arc(0,0,Xn,Os,Wi,ss):Pt.lineTo(Jl,pp)}else Pt.moveTo(0,0);if(Pt.closePath(),hn)return Pt=null,hn+""||null}return Yt.centroid=function(){var hn=(+y.apply(this,arguments)+ +G.apply(this,arguments))/2,Kn=(+tt.apply(this,arguments)+ +pt.apply(this,arguments))/2-qA/2;return[ka(Kn)*hn,Aa(Kn)*hn]},Yt.innerRadius=function(hn){return arguments.length?(y="function"==typeof hn?hn:Fc(+hn),Yt):y},Yt.outerRadius=function(hn){return arguments.length?(G="function"==typeof hn?hn:Fc(+hn),Yt):G},Yt.cornerRadius=function(hn){return arguments.length?(ye="function"==typeof hn?hn:Fc(+hn),Yt):ye},Yt.padRadius=function(hn){return arguments.length?(we=null==hn?null:"function"==typeof hn?hn:Fc(+hn),Yt):we},Yt.startAngle=function(hn){return arguments.length?(tt="function"==typeof hn?hn:Fc(+hn),Yt):tt},Yt.endAngle=function(hn){return arguments.length?(pt="function"==typeof hn?hn:Fc(+hn),Yt):pt},Yt.padAngle=function(hn){return arguments.length?(Ct="function"==typeof hn?hn:Fc(+hn),Yt):Ct},Yt.context=function(hn){return arguments.length?(Pt=hn??null,Yt):Pt},Yt}var sl,ph,Qm=0,em=0,td=0,r0=1e3,Wm=0,_f=0,yl=0,Cl="object"==typeof performance&&performance.now?performance:Date,up="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(y){setTimeout(y,17)};function yu(){return _f||(up(s0),_f=Cl.now()+yl)}function s0(){_f=0}function o0(){this._call=this._time=this._next=null}function a0(y,G,ye){var we=new o0;return we.restart(y,G,ye),we}function tm(){_f=(Wm=Cl.now())+yl,Qm=em=0;try{!function x_(){yu(),++Qm;for(var G,y=sl;y;)(G=_f-y._time)>=0&&y._call.call(void 0,G),y=y._next;--Qm}()}finally{Qm=0,function jm(){for(var y,ye,G=sl,we=1/0;G;)G._call?(we>G._time&&(we=G._time),y=G,G=G._next):(ye=G._next,G._next=null,G=y?y._next=ye:sl=ye);ph=y,l0(we)}(),_f=0}}function Mv(){var y=Cl.now(),G=y-Wm;G>r0&&(yl-=G,Wm=y)}function l0(y){Qm||(em&&(em=clearTimeout(em)),y-_f>24?(y<1/0&&(em=setTimeout(tm,y-Cl.now()-yl)),td&&(td=clearInterval(td))):(td||(Wm=Cl.now(),td=setInterval(Mv,r0)),Qm=1,up(tm)))}function w_(y,G,ye){var we=new o0;return we.restart(tt=>{we.stop(),y(tt+G)},G=null==G?0:+G,ye),we}o0.prototype=a0.prototype={constructor:o0,restart:function(y,G,ye){if("function"!=typeof y)throw new TypeError("callback is not a function");ye=(null==ye?yu():+ye)+(null==G?0:+G),!this._next&&ph!==this&&(ph?ph._next=this:sl=this,ph=this),this._call=y,this._time=ye,l0()},stop:function(){this._call&&(this._call=null,this._time=1/0,l0())}};var hp=Wt("start","end","cancel","interrupt"),Ws=[],jA=0,xs=3;function nm(y,G,ye,we,tt,pt){var Ct=y.__transition;if(Ct){if(ye in Ct)return}else y.__transition={};!function oe(y,G,ye){var tt,we=y.__transition;function Ct(Yt){var hn,Kn,Xn,xi;if(1!==ye.state)return $t();for(hn in we)if((xi=we[hn]).name===ye.name){if(xi.state===xs)return w_(Ct);4===xi.state?(xi.state=6,xi.timer.stop(),xi.on.call("interrupt",y,y.__data__,xi.index,xi.group),delete we[hn]):+hn<G&&(xi.state=6,xi.timer.stop(),xi.on.call("cancel",y,y.__data__,xi.index,xi.group),delete we[hn])}if(w_(function(){ye.state===xs&&(ye.state=4,ye.timer.restart(Pt,ye.delay,ye.time),Pt(Yt))}),ye.state=2,ye.on.call("start",y,y.__data__,ye.index,ye.group),2===ye.state){for(ye.state=xs,tt=new Array(Xn=ye.tween.length),hn=0,Kn=-1;hn<Xn;++hn)(xi=ye.tween[hn].value.call(y,y.__data__,ye.index,ye.group))&&(tt[++Kn]=xi);tt.length=Kn+1}}function Pt(Yt){for(var hn=Yt<ye.duration?ye.ease.call(null,Yt/ye.duration):(ye.timer.restart($t),ye.state=5,1),Kn=-1,Xn=tt.length;++Kn<Xn;)tt[Kn].call(y,hn);5===ye.state&&(ye.on.call("end",y,y.__data__,ye.index,ye.group),$t())}function $t(){for(var Yt in ye.state=6,ye.timer.stop(),delete we[G],we)return;delete y.__transition}we[G]=ye,ye.timer=a0(function pt(Yt){ye.state=1,ye.timer.restart(Ct,ye.delay,ye.time),ye.delay<=Yt&&Ct(Yt-ye.delay)},0,ye.time)}(y,ye,{name:G,index:we,group:tt,on:hp,tween:Ws,time:pt.time,delay:pt.delay,duration:pt.duration,ease:pt.ease,timer:null,state:jA})}function ee(y,G){var ye=ae(y,G);if(ye.state>jA)throw new Error("too late; already scheduled");return ye}function X(y,G){var ye=ae(y,G);if(ye.state>xs)throw new Error("too late; already running");return ye}function ae(y,G){var ye=y.__transition;if(!ye||!(ye=ye[G]))throw new Error("transition not found");return ye}function kt(y,G){var ye,we;return function(){var tt=X(this,y),pt=tt.tween;if(pt!==ye)for(var Ct=0,Pt=(we=ye=pt).length;Ct<Pt;++Ct)if(we[Ct].name===G){(we=we.slice()).splice(Ct,1);break}tt.tween=we}}function an(y,G,ye){var we,tt;if("function"!=typeof ye)throw new Error;return function(){var pt=X(this,y),Ct=pt.tween;if(Ct!==we){tt=(we=Ct).slice();for(var Pt={name:G,value:ye},$t=0,Yt=tt.length;$t<Yt;++$t)if(tt[$t].name===G){tt[$t]=Pt;break}$t===Yt&&tt.push(Pt)}pt.tween=tt}}function Yn(y,G,ye){var we=y._id;return y.each(function(){var tt=X(this,we);(tt.value||(tt.value={}))[G]=ye.apply(this,arguments)}),function(tt){return ae(tt,we).value[G]}}function ni(y,G){var ye;return("number"==typeof G?Jc:G instanceof D?Op:(ye=D(G))?(G=ye,Op):Fg)(y,G)}function ii(y){return function(){this.removeAttribute(y)}}function Gi(y){return function(){this.removeAttributeNS(y.space,y.local)}}function ms(y,G,ye){var we,pt,tt=ye+"";return function(){var Ct=this.getAttribute(y);return Ct===tt?null:Ct===we?pt:pt=G(we=Ct,ye)}}function Pr(y,G,ye){var we,pt,tt=ye+"";return function(){var Ct=this.getAttributeNS(y.space,y.local);return Ct===tt?null:Ct===we?pt:pt=G(we=Ct,ye)}}function Dr(y,G,ye){var we,tt,pt;return function(){var Ct,$t,Pt=ye(this);return null==Pt?void this.removeAttribute(y):(Ct=this.getAttribute(y))===($t=Pt+"")?null:Ct===we&&$t===tt?pt:(tt=$t,pt=G(we=Ct,Pt))}}function Do(y,G,ye){var we,tt,pt;return function(){var Ct,$t,Pt=ye(this);return null==Pt?void this.removeAttributeNS(y.space,y.local):(Ct=this.getAttributeNS(y.space,y.local))===($t=Pt+"")?null:Ct===we&&$t===tt?pt:(tt=$t,pt=G(we=Ct,Pt))}}function qo(y,G){var ye,we;function tt(){var pt=G.apply(this,arguments);return pt!==we&&(ye=(we=pt)&&function za(y,G){return function(ye){this.setAttributeNS(y.space,y.local,G.call(this,ye))}}(y,pt)),ye}return tt._value=G,tt}function Co(y,G){var ye,we;function tt(){var pt=G.apply(this,arguments);return pt!==we&&(ye=(we=pt)&&function Ms(y,G){return function(ye){this.setAttribute(y,G.call(this,ye))}}(y,pt)),ye}return tt._value=G,tt}function Ta(y,G){return function(){ee(this,y).delay=+G.apply(this,arguments)}}function ba(y,G){return G=+G,function(){ee(this,y).delay=G}}function Rl(y,G){return function(){X(this,y).duration=+G.apply(this,arguments)}}function Xa(y,G){return G=+G,function(){X(this,y).duration=G}}var $A=Pu.prototype.constructor;function Wx(y){return function(){this.style.removeProperty(y)}}var wT=0;function am(y,G,ye,we){this._groups=y,this._parents=G,this._name=ye,this._id=we}function Xx(){return++wT}var Mf=Pu.prototype;am.prototype=function Z1(y){return Pu().transition(y)}.prototype={constructor:am,select:function sm(y){var G=this._name,ye=this._id;"function"!=typeof y&&(y=Zn(y));for(var we=this._groups,tt=we.length,pt=new Array(tt),Ct=0;Ct<tt;++Ct)for(var hn,Kn,Pt=we[Ct],$t=Pt.length,Yt=pt[Ct]=new Array($t),Xn=0;Xn<$t;++Xn)(hn=Pt[Xn])&&(Kn=y.call(hn,hn.__data__,Xn,Pt))&&("__data__"in hn&&(Kn.__data__=hn.__data__),Yt[Xn]=Kn,nm(Yt[Xn],G,ye,Xn,Yt,ae(hn,ye)));return new am(pt,this._parents,G,ye)},selectAll:function Uh(y){var G=this._name,ye=this._id;"function"!=typeof y&&(y=vr(y));for(var we=this._groups,tt=we.length,pt=[],Ct=[],Pt=0;Pt<tt;++Pt)for(var hn,$t=we[Pt],Yt=$t.length,Kn=0;Kn<Yt;++Kn)if(hn=$t[Kn]){for(var xi,Xn=y.call(hn,hn.__data__,Kn,$t),wr=ae(hn,ye),ir=0,ur=Xn.length;ir<ur;++ir)(xi=Xn[ir])&&nm(xi,G,ye,ir,Xn,wr);pt.push(Xn),Ct.push(hn)}return new am(pt,Ct,G,ye)},selectChild:Mf.selectChild,selectChildren:Mf.selectChildren,filter:function kd(y){"function"!=typeof y&&(y=Ho(y));for(var G=this._groups,ye=G.length,we=new Array(ye),tt=0;tt<ye;++tt)for(var $t,pt=G[tt],Ct=pt.length,Pt=we[tt]=[],Yt=0;Yt<Ct;++Yt)($t=pt[Yt])&&y.call($t,$t.__data__,Yt,pt)&&Pt.push($t);return new am(we,this._parents,this._name,this._id)},merge:function fp(y){if(y._id!==this._id)throw new Error;for(var G=this._groups,ye=y._groups,we=G.length,pt=Math.min(we,ye.length),Ct=new Array(we),Pt=0;Pt<pt;++Pt)for(var Xn,$t=G[Pt],Yt=ye[Pt],hn=$t.length,Kn=Ct[Pt]=new Array(hn),xi=0;xi<hn;++xi)(Xn=$t[xi]||Yt[xi])&&(Kn[xi]=Xn);for(;Pt<we;++Pt)Ct[Pt]=G[Pt];return new am(Ct,this._parents,this._name,this._id)},selection:function $m(){return new $A(this._groups,this._parents)},transition:function uM(){for(var y=this._name,G=this._id,ye=Xx(),we=this._groups,tt=we.length,pt=0;pt<tt;++pt)for(var $t,Ct=we[pt],Pt=Ct.length,Yt=0;Yt<Pt;++Yt)if($t=Ct[Yt]){var hn=ae($t,G);nm($t,y,ye,Yt,Ct,{time:hn.time+hn.delay+hn.duration,delay:0,duration:hn.duration,ease:hn.ease})}return new am(we,this._parents,y,ye)},call:Mf.call,nodes:Mf.nodes,node:Mf.node,size:Mf.size,empty:Mf.empty,each:Mf.each,on:function im(y,G){var ye=this._id;return arguments.length<2?ae(this.node(),ye).on.on(y):this.each(function wf(y,G,ye){var we,tt,pt=function mh(y){return(y+"").trim().split(/^|\s+/).every(function(G){var ye=G.indexOf(".");return ye>=0&&(G=G.slice(0,ye)),!G||"start"===G})}(G)?ee:X;return function(){var Ct=pt(this,y),Pt=Ct.on;Pt!==we&&(tt=(we=Pt).copy()).on(G,ye),Ct.on=tt}}(ye,y,G))},attr:function Fs(y,G){var ye=xn(y),we="transform"===ye?K0:ni;return this.attrTween(y,"function"==typeof G?(ye.local?Do:Dr)(ye,we,Yn(this,"attr."+y,G)):null==G?(ye.local?Gi:ii)(ye):(ye.local?Pr:ms)(ye,we,G))},attrTween:function hs(y,G){var ye="attr."+y;if(arguments.length<2)return(ye=this.tween(ye))&&ye._value;if(null==G)return this.tween(ye,null);if("function"!=typeof G)throw new Error;var we=xn(y);return this.tween(ye,(we.local?qo:Co)(we,G))},style:function Sv(y,G,ye){var we="transform"==(y+="")?fv:ni;return null==G?this.styleTween(y,function aM(y,G){var ye,we,tt;return function(){var pt=ao(this,y),Ct=(this.style.removeProperty(y),ao(this,y));return pt===Ct?null:pt===ye&&Ct===we?tt:tt=G(ye=pt,we=Ct)}}(y,we)).on("end.style."+y,Wx(y)):"function"==typeof G?this.styleTween(y,function lM(y,G,ye){var we,tt,pt;return function(){var Ct=ao(this,y),Pt=ye(this),$t=Pt+"";return null==Pt&&(this.style.removeProperty(y),$t=Pt=ao(this,y)),Ct===$t?null:Ct===we&&$t===tt?pt:(tt=$t,pt=G(we=Ct,Pt))}}(y,we,Yn(this,"style."+y,G))).each(function jx(y,G){var ye,we,tt,Pt,pt="style."+G,Ct="end."+pt;return function(){var $t=X(this,y),Yt=$t.on,hn=null==$t.value[pt]?Pt||(Pt=Wx(G)):void 0;(Yt!==ye||tt!==hn)&&(we=(ye=Yt).copy()).on(Ct,tt=hn),$t.on=we}}(this._id,y)):this.styleTween(y,function bT(y,G,ye){var we,pt,tt=ye+"";return function(){var Ct=ao(this,y);return Ct===tt?null:Ct===we?pt:pt=G(we=Ct,ye)}}(y,we,G),ye).on("end.style."+y,null)},styleTween:function M_(y,G,ye){var we="style."+(y+="");if(arguments.length<2)return(we=this.tween(we))&&we._value;if(null==G)return this.tween(we,null);if("function"!=typeof G)throw new Error;return this.tween(we,function Xm(y,G,ye){var we,tt;function pt(){var Ct=G.apply(this,arguments);return Ct!==tt&&(we=(tt=Ct)&&function cM(y,G,ye){return function(we){this.style.setProperty(y,G.call(this,we),ye)}}(y,Ct,ye)),we}return pt._value=G,pt}(y,G,ye??""))},text:function om(y){return this.tween("text","function"==typeof y?function $x(y){return function(){var G=y(this);this.textContent=G??""}}(Yn(this,"text",y)):function dM(y){return function(){this.textContent=y}}(null==y?"":y+""))},textTween:function Ev(y){var G="text";if(arguments.length<1)return(G=this.tween(G))&&G._value;if(null==y)return this.tween(G,null);if("function"!=typeof y)throw new Error;return this.tween(G,function Fd(y){var G,ye;function we(){var tt=y.apply(this,arguments);return tt!==ye&&(G=(ye=tt)&&function xT(y){return function(G){this.textContent=y.call(this,G)}}(tt)),G}return we._value=y,we}(y))},remove:function Cf(){return this.on("end.remove",function rm(y){return function(){var G=this.parentNode;for(var ye in this.__transition)if(+ye!==y)return;G&&G.removeChild(this)}}(this._id))},tween:function sn(y,G){var ye=this._id;if(y+="",arguments.length<2){for(var Ct,we=ae(this.node(),ye).tween,tt=0,pt=we.length;tt<pt;++tt)if((Ct=we[tt]).name===y)return Ct.value;return null}return this.each((null==G?kt:an)(ye,y,G))},delay:function So(y){var G=this._id;return arguments.length?this.each(("function"==typeof y?Ta:ba)(G,y)):ae(this.node(),G).delay},duration:function el(y){var G=this._id;return arguments.length?this.each(("function"==typeof y?Rl:Xa)(G,y)):ae(this.node(),G).duration},ease:function Qc(y){var G=this._id;return arguments.length?this.each(function Ya(y,G){if("function"!=typeof G)throw new Error;return function(){X(this,y).ease=G}}(G,y)):ae(this.node(),G).ease},easeVarying:function nd(y){if("function"!=typeof y)throw new Error;return this.each(function xf(y,G){return function(){var ye=G.apply(this,arguments);if("function"!=typeof ye)throw new Error;X(this,y).ease=ye}}(this._id,y))},end:function hM(){var y,G,ye=this,we=ye._id,tt=ye.size();return new Promise(function(pt,Ct){var Pt={value:Ct},$t={value:function(){0==--tt&&pt()}};ye.each(function(){var Yt=X(this,we),hn=Yt.on;hn!==y&&((G=(y=hn).copy())._.cancel.push(Pt),G._.interrupt.push(Pt),G._.end.push($t)),Yt.on=G}),0===tt&&pt()})},[Symbol.iterator]:Mf[Symbol.iterator]};var c0={time:null,delay:0,duration:250,ease:function Tv(y){return((y*=2)<=1?y*y*y:(y-=2)*y*y+2)/2}};function Dv(y,G){for(var ye;!(ye=y.__transition)||!(ye=ye[G]);)if(!(y=y.parentNode))throw new Error(`transition ${G} not found`);return ye}Pu.prototype.interrupt=function ft(y){return this.each(function(){!function Ve(y,G){var we,tt,Ct,ye=y.__transition,pt=!0;if(ye){for(Ct in G=null==G?null:G+"",ye)(we=ye[Ct]).name===G?(tt=we.state>2&&we.state<5,we.state=6,we.timer.stop(),we.on.call(tt?"interrupt":"cancel",y,y.__data__,we.index,we.group),delete ye[Ct]):pt=!1;pt&&delete y.__transition}}(this,y)})},Pu.prototype.transition=function Iv(y){var G,ye;y instanceof am?(G=y._id,y=y._name):(G=Xx(),(ye=c0).time=yu(),y=null==y?null:y+"");for(var we=this._groups,tt=we.length,pt=0;pt<tt;++pt)for(var $t,Ct=we[pt],Pt=Ct.length,Yt=0;Yt<Pt;++Yt)($t=Ct[Yt])&&nm($t,y,G,Yt,Ct,ye||Dv($t,G));return new am(we,this._parents,y,G)}},69:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{$2:()=>te,AI:()=>m,Xv:()=>F,hd:()=>L,iO:()=>U,uA:()=>C});var ve=Ee(467),z=(Ee(5680),Ee(6998)),ke=Ee(471),xe=Ee(4779),et=Ee(9041),Je=Ee(6224),Xe=Ee(1e3);function ot(){return Re.apply(this,arguments)}function Re(){return(Re=(0,ve.A)(function*(){return Ee.e(423).then(Ee.bind(Ee,6423))})).apply(this,arguments)}function He(){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,ve.A)(function*(){return Promise.resolve().then(Ee.bind(Ee,9025))})).apply(this,arguments)}function O(){return ce.apply(this,arguments)}function ce(){return(ce=(0,ve.A)(function*(){return Promise.all([Ee.e(693),Ee.e(76),Ee.e(716)]).then(Ee.bind(Ee,716))})).apply(this,arguments)}function ie(){return he.apply(this,arguments)}function he(){return(he=(0,ve.A)(function*(){return Promise.resolve().then(Ee.bind(Ee,7041))})).apply(this,arguments)}function ue(){return fe.apply(this,arguments)}function fe(){return(fe=(0,ve.A)(function*(){return Promise.resolve().then(Ee.bind(Ee,4491)).then(Q=>{const Ke=L(z.prROOT+"TGeoVolumeAssembly");return Ke&&(Ke.icon="img_geoassembly"),Q})})).apply(this,arguments)}const le="TGraph2D",Y="TH2Poly",V="TEllipse",D="TSpline3",w="TTree",P="TCanvasWebSnapshot",x="fPrimitives",v="fFunctions",_={lst:[{name:z.clTCanvas,icon:"img_canvas",class:()=>He().then(Q=>Q.TCanvasPainter),opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:x,noappend:!0},{name:z.clTPad,icon:"img_canvas",func:Xe.jg.draw,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:x,noappend:!0},{name:"TSlider",icon:"img_canvas",func:Xe.jg.draw},{name:Xe.cw,icon:"img_canvas",func:Xe.jg.draw},{name:z.clTFrame,icon:"img_frame",draw:()=>He().then(Q=>Q.drawTFrame)},{name:z.clTPave,icon:"img_pavetext",class:()=>Promise.resolve().then(Ee.bind(Ee,4485)).then(Q=>Q.TPavePainter)},{name:z.clTPaveText,sameas:z.clTPave},{name:z.clTPavesText,sameas:z.clTPave},{name:z.clTPaveStats,sameas:z.clTPave},{name:z.clTPaveLabel,sameas:z.clTPave},{name:z.clTPaveClass,sameas:z.clTPave},{name:z.clTDiamond,sameas:z.clTPave},{name:z.clTLegend,icon:"img_pavelabel",sameas:z.clTPave},{name:z.clTPaletteAxis,icon:"img_colz",sameas:z.clTPave},{name:z.clTLatex,icon:"img_text",draw:()=>ot().then(Q=>Q.drawText),direct:!0},{name:z.clTMathText,sameas:z.clTLatex},{name:z.clTText,sameas:z.clTLatex},{name:z.clTAnnotation,sameas:z.clTLatex},{name:/^TH1/,icon:"img_histo1d",class:()=>Promise.resolve().then(Ee.bind(Ee,1516)).then(Q=>Q.TH1Painter),opt:";hist;P;P0;E;E1;E2;E3;E4;E1X0;L;LF2;C;B;B1;A;TEXT;LEGO;same",ctrl:"l",expand_item:v,for_derived:!0},{name:z.clTProfile,icon:"img_profile",class:()=>Promise.resolve().then(Ee.bind(Ee,1516)).then(Q=>Q.TH1Painter),opt:";E0;E1;E2;p;AH;hist",expand_item:v},{name:Y,icon:"img_histo2d",class:()=>Promise.resolve().then(Ee.bind(Ee,4149)).then(Q=>Q.TH2Painter),opt:";COL;COL0;COLZ;LCOL;LCOL0;LCOLZ;LEGO;TEXT;same",expand_item:"fBins",theonly:!0},{name:"TProfile2Poly",sameas:Y},{name:"TH2PolyBin",icon:"img_histo2d",draw_field:"fPoly",draw_field_opt:"L"},{name:/^TH2/,icon:"img_histo2d",class:()=>Promise.resolve().then(Ee.bind(Ee,4149)).then(Q=>Q.TH2Painter),dflt:"col",opt:";COL;COLZ;COL0;COL1;COL0Z;COL1Z;COLA;BOX;BOX1;PROJ;PROJX1;PROJX2;PROJX3;PROJY1;PROJY2;PROJY3;SCAT;TEXT;TEXTE;TEXTE0;CANDLE;CANDLE1;CANDLE2;CANDLE3;CANDLE4;CANDLE5;CANDLE6;CANDLEY1;CANDLEY2;CANDLEY3;CANDLEY4;CANDLEY5;CANDLEY6;VIOLIN;VIOLIN1;VIOLIN2;VIOLINY1;VIOLINY2;CONT;CONT1;CONT2;CONT3;CONT4;ARR;SURF;SURF1;SURF2;SURF4;SURF6;E;A;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same",ctrl:"lego",expand_item:v,for_derived:!0},{name:z.clTProfile2D,sameas:z.clTH2},{name:/^TH3/,icon:"img_histo3d",class:()=>Promise.resolve().then(Ee.bind(Ee,1462)).then(Q=>Q.TH3Painter),opt:";SCAT;BOX;BOX2;BOX3;GLBOX1;GLBOX2;GLCOL",expand_item:v,for_derived:!0},{name:z.clTProfile3D,sameas:z.clTH3},{name:z.clTHStack,icon:"img_histo1d",class:()=>Ee.e(675).then(Ee.bind(Ee,3675)).then(Q=>Q.THStackPainter),expand_item:"fHists",opt:"NOSTACK;HIST;E;PFC;PLC"},{name:z.clTPolyMarker3D,icon:"img_histo3d",draw:()=>Promise.all([Ee.e(76),Ee.e(583)]).then(Ee.bind(Ee,8583)).then(Q=>Q.drawPolyMarker3D),direct:!0,frame:"3d"},{name:z.clTPolyLine3D,icon:"img_graph",draw:()=>Promise.all([Ee.e(76),Ee.e(583)]).then(Ee.bind(Ee,8583)).then(Q=>Q.drawPolyLine3D),direct:!0,frame:"3d"},{name:"TGraphStruct"},{name:"TGraphNode"},{name:"TGraphEdge"},{name:z.clTGraphTime,icon:"img_graph",class:()=>Ee.e(330).then(Ee.bind(Ee,4330)).then(Q=>Q.TGraphTimePainter),opt:"once;repeat;first",theonly:!0},{name:le,icon:"img_graph",class:()=>Ee.e(921).then(Ee.bind(Ee,921)).then(Q=>Q.TGraph2DPainter),opt:";P;PCOL",theonly:!0},{name:z.clTGraph2DErrors,sameas:le,opt:";P;PCOL;ERR",theonly:!0},{name:z.clTGraph2DAsymmErrors,sameas:le,opt:";P;PCOL;ERR",theonly:!0},{name:z.clTGraphPolargram,icon:"img_graph",class:()=>Ee.e(226).then(Ee.bind(Ee,9845)).then(Q=>Q.TGraphPolargramPainter),theonly:!0},{name:z.clTGraphPolar,icon:"img_graph",class:()=>Ee.e(226).then(Ee.bind(Ee,9845)).then(Q=>Q.TGraphPolarPainter),opt:";F;L;P;PE",theonly:!0},{name:/^TGraph/,icon:"img_graph",class:()=>Ee.e(693).then(Ee.bind(Ee,4693)).then(Q=>Q.TGraphPainter),opt:";L;P"},{name:"TEfficiency",icon:"img_graph",class:()=>Promise.all([Ee.e(693),Ee.e(76),Ee.e(86)]).then(Ee.bind(Ee,5086)).then(Q=>Q.TEfficiencyPainter),opt:";AP"},{name:z.clTCutG,sameas:z.clTGraph},{name:/^RooHist/,sameas:z.clTGraph},{name:/^RooCurve/,sameas:z.clTGraph},{name:"TScatter",icon:"img_graph",class:()=>Promise.all([Ee.e(693),Ee.e(719)]).then(Ee.bind(Ee,6719)).then(Q=>Q.TScatterPainter),opt:";A"},{name:"RooPlot",icon:"img_canvas",func:function We(Q,Ke){return dt.apply(this,arguments)}},{name:"TRatioPlot",icon:"img_mgraph",class:()=>Promise.all([Ee.e(76),Ee.e(393)]).then(Ee.bind(Ee,5393)).then(Q=>Q.TRatioPlotPainter),opt:""},{name:z.clTMultiGraph,icon:"img_mgraph",class:()=>Promise.all([Ee.e(693),Ee.e(76),Ee.e(902)]).then(Ee.bind(Ee,9902)).then(Q=>Q.TMultiGraphPainter),opt:";l;p;3d",expand_item:"fGraphs"},{name:ke.R0,icon:"img_question",draw:()=>ie().then(Q=>Q.drawStreamerInfo)},{name:"TWebPainting",icon:"img_graph",class:()=>Ee.e(855).then(Ee.bind(Ee,2855)).then(Q=>Q.TWebPaintingPainter)},{name:P,icon:"img_canvas",draw:()=>He().then(Q=>Q.drawTPadSnapshot)},{name:"TPadWebSnapshot",sameas:P},{name:"kind:Text",icon:"img_text",func:Je.as},{name:z.clTObjString,icon:"img_text",func:Je.as},{name:z.clTF1,icon:"img_tf1",class:()=>Ee.e(76).then(Ee.bind(Ee,230)).then(Q=>Q.TF1Painter),opt:";L;C;FC;FL"},{name:z.clTF2,icon:"img_tf2",class:()=>Promise.all([Ee.e(76),Ee.e(843)]).then(Ee.bind(Ee,4843)).then(Q=>Q.TF2Painter),opt:";BOX;ARR;SURF;SURF1;SURF2;SURF4;SURF6;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same"},{name:z.clTF3,icon:"img_histo3d",class:()=>Promise.all([Ee.e(76),Ee.e(524)]).then(Ee.bind(Ee,8524)).then(Q=>Q.TF3Painter),opt:";SURF"},{name:D,icon:"img_tf1",class:()=>Ee.e(392).then(Ee.bind(Ee,4392)).then(Q=>Q.TSplinePainter)},{name:"TSpline5",sameas:D},{name:V,icon:"img_graph",draw:()=>ot().then(Q=>Q.drawEllipse),direct:!0},{name:"TArc",sameas:V},{name:"TCrown",sameas:V},{name:"TPie",icon:"img_graph",draw:()=>ot().then(Q=>Q.drawPie),direct:!0},{name:"TPieSlice",icon:"img_graph",dummy:!0},{name:"TExec",icon:"img_graph",dummy:!0},{name:z.clTLine,icon:"img_graph",class:()=>Ee.e(76).then(Ee.bind(Ee,2695)).then(Q=>Q.TLinePainter)},{name:"TArrow",icon:"img_graph",class:()=>Promise.all([Ee.e(76),Ee.e(316)]).then(Ee.bind(Ee,4316)).then(Q=>Q.TArrowPainter)},{name:z.clTPolyLine,icon:"img_graph",draw:()=>ot().then(Q=>Q.drawPolyLine),direct:!0},{name:"TCurlyLine",sameas:z.clTPolyLine},{name:"TCurlyArc",sameas:z.clTPolyLine},{name:"TParallelCoord",icon:"img_graph",dummy:!0},{name:z.clTGaxis,icon:"img_graph",class:()=>Ee.e(845).then(Ee.bind(Ee,8845)).then(Q=>Q.TGaxisPainter)},{name:z.clTBox,icon:"img_graph",draw:()=>ot().then(Q=>Q.drawBox),direct:!0},{name:"TWbox",sameas:z.clTBox},{name:"TSliderBox",sameas:z.clTBox},{name:"TMarker",icon:"img_graph",draw:()=>ot().then(Q=>Q.drawMarker),direct:!0},{name:"TPolyMarker",icon:"img_graph",draw:()=>ot().then(Q=>Q.drawPolyMarker),direct:!0},{name:"TASImage",icon:"img_mgraph",class:()=>Ee.e(680).then(Ee.bind(Ee,680)).then(Q=>Q.TASImagePainter),opt:";z"},{name:"TJSImage",icon:"img_mgraph",draw:()=>ot().then(Q=>Q.drawJSImage),opt:";scale;center"},{name:z.clTGeoVolume,icon:"img_histo3d",class:()=>ue().then(Q=>Q.TGeoPainter),get_expand:()=>ue().then(Q=>Q.expandGeoObject),opt:";more;all;count;projx;projz;wire;no_screen;dflt",ctrl:"dflt"},{name:"TEveGeoShapeExtract",sameas:z.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt"},{name:z.nsREX+"REveGeoShapeExtract",sameas:z.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt"},{name:"TGeoOverlap",sameas:z.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt",dflt:"dflt",ctrl:"expand"},{name:"TGeoManager",sameas:z.clTGeoVolume,opt:";more;all;count;projx;projz;wire;tracks;no_screen;dflt",dflt:"expand",ctrl:"dflt",noappend:!0,exapnd_after_draw:!0},{name:"TGeoVolumeAssembly",sameas:z.clTGeoVolume,opt:";more;all;count"},{name:/^TGeo/,class:()=>ue().then(Q=>Q.TGeoPainter),get_expand:()=>ue().then(Q=>Q.expandGeoObject),opt:";more;all;axis;compa;count;projx;projz;wire;no_screen;dflt",dflt:"dflt",ctrl:"expand"},{name:"TAxis3D",icon:"img_graph",draw:()=>ue().then(Q=>Q.drawAxis3D),direct:!0},{name:"kind:Command",icon:"img_execute",execute:!0},{name:"TFolder",icon:"img_folder",icon2:"img_folderopen",noinspect:!0,get_expand:()=>ie().then(Q=>Q.folderHierarchy)},{name:"TTask",icon:"img_task",get_expand:()=>ie().then(Q=>Q.taskHierarchy),for_derived:!0},{name:w,icon:"img_tree",get_expand:()=>Promise.resolve().then(Ee.bind(Ee,4779)).then(Q=>Q.treeHierarchy),draw:()=>O().then(Q=>Q.drawTree),dflt:"expand",opt:"player;testio",shift:z.kInspect},{name:"TNtuple",sameas:w},{name:"TNtupleD",sameas:w},{name:xe.clTBranchFunc,icon:"img_leaf_method",draw:()=>O().then(Q=>Q.drawTree),opt:";dump",noinspect:!0},{name:/^TBranch/,icon:"img_branch",draw:()=>O().then(Q=>Q.drawTree),dflt:"expand",opt:";dump",ctrl:"dump",shift:z.kInspect,ignore_online:!0,always_draw:!0},{name:/^TLeaf/,icon:"img_leaf",noexpand:!0,draw:()=>O().then(Q=>Q.drawTree),opt:";dump",ctrl:"dump",ignore_online:!0,always_draw:!0},{name:z.clTList,icon:"img_list",draw:()=>ie().then(Q=>Q.drawList),get_expand:()=>ie().then(Q=>Q.listHierarchy),dflt:"expand"},{name:z.clTHashList,sameas:z.clTList},{name:z.clTObjArray,sameas:z.clTList},{name:z.clTClonesArray,sameas:z.clTList},{name:z.clTMap,sameas:z.clTList},{name:z.clTColor,icon:"img_color"},{name:z.clTFile,icon:"img_file",noinspect:!0},{name:"TMemFile",icon:"img_file",noinspect:!0},{name:z.clTStyle,icon:"img_question",noexpand:!0},{name:"Session",icon:"img_globe"},{name:"kind:TopFolder",icon:"img_base"},{name:"kind:Folder",icon:"img_folder",icon2:"img_folderopen",noinspect:!0},{name:z.nsREX+"RCanvas",icon:"img_canvas",class:()=>Te().then(Q=>Q.RCanvasPainter),opt:"",expand_item:x},{name:z.nsREX+"RCanvasDisplayItem",icon:"img_canvas",draw:()=>Te().then(Q=>Q.drawRPadSnapshot),opt:"",expand_item:x},{name:z.nsREX+"RHist1Drawable",icon:"img_histo1d",class:()=>Te("rh1").then(Q=>Q.RH1Painter),opt:""},{name:z.nsREX+"RHist2Drawable",icon:"img_histo2d",class:()=>Te("rh2").then(Q=>Q.RH2Painter),opt:""},{name:z.nsREX+"RHist3Drawable",icon:"img_histo3d",class:()=>Te("rh3").then(Q=>Q.RH3Painter),opt:""},{name:z.nsREX+"RHistDisplayItem",icon:"img_histo1d",draw:()=>Te("rh3").then(Q=>Q.drawHistDisplayItem),opt:""},{name:z.nsREX+"RText",icon:"img_text",draw:()=>Te("more").then(Q=>Q.drawText),opt:"",direct:"v7",csstype:"text"},{name:z.nsREX+"RFrameTitle",icon:"img_text",draw:()=>Te().then(Q=>Q.drawRFrameTitle),opt:"",direct:"v7",csstype:"title"},{name:z.nsREX+"RPaletteDrawable",icon:"img_text",class:()=>Te("more").then(Q=>Q.RPalettePainter),opt:""},{name:z.nsREX+"RDisplayHistStat",icon:"img_pavetext",class:()=>Te("pave").then(Q=>Q.RHistStatsPainter),opt:""},{name:z.nsREX+"RLine",icon:"img_graph",draw:()=>Te("more").then(Q=>Q.drawLine),opt:"",direct:"v7",csstype:"line"},{name:z.nsREX+"RBox",icon:"img_graph",draw:()=>Te("more").then(Q=>Q.drawBox),opt:"",direct:"v7",csstype:"box"},{name:z.nsREX+"RMarker",icon:"img_graph",draw:()=>Te("more").then(Q=>Q.drawMarker),opt:"",direct:"v7",csstype:"marker"},{name:z.nsREX+"RPave",icon:"img_pavetext",class:()=>Te("pave").then(Q=>Q.RPavePainter),opt:""},{name:z.nsREX+"RLegend",icon:"img_graph",class:()=>Te("pave").then(Q=>Q.RLegendPainter),opt:""},{name:z.nsREX+"RPaveText",icon:"img_pavetext",class:()=>Te("pave").then(Q=>Q.RPaveTextPainter),opt:""},{name:z.nsREX+"RFrame",icon:"img_frame",draw:()=>Te().then(Q=>Q.drawRFrame),opt:""},{name:z.nsREX+"RFont",icon:"img_text",draw:()=>Te().then(Q=>Q.drawRFont),opt:"",direct:"v7",csstype:"font"},{name:z.nsREX+"RAxisDrawable",icon:"img_frame",draw:()=>Te().then(Q=>Q.drawRAxis),opt:""}],cache:{}};function C(Q){return _.lst.push(Q),Q}function L(Q,Ke){if(!(0,z.isStr)(Q))return null;""===Ke&&(Ke=null);let Ze=null;if(null===Ke&&Q in _.cache)return _.cache[Q];const Ue=0===Q.indexOf(z.prROOT)?Q.slice(5):`kind:${Q}`;let Oe=0;for(let lt=0;lt<_.lst.length;++lt){const gt=_.lst[lt];if((0,z.isStr)(gt.name)){if(gt.name!==Ue)continue}else if(!Ue.match(gt.name))continue;if(gt.sameas){const ht=L(z.prROOT+gt.sameas,Ke);if(ht){for(const st in ht)void 0===gt[st]&&(gt[st]=ht[st]);delete gt.sameas}return gt}if(null==Ke)return Q in _.cache||(_.cache[Q]=gt),gt;if((0,z.isStr)(Ke)){if(Ze||(Ze=gt),"::expand"===Ke){if("expand"in gt||"expand_item"in gt)return gt}else if("opt"in gt){const ht=gt.opt.split(";");for(let st=0;st<ht.length;++st)ht[st]=ht[st].toLowerCase();if(ht.indexOf(Ke.toLowerCase())>=0)return gt}}else if(Ke===Oe)return gt;++Oe}return Ze}function F(Q){return(0,z.isStr)(Q)&&(Q=L(Q)),!!(0,z.isObject)(Q)&&(Q.func||Q.class||Q.draw||Q.draw_field)}function U(Q,Ke){const Ze={opts:null,inspect:!1,expand:!1,draw:!1,handle:null};if(!(0,z.isStr)(Q))return Ze;let Ue=!1,Oe=!1,lt=!1;(0,z.isStr)(Ke)||(Ke="");for(let gt=0;gt<1e3;++gt){const ht=L(Q,gt);if(!(ht&&(Ze.handle||(Ze.handle=ht),ht.noinspect&&(Oe=!0),ht.noappend&&(Ze.noappend=!0),(ht.expand||ht.get_expand||ht.expand_item||ht.can_expand)&&(lt=!0),ht.func||ht.class||ht.draw)))break;if(Ue=!0,!("opt"in ht))continue;const st=ht.opt.split(";");for(let yt=0;yt<st.length;++yt)st[yt]=st[yt].toLowerCase(),!(0===st[yt].indexOf("same")&&(Ze.has_same=!0,Ke.indexOf("nosame")>=0))&&(null===Ze.opts&&(Ze.opts=[]),Ze.opts.indexOf(st[yt])<0&&Ze.opts.push(st[yt]));if(ht.theonly)break}return Ke.indexOf("noinspect")>=0&&(Oe=!0),Ue&&null===Ze.opts&&(Ze.opts=[""]),!Ue&&0===Q.indexOf(z.prROOT)&&!Oe&&(Ze.opts=[]),!Oe&&Ze.opts&&Ze.opts.push(z.kInspect),Ze.inspect=!Oe,Ze.expand=lt,Ze.draw=!!Ze.opts,Ze}function te(Q,Ke,Ze){return N.apply(this,arguments)}function N(){return(N=(0,ve.A)(function*(Q,Ke,Ze){if(!(0,z.isObject)(Ke))return Promise.reject(Error("not an object in draw call"));if((0,z.isStr)(Ze)&&0===Ze.indexOf(z.kInspect))return ie().then(ht=>ht.drawInspector(Q,Ke,Ze));let Ue,Oe,gt;if("_typename"in Ke)Oe="type "+Ke._typename,Ue=L(z.prROOT+Ke._typename,Ze);else{if(!("_kind"in Ke))return ie().then(ht=>ht.drawInspector(Q,Ke,Ze));Oe="kind "+Ke._kind,Ue=L(Ke._kind,Ze)}if(!Ue)return Promise.reject(Error(`Object of ${Oe} cannot be shown with draw`));if(Ue.dummy)return null;if(Ue.draw_field&&Ke[Ue.draw_field])return te(Q,Ke[Ue.draw_field],Ze||Ue.draw_field_opt);if(!F(Ue)){if(Ze&&Ze.indexOf("same")>=0){const ht=(0,Je.Nn)(Q);if((0,z.isFunc)(ht?.performDrop))return ht.performDrop(Ke,"",null,Ze)}return Promise.reject(Error(`Function not specified to draw object ${Oe}`))}function lt(){let ht,st;return"v7"===Ue.direct?ht=Ee.e(933).then(Ee.bind(Ee,7933)).then(yt=>(st=new yt.RObjectPainter(Q,Ke,Ze,Ue.csstype),st.redraw=Ue.func,yt.ensureRCanvas(st,Ue.frame||!1))).then(()=>st.redraw()):Ue.direct?(st=new Je.JW(Q,Ke,Ze),st.redraw=Ue.func,ht=He().then(yt=>yt.ensureTCanvas(st,Ue.frame||!1)).then(()=>st.redraw())):ht=(0,z.getPromise)(Ue.func(Q,Ke,Ze)),ht.then(yt=>{if(st||(st=yt),!1===st)return null;if(!st)throw Error(`Fail to draw object ${Oe}`);return(0,z.isObject)(st)&&!st.options&&(st.options={original:Ze||""}),st})}if((0,z.isFunc)(Ue.func))return lt();if((0,z.isFunc)(Ue.class))gt=Ue.class().then(ht=>{Ue.func=ht.draw});else if((0,z.isFunc)(Ue.draw))gt=Ue.draw().then(ht=>{Ue.func=ht});else{if(!Ue.func||!(0,z.isStr)(Ue.func))return Promise.reject(Error(`Draw function or class not specified to draw ${Oe}`));if(!Ue.prereq&&!Ue.script)return Promise.reject(Error(`Prerequicities to load ${Ue.func} are not specified`));gt=(z.internals.ignore_v6?Promise.resolve(!0):(0,z._ensureJSROOT)().then(st=>(Ue.prereq?st.require(Ue.prereq):Promise.resolve(!0)).then(()=>{if(Ue.script)return(0,z.loadScript)(Ue.script)}).then(()=>st._complete_loading()))).then(()=>{const st=(0,z.findFunction)(Ue.func);if(!(0,z.isFunc)(st))return Promise.reject(Error(`Fail to find function ${Ue.func} after loading ${Ue.prereq||Ue.script}`));Ue.func=st})}return gt.then(()=>lt())})).apply(this,arguments)}function m(Q,Ke,Ze){return I.apply(this,arguments)}function I(){return(I=(0,ve.A)(function*(Q,Ke,Ze){if(!(0,z.isObject)(Ke))return Promise.reject(Error("not an object in redraw"));const Ue=(0,Je.m6)(Q);let Oe,gt,lt=null;if(Ke._typename&&(Oe=L(z.prROOT+Ke._typename)),Oe?.draw_field&&Ke[Oe.draw_field]&&(Ke=Ke[Oe.draw_field]),Ue)if(Ue.matchObjectType(Ke._typename))gt=Ue.redrawObject(Ke,Ze),gt&&(lt=Ue);else for(let ht=0;ht<Ue.painters.length;++ht){const st=Ue.painters[ht];if(st.matchObjectType(Ke._typename)&&(gt=st.redrawObject(Ke,Ze),gt)){lt=st;break}}else{const ht=new et.b8(Q).getTopPainter();(0,z.isFunc)(ht?.redrawObject)&&(gt=ht.redrawObject(Ke,Ze),gt&&(lt=ht))}return lt?(0,z.getPromise)(gt).then(()=>lt):((0,Je.tP)(Q),te(Q,Ke,Ze))})).apply(this,arguments)}function be(Q){Q.prototype.drawObject=(...Ke)=>te(...Ke).catch(Ze=>(console.log(`Error ${Ze?.message??Ze}  at ${Ze?.stack??"uncknown place"}`),null)),Q.prototype.getObjectDrawSettings=U}function Te(Q){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,ve.A)(function*(Q){return Ee.e(933).then(Ee.bind(Ee,7933)).then(Ke=>{switch(be(Ke.RPadPainter),Q){case"more":return Promise.all([Ee.e(933),Ee.e(810)]).then(Ee.bind(Ee,9810));case"pave":return Promise.all([Ee.e(933),Ee.e(871)]).then(Ee.bind(Ee,6871));case"rh1":return Promise.all([Ee.e(933),Ee.e(563),Ee.e(50)]).then(Ee.bind(Ee,3050));case"rh2":return Promise.all([Ee.e(933),Ee.e(563),Ee.e(484)]).then(Ee.bind(Ee,9484));case"rh3":return Promise.all([Ee.e(933),Ee.e(563),Ee.e(484),Ee.e(50),Ee.e(608)]).then(Ee.bind(Ee,7608))}return Ke})})).apply(this,arguments)}function dt(){return dt=(0,ve.A)(function*(Q,Ke){return te(Q,Ke._hist,"hist").then(function(){var Ze=(0,ve.A)(function*(Ue){const Oe=[];for(let lt=0;lt<Ke._items.arr.length;++lt)Oe.push(te(Q,Ke._items.arr[lt],Ke._items.opt[lt]));return Promise.all(Oe).then(()=>Ue)});return function(Ue){return Ze.apply(this,arguments)}}())}),dt.apply(this,arguments)}z.internals.addDrawFunc=C,be(Xe.jg),z.internals.addStreamerInfosForPainter=function A(Q){if(!Q)return;const Ke=[z.clTObject,z.clTNamed,z.clTString,"TCollection",z.clTAttLine,z.clTAttFill,z.clTAttMarker,z.clTAttText];function Ze(Ue,Oe){const lt=Ue.fElements?.arr[0];if("BASE"!==lt?.fTypeName||Oe>4||Ke.indexOf(lt.fName)>=0)return null;let gt=L(z.prROOT+lt.fName);if(gt&&!gt.for_derived&&(gt=null),null===gt)for(let ht=0;ht<Q.arr.length;++ht)if(Q.arr[ht].fName===lt.fName){gt=Ze(Q.arr[ht],Oe+1);break}return gt?.for_derived?gt:null}Q.arr.forEach(Ue=>{if(null!==L(z.prROOT+Ue.fName))return;const Oe=Ze(Ue,0);if(Oe){const lt=Object.assign({},Oe);delete lt.for_derived,lt.name=Ue.fName,C(lt)}})}},4491:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{ClonedNodes:()=>j.De,GeoDrawingControl:()=>gt,TGeoPainter:()=>dn,build:()=>ds,createGeoPainter:()=>Hn,drawAxis3D:()=>ys,drawDummy3DGeom:()=>Or,expandGeoObject:()=>Q,produceRenderOrder:()=>j.Pz});var ve=Ee(467),b=Ee(6998),z=Ee(357),ke=Ee(5193),xe=Ee(6714);class et{constructor(W,pe,me,Fe,At="div"){this.parent=W,this.object=pe,this.property=me,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(Fe),this.$name=document.createElement("div"),this.$name.classList.add("name"),et.nextNameID=et.nextNameID||0,this.$name.id="lil-gui-name-"+ ++et.nextNameID,this.$widget=document.createElement(At),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",Et=>Et.stopPropagation()),this.domElement.addEventListener("keyup",Et=>Et.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(me)}name(W){return this._name=W,this.$name.innerHTML=W,this}onChange(W){return this._onChange=W,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(W){return this._onFinishChange=W,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(W=!0){return this.disable(!W)}disable(W=!0){return W===this._disabled||(this._disabled=W,this.domElement.classList.toggle("disabled",W),this.$disable.toggleAttribute("disabled",W)),this}show(W=!0){return this._hidden=!W,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(W){const pe=this.parent.add(this.object,this.property,W);return pe.name(this._name),this.destroy(),pe}min(W){return this}max(W){return this}step(W){return this}decimals(W){return this}listen(W=!0){return this._listening=W,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const W=this.save();W!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=W}getValue(){return this.object[this.property]}setValue(W){return this.object[this.property]=W,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(W){return this.setValue(W),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Je extends et{constructor(W,pe,me){super(W,pe,me,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function Xe(wt){let W,pe;return(W=wt.match(/(#|0x)?([a-f0-9]{6})/i))?pe=W[2]:(W=wt.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?pe=parseInt(W[1]).toString(16).padStart(2,0)+parseInt(W[2]).toString(16).padStart(2,0)+parseInt(W[3]).toString(16).padStart(2,0):(W=wt.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(pe=W[1]+W[1]+W[2]+W[2]+W[3]+W[3]),!!pe&&"#"+pe}const Re={isPrimitive:!0,match:wt=>"number"==typeof wt,fromHexString:wt=>parseInt(wt.substring(1),16),toHexString:wt=>"#"+wt.toString(16).padStart(6,0)},O=[{isPrimitive:!0,match:wt=>"string"==typeof wt,fromHexString:Xe,toHexString:Xe},Re,{isPrimitive:!1,match:wt=>Array.isArray(wt),fromHexString(wt,W,pe=1){const me=Re.fromHexString(wt);W[0]=(me>>16&255)/255*pe,W[1]=(me>>8&255)/255*pe,W[2]=(255&me)/255*pe},toHexString:([wt,W,pe],me=1)=>Re.toHexString(wt*(me=255/me)<<16^W*me<<8^pe*me)},{isPrimitive:!1,match:wt=>Object(wt)===wt,fromHexString(wt,W,pe=1){const me=Re.fromHexString(wt);W.r=(me>>16&255)/255*pe,W.g=(me>>8&255)/255*pe,W.b=(255&me)/255*pe},toHexString:({r:wt,g:W,b:pe},me=1)=>Re.toHexString(wt*(me=255/me)<<16^W*me<<8^pe*me)}];class ie extends et{constructor(W,pe,me,Fe){super(W,pe,me,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function ce(wt){return O.find(W=>W.match(wt))}(this.initialValue),this._rgbScale=Fe,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const At=Xe(this.$text.value);At&&this._setValueFromHexString(At)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(W){if(this._format.isPrimitive){const pe=this._format.fromHexString(W);this.setValue(pe)}else this._format.fromHexString(W,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(W){return this._setValueFromHexString(W),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class he extends et{constructor(W,pe,me){super(W,pe,me,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",Fe=>{Fe.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class ue extends et{constructor(W,pe,me,Fe,At,Et){super(W,pe,me,"number"),this._initInput(),this.min(Fe),this.max(At);const St=void 0!==Et;this.step(St?Et:this._getImplicitStep(),St),this.updateDisplay()}decimals(W){return this._decimals=W,this.updateDisplay(),this}min(W){return this._min=W,this._onUpdateMinMax(),this}max(W){return this._max=W,this._onUpdateMinMax(),this}step(W,pe=!0){return this._step=W,this._stepExplicit=pe,this}updateDisplay(){const W=this.getValue();if(this._hasSlider){let pe=(W-this._min)/(this._max-this._min);pe=Math.max(0,Math.min(pe,1)),this.$fill.style.width=100*pe+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?W:W.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const me=Zt=>{const tr=parseFloat(this.$input.value);isNaN(tr)||(this._snapClampSetValue(tr+Zt),this.$input.value=this.getValue())};let St,xt,En,jt,Cn,Et=!1;const Ci=Zt=>{if(Et){const tr=Zt.clientX-St;Math.abs(Zt.clientY-xt)>5?(Zt.preventDefault(),this.$input.blur(),Et=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(tr)>5&&Rn()}Et||(Cn-=(Zt.clientY-En)*this._step*this._arrowKeyMultiplier(Zt),jt+Cn>this._max?Cn=this._max-jt:jt+Cn<this._min&&(Cn=this._min-jt),this._snapClampSetValue(jt+Cn)),En=Zt.clientY},Rn=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",Ci),window.removeEventListener("mouseup",Rn)};this.$input.addEventListener("input",()=>{let Zt=parseFloat(this.$input.value);isNaN(Zt)||(this._stepExplicit&&(Zt=this._snap(Zt)),this.setValue(this._clamp(Zt)))}),this.$input.addEventListener("keydown",Zt=>{"Enter"===Zt.key&&this.$input.blur(),"ArrowUp"===Zt.code&&(Zt.preventDefault(),me(this._step*this._arrowKeyMultiplier(Zt))),"ArrowDown"===Zt.code&&(Zt.preventDefault(),me(this._step*this._arrowKeyMultiplier(Zt)*-1))}),this.$input.addEventListener("wheel",Zt=>{this._inputFocused&&(Zt.preventDefault(),me(this._step*this._normalizeMouseWheel(Zt)))},{passive:!1}),this.$input.addEventListener("mousedown",Zt=>{St=Zt.clientX,xt=En=Zt.clientY,Et=!0,jt=this.getValue(),Cn=0,window.addEventListener("mousemove",Ci),window.addEventListener("mouseup",Rn)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const pe=Fn=>{const Zt=this.$slider.getBoundingClientRect();let tr=((Fn,Zt,tr,Ne,$)=>(Fn-Zt)/(tr-Zt)*(this._max-Ne)+Ne)(Fn,Zt.left,Zt.right,this._min);this._snapClampSetValue(tr)},Fe=Fn=>{pe(Fn.clientX)},At=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",At)};let St,xt,Et=!1;const En=Fn=>{Fn.preventDefault(),this._setDraggingStyle(!0),pe(Fn.touches[0].clientX),Et=!1},Cn=Fn=>{if(Et){const tr=Fn.touches[0].clientY-xt;Math.abs(Fn.touches[0].clientX-St)>Math.abs(tr)?En(Fn):(window.removeEventListener("touchmove",Cn),window.removeEventListener("touchend",ln))}else Fn.preventDefault(),pe(Fn.touches[0].clientX)},ln=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",Cn),window.removeEventListener("touchend",ln)},Un=this._callOnFinishChange.bind(this);let Rn;this.$slider.addEventListener("mousedown",Fn=>{this._setDraggingStyle(!0),pe(Fn.clientX),window.addEventListener("mousemove",Fe),window.addEventListener("mouseup",At)}),this.$slider.addEventListener("touchstart",Fn=>{Fn.touches.length>1||(this._hasScrollBar?(St=Fn.touches[0].clientX,xt=Fn.touches[0].clientY,Et=!0):En(Fn),window.addEventListener("touchmove",Cn,{passive:!1}),window.addEventListener("touchend",ln))},{passive:!1}),this.$slider.addEventListener("wheel",Fn=>{if(Math.abs(Fn.deltaX)<Math.abs(Fn.deltaY)&&this._hasScrollBar)return;Fn.preventDefault();const tr=this._normalizeMouseWheel(Fn)*this._step;this._snapClampSetValue(this.getValue()+tr),this.$input.value=this.getValue(),clearTimeout(Rn),Rn=setTimeout(Un,400)},{passive:!1})}_setDraggingStyle(W,pe="horizontal"){this.$slider&&this.$slider.classList.toggle("active",W),document.body.classList.toggle("lil-gui-dragging",W),document.body.classList.toggle(`lil-gui-${pe}`,W)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(W){let{deltaX:pe,deltaY:me}=W;return Math.floor(W.deltaY)!==W.deltaY&&W.wheelDelta&&(pe=0,me=-W.wheelDelta/120,me*=this._stepExplicit?1:10),pe+-me}_arrowKeyMultiplier(W){let pe=this._stepExplicit?1:10;return W.shiftKey?pe*=10:W.altKey&&(pe/=10),pe}_snap(W){const pe=Math.round(W/this._step)*this._step;return parseFloat(pe.toPrecision(15))}_clamp(W){return W<this._min&&(W=this._min),W>this._max&&(W=this._max),W}_snapClampSetValue(W){this.setValue(this._clamp(this._snap(W)))}get _hasScrollBar(){const W=this.parent.root.$children;return W.scrollHeight>W.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class fe extends et{constructor(W,pe,me,Fe){super(W,pe,me,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(Fe)?Fe:Object.values(Fe),this._names=Array.isArray(Fe)?Fe:Object.keys(Fe),this._names.forEach(At=>{const Et=document.createElement("option");Et.innerHTML=At,this.$select.appendChild(Et)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const W=this.getValue(),pe=this._values.indexOf(W);return this.$select.selectedIndex=pe,this.$display.innerHTML=-1===pe?W:this._names[pe],this}}class le extends et{constructor(W,pe,me){super(W,pe,me,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",Fe=>{"Enter"===Fe.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let D=!1;class w{constructor({parent:W,autoPlace:pe=void 0===W,container:me,width:Fe,title:At="Controls",closeFolders:Et=!1,injectStyles:St=!0,touchStyles:xt=!0}={}){if(this.parent=W,this.root=W?W.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",En=>{("Enter"===En.code||"Space"===En.code)&&(En.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(At),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),xt&&this.domElement.classList.add("allow-touch-styles"),!D&&St&&(function V(wt){const W=document.createElement("style");W.innerHTML=wt;const pe=document.querySelector("head link[rel=stylesheet], head style");pe?document.head.insertBefore(W,pe):document.head.appendChild(W)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),D=!0),me?me.appendChild(this.domElement):pe&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),Fe&&this.domElement.style.setProperty("--width",Fe+"px"),this._closeFolders=Et}add(W,pe,me,Fe,At){if(Object(me)===me)return new fe(this,W,pe,me);const Et=W[pe];switch(typeof Et){case"number":return new ue(this,W,pe,me,Fe,At);case"boolean":return new Je(this,W,pe);case"string":return new le(this,W,pe);case"function":return new he(this,W,pe)}console.error("gui.add failed\n\tproperty:",pe,"\n\tobject:",W,"\n\tvalue:",Et)}addColor(W,pe,me=1){return new ie(this,W,pe,me)}addFolder(W){const pe=new w({parent:this,title:W});return this.root._closeFolders&&pe.close(),pe}load(W,pe=!0){return W.controllers&&this.controllers.forEach(me=>{me instanceof he||me._name in W.controllers&&me.load(W.controllers[me._name])}),pe&&W.folders&&this.folders.forEach(me=>{me._title in W.folders&&me.load(W.folders[me._title])}),this}save(W=!0){const pe={controllers:{},folders:{}};return this.controllers.forEach(me=>{if(!(me instanceof he)){if(me._name in pe.controllers)throw new Error(`Cannot save GUI with duplicate property "${me._name}"`);pe.controllers[me._name]=me.save()}}),W&&this.folders.forEach(me=>{if(me._title in pe.folders)throw new Error(`Cannot save GUI with duplicate folder "${me._title}"`);pe.folders[me._title]=me.save()}),pe}open(W=!0){return this._setClosed(!W),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(W){this._closed!==W&&(this._closed=W,this._callOnOpenClose(this))}show(W=!0){return this._hidden=!W,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(W=!0){return this._setClosed(!W),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const me=At=>{At.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",me))};this.$children.addEventListener("transitionend",me);const Fe=W?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!W),requestAnimationFrame(()=>{this.$children.style.height=Fe+"px"})}),this}title(W){return this._title=W,this.$title.innerHTML=W,this}reset(W=!0){return(W?this.controllersRecursive():this.controllers).forEach(me=>me.reset()),this}onChange(W){return this._onChange=W,this}_callOnChange(W){this.parent&&this.parent._callOnChange(W),void 0!==this._onChange&&this._onChange.call(this,{object:W.object,property:W.property,value:W.getValue(),controller:W})}onFinishChange(W){return this._onFinishChange=W,this}_callOnFinishChange(W){this.parent&&this.parent._callOnFinishChange(W),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:W.object,property:W.property,value:W.getValue(),controller:W})}onOpenClose(W){return this._onOpenClose=W,this}_callOnOpenClose(W){this.parent&&this.parent._callOnOpenClose(W),void 0!==this._onOpenClose&&this._onOpenClose.call(this,W)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(W=>W.destroy())}controllersRecursive(){let W=Array.from(this.controllers);return this.folders.forEach(pe=>{W=W.concat(pe.controllersRecursive())}),W}foldersRecursive(){let W=Array.from(this.folders);return this.folders.forEach(pe=>{W=W.concat(pe.foldersRecursive())}),W}}var x=Ee(1069),v=Ee(6823),_=Ee(9041),C=Ee(6224),L=Ee(6370),F=Ee(4468),U=Ee(9025),j=Ee(3190);const m="TGeoManager",I="TEveGeoShapeExtract",A="TGeoOverlap",R="TGeoVolumeAssembly",k="TEveTrack",J="TEvePointSet",_e=`${b.nsREX}REveGeoShapeExtract`;let Te=0;function Pe(wt,W,pe){void 0===W&&(W=1),pe||(Te=0,pe="");const me=(0,b.create)(b.clTGeoVolume);if((0,j.bg)(me,j.Wv.kVisThis,!0),(0,j.bg)(me,j.Wv.kVisDaughters,!0),pe&&wt._typename!==j.HO||W<=0)return me.fName=pe,me.fLineColor=Te++%8+2,me.fShape=wt,me;pe&&(pe+="/"),me.$geoh=!0,me.fName="";const Fe=(0,b.create)(b.clTGeoNodeMatrix);(0,j.bg)(Fe,j.Wv.kVisThis,!0),(0,j.bg)(Fe,j.Wv.kVisDaughters,!0),Fe.fName="Left",Fe.fMatrix=wt.fNode.fLeftMat,Fe.fVolume=Pe(wt.fNode.fLeft,W-1,pe+"Left");const At=(0,b.create)(b.clTGeoNodeMatrix);return(0,j.bg)(At,j.Wv.kVisThis,!0),(0,j.bg)(At,j.Wv.kVisDaughters,!0),At.fName="Right",At.fMatrix=wt.fNode.fRightMat,At.fVolume=Pe(wt.fNode.fRight,W-1,pe+"Right"),me.fNodes=(0,b.create)(b.clTList),me.fNodes.Add(Fe),me.fNodes.Add(At),pe||(Te=0),me}function We(wt){const W=wt?.getFramePainter();if(wt?.mode3d&&(0,b.isFunc)(W?.create3DScene)&&W?.renderer){let pe=1,me=1,Fe=1,At=0,Et=0,St=0;return W.scale_xmax>W.scale_xmin&&(pe=2*W.size_x3d/(W.scale_xmax-W.scale_xmin),At=(W.scale_xmax+W.scale_xmin)/2*pe),W.scale_ymax>W.scale_ymin&&(me=2*W.size_y3d/(W.scale_ymax-W.scale_ymin),Et=(W.scale_ymax+W.scale_ymin)/2*me),W.scale_zmax>W.scale_zmin&&(Fe=2*W.size_z3d/(W.scale_zmax-W.scale_zmin),St=(W.scale_zmax+W.scale_zmin)/2*Fe-W.size_z3d),{webgl:W.webgl,scene:W.scene,scene_width:W.scene_width,scene_height:W.scene_height,toplevel:W.toplevel,renderer:W.renderer,camera:W.camera,scale_x:pe,scale_y:me,scale_z:Fe,offset_x:At,offset_y:Et,offset_z:St}}}function dt(wt,W,pe,me){if(!W?.arr?.length)return;const Fe={_name:pe,_kind:b.prROOT+b.clTList,_title:me,_more:!0,_geoobj:W,_parent:wt,_get:At=>Promise.resolve(At._geoobj||null),_expand(At,Et){if(Et.fVolume&&(Et=Et.fVolume.fNodes),!Et.arr)return!1;At._childs=[],(0,j.$T)(null,Et.arr);for(const St in Et.arr)Xi(At,Et.arr[St]);return!0}};wt._childs||(wt._childs=[]),wt._childs.push(Fe)}function Q(wt,W){if(Tn(),!wt||!W)return!1;const pe=0===W._typename.indexOf(b.clTGeoNode),me=0===W._typename.indexOf(b.clTGeoVolume),Fe=W._typename===m,At=W._typename===I||W._typename===_e,Et=W._typename===A;if(!(pe||me||Fe||At||Et))return!1;if(wt._childs)return!0;if(Fe)return dt(wt,W.fMaterials,"Materials","list of materials"),dt(wt,W.fMedia,"Media","list of media"),dt(wt,W.fTracks,"Tracks","list of tracks"),dt(wt,W.fOverlaps,"Overlaps","list of detected overlaps"),Xi(wt,W.fMasterVolume),!0;if(Et)return Xi(wt,W.fVolume1),Xi(wt,W.fVolume2),Xi(wt,W.fMarker,"Marker"),!0;let St,xt,En;if(At?(xt=W.fElements?.arr,En=W.fShape):(St=pe?W.fVolume:W,xt=St?.fNodes?.arr,En=St?.fShape),!xt&&En?._typename===j.HO&&En?.fNode)return wt._childs||(Xi(wt,En.fNode.fLeft,"Left"),Xi(wt,En.fNode.fRight,"Right")),!0;if(!xt)return!1;(0,j.$T)(W,xt);for(let jt=0;jt<xt.length;++jt)Xi(wt,xt[jt]);return!0}function Ke(wt,W){for(;wt;){if(wt._painter?._camera)return W&&(0,b.isFunc)(wt._painter[W])&&wt._painter[W](),wt;wt=wt._parent}return null}function Ze(wt){if(wt._typename===I||wt._typename===_e)return wt.fRnrSelf?" geovis_this":"";const W=!(0,j.zL)(wt,j.Wv.kVisNone)&&(0,j.zL)(wt,j.Wv.kVisThis);let pe=(0,j.zL)(wt,j.Wv.kVisDaughters);return pe&&!wt.fNodes?.arr?.length&&(pe=!1),W&&pe?" geovis_all":W?" geovis_this":pe?" geovis_daughters":""}function Ue(wt,W){!wt||!W||W.forEachItem(pe=>{(wt===pe._volume||wt===pe._geoobj)&&(pe._icon=pe._icon.split(" ")[0]+Ze(wt),W.updateTreeNode(pe))})}function Oe(wt){const W=wt?.object;return W?W.stack?W.stack:W.stacks&&void 0!==wt.instanceId&&wt.instanceId<W.stacks.length?W.stacks[wt.instanceId]:void 0:null}class lt{constructor(W,pe,me){this.bright=pe,this.buttons=me,this.element=W.append("div").attr("style","float: left; box-sizing: border-box; position: relative; bottom: 23px; vertical-align: middle; padding-left: 5px")}createButtons(){const W=[];this.buttons.forEach(pe=>{const me=pe.name;if(!me)throw new Error("must provide button name in button config");if(-1!==W.indexOf(me))throw new Error(`button name ${me} is taken`);W.push(me);const Fe=pe.title||pe.name;if(!(0,b.isFunc)(pe.click))throw new Error("must provide button click() function in button config");xe.IK.createSVG(this.element,xe.IK[pe.icon],16,Fe,this.bright).on("click",pe.click).style("position","relative").style("padding","3px 1px")})}changeBrightness(W){this.bright!==W&&(this.element.selectAll("*").remove(),this.bright=W,this.createButtons())}cleanup(){this.element?.remove(),delete this.element}}class gt extends x.KG{constructor(W,pe){super(),this.mesh=W?.material?W:null,this.bloom=pe}setHighlight(W,pe){return this.drawSpecial(W,pe)}drawSpecial(W,pe){const me=this.mesh;if(me?.material){if(me.isInstancedMesh){if(me._highlight_mesh&&(me.remove(me._highlight_mesh),delete me._highlight_mesh),W&&void 0!==pe){const Fe=new z.eaF(me.geometry,me.material.clone());this.bloom?(Fe.layers.enable(1),Fe.material.emissive=new z.Q1f(65280)):(Fe.material.color=new z.Q1f(W),Fe.material.opacity=1);const At=new z.kn4;me.getMatrixAt(pe,At),Fe.applyMatrix4(At),me.add(Fe),Fe.jsroot_special=!0,me._highlight_mesh=Fe}return!0}if(W)return me.origin||(me.origin={color:me.material.color,emissive:me.material.emissive,opacity:me.material.opacity,width:me.material.linewidth,size:me.material.size}),this.bloom?(me.layers.enable(1),me.material.emissive=new z.Q1f(65280)):(me.material.color=new z.Q1f(W),me.material.opacity=1),me.hightlightWidthScale&&!b.browser.isWin&&(me.material.linewidth=me.origin.width*me.hightlightWidthScale),me.highlightScale&&(me.material.size=me.origin.size*me.highlightScale),!0;if(me.origin)return this.bloom?(me.material.emissive=me.origin.emissive,me.layers.enable(0)):(me.material.color=me.origin.color,me.material.opacity=me.origin.opacity),me.hightlightWidthScale&&(me.material.linewidth=me.origin.width),me.highlightScale&&(me.material.size=me.origin.size),!0}}}class dn extends C.JW{constructor(W,pe){let me;pe?._typename===m&&(me=pe,pe=pe.fMasterVolume),pe?._typename&&0===pe._typename.indexOf(b.clTGeoVolume)&&(pe={_typename:b.clTGeoNode,fVolume:pe,fName:pe.fName,$geoh:pe.$geoh,_proxy:!0}),super(W,pe),We(this.getMainPainter())&&(this.superimpose=!0),me&&(this.geo_manager=me),this.no_default_title=!0,this.mode3d=!0,this.drawing_stage=0,this.drawing_log="Init",this.ctrl={clipIntersect:!0,clipVisualize:!1,clip:[{name:"x",enabled:!1,value:0,min:-100,max:100,step:1},{name:"y",enabled:!1,value:0,min:-100,max:100,step:1},{name:"z",enabled:!1,value:0,min:-100,max:100,step:1}],_highlight:0,highlight:0,highlight_bloom:0,highlight_scene:0,highlight_color:"#00ff00",bloom_strength:1.5,more:1,maxfaces:0,vislevel:void 0,maxnodes:void 0,dflt_colors:!1,info:{num_meshes:0,num_faces:0,num_shapes:0},depthTest:!0,depthMethod:"dflt",select_in_view:!1,update_browser:!0,use_fog:!1,light:{kind:"points",top:!1,bottom:!1,left:!1,right:!1,front:!1,specular:!0,power:1},lightKindItems:[{name:"AmbientLight",value:"ambient"},{name:"DirectionalLight",value:"points"},{name:"HemisphereLight",value:"hemisphere"},{name:"Ambient + Point",value:"mix"}],trans_radial:0,trans_z:0,scale:new z.Pq0(1,1,1),zoom:1,rotatey:0,rotatez:0,depthMethodItems:[{name:"Default",value:"dflt"},{name:"Raytraicing",value:"ray"},{name:"Boundary box",value:"box"},{name:"Mesh size",value:"size"},{name:"Central point",value:"pnt"}],cameraKindItems:[{name:"Perspective",value:"perspective"},{name:"Perspective (Floor XOZ)",value:"perspXOZ"},{name:"Perspective (Floor YOZ)",value:"perspYOZ"},{name:"Perspective (Floor XOY)",value:"perspXOY"},{name:"Orthographic (XOY)",value:"orthoXOY"},{name:"Orthographic (XOZ)",value:"orthoXOZ"},{name:"Orthographic (ZOY)",value:"orthoZOY"},{name:"Orthographic (ZOX)",value:"orthoZOX"},{name:"Orthographic (XnOY)",value:"orthoXNOY"},{name:"Orthographic (XnOZ)",value:"orthoXNOZ"},{name:"Orthographic (ZnOY)",value:"orthoZNOY"},{name:"Orthographic (ZnOX)",value:"orthoZNOX"}],cameraOverlayItems:[{name:"None",value:"none"},{name:"Bar",value:"bar"},{name:"Axis",value:"axis"},{name:"Grid",value:"grid"},{name:"Grid background",value:"gridb"},{name:"Grid foreground",value:"gridf"}],camera_kind:"perspective",camera_overlay:"gridb",rotate:!1,background:b.settings.DarkMode?"#000000":"#ffffff",can_rotate:!0,_axis:0,instancing:0,_count:!1,wireframe:!1,transparency:0,flatShading:!1,roughness:.5,metalness:.5,shininess:0,reflectivity:.5,material_kind:"lambert",materialKinds:[{name:"MeshLambertMaterial",value:"lambert",emissive:!0,props:[{name:"flatShading"}]},{name:"MeshBasicMaterial",value:"basic"},{name:"MeshStandardMaterial",value:"standard",emissive:!0,props:[{name:"flatShading"},{name:"roughness",min:0,max:1,step:.001},{name:"metalness",min:0,max:1,step:.001}]},{name:"MeshPhysicalMaterial",value:"physical",emissive:!0,props:[{name:"flatShading"},{name:"roughness",min:0,max:1,step:.001},{name:"metalness",min:0,max:1,step:.001},{name:"reflectivity",min:0,max:1,step:.001}]},{name:"MeshPhongMaterial",value:"phong",emissive:!0,props:[{name:"flatShading"},{name:"shininess",min:0,max:100,step:.1}]},{name:"MeshNormalMaterial",value:"normal",props:[{name:"flatShading"}]},{name:"MeshDepthMaterial",value:"depth"},{name:"MeshMatcapMaterial",value:"matcap"},{name:"MeshToonMaterial",value:"toon"}],getMaterialCfg:function(){let Fe;return this.materialKinds.forEach(At=>{At.value===this.material_kind&&(Fe=At)}),Fe}},this.cleanup(!0)}changeDarkMode(W){("#000000"===this.ctrl.background||"#ffffff"===this.ctrl.background)&&this.changedBackground(W??b.settings.DarkMode?"#000000":"#ffffff")}changeStage(W,pe){if(this.drawing_stage=W,!pe)switch(W){case 0:pe="Building done";break;case 1:pe="collect visibles";break;case 2:pe="worker collect visibles";break;case 3:pe="Analyse visibles";break;case 4:pe="collect shapes for building";break;case 5:pe="Start build shapes";break;case 6:pe="Worker build shapes";break;case 7:pe="Build shapes";break;case 8:pe="Build ready";break;case 9:pe="Wait for main painter";break;case 10:pe="Build projection";break;default:pe=`stage ${W}`}this.drawing_log=pe}isStage(W){return W===this.drawing_stage}isBatchMode(){return(0,b.isBatchMode)()||this.batch_mode}createToolbar(){if(this._toolbar||!this._webgl||this.ctrl.notoolbar||this.isBatchMode())return;const W=[{name:"toImage",title:"Save as PNG",icon:"camera",click:()=>this.createSnapshot()},{name:"control",title:"Toggle control UI",icon:"rect",click:()=>this.showControlGui("toggle")},{name:"enlarge",title:"Enlarge geometry drawing",icon:"circle",click:()=>this.toggleEnlarge()}];navigator.getVRDisplays&&(W.push({name:"entervr",title:"Enter VR (It requires a VR Headset connected)",icon:"vrgoggles",click:()=>this.toggleVRMode()}),this.initVRMode()),b.settings.ContextMenu&&W.push({name:"menu",title:"Show context menu",icon:"question",click:me=>{me.preventDefault(),me.stopPropagation(),!(0,L.IV)()&&(0,L.ES)(me,this).then(Fe=>{Fe.painter.fillContextMenu(Fe),Fe.show()})}});const pe=new z.Q1f(this.ctrl.background);this._toolbar=new lt(this.selectDom(),pe.r+pe.g+pe.b<1,W),this._toolbar.createButtons()}initVRMode(){this._dolly=new z.YJl,this._scene.add(this._dolly),this._standingMatrix=new z.kn4,this._raycasterEnd=new z.Pq0,this._raycasterOrigin=new z.Pq0,navigator.getVRDisplays().then(W=>{const pe=W[0];pe&&(this._renderer.vr.setDevice(pe),this._vrDisplay=pe,pe.stageParameters&&this._standingMatrix.fromArray(pe.stageParameters.sittingToStandingTransform),this.initVRControllersGeometry())})}initVRControllersGeometry(){const W=new z.Gu$(.025,18,36),pe=new z.V9B({color:"grey",vertexColors:!1}),me=new z.V9B({color:"fuchsia",vertexColors:!1}),Fe=new z.iNn(.001,.001,2),At=new z.eaF(Fe,me),Et=new z.eaF(Fe,me),St=new z.eaF(W,pe),xt=new z.eaF(W,pe);this._controllersMeshes=[],this._controllersMeshes.push(St),this._controllersMeshes.push(xt),At.position.z-=1,Et.position.z-=1,St.add(At),xt.add(Et),this._dolly.add(St),this._dolly.add(xt),St.visible=!1,xt.visible=!1}updateVRControllersList(){const W=navigator.getGamepads&&navigator.getGamepads();if(!this.vrControllers||W.length!==this.vrControllers.length){this._controllersMeshes.forEach(pe=>{pe.visible=!1}),this._vrControllers=[];for(let pe=0;pe<W.length;++pe)!W[pe]||!W[pe].pose||(this._vrControllers.push({gamepad:W[pe],mesh:this._controllersMeshes[pe]}),this._controllersMeshes[pe].visible=!0)}}processVRControllerIntersections(){let W=[];for(let pe=0;pe<this._vrControllers.length;++pe){const me=this._vrControllers[pe].mesh,Fe=me.localToWorld(this._raycasterEnd.set(0,0,-1)),At=me.localToWorld(this._raycasterOrigin.set(0,0,0));Fe.sub(At).normalize(),W=W.concat(this._controls.getOriginDirectionIntersects(At,Fe))}W=W.filter((pe,me)=>W.indexOf(pe)===me),this._controls.processMouseMove(W)}updateVRControllers(){this.updateVRControllersList();for(let W=0;W<this._vrControllers.length;++W){const pe=this._vrControllers[W],me=pe.gamepad.pose.orientation,Fe=pe.gamepad.pose.position,At=pe.mesh;me&&At.quaternion.fromArray(me),Fe&&At.position.fromArray(Fe),At.updateMatrix(),At.applyMatrix4(this._standingMatrix),At.matrixWorldNeedsUpdate=!0}this.processVRControllerIntersections()}toggleVRMode(){if(this._vrDisplay){if(this._vrDisplay.isPresenting)return void this.exitVRMode();this._previousCameraPosition=this._camera.position.clone(),this._previousCameraRotation=this._camera.rotation.clone(),this._vrDisplay.requestPresent([{source:this._renderer.domElement}]).then(()=>{this._previousCameraNear=this._camera.near,this._dolly.position.set(this._camera.position.x/4,-this._camera.position.y/8,-this._camera.position.z/4),this._camera.position.set(0,0,0),this._dolly.add(this._camera),this._camera.near=.1,this._camera.updateProjectionMatrix(),this._renderer.vr.enabled=!0,this._renderer.setAnimationLoop(()=>{this.updateVRControllers(),this.render3D(0)})}),this._renderer.vr.enabled=!0,window.addEventListener("keydown",W=>{"Escape"===W.code&&this.exitVRMode()})}}exitVRMode(){this._vrDisplay.isPresenting&&(this._renderer.vr.enabled=!1,this._dolly.remove(this._camera),this._scene.add(this._camera),this._camera.position.copy(this._previousCameraPosition),this._previousCameraPosition=void 0,this._camera.rotation.copy(this._previousCameraRotation),this._previousCameraRotation=void 0,this._camera.near=this._previousCameraNear,this._camera.updateProjectionMatrix(),this._vrDisplay.exitPresent())}getGeometry(){return this.getObject()}modifyVisisbility(W,pe){if(0!==(0,j.Dh)(this.getGeometry()))return;if(!W)return(0,j.bg)(this.getGeometry().fVolume,j.Wv.kVisThis,"+"===pe);let me,Fe=!1;W.indexOf("*")<0?(me=new RegExp("^"+W+"$"),Fe=!0):(me=new RegExp("^"+W.split("*").join(".*")+"$"),Fe=!1),this.findNodeWithVolume(me,At=>((0,j.N_)(At.node.fVolume,"+"!==pe),Fe?At:null))}decodeOptions(W){(0,b.isStr)(W)||(W=""),this.superimpose&&0===W.indexOf("same")&&(W=W.slice(4));const pe=this.ctrl,me=W.indexOf("macro:");if(me>=0){let Et=W.indexOf(";",me+6);Et<0&&(Et=W.length),pe.script_name=W.slice(me+6,Et),W=W.slice(0,me)+W.slice(Et+1),console.log(`script ${pe.script_name} rest ${W}`)}for(;;){const Et=W.indexOf("+"),St=W.indexOf("-");if(Et<0&&St<0)break;let xt=Et,En="+";(xt<0||St>=0&&St<Et)&&(xt=St,En="-");let jt=xt+1;const Cn=/[,; .]/;for(;jt<W.length&&!Cn.test(W[jt])&&"+"!==W[jt]&&"-"!==W[jt];)jt++;const ln=W.substring(xt+1,jt);W=W.slice(0,xt)+W.slice(jt),this.modifyVisisbility(ln,En)}const Fe=new _.nC(W);Fe.check("MAIN")&&(pe.is_main=!0),Fe.check("TRACKS")&&(pe.tracks=!0),Fe.check("SHOWTOP")&&(pe.showtop=!0),Fe.check("NO_SCREEN")&&(pe.no_screen=!0),Fe.check("NOINSTANCING")&&(pe.instancing=-1),Fe.check("INSTANCING")&&(pe.instancing=1),Fe.check("ORTHO_CAMERA")&&(pe.camera_kind="orthoXOY",pe.can_rotate=0),Fe.check("ORTHO",!0)&&(pe.camera_kind="ortho"+Fe.part,pe.can_rotate=0),Fe.check("OVERLAY",!0)&&(pe.camera_overlay=Fe.part.toLowerCase()),Fe.check("CAN_ROTATE")&&(pe.can_rotate=!0),Fe.check("PERSPECTIVE")&&(pe.camera_kind="perspective",pe.can_rotate=!0),Fe.check("PERSP",!0)&&(pe.camera_kind="persp"+Fe.part,pe.can_rotate=!0),Fe.check("MOUSE_CLICK")&&(pe.mouse_click=!0),(Fe.check("DEPTHRAY")||Fe.check("DRAY"))&&(pe.depthMethod="ray"),(Fe.check("DEPTHBOX")||Fe.check("DBOX"))&&(pe.depthMethod="box"),(Fe.check("DEPTHPNT")||Fe.check("DPNT"))&&(pe.depthMethod="pnt"),(Fe.check("DEPTHSIZE")||Fe.check("DSIZE"))&&(pe.depthMethod="size"),(Fe.check("DEPTHDFLT")||Fe.check("DDFLT"))&&(pe.depthMethod="dflt"),Fe.check("ZOOM",!0)&&(pe.zoom=Fe.partAsFloat(0,100)/100),Fe.check("ROTY",!0)&&(pe.rotatey=Fe.partAsFloat()),Fe.check("ROTZ",!0)&&(pe.rotatez=Fe.partAsFloat()),Fe.check("PHONG")&&(pe.material_kind="phong"),Fe.check("LAMBERT")&&(pe.material_kind="lambert"),Fe.check("MATCAP")&&(pe.material_kind="matcap"),Fe.check("TOON")&&(pe.material_kind="toon"),Fe.check("AMBIENT")&&(pe.light.kind="ambient");const At=()=>{let Et=1;return"N"===Fe.part[0]&&(Et=-1,Fe.part=Fe.part.slice(1)),Et*Fe.partAsFloat()};if(Fe.check("CAMX",!0)&&(pe.camx=At()),Fe.check("CAMY",!0)&&(pe.camy=At()),Fe.check("CAMZ",!0)&&(pe.camz=At()),Fe.check("CAMLX",!0)&&(pe.camlx=At()),Fe.check("CAMLY",!0)&&(pe.camly=At()),Fe.check("CAMLZ",!0)&&(pe.camlz=At()),Fe.check("BLACK")&&(pe.background="#000000"),Fe.check("WHITE")&&(pe.background="#FFFFFF"),Fe.check("BKGR_",!0)){let Et=null;if(Fe.partAsInt(1)>0)Et=(0,v.oU)(Fe.partAsInt());else for(let St=0;St<8;++St)(0,v.oU)(St).toUpperCase()===Fe.part&&(Et=(0,v.oU)(St));Et&&(pe.background="#"+new z.Q1f(Et).getHexString())}Fe.check("R3D_",!0)&&(pe.Render3D=b.constants.Render3D.fromString(Fe.part.toLowerCase())),Fe.check("MORE",!0)&&(pe.more=Fe.partAsInt(0,2)??2),Fe.check("ALL")&&(pe.more=100,pe.vislevel=99),Fe.check("VISLVL",!0)&&(pe.vislevel=Fe.partAsInt()),Fe.check("MAXNODES",!0)&&(pe.maxnodes=Fe.partAsInt()),Fe.check("MAXFACES",!0)&&(pe.maxfaces=Fe.partAsInt()),(Fe.check("CONTROLS")||Fe.check("CTRL"))&&(pe.show_controls=!0),Fe.check("CLIPXYZ")&&(pe.clip[0].enabled=pe.clip[1].enabled=pe.clip[2].enabled=!0),Fe.check("CLIPX")&&(pe.clip[0].enabled=!0),Fe.check("CLIPY")&&(pe.clip[1].enabled=!0),Fe.check("CLIPZ")&&(pe.clip[2].enabled=!0),Fe.check("CLIP")&&(pe.clip[0].enabled=pe.clip[1].enabled=pe.clip[2].enabled=!0),Fe.check("PROJX",!0)&&(pe.project="x",Fe.partAsInt(1)>0&&(pe.projectPos=Fe.partAsInt()),pe.can_rotate=0),Fe.check("PROJY",!0)&&(pe.project="y",Fe.partAsInt(1)>0&&(pe.projectPos=Fe.partAsInt()),pe.can_rotate=0),Fe.check("PROJZ",!0)&&(pe.project="z",Fe.partAsInt(1)>0&&(pe.projectPos=Fe.partAsInt()),pe.can_rotate=0),(Fe.check("DFLT_COLORS")||Fe.check("DFLT"))&&(pe.dflt_colors=!0),Fe.check("SSAO"),Fe.check("NOBLOOM")&&(pe.highlight_bloom=!1),Fe.check("BLOOM")&&(pe.highlight_bloom=!0),Fe.check("OUTLINE")&&(pe.outline=!0),Fe.check("NOWORKER")&&(pe.use_worker=-1),Fe.check("WORKER")&&(pe.use_worker=1),Fe.check("NOFOG")&&(pe.use_fog=!1),Fe.check("FOG")&&(pe.use_fog=!0),(Fe.check("NOHIGHLIGHT")||Fe.check("NOHIGH"))&&(pe.highlight_scene=pe.highlight=!1),Fe.check("HIGHLIGHT")&&(pe.highlight_scene=pe.highlight=!0),Fe.check("HSCENEONLY")&&(pe.highlight_scene=!0,pe.highlight=!1),Fe.check("NOHSCENE")&&(pe.highlight_scene=!1),Fe.check("HSCENE")&&(pe.highlight_scene=!0),(Fe.check("WIREFRAME")||Fe.check("WIRE"))&&(pe.wireframe=!0),Fe.check("ROTATE")&&(pe.rotate=!0),(Fe.check("INVX")||Fe.check("INVERTX"))&&(pe.scale.x=-1),(Fe.check("INVY")||Fe.check("INVERTY"))&&(pe.scale.y=-1),(Fe.check("INVZ")||Fe.check("INVERTZ"))&&(pe.scale.z=-1),Fe.check("COUNT")&&(pe._count=!0),Fe.check("TRANSP",!0)&&(pe.transparency=Fe.partAsInt(0,100)/100),Fe.check("OPACITY",!0)&&(pe.transparency=1-Fe.partAsInt(0,100)/100),(Fe.check("AXISCENTER")||Fe.check("AXISC")||Fe.check("AC"))&&(pe._axis=2),(Fe.check("AXIS")||Fe.check("A"))&&(pe._axis=1),Fe.check("TRR",!0)&&(pe.trans_radial=Fe.partAsInt()/100),Fe.check("TRZ",!0)&&(pe.trans_z=Fe.partAsInt()/100),Fe.check("W")&&(pe.wireframe=!0),Fe.check("Y")&&(pe._yup=!0),Fe.check("Z")&&(pe._yup=!1),void 0===pe._yup&&(pe._yup=this.getCanvSvg().empty()),this.options=pe}activateInBrowser(W,pe){(0,b.isStr)(W)&&(W=[W]),this._hpainter&&(this._hpainter.activateItems(W,pe),this.ctrl.update_browser||setTimeout(()=>this._hpainter.activateItems([]),2e3))}testMatrixes(){let W=0,pe=0,me=0;const Fe={domatrix:!0,func:()=>{let St=this.getmatrix();const xt=this.copyStack(),En=this._clones.createObject3D(xt.stack,this._toplevel,"mesh");if(!En)return!0;pe++;const jt=En.matrixWorld;if(jt.equals(St))return!0;if(jt.determinant()>0&&St.determinant()<-.9){const ln=new z.Pq0(1,1,-1);if(St=St.clone().scale(ln),jt.equals(St))return!0}let Cn=0;for(let ln=0;ln<16;++ln)Cn=Math.max(Cn,Math.abs(jt.elements[ln]-St.elements[ln]));return me=Math.max(Cn,me),Cn<1e-4||(console.log(`${this._clones.resolveStack(xt.stack).name} maxdiff ${Cn} determ ${jt.determinant()} ${St.determinant()}`),W++,!1)}},At=(new Date).getTime();this._clones.scanVisible(Fe);const Et=(new Date).getTime();console.log(`Compare matrixes total ${pe} errors ${W} takes ${Et-At} maxdiff ${me}`)}fillContextMenu(W){W.add("header: Draw options"),W.addchk(this.ctrl.update_browser,"Browser update",()=>{this.ctrl.update_browser=!this.ctrl.update_browser,this.ctrl.update_browser||this.activateInBrowser([])}),W.addchk(this.ctrl.show_controls,"Show Controls",()=>this.showControlGui("toggle")),W.add("sub:Show axes",()=>this.setAxesDraw("toggle")),W.addchk(0===this.ctrl._axis,"off",0,pe=>this.setAxesDraw(parseInt(pe))),W.addchk(1===this.ctrl._axis,"side",1,pe=>this.setAxesDraw(parseInt(pe))),W.addchk(2===this.ctrl._axis,"center",2,pe=>this.setAxesDraw(parseInt(pe))),W.add("endsub:"),this.geo_manager&&W.addchk(this.ctrl.showtop,"Show top volume",()=>this.setShowTop(!this.ctrl.showtop)),W.addchk(this.ctrl.wireframe,"Wire frame",()=>this.toggleWireFrame()),this.getCanvPainter()||W.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),W.add("sub:Highlight"),W.addchk(!this.ctrl.highlight,"Off",()=>{this.ctrl.highlight=!1,this.changedHighlight()}),W.addchk(this.ctrl.highlight&&!this.ctrl.highlight_bloom,"Normal",()=>{this.ctrl.highlight=!0,this.ctrl.highlight_bloom=!1,this.changedHighlight()}),W.addchk(this.ctrl.highlight&&this.ctrl.highlight_bloom,"Bloom",()=>{this.ctrl.highlight=!0,this.ctrl.highlight_bloom=!0,this.changedHighlight()}),W.add("separator"),W.addchk(this.ctrl.highlight_scene,"Scene",pe=>{this.ctrl.highlight_scene=pe,this.changedHighlight()}),W.add("endsub:"),W.add("sub:Camera"),W.add("Reset position",()=>this.focusCamera()),this.ctrl.project||W.addchk(this.ctrl.rotate,"Autorotate",()=>this.setAutoRotate(!this.ctrl.rotate)),this._geom_viewer||(W.addchk(this.canRotateCamera(),"Can rotate",()=>this.changeCanRotate(!this.ctrl.can_rotate)),W.add("Get position",()=>W.info("Position (as url)","&opt="+this.produceCameraUrl())),this.isOrthoCamera()||W.add("Absolute position",()=>{const pe=this.produceCameraUrl(!0),me=pe.indexOf("camlx");W.info("Position (as url)","&opt="+(me<0?pe:pe.slice(0,me)+"\n"+pe.slice(me)))}),W.add("sub:Kind"),this.ctrl.cameraKindItems.forEach(pe=>W.addchk(this.ctrl.camera_kind===pe.value,pe.name,pe.value,me=>{this.ctrl.camera_kind=me,this.changeCamera()})),W.add("endsub:"),this.isOrthoCamera()&&(W.add("sub:Overlay"),this.ctrl.cameraOverlayItems.forEach(pe=>W.addchk(this.ctrl.camera_overlay===pe.value,pe.name,pe.value,me=>{this.ctrl.camera_overlay=me,this.changeCamera()})),W.add("endsub:"))),W.add("endsub:"),W.addchk(this.ctrl.select_in_view,"Select in view",()=>{this.ctrl.select_in_view=!this.ctrl.select_in_view,this.ctrl.select_in_view&&this.startDrawGeometry()})}changedGlobalTransparency(W){const pe=(0,b.isFunc)(W)?W:null;(pe||void 0===W)&&(W=this.ctrl.transparency),this._toplevel?.traverse(me=>{if(void 0===me?.material?.inherentOpacity)return;const Fe=pe?pe(me):void 0;me.material.opacity=void 0!==Fe?1-Fe:Math.min(1-(W||0),me.material.inherentOpacity),me.material.depthWrite=1===me.material.opacity,me.material.transparent=me.material.opacity<1}),this.render3D()}changedMaterial(){this._toplevel?.traverse(W=>{void 0!==W.material?.inherentArgs&&(W.material=(0,j.Cc)(this.ctrl,W.material.inherentArgs))}),this.render3D(-1)}changeMaterialProperty(W){const pe=this.ctrl[W];if(void 0===pe)return console.error("No property ",W);this._toplevel?.traverse(me=>{void 0!==me.material?.inherentArgs&&void 0!==me.material[W]&&(me.material[W]=pe,me.material.needsUpdate=!0)}),this.render3D()}resetTransformation(){this.changedTransformation("reset")}changedTransformation(W){if(!this._toplevel)return;const pe=this.ctrl,me=new z.kn4,Fe=new z.Pq0;"reset"===W&&(pe.trans_z=pe.trans_radial=0),this._toplevel.traverse(At=>{if(void 0!==At.stack){const Et=At.parent;if("reset"===W)return Et.matrix0&&(Et.matrix.copy(Et.matrix0),Et.matrix.decompose(Et.position,Et.quaternion,Et.scale),Et.matrixWorldNeedsUpdate=!0),delete Et.matrix0,delete Et.vect0,delete Et.vect1,void delete Et.minvert;if(void 0===Et.vect0){Et.matrix0=Et.matrix.clone(),Et.minvert=(new z.kn4).copy(Et.matrixWorld).invert();const St=(0,j.UX)(At,null,!0);Et.vect0=new z.Pq0((St.max.x+St.min.x)/2,(St.max.y+St.min.y)/2,(At._flippedMesh?-1:1)*(St.max.z+St.min.z)/2).applyMatrix4(Et.matrixWorld),Et.vect1=new z.Pq0(0,0,0).applyMatrix4(Et.minvert)}Fe.set(pe.trans_radial*Et.vect0.x,pe.trans_radial*Et.vect0.y,pe.trans_z*Et.vect0.z).applyMatrix4(Et.minvert).sub(Et.vect1),Et.matrix.multiplyMatrices(Et.matrix0,me.makeTranslation(Fe.x,Fe.y,Fe.z)),Et.matrix.decompose(Et.position,Et.quaternion,Et.scale),Et.matrixWorldNeedsUpdate=!0}else if(void 0!==At.stacks){if(At.instanceMatrix.needsUpdate=!0,"reset"===W)return At.trans?.forEach((St,xt)=>{At.setMatrixAt(xt,St.matrix0)}),void delete At.trans;if(void 0===At.trans){At.trans=new Array(At.count),At.geometry.computeBoundingBox();for(let St=0;St<At.count;St++){const xt={matrix0:new z.kn4,minvert:new z.kn4};At.trans[St]=xt,At.getMatrixAt(St,xt.matrix0),xt.minvert.copy(xt.matrix0).invert();const En=(new z.NRn).copy(At.geometry.boundingBox).applyMatrix4(xt.matrix0);xt.vect0=new z.Pq0((En.max.x+En.min.x)/2,(En.max.y+En.min.y)/2,(En.max.z+En.min.z)/2),xt.vect1=new z.Pq0(0,0,0).applyMatrix4(xt.minvert)}}const Et=new z.kn4;At.trans?.forEach((St,xt)=>{Fe.set(pe.trans_radial*St.vect0.x,pe.trans_radial*St.vect0.y,pe.trans_z*St.vect0.z).applyMatrix4(St.minvert).sub(St.vect1),Et.multiplyMatrices(St.matrix0,me.makeTranslation(Fe.x,Fe.y,Fe.z)),At.setMatrixAt(xt,Et)})}}),this._toplevel.updateMatrixWorld(),"norender"!==W&&this.drawAxesAndOverlay()}changedAutoRotate(){this.autorotate(2.5)}changedAxes(){(0,b.isStr)(this.ctrl._axis)&&(this.ctrl._axis=parseInt(this.ctrl._axis)),this.drawAxesAndOverlay()}changedBackground(W){if(void 0!==W&&(this.ctrl.background=W),this._scene.background=new z.Q1f(this.ctrl.background),this._renderer.setClearColor(this._scene.background,1),this.render3D(0),this._toolbar){const pe=new z.Q1f(this.ctrl.background);this._toolbar.changeBrightness(pe.r+pe.g+pe.b<1)}}showControlGui(W){if(!this.ctrl)return;if("toggle"===W?W=!this._gui:void 0===W&&(W=this.ctrl.show_controls),this.ctrl.show_controls=W,this._gui)return void(W||(this._gui.destroy(),delete this._gui));if(!W||!this._renderer)return;const pe=this.selectDom();"static"===pe.style("position")&&pe.style("position","relative"),this._gui=new w({container:pe.node(),closeFolders:!0,width:Math.min(300,this._scene_width/2),title:"Settings"});const me=this._gui.domElement;me.style.position="absolute",me.style.top=0,me.style.right=0,this._gui.painter=this;const Fe=Rn=>{const si={};return Rn.forEach(Fn=>{si[Fn.name]=Fn.value}),si};if(!this.ctrl.project){const Rn=this._gui.addFolder("Selection");this.ctrl.maxnodes||(this.ctrl.maxnodes=this._clones?.getMaxVisNodes()??1e4),this.ctrl.vislevel||(this.ctrl.vislevel=this._clones?.getVisLevel()??3),this.ctrl.maxfaces||(this.ctrl.maxfaces=2e5*this.ctrl.more),this.ctrl.more=1,Rn.add(this.ctrl,"vislevel",1,99,1).name("Visibility level").listen().onChange(()=>this.startRedraw(500)),Rn.add(this.ctrl,"maxnodes",0,5e5,1e3).name("Visible nodes").listen().onChange(()=>this.startRedraw(500)),Rn.add(this.ctrl,"maxfaces",0,5e6,1e5).name("Max faces").listen().onChange(()=>this.startRedraw(500))}if(this.ctrl.project){const Rn=this.getGeomBoundingBox(this.getProjectionSource(),.01),si=this.ctrl.project;void 0===this.ctrl.projectPos&&(this.ctrl.projectPos=(Rn.min[si]+Rn.max[si])/2),this._gui.add(this.ctrl,"projectPos",Rn.min[si],Rn.max[si]).name(si.toUpperCase()+" projection").onChange(()=>this.startDrawGeometry())}else{const Rn=this._gui.addFolder("Clipping");for(let si=0;si<3;++si){const Fn=this.ctrl.clip[si],Zt=Fn.name.toUpperCase();Rn.add(Fn,"enabled").name("Enable "+Zt).listen().onChange(()=>this.changedClipping(-1)),Rn.add(Fn,"value",Fn.min,Fn.max,Fn.step).name(Zt+" position").listen().onChange(()=>this.changedClipping(si))}Rn.add(this.ctrl,"clipIntersect").name("Clip intersection").onChange(()=>this.changedClipping(-1)),Rn.add(this.ctrl,"clipVisualize").name("Visualize").onChange(()=>this.changedClipping(-1))}const At=this._gui.addFolder("Scene");At.add(this.ctrl.light,"kind",Fe(this.ctrl.lightKindItems)).name("Light").listen().onChange(()=>{Et.show("mix"===this.ctrl.light.kind||"points"===this.ctrl.light.kind),this.changedLight()}),this.ctrl.light._pnts=this.ctrl.light.specular?0:this.ctrl.light.front?1:2;const Et=At.add(this.ctrl.light,"_pnts",{specular:0,front:1,box:2}).name("Positions").show("mix"===this.ctrl.light.kind||"points"===this.ctrl.light.kind).onChange(Rn=>{this.ctrl.light.specular=0===Rn,this.ctrl.light.front=1===Rn,this.ctrl.light.top=this.ctrl.light.bottom=this.ctrl.light.left=this.ctrl.light.right=2===Rn,this.changedLight()});At.add(this.ctrl.light,"power",0,10,.01).name("Power").listen().onChange(()=>this.changedLight()),At.add(this.ctrl,"use_fog").name("Fog").listen().onChange(()=>this.changedUseFog());const St=this._gui.addFolder("Appearance");this.ctrl._highlight=this.ctrl.highlight?this.ctrl.highlight_bloom?2:1:0,St.add(this.ctrl,"_highlight",{none:0,normal:1,bloom:2}).name("Highlight Selection").listen().onChange(()=>{this.changedHighlight(this.ctrl._highlight),En.show(2===this.ctrl._highlight),xt.show(1===this.ctrl._highlight)});const xt=St.addColor(this.ctrl,"highlight_color").name("Hightlight color").show(1===this.ctrl._highlight),En=St.add(this.ctrl,"bloom_strength",0,3).name("Bloom strength").listen().onChange(()=>this.changedHighlight()).show(2===this.ctrl._highlight);St.addColor(this.ctrl,"background").name("Background").onChange(Rn=>this.changedBackground(Rn)),St.add(this.ctrl,"_axis",{none:0,side:1,center:2}).name("Axes").onChange(()=>this.changedAxes()),this.ctrl.project||St.add(this.ctrl,"rotate").name("Autorotate").listen().onChange(()=>this.changedAutoRotate());const jt=this._gui.addFolder("Material");let Cn=[];const ln=()=>{Cn.forEach(si=>si.destroy()),Cn=[];const Rn=this.ctrl.getMaterialCfg()?.props;Rn&&Rn.forEach(si=>{const Fn=jt.add(this.ctrl,si.name,si.min,si.max,si.step).onChange(()=>{this.changeMaterialProperty(si.name)});Cn.push(Fn)})};jt.add(this.ctrl,"material_kind",Fe(this.ctrl.materialKinds)).name("Kind").listen().onChange(()=>{ln(),this.ensureBloom(!1),this.changedMaterial(),this.changedHighlight()}),jt.add(this.ctrl,"transparency",0,1,.001).name("Transparency").listen().onChange(Rn=>this.changedGlobalTransparency(Rn)),jt.add(this.ctrl,"wireframe").name("Wireframe").listen().onChange(()=>this.changedWireFrame()),jt.add(this,"showMaterialDocu").name("Docu from threejs.org"),ln();const Un=this._gui.addFolder("Camera");Un.add(this.ctrl,"camera_kind",Fe(this.ctrl.cameraKindItems)).name("Kind").listen().onChange(()=>{Ci.show(0===this.ctrl.camera_kind.indexOf("ortho")),this.changeCamera()}),Un.add(this.ctrl,"can_rotate").name("Can rotate").listen().onChange(()=>this.changeCanRotate()),Un.add(this,"focusCamera").name("Reset position");const Ci=Un.add(this.ctrl,"camera_overlay",Fe(this.ctrl.cameraOverlayItems)).name("Overlay").listen().onChange(()=>this.changeCamera()).show(0===this.ctrl.camera_kind.indexOf("ortho"));if(this._webgl){const Rn=this._gui.addFolder("Advanced");Rn.add(this.ctrl,"depthTest").name("Depth test").listen().onChange(()=>this.changedDepthTest()),Rn.add(this.ctrl,"depthMethod",Fe(this.ctrl.depthMethodItems)).name("Rendering order").onChange(si=>this.changedDepthMethod(si)),Rn.add(this,"resetAdvanced").name("Reset")}if(!this.ctrl.project){const Rn=this._gui.addFolder("Transform");Rn.add(this.ctrl,"trans_z",0,3,.01).name("Z axis").listen().onChange(()=>this.changedTransformation()),Rn.add(this.ctrl,"trans_radial",0,3,.01).name("Radial").listen().onChange(()=>this.changedTransformation()),Rn.add(this,"resetTransformation").name("Reset"),(this.ctrl.trans_z||this.ctrl.trans_radial)&&Rn.open()}}showMaterialDocu(){const W=this.ctrl.getMaterialCfg();W?.name&&typeof window<"u"&&window.open("https://threejs.org/docs/index.html#api/en/materials/"+W.name,"_blank")}changedHighlight(W){void 0!==W&&(this.ctrl.highlight=0!==W,this.ctrl.highlight&&(this.ctrl.highlight_bloom=2===W)),this.ensureBloom(),this.ctrl.highlight||this.highlightMesh(null),this._slave_painters?.forEach(pe=>{pe.ctrl.highlight=this.ctrl.highlight,pe.ctrl.highlight_bloom=this.ctrl.highlight_bloom,pe.ctrl.bloom_strength=this.ctrl.bloom_strength,pe.changedHighlight()})}changeCanRotate(W){void 0!==W&&(this.ctrl.can_rotate=W),this._controls&&(this._controls.enableRotate=this.ctrl.can_rotate)}changedUseFog(){this._scene.fog=this.ctrl.use_fog?this._fog:null,this.render3D()}changeCamera(){this._controls&&(this._controls.cleanup(),delete this._controls),this.ensureBloom(!1),this.createCamera(),this.createSpecialEffects(),this.adjustCameraPosition(!0),this.addOrbitControls(),this.render3D()}ensureBloom(W){if(void 0===W&&(0===this.ctrl.highlight_bloom&&(this.ctrl.highlight_bloom=this._webgl),W=this.ctrl.highlight_bloom&&this.ctrl.getMaterialCfg()?.emissive),W&&!this._bloomComposer){this._camera.layers.enable(1),this._bloomComposer=new ke.s0(this._renderer),this._bloomComposer.addPass(new ke.AH(this._scene,this._camera));const pe=new ke.Cg(new z.I9Y(this._scene_width,this._scene_height),1.5,.4,.85);pe.threshold=0,pe.radius=0,pe.renderToScreen=!0,this._bloomComposer.addPass(pe),this._renderer.autoClear=!1}else!W&&this._bloomComposer&&(this._bloomComposer.dispose(),delete this._bloomComposer,this._renderer&&(this._renderer.autoClear=!0),this._camera?.layers.disable(1),this._camera?.layers.set(0));this._bloomComposer?.passes&&(this._bloomComposer.passes[1].strength=this.ctrl.bloom_strength)}orbitContext(W,pe){(0,L.ES)(W,this).then(me=>{let Fe=0,At=0,Et=0;if(pe)for(let St=0;St<pe.length;++St)Oe(pe[St])&&At++,pe[St].geo_name&&Fe++;if(At+Fe===0)this.fillContextMenu(me);else{const St=At+Fe>1;St&&me.add("header:"+(Fe>0?"Items":"Nodes"));for(let xt=0;xt<pe.length;++xt){const En=pe[xt].object,jt=Oe(pe[xt]);let Cn,ln,Un;if(En.geo_name)ln=En.geo_name,0===ln.indexOf("<prnt>")&&(ln=(this.getItemName()||"top")+ln.slice(6)),Cn=ln.slice(ln.lastIndexOf("/")+1),Cn||(Cn=ln),Un=Cn;else{if(!jt)continue;Cn=this._clones.getStackName(jt),ln=this.getStackFullName(jt),Un=this.getItemName(),0===Cn.indexOf("Nodes/")?Un=Cn.slice(6):Cn?Un=Cn:Un||(Un="header")}if(Et++,me.add((St?"sub:":"header:")+Un,ln,Rn=>this.activateInBrowser([Rn],!0)),me.add("Browse",ln,Rn=>this.activateInBrowser([Rn],!0)),this._hpainter&&me.add("Inspect",ln,Rn=>this._hpainter.display(Rn,b.kInspect)),(0,b.isFunc)(this.hidePhysicalNode))me.add("Hide",ln,Rn=>this.hidePhysicalNode([Rn])),Et>1&&me.add("Hide all before",xt,Rn=>{const si=[];for(let Fn=0;Fn<Rn;++Fn){const Zt=Oe(pe[Fn]);Zt&&si.push(this.getStackFullName(Zt))}this.hidePhysicalNode(si)});else if(En.geo_name){me.add("Hide",xt,Rn=>{const si=pe[Rn].object;si.visible=!1,si.geo_object&&(si.geo_object.$hidden_via_menu=!0),me.painter.render3D()},"Hide this physical node"),St&&me.add("endsub:");continue}const Ci=this.accessObjectWireFrame(En);void 0!==Ci&&me.addchk(Ci,"Wireframe",xt,Rn=>{const si=pe[Rn].object.material;si.wireframe=!si.wireframe,this.render3D()},"Toggle wireframe mode for the node"),Et>1&&me.add("Manifest",xt,Rn=>{this._last_manifest&&(this._last_manifest.wireframe=!this._last_manifest.wireframe),this._last_hidden&&this._last_hidden.forEach(si=>{si.visible=!0}),this._last_hidden=[];for(let si=0;si<Rn;++si)this._last_hidden.push(pe[si].object);this._last_hidden.forEach(si=>{si.visible=!1}),this._last_manifest=pe[Rn].object.material,this._last_manifest.wireframe=!this._last_manifest.wireframe,this.render3D()},"Manifest selected node"),me.add("Focus",xt,Rn=>{this.focusCamera(pe[Rn].object)}),this._geom_viewer||(me.add("Hide",xt,Rn=>{const si=this._clones.resolveStack(pe[Rn].object.stack);si.obj&&si.node.kind===j.k$&&si.obj.fVolume?((0,j.bg)(si.obj.fVolume,j.Wv.kVisThis,!1),Ue(si.obj.fVolume,this._hpainter)):si.obj&&si.node.kind===j.NN&&(si.obj.fRnrSelf=!1,Ue(si.obj,this._hpainter)),this.testGeomChanges()},"Hide all logical nodes of that kind"),me.add("Hide only this",xt,Rn=>{this._clones.setPhysNodeVisibility(Oe(pe[Rn]),!1),this.testGeomChanges()},"Hide only this physical node"),xt>1&&me.add("Hide all before",xt,Rn=>{for(let si=0;si<Rn;++si)this._clones.setPhysNodeVisibility(Oe(pe[si]),!1);this.testGeomChanges()},"Hide all physical nodes before that")),St&&me.add("endsub:")}}me.show()})}filterIntersects(W){if(!W?.length)return W;for(let me=0;me<W.length;++me)W[me].object.geo_highlight&&(W[me].object=W[me].object.geo_highlight);for(let me=W.length-1;me>=0;--me){const Fe=W[me].object;let At=Fe.visible&&(Oe(W[me])||void 0!==Fe.geo_name);At&&Fe.material&&void 0!==Fe.material.opacity&&(At=Fe.material.opacity>=.1),Fe.jsroot_special&&(At=!1);for(let Et=0;Et<me&&At;++Et)W[Et].object===Fe&&(At=!1);At||W.splice(me,1)}const pe=this.ctrl.clip;if(pe[0].enabled||pe[1].enabled||pe[2].enabled){const me=[];for(let Fe=0;Fe<W.length;++Fe){const At=W[Fe].point,Et="Points"===W[Fe].object.type;let St=!0;pe[0].enabled&&this._clipPlanes[0].normal.dot(At)>this._clipPlanes[0].constant^Et&&(St=!1),pe[1].enabled&&this._clipPlanes[1].normal.dot(At)>this._clipPlanes[1].constant^Et&&(St=!1),pe[2].enabled&&this._clipPlanes[2].normal.dot(At)>this._clipPlanes[2].constant&&(St=!1),St||me.push(W[Fe])}W=me}return W}testCameraPositionChange(){if(!this.ctrl.select_in_view||this._draw_all_nodes)return;const W=(0,j.d4)(this._camera);(0,j.P1)(W).CheckBox(this.getGeomBoundingBox())||this.startDrawGeometry()}resolveStack(W){return this._clones&&W?this._clones.resolveStack(W):null}getStackFullName(W){const pe=this.getItemName(),me=this.resolveStack(W);return me&&me.name?pe?pe+"/"+me.name:me.name:pe}addHighlightHandler(W){(0,b.isFunc)(W?.highlightMesh)&&(this._highlight_handlers||(this._highlight_handlers=[]),this._highlight_handlers.push(W))}highlightMesh(W,pe,me,Fe,At,Et){if(me){W=W?[W]:[];const jt=this.getExtrasContainer();jt&&jt.traverse(Cn=>{Cn.geo_object===me&&W.indexOf(Cn)<0&&W.push(Cn)})}else At&&this._toplevel?(W=[],this._toplevel.traverse(jt=>{jt instanceof z.eaF&&(0,j.xq)(jt.stack,At)&&W.push(jt)})):W=W?[W]:[];if(W.length||(W=null),W&&(W[0].geo_object?this.ctrl.highlight_scene||(W=null):this.ctrl.highlight||(W=null)),!Et){W&&(me||(me=W[0].geo_object),At||(At=W[0].stack));const jt=this._highlight_handlers||(this._main_painter?this._main_painter._slave_painters.concat([this._main_painter]):this._slave_painters);for(let Cn=0;Cn<jt?.length;++Cn)jt[Cn]!==this&&jt[Cn].highlightMesh(null,pe,me,Fe,At,!0)}const St=this._selected_mesh;if(!St&&!W)return!1;const xt=jt=>jt.get_ctrl?jt.get_ctrl():new gt(jt,this.ctrl.highlight_bloom&&this._bloomComposer);let En=!1;if(St&&W&&St.length===W.length){En=!0;for(let jt=0;jt<St.length&&En;++jt)(St[jt]!==W[jt]||xt(St[jt]).checkHighlightIndex(Fe))&&(En=!1)}if(En)return!!St;if(St)for(let jt=0;jt<St.length;++jt)xt(St[jt]).setHighlight();if(this._selected_mesh=W,W)for(let jt=0;jt<W.length;++jt)xt(W[jt]).setHighlight(pe||new z.Q1f(this.ctrl.highlight_color),Fe);return this.render3D(0),!!W}processMouseClick(W,pe,me){if(!pe.length)return;const Fe=pe[0].object;if(!Fe.get_ctrl)return;const At=Fe.get_ctrl(),Et=At.extractIndex(pe[0]);At.evnt=me,At.setSelected("blue",Et)&&this.render3D(),At.evnt=null}setMouseTmout(W){this.ctrl&&(this.ctrl.mouse_tmout=W),this._controls&&(this._controls.mouse_tmout=W)}setDepthMethod(W){this.ctrl&&(this.ctrl.depthMethod=W)}canRotateCamera(){return!(!1===this.ctrl.can_rotate||!this.ctrl.can_rotate&&(this.isOrthoCamera()||this.ctrl.project))}addOrbitControls(){this._controls||!this._webgl||this.isBatchMode()||this.superimpose||(0,b.isNodeJs)()||(this.getCanvPainter()||this.setTooltipAllowed(b.settings.Tooltip),this._controls=(0,x.Sc)(this,this._camera,this._scene,this._renderer,this._lookat),this._controls.mouse_tmout=this.ctrl.mouse_tmout,this.canRotateCamera()||(this._controls.enableRotate=!1),this._controls.contextMenu=this.orbitContext.bind(this),this._controls.processMouseMove=W=>{if(!this.ctrl||!this._controls)return;let Et,St,xt,pe=null,me=null,Fe=null,At=[];for(let jt=0;jt<W.length;++jt){const Cn=W[jt].object,ln=Oe(W[jt]);if(!Cn||!Cn.visible)continue;let Un=null;Cn.geo_object?Un=Cn.geo_name:ln&&(Un=this.getStackFullName(ln)),Un&&(0===Un.indexOf("<prnt>")&&(Un=this.getItemName()+Un.slice(6)),At.push(Un),pe||(pe=Cn,me=Un,Et=Cn.geo_object,Cn.get_ctrl&&(St=Cn.get_ctrl().extractIndex(W[jt]),void 0!==St&&(0,b.isStr)(me)&&(me+=" indx:"+JSON.stringify(St))),xt=ln,xt&&(Fe=this.resolveStack(xt),Cn.stacks&&(St=W[jt].instanceId))))}if(this.highlightMesh(pe,void 0,Et,St),this.ctrl.update_browser&&(this.ctrl.highlight&&me&&(At=[me]),this.activateInBrowser(At)),!Fe?.obj)return me;const En=(0,j.V)(Fe.obj);return En.unshift(me),{name:Fe.obj.fName,title:Fe.obj.fTitle||Fe.obj._typename,lines:En}},this._controls.processMouseLeave=function(){this.processMouseMove([])},this._controls.processDblClick=()=>{!this.ctrl||!this._controls||(this._last_manifest?(this._last_manifest.wireframe=!this._last_manifest.wireframe,this._last_hidden&&this._last_hidden.forEach(W=>{W.visible=!0}),delete this._last_hidden,delete this._last_manifest):this.adjustCameraPosition(!0),this.render3D())})}nextDrawAction(){if(!this._clones||this.isStage(0))return!1;if(this.isStage(1)){if(this._geom_viewer)return this._draw_all_nodes=!1,this.changeStage(3),!0;if(this.ctrl.use_worker>0){if(!this._worker)return this.startWorker(),1;if(!this._worker_ready)return 1}let W=this._first_drawing?this._clones.countVisibles():0,pe=null,me=null;W||(W=this._clones.markVisibles(!1,!1,!!this.geo_manager&&!this.ctrl.showtop)),this.ctrl.select_in_view&&!this._first_drawing&&(pe=(0,j.d4)(this._camera),me=(0,j.P1)(pe),me.CheckBox(this.getGeomBoundingBox())&&(pe=null,me=null)),this._current_face_limit=this.ctrl.maxfaces,pe&&(this._current_face_limit*=1.25);let Fe=!this.isBatchMode()&&b.browser.isChrome&&(W>1e4||pe&&this._clones.scanVisible()>1e5);if(Fe&&0===b.source_dir.indexOf("file://")&&(console.log("disable worker for jsroot from file system"),Fe=!1),Fe&&!this._worker&&this.ctrl.use_worker>=0&&this.startWorker(),!Fe||!this._worker_ready){const Et=this._clones.collectVisibles(this._current_face_limit,me);return this._new_draw_nodes=Et.lst,this._draw_all_nodes=Et.complete,this.changeStage(3),!0}const At={collect:this._current_face_limit,flags:this._clones.getVisibleFlags(),matrix:pe?pe.elements:null,vislevel:this._clones.getVisLevel(),maxvisnodes:this._clones.getMaxVisNodes()};return this.submitToWorker(At),this.changeStage(2),2}if(this.isStage(2))return 2;if(this.isStage(3)){if(this._new_append_nodes)this._new_draw_nodes=this._draw_nodes.concat(this._new_append_nodes),delete this._new_append_nodes;else if(this._draw_nodes){let W;W=this._geom_viewer?this._draw_nodes:this._clones.mergeVisibles(this._new_draw_nodes,this._draw_nodes);for(let pe=0;pe<W.length;++pe)this._clones.createObject3D(W[pe].stack,this._toplevel,"delete_mesh");W.length>0&&(this.drawing_log=`Delete ${W.length} nodes`)}return this._draw_nodes=this._new_draw_nodes,delete this._new_draw_nodes,this.changeStage(4),!0}if(this.isStage(4)){const W=this._clones.collectShapes(this._draw_nodes);return this._build_shapes=this._clones.mergeShapesLists(this._build_shapes,W),this.changeStage(5),!0}if(this.isStage(5)){if(this.canSubmitToWorker()){const W={limit:this._current_face_limit,shapes:[]};let pe=0;for(let me=0;me<this._build_shapes.length;++me){let Fe=null;const At=this._build_shapes[me];At.ready||At.geom?Fe={id:At.id,ready:!0,nfaces:(0,j.Wz)(At.geom),refcnt:At.refcnt}:(Fe=(0,b.clone)(At,null,!0),pe++),W.shapes.push(Fe)}if(pe>0)return this.submitToWorker(W),this.changeStage(6),2}this.changeStage(7)}if(this.isStage(6))return 2;if(this.isStage(7)||this.isStage(8)){if(this.isStage(7)){const At=this._clones.buildShapes(this._build_shapes,this._current_face_limit,500);if(!At.done)return this.ctrl.info.num_shapes=At.shapes,this.drawing_log=`Creating: ${At.shapes} / ${this._build_shapes.length} shapes,  ${At.faces} faces`,!0;this.ctrl.info.num_shapes=this._build_shapes.length,this.changeStage(8)}const W=(new Date).getTime(),pe=this.ctrl.project?this._full_geom:this._toplevel;let me=!1,Fe=!0;if(this.ctrl.project||(me=this._clones.createInstancedMeshes(this.ctrl,pe,this._draw_nodes,this._build_shapes,(0,v.HG)())),!me)for(let At=0;At<this._draw_nodes.length;++At){const Et=this._draw_nodes[At];if(!Et.done&&(this.createEntryMesh(Et,Et.server_shape||this._build_shapes[Et.shapeid],pe),(new Date).getTime()-W>500)){Fe=!1;break}}return Fe?this.ctrl.project?(this.changeStage(10),!0):(this.changeStage(0),!1):(this.isStage(7)||(this.drawing_log=`Building meshes ${this.ctrl.info.num_meshes} / ${this.ctrl.info.num_faces}`),!0)}if(this.isStage(9)){if(!this._main_painter)return this.changeStage(0,"Lost main painter"),!1;if(!this._main_painter._drawing_ready)return 1;this.changeStage(10)}return this.isStage(10)?(this.doProjection(),this.changeStage(0),!1):(console.error(`never come here, stage ${this.drawing_stage}`),!1)}createEntryMesh(W,pe,me){return this._splitColors&&W.stack&&(0===W.stack[0]?W.custom_color="green":1===W.stack[0]&&(W.custom_color="blue")),this._clones.createEntryMesh(this.ctrl,me,W,pe,(0,v.HG)()),!0}appendMoreNodes(W,pe){if(!this.isStage(0)&&!pe)return void(this._provided_more_nodes=W);if(this._more_nodes)for(let Fe=0;Fe<this._more_nodes.length;++Fe){const At=this._more_nodes[Fe],Et=this._clones.createObject3D(At.stack,this._toplevel,"delete_mesh");(0,x.G1)(Et),(0,j.qU)(At.server_shape),delete At.server_shape}if(delete this._more_nodes,!W)return;const me=[];for(let Fe=0;Fe<W.length;++Fe){const At=W[Fe],Et=At.server_shape;Et?.ready&&this.createEntryMesh(At,Et,this._toplevel)&&me.push(At)}me.length>0&&(this._more_nodes=me),pe||this.render3D()}getProjectionSource(){return this._clones_owner?this._full_geom:this._main_painter?this._main_painter._drawing_ready?this._main_painter._toplevel:(console.warn("MAIN PAINTER NOT READY WHEN DO PROJECTION"),null):(console.warn("MAIN PAINTER DISAPPER"),null)}extendCustomBoundingBox(W){if(!W)return;this._customBoundingBox||(this._customBoundingBox=(new z.NRn).makeEmpty());const pe=this._customBoundingBox.clone();this._customBoundingBox.union(W),this._customBoundingBox.equals(pe)||(this._adjust_camera_with_render=!0)}getGeomBoundingBox(W,pe){const me=new z.NRn,Fe=!this._clones;return void 0===W&&(W=this._toplevel),me.makeEmpty(),this._customBoundingBox&&W===this._toplevel?(me.union(this._customBoundingBox),me):W?(W.traverse(At=>{(Fe||At.stack&&At instanceof z.eaF||At.main_track&&At instanceof z.DXC||At.stacks&&At instanceof z.ZLX)&&(0,j.UX)(At,me)}),"original"===pe?(me.translate(new z.Pq0(-W.position.x,-W.position.y,-W.position.z)),me.min.multiply(new z.Pq0(1/W.scale.x,1/W.scale.y,1/W.scale.z)),me.max.multiply(new z.Pq0(1/W.scale.x,1/W.scale.y,1/W.scale.z))):void 0!==pe&&me.expandByVector(me.getSize(new z.Pq0).multiplyScalar(pe)),me):(me.min.x=me.min.y=me.min.z=-1,me.max.x=me.max.y=me.max.z=1,me)}doProjection(){const W=this.getProjectionSource();if(!W)return!1;if((0,x.G1)(this._toplevel,!0),void 0===this.ctrl.projectPos){const pe=this.getGeomBoundingBox(W),me=pe.min[this.ctrl.project],Fe=pe.max[this.ctrl.project];let At=(me+Fe)/2;me<0&&Fe>0&&Math.abs(At)<.2*Math.max(-me,Fe)&&(At=0),this.ctrl.projectPos=At}return W.traverse(pe=>{if(!(pe instanceof z.eaF&&pe.stack))return;const me=(0,j.qr)(pe.geometry,pe.parent.absMatrix||pe.parent.matrixWorld,this.ctrl.project,this.ctrl.projectPos,pe._flippedMesh);if(!me)return;const Fe=new z.eaF(me,pe.material.clone());this._toplevel.add(Fe),Fe.stack=pe.stack}),!0}changedLight(W){if(!this._camera)return;const pe=!W;W||(W=this.getGeomBoundingBox());const me=W.max.x-W.min.x,Fe=W.max.y-W.min.y,At=W.max.z-W.min.z,Et=[],St=.5*(this.ctrl.light.power??1);if(this._camera._lights!==this.ctrl.light.kind)switch((0,x.G1)(this._camera,!0),this._camera._lights=this.ctrl.light.kind,this._camera._lights){case"ambient":this._camera.add(new z.$p8(15724527,St));break;case"hemisphere":this._camera.add(new z.dth(16777147,526368,St));break;case"mix":this._camera.add(new z.$p8(15724527,St));default:for(let xt=0;xt<6;++xt){const En=new z.ZyN(15724527,St);this._camera.add(En),En._id=xt}}for(let xt=0;xt<this._camera.children.length;++xt){const En=this._camera.children[xt];let jt=!1;if(En.isAmbientLight||En.isHemisphereLight)En.intensity=St;else if(En.isDirectionalLight){switch(En._id){case 0:En.position.set(me/5,Fe/5,At/5),jt=this.ctrl.light.specular;break;case 1:En.position.set(0,0,At/2),jt=this.ctrl.light.front;break;case 2:En.position.set(0,2*Fe,0),jt=this.ctrl.light.top;break;case 3:En.position.set(0,-2*Fe,0),jt=this.ctrl.light.bottom;break;case 4:En.position.set(-2*me,0,0),jt=this.ctrl.light.left;break;case 5:En.position.set(2*me,0,0),jt=this.ctrl.light.right}En.power=jt?St*Math.PI*4:0,jt&&Et.push(En)}}Et.forEach(xt=>{xt.power=4*St*Math.PI/Et.length}),pe&&this.render3D()}isOrthoCamera(){return 0===this.ctrl.camera_kind.indexOf("ortho")}createCamera(){this._camera&&(this._scene.remove(this._camera),(0,x.G1)(this._camera),delete this._camera),this.isOrthoCamera()?this._camera=new z.qUd(-this._scene_width/2,this._scene_width/2,this._scene_height/2,-this._scene_height/2,1,1e4):(this._camera=new z.ubm(25,this._scene_width/this._scene_height,1,1e4),this._camera.up=this.ctrl._yup?new z.Pq0(0,1,0):new z.Pq0(0,0,1));const W=new z.ZyN(15724527,.1);W.position.set(10,10,10),this._camera.add(W),this._scene.add(this._camera)}createSpecialEffects(){this._webgl&&this.ctrl.outline&&(0,b.isFunc)(this.createOutline)&&(this._effectComposer=new ke.s0(this._renderer),this._effectComposer.addPass(new ke.AH(this._scene,this._camera)),this.createOutline(this._scene_width,this._scene_height)),this.ensureBloom()}createScene(W,pe,me){var Fe=this;return(0,ve.A)(function*(){if(Fe.superimpose){const At=We(Fe.getMainPainter());return At?.renderer&&(Fe._scene=At.scene,Fe._scene_width=At.scene_width,Fe._scene_height=At.scene_height,Fe._renderer=At.renderer,Fe._webgl=Fe._renderer.jsroot_render3d===b.constants.Render3D.WebGL,Fe._toplevel=new z.B69,Fe._scene.add(Fe._toplevel),(At.scale_x||At.scale_y||At.scale_z)&&Fe._toplevel.scale.set(At.scale_x,At.scale_y,At.scale_z),(At.offset_x||At.offset_y||At.offset_z)&&Fe._toplevel.position.set(At.offset_x,At.offset_y,At.offset_z),Fe._toplevel.updateMatrix(),Fe._toplevel.updateMatrixWorld(),Fe._camera=At.camera),Fe._renderer?.jsroot_dom}return Fe._scene=new z.Z58,Fe._fog=new z.jUj(16777215,1,1e4),Fe._scene.fog=Fe.ctrl.use_fog?Fe._fog:null,Fe._scene.overrideMaterial=new z.G_z({color:7340287,vertexColors:!1,transparent:!0,opacity:.2,depthTest:!1}),Fe._scene_width=W,Fe._scene_height=pe,Fe.createCamera(),Fe._selected_mesh=null,Fe._overall_size=10,Fe._toplevel=new z.B69,Fe._scene.add(Fe._toplevel),Fe._scene.background=new z.Q1f(Fe.ctrl.background),(0,x.Yw)(W,pe,me,{antialias:!0,logarithmicDepthBuffer:!1,preserveDrawingBuffer:!0}).then(At=>{if(Fe._renderer=At,Fe.batch_format&&(At.jsroot_image_format=Fe.batch_format),Fe._webgl=Fe._renderer.jsroot_render3d===b.constants.Render3D.WebGL,Fe._renderer.setPixelRatio&&!(0,b.isNodeJs)()&&Fe._renderer.setPixelRatio(window.devicePixelRatio),Fe._renderer.setSize(W,pe,!Fe._fit_main_area),Fe._renderer.localClippingEnabled=!0,Fe._renderer.setClearColor(Fe._scene.background,1),Fe._fit_main_area&&Fe._webgl){Fe._renderer.domElement.style.width="100%",Fe._renderer.domElement.style.height="100%";const Et=Fe.selectDom();"static"===Et.style("position")&&Et.style("position","relative")}if(Fe._animating=!1,Fe.ctrl.doubleside=!1,Fe.createSpecialEffects(),Fe._fit_main_area&&!Fe._webgl){const St=(0,b.getDocument)().createElementNS("http://www.w3.org/2000/svg","svg");return St.setAttribute("width",W),St.setAttribute("height",pe),St.appendChild(Fe._renderer.jsroot_dom),St}return Fe._renderer.jsroot_dom})})()}startDrawGeometry(W){W||this.isStage(0)?(this._clones_owner&&this._clones&&this._clones.setDefaultColors(this.ctrl.dflt_colors),this._startm=(new Date).getTime(),this._last_render_tm=this._startm,this._last_render_meshes=0,this.changeStage(1),this._drawing_ready=!1,this.ctrl.info.num_meshes=0,this.ctrl.info.num_faces=0,this.ctrl.info.num_shapes=0,this._selected_mesh=null,this.ctrl.project&&(this._clones_owner?this._full_geom?this.changeStage(10):this._full_geom=new z.B69:this.changeStage(9)),delete this._last_manifest,delete this._last_hidden,delete this._draw_nodes_again,this.continueDraw()):this._draw_nodes_again=!0}resetAdvanced(){this.ctrl.depthTest=!0,this.ctrl.clipIntersect=!0,this.ctrl.depthMethod="ray",this.changedDepthMethod("norender"),this.changedDepthTest()}getOverallSize(W){if(!this._overall_size||W||this._customBoundingBox){const pe=this.getGeomBoundingBox();if(!Number.isFinite(pe.min.x))return 1e3;this._overall_size=2*Math.max(pe.max.x-pe.min.x,pe.max.y-pe.min.y,pe.max.z-pe.min.z)}return this._overall_size}createSnapshot(W){if(!this._renderer)return;this.render3D(0);const pe=this._renderer.domElement.toDataURL("image/png");if("asis"===W)return pe;pe.replace("image/png","image/octet-stream");const me=(0,b.getDocument)(),Fe=me.createElement("a");(0,b.isStr)(Fe.download)&&(me.body.appendChild(Fe),Fe.download=W||"geometry.png",Fe.href=pe,Fe.click(),me.body.removeChild(Fe))}produceCameraUrl(W){if(!this._camera)return"";if(this._camera.isOrthographicCamera){const jt=Math.round(100*this._camera.zoom);return this.ctrl.camera_kind+(100===jt?"":`,zoom=${jt}`)}let pe="";if("perspective"!==this.ctrl.camera_kind&&(pe=this.ctrl.camera_kind+","),!0===W){const jt=this._camera?.position,Cn=this._controls?.target;if(!jt||!Cn)return"";const ln=Ci=>{let Rn="";return Ci<0&&(Rn="n",Ci=-Ci),Rn+Ci.toFixed(0)};let Un=`${pe}camx${ln(jt.x)},camy${ln(jt.y)},camz${ln(jt.z)}`;return(Cn.x||Cn.y||Cn.z)&&(Un+=`,camlx${ln(Cn.x)},camly${ln(Cn.y)},camlz${ln(Cn.z)}`),Un}if(!this._lookat||!this._camera0pos)return"";const me=(new z.Pq0).add(this._camera0pos).sub(this._lookat),Fe=(new z.Pq0).add(this._camera.position).sub(this._lookat),At=Math.min(1e4,Math.max(1,this.ctrl.zoom*Fe.length()/me.length()*100));me.normalize(),Fe.normalize();const Et=new z.PTz,St=new z.O9p;Et.setFromUnitVectors(me,Fe),St.setFromQuaternion(Et,"YZX");let xt=St.y/Math.PI*180,En=St.z/Math.PI*180;return xt<0&&(xt+=360),En<0&&(En+=360),`${pe}roty${xt.toFixed(0)},rotz${En.toFixed(0)},zoom${At.toFixed(0)}`}calculateZoom(){if(this._camera0pos&&this._camera&&this._lookat){const W=(new z.Pq0).add(this._camera0pos).sub(this._lookat);return(new z.Pq0).add(this._camera.position).sub(this._lookat).length()/W.length()}return 0}adjustCameraPosition(W,pe){if(!this._toplevel||this.superimpose)return;const me=!0===W,Fe="first"===W||me,At="only_set"===W,Et=this.getGeomBoundingBox();if(!Number.isFinite(Et.min.x))return void console.log("FAILS to get geometry bounding box");const St=Et.max.x-Et.min.x,xt=Et.max.y-Et.min.y,En=Et.max.z-Et.min.z,jt=(Et.max.x+Et.min.x)/2,Cn=(Et.max.y+Et.min.y)/2,ln=(Et.max.z+Et.min.z)/2,Un=this.ctrl._axis||"bar"===this.ctrl.camera_overlay?.2:.1;if(this._scene_size&&!me){const Fn=this._scene_size,Zt=(Ne,$,S)=>(S||(S=Math.abs((Ne+$)/2)),S<=1e-20||Math.abs($-Ne)/S>.01);if(!(Zt(St,Fn.sizex)||Zt(xt,Fn.sizey)||Zt(En,Fn.sizez)||Zt(jt,Fn.midx,Fn.sizex)||Zt(Cn,Fn.midy,Fn.sizey)||Zt(ln,Fn.midz,Fn.sizez)))return void(this.ctrl.select_in_view&&this.startDrawGeometry())}if(this._scene_size={sizex:St,sizey:xt,sizez:En,midx:jt,midy:Cn,midz:ln},this._overall_size=2*Math.max(St,xt,En),this._camera.near=this._overall_size/350,this._camera.far=100*this._overall_size,this._fog.near=.5*this._overall_size,this._fog.far=5*this._overall_size,Fe)for(let Fn=0;Fn<3;++Fn){const Zt=this.ctrl.clip[Fn];Zt.min=Et.min[Zt.name],Zt.max=Et.max[Zt.name];const tr=Zt.max-Zt.min;Zt.max+=.01*tr,Zt.min-=.01*tr,Zt.step=tr>100?.1:tr>1?.001:void 0,Zt.value?Zt.value<Zt.min?Zt.value=Zt.min:Zt.value>Zt.max&&(Zt.value=Zt.max):Zt.value=(Zt.min+Zt.max)/2}let Ci=2*this.ctrl.zoom;const Rn=Math.max(St,xt,En),si=this.ctrl.camera_kind.indexOf("N")>0?-1:1;if(this._lookat=new z.Pq0(jt,Cn,ln),this._camera0pos=new z.Pq0(-2*Rn,0,0),this._camera.updateMatrixWorld(),this._camera.updateProjectionMatrix(),(this.ctrl.rotatey||this.ctrl.rotatez)&&this.ctrl.can_rotate){const Fn=this.calculateZoom();pe&&Fn&&(Ci=2*Fn);const Zt=new z.O9p(0,this.ctrl.rotatey/180*Math.PI,this.ctrl.rotatez/180*Math.PI,"YZX");this._camera.position.set(-Ci*Rn,0,0),this._camera.position.applyEuler(Zt),this._camera.position.add(new z.Pq0(jt,Cn,ln)),pe&&Fn&&(Ci*=Fn/this.calculateZoom(),this._camera.position.set(-Ci*Rn,0,0),this._camera.position.applyEuler(Zt),this._camera.position.add(new z.Pq0(jt,Cn,ln)))}else if(void 0!==this.ctrl.camx&&void 0!==this.ctrl.camy&&void 0!==this.ctrl.camz)this._camera.position.set(this.ctrl.camx,this.ctrl.camy,this.ctrl.camz),this._lookat.set(this.ctrl.camlx||0,this.ctrl.camly||0,this.ctrl.camlz||0),this.ctrl.camx=this.ctrl.camy=this.ctrl.camz=this.ctrl.camlx=this.ctrl.camly=this.ctrl.camlz=void 0;else if("orthoXOY"===this.ctrl.camera_kind||"orthoXNOY"===this.ctrl.camera_kind)this._camera.up.set(0,1,0),this._camera.position.set(si<0?2*jt:0,0,ln+si*En*2),this._lookat.set(si<0?2*jt:0,0,ln),this._camera.left=Et.min.x-Un*St,this._camera.right=Et.max.x+Un*St,this._camera.top=Et.max.y+Un*xt,this._camera.bottom=Et.min.y-Un*xt,pe||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoSign=si,this._camera.orthoZ=[ln,En/2];else if("orthoXOZ"===this.ctrl.camera_kind||"orthoXNOZ"===this.ctrl.camera_kind)this._camera.up.set(0,0,1),this._camera.position.set(si<0?2*jt:0,Cn-si*xt*2,0),this._lookat.set(si<0?2*jt:0,Cn,0),this._camera.left=Et.min.x-Un*St,this._camera.right=Et.max.x+Un*St,this._camera.top=Et.max.z+Un*En,this._camera.bottom=Et.min.z-Un*En,pe||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[0,2,1],this._camera.orthoRotation=Fn=>Fn.rotateX(Math.PI/2),this._camera.orthoSign=si,this._camera.orthoZ=[Cn,-xt/2];else if("orthoZOY"===this.ctrl.camera_kind||"orthoZNOY"===this.ctrl.camera_kind)this._camera.up.set(0,1,0),this._camera.position.set(jt-si*St*2,0,si<0?2*ln:0),this._lookat.set(jt,0,si<0?2*ln:0),this._camera.left=Et.min.z-Un*En,this._camera.right=Et.max.z+Un*En,this._camera.top=Et.max.y+Un*xt,this._camera.bottom=Et.min.y-Un*xt,pe||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[2,1,0],this._camera.orthoRotation=Fn=>Fn.rotateY(-Math.PI/2),this._camera.orthoSign=si,this._camera.orthoZ=[jt,-St/2];else if("orthoZOX"===this.ctrl.camera_kind||"orthoZNOX"===this.ctrl.camera_kind)this._camera.up.set(1,0,0),this._camera.position.set(0,Cn-si*xt*2,si>0?2*ln:0),this._lookat.set(0,Cn,si>0?2*ln:0),this._camera.left=Et.min.z-Un*En,this._camera.right=Et.max.z+Un*En,this._camera.top=Et.max.x+Un*St,this._camera.bottom=Et.min.x-Un*St,pe||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[2,0,1],this._camera.orthoRotation=Fn=>Fn.rotateX(Math.PI/2).rotateY(Math.PI/2),this._camera.orthoSign=si,this._camera.orthoZ=[Cn,-xt/2];else if(this.ctrl.project)switch(this.ctrl.project){case"x":this._camera.position.set(1.5*Ci*Math.max(xt,En),0,0);break;case"y":this._camera.position.set(0,1.5*Ci*Math.max(St,En),0);break;case"z":this._camera.position.set(0,0,1.5*Ci*Math.max(St,xt))}else"perspXOZ"===this.ctrl.camera_kind?(this._camera.up.set(0,1,0),this._camera.position.set(jt-3*Rn,Cn,ln)):"perspYOZ"===this.ctrl.camera_kind?(this._camera.up.set(1,0,0),this._camera.position.set(jt,Cn-3*Rn,ln)):"perspXOY"===this.ctrl.camera_kind?(this._camera.up.set(0,0,1),this._camera.position.set(jt-3*Rn,Cn,ln)):this.ctrl._yup?(this._camera.up.set(0,1,0),this._camera.position.set(jt-Ci*Math.max(St,En),Cn+Ci*xt,ln-Ci*Math.max(St,En))):(this._camera.up.set(0,0,1),this._camera.position.set(jt-Ci*Math.max(St,xt),Cn-Ci*Math.max(St,xt),ln+Ci*En));if(this._camera.isOrthographicCamera&&this.isOrthoCamera()&&this._scene_width&&this._scene_height){const Fn=this._scene_width/this._scene_height,Zt=this._camera.right-this._camera.left,tr=this._camera.top-this._camera.bottom;if(Fn>Zt/tr){const Ne=(this._camera.right+this._camera.left)/2;this._camera.left=Ne-tr*Fn/2,this._camera.right=Ne+tr*Fn/2}else{const Ne=(this._camera.top+this._camera.bottom)/2;this._camera.top=Ne+Zt/Fn/2,this._camera.bottom=Ne-Zt/Fn/2}}this._camera.lookAt(this._lookat),this._camera.updateProjectionMatrix(),this.changedLight(Et),this._controls&&(this._controls.target.copy(this._lookat),At||this._controls.update()),this.ctrl.select_in_view&&!At&&this.startDrawGeometry()}setCameraPosition(W,pe,me){if(!this.ctrl)return;this.ctrl.rotatey=W||0,this.ctrl.rotatez=pe||0;let Fe=!1;me&&Number.isFinite(me)?this.ctrl.zoom=me:Fe=!0,this.adjustCameraPosition(!1,Fe)}setCameraPositionAndLook(W,pe,me,Fe,At,Et){this.ctrl&&(this.ctrl.camx=W,this.ctrl.camy=pe,this.ctrl.camz=me,this.ctrl.camlx=Fe,this.ctrl.camly=At,this.ctrl.camlz=Et,this.adjustCameraPosition(!1))}focusOnItem(W){if(!W||!this._clones)return;const pe=this._clones.findStackByName(W);pe&&this.focusCamera(this._clones.resolveStack(pe,!0),!1)}focusCamera(W,pe){if(this.ctrl.project||this.isOrthoCamera())return this.adjustCameraPosition(!0),this.render3D();let me=new z.NRn;if(void 0===W)me=this.getGeomBoundingBox();else if(W instanceof z.eaF)me.setFromObject(W);else{const Zt=(new z.Pq0).setFromMatrixPosition(W.matrix),tr=W.node,Ne=new z.Pq0(tr.fDX,tr.fDY,tr.fDZ).multiplyScalar(.5);me.min=Zt.clone().sub(Ne),me.max=Zt.clone().add(Ne)}const Fe=me.max.x-me.min.x,At=me.max.y-me.min.y,Et=me.max.z-me.min.z,St=(me.max.x+me.min.x)/2,xt=(me.max.y+me.min.y)/2,En=(me.max.z+me.min.z)/2;let jt,Cn=50,ln=0;jt=this.ctrl._yup?new z.Pq0(St-2*Math.max(Fe,Et),xt+2*At,En-2*Math.max(Fe,Et)):new z.Pq0(St-2*Math.max(Fe,At),xt-2*Math.max(Fe,At),En+2*Et);const Un=new z.Pq0(St,xt,En),Ci=this._controls.target,Rn=jt.sub(this._camera.position).divideScalar(Cn),si=Un.sub(Ci).divideScalar(Cn);if(pe=pe&&this._webgl){for(let Zt=0;Zt<3;++Zt){const tr=this.ctrl.clip[Zt];tr.enabled||(tr.value=tr.min,tr.enabled=!0),tr.inc=((tr.min+tr.max)/2-tr.value)/Cn}this.updateClipping()}this._animating=!0;const Fn=()=>{if(void 0===this._animating)return;this._animating?requestAnimationFrame(Fn):this._geom_viewer||this.startDrawGeometry();const Zt=1-Math.cos(2*Math.PI*ln/Cn);this._camera.position.add(Rn.clone().multiplyScalar(Zt)),Ci.add(si.clone().multiplyScalar(Zt)),this._lookat=Ci,this._camera.lookAt(this._lookat),this._camera.updateProjectionMatrix();const tr=(new Date).getTime();if(pe){for(let $=0;$<3;++$)this.ctrl.clip[$].value+=this.ctrl.clip[$].inc*Zt;this.updateClipping()}else this.render3D(0);const Ne=(new Date).getTime();0===ln&&Ne-tr>200&&(Cn=20),ln++,this._animating=ln<Cn};Fn()}autorotate(W){const pe=void 0===W?2:W;let me=new Date;const Fe=()=>{if(!this._renderer||!this.ctrl)return;const At=new Date;this.ctrl.rotate&&requestAnimationFrame(Fe),this._controls&&(this._controls.autoRotate=this.ctrl.rotate,this._controls.autoRotateSpeed=pe*(At.getTime()-me.getTime())/16.6666,this._controls.update()),me=new Date,this.render3D(0)};this._webgl&&Fe()}completeScene(){}drawCount(W,pe){var me=this;return(0,ve.A)(function*(){const Fe=ln=>(me.isBatchMode()?"anytime":ln.toString())+" ms",At=["Unique nodes: "+me._clones.nodes.length,"Unique visible: "+W,"Time to clone: "+Fe(pe)];me._clones.scanVisible();let Et=0;const St={clones:me._clones,cnt:[],func(ln){return void 0===this.cnt[this.last]?this.cnt[this.last]=1:this.cnt[this.last]++,Et+=(0,j._b)(this.clones.getNodeShape(ln.id)),!0}};let xt=(new Date).getTime(),En=me._clones.scanVisible(St),jt=(new Date).getTime();At.push(`Total visible nodes: ${En}`,`Total shapes: ${Et}`);for(let ln=0;ln<St.cnt.length;++ln)void 0!==St.cnt[ln]&&At.push(`  lvl${ln}: ${St.cnt[ln]}`);At.push(`Time to scan: ${Fe(jt-xt)}`,"","Check timing for matrix calculations ...");const Cn=me.selectDom().style("overflow","auto");return me.isBatchMode()?Cn.property("_json_object_",At):At.forEach(ln=>Cn.append("p").text(ln)),(0,b.postponePromise)(()=>{St.domatrix=!0,xt=(new Date).getTime(),En=me._clones.scanVisible(St),jt=(new Date).getTime();const ln=`Time to scan with matrix: ${Fe(jt-xt)}`;return me.isBatchMode()?At.push(ln):Cn.append("p").text(ln),me},100)})()}performDrop(W,pe,me,Fe){var At=this;return(0,ve.A)(function*(){if("TTree"===W?.$kind){let Et="extract_geo_tracks";Fe&&Fe.indexOf("$")>0&&(Et=Fe.slice(0,Fe.indexOf("$")),Fe=Fe.slice(Fe.indexOf("$")+1));const St=(0,b.findFunction)(Et);return St?St(W,Fe).then(xt=>xt?At.drawExtras(xt,"",!1).then(()=>(At.updateClipping(!0),At.render3D(100))):At):Promise.reject(Error(`Function ${Et} not found`))}return At.drawExtras(W,pe).then(Et=>Et?(me&&(me._painter=At),At.render3D(100)):At)})()}mouseOverHierarchy(W,pe,me){if(!this.ctrl)return;const Fe=me._obj;!Fe||Fe._typename!==k&&Fe._typename!==J&&Fe._typename!==b.clTPolyMarker3D||this.highlightMesh(null,65280,W?Fe:null)}clearExtras(){this.getExtrasContainer("delete"),delete this._extraObjects,this.render3D()}addExtra(W,pe){return void 0===this._extraObjects&&(this._extraObjects=(0,b.create)(b.clTList)),!(this._extraObjects.arr.indexOf(W)>=0||(this._extraObjects.Add(W,pe),delete W.$hidden_via_menu,0))}extraObjectVisible(W,pe,me){if(!this._extraObjects)return;const Fe=W.itemFullName(pe);let At=this._extraObjects.opt.indexOf(Fe);if(At<0&&pe._obj&&(At=this._extraObjects.arr.indexOf(pe._obj),At>=0&&(this._extraObjects.opt[At]=Fe)),At<0)return;const Et=this._extraObjects.arr[At];let St=!!Et.$hidden_via_menu;if(me){Et.$hidden_via_menu=St,St=!St;let xt=null;this._toplevel.traverse(En=>{En.geo_object===Et&&(xt=En)}),xt?(xt.visible=St,this.render3D()):St&&this.drawExtras(Et,"",!1).then(()=>{this.updateClipping(!0),this.render3D()})}return St}drawExtras(W,pe,me,Fe){var At=this;return(0,ve.A)(function*(){if(!W?._typename||!me&&W.$hidden_via_menu)return!1;let Et=!1;void 0===me?(me=!0,Et=!0):Fe&&(Et=!0);let St=!1;if(W._typename===b.clTList||W._typename===b.clTObjArray){if(!W.arr)return!1;const xt=[];for(let En=0;En<W.arr.length;++En){let Cn=W.opt?W.opt[En]:"";Cn||(Cn=(pe||"<prnt>")+`/[${En}]`),xt.push(At.drawExtras(W.arr[En],Cn,me))}St=Promise.all(xt).then(En=>En.indexOf(!0)>=0)}else"Mesh"===W._typename?(At.addToExtrasContainer(W),St=Promise.resolve(!0)):"TGeoTrack"===W._typename?(!me||At.addExtra(W,pe))&&(St=At.drawGeoTrack(W,pe)):W._typename===b.clTPolyLine3D?(!me||At.addExtra(W,pe))&&(St=At.drawPolyLine(W,pe)):W._typename===k||W._typename===`${b.nsREX}REveTrack`?(!me||At.addExtra(W,pe))&&(St=At.drawEveTrack(W,pe)):W._typename===J||W._typename===`${b.nsREX}REvePointSet`||W._typename===b.clTPolyMarker3D?(!me||At.addExtra(W,pe))&&(St=At.drawHit(W,pe)):(W._typename===I||W._typename===_e)&&(!me||At.addExtra(W,pe))&&(St=At.drawExtraShape(W,pe));return(0,b.getPromise)(St).then(xt=>{if(!xt||!Et)return xt;At.updateClipping(!0);const En=At.render3D(100,!!Fe&&"nopromise");return Fe?At:En})})()}getExtrasContainer(W,pe){if(!this._toplevel)return null;pe||(pe="tracks");let me=null;const Fe=[];for(let At=0;At<this._toplevel.children.length;++At){const Et=this._toplevel.children[At];if(Et._extras){if("collect"===W){Fe.push(Et);continue}if(Et._extras===pe){me=Et;break}}}if("collect"===W){for(let At=0;At<Fe.length;++At)this._toplevel.remove(Fe[At]);return Fe}return"delete"===W?(me&&this._toplevel.remove(me),(0,x.G1)(me),null):("get"!==W&&!me&&(me=new z.B69,me._extras=pe,this._toplevel.add(me)),me)}addToExtrasContainer(W,pe){const me=this.getExtrasContainer("",pe);me?me.add(W):(console.warn("Fail to add object to extras"),(0,x.G1)(W))}drawGeoTrack(W,pe){if(!W?.fNpoints)return!1;const me=b.browser.isWin?1:W.fLineWidth||1,Fe=(0,v.oU)(W.fLineColor)||"#ff00ff",At=Math.round(W.fNpoints/4),Et=new Float32Array(6*(At-1)),St=this.ctrl.projectPos,xt="x"===this.ctrl.project,En="y"===this.ctrl.project,jt="z"===this.ctrl.project;for(let Un=0,Ci=0;Un<At-1;++Un,Ci+=6)Et[Ci]=xt?St:W.fPoints[4*Un],Et[Ci+1]=En?St:W.fPoints[4*Un+1],Et[Ci+2]=jt?St:W.fPoints[4*Un+2],Et[Ci+3]=xt?St:W.fPoints[4*Un+4],Et[Ci+4]=En?St:W.fPoints[4*Un+5],Et[Ci+5]=jt?St:W.fPoints[4*Un+6];const Cn=new z.mrM({color:Fe,linewidth:me}),ln=(0,x.Fc)(Et,Cn);return ln.defaultOrder=ln.renderOrder=1e6,ln.geo_name=pe,ln.geo_object=W,ln.hightlightWidthScale=2,0===pe?.indexOf("<prnt>/Tracks")&&(ln.main_track=!0),this.addToExtrasContainer(ln),!0}drawPolyLine(W,pe){if(!W)return!1;const me=b.browser.isWin?1:W.fLineWidth||1,Fe=(0,v.oU)(W.fLineColor)||"#ff00ff",At=W.fN,Et=W.fP,St=new Float32Array(6*(At-1)),xt=this.ctrl.projectPos,En="x"===this.ctrl.project,jt="y"===this.ctrl.project,Cn="z"===this.ctrl.project;for(let Ci=0,Rn=0;Ci<At-1;++Ci,Rn+=6)St[Rn]=En?xt:Et[3*Ci],St[Rn+1]=jt?xt:Et[3*Ci+1],St[Rn+2]=Cn?xt:Et[3*Ci+2],St[Rn+3]=En?xt:Et[3*Ci+3],St[Rn+4]=jt?xt:Et[3*Ci+4],St[Rn+5]=Cn?xt:Et[3*Ci+5];const ln=new z.mrM({color:Fe,linewidth:me}),Un=(0,x.Fc)(St,ln);return Un.defaultOrder=Un.renderOrder=1e6,Un.geo_name=pe,Un.geo_object=W,Un.hightlightWidthScale=2,this.addToExtrasContainer(Un),!0}drawEveTrack(W,pe){if(!W||W.fN<=0)return!1;const me=b.browser.isWin?1:W.fLineWidth||1,Fe=(0,v.oU)(W.fLineColor)||"#ff00ff",At=new Float32Array(6*(W.fN-1)),Et=this.ctrl.projectPos,St="x"===this.ctrl.project,xt="y"===this.ctrl.project,En="z"===this.ctrl.project;for(let ln=0,Un=0;ln<W.fN-1;++ln,Un+=6)At[Un]=St?Et:W.fP[3*ln],At[Un+1]=xt?Et:W.fP[3*ln+1],At[Un+2]=En?Et:W.fP[3*ln+2],At[Un+3]=St?Et:W.fP[3*ln+3],At[Un+4]=xt?Et:W.fP[3*ln+4],At[Un+5]=En?Et:W.fP[3*ln+5];const jt=new z.mrM({color:Fe,linewidth:me}),Cn=(0,x.Fc)(At,jt);return Cn.defaultOrder=Cn.renderOrder=1e6,Cn.geo_name=pe,Cn.geo_object=W,Cn.hightlightWidthScale=2,this.addToExtrasContainer(Cn),!0}drawHit(W,pe){var me=this;return(0,ve.A)(function*(){if(!W||!W.fN||W.fN<0)return!1;const Fe=W.fN,At=me.ctrl.projectPos,Et="x"===me.ctrl.project,St="y"===me.ctrl.project,xt="z"===me.ctrl.project,En=Math.max(W.fMarkerSize*me.getOverallSize()*(me._dummy?.015:.005),.2),jt=new x._l(Fe,me._webgl,En);for(let Cn=0;Cn<Fe;Cn++)jt.addPoint(Et?At:W.fP[3*Cn],St?At:W.fP[3*Cn+1],xt?At:W.fP[3*Cn+2]);return jt.createPoints({color:(0,v.oU)(W.fMarkerColor)||"#0000ff",style:W.fMarkerStyle}).then(Cn=>(Cn.defaultOrder=Cn.renderOrder=1e6,Cn.highlightScale=2,Cn.geo_name=pe,Cn.geo_object=W,me.addToExtrasContainer(Cn),!0))})()}drawExtraShape(W,pe){const me=ds(W);return!!me&&(me.geo_name=pe,me.geo_object=W,this.addToExtrasContainer(me),!0)}findNodeWithVolume(W,pe,me,Fe,At){let Et=!1,St=null;if(me)Fe&&(Fe+="/"),Fe+=me.fName;else{if(!(me=this.getGeometry())&&0!==(0,j.Dh)(me))return null;Fe=this.geo_manager?me.fName:"",Et=!0,At=[]}if(!me.fVolume||me.fVolume._searched)return null;if(W.test(me.fVolume.fName)&&(St=pe({node:me,item:Fe}),St))return St;if(me.fVolume._searched=!0,At.push(me.fVolume),me.fVolume.fNodes)for(let xt=0,En=me.fVolume.fNodes.arr.length;xt<En&&(St=this.findNodeWithVolume(W,pe,me.fVolume.fNodes.arr[xt],Fe,At),!St);++xt);if(Et)for(let xt=0,En=At.length;xt<En;++xt)delete At[xt]._searched;return St}loadMacro(W){var pe=this;return(0,ve.A)(function*(){const me={obj:pe.getGeometry(),prefix:""};if(pe.geo_manager&&(me.prefix=me.obj.fName),!W||W.length<3||0!==(0,j.Dh)(me.obj))return me;const Fe={GetVolume:At=>{const Et=new RegExp("^"+At+"$"),St=pe.findNodeWithVolume(Et,xt=>xt);return St||console.log(`Did not found ${At} volume`),{found:St,fVolume:St?.node?.fVolume,InvisibleAll(xt){(0,j.N_)(this.fVolume,xt)},Draw(){!this.found||!this.fVolume||(me.obj=this.found.node,me.prefix=this.found.item,console.log(`Select volume for drawing ${this.fVolume.fName} ${me.prefix}`))},SetTransparency(xt){this.fVolume?.fMedium?.fMaterial&&(this.fVolume.fMedium.fMaterial.fFillStyle=3e3+xt)},SetLineColor(xt){this.fVolume&&(this.fVolume.fLineColor=xt)}}},DefaultColors:()=>{pe.ctrl.dflt_colors=!0},SetMaxVisNodes:At=>{pe.ctrl.maxnodes||(pe.ctrl.maxnodes=parseInt(At)||0)},SetVisLevel:At=>{pe.ctrl.vislevel||(pe.ctrl.vislevel=parseInt(At)||0)}};return(0,xe.Rh)(`Loading macro ${W}`),(0,b.httpRequest)(W,"text").then(At=>{const Et=At.split("\n");let St=0;for(;St<Et.length;){let xt=Et[St++].trim();if(!(0===xt.indexOf("//")||xt.indexOf("gGeoManager")<0||(xt=xt.replace("->GetVolume",".GetVolume"),xt=xt.replace("->InvisibleAll",".InvisibleAll"),xt=xt.replace("->SetMaxVisNodes",".SetMaxVisNodes"),xt=xt.replace("->DefaultColors",".DefaultColors"),xt=xt.replace("->Draw",".Draw"),xt=xt.replace("->SetTransparency",".SetTransparency"),xt=xt.replace("->SetLineColor",".SetLineColor"),xt=xt.replace("->SetVisLevel",".SetVisLevel"),xt.indexOf("->")>=0)))try{new Function("gGeoManager",xt)(Fe)}catch{console.error(`Problem by processing ${xt}`)}}return me}).catch(()=>(console.error(`Fail to load ${W}`),me))})()}assignClones(W){this._clones_owner=!0,this._clones=W}extractRawShapes(W,pe){let me=null,Fe=0;pe&&(me=W.numnodes>1e6?{length:W.numnodes}:new Array(W.numnodes)),W.nodes.forEach(Et=>{Et=j.De.formatServerElement(Et),me?me[Et.id]=Et:this._clones.updateNode(Et)}),pe&&(this._clones_owner=!0,this._clones=new j.De(null,me),this._clones.name_prefix=this._clones.getNodeName(0),this._clones.setConfig(this.ctrl),this._clones.maxdepth=20);let At=0;W.cfg&&(At=W.cfg.nsegm),At&&(Fe=(0,j.QL)("GradPerSegm"),(0,j.QL)("GradPerSegm",360/Math.max(At,6)));for(let Et=0;Et<W.visibles.length;++Et){const St=W.visibles[Et],xt=St.ri;xt&&(St.server_shape=xt.server_shape=(0,j.uz)(xt,At))}return Fe&&(0,j.QL)("GradPerSegm",Fe),!0}prepareObjectDraw(W,pe){var me=this;return(0,ve.A)(function*(){if(me.did_cleanup)return null;if("__geom_viewer_append__"===pe)me._new_append_nodes=W,me.ctrl.use_worker=0,me._geom_viewer=!0;else if("__geom_viewer_selection__"===pe&&me._clones)me._new_draw_nodes=W,me.ctrl.use_worker=0,me._geom_viewer=!0;else if(me._main_painter)me._clones_owner=!1,me._clones=me._main_painter._clones,console.log(`Reuse clones ${me._clones.nodes.length} from main painter`);else if(W){me._start_drawing_time=(new Date).getTime(),me._clones_owner=!0,me._clones=new j.De(W);let At=me.ctrl.vislevel,Et=me.ctrl.maxnodes;me.geo_manager&&(!At&&me.geo_manager.fVisLevel&&(At=me.geo_manager.fVisLevel),Et||(Et=me.geo_manager.fMaxVisNodes)),me._clones.setVisLevel(At),me._clones.setMaxVisNodes(Et,me.ctrl.more),me._clones.setConfig(me.ctrl),me._clones.name_prefix=pe;const St=!!me.geo_manager&&!me.ctrl.showtop;let xt=me.ctrl.no_screen?0:me._clones.markVisibles(!0,!1,St);xt=xt<=0?me._clones.markVisibles(!1,!1,St):me._clones.markVisibles(!0,!0,St),me._clones.produceIdShifts();const En=(new Date).getTime()-me._start_drawing_time;if(me._scene||console.log(`Creating clones ${me._clones.nodes.length} takes ${En} ms uniquevis ${xt}`),me.ctrl._count)return me.drawCount(xt,En)}else me._clones_owner=!1,me._clones=null;let Fe=Promise.resolve(!0);if(!me._scene){me._first_drawing=!0;const At=me.getPadPainter();if(me._on_pad=!!At,me._on_pad){let Et,St,xt;Fe=(0,U.ensureTCanvas)(me,"3d").then(()=>(At.fillatt?.color&&(me.ctrl.background=At.fillatt.color),xt=me.getFramePainter(),me.batch_mode=At.isBatchMode(),St=(0,x.ke)(void 0,me.batch_mode),(0,x.LR)(xt),xt.mode3d=!0,Et=xt.getSizeFor3d(void 0,St),me._fit_main_area=-1===Et.can3d,me.createScene(Et.width,Et.height,St).then(En=>xt.add3dCanvas(Et,En,St===b.constants.Render3D.WebGL))))}else{const Et=me.selectDom("origin");me.batch_mode=(0,b.isBatchMode)()||!Et.empty()&&Et.property("_batch_mode"),me.batch_format=Et.property("_batch_format");const St=(0,x.ke)(me.options.Render3D,me.batch_mode);me.ctrl.use_worker>0&&!me.batch_mode&&me.startWorker(),(0,x.LR)(me);const xt=me.getSizeFor3d(void 0,St);me._fit_main_area=-1===xt.can3d,Fe=me.createScene(xt.width,xt.height,St).then(En=>me.add3dCanvas(xt,En,me._webgl))}}return Fe.then(()=>(me._first_drawing&&!me.ctrl.maxfaces&&(me.ctrl.maxfaces=2e5*me.ctrl.more),me.setAsMainPainter(),me.createToolbar(),me._clones?new Promise(At=>{me._resolveFunc=At,me.showDrawInfo("Drawing geometry"),me.startDrawGeometry(!0)}):me.completeDraw()))})()}showDrawInfo(W){if(this.isBatchMode()||!this._first_drawing||!this._start_drawing_time)return;const pe=this._renderer.domElement.parentNode;if(!pe)return;let me=pe.querySelector(".geo_info");if(W){const Fe=.001*((new Date).getTime()-this._start_drawing_time);me||(me=(0,b.getDocument)().createElement("p"),me.setAttribute("class","geo_info"),me.setAttribute("style","position: absolute; text-align: center; vertical-align: middle; top: 45%; left: 40%; color: red; font-size: 150%;"),pe.append(me)),me.innerHTML=`${W}, ${Fe.toFixed(1)}s`}else me?.remove()}continueDraw(){if(this.isStage(0))return;const W=(new Date).getTime(),pe=this._first_drawing?1e3:200;let me=W;for(;;){const At=this.nextDrawAction();if(!At)break;if(me=(new Date).getTime(),me-this._startm>1e5){this.changeStage(0,"Abort build after 100s");break}if(!(!0===At&&me-W<pe)&&(me-W>pe||1===At||2===At))return(0,xe.Rh)(this.drawing_log),this.showDrawInfo(this.drawing_log),this._first_drawing&&this._webgl&&this._num_meshes-this._last_render_meshes>100&&me-this._last_render_tm>2.5*pe&&(this.adjustCameraPosition(),this.render3D(-1),this._last_render_meshes=this.ctrl.info.num_meshes),void(2!==At&&setTimeout(()=>this.continueDraw(),1===At?100:1))}const Fe=me-this._startm;if((this._first_drawing||this._full_redrawing)&&console.log(`Create tm = ${Fe} meshes ${this.ctrl.info.num_meshes} faces ${this.ctrl.info.num_faces}`),Fe>300)return(0,xe.Rh)("Rendering geometry"),this.showDrawInfo("Rendering"),setTimeout(()=>this.completeDraw(!0),10);this.completeDraw(!0)}testCameraPosition(W){this._camera.updateMatrixWorld(),this.drawOverlay();const pe=this._camera.position.clone();if(!(!W&&this._last_camera_position&&this._last_camera_position.distanceTo(pe)<1e-4*(this._overall_size||1e3))){if(this._last_camera_position=pe,this.ctrl._axis){const me=(this._controls?.target||this._lookat).clone().sub(this._camera.position).normalize();this.getExtrasContainer("get","axis")?.traverse(Fe=>{(0,b.isFunc)(Fe._axis_flip)&&Fe._axis_flip(me)})}this.ctrl.project||(0,j.Pz)(this._toplevel,pe,this.ctrl.depthMethod,this._clones)}}render3D(W,pe){if(!this._renderer)return this.did_cleanup?console.warn("try to render after cleanup"):console.warn("renderer object not exists - check code"),this;const me=void 0!==W&&W>0&&"nopromise"!==pe;if(void 0===W&&(W=5),W>0&&this._webgl)return this.isBatchMode()&&(W=1),me?new Promise(Et=>{this._render_resolveFuncs||(this._render_resolveFuncs=[]),this._render_resolveFuncs.push(Et),this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),W))}):(this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),W)),this);this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),(0,x.rv)(this._renderer);const Fe=new Date;this._adjust_camera_with_render&&(this.adjustCameraPosition("only_set"),delete this._adjust_camera_with_render),this.testCameraPosition(-1===W),this._webgl&&this._effectComposer&&this._effectComposer.passes.length>0?this._effectComposer.render():this._webgl&&this._bloomComposer&&this._bloomComposer.passes.length>0?(this._renderer.clear(),this._camera.layers.set(1),this._bloomComposer.render(),this._renderer.clearDepth(),this._camera.layers.set(0),this._renderer.render(this._scene,this._camera)):this._renderer.render(this._scene,this._camera);const At=new Date;if(this.last_render_tm=At.getTime(),0===this.first_render_tm&&!0===pe&&(this.first_render_tm=At.getTime()-Fe.getTime(),this.first_render_tm>500&&console.log(`three.js r${z.sPf}, first render tm = ${this.first_render_tm}`)),(0,x.oE)(this._renderer),this._render_resolveFuncs){const Et=this._render_resolveFuncs;delete this._render_resolveFuncs,Et.forEach(St=>St(this))}}startWorker(){this._worker||(this._worker_ready=!1,this._worker_jobs=0,this._worker=new Worker(b.source_dir+"scripts/geoworker.js"),this._worker.onmessage=W=>{if((0,b.isObject)(W.data)){if("log"in W.data)return console.log(`geo: ${W.data.log}`);if("progress"in W.data)return(0,xe.Rh)(W.data.progress);W.data.tm3=(new Date).getTime(),"init"in W.data?(this._worker_ready=!0,console.log("Worker ready: "+(W.data.tm3-W.data.tm0))):this.processWorkerReply(W.data)}},this._worker.postMessage({init:!0,browser:b.browser,tm0:(new Date).getTime(),vislevel:this._clones.getVisLevel(),maxvisnodes:this._clones.getMaxVisNodes(),clones:this._clones.nodes,sortmap:this._clones.sortmap}))}canSubmitToWorker(W){return!!this._worker&&this._worker_ready&&(0===this._worker_jobs||W)}submitToWorker(W){if(!this._worker)return!1;this._worker_jobs++,W.tm0=(new Date).getTime(),this._worker.postMessage(W)}processWorkerReply(W){if(this._worker_jobs--,"collect"in W)return this._new_draw_nodes=W.new_nodes,this._draw_all_nodes=W.complete,this.changeStage(3),this.continueDraw();if("shapes"in W){for(let pe=0;pe<W.shapes.length;++pe){const me=W.shapes[pe],Fe=this._build_shapes[pe];me.buf_pos&&me.buf_norm&&(0===me.buf_pos.length?Fe.geom=null:me.buf_pos.length!==me.buf_norm.length?(console.error(`item.buf_pos.length ${me.buf_pos.length} !== item.buf_norm.length ${me.buf_norm.length}`),Fe.geom=null):(Fe.geom=new z.LoY,Fe.geom.setAttribute("position",new z.THS(me.buf_pos,3)),Fe.geom.setAttribute("normal",new z.THS(me.buf_norm,3))),Fe.ready=!0,Fe.nfaces=me.nfaces)}return W.tm4=(new Date).getTime(),this.changeStage(7),this.continueDraw()}}testGeomChanges(){if(this._main_painter)return console.warn("Get testGeomChanges call for slave painter"),this._main_painter.testGeomChanges();this.startDrawGeometry();for(let W=0;W<this._slave_painters.length;++W)this._slave_painters[W].startDrawGeometry()}drawAxesAndOverlay(W){const pe=this.drawAxes(),me=this.drawOverlay();return pe||me?this.changedDepthMethod(W?"norender":void 0):W?null:this.render3D()}drawOverlay(){if(this.getExtrasContainer("delete","overlay"),!this.isOrthoCamera()||"none"===this.ctrl.camera_overlay)return!1;const W=.5/this._camera.zoom,pe=(this._camera.left+this._camera.right)/2,me=(this._camera.bottom+this._camera.top)/2,Fe=pe-(this._camera.right-this._camera.left)*W,At=pe+(this._camera.right-this._camera.left)*W,Et=me-(this._camera.top-this._camera.bottom)*W,St=me+(this._camera.top-this._camera.bottom)*W,xt=.02*(St-Et),En=.015*(St-Et),jt=.001*(St-Et),Cn=Fe+5*En,ln=At-5*En,Un=Et+3*En,Ci=St-3*En,Rn=new F.TB(null,(0,b.create)(b.clTAxis));Rn.configureAxis("xaxis",Cn,ln,Cn,ln,!1,[Cn,ln],{log:0,reverse:!1});const si=new F.TB(null,(0,b.create)(b.clTAxis));si.configureAxis("yaxis",Un,Ci,Un,Ci,!1,[Un,Ci],{log:0,reverse:!1});const Fn=this._camera.orthoIndicies??[0,1,2];let Zt,tr,Ne=0,$=0;this._camera.orthoZ&&($=Ne=this._camera.orthoZ[0]);const S=($e,nt,rt)=>{Zt[tr+Fn[0]]=$e,Zt[tr+Fn[1]]=nt,Zt[tr+Fn[2]]=rt??$,tr+=3},Z=($e,nt)=>{const rt=new ke._l($e,{font:x.Te,size:nt,height:0,curveSegments:5});return rt.computeBoundingBox(),rt._width=rt.boundingBox.max.x-rt.boundingBox.min.x,rt._height=rt.boundingBox.max.y-rt.boundingBox.min.y,rt.translate(-rt._width/2,-rt._height/2,0),this._camera.orthoSign<0&&rt.rotateY(Math.PI),(0,b.isFunc)(this._camera.orthoRotation)&&this._camera.orthoRotation(rt),rt},Ae=($e,nt,rt,ct,zt)=>{const at=[0,0,0];at[Fn[0]]=rt,at[Fn[1]]=ct,at[Fn[2]]=zt??$;const nn=new z.eaF($e,nt);return nn.translateX(at[0]).translateY(at[1]).translateZ(at[2]),nn};if("bar"===this.ctrl.camera_overlay){const $e=this.getExtrasContainer("create","overlay");let nt=.15*Fe+.85*At,rt=.05*Fe+.95*At;const ct=.9*St+.1*Et,zt=.86*St+.14*Et,at=Rn.createTicks();at.major?.length>1&&(nt=at.major[at.major.length-2],rt=at.major[at.major.length-1]),Zt=new Float32Array(18),tr=0,S(nt,ct,Ne),S(nt,zt,Ne),S(nt,(ct+zt)/2,Ne),S(rt,(ct+zt)/2,Ne),S(rt,ct,Ne),S(rt,zt,Ne);const nn=new z.mrM({color:"green"}),Wt=new z.V9B({color:"green",vertexColors:!1});$e.add((0,x.Fc)(Zt,nn));const gn=Z(Rn.format(rt-nt,!0),Math.abs(zt-ct));return $e.add(Ae(gn,Wt,(rt+nt)/2,(ct+zt)/2+.8*gn._height,Ne)),!0}const Ce=0===this.ctrl.camera_overlay.indexOf("grid");if(Ce&&this._camera.orthoZ&&("gridf"===this.ctrl.camera_overlay?$+=this._camera.orthoSign*this._camera.orthoZ[1]:"gridb"===this.ctrl.camera_overlay&&($-=this._camera.orthoSign*this._camera.orthoZ[1])),"axis"===this.ctrl.camera_overlay||Ce){const $e=this.getExtrasContainer("create","overlay"),nt=new z.mrM({color:new z.Q1f("black")}),rt=Ce?new z.mrM({color:new z.Q1f(12303291)}):null,ct=Ce?new z.Fvt({color:new z.Q1f(14540253),dashSize:jt,gapSize:jt}):null,zt=new z.V9B({color:"black",vertexColors:!1}),at=Rn.createTicks();for(;at.next();){const Wt=at.tick,gn=1===at.kind?1:.6;if(Ce&&(Zt=new Float32Array(6),tr=0,S(Wt,St-gn*xt-jt),S(Wt,Et+gn*xt+jt),$e.add((0,x.Fc)(Zt,1===at.kind?rt:ct))),Zt=new Float32Array(12),tr=0,S(Wt,St),S(Wt,St-gn*xt),S(Wt,Et),S(Wt,Et+gn*xt),$e.add((0,x.Fc)(Zt,nt)),1!==at.kind)continue;const ze=Z(Rn.format(Wt,!0),En);$e.add(Ae(ze,zt,Wt,St-xt-En/2-ze._height/2)),$e.add(Ae(ze,zt,Wt,Et+xt+En/2+ze._height/2))}const nn=si.createTicks();for(;nn.next();){const Wt=nn.tick,gn=1===nn.kind?1:.6;if(Ce&&(Zt=new Float32Array(6),tr=0,S(Fe+gn*xt+jt,Wt),S(At-gn*xt-jt,Wt),$e.add((0,x.Fc)(Zt,1===nn.kind?rt:ct))),Zt=new Float32Array(12),tr=0,S(Fe,Wt),S(Fe+gn*xt,Wt),S(At,Wt),S(At-gn*xt,Wt),$e.add((0,x.Fc)(Zt,nt)),1!==nn.kind)continue;const ze=Z(si.format(Wt,!0),En);$e.add(Ae(ze,zt,Fe+xt+En/2+ze._width/2,Wt)),$e.add(Ae(ze,zt,At-xt-En/2-ze._width/2,Wt))}return!0}return!1}drawAxes(){if(this.getExtrasContainer("delete","axis"),!this.ctrl._axis)return!1;const W=this.getGeomBoundingBox(this._toplevel,this.superimpose?"original":void 0),pe=this.getExtrasContainer("create","axis"),me=.02*Math.max(W.max.x-W.min.x,W.max.y-W.min.y,W.max.z-W.min.z),Fe=[0,0,0],At=["x","y","z"],Et=["X","Y","Z"],St=["red","green","blue"],xt=this.isOrthoCamera(),En=this.ctrl.camera_kind??"perspective";if(2===this.ctrl._axis)for(let jt=0;jt<3;++jt){const Cn=At[jt];W.min[Cn]<=0&&W.max[Cn]>=0||(Fe[jt]=(W.min[Cn]+W.max[Cn])/2)}for(let jt=0;jt<3;++jt){let Ne=function(Z,Ae){Z._other_side=!1,Z._axis_norm=Ae??new z.Pq0(1,0,0),Z._axis_flip=function(Ce){const $e=Ce.dot(this._axis_norm)<0;this._other_side!==$e&&(this._other_side=$e,this.rotateY(Math.PI))}},$=function(Z,Ae=-1){Z._last_angle=Ae,Z._axis_flip=function(Ce){let $e=0;switch(this._axis_name){case"x":$e=-Math.atan2(Ce.y,Ce.z);break;case"y":$e=-Math.atan2(Ce.z,Ce.x);break;default:$e=Math.atan2(Ce.y,Ce.x)}$e=Math.round($e/Math.PI*2+2)%4,this._last_angle!==$e&&(this.rotateX(($e-this._last_angle)*Math.PI/2),this._last_angle=$e)}};if(xt&&En.indexOf(Et[jt])<0)continue;const Cn=new Float32Array(6),ln=St[jt],Un=At[jt],Ci=Z=>{if(!Z)return"0";const Ae=Math.log10(Math.abs(Z));if(Ae<0){if(Ae>-1)return Z.toFixed(2);if(Ae>-2)return Z.toFixed(3)}else{if(Ae<2)return Z.toFixed(1);if(Ae<4)return Z.toFixed(0)}return Z.toExponential(2)},Rn=Ci(W.max[Un])+" "+Et[jt];switch(Cn[0]=W.min.x,Cn[1]=W.min.y,Cn[2]=W.min.z,Cn[3]=W.min.x,Cn[4]=W.min.y,Cn[5]=W.min.z,jt){case 0:Cn[3]=W.max.x;break;case 1:Cn[4]=W.max.y;break;case 2:Cn[5]=W.max.z}if(2===this.ctrl._axis)for(let Z=0;Z<6;++Z)Z%3!==jt&&(Cn[Z]=Fe[Z%3]);const si=new z.mrM({color:ln});let Fn=(0,x.Fc)(Cn,si);Fn._no_clip=!0,pe.add(Fn);const Zt=new z.V9B({color:ln,vertexColors:!1});if(0===Fe[jt]&&Fe[jt]>=W.min[Un]&&Fe[jt]<=W.max[Un]&&(2!==this.ctrl._axis||0===jt)){const Z=xt?new z.tcD(.25*me):new z.Gu$(.25*me);Fn=new z.eaF(Z,Zt),Fn.translateX(0===jt?Fe[0]:Cn[0]),Fn.translateY(1===jt?Fe[1]:Cn[1]),Fn.translateZ(2===jt?Fe[2]:Cn[2]),Fn._no_clip=!0,pe.add(Fn)}let tr=new ke._l(Rn,{font:x.Te,size:me,height:0,curveSegments:5});Fn=new z.eaF(tr,Zt),Fn._no_clip=!0;let S=(new z.NRn).setFromObject(Fn);if(tr.translate(.5*-S.max.x,-S.max.y/2,0),Fn.translateX(Cn[3]),Fn.translateY(Cn[4]),Fn.translateZ(Cn[5]),Fn._axis_name=Un,0===jt)xt&&En.indexOf("OX")>0?$(Fn,0):(xt?En.indexOf("OY")>0:this.ctrl._yup)?Ne(Fn,new z.Pq0(0,0,-1)):(Ne(Fn,new z.Pq0(0,1,0)),Fn.rotateX(Math.PI/2)),Fn.translateX(.5*me+.5*S.max.x);else if(1===jt)(xt?En.indexOf("OY")>0:this.ctrl._yup)?($(Fn,2),Fn.rotateX(-Math.PI/2),Fn.rotateY(-Math.PI/2),Fn.translateX(.5*me+.5*S.max.x)):(Ne(Fn),Fn.rotateX(Math.PI/2),Fn.rotateY(-Math.PI/2),Fn.translateX(.5*-S.max.x-.5*me));else if(2===jt){if(xt?En.indexOf("OZ")<0:this.ctrl._yup){const Z=xt&&(En.indexOf("ZOX")>0||En.indexOf("ZNOX")>0);Ne(Fn,Z?new z.Pq0(0,-1,0):void 0),Fn.rotateY(-Math.PI/2),Z&&Fn.rotateX(-Math.PI/2)}else $(Fn),Fn.rotateX(Math.PI/2),Fn.rotateZ(Math.PI/2);Fn.translateX(.5*me+.5*S.max.x)}if(pe.add(Fn),tr=new ke._l(Ci(W.min[Un]),{font:x.Te,size:me,height:0,curveSegments:5}),Fn=new z.eaF(tr,Zt),Fn._no_clip=!0,S=(new z.NRn).setFromObject(Fn),tr.translate(.5*-S.max.x,-S.max.y/2,0),Fn._axis_name=Un,Fn.translateX(Cn[0]),Fn.translateY(Cn[1]),Fn.translateZ(Cn[2]),0===jt)xt&&En.indexOf("OX")>0?$(Fn,0):(xt?En.indexOf("OY")>0:this.ctrl._yup)?Ne(Fn,new z.Pq0(0,0,-1)):(Ne(Fn,new z.Pq0(0,1,0)),Fn.rotateX(Math.PI/2)),Fn.translateX(.5*-me-.5*S.max.x);else if(1===jt)(xt?En.indexOf("OY")>0:this.ctrl._yup)?($(Fn,2),Fn.rotateX(-Math.PI/2),Fn.rotateY(-Math.PI/2),Fn.translateX(.5*-S.max.x-.5*me)):(Ne(Fn),Fn.rotateX(Math.PI/2),Fn.rotateY(-Math.PI/2),Fn.translateX(.5*S.max.x+.5*me));else if(2===jt){if(xt?En.indexOf("OZ")<0:this.ctrl._yup){const Z=xt&&(En.indexOf("ZOX")>0||En.indexOf("ZNOX")>0);Ne(Fn,Z?new z.Pq0(0,-1,0):void 0),Fn.rotateY(-Math.PI/2),Z&&Fn.rotateX(-Math.PI/2)}else $(Fn),Fn.rotateX(Math.PI/2),Fn.rotateZ(Math.PI/2);Fn.translateX(.5*-S.max.x-.5*me)}pe.add(Fn)}return!0}setAxesDraw(W){return this.ctrl._axis="toggle"===W?this.ctrl._axis?0:1:"number"==typeof W?W:W?1:0,this.drawAxesAndOverlay()}setAutoRotate(W){this.ctrl.project||(void 0!==W&&(this.ctrl.rotate=W),this.autorotate(2.5))}toggleWireFrame(){this.ctrl.wireframe=!this.ctrl.wireframe,this.changedWireFrame()}setWireFrame(W){this.ctrl.wireframe=!!W,this.changedWireFrame()}setShowTop(W){this.ctrl.showtop=!!W,this.redrawObject("same")}changedClipping(W=-1){(W<0||this.ctrl.clip[W]?.enabled)&&this.updateClipping(!1,!0)}changedDepthTest(){if(!this._toplevel)return;const W=this.ctrl.depthTest;this._toplevel.traverse(pe=>{pe instanceof z.eaF&&(pe.material.depthTest=W)}),this.render3D(0)}changedDepthMethod(W){if(delete this._last_camera_position,"norender"!==W)return this.render3D()}updateClipping(W,pe){if(this._renderer?.jsroot_render3d===b.constants.Render3D.SVG)return;this._clipPlanes||(this._clipPlanes=[new z.Zcv(new z.Pq0(1,0,0),0),new z.Zcv(new z.Pq0(0,this.ctrl._yup?-1:1,0),0),new z.Zcv(new z.Pq0(0,0,this.ctrl._yup?1:-1),0)]);const me=this.ctrl.clip,Fe=[-1*me[0].value,me[1].value,(this.ctrl._yup?-1:1)*me[2].value],At=this.getExtrasContainer(this.ctrl.clipVisualize?"":"delete","clipping");let Et=[],St=!1,xt=this.ctrl.clipIntersect?16:0;for(let ln=0;ln<3;++ln)if(me[ln].enabled&&(xt+=2<<ln),this._clipPlanes[ln].constant!==Fe[ln]&&(me[ln].enabled&&(St=!0),this._clipPlanes[ln].constant=Fe[ln]),me[ln].enabled&&Et.push(this._clipPlanes[ln]),At&&me[ln].enabled){const Un=new z.ZM4(this._clipPlanes[ln],me[ln].max-me[ln].min);Un._no_clip=!0,At.add(Un)}0===Et.length&&(Et=null),this._clipCfg!==xt&&(St=!0),this._clipCfg=xt;const En=!!Et,jt=this.ctrl.clipIntersect,Cn=En?z.$EB:z.hB5;return(pe||St)&&this._scene.traverse(ln=>{!ln._no_clip&&void 0!==ln.material?.clippingPlanes&&(ln.material.clippingPlanes!==Et&&(ln.material.clipIntersection=jt,ln.material.clippingPlanes=Et,ln.material.needsUpdate=!0),void 0!==ln.material.emissive&&ln.material.side!==Cn&&(ln.material.side=Cn,ln.material.needsUpdate=!0))}),this.ctrl.doubleside=En,W||this.render3D(0),St}setCompleteHandler(W){this._complete_handler=W}completeDraw(W){var pe=this;return(0,ve.A)(function*(){let me=!1,Fe=!1,At=!0;if(!pe.ctrl)return console.warn("ctrl object does not exist in completeDraw - something went wrong"),pe;let Et=Promise.resolve(!0);return pe._clones?(pe._first_drawing||pe._full_redrawing)&&pe.ctrl.tracks&&pe.geo_manager&&(Et=pe.drawExtras(pe.geo_manager.fTracks,"<prnt>/Tracks")):(At=!1,pe.getExtrasContainer("delete"),Et=pe.drawExtras((pe._main_painter?pe._main_painter._extraObjects:null)||pe._extraObjects,"",!1)),Et.then(()=>{if(pe._full_redrawing&&(pe.adjustCameraPosition("first"),pe._full_redrawing=!1,Fe=!0,pe.changedDepthMethod("norender")),pe._first_drawing&&(pe.adjustCameraPosition("first"),pe.showDrawInfo(),pe._first_drawing=!1,me=!0,Fe=!0),me&&pe.completeScene(),Fe&&(pe.ctrl.trans_radial||pe.ctrl.trans_z)&&pe.changedTransformation("norender"),Fe)return pe.drawAxesAndOverlay(!0)}).then(()=>{if(pe._scene.overrideMaterial=null,void 0!==pe._provided_more_nodes&&(pe.appendMoreNodes(pe._provided_more_nodes,!0),delete pe._provided_more_nodes),At)return pe.getExtrasContainer("delete"),pe.drawExtras(pe._main_painter?._extraObjects||pe._extraObjects,"",!1)}).then(()=>(pe.updateClipping(!0),pe.render3D(0,!0),W&&(0,xe.Rh)(),pe.addOrbitControls(),me&&!pe.isBatchMode()&&(0===pe.ctrl.highlight&&(pe.ctrl.highlight=pe.first_render_tm<1e3),0===pe.ctrl.highlight_scene&&(pe.ctrl.highlight_scene=pe.ctrl.highlight),pe._webgl&&pe.ctrl.rotate&&!pe.ctrl.project&&pe.autorotate(2.5),pe._webgl&&pe.ctrl.show_controls&&pe.showControlGui(!0)),pe.setAsMainPainter(),(0,b.isFunc)(pe._resolveFunc)&&(pe._resolveFunc(pe),delete pe._resolveFunc),(0,b.isFunc)(pe._complete_handler)&&pe._complete_handler(pe),pe._draw_nodes_again?pe.startDrawGeometry():pe._drawing_ready=!0,pe))})()}isDrawingReady(){return this._drawing_ready||!1}removeDrawnNode(W){if(!this._draw_nodes)return;const pe=[];for(let me=0;me<this._draw_nodes.length;++me){const Fe=this._draw_nodes[me];Fe.nodeid===W||this._clones.isIdInStack(W,Fe.stack)?this._clones.createObject3D(Fe.stack,this._toplevel,"delete_mesh"):pe.push(Fe)}pe.length<this._draw_nodes.length&&(this._draw_nodes=pe,this.render3D())}cleanup(W){if(!W){let pe=0;if(!this.superimpose){if(this.clearTopPainter(),this._on_pad){const Fe=this.getFramePainter();Fe?.mode3d&&(Fe.clear3dCanvas(),Fe.mode3d=!1)}else pe=this.clear3dCanvas();(0,x.G1)(this._scene)}this._toolbar?.cleanup(),(0,x.G1)(this._full_geom),this._controls?.cleanup(),this._context_menu&&this._renderer.domElement.removeEventListener("contextmenu",this._context_menu,!1),this._gui?.destroy(),this._worker?.terminate(),delete this._animating;const me=this.getGeometry();if(me&&this.ctrl.is_main&&(me.$geo_painter===this?delete me.$geo_painter:me.fVolume?.$geo_painter===this&&delete me.fVolume.$geo_painter),this._main_painter?._slave_painters){const Fe=this._main_painter._slave_painters.indexOf(this);Fe>=0&&this._main_painter._slave_painters.splice(Fe,1)}for(let Fe=0;Fe<this._slave_painters?.length;++Fe){const At=this._slave_painters[Fe];At?._main_painter===this&&(At._main_painter=null)}delete this.geo_manager,delete this._highlight_handlers,super.cleanup(),delete this.ctrl,delete this.options,this.did_cleanup=!0,pe<0&&this.selectDom().html("")}if(this._slave_painters)for(const pe in this._slave_painters){const me=this._slave_painters[pe];me._main_painter=null,me._clones===this._clones&&(me._clones=null)}this._main_painter=null,this._slave_painters=[],this._render_resolveFuncs&&(this._render_resolveFuncs.forEach(pe=>pe(this)),delete this._render_resolveFuncs),this.superimpose||(0,x.yW)(this._renderer),this.ensureBloom(!1),delete this._effectComposer,delete this._scene,delete this._scene_size,this._scene_width=0,this._scene_height=0,this._renderer=null,this._toplevel=null,delete this._full_geom,delete this._fog,delete this._camera,delete this._camera0pos,delete this._lookat,delete this._selected_mesh,this._clones&&this._clones_owner&&this._clones.cleanup(this._draw_nodes,this._build_shapes),delete this._clones,delete this._clones_owner,delete this._draw_nodes,delete this._drawing_ready,delete this._build_shapes,delete this._new_draw_nodes,delete this._new_append_nodes,delete this._last_camera_position,this.first_render_tm=0,this.last_render_tm=0,this.changeStage(0,"cleanup"),delete this.drawing_log,delete this._gui,delete this._controls,delete this._context_menu,delete this._toolbar,delete this._worker}performResize(W,pe){return!(this._scene_width===W&&this._scene_height===pe||W<10||pe<10||(this._scene_width=W,this._scene_height=pe,this._camera&&this._renderer&&(this._camera.isPerspectiveCamera?this._camera.aspect=this._scene_width/this._scene_height:this._camera.isOrthographicCamera&&this.adjustCameraPosition(!0,!0),this._camera.updateProjectionMatrix(),this._renderer.setSize(this._scene_width,this._scene_height,!this._fit_main_area),this._effectComposer?.setSize(this._scene_width,this._scene_height),this._bloomComposer?.setSize(this._scene_width,this._scene_height),this.isStage(0)&&this.render3D()),0))}checkResize(W){const pe=this.getCanvPainter();if(pe&&!pe.checkCanvasResize(W))return!1;const me=this.getSizeFor3d();return this.performResize(me.width,me.height)}toggleEnlarge(){this.enlargeMain("toggle")&&this.checkResize()}accessObjectWireFrame(W,pe){if(W?.material)return void 0!==pe&&W.stack&&(W.material.wireframe=pe),W.material.wireframe}changedWireFrame(){this._scene?.traverse(W=>this.accessObjectWireFrame(W,this.ctrl.wireframe)),this.render3D()}updateObject(W){if("same"===W||!W?._typename)return!1;if(W===this.getObject())return!0;let pe;return W._typename===m&&(pe=W,W=W.fMasterVolume),0===W._typename.indexOf(b.clTGeoVolume)&&(W={_typename:b.clTGeoNode,fVolume:W,fName:W.fName,$geoh:W.$geoh,_proxy:!0}),this.geo_manager&&pe?(this.geo_manager=pe,this.assignObject(W),this._did_update=!0,!0):!!this.matchObjectType(W._typename)&&(this.assignObject(W),this._did_update=!0,!0)}clearDrawings(){this._clones&&this._clones_owner&&this._clones.cleanup(this._draw_nodes,this._build_shapes),delete this._clones,delete this._clones_owner,delete this._draw_nodes,delete this._drawing_ready,delete this._build_shapes,delete this._extraObjects,delete this._clipCfg,(0,x.G1)(this._toplevel,!0),this._full_redrawing=!0}redraw(){if(this.superimpose){const me=We(this.getMainPainter());me&&(this._toplevel.scale.set(me.scale_x??1,me.scale_y??1,me.scale_z??1),this._toplevel.position.set(me.offset_x??0,me.offset_y??0,me.offset_z??0),this._toplevel.updateMatrix(),this._toplevel.updateMatrixWorld())}if(this._did_update)return this.startRedraw();const W=this._on_pad?this.getFramePainter():null;if(!W)return Promise.resolve(!1);const pe=W.getSizeFor3d(W.access3dKind());return W.apply3dSize(pe),this.performResize(pe.width,pe.height)}redrawObject(W,pe){return!!this.updateObject(W,pe)&&this.startRedraw()}startRedraw(W){if(W)return this._redraw_timer&&clearTimeout(this._redraw_timer),void(this._redraw_timer=setTimeout(()=>this.startRedraw(),W));delete this._redraw_timer,delete this._did_update,this.clearDrawings();const pe=this.getGeometry();return this.prepareObjectDraw(pe,this.geo_manager?pe.fName:"")}static draw(W,pe,me){return(0,ve.A)(function*(){if(!pe)return null;let Fe=null,At=null,Et="",St=!1;if("fShapeBits"in pe&&"fShapeId"in pe?(Fe=pe,pe=null):pe._typename===R||pe._typename===b.clTGeoVolume?Fe=pe.fShape:pe._typename===I||pe._typename===_e?(Fe=pe.fShape,St=!0):pe._typename===m?Fe=pe.fMasterVolume.fShape:pe._typename===A?(At=pe.fMarker,Et="<prnt>/Marker",pe=function be(wt){const W=(0,b.create)(b.clTGeoVolume);(0,j.bg)(W,j.Wv.kVisDaughters,!0),W.$geoh=!0,W.fName="";const pe=(0,b.create)(b.clTGeoNodeMatrix);pe.fName=wt.fVolume1.fName||"Overlap1",pe.fMatrix=wt.fMatrix1,pe.fVolume=wt.fVolume1;const me=(0,b.create)(b.clTGeoNodeMatrix);return me.fName=wt.fVolume2.fName||"Overlap2",me.fMatrix=wt.fMatrix2,me.fVolume=wt.fVolume2,W.fNodes=(0,b.create)(b.clTList),W.fNodes.Add(pe),W.fNodes.Add(me),W}(pe),me||(me="wire")):"fVolume"in pe?pe.fVolume&&(Fe=pe.fVolume.fShape):pe=null,(0,b.isStr)(me)&&0===me.indexOf("comp")&&Fe&&Fe._typename===j.HO&&Fe.fNode){let En=1;"x"===(me=me.slice(4))[0]&&(En=999,me=me.slice(1)+"_vislvl999"),pe=Pe(Fe,En)}if(!pe&&Fe&&(pe=Object.assign((0,b.create)(b.clTNamed),{_typename:I,fTrans:null,fShape:Fe,fRGBA:[0,1,0,1],fElements:null,fRnrSelf:!0})),!pe)return null;const xt=Hn(W,pe,me);return xt.ctrl.is_main&&!pe.$geo_painter&&(pe.$geo_painter=xt),!xt.ctrl.is_main&&xt.ctrl.project&&pe.$geo_painter&&(xt._main_painter=pe.$geo_painter,xt._main_painter._slave_painters.push(xt)),St&&(!xt.ctrl.vislevel||xt.ctrl.vislevel<9)&&(xt.ctrl.vislevel=9),At&&(xt._splitColors=!0,xt.addExtra(At,Et)),xt.loadMacro(xt.ctrl.script_name).then(En=>xt.prepareObjectDraw(En.obj,En.prefix))})()}}let yn=!1;function Tn(){function wt(W,pe){return`.jsroot .img_${W} { display: inline-block; height: 16px; width: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQ${pe}'); }`}!yn&&(0,b.isFunc)(b.internals.addDrawFunc)&&(yn=!0,b.internals.addDrawFunc({name:J,icon_get:ai,icon_click:hi}),b.internals.addDrawFunc({name:k,icon_get:ai,icon_click:hi})),(0,xe.fz)(`\n${wt("geoarb8","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB1SURBVBjTdY6rEYAwEETTy6lzK8/Fo+Jj18dTAjUgaQGfGiggtRDE8RtY93Zu514If2nzk2ux9c5TZkwXbiWTUavzws69oBfpYBrMT4r0Jhsw+QfRgQSw+CaKRsKsnV+SaF8MN49RBSgPUxO85PMl5n4tfGUH2gghs2uPAeQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geocombi","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAlUlEQVQoz5VQMQ4CMQyzEUNnBqT7Bo+4nZUH8gj+welWJsQDkHoCEYakTXMHSFiq2jqu4xRAEl2A7w4myWzpzCSZRZ658ldKu1hPnFsequBIc/hcLli3l52MAIANtpWrDsv8waGTW6BPuFtsdZArXyFuj33TQpazGEQF38phipnLgItxRcAoOeNpzv4PTXnC42fb//AGI5YqfQAU8dkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geocone","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACRSURBVBjTdY+xDcNACEVvEm/ggo6Olva37IB0C3iEzJABvAHFTXBDeJRwthMnUvylk44vPjxK+afeokX0flQhJO7L4pafSOMxzaxIKc/Tc7SIjNLyieyZSjBzc4DqMZI0HTMonWPBNlogOLeuewbg9c0hOiIqH7DKmTCuFykjHe4XOzQ58XVMGxzt575tKzd6AX9yMkcWyPlsAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geogtra","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACCSURBVBjTVc+hDQMxDAVQD1FyqCQk0MwsCwQEG3+eCW6B0FvheDboFMGepTlVitPP/Cz5y0S/mNkw8pySU9INJDDH4vM4Usm5OrQXasXtkA+tQF+zxfcDY8EVwgNeiwmA37TEccK5oLOwQtuCj7BM2Fq7iGrxVqJbSsH+GzXs+798AThwKMh3/6jDAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geomedium","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABVQTFRFAAAAAAAAMDAww8PDWKj/////gICAG0/C4AAAAAF0Uk5TAEDm2GYAAAABYktHRAX4b+nHAAAACXBIWXMAAABIAAAASABGyWs+AAAAXElEQVQI102MwRGAMAgEuQ6IDwvQCjQdhAl/H7ED038JHhkd3dcOLAgESFARaAqnEB3yrj6QSEym1RbbOKinN+8q2Esui1GaX7VXSi4RUbxHRbER8X6O5Pg/fLgBBzMN8HfXD3AAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geopara","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABtSURBVBjTY2DADq5MT7+CzD9kaKjp+QhJYIWqublhMbKAgpOnZxWSQJdsVJTndCSBKoWoAM/VSALpqlEBAYeQBKJAAsi2BGgCBZDdEWUYFZCOLFBlGOWJ7AyGFeaotjIccopageK3R12PGHABACTYHWd0tGw6AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("georotation","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAiklEQVQoz2NgYGBgYGDg+A/BmIAFIvyDEbs0AwMTAwHACLPiB5QVBTdpGSOSCZjScDcgc4z+32BgYGBgEGIQw3QDLkdCTZD8/xJFeBfDVxQT/j9n/MeIrMCNIRBJwX8GRuzGM/yHKMAljeILNFOuMTyEisEUMKIqucrwB2oyIhyQpH8y/MZrLWkAAHFzIHIc0Q5yAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotranslation","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABESURBVBjTY2DgYGAAYzjgAAIQgSLAgSwAAcrWUUCAJBAVhSpgBAQumALGCJPAAsriHIS0IAQ4UAU4cGphQBWwZSAOAADGJBKdZk/rHQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geotrd2","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABsSURBVBjTbY+xDcAwCARZx6UraiaAmpoRvIIb75PWI2QITxIiRQKk0CCO/xcA/NZ9LRs7RkJEYg3QxczUwoGsXiMAoe8lAelqRWFNKpiNXZLAalRDd0f3TMgeMckABKsCDmu+442RddeHz9cf9jUkW8smGn8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geovolume","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAB5QTFRFAAAAMDAw///Ay8uc/7+Q/4BgmJh4gIDgAAD/////CZb2ugAAAAF0Uk5TAEDm2GYAAAABYktHRAnx2aXsAAAACXBIWXMAAABIAAAASABGyWs+AAAAR0lEQVQI12NggAEBIBAEQgYGQUYQAyIGIhgwAZMSGCgwMJuEKimFOhswsKWAGG4JDGxJIBk1EEO9o6NIDVkEpgauC24ODAAASQ8Pkj/retYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geoassembly","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAA9QTFRFAAAAMDAw/wAAAAD/////jEo0BQAAAAF0Uk5TAEDm2GYAAAABYktHRASPaNlRAAAACXBIWXMAAABIAAAASABGyWs+AAAAOklEQVQI12NggAFGRgEgEBRgEBSAMhgYGQQEgAR+oARGDIwCIAYjUL0A2DQQg9nY2ABVBKoGrgsDAADxzgNboMz8zQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geocomposite","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABuSURBVBjTY2AgF2hqgQCCr+0V4O7hFmgCF7CJyKysKkmxhfGNLaw9SppqAi2gfMuY5Agrl+ZaC6iAUXRJZX6Ic0klTMA5urapPFY5NRcmYKFqWl8S5RobBRNg0PbNT3a1dDGH8RlM3LysTRjIBwAG6xrzJt11BAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geoctub","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACESURBVBjTdc+xDcMwDARA7cKKHTuWX37LHaw+vQbQAJomA7j2DB7FhCMFCZB8pxPwJEv5kQcZW+3HencRBekak4aaMQIi8YJdAQ1CMeE0UBkuaLMETklQ9Alhka0JzzXWqLVBuQYPpWcVuBbZjZafNRYcDk9o/b07bvhINz+/zxu1/M0FSRcmAk/HaIcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geohype","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACKSURBVBjTbU+rFQQhDKQSDDISEYuMREfHx6eHKMpYuf5qoIQt5bgDblfcuJk3nySEhSvceDV3c/ejT66lspopE9pXyIlkCrHMBACpu1DClekQAREi/loviCnF/NhRwJLaQ6hVhPjB8bOCsjlnNnNl0FWJVWxAqGzHONRHpu5Ml+nQ+8GzNW9n+Is3eg80Nk0iiwoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geomixture","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAACFQTFRFAAAAAAAAKysrVVUA//8B//8AgICAqqpV398gv79A////VYJtlwAAAAF0Uk5TAEDm2GYAAAABYktHRApo0PRWAAAACXBIWXMAAABIAAAASABGyWs+AAAAXklEQVQI12NgwASCQsJCgoZAhoADq1tKIJAhEpDGxpYIZKgxsLElgBhibAkOCY4gKTaGkPRGIEPUIYEBrEaAIY0tDawmgYWNgREkkjCVjRWkWCUhLY0FJCIIBljsBgCZTAykgaRiRwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geopcon","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACJSURBVBjTdc+hGcQwCIZhhjl/rkgWiECj8XgGyAbZoD5LdIRMkEnKkV575n75Pp8AgLU54dmh6mauelyAL2Qzxfe2sklioq6FacFAcRFXYhwJHdU5rDD2hEYB/CmoJVRMiIJqgtENuoqA8ltAlYAqRH4d1tGkwzTqN2gA7Nv+fUwkgZ/3mg34txM+szzATJS1HQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geosphere","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACFSURBVBjTdY+xEcQwCAQp5QNFjpQ5vZACFBFTADFFfKYCXINzlUAJruXll2ekxDAEt9zcANFbXb2mqm56dxsymAH0yccAJaeNi0h5QGyfxGJmivMPjj0nmLsbRmyFCss3rlbpcUjfS8wLUNRcJyCF6uqg2IvYCnoKC7f1kSbA6riTz7evfwj3Ml+H3KBqAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotrap","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB5SURBVBjTbY+hFYAwDETZB1OJi4yNPp0JqjtAZ2AELL5DdABmIS2PtLxHXH7u7l2W5W+uHMHpGiCHLYR1yw4SCZMIXBOJWVSjK7QDDAu4g8OBmAKK4sAEDdR3rw8YmcUcrEijKKhl7lN1IQPn9ExlgU6/WEyc75+5AYK0KY5oHBDfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotubeseg","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACBSURBVBjTdc+hEcQwDARA12P6QFBQ9LDwcXEVkA7SQTr4BlJBakgpsWdsh/wfux3NSCrlV86Mlrxmz1pBWq3bAHwETohxABVmDZADQp1BE+wDNnGywzHgmHDOreJNTDH3Xn3CVX0dpu2MHcIFBkYp/gKsQ8SCQ72V+36/+2aWf3kAQfgshnpXF0wAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geoxtru","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABcSURBVBjTY2AgEmhpeZV56vmWwQW00QUYwAJlSAI6XmVqukh8PT1bT03PchhXX09Pr9wQIQDiJ+ZowgWAXD3bck+QQDlCQTkDQgCoxA/ERBKwhbDglgA1lDMQDwCc/Rvq8nYsWgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geobbox","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTVc+hEYAwDAXQLlNRF1tVGxn9NRswQiSSCdgDyQBM0FlIIb2WuL77uf6E8E0N02wKYRwDciTKREVvB04GuZSyOMCABRB1WGzF3uDNQTvs/RcDtJXT4fSEXA5XoiQt0ttVSm8Co2psIOvoimjAOqBmFtH5wEP2373TPIvTK1nrpULXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geoconeseg","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB4SURBVBjTdc6hEcAgDAXQbFNZXHQkFlkd/30myAIMwAws0gmYpVzvoFyv/S5P/B+izzQ387ZA2pkDnvsU1SQLVIFrOM4JFmEaYp2gCQbmPEGODhJ8jt7Am47hwgrzInGAifa/elUZnQLY00iU30BZAV+BWi2VfnIBv1osbHH8jX0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geoeltu","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTdY+hFYUwDEU7xq9CIXC4uNjY6KczQXeoYgVMR2ABRmCGjvIp/6dgiEruueedvBDuOR57LQnKyc8CJmKO+N8bieIUPtmBWjIIx8XDBHYCipsnql1g2D0UP2OoDqwBncf+RdZmzFMHizRjog7KZYzawd4Ay93lEAPWR7WAvNbwMl/XwSxBV8qCjgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geomaterial","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAbElEQVQoz62QMRbAIAhDP319Xon7j54qHSyCtaMZFCUkRjgDIdRU9yZUCfg8ut5aAHdcxtoNurmgA3ABNKIR9KimhSukPe2qxcCYC0pfFXx/aFWo7i42KKItOpopqvvnLzJmtlZTS7EfGAfwAM4EQbLIGV0sAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geoparab","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTbY+xDYAwDAQ9UAp3X7p0m9o9dUZgA9oMwAjpMwMzMAnYBAQSX9mn9+tN9KOtzsWsLOvYCziUGNX3nnCLJRzKPgeYrhPW7FJNLUB3YJazYKQKTnBaxgXRzNmJcrt7XCHQp9kEB1wfELEir/KGj4Foh8A+/zW1nf51AFabKZuWK+mNAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geopgon","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABwSURBVBjTY2AgDlwAAzh3sX1sPRDEeuwDc+8V2dsHgQQ8LCzq74HkLSzs7Yva2tLt7S3sN4MNiDUGKQmysCi6BzWkzcI+PdY+aDPCljZlj1iFOUjW1tvHLjYuQhJIt5/DcAFZYLH9YnSn7iPST9gAACbsJth21haFAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotorus","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTjY+hFcMwDEQ9SkFggXGIoejhw+LiGkBDlHoAr+AhgjNL5byChuXeE7gvPelUyjOds/f5Zw0ggfj5KVCPMBWeyx+SbQ1XUriAC2XfpWWxjQQEZasRtRHiCUAj3qN4JaolUJppzh4q7dUTdHFXW/tH9OuswWm3nI7tc08+/eGLl758ey9KpKrNOQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geotrd1","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTbc6xDQMhDAVQ9qH6lUtal65/zQ5IDMAMmYAZrmKGm4FJzlEQQUo+bvwkG4fwm9lbodV7w40Y4WGfSxQiXiJlQfZOjWRb8Ioi3tKuBQMCo7+9N72BzPsfAuoTdUP9QN8wgOQwvsfWmHzpeT5BKydMNW0nhJGvGf7mAc5WKO9e5N2dAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotube","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTRc+tEcAwCAXgLFNbWeSzSDQazw5doWNUZIOM0BEyS/NHy10E30HyklKvWnJ+0le3sJoKn3X2z7GRuvG++YRyMMDt0IIKUXMzxbnugJi5m9K1gNnGBOUFElAWGMaKIKI4xoQggl00gT+A9hXWgDwnfqgsHRAx2m+8bfjfdyrx5AtsSjpwu+M2RgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("evepoints","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABJQTFRF////n4mJcEdKRDMzcEdH////lLE/CwAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAABIAAAASABGyWs+AAAAI0lEQVQI12NgIAowIpgKEJIZLiAgAKWZGQzQ9UGlWIizBQgAN4IAvGtVrTcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMDktMDJUMTU6MDQ6MzgrMDI6MDDPyc7hAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE2LTA5LTAyVDE1OjA0OjM4KzAyOjAwvpR2XQAAAABJRU5ErkJggg==")}\n${wt("evetrack","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAqElEQVQoz32RMQrCQBBFf4IgSMB0IpGkMpVHCFh7BbHIGTyVhU0K8QYewEKsbVJZaCUiPAsXV8Puzhaz7H8zs5+JUDjikLilQr5zpCRl5xMXZNScQE5gSMGaz70jjUAJcw5c3UBMTsUe+9Kzf065SbropeLXimWfDIgoab/tOyPGzOhz53+oSWcSGh7UdB2ZNKXBZdgAuUdEKJYmrEILyVgG6pE2tEHgDfe42rbjYzSHAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTA5LTAyVDE1OjA0OjQ3KzAyOjAwM0S3EQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0wOS0wMlQxNTowNDo0NyswMjowMEIZD60AAAAASUVORK5CYII=")}\n.jsroot .geovis_this { background-color: lightgreen; }\n.jsroot .geovis_daughters { background-color: lightblue; }\n.jsroot .geovis_all { background-color: yellow; }`)}function Hn(wt,W,pe){Tn(),(0,j.QL)("GradPerSegm",b.settings.GeoGradPerSegm),(0,j.QL)("CompressComp",b.settings.GeoCompressComp);const me=new dn(wt,W);return me.decodeOptions(pe),me}function ti(wt,W,pe){if(!W._geoobj)return!1;const me=W._geoobj,Fe=W._volume,At=me._typename===I||me._typename===_e;if(!Fe&&!At)return!1;wt.add("separator");const Et=(Cn,ln,Un)=>{if(ln||(ln={visible:0,hidden:0}),Un||(void 0!==ln.assign?Cn.fRnrSelf=ln.assign:Cn.fRnrSelf?ln.vis++:ln.hidden++),Cn.fElements)for(let Ci=0;Ci<Cn.fElements.arr.length;++Ci)Et(Cn.fElements.arr[Ci],ln,!1);return ln},St=Cn=>{"self"===Cn?(me.fRnrSelf=!me.fRnrSelf,W._icon=W._icon.split(" ")[0]+Ze(me),pe.updateTreeNode(W)):(Et(me,{assign:"true"===Cn},!0),pe.forEachItem(ln=>{ln._geoobj&&ln._icon&&(ln._icon=W._icon.split(" ")[0]+Ze(ln._geoobj),pe.updateTreeNode(ln))},W)),Ke(W,"testGeomChanges")},xt=Cn=>{(0,j.ZE)(Fe,Cn);const ln=W._icon.split(" ")[0]+Ze(Fe);pe.forEachItem(Un=>{W._volume===Un._volume&&(Un._icon=ln,pe.updateTreeNode(Un))}),pe.updateTreeNode(W),Ke(W,"testGeomChanges")},En=Ke(W),jt=En?pe.itemFullName(W,En):"";if(0===W._geoobj._typename.indexOf(b.clTGeoNode)&&En&&wt.add("Focus",()=>{En&&(0,b.isFunc)(En._painter?.focusOnItem)&&En._painter.focusOnItem(jt)}),At){wt.addchk(me.fRnrSelf,"Visible","self",St);const Cn=Et(me,void 0,!0);Cn.hidden+Cn.visible>0&&wt.addchk(0===Cn.hidden,"Daughters",0!==Cn.hidden?"true":"false",St)}else{const Cn=En?._painter?._clones?.findStackByName(jt),ln=Cn?En._painter._clones.getPhysNodeVisibility(Cn):null,Un=(0,j.zL)(Fe,j.Wv.kVisThis);if(wt.addchk((0,j.zL)(Fe,j.Wv.kVisNone),"Invisible",j.Wv.kVisNone,xt),Cn){const Ci=Rn=>{En._painter._clones.setPhysNodeVisibility(Cn,"off"!==Rn&&Rn),Ke(W,"testGeomChanges")};wt.add("sub:Physical vis","Physical node visibility - only for this instance"),wt.addchk(ln?.visible,"on","on",Ci,"Enable visibility of phys node"),wt.addchk(ln&&!ln.visible,"off","off",Ci,"Disable visibility of physical node"),wt.add("reset","clear",Ci,"Reset custom visibility of physical node"),wt.add("reset all","clearall",Ci,"Reset all custom settings for all nodes"),wt.add("endsub:")}wt.addchk(Un,"Logical vis",j.Wv.kVisThis,xt,"Logical node visibility - all instances"),wt.addchk((0,j.zL)(Fe,j.Wv.kVisDaughters),"Daughters",j.Wv.kVisDaughters,xt,"Logical node daugthers visibility")}return!0}function hi(wt,W){return wt._volume?((0,j.ZE)(wt._volume,wt._more&&wt._volume.fNodes?.arr?.length?j.Wv.kVisDaughters:j.Wv.kVisThis),Ue(wt._volume,W),Ke(wt,"testGeomChanges"),!1):!wt._geoobj||wt._geoobj._typename!==I&&wt._geoobj._typename!==_e?void 0!==Ke(wt)?._painter?.extraObjectVisible(W,wt,!0):(wt._geoobj.fRnrSelf=!wt._geoobj.fRnrSelf,Ue(wt._geoobj,W),Ke(wt,"testGeomChanges"),!1)}function ai(wt,W){let pe="";switch(wt._kind){case b.prROOT+k:pe="img_evetrack";break;case b.prROOT+J:case b.prROOT+b.clTPolyMarker3D:pe="img_evepoints"}return pe&&Ke(wt)?._painter?.extraObjectVisible(W,wt)&&(pe+=" geovis_this"),pe}function Xi(wt,W,pe){const me={_kind:b.prROOT+W._typename,_name:pe||(0,j.Hs)(W),_title:W.fTitle,_parent:wt,_geoobj:W,_get:xt=>(xt._geoobj&&(xt._geoobj.$geoh=!0),Promise.resolve(xt._geoobj))};let Fe,At,Et,St=!1;return"TGeoMaterial"===W._typename?me._icon="img_geomaterial":"TGeoMedium"===W._typename?me._icon="img_geomedium":"TGeoMixture"===W._typename?me._icon="img_geomixture":0===W._typename.indexOf(b.clTGeoNode)&&W.fVolume?(me._title="node:"+W._typename,W.fTitle&&(me._title+=" "+W.fTitle),Fe=W.fVolume):0===W._typename.indexOf(b.clTGeoVolume)?Fe=W:W._typename===I||W._typename===_e?(St=!0,At=W.fShape,Et=W.fElements?W.fElements.arr:null):void 0!==W.fShapeBits&&void 0!==W.fShapeId&&(At=W),Fe&&(At=Fe.fShape,Et=Fe.fNodes?Fe.fNodes.arr:null),(Fe||At||Et)&&(Fe&&(me._volume=Fe),Et?(me._more=!0,me._expand=Q):At&&At._typename===j.HO&&At.fNode&&(me._more=!0,me._shape=At,me._expand=function(xt){return Xi(xt,xt._shape.fNode.fLeft,"Left"),Xi(xt,xt._shape.fNode.fRight,"Right"),!0}),!me._title&&W._typename!==b.clTGeoVolume&&(me._title=W._typename),At?(""===me._title&&(me._title=At._typename),me._icon=(0,j.fD)(At)):me._icon=me._more?"img_geocombi":"img_geobbox",Fe?me._icon+=Ze(Fe):St&&(me._icon+=Ze(W)),me._menu=ti,me._icon_click=hi),wt._childs||(wt._childs=[]),me._name||((0,b.isStr)(wt._name)?(me._name=wt._name,me._name.lastIndexOf("s")===me._name.length-1&&(me._name=me._name.slice(0,me._name.length-1)),me._name+="_"+wt._childs.length):me._name="item_"+wt._childs.length),wt._childs.push(me),me}function Or(wt){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,ve.A)(function*(wt){const W=(0,b.create)(b.clTNamed);W._typename=j.Ce,W.fDX=1e-10,W.fDY=1e-10,W.fDZ=1e-10,W.fShapeId=1,W.fShapeBits=0,W.fOrigin=[0,0,0];const pe=Object.assign((0,b.create)(b.clTNamed),{_typename:I,fTrans:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],fShape:W,fRGBA:[0,0,0,0],fElements:null,fRnrSelf:!1}),me=wt.getPadPainter(),Fe=me?.pad?.fFillColor&&me?.pad?.fFillStyle>1e3?"bkgr_"+me.pad.fFillColor:"";return dn.draw(wt.getDom(),pe,Fe).then(At=>(At._dummy=!0,At))})).apply(this,arguments)}function ys(){const wt=this.getMainPainter();if((0,b.isFunc)(wt?.setAxesDraw))return wt.setAxesDraw(!0);console.error("no geometry painter found to toggle TAxis3D drawing")}function ds(wt,W){if(!wt)return null;W||(W={}),W.numfaces||(W.numfaces=1e5),W.numnodes||(W.numnodes=1e3),W.frustum||(W.frustum=null),W.res_mesh=W.res_faces=0,void 0===W.instancing&&(W.instancing=-1),W.info={num_meshes:0,num_faces:0};let pe=null,me=null;if(wt.visibles&&wt.nodes&&wt.numnodes){const St=wt.numnodes>1e6?{length:wt.numnodes}:new Array(wt.numnodes);wt.nodes.forEach(En=>{St[En.id]=j.De.formatServerElement(En)}),pe=new j.De(null,St),pe.name_prefix=pe.getNodeName(0),pe.maxdepth=20;const xt=wt.cfg?.nsegm||30;for(let En=0;En<wt.visibles.length;++En){const jt=wt.visibles[En],Cn=jt.ri;Cn&&(jt.server_shape=Cn.server_shape=(0,j.uz)(Cn,xt))}me=wt.visibles}else{let St=null,xt=!1;if("fShapeBits"in wt&&"fShapeId"in wt?(St=wt,wt=null):wt._typename===R||wt._typename===b.clTGeoVolume||wt._typename===I||wt._typename===_e?St=wt.fShape:wt._typename===m?(xt=!W.showtop,St=(wt=wt.fMasterVolume).fShape):wt.fVolume?St=wt.fVolume.fShape:wt=null,W.composite&&St&&St._typename===j.HO&&St.fNode&&(wt=Pe(St)),!wt&&St&&(wt=Object.assign((0,b.create)(b.clTNamed),{_typename:I,fTrans:null,fShape:St,fRGBA:[0,1,0,1],fElements:null,fRnrSelf:!0})),!wt)return null;0===wt._typename.indexOf(b.clTGeoVolume)&&(wt={_typename:b.clTGeoNode,fVolume:wt,fName:wt.fName,$geoh:wt.$geoh,_proxy:!0}),pe=new j.De(wt),pe.setVisLevel(W.vislevel),pe.setMaxVisNodes(W.numnodes),W.dflt_colors&&pe.setDefaultColors(!0),(W.no_screen?0:pe.markVisibles(!0))<=0?pe.markVisibles(!1,!1,xt):pe.markVisibles(!0,!0,xt),pe.produceIdShifts(),me=pe.collectVisibles(W.numfaces,W.frustum).lst}W.material_kind||(W.material_kind="lambert"),void 0===W.set_names&&(W.set_names=!0),pe.setConfig(W);const Fe=pe.collectShapes(me);pe.buildShapes(Fe,W.numfaces);const At=new z.B69;At.clones=pe;const Et=(0,v.HG)();if(pe.createInstancedMeshes(W,At,me,Fe,Et))return At;for(let St=0;St<me.length;++St){const xt=me[St];if(xt.done)continue;const En=xt.server_shape||Fe[xt.shapeid];if(!En.ready){console.warn("shape marked as not ready when it should");break}pe.createEntryMesh(W,At,xt,En,Et)}return At}},3190:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{De:()=>Un,$T:()=>gt,Ce:()=>Y,HO:()=>_e,qU:()=>Fn,Wz:()=>wt,_b:()=>Oe,P1:()=>En,Cc:()=>jt,d4:()=>xt,uz:()=>Et,Wv:()=>le,QL:()=>ie,UX:()=>si,Dh:()=>Ue,Hs:()=>lt,fD:()=>tr,xq:()=>ln,NN:()=>ue,k$:()=>he,Pz:()=>Zt,qr:()=>pe,V:()=>St,bg:()=>We,N_:()=>Q,zL:()=>Pe,ZE:()=>dt});var ve=Ee(357),b=Ee(6998);const z=1e-5;class Xe{constructor($,S,Z,Ae,Ce,$e){this.x=$,this.y=S,this.z=Z,this.nx=Ae,this.ny=Ce,this.nz=$e}setnormal($,S,Z){this.nx=$,this.ny=S,this.nz=Z}clone(){return new Xe(this.x,this.y,this.z,this.nx,this.ny,this.nz)}add($){return this.x+=$.x,this.y+=$.y,this.z+=$.z,this}subtract($){return this.x-=$.x,this.y-=$.y,this.z-=$.z,this}cross3($,S,Z){const Ae=this.x,Ce=this.y,$e=this.z;return this.x=Ce*Z-$e*S,this.y=$e*$-Ae*Z,this.z=Ae*S-Ce*$,this}normalize(){const $=Math.sqrt(this.x**2+this.y**2+this.z**2);return this.x/=$,this.y/=$,this.z/=$,this}dot($){return this.x*$.x+this.y*$.y+this.z*$.z}diff($){const Ce=this.x**2+this.y**2+this.z**2;return((this.x-$.x)**2+(this.y-$.y)**2+(this.z-$.z)**2)/(Ce>0?Ce:1e-10)}interpolate($,S){const Z=1-S;return new Xe(this.x*Z+$.x*S,this.y*Z+$.y*S,this.z*Z+$.z*S,this.nx*Z+$.nx*S,this.ny*Z+$.ny*S,this.nz*Z+$.nz*S)}applyMatrix4($){let S=this.x,Z=this.y,Ae=this.z;const Ce=$.elements;return this.x=Ce[0]*S+Ce[4]*Z+Ce[8]*Ae+Ce[12],this.y=Ce[1]*S+Ce[5]*Z+Ce[9]*Ae+Ce[13],this.z=Ce[2]*S+Ce[6]*Z+Ce[10]*Ae+Ce[14],S=this.nx,Z=this.ny,Ae=this.nz,this.nx=Ce[0]*S+Ce[4]*Z+Ce[8]*Ae,this.ny=Ce[1]*S+Ce[5]*Z+Ce[9]*Ae,this.nz=Ce[2]*S+Ce[6]*Z+Ce[10]*Ae,this}}class ot{constructor($,S,Z){this.vertices=$||[],this.nsign=1,S?this.copyProperties(S,Z):this.vertices.length>0&&this.calculateProperties()}copyProperties($,S){return this.normal=$.normal,this.w=$.w,this.nsign=$.nsign,S&&void 0!==$.id&&(this.id=$.id,this.parent=$),this}calculateProperties($){if(this.normal&&!$)return;const S=this.vertices[0],Z=this.vertices[1],Ae=this.vertices[2];return this.nsign=1,this.normal=new Xe(Z.x-S.x,Z.y-S.y,Z.z-S.z,0,0,0).cross3(Ae.x-S.x,Ae.y-S.y,Ae.z-S.z).normalize(),this.w=this.normal.dot(S),this}clone(){const $=this.vertices.length,S=[];for(let Z=0;Z<$;++Z)S.push(this.vertices[Z].clone());return new ot(S,this)}flip(){return this.nsign*=-1,this.vertices.reverse(),this}classifyVertex($){const S=this.nsign*(this.normal.dot($)-this.w);return S<-z?2:S>z?1:0}classifySide($){let S=0,Z=0;const Ae=$.vertices.length;for(let Ce=0;Ce<Ae;++Ce){const $e=this.classifyVertex($.vertices[Ce]);1===$e?++S:2===$e&&++Z}return S>0&&0===Z?1:0===S&&Z>0?2:0===S&&0===Z?0:3}splitPolygon($,S,Z,Ae,Ce){const $e=this.classifySide($);if(0===$e)(this.nsign*$.nsign*this.normal.dot($.normal)>0?S:Z).push($);else if(1===$e)Ae.push($);else if(2===$e)Ce.push($);else{const nt=$.vertices.length,rt=this.normal.x,ct=this.normal.y,zt=this.normal.z,at=[],nn=[];let Wt,gn,ze,Qe,ut,_t,Lt,xn;for(Wt=0;Wt<nt;++Wt)gn=(Wt+1)%nt,ut=$.vertices[Wt],_t=$.vertices[gn],ze=this.classifyVertex(ut),Qe=this.classifyVertex(_t),2!==ze&&at.push(ut),1!==ze&&nn.push(ut),3==(ze|Qe)&&(Lt=(this.w-(rt*ut.x+ct*ut.y+zt*ut.z))/(rt*(_t.x-ut.x)+ct*(_t.y-ut.y)+zt*(_t.z-ut.z)),xn=ut.interpolate(_t,Lt),at.push(xn),nn.push(xn));at.length>=3&&Ae.push(new ot(at,$,!0)),nn.length>=3&&Ce.push(new ot(nn,$,!0))}}}class Re{constructor($,S){if(this.polygons=[],this.front=this.back=void 0,!$)return;this.divider=$[0].clone();const Z=$.length,Ae=[],Ce=[];for(let $e=0;$e<Z;++$e)void 0!==S&&($[$e].id=S++,delete $[$e].parent),0===$e?this.polygons.push($[0]):this.divider.splitPolygon($[$e],this.polygons,this.polygons,Ae,Ce);void 0!==S&&(this.maxnodeid=S),Ae.length>0&&(this.front=new Re(Ae)),Ce.length>0&&(this.back=new Re(Ce))}build($){const S=$.length,Z=[],Ae=[];let Ce=0;this.divider||(this.divider=$[0].clone(),this.polygons.push($[0]),Ce=1);for(let $e=Ce;$e<S;++$e)this.divider.splitPolygon($[$e],this.polygons,this.polygons,Z,Ae);Z.length>0&&(this.front||(this.front=new Re),this.front.build(Z)),Ae.length>0&&(this.back||(this.back=new Re),this.back.build(Ae))}collectPolygons($){void 0===$&&($=[]);const S=this.polygons.length;for(let Z=0;Z<S;++Z)$.push(this.polygons[Z]);return this.front?.collectPolygons($),this.back?.collectPolygons($),$}numPolygons(){return this.polygons.length+(this.front?.numPolygons()||0)+(this.back?.numPolygons()||0)}clone(){const $=new Re;return $.divider=this.divider?.clone(),$.polygons=this.polygons.map(S=>S.clone()),$.front=this.front?.clone(),$.back=this.back?.clone(),$}invert(){const $=this.polygons.length;for(let Z=0;Z<$;++Z)this.polygons[Z].flip();this.divider.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();const S=this.front;return this.front=this.back,this.back=S,this}clipPolygons($){if(!this.divider)return $.slice();const S=$.length;let Z=[],Ae=[];for(let Ce=0;Ce<S;++Ce)this.divider.splitPolygon($[Ce],Z,Ae,Z,Ae);return this.front&&(Z=this.front.clipPolygons(Z)),Ae=this.back?this.back.clipPolygons(Ae):[],Z.concat(Ae)}clipTo($){this.polygons=$.clipPolygons(this.polygons),this.front&&this.front.clipTo($),this.back&&this.back.clipTo($)}}function He(Ne){const $=Ne.length;let S,Z,Ae=0;for(S=0;S<$;++S)Ae+=9*(Ne[S].vertices.length-2);const Ce=new Float32Array(Ae),$e=new Float32Array(Ae);let rt,nt=0;function ct(at){Ce[nt]=at.x,Ce[nt+1]=at.y,Ce[nt+2]=at.z,$e[nt]=rt.nsign*at.nx,$e[nt+1]=rt.nsign*at.ny,$e[nt+2]=rt.nsign*at.nz,nt+=3}for(S=0;S<$;++S)for(rt=Ne[S],Z=2;Z<rt.vertices.length;++Z)ct(rt.vertices[0]),ct(rt.vertices[Z-1]),ct(rt.vertices[Z]);const zt=new ve.LoY;return zt.setAttribute("position",new ve.THS(Ce,3)),zt.setAttribute("normal",new ve.THS($e,3)),zt}class Ie{constructor($,S,Z,Ae){if(!($ instanceof ve.eaF)){if($ instanceof Re)return this.tree=$,this.matrix=null,this;if($ instanceof ve.LoY){const nn=$.getAttribute("position").array,Wt=$.getAttribute("normal").array,gn=[];let ze,Qe,ut,_t;for(let Lt=0;Lt<nn.length;Lt+=9)ze=new ot,Qe=new Xe(nn[Lt],nn[Lt+1],nn[Lt+2],Wt[Lt],Wt[Lt+1],Wt[Lt+2]),S&&Qe.applyMatrix4(S),ut=new Xe(nn[Lt+3],nn[Lt+4],nn[Lt+5],Wt[Lt+3],Wt[Lt+4],Wt[Lt+5]),S&&ut.applyMatrix4(S),_t=new Xe(nn[Lt+6],nn[Lt+7],nn[Lt+8],Wt[Lt+6],Wt[Lt+7],Wt[Lt+8]),S&&_t.applyMatrix4(S),Ae?ze.vertices.push(Qe,_t,ut):ze.vertices.push(Qe,ut,_t),ze.calculateProperties(!0),gn.push(ze);return this.tree=new Re(gn,Z),void 0!==Z&&(this.maxid=this.tree.maxnodeid),this}if($.polygons&&$.polygons[0]instanceof ot){const nn=$.polygons;for(let Wt=0;Wt<nn.length;++Wt){const gn=nn[Wt];if(S){const ze=[];for(let Qe=0;Qe<gn.vertices.length;++Qe)ze.push(gn.vertices[Qe].clone().applyMatrix4(S));gn.vertices=ze}gn.calculateProperties(S)}return this.tree=new Re(nn,Z),void 0!==Z&&(this.maxid=this.tree.maxnodeid),this}throw Error("ThreeBSP: Given geometry is unsupported")}$.updateMatrix(),S=this.matrix=$.matrix.clone();const Ce=[],$e=($=$.geometry).faces.length;let nt,rt,ct,zt,at;for(let nn=0;nn<$e;++nn)nt=$.faces[nn],zt=nt.normal,rt=new ot,at=nt.vertexNormals&&3===nt.vertexNormals.length,ct=$.vertices[nt.a],at&&(zt=nt.vertexNormals[0]),ct=new Xe(ct.x,ct.y,ct.z,zt.x,zt.y,zt.z),S&&ct.applyMatrix4(S),rt.vertices.push(ct),ct=$.vertices[nt.b],at&&(zt=nt.vertexNormals[1]),ct=new Xe(ct.x,ct.y,ct.z,zt.x,zt.y,zt.z),S&&ct.applyMatrix4(S),rt.vertices.push(ct),ct=$.vertices[nt.c],at&&(zt=nt.vertexNormals[2]),ct=new Xe(ct.x,ct.y,ct.z,zt.x,zt.y,zt.z),S&&ct.applyMatrix4(S),rt.vertices.push(ct),rt.calculateProperties(!0),Ce.push(rt);this.tree=new Re(Ce,Z),void 0!==Z&&(this.maxid=this.tree.maxnodeid)}subtract($){let S=this.tree.clone();const Z=$.tree.clone();return S.invert(),S.clipTo(Z),Z.clipTo(S),Z.invert(),Z.clipTo(S),Z.invert(),S.build(Z.collectPolygons()),S.invert(),S=new Ie(S),S.matrix=this.matrix,S}union($){let S=this.tree.clone();const Z=$.tree.clone();return S.clipTo(Z),Z.clipTo(S),Z.invert(),Z.clipTo(S),Z.invert(),S.build(Z.collectPolygons()),S=new Ie(S),S.matrix=this.matrix,S}intersect($){let S=this.tree.clone();const Z=$.tree.clone();return S.invert(),Z.clipTo(S),Z.invert(),S.clipTo(Z),Z.clipTo(S),S.build(Z.collectPolygons()),S.invert(),S=new Ie(S),S.matrix=this.matrix,S}tryToCompress($){if(void 0===this.maxid)return;const S=[];let Z,Ae,$e,rt,ct,zt,at,nn,Ce=0,nt=$.length;for($e=0;$e<nt;++$e)rt=$[$e],void 0!==rt.id&&(void 0===S[rt.id]&&(S[rt.id]=[]),S[rt.id].push(rt));for($e=0;$e<S.length;++$e)if(Z=S[$e],void 0!==Z)for(nt=Z.length,Ae=nt>1;Ae;)for(Ae=!1,at=0;at<nt-1;++at)if(ct=Z[at],ct?.parent)for(nn=at+1;nn<nt;++nn)if(zt=Z[nn],zt&&ct.parent===zt.parent&&ct.nsign===zt.nsign){ct.nsign!==ct.parent.nsign&&ct.parent.flip(),Ce++,Z[at]=ct.parent,Z[nn]=null,ct.parent.vertices.length<3&&console.log("something wrong with parent"),Ae=!0;break}if(Ce>0)for($.splice(0,$.length),$e=0;$e<S.length;++$e)if(Z=S[$e],void 0!==Z)for(at=0,nt=Z.length;at<nt;++at)Z[at]&&$.push(Z[at])}direct_subtract($){const S=this.tree,Z=$.tree;return S.invert(),S.clipTo(Z),Z.clipTo(S),Z.invert(),Z.clipTo(S),Z.invert(),S.build(Z.collectPolygons()),S.invert(),this}direct_union($){const S=this.tree,Z=$.tree;return S.clipTo(Z),Z.clipTo(S),Z.invert(),Z.clipTo(S),Z.invert(),S.build(Z.collectPolygons()),this}direct_intersect($){const S=this.tree,Z=$.tree;return S.invert(),Z.clipTo(S),Z.invert(),S.clipTo(Z),Z.clipTo(S),S.build(Z.collectPolygons()),S.invert(),this}cut_from_plane($){const S=this.tree,Z=$.tree;return S.invert(),Z.clipTo(S),this}scale($,S,Z){const Ae=this.tree.collectPolygons();for(let Ce=0;Ce<Ae.length;++Ce){const $e=Ae[Ce];for(let nt=0;nt<$e.vertices.length;++nt){const rt=$e.vertices[nt];rt.x*=$,rt.y*=S,rt.z*=Z}$e.calculateProperties(!0)}}toPolygons(){const $=this.tree.collectPolygons();this.tryToCompress($);for(let S=0;S<$.length;++S)delete $[S].id,delete $[S].parent;return $}toBufferGeometry(){return He(this.toPolygons())}toMesh($){const S=this.toBufferGeometry(),Z=new ve.eaF(S,$);return this.matrix&&(Z.position.setFromMatrixPosition(this.matrix),Z.rotation.setFromRotationMatrix(this.matrix)),Z}}const ce={GradPerSegm:6,CompressComp:!0};function ie(Ne,$){if(void 0===$)return ce[Ne];ce[Ne]=$}const he=0,ue=1,le={kVisOverride:(0,b.BIT)(0),kVisNone:(0,b.BIT)(1),kVisThis:(0,b.BIT)(2),kVisDaughters:(0,b.BIT)(3),kVisOneLevel:(0,b.BIT)(4),kVisStreamed:(0,b.BIT)(5),kVisTouched:(0,b.BIT)(6),kVisOnScreen:(0,b.BIT)(7),kVisContainers:(0,b.BIT)(12),kVisOnly:(0,b.BIT)(13),kVisBranch:(0,b.BIT)(14),kVisRaytrace:(0,b.BIT)(15)},Y="TGeoBBox",V="TGeoArb8",D="TGeoCone",w="TGeoConeSeg",P="TGeoTube",x="TGeoTubeSeg",v="TGeoCtub",_="TGeoTrd1",C="TGeoTrd2",L="TGeoPara",F="TGeoParaboloid",U="TGeoPcon",j="TGeoPgon",te="TGeoShapeAssembly",N="TGeoSphere",m="TGeoTorus",I="TGeoXtru",A="TGeoTrap",R="TGeoGtra",k="TGeoEltu",J="TGeoHype",_e="TGeoCompositeShape",be="TGeoHalfSpace",Te="TGeoScaledShape";function Pe(Ne,$){const S=Ne.fGeoAtt;return void 0!==S&&!!(S&$)}function We(Ne,$,S){void 0!==Ne.fGeoAtt&&(Ne.fGeoAtt=S?Ne.fGeoAtt|$:Ne.fGeoAtt&~$)}function dt(Ne,$){void 0!==Ne.fGeoAtt&&(Ne.fGeoAtt=Ne.fGeoAtt^16777215&$)}function Q(Ne,$){if(void 0===$&&($=!0),We(Ne,le.kVisThis,!$),Ne.fNodes)for(let S=0;S<Ne.fNodes.arr.length;++S)We(Ne.fNodes.arr[S].fVolume,le.kVisThis,!$)}const Ke={};function Ze(Ne){void 0===Ke[Ne]&&(Ke[Ne]=!0,console.warn(Ne))}function Ue(Ne){return(0,b.isObject)(Ne)?"fShape"in Ne&&"fTrans"in Ne?ue:he:-1}function Oe(Ne){return Ne?Ne._typename!==_e?1:Oe(Ne.fNode.fLeft)+Oe(Ne.fNode.fRight):0}function lt(Ne){return Ne?.fName?Ne.fName+(Ne.$geo_suffix||""):""}function gt(Ne,$){if(Ne){if(Ne.$geo_checked)return;Ne.$geo_checked=!0}const S=[],Z=[];for(let Ae=0;Ae<$.length;++Ae){const Ce=$[Ae];if(Ce?.fName){if(!Ce.$geo_suffix){const $e=S.indexOf(Ce.fName);if($e>=0){let nt=Z[$e]||1;for(;S.indexOf(Ce.fName+"#"+nt)>=0;)++nt;Ce.$geo_suffix="#"+nt,Z[$e]=nt+1}}S.push(lt(Ce))}}}function ht(Ne,$,S,Z,Ae,Ce,$e,nt,rt){const ct=new ve.Pq0(Ne,$,S),zt=new ve.Pq0(Z,Ae,Ce),at=new ve.Pq0($e,nt,rt),nn=new ve.Pq0,Wt=new ve.Pq0;return nn.subVectors(at,zt),Wt.subVectors(ct,zt),nn.cross(Wt),nn}class st{constructor($){this.nfaces=$,this.indx=0,this.pos=new Float32Array(9*$),this.norm=new Float32Array(9*$)}addFace3($,S,Z,Ae,Ce,$e,nt,rt,ct){const zt=this.indx,at=this.pos;at[zt]=$,at[zt+1]=S,at[zt+2]=Z,at[zt+3]=Ae,at[zt+4]=Ce,at[zt+5]=$e,at[zt+6]=nt,at[zt+7]=rt,at[zt+8]=ct,this.last4=!1,this.indx=zt+9}startPolygon(){}stopPolygon(){}addFace4($,S,Z,Ae,Ce,$e,nt,rt,ct,zt,at,nn,Wt){let gn=this.indx;const ze=this.pos;1!==Wt&&(ze[gn]=$,ze[gn+1]=S,ze[gn+2]=Z,ze[gn+3]=Ae,ze[gn+4]=Ce,ze[gn+5]=$e,ze[gn+6]=nt,ze[gn+7]=rt,ze[gn+8]=ct,gn+=9),2!==Wt&&(ze[gn]=$,ze[gn+1]=S,ze[gn+2]=Z,ze[gn+3]=nt,ze[gn+4]=rt,ze[gn+5]=ct,ze[gn+6]=zt,ze[gn+7]=at,ze[gn+8]=nn,gn+=9),this.last4=gn!==this.indx+9,this.indx=gn}setNormal4($,S,Z,Ae,Ce,$e,nt,rt,ct,zt,at,nn,Wt){if(this.last4&&Wt)return console.error("missmatch between addFace4 and setNormal4 calls");let gn=this.indx-(this.last4?18:9);const ze=this.norm;1!==Wt&&(ze[gn]=$,ze[gn+1]=S,ze[gn+2]=Z,ze[gn+3]=Ae,ze[gn+4]=Ce,ze[gn+5]=$e,ze[gn+6]=nt,ze[gn+7]=rt,ze[gn+8]=ct,gn+=9),2!==Wt&&(ze[gn]=$,ze[gn+1]=S,ze[gn+2]=Z,ze[gn+3]=nt,ze[gn+4]=rt,ze[gn+5]=ct,ze[gn+6]=zt,ze[gn+7]=at,ze[gn+8]=nn)}recalcZ($){const S=this.pos,Z=this.indx;let Ae=Z-(this.last4?18:9);for(;Ae<Z;)S[Ae+2]=$(S[Ae],S[Ae+1],S[Ae+2]),Ae+=3}calcNormal(){this.cb||(this.pA=new ve.Pq0,this.pB=new ve.Pq0,this.pC=new ve.Pq0,this.cb=new ve.Pq0,this.ab=new ve.Pq0),this.pA.fromArray(this.pos,this.indx-9),this.pB.fromArray(this.pos,this.indx-6),this.pC.fromArray(this.pos,this.indx-3),this.cb.subVectors(this.pC,this.pB),this.ab.subVectors(this.pA,this.pB),this.cb.cross(this.ab),this.setNormal(this.cb.x,this.cb.y,this.cb.z)}setNormal($,S,Z){let Ae=this.indx-9;const Ce=this.norm;Ce[Ae]=Ce[Ae+3]=Ce[Ae+6]=$,Ce[Ae+1]=Ce[Ae+4]=Ce[Ae+7]=S,Ce[Ae+2]=Ce[Ae+5]=Ce[Ae+8]=Z,this.last4&&(Ae-=9,Ce[Ae]=Ce[Ae+3]=Ce[Ae+6]=$,Ce[Ae+1]=Ce[Ae+4]=Ce[Ae+7]=S,Ce[Ae+2]=Ce[Ae+5]=Ce[Ae+8]=Z)}setNormal_12_34($,S,Z,Ae,Ce,$e,nt){void 0===nt&&(nt=0);let rt=this.indx-(nt>0?9:18);const ct=this.norm;1!==nt&&(ct[rt]=$,ct[rt+1]=S,ct[rt+2]=Z,ct[rt+3]=$,ct[rt+4]=S,ct[rt+5]=Z,ct[rt+6]=Ae,ct[rt+7]=Ce,ct[rt+8]=$e,rt+=9),2!==nt&&(ct[rt]=$,ct[rt+1]=S,ct[rt+2]=Z,ct[rt+3]=Ae,ct[rt+4]=Ce,ct[rt+5]=$e,ct[rt+6]=Ae,ct[rt+7]=Ce,ct[rt+8]=$e)}create(){this.nfaces!==this.indx/9&&console.error(`Mismatch with created ${this.nfaces} and filled ${this.indx/9} number of faces`);const $=new ve.LoY;return $.setAttribute("position",new ve.THS(this.pos,3)),$.setAttribute("normal",new ve.THS(this.norm,3)),$}}class yt{constructor(){this.polygons=[]}startPolygon($){this.multi=1,this.mnormal=$}stopPolygon(){this.multi&&(this.multi=0,console.error("Polygon should be already closed at this moment"))}addFace3($,S,Z,Ae,Ce,$e,nt,rt,ct){this.addFace4($,S,Z,Ae,Ce,$e,nt,rt,ct,nt,rt,ct,2)}addFace4($,S,Z,Ae,Ce,$e,nt,rt,ct,zt,at,nn,Wt){if(void 0===Wt&&(Wt=0),this.v1=new Xe($,S,Z,0,0,0),this.v2=1===Wt?null:new Xe(Ae,Ce,$e,0,0,0),this.v3=new Xe(nt,rt,ct,0,0,0),this.v4=2===Wt?null:new Xe(zt,at,nn,0,0,0),this.reduce=Wt,this.multi){let ze;return 2!==Wt&&console.error("polygon not supported for not-reduced faces"),1==this.multi++?(ze=new ot,ze.vertices.push(this.mnormal?this.v2:this.v3),this.polygons.push(ze)):(ze=this.polygons[this.polygons.length-1],(this.mnormal?this.v2:this.v3).diff(this.mnormal?ze.vertices[ze.vertices.length-1]:ze.vertices[0])>1e-12&&console.error("vertex missmatch when building polygon")),void((this.mnormal?this.v3:this.v2).diff(this.mnormal?ze.vertices[0]:ze.vertices[ze.vertices.length-1])<1e-12?this.multi=0:this.mnormal?ze.vertices.push(this.v3):ze.vertices.unshift(this.v2))}const gn=new ot;switch(Wt){case 0:gn.vertices.push(this.v1,this.v2,this.v3,this.v4);break;case 1:gn.vertices.push(this.v1,this.v3,this.v4);break;case 2:gn.vertices.push(this.v1,this.v2,this.v3)}this.polygons.push(gn)}setNormal4($,S,Z,Ae,Ce,$e,nt,rt,ct,zt,at,nn){this.v1.setnormal($,S,Z),this.v2&&this.v2.setnormal(Ae,Ce,$e),this.v3.setnormal(nt,rt,ct),this.v4&&this.v4.setnormal(zt,at,nn)}setNormal_12_34($,S,Z,Ae,Ce,$e){this.v1.setnormal($,S,Z),this.v2&&this.v2.setnormal($,S,Z),this.v3.setnormal(Ae,Ce,$e),this.v4&&this.v4.setnormal(Ae,Ce,$e)}calcNormal(){this.cb||(this.pA=new ve.Pq0,this.pB=new ve.Pq0,this.pC=new ve.Pq0,this.cb=new ve.Pq0,this.ab=new ve.Pq0),this.pA.set(this.v1.x,this.v1.y,this.v1.z),1!==this.reduce?(this.pB.set(this.v2.x,this.v2.y,this.v2.z),this.pC.set(this.v3.x,this.v3.y,this.v3.z)):(this.pB.set(this.v3.x,this.v3.y,this.v3.z),this.pC.set(this.v4.x,this.v4.y,this.v4.z)),this.cb.subVectors(this.pC,this.pB),this.ab.subVectors(this.pA,this.pB),this.cb.cross(this.ab),this.setNormal(this.cb.x,this.cb.y,this.cb.z)}setNormal($,S,Z){this.v1.setnormal($,S,Z),this.v2&&this.v2.setnormal($,S,Z),this.v3.setnormal($,S,Z),this.v4&&this.v4.setnormal($,S,Z)}recalcZ($){this.v1.z=$(this.v1.x,this.v1.y,this.v1.z),this.v2&&(this.v2.z=$(this.v2.x,this.v2.y,this.v2.z)),this.v3.z=$(this.v3.x,this.v3.y,this.v3.z),this.v4&&(this.v4.z=$(this.v4.x,this.v4.y,this.v4.z))}create(){return{polygons:this.polygons}}}function Ot(Ne,$){const S=[4,7,6,5,0,3,7,4,4,5,1,0,6,2,1,5,7,3,2,6,1,2,3,0],Z=$>0?new yt:new st(12);for(let Ae=0;Ae<S.length;Ae+=4){const Ce=3*S[Ae],$e=3*S[Ae+1],nt=3*S[Ae+2],rt=3*S[Ae+3];Z.addFace4(Ne[Ce],Ne[Ce+1],Ne[Ce+2],Ne[$e],Ne[$e+1],Ne[$e+2],Ne[nt],Ne[nt+1],Ne[nt+2],Ne[rt],Ne[rt+1],Ne[rt+2]),0===Ae?Z.setNormal(0,0,1):20===Ae?Z.setNormal(0,0,-1):Z.calcNormal()}return Z.create()}function Qt(Ne,$){let S,Z;Ne._typename===D||Ne._typename===w?(S=[Ne.fRmax2,Ne.fRmax1],Z=[Ne.fRmin2,Ne.fRmin1]):(S=[Ne.fRmax,Ne.fRmax],Z=[Ne.fRmin,Ne.fRmin]);const Ae=Z[0]>0||Z[1]>0;let Ce=0,$e=360;(Ne._typename===w||Ne._typename===x||Ne._typename===v)&&(Ce=Ne.fPhi1,$e=Ne.fPhi2-Ne.fPhi1);const nt=Math.max(4,Math.round($e/ce.GradPerSegm));let rt=nt*(S[0]<=0||S[1]<=0?1:2);if(Ae&&(rt+=nt*(Z[0]<=0||Z[1]<=0?1:2)),S[0]>0&&(rt+=nt*(Z[0]>0?2:1)),S[1]>0&&(rt+=nt*(Z[1]>0?2:1)),$e<360&&(rt+=(S[0]>Z[0]?2:0)+(S[1]>Z[1]?2:0)),$<0)return rt;const ct=Ce*Math.PI/180,zt=$e/nt*Math.PI/180,at=new Float32Array(nt+1),nn=new Float32Array(nt+1);for(let ze=0;ze<=nt;++ze)nn[ze]=Math.cos(ct+ze*zt),at[ze]=Math.sin(ct+ze*zt);const Wt=$?new yt:new st(rt),gn=Ne._typename!==v?null:(ze,Qe,ut)=>{const _t=ut<0?Ne.fNlow:Ne.fNhigh;return(ut<0?-Ne.fDz:Ne.fDz)-(ze*_t[0]+Qe*_t[1])/_t[2]};for(let ze=0;ze<2&&(1!==ze||Ae);++ze){const Qe=0===ze?S:Z,ut=ze,_t=1-ze;let Lt=1,xn=0;if(Qe[0]!==Qe[1]){const Xt=Math.atan2(Qe[1]-Qe[0],2*Ne.fDZ);Lt=Math.cos(Xt),xn=Math.sin(Xt)}1===ze&&(Lt*=-1,xn*=-1);const rn=Qe[0]<=0?2:Qe[1]<=0?1:0;for(let Xt=0;Xt<nt;++Xt)Wt.addFace4(Qe[0]*nn[Xt+ut],Qe[0]*at[Xt+ut],Ne.fDZ,Qe[1]*nn[Xt+ut],Qe[1]*at[Xt+ut],-Ne.fDZ,Qe[1]*nn[Xt+_t],Qe[1]*at[Xt+_t],-Ne.fDZ,Qe[0]*nn[Xt+_t],Qe[0]*at[Xt+_t],Ne.fDZ,rn),gn&&Wt.recalcZ(gn),Wt.setNormal_12_34(Lt*nn[Xt+ut],Lt*at[Xt+ut],xn,Lt*nn[Xt+_t],Lt*at[Xt+_t],xn,rn)}for(let ze=0;ze<2;++ze){if(S[ze]<=0)continue;const Qe=ze,ut=1-ze,_t=0===ze?1:-1,Lt=Z[ze]<=0?2:0;2===Lt&&360===$e&&!gn&&Wt.startPolygon(0===ze);for(let xn=0;xn<nt;++xn)Wt.addFace4(Z[ze]*nn[xn+Qe],Z[ze]*at[xn+Qe],_t*Ne.fDZ,S[ze]*nn[xn+Qe],S[ze]*at[xn+Qe],_t*Ne.fDZ,S[ze]*nn[xn+ut],S[ze]*at[xn+ut],_t*Ne.fDZ,Z[ze]*nn[xn+ut],Z[ze]*at[xn+ut],_t*Ne.fDZ,Lt),gn?(Wt.recalcZ(gn),Wt.calcNormal()):Wt.setNormal(0,0,_t);Wt.stopPolygon()}return $e<360&&(Wt.addFace4(Z[1]*nn[0],Z[1]*at[0],-Ne.fDZ,S[1]*nn[0],S[1]*at[0],-Ne.fDZ,S[0]*nn[0],S[0]*at[0],Ne.fDZ,Z[0]*nn[0],Z[0]*at[0],Ne.fDZ,S[0]===Z[0]?2:Z[1]===S[1]?1:0),gn&&Wt.recalcZ(gn),Wt.calcNormal(),Wt.addFace4(Z[0]*nn[nt],Z[0]*at[nt],Ne.fDZ,S[0]*nn[nt],S[0]*at[nt],Ne.fDZ,S[1]*nn[nt],S[1]*at[nt],-Ne.fDZ,Z[1]*nn[nt],Z[1]*at[nt],-Ne.fDZ,S[0]===Z[0]?1:Z[1]===S[1]?2:0),gn&&Wt.recalcZ(gn),Wt.calcNormal()),Wt.create()}function ai(Ne){if(!Ne)return null;let $,S,Z;switch(Ne._typename){case"TGeoTranslation":$=Ne.fTranslation;break;case"TGeoRotation":S=Ne.fRotationMatrix;break;case"TGeoScale":Z=Ne.fScale;break;case"TGeoGenTrans":Z=Ne.fScale;case"TGeoCombiTrans":$=Ne.fTranslation,Ne.fRotation&&(S=Ne.fRotation.fRotationMatrix);break;case"TGeoHMatrix":$=Ne.fTranslation,S=Ne.fRotationMatrix,Z=Ne.fScale;break;case"TGeoIdentity":break;default:console.warn(`unsupported matrix ${Ne._typename}`)}if(!$&&!S&&!Z)return null;const Ae=new ve.kn4;return S&&Ae.set(S[0],S[1],S[2],0,S[3],S[4],S[5],0,S[6],S[7],S[8],0,0,0,0,1),$&&Ae.setPosition($[0],$[1],$[2]),Z&&Ae.scale(new ve.Pq0(Z[0],Z[1],Z[2])),Ae}function Xi(Ne,$){let S=null;if(Ne===ue)S=new ve.kn4,$.fTrans&&(S.set($.fTrans[0],$.fTrans[4],$.fTrans[8],0,$.fTrans[1],$.fTrans[5],$.fTrans[9],0,$.fTrans[2],$.fTrans[6],$.fTrans[10],0,0,0,0,1),S.setPosition($.fTrans[12],$.fTrans[13],$.fTrans[14]));else if($.fMatrix)S=ai($.fMatrix);else if("TGeoNodeOffset"===$._typename&&$.fFinder){const Z=(0,b.BIT)(14);switch($.fFinder.fBits&Z&&Ze("Unsupported reflected pattern "+$.fFinder._typename),$.fFinder._typename){case"TGeoPatternX":case"TGeoPatternY":case"TGeoPatternZ":case"TGeoPatternParaX":case"TGeoPatternParaY":case"TGeoPatternParaZ":{const Ae=$.fFinder.fStart+($.fIndex+.5)*$.fFinder.fStep;switch(S=new ve.kn4,$.fFinder._typename[$.fFinder._typename.length-1]){case"X":S.setPosition(Ae,0,0);break;case"Y":S.setPosition(0,Ae,0);break;case"Z":S.setPosition(0,0,Ae)}break}case"TGeoPatternCylPhi":{const Ae=Math.PI/180*($.fFinder.fStart+($.fIndex+.5)*$.fFinder.fStep),Ce=Math.cos(Ae),$e=Math.sin(Ae);S=new ve.kn4,S.set(Ce,-$e,0,0,$e,Ce,0,0,0,0,1,0,0,0,0,1);break}case"TGeoPatternCylR":S=new ve.kn4;break;case"TGeoPatternTrapZ":{const Ae=$.fFinder.fStart+($.fIndex+.5)*$.fFinder.fStep;S=new ve.kn4,S.setPosition($.fFinder.fTxz*Ae,$.fFinder.fTyz*Ae,Ae);break}default:Ze(`Unsupported pattern type ${$.fFinder._typename}`)}}return S}function Or(Ne){if(!Ne)return 0;if(Ne instanceof Ie)return Ne.tree.numPolygons();if(Ne.polygons)return Ne.polygons.length;const $=Ne.getAttribute("position");return $?.count?Math.round($.count/3):0}function ds(Ne,$){if(!Ne?.fN||!Ne?.fP)return null;const S=new ve.Pq0(Ne.fP[0],Ne.fP[1],Ne.fP[2]),Z=new ve.Pq0(Ne.fN[0],Ne.fN[1],Ne.fN[2]);Z.normalize();let Ae=1e10;if($){const at=function ys(Ne){if(!Ne)return null;let $=null;if(Ne instanceof Ie?$=Ne.tree.collectPolygons():Ne.polygons&&($=Ne.polygons),null!==$){const S=new ve.NRn;for(let Z=0;Z<$.length;++Z){const Ae=$[Z],Ce=Ae.vertices.length;for(let $e=0;$e<Ce;++$e)S.expandByPoint(Ae.vertices[$e])}return S}return Ne.boundingBox||Ne.computeBoundingBox(),Ne.boundingBox.clone()}($);at&&(Ae=1e3*at.getSize(new ve.Pq0).length())}const Ce=new ve.Pq0(-Ae,-Ae/2,0),$e=new ve.Pq0(0,Ae,0),nt=new ve.Pq0(Ae,-Ae/2,0),rt=new ve.Pq0(0,0,-Ae),ct=new ve.LoY,zt=new Float32Array([Ce.x,Ce.y,Ce.z,nt.x,nt.y,nt.z,$e.x,$e.y,$e.z,Ce.x,Ce.y,Ce.z,$e.x,$e.y,$e.z,rt.x,rt.y,rt.z,$e.x,$e.y,$e.z,nt.x,nt.y,nt.z,rt.x,rt.y,rt.z,nt.x,nt.y,nt.z,Ce.x,Ce.y,Ce.z,rt.x,rt.y,rt.z]);ct.setAttribute("position",new ve.THS(zt,3)),ct.computeVertexNormals(),ct.lookAt(Z),ct.computeVertexNormals();for(let at=0;at<zt.length;at+=3)zt[at]=zt[at]+S.x,zt[at+1]=zt[at+1]+S.y,zt[at+2]=zt[at+2]+S.z;return ct}function wt(Ne){if(!Ne)return 0;if(Ne instanceof Ie)return Ne.tree.numPolygons();if(Ne.polygons)return Ne.polygons.length;const $=Ne.getAttribute("position");return $?.count?Math.round($.count/3):0}function pe(Ne,$,S,Z,Ae){Ne.boundingBox||Ne.computeBoundingBox();const Ce=Ne.boundingBox.clone();if(Ce.applyMatrix4($),Z||(Z=0),Ce.min[S]>=Z&&Ce.max[S]>=Z||Ce.min[S]<=Z&&Ce.max[S]<=Z)return null;const $e=new Ie(Ne,$,0,Ae),nt=2*Math.max(Math.abs(Ce.min.x),Math.abs(Ce.max.x)),rt=2*Math.max(Math.abs(Ce.min.y),Math.abs(Ce.max.y)),ct=2*Math.max(Math.abs(Ce.min.z),Math.abs(Ce.max.z));let zt=1e4;switch(S){case"x":zt=Math.max(rt,ct);break;case"y":zt=Math.max(nt,ct);break;case"z":zt=Math.max(nt,rt)}const at=function O(Ne,$,S){let Z;switch((!S||S<1e4)&&(S=1e4),Ne){case"x":Z=[new Xe($,-3*S,S,1,0,0),new Xe($,S,-3*S,1,0,0),new Xe($,S,S,1,0,0)];break;case"y":Z=[new Xe(-3*S,$,S,0,1,0),new Xe(S,$,S,0,1,0),new Xe(S,$,-3*S,0,1,0)];break;default:Z=[new Xe(-3*S,S,$,0,0,1),new Xe(S,-3*S,$,0,0,1),new Xe(S,S,$,0,0,1)]}const Ae=new Re([new ot(Z)]);return new Ie(Ae)}(S,Z,zt);return $e.cut_from_plane(at),at.toBufferGeometry()}function me(Ne,$){void 0===$&&($=0);try{switch(Ne._typename){case Y:return function Kt(Ne,$){if($<0)return 12;const S=Ne.fDX,Z=Ne.fDY,Ae=Ne.fDZ,Ce=$?new yt:new st(12);return Ce.addFace4(S,Z,Ae,S,-Z,Ae,S,-Z,-Ae,S,Z,-Ae),Ce.setNormal(1,0,0),Ce.addFace4(-S,Z,-Ae,-S,-Z,-Ae,-S,-Z,Ae,-S,Z,Ae),Ce.setNormal(-1,0,0),Ce.addFace4(-S,Z,-Ae,-S,Z,Ae,S,Z,Ae,S,Z,-Ae),Ce.setNormal(0,1,0),Ce.addFace4(-S,-Z,Ae,-S,-Z,-Ae,S,-Z,-Ae,S,-Z,Ae),Ce.setNormal(0,-1,0),Ce.addFace4(-S,Z,Ae,-S,-Z,Ae,S,-Z,Ae,S,Z,Ae),Ce.setNormal(0,0,1),Ce.addFace4(S,Z,-Ae,S,-Z,-Ae,-S,-Z,-Ae,-S,Z,-Ae),Ce.setNormal(0,0,-1),Ce.create()}(Ne,$);case L:return function It(Ne,$){if($<0)return 12;const S=Ne.fTxy,Z=Ne.fTxz,Ae=Ne.fTyz;return Ot([-Ne.fZ*Z-S*Ne.fY-Ne.fX,-Ne.fY-Ne.fZ*Ae,-Ne.fZ,-Ne.fZ*Z+S*Ne.fY-Ne.fX,Ne.fY-Ne.fZ*Ae,-Ne.fZ,-Ne.fZ*Z+S*Ne.fY+Ne.fX,Ne.fY-Ne.fZ*Ae,-Ne.fZ,-Ne.fZ*Z-S*Ne.fY+Ne.fX,-Ne.fY-Ne.fZ*Ae,-Ne.fZ,Ne.fZ*Z-S*Ne.fY-Ne.fX,Ne.fZ*Ae-Ne.fY,Ne.fZ,Ne.fZ*Z+S*Ne.fY-Ne.fX,Ne.fY+Ne.fZ*Ae,Ne.fZ,Ne.fZ*Z+S*Ne.fY+Ne.fX,Ne.fY+Ne.fZ*Ae,Ne.fZ,Ne.fZ*Z-S*Ne.fY+Ne.fX,Ne.fZ*Ae-Ne.fY,Ne.fZ],$)}(Ne,$);case _:case C:return function An(Ne,$){if($<0)return 12;let S,Z;return Ne._typename===_?S=Z=Ne.fDY:(S=Ne.fDy1,Z=Ne.fDy2),Ot([-Ne.fDx1,S,-Ne.fDZ,Ne.fDx1,S,-Ne.fDZ,Ne.fDx1,-S,-Ne.fDZ,-Ne.fDx1,-S,-Ne.fDZ,-Ne.fDx2,Z,Ne.fDZ,Ne.fDx2,Z,Ne.fDZ,Ne.fDx2,-Z,Ne.fDZ,-Ne.fDx2,-Z,Ne.fDZ],$)}(Ne,$);case V:case A:case R:return function on(Ne,$){if($<0)return 12;const S=[Ne.fXY[0][0],Ne.fXY[0][1],-Ne.fDZ,Ne.fXY[1][0],Ne.fXY[1][1],-Ne.fDZ,Ne.fXY[2][0],Ne.fXY[2][1],-Ne.fDZ,Ne.fXY[3][0],Ne.fXY[3][1],-Ne.fDZ,Ne.fXY[4][0],Ne.fXY[4][1],Ne.fDZ,Ne.fXY[5][0],Ne.fXY[5][1],Ne.fDZ,Ne.fXY[6][0],Ne.fXY[6][1],Ne.fDZ,Ne.fXY[7][0],Ne.fXY[7][1],Ne.fDZ],Z=[4,7,6,6,5,4,3,7,4,4,0,3,5,1,0,0,4,5,6,2,1,1,5,6,7,3,2,2,6,7,1,2,3,3,0,1];for(let nt=0;nt<S.length;nt+=S.length/2)for(let rt=nt;rt<nt+S.length/2-3;rt+=3)for(let ct=rt+3;ct<nt+S.length/2;ct+=3)if(S[rt]===S[ct]&&S[rt+1]===S[ct+1]&&S[rt+2]===S[ct+2])for(let zt=0;zt<Z.length;++zt)Z[zt]===ct/3&&(Z[zt]=rt/3);const Ae=[];let Ce=0;for(let nt=0;nt<Z.length;nt+=3){const rt=100*Z[nt]+10*Z[nt+1]+Z[nt+2],ct=100*Z[nt+1]+10*Z[nt+2]+Z[nt],zt=100*Z[nt+2]+10*Z[nt]+Z[nt+1];Z[nt]===Z[nt+1]||Z[nt]===Z[nt+2]||Z[nt+1]===Z[nt+2]||Ae.indexOf(rt)>=0||Ae.indexOf(ct)>=0||Ae.indexOf(zt)>=0?Z[nt]=Z[nt+1]=Z[nt+2]=-1:(Ae.push(rt,ct,zt),Ce++)}const $e=$?new yt:new st(Ce);for(let nt=0;nt<Z.length;nt+=6){const rt=3*Z[nt],ct=3*Z[nt+1],zt=3*Z[nt+2],at=3*Z[nt+3],nn=3*Z[nt+4],Wt=3*Z[nt+5];let gn=null;if(rt>=0&&at>=0&&$)if(0===nt)gn=new ve.Pq0(0,0,1);else if(30===nt)gn=new ve.Pq0(0,0,-1);else{const ze=ht(S[rt],S[rt+1],S[rt+2],S[ct],S[ct+1],S[ct+2],S[zt],S[zt+1],S[zt+2]);ze.normalize();const Qe=ht(S[at],S[at+1],S[at+2],S[nn],S[nn+1],S[nn+2],S[Wt],S[Wt+1],S[Wt+2]);Qe.normalize(),ze.distanceToSquared(Qe)<1e-12&&(gn=ze)}null!==gn?($e.addFace4(S[rt],S[rt+1],S[rt+2],S[ct],S[ct+1],S[ct+2],S[zt],S[zt+1],S[zt+2],S[nn],S[nn+1],S[nn+2]),$e.setNormal(gn.x,gn.y,gn.z)):(rt>=0&&($e.addFace3(S[rt],S[rt+1],S[rt+2],S[ct],S[ct+1],S[ct+2],S[zt],S[zt+1],S[zt+2]),$e.calcNormal()),at>=0&&($e.addFace3(S[at],S[at+1],S[at+2],S[nn],S[nn+1],S[nn+2],S[Wt],S[Wt+1],S[Wt+2]),$e.calcNormal()))}return $e.create()}(Ne,$);case N:return function pn(Ne,$){const S=[Ne.fRmax,Ne.fRmin],Z=Ne.fPhi1,Ae=Ne.fPhi2-Ne.fPhi1,Ce=Ne.fTheta1,$e=Ne.fTheta2-Ne.fTheta1,nt=S[1]<=0;let rt=Ne.fNseg,ct=Ne.fNz;if($>0){const rn=(nt?2:4)*rt*ct/$;rn>1&&(rt=Math.max(4,Math.floor(rt/Math.sqrt(rn))),ct=Math.max(4,Math.floor(ct/Math.sqrt(rn))))}let zt=rt*ct*2,at=rt*(nt?1:2),nn=rt*(nt?1:2);const Wt=360===Ae?0:ct*(nt?2:4),gn=1e-10;if($<0)return zt*(nt?1:2)+at+nn+Wt;const ze=new Float32Array(rt+1),Qe=new Float32Array(rt+1),ut=new Float32Array(ct+1),_t=new Float32Array(ct+1);for(let rn=0;rn<=ct;++rn){const Xt=(Ce+$e/ct*rn)*Math.PI/180;ut[rn]=Math.sin(Xt),_t[rn]=Math.cos(Xt)}for(let rn=0;rn<=rt;++rn){const Xt=(Z+Ae/rt*rn)*Math.PI/180;ze[rn]=Math.sin(Xt),Qe[rn]=Math.cos(Xt)}Math.abs(ut[0])<=gn&&(zt-=rt,at=0),Math.abs(ut[ct])<=gn&&(zt-=rt,nn=0);const Lt=zt*(nt?1:2)+at+nn+Wt,xn=$?new yt:new st(Lt);for(let rn=0;rn<2&&(1!==rn||!nt);++rn){const Xt=S[rn],cn=0===rn?1:-1,Pn=1-rn,Zn=1-Pn;for(let Ui=0;Ui<ct;++Ui){const Ki=Ui+Pn,Ii=Ui+Zn;let vr=0;Math.abs(ut[Ki])<=gn?vr=1:Math.abs(ut[Ii])<=gn&&(vr=2);for(let $r=0;$r<rt;++$r)xn.addFace4(Xt*ut[Ki]*Qe[$r],Xt*ut[Ki]*ze[$r],Xt*_t[Ki],Xt*ut[Ki]*Qe[$r+1],Xt*ut[Ki]*ze[$r+1],Xt*_t[Ki],Xt*ut[Ii]*Qe[$r+1],Xt*ut[Ii]*ze[$r+1],Xt*_t[Ii],Xt*ut[Ii]*Qe[$r],Xt*ut[Ii]*ze[$r],Xt*_t[Ii],vr),xn.setNormal4(cn*ut[Ki]*Qe[$r],cn*ut[Ki]*ze[$r],cn*_t[Ki],cn*ut[Ki]*Qe[$r+1],cn*ut[Ki]*ze[$r+1],cn*_t[Ki],cn*ut[Ii]*Qe[$r+1],cn*ut[Ii]*ze[$r+1],cn*_t[Ii],cn*ut[Ii]*Qe[$r],cn*ut[Ii]*ze[$r],cn*_t[Ii],vr)}}for(let rn=0;rn<=ct;rn+=ct)if(Math.abs(ut[rn])>=gn){const Xt=ut[rn],cn=_t[rn],Pn=0===rn?0:1,Zn=1-Pn;for(let Ui=0;Ui<rt;++Ui)xn.addFace4(S[1]*Xt*Qe[Ui+Pn],S[1]*Xt*ze[Ui+Pn],S[1]*cn,S[0]*Xt*Qe[Ui+Pn],S[0]*Xt*ze[Ui+Pn],S[0]*cn,S[0]*Xt*Qe[Ui+Zn],S[0]*Xt*ze[Ui+Zn],S[0]*cn,S[1]*Xt*Qe[Ui+Zn],S[1]*Xt*ze[Ui+Zn],S[1]*cn,nt?2:0),xn.calcNormal()}if(Ae<360)for(let rn=0;rn<=rt;rn+=rt){const Xt=ze[rn],cn=Qe[rn],Pn=0===rn?1:0,Zn=1-Pn;for(let Ui=0;Ui<ct;++Ui)xn.addFace4(S[1]*ut[Ui+Pn]*cn,S[1]*ut[Ui+Pn]*Xt,S[1]*_t[Ui+Pn],S[0]*ut[Ui+Pn]*cn,S[0]*ut[Ui+Pn]*Xt,S[0]*_t[Ui+Pn],S[0]*ut[Ui+Zn]*cn,S[0]*ut[Ui+Zn]*Xt,S[0]*_t[Ui+Zn],S[1]*ut[Ui+Zn]*cn,S[1]*ut[Ui+Zn]*Xt,S[1]*_t[Ui+Zn],nt?2:0),xn.calcNormal()}return xn.create()}(Ne,$);case D:case w:case P:case x:case v:return Qt(Ne,$);case k:return function Bn(Ne,$){const S=Math.max(4,Math.round(360/ce.GradPerSegm));if($<0)return 4*S;const Z=new Float32Array(S+1),Ae=new Float32Array(S+1);for(let zt=0;zt<=S;++zt){const at=zt/S*2*Math.PI;Z[zt]=Ne.fRmin*Math.cos(at),Ae[zt]=Ne.fRmax*Math.sin(at)}const Ce=$?new yt:new st(4*S);let $e,nt,rt=1,ct=0;for(let zt=0;zt<S;++zt){Ce.addFace4(Z[zt],Ae[zt],+Ne.fDZ,Z[zt],Ae[zt],-Ne.fDZ,Z[zt+1],Ae[zt+1],-Ne.fDZ,Z[zt+1],Ae[zt+1],Ne.fDZ),$e=rt,nt=ct,rt=Z[zt+1]*Ne.fRmax/Ne.fRmin,ct=Ae[zt+1]*Ne.fRmin/Ne.fRmax;const at=Math.sqrt(rt**2+ct**2);rt/=at,ct/=at,Ce.setNormal_12_34($e,nt,0,rt,ct,0)}for(let zt=0;zt<2;++zt){const at=0===zt?1:-1,nn=zt,Wt=1-zt;for(let gn=0;gn<S;++gn)Ce.addFace3(0,0,at*Ne.fDZ,Z[gn+nn],Ae[gn+nn],at*Ne.fDZ,Z[gn+Wt],Ae[gn+Wt],at*Ne.fDZ),Ce.setNormal(0,0,at)}return Ce.create()}(Ne,$);case m:return function dn(Ne,$){const S=Ne.fR;let Z=Math.max(6,Math.round(360/ce.GradPerSegm)),Ae=Math.max(8,Math.round(Ne.fDphi/ce.GradPerSegm)),Ce=(Ne.fRmin>0?4:2)*Z*(Ae+(360!==Ne.fDphi?1:0));if($<0)return Ce;$>0&&Ce>$&&(Z=Math.floor(Z/Math.sqrt(Ce/$)),Ae=Math.floor(Ae/Math.sqrt(Ce/$)),Ce=(Ne.fRmin>0?4:2)*Z*(Ae+(360!==Ne.fDphi?1:0)));const $e=new Float32Array(Z+1),nt=new Float32Array(Z+1),rt=new Float32Array(Ae+1),ct=new Float32Array(Ae+1);for(let rn=0;rn<=Z;++rn)$e[rn]=Math.sin(rn/Z*2*Math.PI),nt[rn]=Math.cos(rn/Z*2*Math.PI);for(let rn=0;rn<=Ae;++rn){const Xt=(Ne.fPhi1+Ne.fDphi*rn/Ae)/180*Math.PI;rt[rn]=Math.sin(Xt),ct[rn]=Math.cos(Xt)}const zt=$?new yt:new st(Ce),at=new ve.Pq0,nn=new ve.Pq0,Wt=new ve.Pq0,gn=new ve.Pq0,ze=new ve.Pq0,Qe=new ve.Pq0,ut=new ve.Pq0,_t=new ve.Pq0,Lt=new ve.Pq0,xn=new ve.Pq0;for(let rn=0;rn<2&&!(rn>0&&Ne.fRmin<=0);++rn){const Xt=rn>0?Ne.fRmin:Ne.fRmax,cn=1-rn,Pn=1-cn,Zn=rn>0?-1:1;for(let Ui=0;Ui<Ae;++Ui){const Ki=Ui+cn,Ii=Ui+Pn;Lt.x=S*ct[Ki],Lt.y=S*rt[Ki],xn.x=S*ct[Ii],xn.y=S*rt[Ii];for(let vr=0;vr<Z;++vr)at.x=(S+Xt*nt[vr])*ct[Ki],at.y=(S+Xt*nt[vr])*rt[Ki],at.z=Xt*$e[vr],nn.x=(S+Xt*nt[vr+1])*ct[Ki],nn.y=(S+Xt*nt[vr+1])*rt[Ki],nn.z=Xt*$e[vr+1],Wt.x=(S+Xt*nt[vr+1])*ct[Ii],Wt.y=(S+Xt*nt[vr+1])*rt[Ii],Wt.z=Xt*$e[vr+1],gn.x=(S+Xt*nt[vr])*ct[Ii],gn.y=(S+Xt*nt[vr])*rt[Ii],gn.z=Xt*$e[vr],zt.addFace4(at.x,at.y,at.z,nn.x,nn.y,nn.z,Wt.x,Wt.y,Wt.z,gn.x,gn.y,gn.z),ze.subVectors(at,Lt).normalize(),Qe.subVectors(nn,Lt).normalize(),ut.subVectors(Wt,xn).normalize(),_t.subVectors(gn,xn).normalize(),zt.setNormal4(Zn*ze.x,Zn*ze.y,Zn*ze.z,Zn*Qe.x,Zn*Qe.y,Zn*Qe.z,Zn*ut.x,Zn*ut.y,Zn*ut.z,Zn*_t.x,Zn*_t.y,Zn*_t.z)}}if(360!==Ne.fDphi)for(let rn=0;rn<=Ae;rn+=Ae){const Xt=Ne.fRmax,cn=Ne.fRmin,Pn=rn>0?0:1,Zn=1-Pn,Ui=Ne.fRmin>0?0:1,Ki=rn>0?1:-1;for(let Ii=0;Ii<Z;++Ii)zt.addFace4((S+Xt*nt[Ii+Pn])*ct[rn],(S+Xt*nt[Ii+Pn])*rt[rn],Xt*$e[Ii+Pn],(S+cn*nt[Ii+Pn])*ct[rn],(S+cn*nt[Ii+Pn])*rt[rn],cn*$e[Ii+Pn],(S+cn*nt[Ii+Zn])*ct[rn],(S+cn*nt[Ii+Zn])*rt[rn],cn*$e[Ii+Zn],(S+Xt*nt[Ii+Zn])*ct[rn],(S+Xt*nt[Ii+Zn])*rt[rn],Xt*$e[Ii+Zn],Ui),zt.setNormal(-Ki*rt[rn],Ki*ct[rn],0)}return zt.create()}(Ne,$);case U:case j:return function yn(Ne,$){const S=Ne.fPhi1,Z=Ne.fDphi;let Ae,Ce;Ne._typename===j?(Ae=Ne.fNedges,Ce=1/Math.cos(Math.PI/180*Z/Ae/2)):(Ae=Math.max(5,Math.round(Z/ce.GradPerSegm)),Ce=1);const $e=new Int16Array(2*Ne.fNz);let nt=0,rt=!1;for(let ut=0;ut<Ne.fNz;++ut)Ne.fRmin[ut]>0&&(rt=!0);if($<0)return(rt?4:2)*Ae*(Ne.fNz-1);const ct=360===Z?null:[];for(let ut=0;ut<2;++ut){const _t=0===ut?"fRmax":"fRmin";for(let Lt=0;Lt<Ne.fNz;++Lt){const xn=Ne.fZ[Lt],rn=Ne[_t][Lt];$e[2*Lt+ut]=0,!(Lt>0&&Lt<Ne.fNz-1&&(Ne.fZ[Lt-1]===xn&&Ne[_t][Lt-1]===rn||Ne[_t][Lt+1]===rn&&Ne[_t][Lt-1]===rn))&&(Lt>0&&(0===ut||rt)&&($e[2*Lt+ut]=1,nt++),null!==ct&&(0===ut?ct.push(new ve.I9Y(Ce*rn,xn)):rn<Ne.fRmax[Lt]&&ct.unshift(new ve.I9Y(Ce*rn,xn))))}}let zt=nt*Ae*2;Ne.fRmin[0]!==Ne.fRmax[0]&&(zt+=Ae*(rt?2:1)),Ne.fRmin[Ne.fNz-1]!==Ne.fRmax[Ne.fNz-1]&&(zt+=Ae*(rt?2:1));let at=null;if(null!==ct){if(ct.length===2*Ne.fNz){at=[];for(let ut=Ne.fNz-1;ut>0;--ut){if(Ne.fZ[ut]===Ne.fZ[ut-1])continue;const _t=2*Ne.fNz-1-ut;at.push([_t,ut-1,ut]),at.push([_t,_t+1,ut-1])}}else at=ve.xJ6.triangulateShape(ct,[]);zt+=2*at.length}const nn=S*Math.PI/180,Wt=Z/Ae*Math.PI/180,gn=new Float32Array(Ae+1),ze=new Float32Array(Ae+1);for(let ut=0;ut<=Ae;++ut)ze[ut]=Math.cos(nn+ut*Wt),gn[ut]=Math.sin(nn+ut*Wt);const Qe=$?new yt:new st(zt);for(let ut=0;ut<2;++ut){const _t=0===ut?"fRmax":"fRmin",Lt=1-ut,xn=ut;let rn=Ne.fZ[0],Xt=Ce*Ne[_t][0];for(let cn=0;cn<Ne.fNz;++cn){if(0===$e[2*cn+ut])continue;const Pn=Ne.fZ[cn],Zn=Ce*Ne[_t][cn];let Ui=1,Ki=0;if(Zn!==Xt){const Ii=Math.atan2(Zn-Xt,Pn-rn);Ui=Math.cos(Ii),Ki=Math.sin(Ii)}ut>0&&(Ui*=-1,Ki*=-1);for(let Ii=0;Ii<Ae;++Ii)Qe.addFace4(Xt*ze[Ii+Lt],Xt*gn[Ii+Lt],rn,Zn*ze[Ii+Lt],Zn*gn[Ii+Lt],Pn,Zn*ze[Ii+xn],Zn*gn[Ii+xn],Pn,Xt*ze[Ii+xn],Xt*gn[Ii+xn],rn),Qe.setNormal_12_34(Ui*ze[Ii+Lt],Ui*gn[Ii+Lt],Ki,Ui*ze[Ii+xn],Ui*gn[Ii+xn],Ki);rn=Pn,Xt=Zn}}for(let ut=0;ut<Ne.fNz;ut+=Ne.fNz-1){const _t=Ce*Ne.fRmin[ut],Lt=Ce*Ne.fRmax[ut];if(_t===Lt)continue;const xn=Ne.fZ[ut],rn=0===ut?1:0,Xt=1-rn,cn=0===ut?-1:1;!rt&&!at&&Qe.startPolygon(ut>0);for(let Pn=0;Pn<Ae;++Pn)Qe.addFace4(_t*ze[Pn+rn],_t*gn[Pn+rn],xn,Lt*ze[Pn+rn],Lt*gn[Pn+rn],xn,Lt*ze[Pn+Xt],Lt*gn[Pn+Xt],xn,_t*ze[Pn+Xt],_t*gn[Pn+Xt],xn,rt?0:2),Qe.setNormal(0,0,cn);Qe.stopPolygon()}if(at)for(let ut=0;ut<=Ae;ut+=Ae){const _t=0===ut?1:2,Lt=3-_t;for(let xn=0;xn<at.length;++xn){const rn=ct[at[xn][0]],Xt=ct[at[xn][_t]],cn=ct[at[xn][Lt]];Qe.addFace3(rn.x*ze[ut],rn.x*gn[ut],rn.y,Xt.x*ze[ut],Xt.x*gn[ut],Xt.y,cn.x*ze[ut],cn.x*gn[ut],cn.y),Qe.calcNormal()}}return Qe.create()}(Ne,$);case I:return function Tn(Ne,$){let S=(Ne.fNz-1)*Ne.fNvert*2;if($<0)return S+3*Ne.fNvert;const Z=[];for(let $e=0;$e<Ne.fNvert;++$e)Z.push(new ve.I9Y(Ne.fX[$e],Ne.fY[$e]));let Ae=ve.xJ6.triangulateShape(Z,[]);Ae.length<Z.length-2?(Ze(`Problem with XTRU shape ${Ne.fName} with ${Z.length} vertices`),Ae=[]):S+=2*Ae.length;const Ce=$?new yt:new st(S);for(let $e=0;$e<Ne.fNz-1;++$e){const nt=Ne.fZ[$e],rt=Ne.fScale[$e],ct=Ne.fZ[$e+1],zt=Ne.fScale[$e+1],at=Ne.fX0[$e],nn=Ne.fX0[$e+1],Wt=Ne.fY0[$e],gn=Ne.fY0[$e+1];for(let ze=0;ze<Ne.fNvert;++ze){const Qe=(ze+1)%Ne.fNvert;Ce.addFace4(rt*Ne.fX[ze]+at,rt*Ne.fY[ze]+Wt,nt,zt*Ne.fX[ze]+nn,zt*Ne.fY[ze]+gn,ct,zt*Ne.fX[Qe]+nn,zt*Ne.fY[Qe]+gn,ct,rt*Ne.fX[Qe]+at,rt*Ne.fY[Qe]+Wt,nt),Ce.calcNormal()}}for(let $e=0;$e<=Ne.fNz-1;$e+=Ne.fNz-1){const nt=Ne.fZ[$e],rt=Ne.fScale[$e],ct=Ne.fX0[$e],zt=Ne.fY0[$e];for(let at=0;at<Ae.length;++at){const nn=Ae[at],Wt=Z[nn[0]],gn=Z[nn[0===$e?2:1]],ze=Z[nn[0===$e?1:2]];Ce.addFace3(rt*Wt.x+ct,rt*Wt.y+zt,nt,rt*gn.x+ct,rt*gn.y+zt,nt,rt*ze.x+ct,rt*ze.y+zt,nt),Ce.setNormal(0,0,0===$e?-1:1)}}return Ce.create()}(Ne,$);case F:return function Hn(Ne,$){let S=Math.max(4,Math.round(360/ce.GradPerSegm)),Z=30;if($>0){const _t=2*S*(Z+1)/$;_t>1&&(S=Math.max(5,Math.floor(S/Math.sqrt(_t))),Z=Math.max(5,Math.floor(Z/Math.sqrt(_t))))}const Ae=Ne.fRlo,Ce=Ne.fRhi;let $e=(Z+1)*S*2;if(0===Ae&&($e-=2*S),0===Ce&&($e-=2*S),$<0)return $e;let nt=-Ne.fDZ,rt=Ne.fDZ;Ne.fA>=0?Ne.fB>nt&&(nt=Ne.fB):Ne.fB<rt&&(rt=Ne.fB);const ct=Math.atan2(nt,Ae),zt=Math.atan2(rt,Ce),at=new Float32Array(S+1),nn=new Float32Array(S+1);for(let _t=0;_t<=S;++_t)nn[_t]=Math.cos(_t/S*2*Math.PI),at[_t]=Math.sin(_t/S*2*Math.PI);const Wt=$?new yt:new st($e);let gn=nt,ze=0,Qe=0,ut=-1;for(let _t=0;_t<=Z+1;++_t){let Lt=0,xn=0,rn=0,Xt=-1;if(0===_t&&0===Ae)continue;if(_t===Z+1&&0===ze)break;switch(_t){case 0:Lt=nt,xn=Ae;break;case Z:Lt=rt,xn=Ce;break;case Z+1:Lt=rt,xn=0;break;default:{const Pn=Math.tan(ct+(zt-ct)*_t/Z);xn=.5*(Pn+Math.sqrt(Pn**2-4*Ne.fA*Ne.fB))/Ne.fA,xn<1e-6&&(xn=0),Lt=xn*Pn}}rn=Ne.fA*xn,Xt=Ne.fA>0?-1:1;const cn=0===ze?1:0===xn?2:0;for(let Pn=0;Pn<S;++Pn)Wt.addFace4(xn*nn[Pn],xn*at[Pn],Lt,ze*nn[Pn],ze*at[Pn],gn,ze*nn[Pn+1],ze*at[Pn+1],gn,xn*nn[Pn+1],xn*at[Pn+1],Lt,cn),0===cn||1===_t&&0===Ae||_t===Z+1&&0===Ce?Wt.setNormal4(rn*nn[Pn],rn*at[Pn],Xt,Qe*nn[Pn],Qe*at[Pn],ut,Qe*nn[Pn+1],Qe*at[Pn+1],ut,rn*nn[Pn+1],rn*at[Pn+1],Xt,cn):Wt.setNormal(0,0,_t<Z?-1:1);gn=Lt,ze=xn,Qe=rn,ut=Xt}return Wt.create()}(Ne,$);case J:return function ti(Ne,$){if(0===Ne.fTin&&0===Ne.fTout)return Qt(Ne,$);let S=Math.max(4,Math.round(360/ce.GradPerSegm)),Z=30,Ae=S*(Z+1)*(Ne.fRmin>0?4:2);if($<0)return Ae;$>0&&$>Ae&&(S=Math.max(4,Math.floor(S/Math.sqrt(Ae/$))),Z=Math.max(4,Math.floor(Z/Math.sqrt(Ae/$))),Ae=S*(Z+1)*(Ne.fRmin>0?4:2));const Ce=new Float32Array(S+1),$e=new Float32Array(S+1);for(let rt=0;rt<=S;++rt)$e[rt]=Math.cos(rt/S*2*Math.PI),Ce[rt]=Math.sin(rt/S*2*Math.PI);const nt=$?new yt:new st(Ae);for(let rt=0;rt<2&&!(rt>0&&Ne.fRmin<=0);++rt){const ct=rt>0?Ne.fRmin:Ne.fRmax,zt=rt>0?Ne.fTinsq:Ne.fToutsq,at=1-rt,nn=1-at;for(let Wt=0;Wt<Z;++Wt){const gn=Wt/Z*2*Ne.fDz-Ne.fDz,ze=(Wt+1)/Z*2*Ne.fDz-Ne.fDz,Qe=Math.sqrt(ct**2+zt*gn**2),ut=Math.sqrt(ct**2+zt*ze**2);for(let _t=0;_t<S;++_t)nt.addFace4(Qe*$e[_t+at],Qe*Ce[_t+at],gn,ut*$e[_t+at],ut*Ce[_t+at],ze,ut*$e[_t+nn],ut*Ce[_t+nn],ze,Qe*$e[_t+nn],Qe*Ce[_t+nn],gn),nt.calcNormal()}}for(let rt=0;rt<2;++rt){const ct=0===rt?Ne.fDz:-Ne.fDz,zt=Math.sqrt(Ne.fRmax**2+Ne.fToutsq*ct**2),at=Ne.fRmin>0?Math.sqrt(Ne.fRmin**2+Ne.fTinsq*ct**2):0,nn=Ne.fRmin>0?0:1,Wt=1-rt,gn=1-Wt;for(let ze=0;ze<S;++ze)nt.addFace4(zt*$e[ze+Wt],zt*Ce[ze+Wt],ct,at*$e[ze+Wt],at*Ce[ze+Wt],ct,at*$e[ze+gn],at*Ce[ze+gn],ct,zt*$e[ze+gn],zt*Ce[ze+gn],ct,nn),nt.setNormal(0,0,0===rt?1:-1)}return nt.create()}(Ne,$);case"TGeoTessellated":return function hi(Ne,$){let S=0;for(let Ae=0;Ae<Ne.fFacets.length;++Ae)S+=4===Ne.fFacets[Ae].fNvert?2:1;if($<0)return S;const Z=$?new yt:new st(S);for(let Ae=0;Ae<Ne.fFacets.length;++Ae){const Ce=Ne.fFacets[Ae],$e=Ne.fVertices[Ce.fIvert[0]].fVec,nt=Ne.fVertices[Ce.fIvert[1]].fVec,rt=Ne.fVertices[Ce.fIvert[2]].fVec;if(4===Ce.fNvert){const ct=Ne.fVertices[Ce.fIvert[3]].fVec;Z.addFace4($e[0],$e[1],$e[2],nt[0],nt[1],nt[2],rt[0],rt[1],rt[2],ct[0],ct[1],ct[2]),Z.calcNormal()}else Z.addFace3($e[0],$e[1],$e[2],nt[0],nt[1],nt[2],rt[0],rt[1],rt[2]),Z.calcNormal()}return Z.create()}(Ne,$);case _e:return function W(Ne,$){if($<0)return me(Ne.fNode.fLeft,-1)+me(Ne.fNode.fRight,-1);let S,Z,Ae=!1;const Ce=ai(Ne.fNode.fLeftMat),$e=ai(Ne.fNode.fRightMat);if(0===$?$=4e3:Ae=!0,Ce&&Ce.determinant()<-.9&&Ze("Axis reflection in left composite shape - not supported"),$e&&$e.determinant()<-.9&&Ze("Axis reflections in right composite shape - not supported"),S=Ne.fNode.fLeft._typename===be?ds(Ne.fNode.fLeft):me(Ne.fNode.fLeft,$),!S)return null;let nt=wt(S),rt=0;if(S._exceed_limit&&(nt+=$),nt<$&&(Z=Ne.fNode.fRight._typename===be?ds(Ne.fNode.fRight,S):me(Ne.fNode.fRight,$),rt=wt(Z)),nt+rt>=$||!Z)return S.polygons&&(S=He(S.polygons)),Ce&&S.applyMatrix4(Ce),S._exceed_limit=!0,S;let ct=new Ie(S,Ce,ce.CompressComp?0:void 0);const zt=new Ie(Z,$e,ct.maxid);switch(ct.maxid=zt.maxid,Ne.fNode._typename){case"TGeoIntersection":ct.direct_intersect(zt);break;case"TGeoUnion":ct.direct_union(zt);break;case"TGeoSubtraction":ct.direct_subtract(zt);break;default:Ze("unsupported bool operation "+Ne.fNode._typename+", use first geom")}return 0===wt(ct)&&(Ze(`Zero faces in comp shape left: ${Ne.fNode.fLeft._typename} ${wt(S)} faces right: ${Ne.fNode.fRight._typename} ${wt(Z)} faces  use first`),ct=new Ie(S,Ce)),Ae?{polygons:ct.toPolygons()}:ct.toBufferGeometry()}(Ne,$);case te:break;case Te:{const S=me(Ne.fShape,$);return Ne.fScale&&$>=0&&(0,b.isFunc)(S?.scale)&&S.scale(Ne.fScale.fScale[0],Ne.fScale.fScale[1],Ne.fScale.fScale[2]),S}case be:if($<0)return 1;default:Ze(`unsupported shape type ${Ne._typename}`)}}catch(S){let Z="";void 0!==S.stack&&(Z=S.stack.split("\n")[0],Z=Z.indexOf(S.message)>=0?S.stack.split("\n")[1]:"at: "+Z),Ze(`${Ne._typename} err: ${S.message} ${Z}`)}return $<0?0:null}function Et(Ne,$){if(Ne.server_shape&&(Ne.nsegm===$||!Ne.shape))return Ne.server_shape;Ne.nsegm=$;let S=null;if(Ne.shape)S=me(Ne.shape);else{if(!Ne.raw?.buffer)return console.error("No raw data at all"),null;S=Ne.sz?function Fe(Ne){let $=0;if(Ne.sz[0]&&(Ne.vtxBuff=new Float32Array(Ne.raw.buffer,$,Ne.sz[0]),$+=4*Ne.sz[0]),Ne.sz[1]&&($+=4*Ne.sz[1]),Ne.sz[2]&&(Ne.prefixBuf=new Uint32Array(Ne.raw.buffer,$,2),$+=8,Ne.idxBuff=new Uint32Array(Ne.raw.buffer,$,Ne.sz[2]-2)),4!==Ne.prefixBuf[0])throw Error("Expect triangles first.");if(Ne.idxBuff.length!==3*Ne.prefixBuf[1])throw Error("Expect single list of triangles in index buffer.");const Ae=new ve.LoY;return Ae.setAttribute("position",new ve.THS(Ne.vtxBuff,3)),Ae.setIndex(new ve.THS(Ne.idxBuff,1)),Ae.computeVertexNormals(),Ae}(Ne):function At(Ne){const $=new Float32Array(Ne.raw.buffer,0,Ne.raw.buffer.byteLength/4),S=new ve.LoY;return S.setAttribute("position",new ve.THS($,3)),S.setIndex(new ve.THS(new Uint32Array(Ne.idx),1)),S.computeVertexNormals(),S}(Ne)}return{_typename:"$$Shape$$",ready:!0,geom:S,nfaces:Or(S)}}function St(Ne){let $=[],S=null;if(void 0!==Ne.fVolume?S=Ne.fVolume.fShape:void 0!==Ne.fShape?S=Ne.fShape:void 0!==Ne.fShapeBits&&void 0!==Ne.fShapeId&&(S=Ne),!S)return $.push(Ne._typename),$;const Z=Math.max(S.fDX,S.fDY,S.fDZ),Ae=Z>1e7||Z<1e-7,Ce=$e=>void 0===$e?"???":$e===Math.round($e)&&$e<1e7?Math.round($e):Ae?$e.toExponential(4):$e.toPrecision(7);switch($.push(S._typename),$.push(`DX=${Ce(S.fDX)} DY=${Ce(S.fDY)} DZ=${Ce(S.fDZ)}`),S._typename){case Y:break;case L:$.push(`Alpha=${S.fAlpha} Phi=${S.fPhi} Theta=${S.fTheta}`);break;case C:$.push(`Dy1=${Ce(S.fDy1)} Dy2=${Ce(S.fDy1)}`);case _:$.push(`Dx1=${Ce(S.fDx1)} Dx2=${Ce(S.fDx1)}`);break;case V:case A:case R:break;case N:$.push(`Rmin=${Ce(S.fRmin)} Rmax=${Ce(S.fRmax)}`,`Phi1=${S.fPhi1} Phi2=${S.fPhi2}`,`Theta1=${S.fTheta1} Theta2=${S.fTheta2}`);break;case w:$.push(`Phi1=${S.fPhi1} Phi2=${S.fPhi2}`);case D:$.push(`Rmin1=${Ce(S.fRmin1)} Rmax1=${Ce(S.fRmax1)}`,`Rmin2=${Ce(S.fRmin2)} Rmax2=${Ce(S.fRmax2)}`);break;case v:case x:$.push(`Phi1=${S.fPhi1} Phi2=${S.fPhi2}`);case k:case P:$.push(`Rmin=${Ce(S.fRmin)} Rmax=${Ce(S.fRmax)}`);break;case m:$.push(`Rmin=${Ce(S.fRmin)} Rmax=${Ce(S.fRmax)}`,`Phi1=${S.fPhi1} Dphi=${S.fDphi}`);break;case U:case j:case I:break;case F:$.push(`Rlo=${Ce(S.fRlo)} Rhi=${Ce(S.fRhi)}`,`A=${Ce(S.fA)} B=${Ce(S.fB)}`);break;case J:$.push(`Rmin=${Ce(S.fRmin)} Rmax=${Ce(S.fRmax)}`,`StIn=${Ce(S.fStIn)} StOut=${Ce(S.fStOut)}`);break;case _e:case te:break;case Te:$=St(S.fShape),S.fScale&&$.unshift(`Scale X=${S.fScale.fScale[0]} Y=${S.fScale.fScale[1]} Z=${S.fScale.fScale[2]}`)}return $}function xt(Ne){const $=new ve.kn4;return Ne.updateMatrixWorld(),Ne.matrixWorldInverse.copy(Ne.matrixWorld).invert(),$.multiplyMatrices(Ne.projectionMatrix,Ne.matrixWorldInverse),$}function En(Ne){if(!Ne)return null;Ne instanceof ve.ubm&&(Ne=xt(Ne));const $=new ve.PPD;return $.setFromProjectionMatrix(Ne),$.corners=new Float32Array([1,1,1,1,1,-1,1,-1,1,1,-1,-1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1,0,0,0]),$.test=new ve.Pq0(0,0,0),$.CheckShape=function(S,Z){const Ae=this.test,Ce=this.corners.length,$e=this.corners;for(let nt=0;nt<Ce;nt+=3)if(Ae.x=$e[nt]*Z.fDX,Ae.y=$e[nt+1]*Z.fDY,Ae.z=$e[nt+2]*Z.fDZ,this.containsPoint(Ae.applyMatrix4(S)))return!0;return!1},$.CheckBox=function(S){const Z=this.test;let Ae=0;return Z.set(S.min.x,S.min.y,S.min.z),this.containsPoint(Z)&&Ae++,Z.set(S.min.x,S.min.y,S.max.z),this.containsPoint(Z)&&Ae++,Z.set(S.min.x,S.max.y,S.min.z),this.containsPoint(Z)&&Ae++,Z.set(S.min.x,S.max.y,S.max.z),this.containsPoint(Z)&&Ae++,Z.set(S.max.x,S.max.y,S.max.z),this.containsPoint(Z)&&Ae++,Z.set(S.max.x,S.min.y,S.max.z),this.containsPoint(Z)&&Ae++,Z.set(S.max.x,S.max.y,S.min.z),this.containsPoint(Z)&&Ae++,Z.set(S.max.x,S.max.y,S.max.z),this.containsPoint(Z)&&Ae++,Ae>5},$}function jt(Ne,$){Ne||(Ne={material_kind:"lambert"});const S=Object.assign({},$);let Z;return void 0===S.opacity&&(S.opacity=1),Ne.transparency&&(S.opacity=Math.min(1-Ne.transparency,S.opacity)),S.wireframe=Ne.wireframe??!1,S.color||(S.color="red"),S.side=ve.hB5,S.transparent=S.opacity<1,S.depthWrite=1===S.opactity,"basic"===Ne.material_kind?Z=new ve.V9B(S):"depth"===Ne.material_kind?(delete S.color,Z=new ve.CSG(S)):"toon"===Ne.material_kind?Z=new ve.Df(S):"matcap"===Ne.material_kind?(delete S.wireframe,Z=new ve.FNr(S)):"standard"===Ne.material_kind?(S.metalness=Ne.metalness??.5,S.roughness=Ne.roughness??.1,Z=new ve._4j(S)):"normal"===Ne.material_kind?(delete S.color,Z=new ve.qBx(S)):"physical"===Ne.material_kind?(S.metalness=Ne.metalness??.5,S.roughness=Ne.roughness??.1,S.reflectivity=Ne.reflectivity??.5,S.emissive=S.color,Z=new ve.uSd(S)):"phong"===Ne.material_kind?(S.shininess=Ne.shininess??.9,Z=new ve.tXL(S)):(S.vertexColors=!1,Z=new ve.G_z(S)),void 0!==Z.flatShading&&void 0!==Ne.flatShading&&(Z.flatShading=Ne.flatShading),Z.inherentOpacity=$.opacity??1,Z.inherentArgs=$,Z}function Cn(Ne,$){if(Ne===$)return 0;const S=Ne?.length??0,Z=$?.length??0,Ae=S<Z?S:Z;let Ce=0;for(;Ce<Ae;){if(Ne[Ce]<$[Ce])return-1;if(Ne[Ce]>$[Ce])return 1;++Ce}return S<Z?-1:S>Z?1:0}function ln(Ne,$){if(!Ne||!$)return!1;if(Ne===$)return!0;if(Ne.length!==$.length)return!1;for(let S=0;S<Ne.length;++S)if(Ne[S]!==$[S])return!1;return!0}class Un{constructor($,S){this.toplevel=!0,this.name_prefix="",this.maxdepth=1,this.vislevel=4,this.maxnodes=1e4,$?($.$geoh&&(this.toplevel=!1),this.createClones($)):S&&(this.nodes=S)}setVisLevel($){this.vislevel=$&&Number.isInteger($)?$:4}getVisLevel(){return this.vislevel}setMaxVisNodes($,S){this.maxnodes=Number.isFinite($)?$:1e4,S&&Number.isFinite(S)&&(this.maxnodes*=S)}getMaxVisNodes(){return this.maxnodes}setConfig($){this._cfg=$}updateNode($){$&&Number.isInteger($.id)&&$.id<this.nodes.length&&(this.nodes[$.id]=$)}getNodeShape($){if(!this.origin||!this.nodes)return null;const S=this.origin[$],Z=this.nodes[$];return S&&Z?Z.kind!==he?S.fShape:S.fVolume?S.fVolume.fShape:null:null}cleanup($,S){if($)for(let Z=0;Z<$.length;++Z)delete $[Z].stack,$[Z]=void 0;if(S)for(let Z=0;Z<S.length;++Z)delete S[Z].geom,S[Z]=void 0;if(this.nodes)for(let Z=0;Z<this.nodes.length;++Z)this.nodes[Z]&&delete this.nodes[Z].chlds;delete this.nodes,delete this.origin,delete this.sortmap}createClones($,S,Z){if(!S){if("$$Shape$$"===$?._typename)return this.createClonesForShape($);this.origin=[],S=1,Z=Ue($)}if(Z<0||!$||"_refid"in $)return;$._refid=this.origin.length,this.origin.push($),S>this.maxdepth&&(this.maxdepth=S);let Ae=null;if(Ae=Z===he?$.fVolume?.fNodes?.arr||null:$.fElements?.arr||null,null!==Ae){gt($,Ae);for(let $e=0;$e<Ae.length;++$e)this.createClones(Ae[$e],S+1,Z)}if(S>1)return;this.nodes=[];const Ce=[];for(let $e=0;$e<this.origin.length;++$e){const nt={id:$e,kind:Z,vol:0,nfaces:0};this.nodes.push(nt),Ce.push(nt)}for(let $e=0;$e<this.origin.length;++$e){const nt=this.origin[$e],rt=this.nodes[$e];let ct=null,zt=null;Z===ue?(zt=nt.fShape,nt.fElements&&(ct=nt.fElements.arr)):nt.fVolume&&(zt=nt.fVolume.fShape,nt.fVolume.fNodes&&(ct=nt.fVolume.fNodes.arr));const at=Xi(Z,nt);if(at){if(rt.matrix=at.elements,1===rt.matrix[0]){let nn=!0;for(let Wt=1;Wt<rt.matrix.length&&nn;++Wt)nn=rt.matrix[Wt]===(5===Wt||10===Wt||15===Wt?1:0);nn&&delete rt.matrix}rt.matrix&&Z===ue&&(rt.abs_matrix=!0)}if(zt&&(rt.fDX=zt.fDX,rt.fDY=zt.fDY,rt.fDZ=zt.fDZ,rt.vol=Math.sqrt(zt.fDX**2+zt.fDY**2+zt.fDZ**2),void 0===zt.$nfaces&&(zt.$nfaces=me(zt,-1)),rt.nfaces=zt.$nfaces,rt.nfaces<=0&&(rt.vol=0)),ct){rt.chlds=new Array(ct.length);for(let nn=0;nn<ct.length;++nn)rt.chlds[nn]=ct[nn]._refid}}for(let $e=0;$e<this.origin.length;++$e)delete this.origin[$e]._refid;Ce.sort(($e,nt)=>nt.vol-$e.vol),this.sortmap=new Array(this.nodes.length);for(let $e=0;$e<this.nodes.length;++$e)this.sortmap[$e]=Ce[$e].id,Ce[$e].sortid=$e}createClonesForShape($){this.origin=[],this.plain_shape=$,this.nodes=[{id:0,sortid:0,kind:2,name:"Shape",nfaces:$.nfaces,fDX:1,fDY:1,fDZ:1,vol:1,vis:!0}]}countVisibles(){const $=this.nodes?.length||0;let S=0;for(let Z=0;Z<$;++Z)this.nodes[Z].vis&&S++;return S}markVisibles($,S,Z){if(this.plain_shape)return 1;if(!this.origin||!this.nodes)return 0;let Ae=0;for(let Ce=0;Ce<this.nodes.length;++Ce){const $e=this.nodes[Ce],nt=this.origin[Ce];$e.vis=0,delete $e.nochlds,$e.kind===he?nt.fVolume&&($?($e.vis=Pe(nt.fVolume,le.kVisOnScreen)?99:0,0===Ce&&$e.vis&&Z&&($e.vis=0),S&&(We(nt.fVolume,le.kVisNone,!1),We(nt.fVolume,le.kVisThis,$e.vis>0),We(nt.fVolume,le.kVisDaughters,!0),We(nt,le.kVisDaughters,!0))):($e.vis=!Pe(nt.fVolume,le.kVisNone)&&Pe(nt.fVolume,le.kVisThis)?99:0,(!Pe(nt,le.kVisDaughters)||!Pe(nt.fVolume,le.kVisDaughters))&&($e.nochlds=!0),$e.vis>0&&$e.chlds&&!$e.nochlds&&($e.vis=1),0===Ce&&(Z&&($e.vis=0),delete $e.nochlds))):($e.vis=nt.fRnrSelf?99:0,0===Ce&&1===this.nodes.length&&($e.vis=99),this.vislevel=9999),($e.vol<=0||$e.nfaces<=0)&&($e.vis=0),$e.vis&&Ae++}return Ae}produceIdShifts(){for(let S=0;S<this.nodes.length;++S)this.nodes[S].idshift=-1;!function $(S,Z){if(Z.idshift<0&&(Z.idshift=0,Z.chlds))for(let Ae=0;Ae<Z.chlds.length;++Ae)Z.idshift+=$(S,S[Z.chlds[Ae]]);return Z.idshift+1}(this.nodes,this.nodes[0])}getVisibleFlags(){const $=new Array(this.nodes.length);for(let S=0;S<this.nodes.length;++S)$[S]={vis:this.nodes[S].vis,nochlds:this.nodes[S].nochlds};return $}setVisibleFlags($){if(!this.nodes||!$||!$.length!==this.nodes.length)return 0;let S=0;for(let Z=0;Z<this.nodes.length;++Z){const Ae=this.nodes[Z];Ae.vis=$[Z].vis,Ae.nochlds=$[Z].nochlds,Ae.vis&&S++}return S}setPhysNodeVisibility($,S){let Z=!1;if("clearall"!==S){if("clear"===S){if(Z=!0,!this.fVisibility)return}else S=!!S;if($){this.fVisibility||(this.fVisibility=[]);for(let Ae=0;Ae<this.fVisibility.length;++Ae){const Ce=this.fVisibility[Ae],$e=Cn(Ce.stack,$);if(0===$e)return void(Z?(this.fVisibility.splice(Ae,1),0===this.fVisibility.length&&delete this.fVisibility):Ce.visible=S);if($e>0)return void(Z||this.fVisibility.splice(Ae,0,{visible:S,stack:$}))}Z||this.fVisibility.push({visible:S,stack:$})}}else delete this.fVisibility}getPhysNodeVisibility($){if(!$||!this.fVisibility)return null;for(let S=0;S<this.fVisibility.length;++S){const Z=this.fVisibility[S],Ae=Cn(Z.stack,$);if(0===Ae)return Z;if(Ae>0)return null}return null}scanVisible($,S){if(!this.nodes)return 0;void 0===S&&($||($={}),(S=$.vislvl||this.vislevel||4)>88&&(S=88),$.stack=new Array(100),$.nodeid=0,$.counter=0,$.last=0,$.copyStack=function(nt){const rt={nodeid:this.nodeid,seqid:this.counter,stack:new Array(this.last)};nt&&(rt.factor=nt);for(let ct=0;ct<this.last;++ct)rt.stack[ct]=this.stack[ct+1];return rt},$.domatrix&&($.matrices=[],$.mpool=[new ve.kn4],$.getmatrix=function(){return this.matrices[this.last]}),this.fVisibility?.length&&($.vindx=0,$.varray=this.fVisibility,$.vstack=$.varray[$.vindx].stack,$.testPhysVis=function(){if(!this.vstack||this.vstack?.length!==this.last)return;for(let rt=0;rt<this.last;++rt)if(this.vstack[rt]!==this.stack[rt+1])return;const nt=this.varray[this.vindx++].visible;return this.vstack=this.vindx<this.varray.length?this.varray[this.vindx].stack:null,nt}));const Z=this.nodes[$.nodeid];let Ae=0;if($.domatrix){$.mpool[$.last+1]||($.mpool[$.last+1]=new ve.kn4);const nt=$.last>0?$.matrices[$.last-1]:new ve.kn4;Z.matrix?($.matrices[$.last]=$.mpool[$.last].fromArray(nt.elements),$.matrices[$.last].multiply($.mpool[$.last+1].fromArray(Z.matrix))):$.matrices[$.last]=nt}let Ce=Z.vis,$e=Z.nochlds;if(0===$.nodeid&&$.main_visible)Ce=S+1;else if($.testPhysVis){const nt=$.testPhysVis();void 0!==nt&&(Ce=nt&&!Z.chlds?S+1:0,$e=!nt)}if($e&&(S=0),Ce>S&&(!$.func||$.func(Z))&&Ae++,$.counter++,S>0&&Z.chlds){$.last++;for(let nt=0;nt<Z.chlds.length;++nt)$.nodeid=Z.chlds[nt],$.stack[$.last]=nt,Ae+=this.scanVisible($,S-1);$.last--}else $.counter+=Z.idshift||0;return 0===$.last&&(delete $.last,delete $.stack,delete $.copyStack,delete $.counter,delete $.matrices,delete $.mpool,delete $.getmatrix,delete $.vindx,delete $.varray,delete $.vstack,delete $.testPhysVis),Ae}getNodeName($){if(this.origin){const Z=this.origin[$];return Z?lt(Z):""}const S=this.nodes[$];return S?S.name:""}resolveStack($,S){const Z={id:0,obj:null,node:this.nodes[0],name:this.name_prefix||""};if(S&&(Z.matrix=new ve.kn4,Z.node.matrix&&Z.matrix.fromArray(Z.node.matrix)),this.origin&&(Z.obj=this.origin[0]),$)for(let Ae=0;Ae<$.length;++Ae){Z.id=Z.node.chlds[$[Ae]],Z.node=this.nodes[Z.id],this.origin&&(Z.obj=this.origin[Z.id]);const Ce=this.getNodeName(Z.id);Ce&&(Z.name&&(Z.name+="/"),Z.name+=Ce),S&&Z.node.matrix&&Z.matrix.multiply((new ve.kn4).fromArray(Z.node.matrix))}return Z}getStackName($){return this.resolveStack($).name}buildStackByIds($){if(!$)return null;if(0!==$[0])return console.error("wrong ids - first should be 0"),null;let S=this.nodes[0];const Z=[];for(let Ae=1;Ae<$.length;++Ae){const Ce=$[Ae];if(!S)return null;const $e=S.chlds.indexOf(Ce);if($e<0)return console.error(`wrong nodes ids ${$[Ae]} is not child of ${$[Ae-1]}`),null;Z.push($e),S=this.nodes[Ce]}return Z}buildIdsByStack($){if(!$)return null;let S=this.nodes[0];const Z=[0];for(let Ae=0;Ae<$.length;++Ae){const Ce=S.chlds[$[Ae]];Z.push(Ce),S=this.nodes[Ce]}return Z}getNodeIdByStack($){if(!$||!this.nodes)return-1;let S=this.nodes[0],Z=0;for(let Ae=0;Ae<$.length;++Ae)Z=S.chlds[$[Ae]],S=this.nodes[Z];return Z}isIdInStack($,S){if(!$)return!0;let Z=this.nodes[0],Ae=0;for(let Ce=0;Ce<S.length;++Ce){if(Ae=Z.chlds[S[Ce]],Ae===$)return!0;Z=this.nodes[Ae]}return!1}findStackByName($){const S=$.split("/"),Z=[];let Ae=0;if(this.getNodeName(Ae)!==S[0])return null;for(let Ce=1;Ce<S.length;++Ce){const $e=this.nodes[Ae];if(!$e.chlds)return null;for(let nt=0;nt<$e.chlds.length;++nt){const rt=$e.chlds[nt];if(this.getNodeName(rt)===S[Ce]){Z.push(nt),Ae=rt;break}}if(Z.length===Ce-1)return null}return Z}setDefaultColors($){if(this.use_dflt_colors=$,this.use_dflt_colors&&!this.dflt_table){const S={kWhite:0,kBlack:1,kGray:920,kRed:632,kGreen:416,kBlue:600,kYellow:400,kMagenta:616,kCyan:432,kOrange:800,kSpring:820,kTeal:840,kAzure:860,kViolet:880,kPink:900},Z=110,Ae=[];for(let Ce=0;Ce<Z;Ce++)Ae.push(S.kGray);Ae[3]=S.kYellow-10,Ae[4]=Ae[5]=S.kGreen-10,Ae[6]=Ae[7]=S.kBlue-7,Ae[8]=Ae[9]=S.kMagenta-3,Ae[10]=Ae[11]=S.kRed-10,Ae[12]=S.kGray+1,Ae[13]=S.kBlue-10,Ae[14]=S.kOrange+7,Ae[16]=S.kYellow+1,Ae[20]=S.kYellow-10,Ae[24]=Ae[25]=Ae[26]=S.kBlue-8,Ae[29]=S.kOrange+9,Ae[79]=S.kOrange-2,this.dflt_table=Ae}}getDrawEntryProperties($,S){const Z=this.nodes[$.nodeid];if(2===Z.kind){const rt={name:Z.name,nname:Z.name,shape:null,material:null,chlds:null},ct=$.opacity||1,zt=$.color||"#0000FF";return rt.fillcolor=new ve.Q1f("#"===zt[0]?zt:`rgb(${zt})`),rt.material=jt(this._cfg,{opacity:ct,color:rt.fillcolor}),rt}if(!this.origin)return console.error("origin not there - kind",Z.kind,$.nodeid,Z),null;const Ce=this.origin[$.nodeid];if(Z.kind===ue){const rt={name:lt(Ce),nname:lt(Ce),shape:Ce.fShape,material:null,chlds:null};null!==Ce.fElements&&(rt.chlds=Ce.fElements.arr);{const ct=Math.min(1,Ce.fRGBA[3]);rt.fillcolor=new ve.Q1f(Ce.fRGBA[0],Ce.fRGBA[1],Ce.fRGBA[2]),rt.material=jt(this._cfg,{opacity:ct,color:rt.fillcolor})}return rt}const $e=Ce.fVolume,nt={name:lt($e),nname:lt(Ce),volume:$e,shape:$e.fShape,material:null,chlds:$e.fNodes?.arr,linewidth:$e.fLineWidth};{let rt=1;S||(S=["white","black","red","green","blue","yellow","magenta","cyan"]),$.custom_color?nt.fillcolor=$.custom_color:$e.fFillColor>1&&1===$e.fLineColor?nt.fillcolor=S[$e.fFillColor]:$e.fLineColor>=0&&(nt.fillcolor=S[$e.fLineColor]);const ct=$e.fMedium?.fMaterial;if(ct){const zt=ct.fFillStyle;let at=zt>=3e3&&zt<=3100?zt-3e3:0;if(this.use_dflt_colors){const nn=Math.round(ct.fZ);nt.fillcolor=S[this.dflt_table[nn]],ct.fDensity<.1&&(at=60)}at>0&&(rt=(100-at)/100),void 0===nt.fillcolor&&(nt.fillcolor=S[ct.fFillColor])}void 0===nt.fillcolor&&(nt.fillcolor="lightgrey"),nt.material=jt(this._cfg,{opacity:rt,color:nt.fillcolor})}return nt}createObject3D($,S,Z){let Ae=this.nodes[0],Ce=S,$e=0;const nt=(0,b.isObject)(Z)||"force"===Z;for(let rt=0;rt<=$.length;++rt){const ct=rt>0?$[rt-1]:0,zt=rt>0?this.nodes[Ae.chlds[ct]]:Ae;if(!zt)return console.error(`Wrong stack ${JSON.stringify($)} for nodes at level ${rt}, node.id ${Ae.id}, numnodes ${this.nodes.length}, nchld ${ct}, numchilds ${Ae.chlds.length}, chldid ${Ae.chlds[ct]}`),null;let at;if(Ae=zt,Ce.children)for(let nn=0;nn<Ce.children.length;++nn)if(Ce.children[nn].nchld===ct){at=Ce.children[nn];break}if(at)Ce=at,at.$jsroot_drawable&&$e++;else{if(!nt)return null;at=new ve.B69,this._cfg?.set_names&&(at.name=this.getNodeName(Ae.id)),this._cfg?.set_origin&&this.origin&&(at.userData=this.origin[Ae.id]),Ae.abs_matrix?(at.absMatrix=new ve.kn4,at.absMatrix.fromArray(Ae.matrix)):Ae.matrix&&(at.matrix.fromArray(Ae.matrix),at.matrix.decompose(at.position,at.quaternion,at.scale)),at.nchld=ct,Ce.add(at),0===rt&&(0,b.isObject)(Z)&&Z.scale&&(Z.scale.x<0||Z.scale.y<0||Z.scale.z<0)&&(at.scale.copy(Z.scale),at.updateMatrix()),at.updateMatrixWorld(),Ce=at}}if("mesh"===Z||"delete_mesh"===Z){let rt=null;if(Ce)for(let zt=0;zt<Ce.children.length&&!rt;++zt){const at=Ce.children[zt];"Mesh"===at.type&&void 0===at.nchld&&(rt=at)}if("mesh"===Z||!rt)return rt;const ct=Ce;for(;rt&&rt!==S;)Ce=rt.parent,Ce.remove(rt),rt=0===Ce.children.length?Ce:null;return ct}return Ce&&(Ce.$jsroot_drawable=!0,Ce.$jsroot_depth=$e),Ce}createEntryMesh($,S,Z,Ae,Ce){if(!Ae||!Ae.ready)return null;if(Z.done=!0,Ae.used=!0,!Ae.geom||!Ae.nfaces)return this.createObject3D(Z.stack,S,"delete_mesh"),null;const $e=this.getDrawEntryProperties(Z,Ce),nt=this.createObject3D(Z.stack,S,$),rt=nt.absMatrix||nt.matrixWorld;let ct;return $e.material.wireframe=$.wireframe,$e.material.side=$.doubleside?ve.$EB:ve.hB5,ct=rt.determinant()>-.9?new ve.eaF(Ae.geom,$e.material):function Rn(Ne,$){void 0===Ne.geomZ&&(Ne.geomZ=Ci(Ne.geom));const S=new ve.eaF(Ne.geomZ,$);return S.scale.copy(new ve.Pq0(1,1,-1)),S.updateMatrix(),S._flippedMesh=!0,S}(Ae,$e.material),nt.add(ct),nt.absMatrix&&(ct.matrix.copy(nt.absMatrix),ct.matrix.decompose(ct.position,ct.quaternion,ct.scale),ct.updateMatrixWorld()),ct.stack=Z.stack,ct.renderOrder=this.maxdepth-Z.stack.length,$.set_names&&(ct.name=this.getNodeName(Z.nodeid)),$.set_origin&&(ct.userData=$e.volume),ct.$jsroot_order=nt.$jsroot_depth,void 0!==$.info?.num_meshes&&($.info.num_meshes++,$.info.num_faces+=Ae.nfaces),ct}createInstancedMeshes($,S,Z,Ae,Ce){if($.instancing<0)return!1;const $e=[];let nt=1;for(let ct=0;ct<Z.length;++ct){const zt=Z[ct];if(zt.done)continue;const at=zt.server_shape||Ae[zt.shapeid];if(!at||!at.ready)return console.warn(`Problem with shape id ${zt.shapeid} when building`),!1;if(!at.geom||!at.nfaces)continue;void 0===at.instances&&(at.instances=[],$e.push(at));const nn=at.instances.find(Wt=>Wt.nodeid===zt.nodeid);nn?(nn.entries.push(zt),nt=Math.max(nt,nn.entries.length)):at.instances.push({nodeid:zt.nodeid,entries:[zt]})}return($.instancing>0?nt>2:Z.length>1e4&&nt>10)?($e.forEach(ct=>{ct.used=!0,ct.instances.forEach(zt=>{const at=zt.entries[0],nn=this.getDrawEntryProperties(at,Ce);if(nn.material.wireframe=$.wireframe,nn.material.side=$.doubleside?ve.$EB:ve.hB5,1===zt.entries.length)this.createEntryMesh($,S,at,ct,Ce);else{const Wt=[],gn=[],ze=[],Qe=[],ut=[],_t=[];if(zt.entries.forEach(Lt=>{const xn=this.resolveStack(Lt.stack,!0);xn.matrix.determinant()>-.9?(Wt.push(xn.matrix),ze.push(Lt.stack),ut.push(this.getNodeName(Lt.nodeid))):(gn.push(xn.matrix),Qe.push(Lt.stack),_t.push(this.getNodeName(Lt.nodeid))),Lt.done=!0}),Wt.length>0){const Lt=new ve.ZLX(ct.geom,nn.material,Wt.length);Lt.stacks=ze,Wt.forEach((xn,rn)=>Lt.setMatrixAt(rn,xn)),S.add(Lt),Lt.renderOrder=1,$.set_names&&(Lt.name=ut[0],Lt.names=ut),$.set_origin&&(Lt.userData=nn.volume),Lt.$jsroot_order=1,$.info.num_meshes++,$.info.num_faces+=ct.nfaces*Wt.length}if(gn.length>0){void 0===ct.geomZ&&(ct.geomZ=Ci(ct.geom));const Lt=new ve.ZLX(ct.geomZ,nn.material,gn.length);Lt.stacks=Qe;const xn=(new ve.kn4).makeScale(1,1,-1);gn.forEach((rn,Xt)=>{Lt.setMatrixAt(Xt,rn.multiply(xn))}),Lt._flippedMesh=!0,S.add(Lt),Lt.renderOrder=1,$.set_names&&(Lt.name=_t[0],Lt.names=_t),$.set_origin&&(Lt.userData=nn.volume),Lt.$jsroot_order=1,$.info.num_meshes++,$.info.num_faces+=ct.nfaces*gn.length}}}),delete ct.instances}),!0):($e.forEach(ct=>{delete ct.instances}),!1)}getVolumeBoundary($,S,Z){const Ae={min:0,max:1,sortidcut:0};if(!this.sortmap)return console.error("sorting map do not exist"),Ae;let Ce,$e,nt=0,rt=0;for(let ct=0;ct<this.sortmap.length&&nt<Z&&rt<S;++ct){const zt=this.sortmap[ct];0!==$[zt]&&($e=this.nodes[zt],Ce||(Ce=$e),nt+=$[zt],rt+=$[zt]*$e.nfaces)}return $e?(Ae.max=Ce.vol,Ae.min=$e.vol,Ae.sortidcut=$e.sortid,Ae):(console.error("no volumes selected"),Ae)}collectVisibles($,S){if(this.plain_shape)return{lst:[{nodeid:0,seqid:0,stack:[],factor:1,shapeid:0,server_shape:this.plain_shape}],complete:!0};const Z={facecnt:0,viscnt:new Array(this.nodes.length),vislvl:this.getVisLevel(),reset(){this.total=0,this.facecnt=0,this.viscnt.fill(0)},func(at){return this.total++,this.facecnt+=at.nfaces,this.viscnt[at.id]++,!0}};Z.reset();let Ae=this.scanVisible(Z);0===Ae&&this.nodes[0].vis<2&&!this.nodes[0].nochlds&&(Z.reset(),Z.main_visible=!0,Ae=this.scanVisible(Z));const Ce=this.getMaxVisNodes();if(Ce>0)for(;Ae>Ce&&Z.vislvl>1;)Z.vislvl--,Z.reset(),Ae=this.scanVisible(Z);this.actual_level=Z.vislvl;let $e=0,nt=0,rt=-1,ct=10,zt=this.nodes.length+1;if(Z.facecnt>$){const Wt=this.getVolumeBoundary(Z.viscnt,$*(S?.8:1),Ce*(S?.8:1));if($e=Wt.min,nt=Wt.max,zt=Wt.sortidcut,S){Z.domatrix=!0,Z.frustum=S,Z.totalcam=0,Z.func=function(gn){return gn.vol<=$e&&this.frustum.CheckShape(this.getmatrix(),gn)&&(this.viscnt[gn.id]++,this.totalcam+=gn.nfaces),!0};for(let gn=0;gn<Z.viscnt.length;++gn)Z.viscnt[gn]=0;this.scanVisible(Z),rt=Z.totalcam>.2*$?this.getVolumeBoundary(Z.viscnt,.2*$,.2*Ce).min:0,ct=nt/(rt>0?rt>0:$e)}}return Z.items=[],Z.func=function(at){return at.sortid<zt?this.items.push(this.copyStack()):rt>=0&&at.vol>rt&&this.frustum.CheckShape(this.getmatrix(),at)&&this.items.push(this.copyStack(ct)),!0},this.scanVisible(Z),{lst:Z.items,complete:0===$e}}mergeVisibles($,S){let Z=0;const Ae=[];for(let Ce=0;Ce<$.length&&Z<S.length;++Ce){for(;Z<S.length&&S[Z].seqid<$[Ce].seqid;)Ae.push(S[Z++]);Z<S.length&&S[Z].seqid===$[Ce].seqid&&(S[Z].done&&($[Ce].done=!0),Z++)}for(;Z<S.length;)Ae.push(S[Z++]);return Ae}collectShapes($){if(this.plain_shape)return[this.plain_shape];const S=[];for(let Z=0;Z<$.length;++Z){const Ae=$[Z],Ce=this.getNodeShape(Ae.nodeid);Ce&&(void 0===Ce._id?(Ce._id=S.length,S.push({id:Ce._id,shape:Ce,vol:this.nodes[Ae.nodeid].vol,refcnt:1,factor:1,ready:!1})):S[Ce._id].refcnt++,Ae.shape=S[Ce._id],Ae.factor&&Ae.factor>Ae.shape.factor&&(Ae.shape.factor=Ae.factor))}S.sort((Z,Ae)=>Ae.vol*Ae.factor-Z.vol*Z.factor);for(let Z=0;Z<S.length;++Z){const Ae=S[Z];Ae.id=Z,delete Ae.shape._id}for(let Z=0;Z<$.length;++Z){const Ae=$[Z];Ae.shape&&(Ae.shapeid=Ae.shape.id,delete Ae.shape)}return S}mergeShapesLists($,S){if(!$)return S;for(let Z=0;Z<$.length;++Z){const Ae=$[Z];Ae.shape._geom=Ae.geom,delete Ae.geom,void 0!==Ae.geomZ&&(Ae.shape._geomZ=Ae.geomZ,delete Ae.geomZ)}for(let Z=0;Z<S.length;++Z){const Ae=S[Z];void 0!==Ae.shape._geom&&(Ae.geom=Ae.shape._geom,delete Ae.shape._geom),void 0!==Ae.shape._geomZ&&(Ae.geomZ=Ae.shape._geomZ,delete Ae.shape._geomZ)}for(let Z=0;Z<$.length;++Z){const Ae=$[Z];delete Ae.shape._geom,delete Ae.shape._geomZ}return S}buildShapes($,S,Z){let Ae=0;const Ce=(new Date).getTime(),$e={done:!1,shapes:0,faces:0,notusedshapes:0};for(let nt=0;nt<$.length;++nt){const rt=$[nt];if($e.done)rt.ready=!0;else if(rt.ready||(rt._typename="$$Shape$$",rt.ready=!0,void 0===rt.geom&&(rt.geom=me(rt.shape),rt.geom&&Ae++),rt.nfaces=wt(rt.geom)),$e.shapes++,rt.used||$e.notusedshapes++,$e.faces+=rt.nfaces*rt.refcnt,$e.faces>=S)$e.done=!0;else if(Ae>.01*$.length&&void 0!==Z&&(new Date).getTime()-Ce>Z)return $e}return $e.done=!0,$e}static formatServerElement($){$.kind=2,$.vis=2;const S=$.matr;if(delete $.matr,!S?.length)return $;if(16===S.length)$.matrix=S;else{const Z=$.matrix=new Array(16);Z.fill(0),Z[0]=Z[5]=Z[10]=Z[15]=1,3===S.length?(Z[12]=S[0],Z[13]=S[1],Z[14]=S[2]):4===S.length?(Z[0]=S[0],Z[5]=S[1],Z[10]=S[2],Z[15]=S[3]):9===S.length?(Z[0]=S[0],Z[4]=S[1],Z[8]=S[2],Z[1]=S[3],Z[5]=S[4],Z[9]=S[5],Z[2]=S[6],Z[6]=S[7],Z[10]=S[8]):console.error(`wrong number of elements ${S.length} in the matrix`)}return $}}function Ci(Ne){let $=Ne.getAttribute("position").array,S=Ne.getAttribute("normal").array;const Z=Ne.getIndex();if(Z){const rt=Z.array,ct=Ne.drawRange.start;let zt=Ne.drawRange.count;ct+zt>rt.length&&(zt=rt.length-ct);const at=new Float32Array(3*zt),nn=new Float32Array(3*zt);for(let Wt=0;Wt<zt;++Wt){const gn=rt[ct+Wt];(gn<0||3*gn>=$.length)&&console.log(`strange index ${3*gn} totallen = ${$.length}`),at[3*Wt]=$[3*gn],at[3*Wt+1]=$[3*gn+1],at[3*Wt+2]=$[3*gn+2],nn[3*Wt]=S[3*gn],nn[3*Wt+1]=S[3*gn+1],nn[3*Wt+2]=S[3*gn+2]}$=at,S=nn}const Ae=$.length,Ce=new Float32Array(Ae),$e=new Float32Array(Ae);for(let rt=0,ct=0;rt<Ae;rt+=3)Ce[rt]=$[rt+ct],Ce[rt+1]=$[rt+1+ct],Ce[rt+2]=-$[rt+2+ct],$e[rt]=S[rt+ct],$e[rt+1]=S[rt+1+ct],$e[rt+2]=-S[rt+2+ct],ct+=3,6===ct&&(ct=-3);const nt=new ve.LoY;return nt.setAttribute("position",new ve.THS(Ce,3)),nt.setAttribute("normal",new ve.THS($e,3)),nt}function si(Ne,$,S){if(!Ne?.geometry)return $;if($||($=(new ve.NRn).makeEmpty()),Ne.isInstancedMesh){const Ce=new ve.kn4,$e=(new ve.NRn).makeEmpty();Ne.geometry.computeBoundingBox();for(let nt=0;nt<Ne.count;nt++)Ne.getMatrixAt(nt,Ce),$e.copy(Ne.geometry.boundingBox).applyMatrix4(Ce),$.union($e);return $}S||Ne.updateWorldMatrix(!1,!1);const Z=new ve.Pq0,Ae=Ne.geometry.attributes?.position;if(void 0!==Ae)for(let Ce=0,$e=Ae.count;Ce<$e;Ce++)Z.fromBufferAttribute(Ae,Ce),S||Z.applyMatrix4(Ne.matrixWorld),$.expandByPoint(Z);return $}function Fn(Ne){Ne&&((0,b.isFunc)(Ne.geom?.dispose)&&Ne.geom.dispose(),(0,b.isFunc)(Ne.geomZ?.dispose)&&Ne.geomZ.dispose(),delete Ne.geom,delete Ne.geomZ)}function Zt(Ne,$,S,Z){const Ae=new ve.tBo;function Ce(ct){ct&&ct.traverse(zt=>{zt.renderOrder=zt.defaultOrder||0,zt.material&&(zt.material.depthWrite=!0)})}function $e(ct,zt,at){if(ct.children)for(let nn=0;nn<ct.children.length;++nn){const Wt=ct.children[nn];Wt.$jsroot_order===zt?Wt.material&&(Wt.material.transparent?(Wt.material.depthWrite=!1,at.push(Wt)):Ce(Wt)):(void 0===ct.$jsroot_depth||ct.$jsroot_depth<zt)&&$e(Wt,zt,at)}}S&&"dflt"!==S?function rt(ct,zt,at,nn){const Wt=[];let gn=!1;if($e(ct,zt,Wt),Wt.length){if(at===nn)for(let ze=0;ze<Wt.length;++ze)Wt[ze].renderOrder=at;else gn=function nt(ct,zt,at){if(ct.length>1e3){for(let gn=0;gn<ct.length;++gn)ct[gn].renderOrder=(zt+at)/2;return!1}const nn=new ve.Pq0;for(let gn=0;gn<ct.length;++gn){const ze=ct[gn];let Qe=ze.$jsroot_box3;if(Qe||(ze.$jsroot_box3=Qe=si(ze)),"size"===S){const Lt=Qe.getSize(new ve.Pq0);ze.$jsroot_distance=Lt.x*Lt.y*Lt.z;continue}if("pnt"===S){ze.$jsroot_distance=$.distanceTo(Qe.getCenter(nn));continue}let ut=Math.min($.distanceTo(Qe.min),$.distanceTo(Qe.max));const _t=new ve.Pq0(Qe.min.x,Qe.min.y,Qe.max.z);ut=Math.min(ut,$.distanceTo(_t)),_t.set(Qe.min.x,Qe.max.y,Qe.min.z),ut=Math.min(ut,$.distanceTo(_t)),_t.set(Qe.max.x,Qe.min.y,Qe.min.z),ut=Math.min(ut,$.distanceTo(_t)),_t.set(Qe.max.x,Qe.max.y,Qe.min.z),ut=Math.min(ut,$.distanceTo(_t)),_t.set(Qe.max.x,Qe.min.y,Qe.max.z),ut=Math.min(ut,$.distanceTo(_t)),_t.set(Qe.min.x,Qe.max.y,Qe.max.z),ut=Math.min(ut,$.distanceTo(_t)),ze.$jsroot_distance=ut}ct.sort((gn,ze)=>gn.$jsroot_distance-ze.$jsroot_distance);const Wt=new Array(ct.length);for(let gn=0;gn<ct.length;++gn)ct[gn].$jsroot_index=gn,Wt[gn]=ct[gn];if("ray"===S)for(let gn=ct.length-1;gn>=0;--gn){const ze=ct[gn];let ut,_t=ze.$jsroot_box3.getCenter(nn);for(let Lt=0;Lt<2;++Lt){_t.sub($).normalize(),Ae.set($,_t),ut=Ae.intersectObjects(ct,!1)||[];const xn=[];for(let Xt=0;Xt<ut.length;++Xt)xn.indexOf(ut[Xt].object)<0&&xn.push(ut[Xt].object);if(ut=xn,ut.indexOf(ze)<0&&Lt>0&&console.log(`MISS ${Z?.resolveStack(ze.stack)?.name}`),ut.indexOf(ze)>=0||Lt>0)break;const rn=ze.geometry.attributes.position.array;_t=new ve.Pq0((rn[0]+rn[3]+rn[6])/3,(rn[1]+rn[4]+rn[7])/3,(rn[2]+rn[5]+rn[8])/3),_t.applyMatrix4(ze.matrixWorld)}for(let Lt=0;Lt<ut.length-1;++Lt){const rn=ut[Lt+1],Xt=ut[Lt].$jsroot_index,cn=rn.$jsroot_index;if(!(Xt<cn)){for(let Pn=cn;Pn<Xt;++Pn)Wt[Pn]=Wt[Pn+1],Wt[Pn].$jsroot_index=Pn;Wt[Xt]=rn,rn.$jsroot_index=Xt}}}for(let gn=0;gn<Wt.length;++gn)Wt[gn].renderOrder=Math.round(at-(gn+1)/(Wt.length+1)*(at-zt)),delete Wt[gn].$jsroot_index,delete Wt[gn].$jsroot_distance;return!0}(Wt,at,nn),gn||(at=nn=(at+nn)/2);for(let ze=0;ze<Wt.length;++ze){let ut=at,_t=nn;gn&&(_t=Wt[ze].renderOrder,ut=_t-(nn-at)/(Wt.length+2)),rt(Wt[ze].parent,zt+1,ut,_t)}}}(Ne,0,1,1e6):Ce(Ne)}function tr(Ne){switch(Ne._typename){case V:return"img_geoarb8";case D:return"img_geocone";case w:return"img_geoconeseg";case _e:return"img_geocomposite";case P:return"img_geotube";case x:return"img_geotubeseg";case L:return"img_geopara";case F:return"img_geoparab";case U:return"img_geopcon";case j:return"img_geopgon";case te:return"img_geoassembly";case N:return"img_geosphere";case m:return"img_geotorus";case _:return"img_geotrd1";case C:return"img_geotrd2";case I:return"img_geoxtru";case A:return"img_geotrap";case R:return"img_geogtra";case k:return"img_geoeltu";case J:return"img_geohype";case v:return"img_geoctub"}return"img_geotube"}},4468:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{TB:()=>He,fm:()=>Re,iF:()=>ot,rb:()=>xe.rb});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(9041),xe=Ee(6224),et=Ee(528);function ot(Ie,O){return Ie<.5?O?"%S.%L":"%H:%M:%S.%L":Ie<30?O?"%Mm%S":"%H:%M:%S":(Ie/=60)<30?O?"%Hh%M":"%d/%m %H:%M":(Ie/=60)<12?O?"%d-%Hh":"%d/%m/%y %Hh":(Ie/=24)<15.218425?O?"%d/%m":"%d/%m/%y":(Ie/=30.43685)<6?"%d/%m/%y":(Ie/=12)<2?O?"%m/%y":"%d/%m/%y":"%Y"}const Re={initAxisPainter(){this.name="yaxis",this.kind=xe.UV,this.func=null,this.order=0,this.full_min=0,this.full_max=1,this.scale_min=0,this.scale_max=1,this.ticks=[]},cleanupAxisPainter(){this.ticks=[],delete this.format,delete this.func,delete this.tfunc1,delete this.tfunc2,delete this.gr},assignFrameMembers(Ie,O){Ie[`gr${O}`]=this.gr,Ie[`log${O}`]=this.log,Ie[`scale_${O}min`]=this.scale_min,Ie[`scale_${O}max`]=this.scale_max},convertDate(Ie){return new Date(this.timeoffset+1e3*Ie)},revertPoint(Ie){const O=this.func.invert(Ie);return this.kind===xe.Yu?(O-this.timeoffset)/1e3:O},formatTime(Ie,O){return O?this.tfunc1(Ie):this.tfunc2(Ie)},formatLog(Ie,O,ce){const ie=parseFloat(Ie),he=Math.round(ie);if(!O)return he===ie&&Math.abs(he)<1e9?he.toString():(0,ke.lg)(ie,ce||b.gStyle.fStatFormat);if(ie<=0)return null;let ue=Math.log10(ie);const fe=this.logbase;return 10!==fe&&(ue/=Math.log10(fe)),this.moreloglabels||Math.abs(ue-Math.round(ue))<.001?this.noexp||2===O?Math.abs(fe-Math.E)<.001?(0,ke.lg)(ie,ce||b.gStyle.fStatFormat):ie.toFixed(ue<0?Math.round(.5-ue):0):this.formatExp(fe,Math.floor(ue+.01),ie):null},formatNormal(Ie,O,ce){let ie=parseFloat(Ie);if(O&&this.order&&(ie/=Math.pow(10,this.order)),b.gStyle.fStripDecimals&&ie===Math.round(ie))return Math.abs(ie)<1e9?ie.toFixed(0):ie.toExponential(4);if(O){if(this.ndig>10)return ie.toExponential(this.ndig-11);let he=ie.toFixed(this.ndig);const ue=he.indexOf(".");if(ue>0&&b.settings.StripAxisLabels)for(;he.length>=ue&&("0"===he[he.length-1]||"."===he[he.length-1]);)he=he.slice(0,he.length-1);return he}return(0,ke.lg)(ie,ce||b.gStyle.fStatFormat)},formatExp(Ie,O,ce){let ie="";const he=Math.abs(Ie-Math.E)<.001?"e":Ie.toString();if(ce){if(ce=Math.round(ce/Math.pow(Ie,O)),b.settings.StripAxisLabels){if(0===O)return ce.toString();if(1===O&&1===ce)return he}1!==ce&&(ie=ce.toString()+(b.settings.Latex?"#times":"x"))}if(ie+=he,b.settings.Latex>b.constants.Latex.Symbols)return ie+`^{${O}}`;const ue={0:"\u2070",1:"\xb9",2:"\xb2",3:"\xb3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079","-":"\u207b"},fe=O.toString();for(let le=0;le<fe.length;++le)ie+=ue[fe[le]];return ie},axisAsText(Ie,O){return this.kind===xe.Yu&&(Ie=this.convertDate(Ie)),this.format?this.format(Ie,!1,O):Ie.toPrecision(4)},poduceLogTicks(Ie,O){const ce=he=>{let ue=0,fe=0;for(let V=1;V<he.length;++V){const D=he[V]-he[V-1];ue+=D,fe+=D**2}const le=ue/(he.length-1),Y=fe/(he.length-1)-le**2;return Y<=0||!(Math.abs(le)<1e-100)&&Math.sqrt(Y)/le<1e-6};let ie=Ie.ticks(O);for(;O>4&&ce(ie);)O=Math.round(.8*O),ie=Ie.ticks(O);if(O<5&&ce(ie)&&this.logbase&&10!==this.logbase){const he=[];ie.forEach(ue=>{const fe=Math.log10(ue)/Math.log10(this.logbase);Math.abs(Math.round(fe)-fe)<.01&&he.push(ue)}),he.length>0&&(ie=he)}return ie},produceTicks(Ie,O){if(!this.noticksopt){const he=Ie*(O||1);if(this.log)return this.poduceLogTicks(this.func,he);const ue=this.func.domain(),fe=V=>V.length<=he||!(V.length>he+1)&&(V[0]===ue[0]||V[he]===ue[1]),le=this.func.ticks(he);if(O||fe(le))return le;const Y=this.func.ticks(Math.round(.7*he));return Y.length>2&&fe(Y)?Y:le}const ce=this.func.domain(),ie=[];O&&(Ie=(Ie-1)*O);for(let he=0;he<=Ie;++he)ie.push((ce[0]*(Ie-he)+ce[1]*he)/Ie);return ie},analyzeWheelEvent(Ie,O,ce,ie){ce||(ce={});let he=0,ue=1,fe=1;if("dleft"in ce&&(ue=ce.dleft,he=1),"dright"in ce&&(fe=ce.dright,he=1),ce.delta?he=ce.delta:Ie&&(he=Ie.wheelDelta?-Ie.wheelDelta:Ie.deltaY||Ie.detail),!he||ie&&ce.ignore)return;he=he<0?-.2:.2,ue*=he,fe*=he;const le=ce.min=this.scale_min,Y=ce.max=this.scale_max,V=this.full_min,D=this.full_max;if(ce.min===ce.max&&he<0&&(ce.min=V,ce.max=D),!(ce.min>=ce.max)){if(ce.reverse&&(O=1-O),O>0&&O<1){if(this.log){let w=ce.min>0?Math.log10(ce.max/ce.min):2;w>10?w=10:w<.01&&(w=.01),ce.min=ce.min/Math.pow(10,w*ue*O),ce.max=ce.max*Math.pow(10,w*fe*(1-O))}else if(ue!==-fe||ce.reverse){let w=ce.max-ce.min,P=w;ue>0&&(w=1.001*w/(1-ue)),ce.min+=-ue*O*w,fe>0&&(P=1.001*P/(1-fe)),ce.max-=-fe*(1-O)*P}else{let w=(ce.max-ce.min)*fe*O;Math.round(ce.max)===ce.max&&Math.round(ce.min)===ce.min&&Math.abs(w)>1&&(w=Math.round(w)),ce.min+w<V?w=V-ce.min:ce.max+w>D&&(w=D-ce.max),0!==w?(ce.min+=w,ce.max+=w):(delete ce.min,delete ce.max)}ce.min>=ce.max?ce.min=ce.max=void 0:ue!==fe?(ce.min<V&&le===V||ce.max>D&&Y===D)&&(ce.min=ce.max=void 0):(ce.min<V&&(ce.min=V),ce.max>D&&(ce.max=D))}else ce.min=ce.max=void 0;return ce.changed=void 0!==ce.min&&void 0!==ce.max,ce}}};class He extends xe.JW{constructor(O,ce,ie){super(O,ce),this.is_gaxis=ce?._typename===b.clTGaxis,Object.assign(this,Re),this.initAxisPainter(),this.embedded=ie,this.invert_side=!1,this.lbls_both_sides=!1}cleanup(){this.cleanupAxisPainter(),super.cleanup()}getAxisType(){return b.clTAxis}configureAxis(O,ce,ie,he,ue,fe,le,Y){this.name=O,this.full_min=ce,this.full_max=ie,this.kind=xe.UV,this.vertical=fe,this.log=Y.log||0,this.noexp_changed=Y.noexp_changed,this.symlog=Y.symlog||!1,this.reverse=Y.reverse||!1,this.swap_side=Y.swap_side||!1,this.fixed_ticks=Y.fixed_ticks||null,this.maxTickSize=Y.maxTickSize||0;const V=this.getObject();if(Y.time_scale||V.fTimeDisplay?(this.kind=xe.Yu,this.timeoffset=function Je(Ie){if(!Ie)return 7889184e5;const ce=Ie.fTimeFormat.indexOf("%F");if(ce<0)return 1e3*b.gStyle.fTimeOffset;let ie=Ie.fTimeFormat.slice(ce+2);if(0===ie.indexOf("1995-01-01 00:00:00s0"))return 7889184e5;if("0"===ie||""===ie)return 0;const he=(v,_,C)=>{const L=ie.indexOf(v);if(L<0)return _;const F=parseInt(ie.slice(0,L));return ie=ie.slice(L+1),!Number.isInteger(F)||F<_||F>C?_:F},ue=he("-",1900,2900),fe=he("-",1,12)-1,le=he(" ",1,31),Y=he(":",0,23),V=he(":",0,59),D=he("s",0,59),w=he(" ",0,999);let x=new Date(Date.UTC(ue,fe,le,Y,V,D,w)).getTime();if(ie=ie.toUpperCase(),0===ie.indexOf("GMT")&&(ie=ie.slice(4).trim(),ie.length>3)){let v=0,_=1e3;"-"===ie[0]&&(v=1,_=-1e3),x-=_*(3600*parseInt(ie.slice(v,v+2))+60*parseInt(ie.slice(v+2,v+4)))}return x}(V),this.timegmt=function Xe(Ie){const O=Ie?.fTimeFormat??"";return O.indexOf("gmt")>0||O.indexOf("GMT")>0}(V)):this.kind=Y.axis_func?xe.Z_:V.fLabels?xe.ei:xe.UV,this.kind===xe.Yu)this.func=(0,z.w7)().domain([this.convertDate(he),this.convertDate(ue)]);else if(this.log){if(this.logbase=1===this.log||10===this.log?10:3===this.log?Math.E:Math.round(this.log),ue<=0&&(ue=1),he<=0&&V&&!Y.logcheckmin)for(let P=0;P<V.fNbins&&!((he=Math.max(he,V.GetBinLowEdge(P+1)))>0);++P);he<=0&&Y.log_min_nz&&(he=this.log_min_nz=Y.log_min_nz),(he<=0||he>=ue)&&(he=ue*(Y.logminfactor||1e-4)),this.func=this.kind===xe.Z_?this.createFuncHandle(Y.axis_func,this.logbase,he,ue):(0,z.ZE)().base(this.logbase).domain([he,ue])}else if(this.symlog){let P=Math.max(Math.abs(he),Math.abs(ue));Number.isInteger(this.symlog)&&this.symlog>0?P*=Math.pow(10,-1*this.symlog):P*=.01,this.func=(0,z.aX)().constant(P).domain([he,ue])}else this.func=this.kind===xe.Z_?this.createFuncHandle(Y.axis_func,0,he,ue):(0,z.m4)().domain([he,ue]);if(this.vertical^this.reverse){const P=le[0];le[0]=le[1],le[1]=P}this.func.range(le),this.scale_min=he,this.scale_max=ue,this.gr=this.kind===xe.Yu?P=>this.func(this.convertDate(P)):this.log?P=>P<this.scale_min?this.vertical?this.func.range()[0]+5:-5:this.func(P):this.func,delete this.format;let D=508;this.is_gaxis?D=V.fNdiv:V&&(D=V.fNdivisions?Math.max(V.fNdivisions,4):0),this.nticks=D%100,this.nticks2=(D%1e4-this.nticks)/100,this.nticks3=Math.floor(D/1e4),V&&!this.is_gaxis&&this.nticks>20&&(this.nticks=20);let w=Math.abs(this.func.range()[1]-this.func.range()[0]);if(w<=0&&(w=100),this.kind===xe.Yu){this.nticks>8&&(this.nticks=8);const P=this.scale_max-this.scale_min,x=V.fTimeFormat.indexOf("%F"),v=ot(P/w,!1);let _=x>=0?V.fTimeFormat.slice(0,x):V.fTimeFormat;(!_||P<.1*(this.full_max-this.full_min))&&(_=ot(P/this.nticks,!0)),this.tfunc1=this.tfunc2=this.timegmt?(0,z.aL)(_):(0,z.DC)(_),v!==_&&(this.tfunc2=this.timegmt?(0,z.aL)(v):(0,z.DC)(v)),this.format=this.formatTime}else if(this.log)this.nticks2>1&&(this.nticks*=this.nticks2,this.nticks2=1),this.noexp=V?.TestBit(xe.rb.kNoExponent),this.scale_max<300&&this.scale_min>.3&&!this.noexp_changed&&(this.noexp=!0),this.moreloglabels=V?.TestBit(xe.rb.kMoreLogLabels),this.format=this.formatLog;else if(this.kind===xe.ei){this.nticks=50;const P=this.scale_max-this.scale_min;this.nticks>P&&(this.nticks=Math.round(P)),this.regular_labels=!0,V&&V.fNbins&&V.fLabels&&(V.fNbins!==Math.round(V.fXmax-V.fXmin)||0!==V.fXmin||V.fXmax!==V.fNbins)&&(this.regular_labels=!1),this.nticks2=1,this.format=this.formatLabels}else this.order=0,this.ndig=0,this.format=this.formatNormal}getScaleMin(){return this.func?.domain()[0]??0}getScaleMax(){return this.func?.domain()[1]??0}formatLabels(O){const ce=this.getObject();let ie=parseFloat(O);if(ie=this.regular_labels?Math.floor(ie):Math.round((ie-ce.fXmin)/(ce.fXmax-ce.fXmin)*ce.fNbins),ie<0||ie>=ce.fNbins)return null;for(let he=0;he<ce.fLabels.arr.length;++he){const ue=ce.fLabels.arr[he];if(ue.fUniqueID===ie+1)return ue.fString}return null}createTicks(O,ce,ie,he){ie&&this.nticks&&this.kind===xe.UV&&(this.noticksopt=!0);const ue={painter:this,nminor:0,nmiddle:0,nmajor:0,func:this.func,minor:[],middle:[],major:[]};let fe=[];if(this.fixed_ticks)this.fixed_ticks.forEach(le=>{le>=this.scale_min&&le<=this.scale_max&&fe.push(le)});else if(this.kind===xe.ei){ue.lbl_pos=[];const le=this.getObject();for(let Y=0;Y<=le.fNbins;++Y){const V=this.regular_labels?Y:le.fXmin+Y/le.fNbins*(le.fXmax-le.fXmin);V>=this.scale_min&&V<=this.scale_max&&(ue.lbl_pos.push(V),fe.push(V))}}else fe=this.produceTicks(this.nticks);if(ue.minor=ue.middle=ue.major=fe,O){const le=ue.major,Y=1e-5*(this.scale_max-this.scale_min);return le[0]>this.scale_min+Y&&le.unshift(this.scale_min),le[le.length-1]<this.scale_max-Y&&le.push(this.scale_max),le}if(this.nticks2>1&&(!this.log||10===this.logbase)&&!this.fixed_ticks){ue.minor=ue.middle=this.produceTicks(ue.major.length,this.nticks2);const le=Math.abs(this.func.range()[1]-this.func.range()[0]);ue.middle.length<=ue.major.length||ue.middle.length>le/3.5?ue.minor=ue.middle=ue.major:this.nticks3>1&&!this.log&&(ue.minor=this.produceTicks(ue.middle.length,this.nticks3),(ue.minor.length<=ue.middle.length||ue.minor.length>le/1.7)&&(ue.minor=ue.middle))}if(ue.reset=function(){this.nminor=this.nmiddle=this.nmajor=0},ue.next=function(le){return!(this.nminor>=this.minor.length||(this.tick=this.minor[this.nminor++],this.grpos=this.func(this.tick),le&&(this.grpos=Math.round(this.grpos)),this.kind=3,this.nmiddle<this.middle.length&&Math.abs(this.grpos-this.func(this.middle[this.nmiddle]))<1&&(this.nmiddle++,this.kind=2),this.nmajor<this.major.length&&Math.abs(this.grpos-this.func(this.major[this.nmajor]))<1&&(this.nmajor++,this.kind=1),0))},ue.last_major=function(){return 1===this.kind&&this.nmajor===this.major.length},ue.next_major_grpos=function(){return this.nmajor>=this.major.length?null:this.func(this.major[this.nmajor])},ue.get_modifier=function(){return this.painter.findLabelModifier(this.painter.getObject(),this.nmajor-1,this.major)},this.order=0,this.ndig=0,(this.kind===xe.UV||this.kind===xe.Z_)&&!this.log&&ue.major.length>0){let le=0,Y=0,V=!1;if(!ce){const x=Math.max(Math.abs(ue.major[0]),Math.abs(ue.major[ue.major.length-1])),v=Math.min(Math.abs(ue.major[0]),Math.abs(ue.major[ue.major.length-1])),_=x>0?3*Math.round(Math.log10(x)/3):0,C=v>0?3*Math.round(Math.log10(v)/3):0;V=x<2e4,(x||v)&&(le=Math.max(_,C)+3,Y=Math.min(_,C)-3)}let D=0,w=this.ndig,P=1e10;for(let x=Y;x<=le;x+=3){if(V&&3===x)continue;this.order=x,this.ndig=0;let v=[],_=0,C=0;for(;_<ue.major.length;){const L=this.format(ue.major[_],!0);if(v.indexOf(L)<0){v.push(L);const F=L.indexOf(".");!x&&!ce&&(F>b.gStyle.fAxisMaxDigits||F<0&&L.length>b.gStyle.fAxisMaxDigits)&&(C+=1e10,V=!1),C+=L.length,_++}else{if(++this.ndig>15)break;v=[],_=0,C=0}}!x&&this.ndig<4&&(C-=2*ue.major.length+3),C<P&&(P=C,D=this.order,w=this.ndig)}this.order=D,this.ndig=w,he&&(this.order&&console.warn(`Axis painter - integer labels are configured, but axis order ${this.order} is preferable`),this.ndig&&console.warn(`Axis painter - integer labels are configured, but ${this.ndig} decimal digits are required`),this.ndig=0,this.order=0)}return ue}isCenteredLabels(){return this.kind===xe.ei||!this.log&&this.getObject()?.TestBit(xe.rb.kCenterLabels)}addTitleDrag(O,ce,ie,he,ue){if(!b.settings.MoveResize||this.isBatchMode())return;let le,Y,V,D,w,P,x,fe=null;const v=(0,z.$E)().subject(Object);v.on("start",_=>{_.sourceEvent.preventDefault(),_.sourceEvent.stopPropagation();const C=O.node().getBBox(),L=ce?C.height:C.width;V=le=O.property("shift_x"),D=Y=O.property("shift_y"),w=ce?le>0:Y>0,P=ce?[ue,ue/2,0]:[0,ue/2,ue];const F=ce?-L/2:L/2;"middle"===this.title_align?(P[0]+=F,P[2]-=F):"begin"===this.title_align?(P[1]-=F,P[2]-=2*F):(P[0]+=2*F,P[1]+=F),x=this.titleCenter?1:he^this.titleOpposite?0:2,P[x]=ce?Y:le,fe=O.append("rect").attr("x",C.x).attr("y",C.y).attr("width",C.width).attr("height",C.height).style("cursor","move").call(ke.Ru,!0)}).on("drag",_=>{if(!fe)return;_.sourceEvent.preventDefault(),_.sourceEvent.stopPropagation(),le+=_.dx,Y+=_.dy;let C,L,F=0;const U=ce?Y:le;for(let j=1;j<3;++j)Math.abs(U-P[j])<Math.abs(U-P[F])&&(F=j);ce?(C=le,L=P[F]):(L=Y,C=P[F]),w===(ce?C>0:L>0)&&(V=C,D=L,x=F,(0,ke.bk)(O,V,D))}).on("end",_=>{if(!fe)return;_.sourceEvent.preventDefault(),_.sourceEvent.stopPropagation(),O.property("shift_x",V).property("shift_y",D);const C=this.getObject(),L=this.source_axis,F=(j,te)=>{C&&C.TestBit(j)!==te&&C.InvertBit(j),L&&L.TestBit(j)!==te&&L.InvertBit(j)};this.titleOffset=(ce?V:D)/ie;const U=this.titleOffset/this.offsetScaling/this.titleSize;C&&(C.fTitleOffset=U),L&&(L.fTitleOffset=U),1===x?(F(xe.rb.kCenterTitle,!0),this.titleCenter=!0,F(xe.rb.kOppositeTitle,!1),this.titleOpposite=!1):0===x?(F(xe.rb.kCenterTitle,!1),this.titleCenter=!1,F(xe.rb.kOppositeTitle,!0),this.titleOpposite=!0):(F(xe.rb.kCenterTitle,!1),this.titleCenter=!1,F(xe.rb.kOppositeTitle,!1),this.titleOpposite=!1),this.submitAxisExec(`SetTitleOffset(${U});;SetBit(${xe.rb.kCenterTitle},${this.titleCenter?1:0})`),fe.remove(),fe=null}),O.style("cursor","move").call(v)}setHistPainter(O,ce){this.hist_painter=O,this.hist_axis=ce}submitAxisExec(O,ce){const ie=this.hist_painter?.snapid;ie&&this.hist_axis&&!ce?this.submitCanvExec(O,`${ie}#${this.hist_axis}`):this.is_gaxis&&this.submitCanvExec(O)}produceTicksPath(O,ce,ie,he,ue,fe){let le="",Y="";for(this.ticks=[];O.next(!0);){let V=Math.round(ie/4),D=0;O.kind<3&&(V=Math.round(ie/2)),1===O.kind&&(null!==this.format(O.tick,!0)&&(V=ie),this.ticks.push(O.grpos)),he>0?D=-V:ce<0&&(D=-V,V=0),le+=this.vertical?`M${V},${O.grpos}H${D}`:`M${O.grpos},${-V}V${-D}`,ue&&(Y+=this.vertical?`M${ue-V},${O.grpos}H${ue-D}`:`M${O.grpos},${ue+V}V${ue+D}`)}return fe?le+Y:""}findLabelModifier(O,ce,ie){if(!O.fModLabs)return null;for(let he=0;he<O.fModLabs.arr.length;++he){const ue=O.fModLabs.arr[he];if(void 0!==ue.fLabValue&&0===ue.fLabNum){const fe=this.log?1e-6*ie[ce]:1e-6*(this.scale_max-this.scale_min);if(Math.abs(ue.fLabValue-ie[ce])<fe)return ue}if(ue.fLabNum===ce+1||ue.fLabNum<0&&ce===ie.length+ue.fLabNum)return ue}return null}drawLabels(O,ce,ie,he,ue,fe,le,Y,V,D,w,P){var x=this;return(0,ve.A)(function*(){const v=x.isCenteredLabels(),_=ce.TestBit(xe.rb.kLabelsVert),C=[O.append("svg:g").attr("class","axis_labels")],L=ue.lbl_pos||ue.major,F=b.gStyle.AxisTiltAngle??25;let U=1,j=0,te=0,N=!1,m=!1,I=0,A=0;function R(k){const J=this.result_width;if(I=Math.max(I,J),J&&(!k.vertical&&!_||k.vertical&&_)&&!k.log){let be=.45*this.gap_before+.45*this.gap_after;this.gap_before?this.gap_after||(be=.9*this.gap_before):be=.9*this.gap_after,U=Math.min(U,be/J)}else k.vertical&&w&&this.normal_side&&w-Y>20&&J>w-Y&&(U=Math.min(U,(w-Y)/J));U>1e-4&&U<.7&&!m&&!k.vertical&&!_&&j>5&&1===C.length&&!1===N&&(N=!0);let _e=U;N&&(A&&I?(_e=Math.min(1,.8*A/I),_e<U&&(N=0,_e=U)):_e*=3),(_e>1e-4&&_e<1||!1!==N)&&(te=1/_e,k.scaleTextDrawing(te,C[0]))}x.lbls_both_sides&&C.push(O.append("svg:g").attr("class","axis_labels").attr("transform",x.vertical?`translate(${ie})`:`translate(0,${-he})`)),P>0&&(A=P/Math.sin(F/180*Math.PI)-Math.tan(F/180*Math.PI));for(let k=0;k<C.length;++k){k>0&&(fe=-fe);let J=0;const _e=x.vertical?-Y*fe:Y*fe+D*V;x.startTextDrawing(le,"font",C[k]);for(let be=0;be<L.length;++be){let Te=x.format(L[be],!0);if(null===Te)continue;const Pe=x.findLabelModifier(ce,be,L);if(0===Pe?.fTextSize)continue;Pe&&(m=!0),Pe?.fLabText&&(Te=Pe.fLabText);const We={text:Te,color:le.color,latex:1,draw_g:C[k],normal_side:0===k};let dt=Math.round(x.func(L[be]));if(Pe?.fTextColor>0&&(We.color=x.getColor(Pe.fTextColor)),We.gap_before=be>0?Math.abs(Math.round(dt-x.func(L[be-1]))):0,We.gap_after=be<L.length-1?Math.abs(Math.round(x.func(L[be+1])-dt)):0,v){const Q=We.gap_after||We.gap_before;if(dt=Math.round(dt-(x.vertical!==x.reverse?.5*Q:-.5*Q)),dt<-5||dt>(x.vertical?he:ie)+5)continue}if(j=Math.max(j,Te.length),x.vertical?(We.x=_e,We.y=dt,We.align=_?fe<0?23:20:fe<0?12:32):(We.x=dt,We.y=_e,We.align=_?fe<0?12:32:fe<0?20:23,!x.log||x.noexp||x.vertical||23!==We.align?We.align%10==3&&(We.y-=.1*le.size):(We.align=21,We.y+=le.size)),_?We.rotate=270:Pe&&-1!==Pe.fTextAngle&&(We.rotate=-Pe.fTextAngle),0===k&&(We.post_process=R),x.drawText(We),x.symlog&&J&&dt!==J&&(x.vertical&&!_||!x.vertical&&_)){const Q=Math.abs(dt-J);U=Math.min(U,1.1*Q/le.size)}J=dt}if(x.order){let be=0,Te=0;"xaxis"===x.name?(be=b.gStyle.fXAxisExpXOffset||0,Te=b.gStyle.fXAxisExpYOffset||0):"yaxis"===x.name&&(be=b.gStyle.fYAxisExpXOffset||0,Te=b.gStyle.fYAxisExpYOffset||0),be&&(be=Math.round(be*(x.getPadPainter()?.getPadWidth()??0))),Te&&(Te=Math.round(Te*(x.getPadPainter()?.getPadHeight()??0))),x.drawText({color:le.color,x:be+(x.vertical?5*fe:ie+5),y:Te+(x.has_obstacle?_e:x.vertical?-3:-3*fe),align:x.vertical?fe<0?30:10:x.has_obstacle^fe<0?13:10,latex:1,text:"#times"+x.formatExp(10,x.order),draw_g:C[k]})}}return x.finishTextDrawing(C[0],!0).then(()=>{if(C.length>1)return te&&x.scaleTextDrawing(te,C[1]),x.finishTextDrawing(C[1],!0)}).then(()=>(N&&C[0].selectAll("text").each(function(){const k=(0,z.Lt)(this),J=k.attr("transform");k.attr("transform",`${J} rotate(${F})`).style("text-anchor","start")}),I))})()}extractDrawAttributes(O,ce,ie){const he=this.getObject();let ue=this.getPadPainter();he.$use_top_pad&&(ue=ue?.getPadPainter());const fe=ue?.getPadWidth()||O||ce/.8,le=ue?.getPadHeight()||O||ie/.8,Y=O||(this.vertical?ie/le*fe:ce/fe*le);let D,w,P,V=0;if(this.scalingSize=O||Math.max(Math.min(fe,le),10),this.is_gaxis){const v=he.fChopt.indexOf("S")>=0;this.optionUnlab=he.fChopt.indexOf("U")>=0,this.optionMinus=he.fChopt.indexOf("-")>=0||he.TestBit(xe.rb.kTickMinus),this.optionPlus=he.fChopt.indexOf("+")>=0||he.TestBit(xe.rb.kTickPlus),this.optionNoopt=he.fChopt.indexOf("N")>=0,this.optionInt=he.fChopt.indexOf("I")>=0,this.optionText=he.fChopt.indexOf("T")>=0,this.createAttLine({attr:he}),V=v?he.fTickSize:.03,D=this.getColor(he.fTextColor),w=he.fTextFont,P=he.fLabelOffset,(this.vertical&&he.fY1>he.fY2&&!this.optionMinus||!this.vertical&&he.fX1>he.fX2)&&(P=-P)}else this.optionUnlab=!1,this.optionMinus=this.vertical^this.invert_side,this.optionPlus=!this.optionMinus,this.optionNoopt=!1,this.optionInt=!1,this.optionText=!1,this.createAttLine({color:he.fAxisColor,width:1,style:1}),V=he.fTickLength,D=this.getColor(he.fTitleColor),w=he.fTitleFont,P=he.fLabelOffset;P+=this.vertical?.002:.005,this.kind===xe.ei&&(this.optionText=!0),this.optionNoexp=he.TestBit(xe.rb.kNoExponent),this.ticksSize=Math.round(V*Y),O&&this.ticksSize<0&&(this.ticksSize=-this.ticksSize),this.maxTickSize&&this.ticksSize>this.maxTickSize&&(this.ticksSize=this.maxTickSize),this.ticksColor=this.lineatt.color,this.ticksWidth=this.lineatt.width;const x=this.optionText?.66666:1;this.labelSize=Math.round(he.fLabelSize<1?x*he.fLabelSize*this.scalingSize:x*he.fLabelSize),this.labelsOffset=Math.round(P*this.scalingSize),this.labelsFont=new et.qg(he.fLabelFont,this.labelSize,O),(this.labelSize<=0||Math.abs(he.fLabelOffset)>1.1)&&(this.optionUnlab=!0),this.labelsFont.setColor(this.getColor(he.fLabelColor)),this.fTitle=he.fTitle,this.fTitle?(this.titleSize=he.fTitleSize>=1?he.fTitleSize:Math.round(he.fTitleSize*this.scalingSize),this.titleFont=new et.qg(w,this.titleSize,O),this.titleFont.setColor(D),this.offsetScaling=he.fTitleSize>=1?1:(this.vertical?fe:le)/this.scalingSize,this.titleOffset=he.fTitleOffset,!this.titleOffset&&"x"===this.name[0]&&(this.titleOffset=b.gStyle.fXaxis.fTitleOffset),this.titleOffset*=this.titleSize*this.offsetScaling,this.titleCenter=he.TestBit(xe.rb.kCenterTitle),this.titleOpposite=he.TestBit(xe.rb.kOppositeTitle)):(delete this.titleSize,delete this.titleFont,delete this.offsetScaling,delete this.titleOffset,delete this.titleCenter,delete this.titleOpposite)}drawAxis(O,ce,ie,he,ue,fe,le,Y,V){var D=this;return(0,ve.A)(function*(){const w=D.getObject(),P=D.swap_side||!1;let x=O,v=!0;ue?D.invert_side&&(ue=-ue):ue=0,D.extractDrawAttributes(void 0,ce,ie),D.is_gaxis&&(v=0!==w.fLineColor),D.lineatt.not_standard=!0,(!D.is_gaxis||"zaxis"===D.name)&&(x=O.selectChild(`.${D.name}_container`),x.empty()?x=O.append("svg:g").attr("class",`${D.name}_container`):x.selectAll("*").remove());let _="";v&&(_="M0,0"+(D.vertical?`v${ie}`:`h${ce}`),ue&&(_+=D.vertical?`M${ue},0v${ie}`:`M0,${ue}h${ce}`)),x.attr("transform",he);let C=1,L=0;D.optionPlus&&D.optionMinus?(C=1,L=1):D.optionMinus?C=P^D.vertical?1:-1:D.optionPlus&&(C=P^D.vertical?-1:1);const F=D.createTicks(!1,D.optionNoexp,D.optionNoopt,D.optionInt);_+=D.produceTicksPath(F,C,D.ticksSize,L,ue,v&&!fe&&!D.disable_ticks),!fe&&_&&!D.lineatt.empty()&&x.append("svg:path").attr("d",_).call(D.lineatt.func);let U=0,j=0,te=null,N=0;return(fe||D.optionUnlab?Promise.resolve(0):D.drawLabels(x,w,ce,ie,F,C,D.labelsFont,D.labelsOffset,D.ticksSize,L,le,V)).then(I=>{if(N=I,b.settings.Zooming&&!D.disable_zooming&&!D.isBatchMode()){const _e=Math.max(D.labelsFont.size,5),be=x.append("svg:rect").attr("class","axis_zoom").style("opacity","0").style("cursor","crosshair");if(D.vertical){const Te=(N||2*_e)+3;be.attr("x",C>0?-Te:0).attr("y",0).attr("width",Te).attr("height",ie)}else be.attr("x",0).attr("y",C>0?0:-_e-3).attr("width",ce).attr("height",_e+3)}if(D.position=0,Y){const _e=x.node(),be=D.getPadSvg().node();if((0,b.isFunc)(_e?.getBoundingClientRect)&&(0,b.isFunc)(be?.getBoundingClientRect)){const Te=_e.getBoundingClientRect(),Pe=be.getBoundingClientRect();D.position=Te.left-Pe.left}_e&&!be&&console.warn("Why PAD element missing when search for position")}if(!D.fTitle||fe)return!0;te=x.append("svg:g").attr("class","axis_title");let A=C;const R=w.TestBit(xe.rb.kRotateTitle)?-1:1;D.startTextDrawing(D.titleFont,"font",te);const k=P^D.titleOpposite;return D.title_align=D.titleCenter?"middle":R<0^k?"begin":"end",D.vertical?(A*=-1.6,U=Math.round(A*D.titleOffset),j=Math.round(D.titleCenter?ie/2:k?ie:0),D.drawText({align:D.title_align+";middle",rotate:R<0?90:270,text:D.fTitle,color:D.titleFont.color,draw_g:te})):(A*=1.6,U=Math.round(D.titleCenter?ce/2:k?0:ce),j=Math.round(A*D.titleOffset),D.drawText({align:D.title_align+";middle",rotate:R<0?180:0,text:D.fTitle,color:D.titleFont.color,draw_g:te})),D.addTitleDrag(te,D.vertical,A,P,D.vertical?ie:ce),D.finishTextDrawing(te)}).then(()=>(te&&(!D.titleOffset&&D.vertical&&N&&(U=Math.round(-C*(N+.7*D.offsetScaling*D.titleSize))),(0,ke.bk)(te,U,j),te.property("shift_x",U).property("shift_y",j)),D))})()}}},9025:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{TCanvasPainter:()=>ie,TPadPainter:()=>Xe.jg,drawTFrame:()=>Y,drawTPadSnapshot:()=>fe,ensureTCanvas:()=>he});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(6714),xe=Ee(5983),et=Ee(6224),Je=Ee(4952),Xe=Ee(1e3);const ot=(0,b.BIT)(15),Re=(0,b.BIT)(17),He=(0,b.BIT)(18),Ie=(0,b.BIT)(19),O=(0,b.BIT)(23);function ce(D,w,P){const x=new Je.nc(D,w);return x.addToPadPrimitives(),"3d"===P&&(x.mode3d=!0),x.redraw()}class ie extends Xe.jg{constructor(w,P){super(w,P,!0),this._websocket=null,this.tooltip_allowed=b.settings.Tooltip,null===w&&null===P&&(b.settings.SmallPad.width=20,b.settings.SmallPad.height=10)}cleanup(){this._changed_layout&&this.setLayoutKind("simple"),delete this._changed_layout,super.cleanup()}getLayoutKind(){const w=this.selectDom("origin");return(w.empty()?"":w.property("layout"))||"simple"}setLayoutKind(w,P){const x=this.selectDom("origin");x.empty()||(w||(w="simple"),x.property("layout",w),x.property("layout_selector","simple"!==w&&P?P:null),this._changed_layout="simple"!==w)}changeLayout(w,P){var x=this;return(0,ve.A)(function*(){if(x.getLayoutKind()===w)return!0;const _=x.selectDom("origin"),C=_.select(".side_panel2"),L=[];let j,F=_.select(".side_panel"),U=x.selectDom();for(;U.node().firstChild;)L.push(U.node().removeChild(U.node().firstChild));if(F.empty()||(0,et.tP)(F.node()),C.empty()||(0,et.tP)(C.node()),x.setLayoutKind("simple"),_.html(""),"simple"===w){U=_;for(let te=0;te<L.length;++te)U.node().appendChild(L[te]);x.setLayoutKind(w),j=!0}else{const te=new xe.ho(_.node(),w);void 0===P&&(P=0===w.indexOf("vert")?0:1),U=(0,z.Lt)(te.getGridFrame(P)),U.classed("central_panel",!0).style("position","relative"),2===P?(F=(0,z.Lt)(te.getGridFrame(0)),F.classed("side_panel2",!0).style("position","relative"),F=(0,z.Lt)(te.getGridFrame(3)),F.classed("side_panel",!0).style("position","relative")):(F=(0,z.Lt)(te.getGridFrame(1-P)),F.classed("side_panel",!0).style("position","relative"));for(let N=0;N<L.length;++N)U.node().appendChild(L[N]);x.setLayoutKind(w,".central_panel"),_.property("mdi",null)}return(0,et.XR)(U.node(),j),!0})()}toggleProjection(w){var P=this;return(0,ve.A)(function*(){if(delete P.proj_painter,w&&(P.proj_painter={X:!1,Y:!1}),(0,b.isFunc)(P.showUI5ProjectionArea))return P.showUI5ProjectionArea(w);let v,x="simple";switch(w){case"XY":x="projxy",v=2;break;case"X":case"bottom":x="vert2_31",v=0;break;case"Y":case"left":x="horiz2_13",v=1;break;case"top":x="vert2_13",v=1;break;case"right":x="horiz2_31",v=0}return P.changeLayout(x,v)})()}drawProjection(w,P,x){var v=this;return(0,ve.A)(function*(){if(!v.proj_painter)return!1;if(void 0===x&&(x="hist"),w||(w="X"),!v.proj_painter[w]){v.proj_painter[w]="init";const _=(0,b.create)(b.clTCanvas),C=v.pad,L=v.getFramePainter();let F;return"X"===w?(_.fLeftMargin=C.fLeftMargin,_.fRightMargin=C.fRightMargin,_.fLogx=L.logx,_.fUxmin=L.logx?Math.log10(L.scale_xmin):L.scale_xmin,_.fUxmax=L.logx?Math.log10(L.scale_xmax):L.scale_xmax,F="fixframe"):"Y"===w&&(_.fBottomMargin=C.fBottomMargin,_.fTopMargin=C.fTopMargin,_.fLogx=L.logy,_.fUxmin=L.logy?Math.log10(L.scale_ymin):L.scale_ymin,_.fUxmax=L.logy?Math.log10(L.scale_ymax):L.scale_ymax,F="rotate"),_.fPrimitives.Add(P,x),((0,b.isFunc)(v.drawInUI5ProjectionArea)?v.drawInUI5ProjectionArea(_,F,w):v.drawInSidePanel(_,F,w)).then(j=>(v.proj_painter[w]=j,j))}return(0,b.isStr)(v.proj_painter[w])?(console.log("Not ready with first painting",w),!0):(v.proj_painter[w].getMainPainter()?.updateObject(P,x),v.proj_painter[w].redrawPad())})()}testUI5(){return!!this.use_openui&&(console.warn("full ui5 should be used - not loaded yet? Please check!!"),!0)}drawInSidePanel(w,P,x){var v=this;return(0,ve.A)(function*(){const _="projxy"===v.getLayoutKind()&&"Y"===x?".side_panel2":".side_panel",C=v.selectDom("origin").select(_);return C.empty()?null:v.drawObject(C.node(),w,P)})()}showMessage(w){this.testUI5()||(0,ke.Rh)(w,7e3)}saveCanvasAsFile(w){const P=w.indexOf(".");this.createImage(w.slice(P+1)).then(x=>this.sendWebsocket(`SAVE:${w}:${x}`))}sendSaveCommand(w){this.sendWebsocket("PRODUCE:"+w)}submitMenuRequest(w,P,x){var v=this;return(0,ve.A)(function*(){return new Promise(_=>{v._getmenu_callback=_,v.sendWebsocket("GETMENU:"+x)})})()}submitExec(w,P,x){if(!this._readonly&&w&&(x||(x=w.snapid),x&&(0,b.isStr)(x)&&P))return this.sendWebsocket(`OBJEXEC:${x}:${P}`)}sendWebsocket(w){return this._websocket?.canSend()?(this._websocket.send(w),!0):(console.warn(`DROP SEND: ${w}`),!1)}closeWebsocket(w){this._websocket&&(this._websocket.close(w),this._websocket.cleanup(),delete this._websocket)}useWebsocket(w){this.closeWebsocket(),this._websocket=w,this._websocket.setReceiver(this),this._websocket.connect()}websocketTimeout(w,P){if(!this._websocket)return;this._websocket._tmouts||(this._websocket._tmouts={});const x=this._websocket._tmouts[w];if(void 0===P)return void 0!==x;"reset"===P?x&&(clearTimeout(x),delete this._websocket._tmouts[w]):!x&&Number.isInteger(P)&&(this._websocket._tmouts[w]=setTimeout(()=>{delete this._websocket._tmouts[w]},P))}onWebsocketOpened(){}onWebsocketClosed(){this.embed_canvas||(0,ke.W4)()}onWebsocketMsg(w,P){if("CLOSE"===P)this.onWebsocketClosed(),this.closeWebsocket(!0);else if("SNAP6:"===P.slice(0,6)){const x=P.indexOf(":",6),v=P.slice(6,x),_=(0,b.parse)(P.slice(x+1));this.syncDraw(!0).then(()=>{this.snapid||this.resizeBrowser(_.fSnapshot.fWindowWidth,_.fSnapshot.fWindowHeight),!this.snapid&&(0,b.isFunc)(this.setFixedCanvasSize)&&(this._online_fixed_size=this.setFixedCanvasSize(_.fSnapshot.fCw,_.fSnapshot.fCh,_.fFixedSize))}).then(()=>this.redrawPadSnap(_)).then(()=>{this.completeCanvasSnapDrawing();let C=this.getWebPadOptions();C&&(C=":"+C),w.send(`READY6:${v}${C}`),this.confirmDraw()})}else if("MENU:"===P.slice(0,5)){const x=(0,b.parse)(P.slice(5));(0,b.isFunc)(this._getmenu_callback)&&(this._getmenu_callback(x),delete this._getmenu_callback)}else if("CMD:"===P.slice(0,4)){const x=(P=P.slice(4)).indexOf(":"),v=P.slice(0,x),_=P.slice(x+1),C=`REPLY:${v}:`;"SVG"===_||"PNG"===_||"JPEG"===_?this.createImage(_.toLowerCase()).then(L=>w.send(C+L)):(console.log(`Unrecognized command ${_}`),w.send(C))}else if("DXPROJ:"===P.slice(0,7)||"DYPROJ:"===P.slice(0,7)){const x=P[1],v=(0,b.parse)(P.slice(7));this.websocketTimeout(`proj${x}`,"reset"),this.drawProjection(x,v)}else if("CTRL:"===P.slice(0,5)){const x=(0,b.parse)(P.slice(5))||{};let v=!1;if(void 0!==x.title&&typeof document<"u"&&(document.title=x.title),x.x&&x.y&&typeof window<"u"&&(window.moveTo(x.x,x.y),v=!0),x.w&&x.h&&(this.resizeBrowser(Number.parseInt(x.w),Number.parseInt(x.h)),v=!0),x.cw&&x.ch&&(0,b.isFunc)(this.setFixedCanvasSize)&&(this._online_fixed_size=this.setFixedCanvasSize(Number.parseInt(x.cw),Number.parseInt(x.ch),!0),v=!0),["Menu","StatusBar","Editor","ToolBar","ToolTips"].forEach(C=>{void 0!==x[C]&&this.showSection(C,"1"===x[C])}),x.edit){const C=this.findSnap(x.edit);C&&this.showSection("Editor",!0).then(()=>this.producePadEvent("select",C.getPadPainter(),C))}x.winstate&&typeof window<"u"&&("iconify"===x.winstate?window.blur():window.focus()),v&&this.sendResized(!0)}else console.log(`unrecognized msg ${P}`)}sendResized(w){if(!this.pad||typeof window>"u")return;const P=this.getPadWidth(),x=this.getPadHeight(),v=window.screenLeft,_=window.screenTop,C=window.outerWidth,L=window.outerHeight,F=this._online_fixed_size?1:0;w||(w=P>0&&x>0&&(this.pad.fCw!==P||this.pad.fCh!==x))&&(this.pad.fCw=P,this.pad.fCh=x),w&&this.sendWebsocket(`RESIZED:${JSON.stringify([v,_,C,L,P,x,F])}`)}clickPadButton(w,P){return"ToggleGed"===w?this.activateGed(this,null,"toggle"):"ToggleStatus"===w?this.activateStatusBar("toggle"):super.clickPadButton(w,P)}hasEventStatus(){return!this.testUI5()&&(this.brlayout?this.brlayout.hasStatus():(0,xe.gZ)()?.hasStatusLine()??!1)}canStatusBar(){return this.testUI5()||this.brlayout||(0,xe.gZ)()}activateStatusBar(w){this.testUI5()||(this.brlayout?this.brlayout.createStatusLine(23,w):(0,xe.gZ)()?.createStatusLine(23,w),this.processChanges("sbits",this))}showCanvasStatus(...w){this.testUI5()||(this.brlayout||(0,xe.gZ)()?.brlayout)?.showStatus(...w)}hasGed(){return!this.testUI5()&&(this.brlayout?.hasContent()??!1)}removeGed(){this.testUI5()||(this.registerForPadEvents(null),this.ged_view&&(this.ged_view.getController().cleanupGed(),this.ged_view.destroy(),delete this.ged_view),this.brlayout?.deleteContent(!0),this.processChanges("sbits",this))}getUi5PanelData(){return{jsroot:{settings:b.settings,create:b.create,parse:b.parse,toJSON:b.toJSON,loadScript:b.loadScript,EAxisBits:et.rb,getColorExec:ke.pp}}}activateGed(w,P,x){var v=this;return(0,ve.A)(function*(){if(v.testUI5()||!v.brlayout)return!1;if(v.brlayout.hasContent())return"toggle"===x||!1===x?v.removeGed():w?.getPadPainter()?.selectObjectPainter(w),!0;if(!1===x)return!1;const _=v.brlayout.createBrowserBtns();return ke.IK.createSVG(_,ke.IK.diamand,15,"toggle fix-pos mode","browser").style("margin","3px").on("click",()=>v.brlayout.toggleKind("fix")),ke.IK.createSVG(_,ke.IK.circle,15,"toggle float mode","browser").style("margin","3px").on("click",()=>v.brlayout.toggleKind("float")),ke.IK.createSVG(_,ke.IK.cross,15,"delete GED","browser").style("margin","3px").on("click",()=>v.removeGed()),v.brlayout.setBrowserContent("<div class='jsroot_browser_hierarchy' id='ged_placeholder'>Loading GED ...</div>"),v.brlayout.setBrowserTitle("GED"),v.brlayout.toggleBrowserKind(P||"float"),new Promise(C=>{(0,ke.cA)().then(L=>{(0,z.Lt)("#ged_placeholder").text(""),L.ui.require(["sap/ui/model/json/JSONModel","sap/ui/core/mvc/XMLView"],(F,U)=>{const j=new F({handle:null});U.create({viewName:"rootui5.canv.view.Ged",viewData:v.getUi5PanelData("Ged")}).then(te=>{te.setModel(j),te.placeAt("ged_placeholder"),v.ged_view=te,v.registerForPadEvents(te.getController().padEventsReceiver.bind(te.getController())),w?.getPadPainter()?.selectObjectPainter(w),console.log("activate GED"),v.processChanges("sbits",v),C(!0)})})})})})()}showSection(w,P){var x=this;return(0,ve.A)(function*(){if(x.testUI5())return!1;switch(w){case"Menu":case"ToolBar":break;case"StatusBar":x.activateStatusBar(P);break;case"Editor":return x.activateGed(x,null,!!P);case"ToolTips":x.setTooltipAllowed(P)}return!0})()}completeCanvasSnapDrawing(){this.pad&&(this.addPadInteractive(),typeof document<"u"&&!this.embed_canvas&&this._websocket&&(document.title=this.pad.fTitle),!this._all_sections_showed&&(this._all_sections_showed=!0,this.showSection("Menu",this.pad.TestBit(Re)),this.showSection("StatusBar",this.pad.TestBit(ot)),this.showSection("ToolBar",this.pad.TestBit(He)),this.showSection("Editor",this.pad.TestBit(Ie)),this.showSection("ToolTips",this.pad.TestBit(O)||this._highlight_connect)))}processHighlightConnect(w){if(!w||0===w.length||!this._highlight_connect||!this._websocket||this.doingDraw()||!this._websocket.canSend(2))return;const P=w[0]||w[1];if(!(P&&P.painter&&P.painter.snapid&&P.user_info))return;const x=P.painter.getPadPainter()||this;if(!x.snapid)return;const v=[x.snapid,P.painter.snapid,"0","0"];void 0!==P.user_info.binx&&void 0!==P.user_info.biny?(v[2]=P.user_info.binx.toString(),v[3]=P.user_info.biny.toString()):void 0!==P.user_info.bin&&(v[2]=P.user_info.bin.toString());const _=JSON.stringify(v);this._last_highlight_msg!==_&&(this._last_highlight_msg=_,this.sendWebsocket(`HIGHLIGHT:${_}`))}processChanges(w,P,x){if(!this._websocket||this._readonly||!this._websocket.canSend(2)||!(0,b.isStr)(w))return;let v="";switch(P||(P=this),w){case"sbits":v="STATUSBITS:"+this.getStatusBits();break;case"frame":case"zoom":(0,b.isFunc)(P.getWebPadOptions)||(P=P.getPadPainter()),(0,b.isFunc)(P.getWebPadOptions)&&(v="OPTIONS6:"+P.getWebPadOptions("only_this"));break;case"padpos":v="OPTIONS6:"+P.getWebPadOptions("with_subpads");break;case"drawopt":P.snapid&&(v="DRAWOPT:"+JSON.stringify([P.snapid.toString(),P.getDrawOpt()||""]));break;case"pave_moved":{const _=(0,Xe.O4)(P);_&&(v="PRIMIT6:"+(0,b.toJSON)(_));break}case"logx":case"logy":case"logz":{const _=P.getPadPainter();_?.snapid&&_?.pad&&(P=_,w=`exec:${"SetLog"+w[3]}(${_.pad["fLog"+w[3]]})`);break}}if(!v&&(0,b.isFunc)(P?.getSnapId)&&"exec:"===w.slice(0,5)){const _=P.getSnapId(x);_&&(v="PRIMIT6:"+(0,b.toJSON)({_typename:"TWebObjectOptions",snapid:_,opt:w.slice(5),fcust:"exec",fopt:[]}))}v?this._websocket.send(v):console.log(`Unprocessed changes ${w} for painter of ${P?.getObject()?._typename} subelem ${x}`)}selectActivePad(w,P,x){if(!this.snapid||!w)return;let v=null,_=!1;const C=w.matchObjectType(Xe.cw);w.snapid&&this._websocket&&(v={_typename:"TWebPadClick",padid:w.snapid.toString(),objid:"",x:-1,y:-1,dbl:!1}),!w.is_active_pad&&!C&&(_=!0,this.forEachPainterInPad(L=>L.drawActiveBorder(null,L===w),"pads")),void 0!==P?.snapid&&v&&(_=!0,v.objid=P.snapid.toString()),x&&v&&(_=!0,v.x=Math.round(x.x||0),v.y=Math.round(x.y||0),x.dbl&&(v.dbl=!0)),v&&(_||C)&&this.sendWebsocket("PADCLICKED:"+(0,b.toJSON)(v))}getStatusBits(){let w=0;return this.hasEventStatus()&&(w|=ot),this.hasGed()&&(w|=Ie),this.isTooltipAllowed()&&(w|=O),this.use_openui&&(w|=Re),w}produceJSON(){const w=this.getObject(),P=0===w.fFillStyle,x=[],v=[];P&&(w.fFillStyle=1001),this.forEachPainterInPad(C=>{const L=C.getMainPainter(),F=C.getFramePainter();if(!(0,b.isFunc)(L?.getHisto)||!(0,b.isFunc)(L?.getDimension))return;const U=L.getHisto(),j=L.getDimension();if(!U?.fXaxis)return;const te=(N,m)=>{F?.zoomChangedInteractive(N)&&(x.push({axis:m,f:m.fFirst,l:m.fLast,b:m.fBits}),m.fFirst=L.getSelectIndex(N,"left",1),m.fLast=L.getSelectIndex(N,"right"),(m.fFirst>0||m.fLast<m.fNbins)!==m.TestBit(et.rb.kAxisRange)&&m.InvertBit(et.rb.kAxisRange))};te("x",U.fXaxis),j>1&&te("y",U.fYaxis),j>2&&te("z",U.fZaxis),2===j&&F?.zoomChangedInteractive("z")&&(v.push({hist:U,min:U.fMinimum,max:U.fMaximum}),U.fMinimum=F.zoom_zmin??F.zmin,U.fMaximum=F.zoom_zmax??F.zmax)},"pads"),this.normal_canvas||this.forEachPainterInPad(C=>{if(C.isSecondary())return;const L=C.getObject();L?._typename&&w.fPrimitives.Add(L,C.getDrawOpt())},"objects");const _=(0,b.toJSON)(w);return P&&(w.fFillStyle=0),x.forEach(C=>{C.axis.fFirst=C.f,C.axis.fLast=C.l,C.axis.fBits=C.b}),v.forEach(C=>{C.hist.fMinimum=C.min,C.hist.fMaximum=C.max}),this.normal_canvas||w.fPrimitives.Clear(),_}resizeBrowser(w,P){!w||!P||this.isBatchMode()||this.embed_canvas||this.batch_mode||(b.browser.qt5&&w>100&&P>60&&(w-=3,P-=30),this._websocket?.resizeWindow(w,P))}static draw(w,P,x){return(0,ve.A)(function*(){const v=!P;v&&(P=(0,b.create)(b.clTCanvas));const _=new ie(w,P);if(_.checkSpecialsInPrimitives(P),!v&&P.fCw&&P.fCh&&!_.isBatchMode()){const C=_.selectDom().node().getBoundingClientRect();!C.height&&C.width>.1*P.fCw&&(_.selectDom().style("width",P.fCw+"px").style("height",P.fCh+"px"),_._fixed_size=!0)}return _.decodeOptions(x),_.normal_canvas=!v,_.createCanvasSvg(0),_.addPadButtons(),v&&x.indexOf("noframe")<0&&ce(w,null),(0,et.QD)({pp:_,active:!0}),_.drawPrimitives().then(()=>(_.addPadInteractive(),_.showPadButtons(),_))})()}}function he(D,w){return ue.apply(this,arguments)}function ue(){return(ue=(0,ve.A)(function*(D,w){if(!D)return Promise.reject(Error("Painter not provided in ensureTCanvas"));const P=!1===w||"3d"===w?"noframe":"";return(D.getCanvSvg().empty()?ie.draw(D.getDom(),null,P):Promise.resolve(!0)).then(()=>(!1!==w&&D.getFrameSvg().selectChild(".main_layer").empty()&&!D.getFramePainter()&&ce(D.getDom(),null,w),D.addToPadPrimitives(),D))})).apply(this,arguments)}function fe(D,w){return le.apply(this,arguments)}function le(){return(le=(0,ve.A)(function*(D,w){const P=(0,b.create)(b.clTCanvas),x=new ie(D,P);return x.normal_canvas=!1,x.addPadButtons(),x.syncDraw(!0).then(()=>x.redrawPadSnap(w)).then(()=>(x.confirmDraw(),x.showPadButtons(),x))})).apply(this,arguments)}function Y(D,w,P){return V.apply(this,arguments)}function V(){return(V=(0,ve.A)(function*(D,w,P){const x=new Je.nc(D,w);return x.mode3d="3d"===P,he(x,!1).then(()=>x.redraw())})).apply(this,arguments)}},4952:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{G_:()=>D,WJ:()=>V,nc:()=>P,qP:()=>ie,wM:()=>w});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(9041),xe=Ee(6224),et=Ee(8732),Je=Ee(4468),Xe=Ee(528),ot=Ee(6370),Re=Ee(6714);const Ie=3e-4;function O(x,v){if(!x)return;const _=x.getFramePainter();(0,b.isFunc)(_?.setTooltipEnabled)&&(_.setTooltipEnabled(v),_.processFrameTooltipEvent(null)),(0,b.isFunc)(x.control?.setTooltipEnabled)&&x.control.setTooltipEnabled(v)}function ce(x,v){return x.$touch_arr??(0,z.D_)(x,v)}function ie(x){switch(x){case 1:return(v,_)=>{const C=Math.PI/180,L=v/2*C,F=_*C,U=Math.sqrt(2),j=2*U/Math.PI,te=Math.cos(F),N=Math.sqrt(1+te*Math.cos(L));return{x:te*Math.sin(L)*2*U/N/j/C,y:Math.sin(F)*U/N/j/C}};case 2:return(v,_)=>({x:v,y:Math.log(Math.tan((Math.PI/2+_/180*Math.PI)/2))});case 3:return(v,_)=>({x:v*Math.cos(_/180*Math.PI),y:_});case 4:return(v,_)=>({x:v*(2*Math.cos(2*_/180*Math.PI/3)-1),y:180*Math.sin(_/180*Math.PI/3)});case 5:return(v,_)=>{const C=_*Math.PI/180;let F,U,L=C;for(let j=0;j<100;j++){if(F=2*L+Math.sin(2*L)-Math.PI*Math.sin(C),U=4*Math.cos(L)**2,U<1e-20){L=C;break}if(L-=F/U,Math.abs(F/U)<1e-4)break}return{x:v*Math.cos(L),y:90*Math.sin(L)}}}}function he(x){if(!(0,b.isFunc)(x?.getDimension)||1!==x.getDimension())return;const v=x.draw_content?x.hmin:x.ymin,_=x.draw_content?x.hmax:x.ymax;x.zoom_ymin!==x.zoom_ymax&&v!==_&&v<=x.zoom_ymin&&x.zoom_ymax<=_&&(x.zoom_ymin=x.zoom_ymax=0)}let ue=null,fe="",le=null;function Y(x,v){return ue&&le===x&&fe===v}function V(x,v){if(!b.settings.MoveResize)return;const _=x,C=_.getPadPainter();if(C?._fast_drawing||C?.isBatchMode())return;function L(N,m){function I(A,R){const k="js_"+A.replace(/[-]/g,"_");let J=N.selectChild("."+k);if(v.cleanup)return J.remove();J.empty()&&(J=N.append("path").classed(k,!0)),J.style("opacity",0).style("cursor",A).attr("d",R),m&&J.call(m)}I("nw-resize","M2,2h15v-5h-20v20h5Z"),I("ne-resize",`M${v.width-2},2h-15v-5h20v20h-5 Z`),I("sw-resize",`M2,${v.height-2}h15v5h-20v-20h5Z`),I("se-resize",`M${v.width-2},${v.height-2}h-15v5h20v-20h-5Z`),v.no_change_x||(I("w-resize",`M-3,18h5v${Math.max(0,v.height-36)}h-5Z`),I("e-resize",`M${v.width+3},18h-5v${Math.max(0,v.height-36)}h5Z`)),v.no_change_y||(I("n-resize",`M18,-3v5h${Math.max(0,v.width-36)}v-5Z`),I("s-resize",`M18,${v.height+3}v-5h${Math.max(0,v.width-36)}v5Z`))}!1===C?.isEditable()&&(v.cleanup=!0),(0,b.isFunc)(v.getDrawG)||(v.getDrawG=()=>_?.draw_g);const F=(N,m,I,A)=>{le=null,fe="",ue&&(ue.remove(),ue=null);const R=v.getDrawG();if(!R)return!1;const k=v.x,J=v.y;v.minwidth&&I<v.minwidth&&(I=v.minwidth),v.minheight&&A<v.minheight&&(A=v.minheight);const _e=I!==v.width||A!==v.height,be=N!==k||m!==J;if(v.x=N,v.y=m,v.width=I,v.height=A,v.no_transform||(0,ke.bk)(R,N,m),O(_,!0),L(R),(_e||be)&&(_e&&(0,b.isFunc)(v.resize)&&v.resize(I,A),be&&(0,b.isFunc)(v.move)&&v.move(N,m,N-k,m-J),_e||be)){if(v.obj){const Te=v.pad_rect??C.getPadRect();v.obj.fX1NDC=N/Te.width,v.obj.fX2NDC=(N+I)/Te.width,v.obj.fY1NDC=1-(m+A)/Te.height,v.obj.fY2NDC=1-m/Te.height,v.obj.modified_NDC=!0}else(0,b.isFunc)(v.move_resize)&&v.move_resize(N,m,I,A);(0,b.isFunc)(v.redraw)&&v.redraw(v)}return _e||be},U=(0,z.$E)().subject(Object),j=(0,z.$E)().subject(Object);j.on("start",null).on("drag",null).on("end",null),U.on("start",function(N){if((0,Re.iE)(N.sourceEvent)||fe||(0,b.isFunc)(v.is_disabled)&&v.is_disabled("move"))return;(0,ot.IV)(),O(_,!1),N.sourceEvent.preventDefault(),N.sourceEvent.stopPropagation();const m=v.pad_rect??C.getPadRect(),I={x:v.x,y:v.y,width:v.width,height:v.height,acc_x1:v.x,acc_y1:v.y,pad_w:m.width-v.width,pad_h:m.height-v.height,drag_tm:new Date,path:`v${v.height}h${v.width}v${-v.height}z`,evnt_x:N.x,evnt_y:N.y};le=_,fe="move",ue=(0,z.Lt)(v.getDrawG().node().parentNode).append("path").attr("d",`M${I.acc_x1},${I.acc_y1}${I.path}`).style("cursor","move").style("pointer-events","none").property("drag_handle",I).call(ke.Ru,!0)}).on("drag",function(N){if(!Y(_,"move"))return;N.sourceEvent.preventDefault(),N.sourceEvent.stopPropagation();const m=ue.property("drag_handle");v.no_change_x||(m.acc_x1+=N.dx),v.no_change_y||(m.acc_y1+=N.dy),m.x=Math.min(Math.max(m.acc_x1,0),m.pad_w),m.y=Math.min(Math.max(m.acc_y1,0),m.pad_h),ue.attr("d",`M${m.x},${m.y}${m.path}`)}).on("end",function(N){if(!Y(_,"move"))return;N.sourceEvent.stopPropagation(),N.sourceEvent.preventDefault();const m=ue.property("drag_handle");if(!1===F(m.x,m.y,v.width,v.height)){const I=(new Date).getTime()-m.drag_tm.getTime();v.ctxmenu&&I>600?(0,ot.sj)({clientX:m.evnt_x,clientY:m.evnt_y,skip_close:1},_):v.canselect&&I<=600&&_.getPadPainter()?.selectObjectPainter(_)}});const te=(0,z.$E)().subject(Object);te.on("start",function(N){if((0,Re.iE)(N.sourceEvent)||fe||(0,b.isFunc)(v.is_disabled)&&v.is_disabled("resize"))return;(0,ot.IV)(),O(_,!1),N.sourceEvent.stopPropagation(),N.sourceEvent.preventDefault();const m=v.pad_rect??C.getPadRect(),I={x:v.x,y:v.y,width:v.width,height:v.height,acc_x1:v.x,acc_y1:v.y,acc_x2:v.x+v.width,acc_y2:v.y+v.height,pad_w:m.width,pad_h:m.height};le=_,fe="resize",ue=(0,z.Lt)(v.getDrawG().node().parentNode).append("rect").style("cursor",(0,z.Lt)(this).style("cursor")).attr("x",I.acc_x1).attr("y",I.acc_y1).attr("width",I.acc_x2-I.acc_x1).attr("height",I.acc_y2-I.acc_y1).property("drag_handle",I).call(ke.Ru,!0)}).on("drag",function(N){if(!Y(_,"resize"))return;N.sourceEvent.preventDefault(),N.sourceEvent.stopPropagation();const m=ue.property("drag_handle"),I=(0,z.Lt)(this);let A=N.dx,R=N.dy;v.no_change_x&&(A=0),v.no_change_y&&(R=0),I.classed("js_nw_resize")?(m.acc_x1+=A,m.acc_y1+=R):I.classed("js_ne_resize")?(m.acc_x2+=A,m.acc_y1+=R):I.classed("js_sw_resize")?(m.acc_x1+=A,m.acc_y2+=R):I.classed("js_se_resize")?(m.acc_x2+=A,m.acc_y2+=R):I.classed("js_w_resize")?m.acc_x1+=A:I.classed("js_n_resize")?m.acc_y1+=R:I.classed("js_e_resize")?m.acc_x2+=A:I.classed("js_s_resize")&&(m.acc_y2+=R);const k=Math.max(0,m.acc_x1),J=Math.min(m.acc_x2,m.pad_w),_e=Math.max(0,m.acc_y1),be=Math.min(m.acc_y2,m.pad_h);m.x=Math.min(k,J),m.y=Math.min(_e,be),m.width=Math.abs(J-k),m.height=Math.abs(be-_e),ue.attr("x",m.x).attr("y",m.y).attr("width",m.width).attr("height",m.height)}).on("end",function(N){if(!Y(_,"resize"))return;N.sourceEvent.preventDefault();const m=ue.property("drag_handle");F(m.x,m.y,m.width,m.height)}),v.only_resize||v.getDrawG().style("cursor",v.cleanup?null:"move").call(v.cleanup?j:U),v.only_move||L(v.getDrawG(),te)}const D={hints_layer(){return this.getCanvPainter()?.getLayerSvg("info_layer")??(0,z.Lt)(null)},isTooltipShown(){if(!this.tooltip_enabled||!this.isTooltipAllowed())return!1;const x=this.hints_layer().selectChild(".objects_hints");return!x.empty()&&x.property("hints_pad")===this.getPadName()},setTooltipEnabled(x){void 0!==x&&(this.tooltip_enabled=x)},processFrameTooltipEvent(x,v){if(x?.handler){const Tn=this.draw_g?.selectChild(".main_layer");if(!Tn||Tn.empty())x=null;else if(x.touch&&v){const Hn=ce(v,Tn.node());x=Hn&&1===Hn.length?{touch:!0,x:Hn[0][0],y:Hn[0][1]}:null}else if(v){const Hn=(0,z.Wn)(v,Tn.node());x={touch:!1,x:Hn[0],y:Hn[1]}}}let _=0,C=0,L=0,F=0,U=!1,j=11;const I=this.getFrameRect(),A=this.getPadPainter(),R=A?.getPadWidth(),k=new Xe.qg(160,j),J=!this.isTooltipAllowed()||!this.tooltip_enabled;x&&(x.disabled=J,x.painters=!0);const _e=A?.processPadTooltipEvent(x)??[];A?._deliver_webcanvas_events&&A?.is_active_pad&&x&&(0,b.isFunc)(A?.deliverWebCanvasEvent)&&A.deliverWebCanvasEvent("move",I.x+x.x,I.y+x.y,_e),x?.touch&&(j=15);for(let Tn=0;Tn<_e.length;++Tn){const Hn=_e[Tn];if(Hn){if(void 0!==Hn.user_info&&Hn.painter?.provideUserTooltip(Hn.user_info),!Hn.lines||0===Hn.lines.length){_e[Tn]=null;continue}for(let ti=0;ti<Tn;++ti){const hi=_e[ti];let ai=!1;if(hi&&hi.lines.length===Hn.lines.length){for(let Xi=0;Xi<Hn.lines.length&&!ai;++Xi)hi.lines[Xi]!==Hn.lines[Xi]&&(ai=!0);if(!ai){_e[Tn]=null;break}}}_e[Tn]&&(_++,Hn.exact&&C++,Hn.lines.forEach(ti=>{L=Math.max(L,ti.length)}),Hn.height=Math.round(Hn.lines.length*j*1.2+6-j*(1.2-1)),void 0!==Hn.color1&&"none"!==Hn.color1&&(0!==F&&F!==Hn.color1&&(U=!0),F=Hn.color1))}}let be=null,Te=_e.length>1;for(let Tn=0;Tn<_e.length;++Tn){const Hn=_e[Tn],ti=Hn?.lines?Hn.lines[0]?.lastIndexOf("/"):-1;if(ti>0){const hi=Hn.lines[0].slice(0,ti+1);null===be?be=hi:be!==hi&&(Te=!1)}else Te=!1}const Pe=this.hints_layer(),We=_>15,dt=x?Math.round(x.x)+","+Math.round(x.y):"";let Q=Pe.selectChild(".objects_hints"),Ke="",Ze="",Ue="",Oe=null,lt=1e10,gt=null;for(let Tn=0;Tn<_e.length;++Tn){if(!_e[Tn])continue;if(Oe||(Oe=_e[Tn]),_e[Tn].exact&&C<2&&(!Oe||!Oe.exact)){Oe=_e[Tn];break}if(!x||void 0===_e[Tn].x||void 0===_e[Tn].y)continue;const Hn=(x.x-_e[Tn].x)**2+(x.y-_e[Tn].y)**2;Hn<lt&&(lt=Hn,gt=_e[Tn])}if((!Oe||!Oe.exact)&&lt<400&&(Oe=gt),Oe&&(Ze=Oe.lines&&Oe.lines.length>1?Oe.lines[0]:Oe.name,Ke=Oe.title||"",Ue=Oe.line,!Ue&&Oe.lines&&(Ue=Oe.lines.slice(1).join(" "))),this.showObjectStatus(Ze,Ke,Ue,dt),!x||J||0===_e.length||0===L||We&&!gt)return void Q.remove();Q.empty()&&(Q=Pe.append("svg:g").attr("class","objects_hints").style("pointer-events","none"));let ht={x:0,y:0},st=I.transform||"";A.iscan||(ht=(0,ke.md)(this.getPadSvg(),ht),st=`translate(${ht.x},${ht.y}) ${st}`),Q.attr("transform",st).property("last_point",x).property("hints_pad",this.getPadName());let yt=Q.property("viewmode")||"",Kt=0,Ot=x.x+I.hint_delta_x;if(We||1===_)yt="single",Ot+=15;else{let Tn=.5,Hn=.5;"left"===yt?Hn=.7:"right"===yt&&(Tn=.3),Ot<=Tn*I.width?(yt="left",Ot=20):Ot>=Hn*I.width?(yt="right",Ot=I.width-60):Ot=Q.property("startx")}yt!==Q.property("viewmode")&&(Q.property("viewmode",yt),Q.selectAll("*").remove());let It=10,An=10,on=-1111,pn=-1111;const Qt=-ht.y,Bn=this.getCanvPainter(),dn=Bn.getPadHeight()-I.y-ht.y;for(let Tn=0;Tn<_e.length;++Tn){let Xi=function(){return function(){return function(Or){return Or<.8?"0":5*(Or-.8)}}},Hn=_e[Tn],ti=Q.selectChild(`.painter_hint_${Tn}`);if(We&&Hn!==gt&&(Hn=null),null===Hn){ti.remove();continue}const hi=ti.empty();if(hi&&(ti=Q.append("svg:svg").attr("class",`painter_hint_${Tn}`).attr("opacity",0).style("overflow","hidden").style("pointer-events","none")),"single"===yt)It=x.touch?x.y-Hn.height-5:Math.min(x.y+15,dn-Hn.height-3)+I.hint_delta_y;else{for(let Or=0;Or<_e.length&&An<dn;++Or){const Tr=_e[Or];Tr&&Tr.y>=An-5&&Tr.y<=An+Tr.height+5&&(An=Tr.y+10,Or=-1)}-1111===on&&-1111===pn&&(on=pn=Hn.x),on=Math.min(on,Hn.x),pn=Math.min(pn,Hn.x)}ti.attr("x",Ot).attr("y",It).property("curry",It).property("gapy",An),It+=Hn.height+5,An+=Hn.height+5,hi||ti.selectAll("*").remove(),ti.attr("width",60).attr("height",Hn.height);const ai=ti.append("rect").attr("x",0).attr("y",0).attr("width",60).attr("height",Hn.height).style("fill","lightgrey").style("pointer-events","none");if(_>1){const Or=U?Hn.color1:Hn.color2;Or&&"none"!==Or&&ai.style("stroke",Or)}ai.attr("stroke-width",Hn.exact?3:1);for(let Or=0;Or<(Hn.lines?.length??0);Or++){let Tr=Hn.lines[Or];if(0===Or&&be&&Te&&(Tr=Tr.slice(be.length)),Tr){const ys=ti.append("svg:text").attr("text-anchor","start").attr("x",3).attr("y",3+Or*j*1.2).attr("dy",".8em").style("fill","black").style("pointer-events","none").call(k.func).text(Tr),ds=(0,ke.xh)(ys,"bbox");Kt=Math.max(Kt,ds.width)}}hi&&(b.settings.TooltipAnimation>0?ti.transition().duration(b.settings.TooltipAnimation).attrTween("opacity",Xi()):ti.attr("opacity",1))}Kt+=6;const yn=Q.selectAll("svg");if("right"===yt&&Ot+Kt>I.width-20&&(Ot=I.width-Kt-20,yn.attr("x",Ot)),"single"===yt&&Ot+Kt>R-I.x&&Ot>Kt+20&&(Ot-=Kt+20,yn.attr("x",Ot)),"single"!==yt&&An<dn&&An!==It)on<=Ot+Kt+5&&pn>=Ot-5&&yn.attr("y",function(){return(0,z.Lt)(this).property("gapy")});else if("single"!==yt&&It>dn){const Tn=Math.max(dn-It-10,Qt);Tn<0&&yn.attr("y",function(){return(0,z.Lt)(this).property("curry")+Tn})}Kt>10&&yn.attr("width",Kt).select("rect").attr("width",Kt),Q.property("startx",Ot),Bn._highlight_connect&&(0,b.isFunc)(Bn.processHighlightConnect)&&Bn.processHighlightConnect(_e)},assign(x){Object.assign(x,this,{tooltip_enabled:!0})}},w={addBasicInteractivity(){D.assign(this),!this._frame_rotate&&!this._frame_fixpos&&V(this,{obj:this,x:this._frame_x,y:this._frame_y,width:this.getFrameWidth(),height:this.getFrameHeight(),is_disabled:F=>"move"===F&&this.mode3d,only_resize:!0,minwidth:20,minheight:20,redraw:()=>this.sizeChanged()});const x=this.draw_g.selectChild("path"),v=this.draw_g.selectChild(".main_layer");x.style("pointer-events","visibleFill").style("cursor","default"),v.style("pointer-events","visibleFill").style("cursor","default").property("handlers_set",0);const _=this.getPadPainter(),C=_?._fast_drawing?0:1;if(v.property("handlers_set")!==C){const F=C?this.processFrameTooltipEvent.bind(this,null):null,U=C?this.processFrameTooltipEvent.bind(this,{handler:!0,touch:!1}):null;if(v.property("handlers_set",C).on("mouseenter",U).on("mousemove",U).on("mouseleave",F),b.browser.touches){const j=C?this.processFrameTooltipEvent.bind(this,{handler:!0,touch:!0}):null;v.on("touchstart",j).on("touchmove",j).on("touchend",F).on("touchcancel",F)}}v.attr("x",0).attr("y",0).attr("width",this.getFrameWidth()).attr("height",this.getFrameHeight());const L=this.hints_layer().selectChild(".objects_hints");!L.empty()&&this.isTooltipAllowed()&&L.property("hints_pad")===this.getPadName()&&setTimeout(this.processFrameTooltipEvent.bind(this,L.property("last_point"),null),10)},addFrameInteractivity(x){var v=this;return(0,ve.A)(function*(){const _=v.getPadPainter(),C=v.getFrameSvg();if(_?._fast_drawing||C.empty())return v;if(x){const U=C.selectAll(".x2axis_container"),j=C.selectAll(".y2axis_container");return b.settings.ContextMenu&&(U.on("contextmenu",te=>v.showContextMenu("x2",te)),j.on("contextmenu",te=>v.showContextMenu("y2",te))),U.on("mousemove",te=>v.showAxisStatus("x2",te)),j.on("mousemove",te=>v.showAxisStatus("y2",te)),v}const L=C.selectAll(".xaxis_container"),F=C.selectAll(".yaxis_container");return v.can_zoom_x=v.can_zoom_y=b.settings.Zooming,_?.options&&(_.options.NoZoomX&&(v.can_zoom_x=!1),_.options.NoZoomY&&(v.can_zoom_y=!1)),C.property("interactive_set")||(v.addFrameKeysHandler(),v.zoom_kind=0,v.zoom_rect=null,v.zoom_origin=null,v.zoom_curr=null),b.settings.Zooming&&(b.settings.ZoomMouse&&(C.on("mousedown",U=>v.startRectSel(U)),C.on("dblclick",U=>v.mouseDoubleClick(U))),b.settings.ZoomWheel&&C.on("wheel",U=>v.mouseWheel(U))),b.browser.touches&&(b.settings.Zooming&&b.settings.ZoomTouch||b.settings.ContextMenu)&&C.on("touchstart",U=>v.startTouchZoom(U)),b.settings.ContextMenu&&(b.browser.touches&&(L.on("touchstart",U=>v.startSingleTouchHandling("x",U)),F.on("touchstart",U=>v.startSingleTouchHandling("y",U))),C.on("contextmenu",U=>v.showContextMenu("",U)),L.on("contextmenu",U=>v.showContextMenu("x",U)),F.on("contextmenu",U=>v.showContextMenu("y",U))),L.on("mousemove",U=>v.showAxisStatus("x",U)),F.on("mousemove",U=>v.showAxisStatus("y",U)),C.property("interactive_set",!0),v})()},addFrameKeysHandler(){this.keys_handler||typeof window>"u"||(this.keys_handler=x=>this.processKeyPress(x),window.addEventListener("keydown",this.keys_handler,!1))},processKeyPress(x){if((0,ot.as)())return!0;const _=this.selectDom(),C=this.getPadPainter();let L=x.key;if(!b.settings.HandleKeys||_.empty()||!1===this.enabledKeys||(0,xe.OZ)()!==C||["PageUp","PageDown","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PrintScreen","Escape","*"].indexOf(L)<0)return!1;x.shiftKey&&(L=`Shift ${L}`),x.altKey&&(L=`Alt ${L}`),x.ctrlKey&&(L=`Ctrl ${L}`);const F={name:"x",dleft:0,dright:0};switch(L){case"ArrowLeft":F.dleft=-1,F.dright=1;break;case"ArrowRight":F.dleft=1,F.dright=-1;break;case"Ctrl ArrowLeft":F.dleft=F.dright=-1;break;case"Ctrl ArrowRight":F.dleft=F.dright=1;break;case"ArrowUp":F.name="y",F.dleft=1,F.dright=-1;break;case"ArrowDown":F.name="y",F.dleft=-1,F.dright=1;break;case"Ctrl ArrowUp":F.name="y",F.dleft=F.dright=1;break;case"Ctrl ArrowDown":F.name="y",F.dleft=F.dright=-1;break;case"Escape":return C?.enlargePad(null,!1,!0),!0}if(F.dleft||F.dright){if(!b.settings.Zooming||this.mode3d&&0!==L.indexOf("Ctrl"))return!1;this.analyzeMouseWheelEvent(null,F,.5),F.changed&&(this.zoom(F.name,F.min,F.max),this.zoomChangedInteractive(F.name,!0)),x.stopPropagation(),x.preventDefault()}else{const U=C?.findPadButton(L);U&&(C.clickPadButton(U),x.stopPropagation(),x.preventDefault())}return!0},processFrameClick(x,v){const _=this.getPadPainter();if(!_)return;x.painters=!0,x.disabled=!0;const C=_.processPadTooltipEvent(x);let F,L=null;for(let U=0;U<C.length&&!L;++U)C[U]&&C[U].exact&&(L=C[U]);if(L){const U=v?this._dblclick_handler:this._click_handler;U&&(F=U(L.user_info,x))}return v||_.selectObjectPainter(L?L.painter:this,{x:x.x+(this._frame_x||0),y:x.y+(this._frame_y||0)}),F},shiftMoveHanlder(x,v){if(x.buttons===this._shifting_buttons){const _=this.getFrameSvg(),C=(0,z.Wn)(x,_.node()),L=this.draw_g.selectChild(".main_layer"),F=v[0]-C[0],U=1===this.scales_ndim?0:v[1]-C[1],j=this.getFrameWidth(),te=this.getFrameHeight();this._shifting_dx=F,this._shifting_dy=U,L.attr("viewBox",`${F} ${U} ${j} ${te}`),x.preventDefault(),x.stopPropagation()}},shiftUpHanlder(x){x.preventDefault(),(0,z.Lt)(window).on("mousemove.shiftHandler",null).on("mouseup.shiftHandler",null),void 0!==this._shifting_dx&&void 0!==this._shifting_dy&&this.performScalesShift()},performScalesShift(){const x=this.getFrameWidth(),v=this.getFrameHeight(),_=this.draw_g.selectChild(".main_layer"),C=this.getGrFuncs(),L=C.revertAxis("x",this._shifting_dx),F=C.revertAxis("x",this._shifting_dx+x),U=C.revertAxis("y",this._shifting_dy+v),j=C.revertAxis("y",this._shifting_dy);_.attr("viewBox",`0 0 ${x} ${v}`),delete this._shifting_dx,delete this._shifting_dy,O(this,!0),1===this.scales_ndim?this.zoomSingle("x",L,F):this.zoom(L,F,U,j)},startRectSel(x){if(this.zoom_kind>100)return;const v=this.getFrameSvg(),_=(0,z.Wn)(x,v.node());if(3===x.buttons||1===x.button)return this.clearInteractiveElements(),this._shifting_buttons=x.buttons,x.$emul||(0,z.Lt)(window).on("mousemove.shiftHandler",F=>this.shiftMoveHanlder(F,_)).on("mouseup.shiftHandler",F=>this.shiftUpHanlder(F),!0),O(this,!1),x.preventDefault(),void x.stopPropagation();if(0!==x.button)return;x.preventDefault(),this.clearInteractiveElements();const C=this.getFrameWidth(),L=this.getFrameHeight();return this.zoom_lastpos=_,this.zoom_curr=[Math.max(0,Math.min(C,_[0])),Math.max(0,Math.min(L,_[1]))],this.zoom_origin=[0,0],this.zoom_second=!1,_[0]<0||_[0]>C?(this.zoom_second=_[0]>C&&this.y2_handle,this.zoom_kind=3,this.zoom_origin[1]=this.zoom_curr[1],this.zoom_curr[0]=C,this.zoom_curr[1]+=1):_[1]<0||_[1]>L?(this.zoom_second=_[1]<0&&this.x2_handle,this.zoom_kind=2,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_curr[0]+=1,this.zoom_curr[1]=L):(this.zoom_kind=1,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_origin[1]=this.zoom_curr[1]),x.$emul||(0,z.Lt)(window).on("mousemove.zoomRect",F=>this.moveRectSel(F)).on("mouseup.zoomRect",F=>this.endRectSel(F),!0),this.zoom_rect=null,O(this,!1),x.stopPropagation(),1!==this.zoom_kind?(0,b.postponePromise)(()=>this.startLabelsMove(),500):void 0},startLabelsMove(){if(this.zoom_rect)return;const x=2===this.zoom_kind?this.x_handle:this.y_handle;!(0,b.isFunc)(x?.processLabelsMove)||!this.zoom_lastpos||x.processLabelsMove("start",this.zoom_lastpos)&&(this.zoom_labels=x)},moveRectSel(x){if(0===this.zoom_kind||this.zoom_kind>100)return;x.preventDefault();const v=(0,z.Wn)(x,this.getFrameSvg().node());if(this.zoom_labels)return this.zoom_labels.processLabelsMove("move",v);switch(this.zoom_lastpos[0]=v[0],this.zoom_lastpos[1]=v[1],v[0]=Math.max(0,Math.min(this.getFrameWidth(),v[0])),v[1]=Math.max(0,Math.min(this.getFrameHeight(),v[1])),this.zoom_kind){case 1:this.zoom_curr[0]=v[0],this.zoom_curr[1]=v[1];break;case 2:this.zoom_curr[0]=v[0];break;case 3:this.zoom_curr[1]=v[1]}const _=Math.min(this.zoom_origin[0],this.zoom_curr[0]),C=Math.min(this.zoom_origin[1],this.zoom_curr[1]),L=Math.abs(this.zoom_curr[0]-this.zoom_origin[0]),F=Math.abs(this.zoom_curr[1]-this.zoom_origin[1]);if(!this.zoom_rect){if(1!==this.zoom_kind&&(L<2||F<2))return;this.zoom_rect=this.getFrameSvg().append("rect").style("pointer-events","none").call(ke.Ru,!0)}this.zoom_rect.attr("x",_).attr("y",C).attr("width",L).attr("height",F)},endRectSel(x){if(0===this.zoom_kind||this.zoom_kind>100)return;x.preventDefault(),x.$emul||(0,z.Lt)(window).on("mousemove.zoomRect",null).on("mouseup.zoomRect",null);const v=(0,z.Wn)(x,this.getFrameSvg().node());let C,_=this.zoom_kind;if(this.zoom_labels)this.zoom_labels.processLabelsMove("stop",v);else{const F=[this.can_zoom_x,this.can_zoom_y];switch(v[0]=Math.max(0,Math.min(this.getFrameWidth(),v[0])),v[1]=Math.max(0,Math.min(this.getFrameHeight(),v[1])),this.zoom_kind){case 1:this.zoom_curr[0]=v[0],this.zoom_curr[1]=v[1];break;case 2:this.zoom_curr[0]=v[0],F[1]=!1;break;case 3:this.zoom_curr[1]=v[1],F[0]=!1}const U=this.swap_xy?1:0,j=1-U;let te,N,m,I,A=!1,R="x",k="y";F[U]&&Math.abs(this.zoom_curr[U]-this.zoom_origin[U])>10&&(this.zoom_second&&2===this.zoom_kind&&(R="x2"),te=Math.min(this.revertAxis(R,this.zoom_origin[U]),this.revertAxis(R,this.zoom_curr[U])),N=Math.max(this.revertAxis(R,this.zoom_origin[U]),this.revertAxis(R,this.zoom_curr[U])),A=!0),F[j]&&Math.abs(this.zoom_curr[j]-this.zoom_origin[j])>10&&(this.zoom_second&&3===this.zoom_kind&&(k="y2"),m=Math.min(this.revertAxis(k,this.zoom_origin[j]),this.revertAxis(k,this.zoom_curr[j])),I=Math.max(this.revertAxis(k,this.zoom_origin[j]),this.revertAxis(k,this.zoom_curr[j])),A=!0),"x2"===R?(this.zoomChangedInteractive(R,!0),C=this.zoomSingle(R,te,N),_=0):"y2"===k?(this.zoomChangedInteractive(k,!0),C=this.zoomSingle(k,m,I),_=0):A&&(this.zoomChangedInteractive("x",!0),this.zoomChangedInteractive("y",!0),C=this.zoom(te,N,m,I),_=0)}const L=1===_?{x:this.zoom_origin[0],y:this.zoom_origin[1]}:null;switch(this.clearInteractiveElements(),_){case 1:this.processFrameClick(L);break;case 2:this.getPadPainter()?.selectObjectPainter(this,null,"xaxis");break;case 3:this.getPadPainter()?.selectObjectPainter(this,null,"yaxis")}return C},mouseDoubleClick(x){x.preventDefault();const v=(0,z.Wn)(x,this.getFrameSvg().node()),_=this.getFrameWidth(),C=this.getFrameHeight();this.clearInteractiveElements();const L=v[0]>=0&&v[0]<=_,F=v[1]>=0&&v[1]<=C;if(L&&F&&this._dblclick_handler&&this.processFrameClick({x:v[0],y:v[1]},!0))return;let U=(this.can_zoom_x?"x":"")+(this.can_zoom_y?"y":"")+"z";if(L){if(!F){if(!this.can_zoom_x)return;U=this.swap_xy?"y":"x",v[1]<0&&this[U+"2_handle"]&&(U+="2")}}else{if(!this.can_zoom_y)return;U=this.swap_xy?"x":"y",v[0]>_&&this[U+"2_handle"]&&(U+="2")}return this.unzoom(U).then(j=>{if(j)return;const te=this.getPadPainter(),N=this.getFrameRect();return te?.selectObjectPainter(te,{x:v[0]+N.x,y:v[1]+N.y,dbl:!0})})},startTouchZoom(x){if(x.preventDefault(),x.stopPropagation(),0!==this.zoom_kind||fe)return;const v=ce(x,this.getFrameSvg().node());if(1===v.length){const U=(new Date).getTime();let j=1e10,te=100,N=100;this.last_touch_time&&this.last_touch_pos&&(j=U-this.last_touch_time,te=Math.abs(v[0][0]-this.last_touch_pos[0]),N=Math.abs(v[0][1]-this.last_touch_pos[1])),this.last_touch_time=U,this.last_touch_pos=v[0],j<500&&te<20&&N<20?(this.clearInteractiveElements(),this.unzoom("xyz"),delete this.last_touch_time):b.settings.ContextMenu&&this.startSingleTouchHandling("",x)}if(2!==v.length||!b.settings.Zooming||!b.settings.ZoomTouch)return;this.clearInteractiveElements(),this.endSingleTouchHandling(null);const _=v[0],C=v[1],L=this.getFrameWidth(),F=this.getFrameHeight();this.zoom_curr=[Math.min(_[0],C[0]),Math.min(_[1],C[1])],this.zoom_origin=[Math.max(_[0],C[0]),Math.max(_[1],C[1])],this.zoom_second=!1,this.zoom_curr[0]<0||this.zoom_curr[0]>L?(this.zoom_second=this.zoom_curr[0]>L&&this.y2_handle,this.zoom_kind=103,this.zoom_curr[0]=0,this.zoom_origin[0]=L):this.zoom_origin[1]>F||this.zoom_origin[1]<0?(this.zoom_second=this.zoom_origin[1]<0&&this.x2_handle,this.zoom_kind=102,this.zoom_curr[1]=0,this.zoom_origin[1]=F):this.zoom_kind=101,fe="zoom",O(this,!1),this.zoom_rect=this.getFrameSvg().append("rect").attr("id","zoomRect").attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]).call(ke.Ru,!0),x.$emul||(0,z.Lt)(window).on("touchmove.zoomRect",U=>this.moveTouchZoom(U)).on("touchcancel.zoomRect",U=>this.endTouchZoom(U)).on("touchend.zoomRect",U=>this.endTouchZoom(U))},moveTouchZoom(x){if(this.zoom_kind<100)return;x.preventDefault();const v=ce(x,this.getFrameSvg().node());if(2!==v.length)return this.clearInteractiveElements();const _=v[0],C=v[1];103!==this.zoom_kind&&(this.zoom_curr[0]=Math.min(_[0],C[0]),this.zoom_origin[0]=Math.max(_[0],C[0])),102!==this.zoom_kind&&(this.zoom_curr[1]=Math.min(_[1],C[1]),this.zoom_origin[1]=Math.max(_[1],C[1])),this.zoom_rect.attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]),(this.zoom_origin[0]-this.zoom_curr[0]>10||this.zoom_origin[1]-this.zoom_curr[1]>10)&&O(this,!1),x.stopPropagation()},endTouchZoom(x){if(this.zoom_kind<100)return;fe="",x.preventDefault(),x.$emul||(0,z.Lt)(window).on("touchmove.zoomRect",null).on("touchend.zoomRect",null).on("touchcancel.zoomRect",null);let v,_,C,L,F=!1,U="x",j="y";const te=this.swap_xy?1:0,N=1-te,m=[!0,!0];102===this.zoom_kind&&(m[1]=!1),103===this.zoom_kind&&(m[0]=!1),m[te]&&Math.abs(this.zoom_curr[te]-this.zoom_origin[te])>10&&(this.zoom_second&&102===this.zoom_kind&&(U="x2"),v=Math.min(this.revertAxis(U,this.zoom_origin[te]),this.revertAxis(U,this.zoom_curr[te])),_=Math.max(this.revertAxis(U,this.zoom_origin[te]),this.revertAxis(U,this.zoom_curr[te])),F=!0),m[N]&&Math.abs(this.zoom_curr[N]-this.zoom_origin[N])>10&&(this.zoom_second&&103===this.zoom_kind&&(j="y2"),C=Math.min(this.revertAxis(j,this.zoom_origin[N]),this.revertAxis(j,this.zoom_curr[N])),L=Math.max(this.revertAxis(j,this.zoom_origin[N]),this.revertAxis(j,this.zoom_curr[N])),F=!0),this.clearInteractiveElements(),delete this.last_touch_time,"x2"===U?(this.zoomChangedInteractive(U,!0),this.zoomSingle(U,v,_)):"y2"===j?(this.zoomChangedInteractive(j,!0),this.zoomSingle(j,C,L)):F&&(this.zoomChangedInteractive("x",!0),this.zoomChangedInteractive("y",!0),this.zoom(v,_,C,L)),x.stopPropagation()},analyzeMouseWheelEvent(x,v,_,C,L){const F=L?this[v.name+"2_handle"]:null;return F?(v.second=Object.assign({},v),F.analyzeWheelEvent(x,_,v.second,C)):this[v.name+"_handle"]?.analyzeWheelEvent(x,_,v,C)},isAllowedDefaultYZooming(){if(this.self_drawaxes)return!0;const x=this.getPadPainter();if(x?.painters)for(let v=0;v<x.painters.length;++v){const _=x.painters[v];if(void 0!==_?.wheel_zoomy)return _.wheel_zoomy}return!1},mouseWheel(x){x.stopPropagation(),x.preventDefault(),this.clearInteractiveElements();const v={name:"x",reverse:this.reverse_x},_={name:"y",reverse:this.reverse_y,ignore:!this.isAllowedDefaultYZooming()},C=(0,z.Wn)(x,this.getFrameSvg().node()),L=this.getFrameWidth(),F=this.getFrameHeight();this.can_zoom_x&&this.analyzeMouseWheelEvent(x,this.swap_xy?_:v,C[0]/L,C[1]>=0&&C[1]<=F,C[1]<0),this.can_zoom_y&&this.analyzeMouseWheelEvent(x,this.swap_xy?v:_,1-C[1]/F,C[0]>=0&&C[0]<=L,C[0]>L);let U=this.zoom(v.min,v.max,_.min,_.max);return v.changed&&this.zoomChangedInteractive("x",!0),_.changed&&this.zoomChangedInteractive("y",!0),v.second&&(U=U.then(()=>this.zoomSingle("x2",v.second.min,v.second.max)),v.second.changed&&this.zoomChangedInteractive("x2",!0)),_.second&&(U=U.then(()=>this.zoomSingle("y2",_.second.min,_.second.max)),_.second.changed&&this.zoomChangedInteractive("y2",!0)),U},showContextMenu(x,v,_){if(3===v?.buttons)return v.preventDefault();if("zoom_kind"in this&&this.zoom_kind>100)return;let C,L=this,F=null,U=!1,j=null;const te=this.getFrameSvg().node();if((0,b.isFunc)(v?.stopPropagation)){v.preventDefault(),v.stopPropagation();const N=(0,z.Wn)(v,te),m=ce(v,te);1===m.length?C={x:m[0][0],y:m[0][1],touch:!0}:2===N.length&&(C={x:N[0],y:N[1],touch:!1})}else if(void 0!==v?.x&&void 0!==v?.y&&void 0===v?.clientX){C=v;const N=te.getBoundingClientRect();v={clientX:N.left+C.x,clientY:N.top+C.y}}if("painter"===x&&_)L=_,x="";else if("main"===x)L=this.getMainPainter(!0),x="";else if(x)("x"===x||"y"===x||"z"===x||"pal"===x)&&(F=this.getMainPainter(!0),this.v7_frame&&(0,b.isFunc)(F?.v7EvalAttr)&&(F=null));else{const N=this.getPadPainter();let m=null;if(j=this,C&&N){C.painters=!0;const I=N.processPadTooltipEvent(C);let A=1e3;for(let R=0;R<I.length;++R)if(I[R]?.menu){const k=I[R].menu_dist??7;k<A&&(m=I[R].painter,A=k)}}m?L=m:x="frame",C&&(U=C.x>0&&C.x<20&&C.y>0&&C.y<20),j.setLastEventPos(C)}return F||(F=L),(0,b.isFunc)(L?.fillContextMenu)?(this.clearInteractiveElements(),(0,ot.ES)(v,L).then(N=>{let m=N.painter.fillContextMenu(N,x,_);if(j&&(!m||U&&"frame"!==x)&&(m=j.fillContextMenu(N)),m)return F.fillObjectExecMenu(N,x).then(I=>(O(I.painter,!1),I.show().then(()=>O(I.painter,!0))))})):void 0},startSingleTouchHandling(x,v){const _=ce(v,this.getFrameSvg().node());if(1!==_.length)return;v.preventDefault(),v.stopPropagation(),(0,ot.IV)();const C=(new Date).getTime();this._shifting_dx=0,this._shifting_dy=0,O(this,!1),(0,z.Lt)(window).on("touchmove.singleTouch",x?null:L=>this.moveTouchHandling(L,x,_[0])).on("touchcancel.singleTouch",L=>this.endSingleTouchHandling(L,x,_[0],C)).on("touchend.singleTouch",L=>this.endSingleTouchHandling(L,x,_[0],C))},moveTouchHandling(x,v,_){const C=this.getFrameSvg(),L=this.draw_g.selectChild(".main_layer");let F;try{F=ce(x,C.node())[0]}catch{F=[0,0],x?.changedTouches&&(F=[x.changedTouches[0].clientX,x.changedTouches[0].clientY])}const U=_[0]-F[0],j=1===this.scales_ndim?0:_[1]-F[1],te=this.getFrameWidth(),N=this.getFrameHeight();this._shifting_dx=U,this._shifting_dy=j,L.attr("viewBox",`${U} ${j} ${te} ${N}`)},endSingleTouchHandling(x,v,_,C){x?.preventDefault(),x?.stopPropagation(),O(this,!0),(0,z.Lt)(window).on("touchmove.singleTouch",null).on("touchcancel.singleTouch",null).on("touchend.singleTouch",null),null!==x&&(Math.abs(this._shifting_dx)>2||Math.abs(this._shifting_dy)>2?this.performScalesShift():(new Date).getTime()-C>700&&this.showContextMenu(v,{x:_[0],y:_[1]}))},clearInteractiveElements(){(0,ot.IV)(),this.zoom_kind=0,this.zoom_rect?.remove(),delete this.zoom_rect,delete this.zoom_curr,delete this.zoom_origin,delete this.zoom_lastpos,delete this.zoom_labels,O(this,!0)},assign(x){Object.assign(x,this)}};class P extends xe.JW{constructor(v,_){super(v,_&&_.$dummy?null:_),this.zoom_kind=0,this.mode3d=!1,this.shrink_frame_left=0,this.xmin=this.xmax=0,this.ymin=this.ymax=0,this.ranges_set=!1,this.axes_drawn=!1,this.keys_handler=null,this.projection=0}getFramePainter(){return this}is_root6(){return!0}getObject(v){return"xaxis"===v?this.xaxis:"yaxis"===v?this.yaxis:super.getObject()}setFrameActive(v){this.enabledKeys=v&&b.settings.HandleKeys,this.control&&(this.control.enableKeys=this.enabledKeys)}shrinkFrame(v,_){this.fX1NDC+=v,this.fX2NDC-=_}setLastEventPos(v){this.fLastEventPnt=v}getLastEventPos(){return this.fLastEventPnt}getProjectionFunc(){return ie(this.projection)}recalculateRange(v,_,C){this.projection=v||0,2===this.projection&&(this.scale_ymin<=-90||this.scale_ymax>=90)&&(console.warn(`Mercator Projection: Latitude out of range ${this.scale_ymin} ${this.scale_ymax}`),this.projection=0);const L=this.getProjectionFunc();if(!L)return;const F=[L(this.scale_xmin,this.scale_ymin),L(this.scale_xmin,this.scale_ymax),L(this.scale_xmax,this.scale_ymax),L(this.scale_xmax,this.scale_ymin)];this.scale_xmin<0&&this.scale_xmax>0&&(F.push(L(0,this.scale_ymin)),F.push(L(0,this.scale_ymax))),this.scale_ymin<0&&this.scale_ymax>0&&(F.push(L(this.scale_xmin,0)),F.push(L(this.scale_xmax,0))),this.original_xmin=this.scale_xmin,this.original_xmax=this.scale_xmax,this.original_ymin=this.scale_ymin,this.original_ymax=this.scale_ymax,_&&(this.scale_xmin=this.scale_xmax=F[0].x),C&&(this.scale_ymin=this.scale_ymax=F[0].y);for(let U=1;U<F.length;++U)_&&(this.scale_xmin=Math.min(this.scale_xmin,F[U].x),this.scale_xmax=Math.max(this.scale_xmax,F[U].x)),C&&(this.scale_ymin=Math.min(this.scale_ymin,F[U].y),this.scale_ymax=Math.max(this.scale_ymax,F[U].y))}setAxesRanges(v,_,C,L,F,U,j,te,N,m){if(this.ranges_set=!0,this.xaxis=v,this.xmin=_,this.xmax=C,this.yaxis=L,this.ymin=F,this.ymax=U,this.zaxis=j,this.zmin=te,this.zmax=N,m?.check_pad_range){delete m.check_pad_range;const I=m.getDimension();this.applyAxisZoom("x"),I>1&&this.applyAxisZoom("y"),I>2&&this.applyAxisZoom("z")}m&&!m._checked_zooming&&(m._checked_zooming=!0,m.options.minimum!==b.kNoZoom&&(this.zoom_zmin=m.options.minimum,this.zoom_zmax=this.zmax),m.options.maximum!==b.kNoZoom&&(this.zoom_zmax=m.options.maximum,void 0===this.zoom_zmin&&(this.zoom_zmin=this.zmin)))}setAxes2Ranges(v,_,C,L,F,U,j,te){v&&(this.x2axis=_,this.x2min=C,this.x2max=L),F&&(this.y2axis=U,this.y2min=j,this.y2max=te)}getAxis(v){switch(v){case"x":return this.xaxis;case"y":return this.yaxis;case"z":return this.zaxis;case"x2":return this.x2axis;case"y2":return this.y2axis}return null}applyPadUserRange(v,_){if(!v)return;let C=v[`fU${_}min`],L=v[`fU${_}max`],F=1e-7;if("x"===_){if(Math.abs(v.fX1)>F||Math.abs(v.fX2-1)>F){const N=v.fX2-v.fX1;C=v.fX1+N*v.fLeftMargin,L=v.fX2-N*v.fRightMargin}}else if(Math.abs(v.fY1)>F||Math.abs(v.fY2-1)>F){const N=v.fY2-v.fY1;C=v.fY1+N*v.fBottomMargin,L=v.fY2-N*v.fTopMargin}if(C>=L||Math.abs(C)<F&&Math.abs(L-1)<F)return;v[`fLog${_}`]>0&&(C=Math.exp(C*Math.log(10)),L=Math.exp(L*Math.log(10)));let U=_;this.swap_xy&&(U="x"===_?"y":"x");const j=this[`scale_${U}min`],te=this[`scale_${U}max`];F=1e-7*(te-j),(Math.abs(C-j)>F||Math.abs(L-te)>F)&&(this[`zoom_${U}min`]=C,this[`zoom_${U}max`]=L)}applyAxisZoom(v){if(this.zoomChangedInteractive(v))return;this[`zoom_${v}min`]=this[`zoom_${v}max`]=0;const _=this.getAxis(v);_?.TestBit(xe.rb.kAxisRange)&&_.fFirst!==_.fLast&&(_.fFirst>1||_.fLast<_.fNbins)&&(this[`zoom_${v}min`]=_.fFirst>1?_.GetBinLowEdge(_.fFirst):_.fXmin,this[`zoom_${v}max`]=_.fLast<_.fNbins?_.GetBinLowEdge(_.fLast+1):_.fXmax,_.InvertBit(xe.rb.kAxisRange),_.fFirst=1,_.fLast=_.fNbins)}createXY(v){this.cleanXY(),v||(v={ndim:1}),this.swap_xy=v.swap_xy||!1,this.reverse_x=v.reverse_x||!1,this.reverse_y=v.reverse_y||!1,this.logx=this.logy=0;const _=this.getFrameWidth(),C=this.getFrameHeight(),F=this.getPadPainter().getRootPad(),U=F.fLogx,j=(1===v.ndim?F.fLogv:void 0)??F.fLogy;this.scales_ndim=v.ndim,this.scale_xmin=this.xmin,this.scale_xmax=this.xmax,this.scale_ymin=this.ymin,this.scale_ymax=this.ymax,v.extra_y_space&&((this.swap_xy?U:j)&&this.scale_ymax>0?this.scale_ymax=Math.exp(1.1*Math.log(this.scale_ymax)):this.scale_ymax+=.1*(this.scale_ymax-this.scale_ymin)),v.check_pad_range&&(this.applyAxisZoom("x"),v.ndim>1&&this.applyAxisZoom("y"),v.ndim>2&&this.applyAxisZoom("z"),"pad_range"===v.check_pad_range&&(this.applyPadUserRange(F,"x"),this.applyPadUserRange(F,"y"))),v.zoom_xmin!==v.zoom_xmax&&(this.zoom_xmin===this.zoom_xmax||!this.zoomChangedInteractive("x"))&&(this.zoom_xmin=v.zoom_xmin,this.zoom_xmax=v.zoom_xmax),v.zoom_ymin!==v.zoom_ymax&&(this.zoom_ymin===this.zoom_ymax||!this.zoomChangedInteractive("y"))&&(this.zoom_ymin=v.zoom_ymin,this.zoom_ymax=v.zoom_ymax);let te=!0,N=!0;this.zoom_xmin!==this.zoom_xmax&&(this.scale_xmin=this.zoom_xmin,this.scale_xmax=this.zoom_xmax,te=!1),this.zoom_ymin!==this.zoom_ymax&&(this.scale_ymin=this.zoom_ymin,this.scale_ymax=this.zoom_ymax,N=!1),this.recalculateRange(v.Proj,te,N),this.x_handle=new Je.TB(this.getDom(),this.xaxis,!0),this.x_handle.setPadName(this.getPadName()),this.x_handle.setHistPainter(v.hist_painter,"x"),this.x_handle.configureAxis("xaxis",this.xmin,this.xmax,this.scale_xmin,this.scale_xmax,this.swap_xy,this.swap_xy?[0,C]:[0,_],{reverse:this.reverse_x,log:this.swap_xy?j:U,noexp_changed:this.x_noexp_changed,symlog:this.swap_xy?v.symlog_y:v.symlog_x,logcheckmin:this.swap_xy,logminfactor:1e-4}),this.x_handle.assignFrameMembers(this,"x"),this.y_handle=new Je.TB(this.getDom(),this.yaxis,!0),this.y_handle.setPadName(this.getPadName()),this.y_handle.setHistPainter(v.hist_painter,"y"),this.y_handle.configureAxis("yaxis",this.ymin,this.ymax,this.scale_ymin,this.scale_ymax,!this.swap_xy,this.swap_xy?[0,_]:[0,C],{reverse:this.reverse_y,log:this.swap_xy?U:j,noexp_changed:this.y_noexp_changed,symlog:this.swap_xy?v.symlog_x:v.symlog_y,logcheckmin:v.ndim<2||this.swap_xy,log_min_nz:v.ymin_nz&&v.ymin_nz<=this.ymax?.5*v.ymin_nz:0,logminfactor:Ie}),this.y_handle.assignFrameMembers(this,"y"),this.setRootPadRange(F)}createXY2(v){v||(v={ndim:this.scales_ndim??1}),this.reverse_x2=v.reverse_x||!1,this.reverse_y2=v.reverse_y||!1,this.logx2=this.logy2=0;const _=this.getFrameWidth(),C=this.getFrameHeight(),F=this.getPadPainter().getRootPad();v.second_x&&(this.scale_x2min=this.x2min,this.scale_x2max=this.x2max),v.second_y&&(this.scale_y2min=this.y2min,this.scale_y2max=this.y2max),v.extra_y_space&&v.second_y&&((this.swap_xy?F.fLogx:F.fLogy)&&this.scale_y2max>0?this.scale_y2max=Math.exp(1.1*Math.log(this.scale_y2max)):this.scale_y2max+=.1*(this.scale_y2max-this.scale_y2min)),this.zoom_x2min!==this.zoom_x2max&&v.second_x&&(this.scale_x2min=this.zoom_x2min,this.scale_x2max=this.zoom_x2max),this.zoom_y2min!==this.zoom_y2max&&v.second_y&&(this.scale_y2min=this.zoom_y2min,this.scale_y2max=this.zoom_y2max),v.second_x&&(this.x2_handle=new Je.TB(this.getDom(),this.x2axis,!0),this.x2_handle.setPadName(this.getPadName()),this.x2_handle.setHistPainter(v.hist_painter,"x"),this.x2_handle.configureAxis("x2axis",this.x2min,this.x2max,this.scale_x2min,this.scale_x2max,this.swap_xy,this.swap_xy?[0,C]:[0,_],{reverse:this.reverse_x2,log:this.swap_xy?F.fLogy:F.fLogx,noexp_changed:this.x2_noexp_changed,logcheckmin:this.swap_xy,logminfactor:1e-4}),this.x2_handle.assignFrameMembers(this,"x2")),v.second_y&&(this.y2_handle=new Je.TB(this.getDom(),this.y2axis,!0),this.y2_handle.setPadName(this.getPadName()),this.y2_handle.setHistPainter(v.hist_painter,"y"),this.y2_handle.configureAxis("y2axis",this.y2min,this.y2max,this.scale_y2min,this.scale_y2max,!this.swap_xy,this.swap_xy?[0,_]:[0,C],{reverse:this.reverse_y2,log:this.swap_xy?F.fLogx:F.fLogy,noexp_changed:this.y2_noexp_changed,logcheckmin:v.ndim<2||this.swap_xy,log_min_nz:v.ymin_nz&&v.ymin_nz<this.y2max?.5*v.ymin_nz:0,logminfactor:Ie}),this.y2_handle.assignFrameMembers(this,"y2"))}getGrFuncs(v,_){const C=v&&this.grx2,L=_&&this.gry2;return C||L?{use_x2:C,grx:C?this.grx2:this.grx,logx:this.logx,x_handle:C?this.x2_handle:this.x_handle,scale_xmin:C?this.scale_x2min:this.scale_xmin,scale_xmax:C?this.scale_x2max:this.scale_xmax,use_y2:L,gry:L?this.gry2:this.gry,logy:this.logy,y_handle:L?this.y2_handle:this.y_handle,scale_ymin:L?this.scale_y2min:this.scale_ymin,scale_ymax:L?this.scale_y2max:this.scale_ymax,swap_xy:this.swap_xy,fp:this,revertAxis(F,U){return"x"===F&&this.use_x2&&(F="x2"),"y"===F&&this.use_y2&&(F="y2"),this.fp.revertAxis(F,U)},axisAsText(F,U){return"x"===F&&this.use_x2&&(F="x2"),"y"===F&&this.use_y2&&(F="y2"),this.fp.axisAsText(F,U)}}:this}setRootPadRange(v,_){if(!v||!this.ranges_set)return;_?(v.fUxmin=v.fUymin=-.9,v.fUxmax=v.fUymax=.9):(v.fLogx=this.swap_xy?this.logy:this.logx,v.fUxmin=v.fLogx?Math.log10(this.scale_xmin):this.scale_xmin,v.fUxmax=v.fLogx?Math.log10(this.scale_xmax):this.scale_xmax,v.fLogy=this.swap_xy?this.logx:this.logy,v.fUymin=v.fLogy?Math.log10(this.scale_ymin):this.scale_ymin,v.fUymax=v.fLogy?Math.log10(this.scale_ymax):this.scale_ymax);const C=v.fUxmax-v.fUxmin,L=v.fUymax-v.fUymin;let F=1-v.fLeftMargin-v.fRightMargin,U=1-v.fBottomMargin-v.fTopMargin;F<=0&&(F=.01),U<=0&&(U=.01),v.fX1=v.fUxmin-C/F*v.fLeftMargin,v.fX2=v.fUxmax+C/F*v.fRightMargin,v.fY1=v.fUymin-L/U*v.fBottomMargin,v.fY2=v.fUymax+L/U*v.fTopMargin}drawGrids(v){const _=this.getFrameSvg().selectChild(".axis_layer");_.selectAll(".xgrid").remove(),_.selectAll(".ygrid").remove();const C=this.getPadPainter(),L=C?.getRootPad(!0),F=this.getFrameHeight(),U=this.getFrameWidth(),j=b.gStyle.fGridStyle;if(L?.fGridx&&v&&this.x_handle?.ticks){const te=b.gStyle.fGridColor>0?b.gStyle.fGridColor:this.getAxis("x")?.fAxisColor??1;let N="";this.x_handle.ticks.forEach(m=>{N+=this.swap_xy?`M0,${m}h${U}`:`M${m},0v${F}`}),_.append("svg:path").attr("class","xgrid").attr("d",N).style("stroke",this.getColor(te)||"black").style("stroke-width",b.gStyle.fGridWidth).style("stroke-dasharray",(0,et.Ov)(j))}if(L?.fGridy&&v&&this.y_handle?.ticks){const te=b.gStyle.fGridColor>0?b.gStyle.fGridColor:this.getAxis("y")?.fAxisColor??1;let N="";this.y_handle.ticks.forEach(m=>{N+=this.swap_xy?`M${m},0v${F}`:`M0,${m}h${U}`}),_.append("svg:path").attr("class","ygrid").attr("d",N).style("stroke",this.getColor(te)||"black").style("stroke-width",b.gStyle.fGridWidth).style("stroke-dasharray",(0,et.Ov)(j))}}axisAsText(v,_){const C=this[`${v}_handle`];return C?C.axisAsText(_,b.settings[v.toUpperCase()+"ValuesFormat"]):_.toPrecision(4)}hasDrawnAxes(v,_){return!v&&!_&&this.axes_drawn}drawAxes(v,_,C,L,F,U,j){var te=this;return(0,ve.A)(function*(){if(te.cleanAxesDrawings(),te.xmin===te.xmax||te.ymin===te.ymax)return!1;void 0===L&&(L=0);const N=te.getFrameSvg().selectChild(".axis_layer"),m=te.getFrameWidth(),I=te.getFrameHeight(),A=te.getPadPainter(),R=A.getRootPad(!0),k=j&&(R?.fGridx||R?.fGridy);te.x_handle.invert_side=L>=10,te.x_handle.lbls_both_sides=!te.x_handle.invert_side&&R?.fTickx>1,te.x_handle.has_obstacle=F,te.y_handle.invert_side=L%10==1,te.y_handle.lbls_both_sides=!te.y_handle.invert_side&&R?.fTicky>1,te.y_handle.has_obstacle=U;const J=te.swap_xy?te.y_handle:te.x_handle,_e=te.swap_xy?te.x_handle:te.y_handle;(!_||!C)&&A._fast_drawing&&(_=C=!0);let be=Promise.resolve(!0);if(!_||!C||k){const Te=!v&&b.settings.CanAdjustFrame,Pe=J.drawAxis(N,m,I,J.invert_side?null:`translate(0,${I})`,R?.fTickx?-I:0,_,void 0,!1,A.getPadHeight()-I-te.getFrameY()),We=_e.drawAxis(N,m,I,_e.invert_side?`translate(${m})`:null,R?.fTicky?m:0,C,_e.invert_side?0:te._frame_x,Te);be=Promise.all([Pe,We]).then(()=>{if(te.drawGrids(k),!Te)return;let dt=0;const Q=_e.position;return-.2*m<Q&&Q<0?(dt=-Q/m+.001,te.shrink_frame_left+=dt):Q>0&&Q<.3*m&&te.shrink_frame_left>0&&Q/m>te.shrink_frame_left&&(dt=-te.shrink_frame_left,te.shrink_frame_left=0),dt?(te.shrinkFrame(dt,0),te.redraw().then(()=>te.drawAxes(!0))):void 0})}return be.then(()=>(v||(te.axes_drawn=!0),!0))})()}drawAxes2(v,_){const C=this.getFrameSvg().selectChild(".axis_layer"),L=this.getFrameWidth(),F=this.getFrameHeight(),U=this.getPadPainter(),j=U.getRootPad(!0);v&&(this.x2_handle.invert_side=!0,this.x2_handle.lbls_both_sides=!1,this.x2_handle.has_obstacle=!1),_&&(this.y2_handle.invert_side=!0,this.y2_handle.lbls_both_sides=!1);let m,I,te=this.swap_xy?this.y2_handle:this.x2_handle,N=this.swap_xy?this.x2_handle:this.y2_handle;return(te||N)&&U._fast_drawing&&(te=N=null),te&&(m=te.drawAxis(C,L,F,te.invert_side?null:`translate(0,${F})`,j?.fTickx?-F:0,!1,void 0,!1)),N&&(I=N.drawAxis(C,L,F,N.invert_side?`translate(${L})`:null,j?.fTicky?L:0,!1,N.invert_side?0:this._frame_x,!1)),Promise.all([m,I])}updateAttributes(v){const _=this.getPadPainter(),C=_?.getRootPad(!0),L=this.getObject();(void 0===this.fX1NDC||v&&!this.modified_NDC)&&(C?(this.fX1NDC=C.fLeftMargin,this.fX2NDC=1-C.fRightMargin,this.fY1NDC=C.fBottomMargin,this.fY2NDC=1-C.fTopMargin):(this.fX1NDC=b.gStyle.fPadLeftMargin,this.fX2NDC=1-b.gStyle.fPadRightMargin,this.fY1NDC=b.gStyle.fPadBottomMargin,this.fY2NDC=1-b.gStyle.fPadTopMargin)),void 0===this.fillatt&&(this.createAttFill(L?{attr:L}:C?.fFrameFillColor?{pattern:C.fFrameFillStyle,color:C.fFrameFillColor}:C?{attr:C}:{pattern:1001,color:0}),!L&&this.fillatt.empty()&&_?.iscan?this.fillatt.setSolidColor("white"):4e3===C?.fFillStyle&&!this.fillatt.empty()&&this.fillatt.setOpacity(0)),this.createAttLine(L||void 0===C?.fFrameLineColor?{attr:L,color:"black"}:{color:C.fFrameLineColor,width:C.fFrameLineWidth,style:C.fFrameLineStyle})}sizeChanged(){const v=this.getPadPainter()?.getRootPad(!0);v&&(v.fLeftMargin=this.fX1NDC,v.fRightMargin=1-this.fX2NDC,v.fBottomMargin=this.fY1NDC,v.fTopMargin=1-this.fY2NDC,this.setRootPadRange(v)),this.interactiveRedraw("pad","frame")}cleanXY(){delete this.grx,delete this.gry,delete this.grz,delete this.grx2,delete this.gry2,this.x_handle?.cleanup(),this.y_handle?.cleanup(),this.z_handle?.cleanup(),this.x2_handle?.cleanup(),this.y2_handle?.cleanup(),delete this.x_handle,delete this.y_handle,delete this.z_handle,delete this.x2_handle,delete this.y2_handle}cleanAxesDrawings(){this.x_handle?.removeG(),this.y_handle?.removeG(),this.z_handle?.removeG(),this.x2_handle?.removeG(),this.y2_handle?.removeG(),this.draw_g?.selectChild(".axis_layer").selectAll("*").remove(),this.axes_drawn=!1}cleanFrameDrawings(){(0,b.isFunc)(this.create3DScene)&&this.create3DScene(-1),this.cleanAxesDrawings(),this.cleanXY(),this.ranges_set=!1,this.xmin=this.xmax=0,this.ymin=this.ymax=0,this.zmin=this.zmax=0,this.zoom_xmin=this.zoom_xmax=0,this.zoom_ymin=this.zoom_ymax=0,this.zoom_zmin=this.zoom_zmax=0,this.scale_xmin=this.scale_xmax=0,this.scale_ymin=this.scale_ymax=0,this.scale_zmin=this.scale_zmax=0,this.draw_g?.selectChild(".main_layer").selectAll("*").remove(),this.draw_g?.selectChild(".upper_layer").selectAll("*").remove(),this.xaxis=null,this.yaxis=null,this.zaxis=null,this.draw_g&&(this.draw_g.selectAll("*").remove(),this.draw_g.on("mousedown",null).on("dblclick",null).on("wheel",null).on("contextmenu",null).property("interactive_set",null),this.draw_g.remove()),delete this.draw_g,this.keys_handler&&(window.removeEventListener("keydown",this.keys_handler,!1),this.keys_handler=null)}cleanup(){this.cleanFrameDrawings(),delete this._click_handler,delete this._dblclick_handler,delete this.enabledKeys;const v=this.getPadPainter();v?.frame_painter_ref===this&&delete v.frame_painter_ref,super.cleanup()}redraw(){const v=this.getPadPainter();v&&(v.frame_painter_ref=this),this.updateAttributes();const _=v?.getPadRect()??{width:10,height:10},C=Math.round(_.width*this.fX1NDC),L=Math.round(_.height*(1-this.fY2NDC));let N,m,I,F=Math.round(_.width*(this.fX2NDC-this.fX1NDC)),U=Math.round(_.height*(this.fY2NDC-this.fY1NDC)),j=!1,te=!1;return v?.options&&(v.options.RotateFrame&&(j=!0),v.options.FixFrame&&(te=!0)),j?(N=`rotate(-90,${C},${L}) translate(${C-U},${L})`,[F,U]=[U,F]):N=(0,ke.bk)(C,L),this._frame_x=C,this._frame_y=L,this._frame_width=F,this._frame_height=U,this._frame_rotate=j,this._frame_fixpos=te,this.mode3d||(this.draw_g=this.getFrameSvg(),this.draw_g.empty()?(this.draw_g=this.getLayerSvg("primitives_layer").append("svg:g").attr("class","root_frame"),this.isBatchMode()||this.draw_g.append("svg:title").text(""),m=this.draw_g.append("svg:path"),I=this.draw_g.append("svg:svg").attr("class","main_layer").attr("x",0).attr("y",0).attr("overflow","hidden"),this.draw_g.append("svg:g").attr("class","axis_layer"),this.draw_g.append("svg:g").attr("class","upper_layer")):(m=this.draw_g.selectChild("path"),I=this.draw_g.selectChild(".main_layer")),this.axes_drawn=!1,this.draw_g.attr("transform",N),m.attr("d",`M0,0H${F}V${U}H0Z`).call(this.fillatt.func).call(this.lineatt.func),I.attr("width",F).attr("height",U).attr("viewBox",`0 0 ${F} ${U}`)),this}changeAxisLog(v,_){const C=this.getPadPainter(),L=C?.getRootPad(!0);if(!L)return;C._interactively_changed=!0;const F=`fLog${v}`;return L[F]||(this.swap_xy&&"x"===v?v="y":this.swap_xy&&"y"===v&&(v="x"),this[`${v}_handle`]?.kind!==xe.ei)?(("toggle"===_||void 0===_)&&(_=L[F]?0:1),L[F]=_,this.interactiveRedraw("pad",`log${v}`)):void 0}toggleAxisLog(v){return this.changeAxisLog(v,"toggle")}fillContextMenu(v,_,C){const L=this.getMainPainter(!0),F=this.getPadPainter(),U=F?.getRootPad(!0),j="pal"===_;if(j&&(_="z"),"x"===_||"y"===_||"z"===_||"x2"===_||"y2"===_){const N=C||this[_+"axis"],m=this[`${_}_handle`];if(!(0,b.isFunc)(N?.TestBit))return!1;if(v.add(`header: ${_.toUpperCase()} axis`),v.add("Unzoom",()=>this.unzoom(_)),U){const I="fLog"+_[0];v.add("sub:SetLog "+_[0],()=>{v.input("Enter log kind: 0 - off, 1 - log10, 2 - log2, 3 - ln, ...",U[I],"int",0,1e4).then(A=>{this.changeAxisLog(_[0],A)})}),v.addchk(0===U[I],"linear",()=>this.changeAxisLog(_[0],0)),v.addchk(1===U[I],"log10",()=>this.changeAxisLog(_[0],1)),v.addchk(2===U[I],"log2",()=>this.changeAxisLog(_[0],2)),v.addchk(3===U[I],"ln",()=>this.changeAxisLog(_[0],3)),v.addchk(4===U[I],"log4",()=>this.changeAxisLog(_[0],4)),v.addchk(8===U[I],"log8",()=>this.changeAxisLog(_[0],8)),v.add("endsub:")}return v.addchk(N.TestBit(xe.rb.kMoreLogLabels),"More log",I=>{N.InvertBit(xe.rb.kMoreLogLabels),L?.snapid&&1===_.length?L.interactiveRedraw("pad",`exec:SetMoreLogLabels(${I})`,_):this.interactiveRedraw("pad")}),v.addchk(m?.noexp??N.TestBit(xe.rb.kNoExponent),"No exponent",I=>{I!==N.TestBit(xe.rb.kNoExponent)&&N.InvertBit(xe.rb.kNoExponent),m&&(m.noexp_changed=!0),this[`${_}_noexp_changed`]=!0,L?.snapid&&1===_.length?L.interactiveRedraw("pad",`exec:SetNoExponent(${I})`,_):this.interactiveRedraw("pad")}),"z"===_&&(0,b.isFunc)(L?.fillPaletteMenu)&&L.fillPaletteMenu(v,!j),m?.kind===xe.ei&&N.fNbins>20&&v.add("Find label",()=>v.input("Label id").then(I=>{if(I)for(let A=0;A<N.fNbins;++A)if(m.formatLabels(A)===I)return this.zoom(_,Math.max(0,A-4),Math.min(N.fNbins,A+5))})),v.addTAxisMenu(xe.rb,L||this,N,_),!0}const te=0===v.size();return v.add(te?"header:Frame":"separator"),this.zoom_xmin!==this.zoom_xmax&&v.add("Unzoom X",()=>this.unzoom("x")),this.zoom_ymin!==this.zoom_ymax&&v.add("Unzoom Y",()=>this.unzoom("y")),this.zoom_zmin!==this.zoom_zmax&&v.add("Unzoom Z",()=>this.unzoom("z")),this.zoom_x2min!==this.zoom_x2max&&v.add("Unzoom X2",()=>this.unzoom("x2")),this.zoom_y2min!==this.zoom_y2max&&v.add("Unzoom Y2",()=>this.unzoom("y2")),v.add("Unzoom all",()=>this.unzoom("all")),U&&(v.addchk(U.fLogx,"SetLogx",()=>this.toggleAxisLog("x")),v.addchk(U.fLogy,"SetLogy",()=>this.toggleAxisLog("y")),(0,b.isFunc)(L?.getDimension)&&L.getDimension()>1&&v.addchk(U.fLogz,"SetLogz",()=>this.toggleAxisLog("z")),v.add("separator")),v.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),v.addAttributesMenu(this,te?"":"Frame "),v.add("Save to gStyle",()=>{b.gStyle.fPadBottomMargin=this.fY1NDC,b.gStyle.fPadTopMargin=1-this.fY2NDC,b.gStyle.fPadLeftMargin=this.fX1NDC,b.gStyle.fPadRightMargin=1-this.fX2NDC,this.fillatt?.saveToStyle("fFrameFillColor","fFrameFillStyle"),this.lineatt?.saveToStyle("fFrameLineColor","fFrameLineWidth","fFrameLineStyle")},"Store frame position and graphical attributes to gStyle"),v.add("separator"),v.add("sub:Save as"),["svg","png","jpeg","pdf","webp"].forEach(N=>v.add(`frame.${N}`,()=>F.saveAs(N,"frame",`frame.${N}`))),v.add("endsub:"),!0}fillWebObjectOptions(v){v.fcust="frame",v.fopt=[this.scale_xmin||0,this.scale_ymin||0,this.scale_xmax||0,this.scale_ymax||0]}getFrameX(){return this._frame_x||0}getFrameY(){return this._frame_y||0}getFrameWidth(){return this._frame_width||0}getFrameHeight(){return this._frame_height||0}getFrameRect(){return{x:this._frame_x||0,y:this._frame_y||0,width:this.getFrameWidth(),height:this.getFrameHeight(),transform:this.draw_g?.attr("transform")||"",hint_delta_x:0,hint_delta_y:0}}configureUserClickHandler(v){this._click_handler=(0,b.isFunc)(v)?v:null}configureUserDblclickHandler(v){this._dblclick_handler=(0,b.isFunc)(v)?v:null}zoom(v,_,C,L,F,U){var j=this;return(0,ve.A)(function*(){"x"===v?(v=_,_=C,C=void 0):"y"===v?(L=C,C=_,v=_=void 0):"z"===v&&(F=_,U=C,v=_=C=void 0);let te=v!==_,N=C!==L,m=F!==U,I=!1,A=!1,R=!1;if(te){let J=0;v<=j.xmin&&(v=j.xmin,J++),_>=j.xmax&&(_=j.xmax,J++),2===J&&(te=!1,I=!0)}else I=v===_&&0===v;if(N){let J=0;(C<=j.ymin||!j.ymin&&j.logy&&(!j.y_handle?.log_min_nz&&C<Ie*j.ymax||C<j.y_handle?.log_min_nz))&&(C=j.ymin,J++),L>=j.ymax&&(L=j.ymax,J++),2===J&&1!==j.scales_ndim&&(N=!1,A=!0)}else A=C===L&&0===C;if(m){let J=0;F<=j.zmin&&(F=j.zmin,J++),U>=j.zmax&&(U=j.zmax,J++),2===J&&j.scales_ndim>2&&(m=!1,R=!0)}else R=F===U&&0===F;let k=!1;return(te||N||m)&&j.forEachPainter(J=>{(0,b.isFunc)(J.canZoomInside)&&(te&&J.canZoomInside("x",v,_)&&(j.zoom_xmin=v,j.zoom_xmax=_,k=!0,te=!1),N&&J.canZoomInside("y",C,L)&&(j.zoom_ymin=C,j.zoom_ymax=L,k=!0,N=!1),m&&J.canZoomInside("z",F,U)&&(j.zoom_zmin=F,j.zoom_zmax=U,k=!0,m=!1))}),(I||A||R)&&(I&&(j.zoom_xmin!==j.zoom_xmax&&(k=!0),j.zoom_xmin=j.zoom_xmax=0),A&&(j.zoom_ymin!==j.zoom_ymax&&(k=!0,he(j.getMainPainter())),j.zoom_ymin=j.zoom_ymax=0),R&&(j.zoom_zmin!==j.zoom_zmax&&(k=!0),j.zoom_zmin=j.zoom_zmax=0),k||j.getPadPainter()?.painters?.forEach(J=>{(0,b.isFunc)(J?.unzoomUserRange)&&J.unzoomUserRange(I,A,R)&&(k=!0)})),!!k&&j.interactiveRedraw("pad","zoom").then(()=>!0)})()}zoomSingle(v,_,C){var L=this;return(0,ve.A)(function*(){if(!L[v+"_handle"])return!1;let F=_!==C,U=!1;if(F){let te=0;_<=L[v+"min"]&&(_=L[v+"min"],te++),C>=L[v+"max"]&&(C=L[v+"max"],te++),2===te&&(F=!1,U=!0)}else U=_===C&&0===_;let j=!1;return F&&L.forEachPainter(te=>{(0,b.isFunc)(te.canZoomInside)&&F&&te.canZoomInside(v[0],_,C)&&(L[`zoom_${v}min`]=_,L[`zoom_${v}max`]=C,j=!0,F=!1)}),U&&(L[`zoom_${v}min`]!==L[`zoom_${v}max`]&&(j=!0,"y"===v&&he(L.getMainPainter())),L[`zoom_${v}min`]=L[`zoom_${v}max`]=0),!!j&&L.interactiveRedraw("pad","zoom").then(()=>!0)})()}isAxisZoomed(v){return this[`zoom_${v}min`]!==this[`zoom_${v}max`]}unzoom(v,_,C){var L=this;return(0,ve.A)(function*(){return"all"===v?L.unzoom("x2").then(()=>L.unzoom("y2")).then(()=>L.unzoom("xyz")):"x2"===v||"y2"===v?L.zoomSingle(v,0,0).then(F=>(F&&L.zoomChangedInteractive(v,"unzoom"),F)):(typeof v>"u"?v=_=C=!0:(0,b.isStr)(v)&&(C=v.indexOf("z")>=0,_=v.indexOf("y")>=0,v=v.indexOf("x")>=0),L.zoom(v?0:void 0,v?0:void 0,_?0:void 0,_?0:void 0,C?0:void 0,C?0:void 0).then(F=>(F&&v&&L.zoomChangedInteractive("x","unzoom"),F&&_&&L.zoomChangedInteractive("y","unzoom"),F&&C&&L.zoomChangedInteractive("z","unzoom"),F)))})()}zoomChangedInteractive(v,_){if("reset"===v)return void(this.zoom_changed_x=this.zoom_changed_y=this.zoom_changed_z=void 0);if(!v||"any"===v)return this.zoom_changed_x||this.zoom_changed_y||this.zoom_changed_z;if("x"!==v&&"y"!==v&&"z"!==v)return;const C="zoom_changed_"+v;if(void 0===_)return this[C];"unzoom"!==_?_&&(this[C]=!0):this[C]=void 0===this[C]}revertAxis(v,_){return this[`${v}_handle`]?.revertPoint(_)??0}showAxisStatus(v,_){const C=this.getAxis(v),L=(0,z.Wn)(_,this.getFrameSvg().node());let F=v,U=b.clTAxis,j="x"===v?0:1;C&&(F=C.fName,U=C.fTitle||`TAxis object for ${v}`),this.swap_xy&&(j=1-j);const te=this.revertAxis(v,L[j]);this.showObjectStatus(F,U,`${v} : ${this.axisAsText(v,te)}`,`${L[0]},${L[1]}`)}addKeysHandler(){this.isBatchMode()||(w.assign(this),this.addFrameKeysHandler())}addInteractivity(v){return!(this.isBatchMode()||!b.settings.Zooming&&!b.settings.ContextMenu)&&(w.assign(this),v||this.addBasicInteractivity(),this.addFrameInteractivity(v))}}},1e3:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{DR:()=>ue,O4:()=>le,cw:()=>O,jg:()=>Y});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(6823),xe=Ee(9041),et=Ee(6224),Je=Ee(8732),Xe=Ee(528),ot=Ee(4952),Re=Ee(6370),He=Ee(6714),Ie=Ee(5983);const O="TButton",ce=(0,b.BIT)(22);function ie(V,D){return Math.round((D||1)*(V.iscan||!V.has_canvas?16:12))}function he(V,D,w){w?.preventDefault(),w?.stopPropagation();const P=V.getLayerSvg("btns_layer",V.this_pad_name),x=P.select("[name='Toggle']");if(x.empty())return;let v=x.property("buttons_state");x.property("timout_handler")&&("timeout"!==D&&clearTimeout(x.property("timout_handler")),x.property("timout_handler",null));let _=!1;switch(D){case"enable":_=!0,V.btns_active_flag=!0;break;case"enterbtn":return void(V.btns_active_flag=!0);case"timeout":_=!1;break;case"toggle":v=!v,x.property("buttons_state",v),_=v;break;case"disable":case"leavebtn":return V.btns_active_flag=!1,void(v||x.property("timout_handler",setTimeout(()=>he(V,"timeout"),1200)))}P.selectAll("svg").each(function(){this!==x.node()&&(0,z.Lt)(this).style("display",_?"":"none")})}const ue={alignButtons(V,D,w){const P=ie(this,1.25),x=(V.property("nextx")||0)+P;let v,_;V.property("vertical")?(v=V.property("leftside")?2:D-P,_=w-x):(v=V.property("leftside")?2:D-x,_=w-P),(0,xe.bk)(V,v,_)},findPadButton(V){const D=this.getLayerSvg("btns_layer",this.this_pad_name);let w="";return D.empty()||D.selectAll("svg").each(function(){(0,z.Lt)(this).attr("key")===V&&(w=(0,z.Lt)(this).attr("name"))}),w},removePadButtons(){const V=this.getLayerSvg("btns_layer",this.this_pad_name);V.empty()||(V.selectAll("*").remove(),V.property("nextx",null))},showPadButtons(){const V=this.getLayerSvg("btns_layer",this.this_pad_name);if(V.empty()||(V.selectAll("*").remove(),!this._buttons))return;const D=this.iscan||!this.has_canvas;let P,x=V.property("leftside")?ie(this,1.25):0;if(this._fast_drawing)P=He.IK.createSVG(V,He.IK.circle,ie(this),"enlargePad",!1).attr("name","Enlarge").attr("x",0).attr("y",0).on("click",v=>this.clickPadButton("enlargePad",v));else{P=He.IK.createSVG(V,He.IK.rect,ie(this),"Toggle tool buttons",!1).attr("name","Toggle").attr("x",0).attr("y",0).property("buttons_state","popup"!==b.settings.ToolBar||b.browser.touches).on("click",v=>he(this,"toggle",v)),P.node()._mouseenter=()=>he(this,"enable"),P.node()._mouseleave=()=>he(this,"disable");for(let v=0;v<this._buttons.length;++v){const _=this._buttons[v];let C=_.btn;(0,b.isStr)(C)&&(C=He.IK[C]),C||(C=He.IK.circle);const L=He.IK.createSVG(V,C,ie(this),_.tooltip+(D?"":` on pad ${this.this_pad_name}`)+(_.keyname?` (keyshortcut ${_.keyname})`:""),!1);V.property("vertical")?L.attr("x",0).attr("y",x):L.attr("x",x).attr("y",0),L.attr("name",_.funcname).style("display",P.property("buttons_state")?"":"none").attr("key",_.keyname||null).on("click",F=>this.clickPadButton(_.funcname,F)),L.node()._mouseenter=()=>he(this,"enterbtn"),L.node()._mouseleave=()=>he(this,"leavebtn"),x+=ie(this,1.25)}}V.property("nextx",x),this.alignButtons(V,this.getPadWidth(),this.getPadHeight()),V.property("vertical")?P.attr("y",x):V.property("leftside")||P.attr("x",x)},assign(V){Object.assign(V,this)}};function le(V){if(!V?.snapid)return null;const D={_typename:"TWebObjectOptions",snapid:V.snapid.toString(),opt:V.getDrawOpt(!0),fcust:"",fopt:[]};return(0,b.isFunc)(V.fillWebObjectOptions)&&V.fillWebObjectOptions(D),D}class Y extends et.JW{constructor(D,w,P){super(D,w),this.pad=w,this.iscan=P,this.this_pad_name="",!this.iscan&&w?.fName&&(this.this_pad_name=w.fName.replace(" ","_"),(!/^[A-Za-z][A-Za-z0-9_]*$/.test(this.this_pad_name)||"button"===this.this_pad_name&&w._typename===O)&&(this.this_pad_name="jsroot_pad_"+b.internals.id_counter++)),this.painters=[],this.has_canvas=!0,this.forEachPainter=this.forEachPainterInPad;const x=this.selectDom();!x.empty()&&x.property("_batch_mode")&&(this.batch_mode=!0)}isBatchMode(){return void 0!==this.batch_mode?this.batch_mode:!!(0,b.isBatchMode)()||!(this.iscan||!this.has_canvas)&&this.getCanvPainter()?.isBatchMode()}isRoot6(){return!0}isEditable(){return this.pad?.fEditable??!0}svg_this_pad(){return this.getPadSvg(this.this_pad_name)}getMainPainter(){return this.main_painter_ref||null}setMainPainter(D,w){(!this.main_painter_ref||w)&&(this.main_painter_ref=D)}cleanup(){this._doing_draw&&console.error("pad drawing is not completed when cleanup is called"),this.painters.forEach(w=>w.cleanup());const D=this.svg_this_pad();D.empty()||(D.property("pad_painter",null),this.iscan||D.remove()),delete this.main_painter_ref,delete this.frame_painter_ref,delete this.pads_cache,delete this.custom_palette,delete this._pad_x,delete this._pad_y,delete this._pad_width,delete this._pad_height,delete this._doing_draw,delete this._interactively_changed,delete this._snap_primitives,delete this._last_grayscale,delete this._custom_colors,delete this._custom_palette_indexes,delete this._custom_palette_colors,delete this.root_colors,this.painters=[],this.pad=null,this.this_pad_name=void 0,this.has_canvas=!1,(0,et.QD)({pp:this,active:!1}),super.cleanup()}getFramePainter(){return this.frame_painter_ref}getPadWidth(){return this._pad_width||0}getPadHeight(){return this._pad_height||0}getPadRect(){return{x:this._pad_x||0,y:this._pad_y||0,width:this.getPadWidth(),height:this.getPadHeight()}}getPadLog(D){const w=this.getRootPad();return"x"===D?w?.fLogx:"y"===D&&(w?.fLogv??w?.fLogy)}getFrameRect(){const D=this.getFramePainter();if(D)return D.getFrameRect();const w=this.getPadWidth(),P=this.getPadHeight(),x={};return this.pad?(x.szx=Math.round(Math.max(0,.5-Math.max(this.pad.fLeftMargin,this.pad.fRightMargin))*w),x.szy=Math.round(Math.max(0,.5-Math.max(this.pad.fBottomMargin,this.pad.fTopMargin))*P)):(x.szx=Math.round(.5*w),x.szy=Math.round(.5*P)),x.width=2*x.szx,x.height=2*x.szy,x.x=Math.round(w/2-x.szx),x.y=Math.round(P/2-x.szy),x.hint_delta_x=x.szx,x.hint_delta_y=x.szy,x.transform=(0,xe.bk)(x.x,x.y)||"",x}getRootPad(D){return void 0===D||D?this.pad:null}cleanPrimitives(D){if((0,b.isFunc)(D))for(let w=this.painters.length-1;w>=0;--w)D(this.painters[w])&&(this.painters[w].cleanup(),this.painters.splice(w,1))}removePrimitive(D){const w=this.painters[D],P=[];let x=D;for(let v=this.painters.length-1;v>=0;--v)(v===D||this.painters[v].isSecondary(w))&&(P.push(this.painters[v]),this.painters.splice(v,1),v<=D&&x--);return P.forEach(v=>{v.cleanup(),this.main_painter_ref===v&&(delete this.main_painter_ref,x=-111)}),x}getCustomPalette(){return this.custom_palette||this.getCanvPainter()?.custom_palette}getNumPainters(){return this.painters.length}getAutoColor(D){D||(D=this._num_primitives||5),D<2&&(D=2);let w=this._auto_color??0;this._auto_color=(w+1)%D,w>=D&&(w=D-1);const P=this._custom_palette_indexes||this.getCanvPainter()?._custom_palette_indexes;if(P?.length)return P[Math.round(w*(P.length-3)/(D-1))];this._auto_palette||(this._auto_palette=(0,ke.jh)(b.settings.Palette,this.isGrayscale()));const x=Math.round(w*(this._auto_palette.getLength()-3)/(D-1)),v=this._auto_palette.getColor(x);return this.addColor(v)}forEachPainterInPad(D,w){w||(w="all"),"objects"!==w&&D(this);for(let P=0;P<this.painters.length;++P){const x=this.painters[P];(0,b.isFunc)(x.forEachPainterInPad)?"objects"!==w&&x.forEachPainterInPad(D,w):"pads"!==w&&D(x)}}registerForPadEvents(D){this.pad_events_receiver=D}producePadEvent(D,w,P,x,v){"select"===D&&(0,b.isFunc)(this.selectActivePad)&&this.selectActivePad(w,P,x),(0,b.isFunc)(this.pad_events_receiver)&&this.pad_events_receiver({what:D,padpainter:w,painter:P,position:x,place:v})}selectObjectPainter(D,w,P){const x=this.iscan||!this.has_canvas,v=x?this:this.getCanvPainter();void 0===D&&(D=this),w&&!x&&(w=(0,xe.md)(this.svg_this_pad(),w)),(0,et.QD)({pp:this,active:!0}),v?.producePadEvent("select",this,D,w,P)}drawActiveBorder(D,w){if(void 0!==w){if(this.is_active_pad===w)return;this.is_active_pad=w}if(void 0===this.is_active_pad)return;D||(D=this.iscan?this.getCanvSvg().selectChild(".canvas_fillrect"):this.svg_this_pad().selectChild(".root_pad_border"));const P=this.getCanvPainter();let x=this.is_active_pad&&P?.highlight_gpad?new Je.gx({style:1,width:1,color:"red"}):this.lineatt;x||(x=new Je.gx({color:"none"})),D.call(x.func)}setFastDrawing(D,w){const P=this._fast_drawing;this._fast_drawing=b.settings.SmallPad&&(D<b.settings.SmallPad.width||w<b.settings.SmallPad.height),P!==this._fast_drawing&&this.showPadButtons()}isGrayscale(){return!!this.iscan&&(this.pad?.TestBit(ce)??!1)}setGrayscale(D){if(!this.iscan)return;let w=!1;void 0===D?(D=this.pad?.TestBit(ce)??!1,w=void 0!==this._last_grayscale&&this._last_grayscale!==D):D!==this.pad?.TestBit(ce)&&(this.pad?.InvertBit(ce),w=!0),w&&this.forEachPainter(P=>{delete P._color_palette}),this.root_colors=D?(0,ke.uw)(this._custom_colors):this._custom_colors,this._last_grayscale=D,this.custom_palette=this._custom_palette_colors?new ke.rE(this._custom_palette_colors,D):null}createCanvasSvg(D,w){const P=this.isBatchMode();let L,F,U,v=null,_=null,C=null;if(D>0){if(this._fixed_size)return D>1;if(_=this.getCanvSvg(),_.empty()||(v=_.property("height_factor"),C=this.testMainResize(D,null,v),!C.changed&&1===D))return!1;P||(L=this.getLayerSvg("btns_layer",this.this_pad_name)),F=this.getLayerSvg("info_layer",this.this_pad_name),U=_.selectChild(".canvas_fillrect")}else{const N=this.selectDom();"static"===N.style("position")&&N.style("position","relative"),_=N.append("svg").attr("class","jsroot root_canvas").property("pad_painter",this).property("current_pad","").property("redraw_by_resize",!1),this.setTopPainter(),P?_.attr("xmlns","http://www.w3.org/2000/svg"):this.online_canvas||_.append("svg:title").text("ROOT canvas"),(!P||this.pad.fFillStyle>0)&&(U=_.append("svg:path").attr("class","canvas_fillrect")),P||U.style("pointer-events","visibleFill").on("dblclick",m=>this.enlargePad(m,!0)).on("click",()=>this.selectObjectPainter()).on("mouseenter",()=>this.showObjectStatus()).on("contextmenu",b.settings.ContextMenu?m=>this.padContextMenu(m):null),_.append("svg:g").attr("class","primitives_layer"),F=_.append("svg:g").attr("class","info_layer"),P||(L=_.append("svg:g").attr("class","btns_layer").property("leftside","left"===b.settings.ToolBarSide).property("vertical",b.settings.ToolBarVert)),v=.66,this.pad?.fCw&&this.pad?.fCh&&this.pad?.fCw>0&&(v=this.pad.fCh/this.pad.fCw,(v<.1||v>10)&&(v=.66)),this._fixed_size?(N.style("overflow","auto"),C={width:this.pad.fCw,height:this.pad.fCh},(!C.width||!C.height)&&(C=(0,xe.xh)(N))):C=this.testMainResize(2,w,v)}this.setGrayscale(),this.createAttFill({attr:this.pad}),C.width<=5||C.height<=5?(_.style("display","none"),console.warn(`Hide canvas while geometry too small w=${C.width} h=${C.height}`),this._pad_width&&this._pad_height?(C.width=this._pad_width,C.height=this._pad_height):(C.width=800,C.height=600)):_.style("display",null),_.attr("x",0).attr("y",0).style("position","absolute"),this._fixed_size?_.attr("width",C.width).attr("height",C.height):_.style("width","100%").style("height","100%").style("left",0).style("top",0).style("bottom",0).style("right",0),_.style("filter",b.settings.DarkMode||this.pad?.$dark?"invert(100%)":null),_.attr("viewBox",`0 0 ${C.width} ${C.height}`).attr("preserveAspectRatio","none").property("height_factor",v).property("draw_x",0).property("draw_y",0).property("draw_width",C.width).property("draw_height",C.height),this._pad_x=0,this._pad_y=0,this._pad_width=C.width,this._pad_height=C.height,U&&(U.attr("d",`M0,0H${C.width}V${C.height}H0Z`).call(this.fillatt.func),this.drawActiveBorder(U)),this.setFastDrawing(C.width*(1-this.pad.fLeftMargin-this.pad.fRightMargin),C.height*(1-this.pad.fBottomMargin-this.pad.fTopMargin)),this.alignButtons&&L&&this.alignButtons(L,C.width,C.height);let j=F.selectChild(".canvas_date");if(b.gStyle.fOptDate){j.empty()&&(j=F.append("text").attr("class","canvas_date"));const N=Math.round(C.height*(1-b.gStyle.fDateY)),m=new Date;let I=Math.round(C.width*b.gStyle.fDateX);!P&&I<25&&(I=25),b.gStyle.fOptDate>3&&m.setTime(1e3*b.gStyle.fOptDate),(0,xe.bk)(j,I,N).style("text-anchor","start").text((0,xe.ic)(m))}else j.remove();const te=this.getItemName();return te?this.drawItemNameOnCanvas(te):b.gStyle.fOptFile||F.selectChild(".canvas_item").remove(),!0}drawItemNameOnCanvas(D){const w=this.getLayerSvg("info_layer",this.this_pad_name);let P=w.selectChild(".canvas_item");const x=(0,Ie.gZ)().findRootFileForItem(D),v=3===b.gStyle.fOptFile?D:2===b.gStyle.fOptFile?x?._fullurl:x?._name;if(b.gStyle.fOptFile&&v){P.empty()&&(P=w.append("text").attr("class","canvas_item"));const _=this.getPadRect();(0,xe.bk)(P,Math.round(_.width*(1-b.gStyle.fDateX)),Math.round(_.height*(1-b.gStyle.fDateY))).style("text-anchor","end").text(v)}else P.remove();(2===b.gStyle.fOptDate||3===b.gStyle.fOptDate)&&x?._file&&w.selectChild(".canvas_date").text((0,xe.ic)(2===b.gStyle.fOptDate?x._file.fDatimeC.getDate():x._file.fDatimeM.getDate()))}isPadEnlarged(){return this.iscan||!this.has_canvas?"on"===this.enlargeMain("state"):this.getCanvSvg().property("pad_enlarged")===this.pad}enlargePad(D,w,P){if(D?.preventDefault(),D?.stopPropagation(),w&&this._websocket&&"off"===this.enlargeMain("state"))return;const x=this.getCanvSvg(),v=x.property("pad_enlarged");if(!this.iscan&&this.has_canvas&&(v||this.hasObjectsToDraw()||this.painters))v||P?v===this.pad?(this.enlargeMain(!1),x.property("pad_enlarged",null)):!P&&w&&console.error("missmatch with pad double click events"):(this.enlargeMain(!0,!0),x.property("pad_enlarged",this.pad),(0,et.QD)({pp:this,active:!0}));else{if(this._fixed_size||!this.enlargeMain(!P&&"toggle"))return;"off"===this.enlargeMain("state")?x.property("pad_enlarged",null):(0,et.QD)({pp:this,active:!0})}return this.checkResize(!0)}createPadSvg(D){if(!this.has_canvas)return this.createCanvasSvg(D?2:0),!0;const w=this.getCanvSvg(),P=w.property("draw_width"),x=w.property("draw_height"),v=w.property("pad_enlarged"),_=!(this.pad_draw_disabled||v&&v!==this.pad),C=this.isBatchMode();let te,N,m,L=Math.round(this.pad.fAbsWNDC*P),F=Math.round(this.pad.fAbsHNDC*x),U=Math.round(this.pad.fAbsXlowNDC*P),j=Math.round(x*(1-this.pad.fAbsYlowNDC))-F;if(v===this.pad&&(L=P,F=x,U=j=0),D?(te=this.svg_this_pad(),N=te.selectChild(".root_pad_border"),C||(m=this.getLayerSvg("btns_layer",this.this_pad_name)),this.addPadInteractive(!0)):(te=w.selectChild(".primitives_layer").append("svg:svg").classed("__root_pad_"+this.this_pad_name,!0).attr("pad",this.this_pad_name).property("pad_painter",this),C||te.append("svg:title").text("subpad "+this.this_pad_name),(!C||this.pad.fFillStyle>0||this.pad.fLineStyle>0&&this.pad.fLineColor>0)&&(N=te.append("svg:path").attr("class","root_pad_border")),C||N.style("pointer-events","visibleFill").on("dblclick",I=>this.enlargePad(I,!0)).on("click",()=>this.selectObjectPainter()).on("mouseenter",()=>this.showObjectStatus()).on("contextmenu",b.settings.ContextMenu?I=>this.padContextMenu(I):null),te.append("svg:g").attr("class","primitives_layer"),C||(m=te.append("svg:g").attr("class","btns_layer").property("leftside","left"!==b.settings.ToolBarSide).property("vertical",b.settings.ToolBarVert))),this.createAttFill({attr:this.pad}),this.createAttLine({attr:this.pad,color0:this.pad.fBorderMode?"":"none"}),te.style("display",_?null:"none").attr("viewBox",`0 0 ${L} ${F}`).attr("preserveAspectRatio","none").attr("x",U).attr("y",j).attr("width",L).attr("height",F).property("draw_x",U).property("draw_y",j).property("draw_width",L).property("draw_height",F),this._pad_x=U,this._pad_y=j,this._pad_width=L,this._pad_height=F,N){N.attr("d",`M0,0H${L}V${F}H0Z`).call(this.fillatt.func).call(this.lineatt.func),this.drawActiveBorder(N);let I=te.selectChild(".root_pad_border1"),A=te.selectChild(".root_pad_border2");if(this.pad.fBorderMode&&this.pad.fBorderSize){const R=this.pad.fBorderSize,k=this.pad.fBorderSize,J=`M0,0h${L}l${-R},${k}h${2*R-L}v${F-2*k}l${-R},${k}z`,_e=`M${L},${F}v${-F}l${-R},${k}v${F-2*k}h${2*R-L}l${-R},${k}z`;A.empty()&&(A=te.insert("svg:path",".primitives_layer").attr("class","root_pad_border2")),I.empty()&&(I=te.insert("svg:path",".primitives_layer").attr("class","root_pad_border1")),I.attr("d",this.pad.fBorderMode>0?J:_e).call(this.fillatt.func).style("fill",(0,z.Qh)(this.fillatt.color).brighter(.5).formatHex()),A.attr("d",this.pad.fBorderMode>0?_e:J).call(this.fillatt.func).style("fill",(0,z.Qh)(this.fillatt.color).darker(.5).formatHex())}else I.remove(),A.remove()}return this.setFastDrawing(L*(1-this.pad.fLeftMargin-this.pad.fRightMargin),F*(1-this.pad.fBottomMargin-this.pad.fTopMargin)),te.property("can3d")===b.constants.Embed3D.Overlay&&this.selectDom().select(".draw3d_"+this.this_pad_name).style("display",_?"":"none"),this.alignButtons&&m&&this.alignButtons(m,L,F),_}addPadInteractive(D=!1){if((0,b.isFunc)(this.$userInteractive)&&(this.$userInteractive(),delete this.$userInteractive),this.isBatchMode()||this.iscan)return;const w=this.getCanvSvg(),P=w.property("draw_width"),x=w.property("draw_height");(0,ot.WJ)(this,{cleanup:D,x:this._pad_x,y:this._pad_y,width:this._pad_width,height:this._pad_height,no_transform:!0,only_resize:!0,is_disabled:v=>w.property("pad_enlarged")||this.btns_active_flag||"move"===v&&(this._disable_dragging||this.getFramePainter()?.mode3d),getDrawG:()=>this.svg_this_pad(),pad_rect:{width:P,height:x},minwidth:20,minheight:20,move_resize:(v,_,C,L)=>{const F=this.pad.fAbsXlowNDC,U=this.pad.fAbsYlowNDC,j=C/P/this.pad.fAbsWNDC,te=L/x/this.pad.fAbsHNDC,N=v/P-F,m=1-(_+L)/x-U;this.forEachPainterInPad(I=>{I.pad.fAbsXlowNDC+=(I.pad.fAbsXlowNDC-F)*(j-1)+N,I.pad.fAbsYlowNDC+=(I.pad.fAbsYlowNDC-U)*(te-1)+m,I.pad.fAbsWNDC*=j,I.pad.fAbsHNDC*=te},"pads")},redraw:()=>this.interactiveRedraw("pad","padpos")})}disablePadDrawing(){!this.pad_draw_disabled&&this.has_canvas&&!this.iscan&&(this.pad_draw_disabled=!0,this.createPadSvg(!0))}checkSpecial(D){if(!D)return!1;if(D._typename===b.clTStyle)return Object.assign(b.gStyle,D),!0;if(D._typename===b.clTObjArray&&"ListOfColors"===D.name){if(this.options?.CreatePalette){let w=[];for(let P=D.arr.length-this.options.CreatePalette;P<D.arr.length;++P){const x=(0,ke.d_)(D.arr[P]);if(!x){console.log("Fail to create color for palette"),w=null;break}w.push(x)}w&&(this.custom_palette=new ke.rE(w))}return(!this.options||this.options.GlobalColors)&&(0,ke.np)(D),this._custom_colors=this.options?.LocalColors?(0,ke.TZ)(null,D):null,!0}if(D._typename===b.clTObjArray&&"CurrentColorPalette"===D.name){const w=[],P=[];let x=!1;for(let _=0;_<D.arr.length;++_){const C=D.arr[_];C?._typename===b.clTColor?(P[_]=C.fNumber,w[_]=(0,ke.d_)(C)):(console.log(`Missing color with index ${_}`),x=!0)}const v=!this.options||!x&&!this.options.IgnorePalette;return this._custom_palette_indexes=v?P:null,this._custom_palette_colors=v?w:null,!0}return!1}checkSpecialsInPrimitives(D){const w=D?.fPrimitives;if(w)for(let P=0;P<w.arr?.length;++P)this.checkSpecial(w.arr[P])&&(w.arr.splice(P,1),w.opt.splice(P,1),P--)}findInPrimitives(D,w){const P=v=>v&&v?.fName===D&&(!w||v?._typename===w),x=this._snap_primitives?.find(v=>P(1===v.fKind?v.fSnapshot:null));return x?x.fSnapshot:this.pad?.fPrimitives?.arr.find(P)}findPainterFor(D,w,P){return this.painters.find(x=>{const v=x.getObject();return!(!v||(!D||v!==D)&&(!w&&!P||w&&v.fName!==w||P&&v._typename!==P))})}hasObjectsToDraw(){return this.pad?.fPrimitives?.arr?.find(D=>D._typename!==b.clTPad)}syncDraw(D){const w={kind:D||"redraw"};return void 0===this._doing_draw?(this._doing_draw=[w],Promise.resolve(!0)):!(!0!==w.kind&&this._doing_draw.findIndex((P,x)=>x>0&&P.kind===w.kind)>0)&&(this._doing_draw.push(w),new Promise(P=>{w.func=P}))}doingDraw(){return void 0!==this._doing_draw}confirmDraw(){if(void 0===this._doing_draw)return console.warn("failure, should not happen");if(this._doing_draw.shift(),0===this._doing_draw.length)delete this._doing_draw;else{const D=this._doing_draw[0];D.func&&(D.func(),delete D.func)}}drawObject(){return(0,ve.A)(function*(){return console.log("Not possible to draw object without loading of draw.mjs"),null})()}drawPrimitives(D){var w=this;return(0,ve.A)(function*(){if(void 0===D)return w.iscan&&(w._start_tm=(new Date).getTime()),w._num_primitives=w.pad?.fPrimitives?.arr?.length||0,w.syncDraw(!0).then(()=>w.drawPrimitives(0));if(!w.pad||D>=w._num_primitives){if(w._start_tm){const x=(new Date).getTime()-w._start_tm;x>1e3&&console.log(`Canvas ${w.pad?.fName||"---"} drawing took ${(.001*x).toFixed(2)}s`),delete w._start_tm}return void w.confirmDraw()}const P=w.pad.fPrimitives.arr[D];return!P||D>0&&P._typename===b.clTFrame&&w.getFramePainter()?w.drawPrimitives(D+1):w.drawObject(w.getDom(),P,w.pad.fPrimitives.opt[D]).then(x=>((0,b.isObject)(x)&&(x._primitive=!0),w.drawPrimitives(D+1)))})()}divide(D,w){var P=this;return(0,ve.A)(function*(){if(!P.pad.Divide(D,w))return P;const x=v=>v>=P.pad.fPrimitives.arr.length?P:P.drawObject(P.getDom(),P.pad.fPrimitives.arr[v]).then(()=>x(v+1));return x(0)})()}getSubPadPainter(D){for(let w=0;w<this.painters.length;++w){const P=this.painters[w];if(P.pad&&(0,b.isFunc)(P.forEachPainterInPad)&&P.pad.fNumber===D)return P}return null}processPadTooltipEvent(D){const w=[],P=[];return this.painters?.forEach(x=>{(0,b.isFunc)(x.processTooltipEvent)&&w.push(x)}),D&&(D.nproc=w.length),w.forEach(x=>{const v=x.processTooltipEvent(D)||{user_info:null};P.push(v),D?.painters&&(v.painter=x)}),P}changeDarkMode(D){this.getCanvSvg().style("filter",D??b.settings.DarkMode?"invert(100%)":null)}fillContextMenu(D){if(D.add(this.pad?`header:${this.pad._typename}::${this.pad.fName}`:"header:Canvas"),D.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),!this._websocket){let P=function(x){this.pad[x.slice(1)]=parseInt(x[0]),this.interactiveRedraw("pad",x.slice(1))};D.addchk(this.pad?.fGridx,"Grid x",(this.pad?.fGridx?"0":"1")+"fGridx",P),D.addchk(this.pad?.fGridy,"Grid y",(this.pad?.fGridy?"0":"1")+"fGridy",P),D.add("sub:Ticks x"),D.addchk(0===this.pad?.fTickx,"normal","0fTickx",P),D.addchk(1===this.pad?.fTickx,"ticks on both sides","1fTickx",P),D.addchk(2===this.pad?.fTickx,"labels on both sides","2fTickx",P),D.add("endsub:"),D.add("sub:Ticks y"),D.addchk(0===this.pad?.fTicky,"normal","0fTicky",P),D.addchk(1===this.pad?.fTicky,"ticks on both sides","1fTicky",P),D.addchk(2===this.pad?.fTicky,"labels on both sides","2fTicky",P),D.add("endsub:"),D.addchk(this.pad?.fEditable,"Editable",x=>{this.pad.fEditable=x,this.interactiveRedraw("pad")}),this.iscan&&D.addchk(this.pad?.TestBit(ce),"Gray scale",x=>{this.setGrayscale(x),this.interactiveRedraw("pad")}),(0,b.isFunc)(this.drawObject)&&D.add("Build legend",()=>this.buildLegend()),D.addAttributesMenu(this),D.add("Save to gStyle",()=>{this.pad&&(this.fillatt?.saveToStyle(this.iscan?"fCanvasColor":"fPadColor"),b.gStyle.fPadGridX=this.pad.fGridx,b.gStyle.fPadGridY=this.pad.fGridy,b.gStyle.fPadTickX=this.pad.fTickx,b.gStyle.fPadTickY=this.pad.fTicky,b.gStyle.fOptLogx=this.pad.fLogx,b.gStyle.fOptLogy=this.pad.fLogy,b.gStyle.fOptLogz=this.pad.fLogz)},"Store pad fill attributes, grid, tick and log scale settings to gStyle"),this.iscan&&D.addSettingsMenu(!1,!1,x=>{"dark"===x&&this.changeDarkMode()})}D.add("separator"),(0,b.isFunc)(this.hasMenuBar)&&(0,b.isFunc)(this.actiavteMenuBar)&&D.addchk(this.hasMenuBar(),"Menu bar",P=>this.actiavteMenuBar(P)),(0,b.isFunc)(this.hasEventStatus)&&(0,b.isFunc)(this.activateStatusBar)&&(0,b.isFunc)(this.canStatusBar)&&this.canStatusBar()&&D.addchk(this.hasEventStatus(),"Event status",()=>this.activateStatusBar("toggle")),(this.enlargeMain()||this.has_canvas&&this.hasObjectsToDraw())&&D.addchk(this.isPadEnlarged(),"Enlarge "+(this.iscan?"canvas":"pad"),()=>this.enlargePad());const w=this.this_pad_name||(this.iscan?"canvas":"pad");return D.add("sub:Save as"),["svg","png","jpeg","pdf","webp"].forEach(P=>D.add(`${w}.${P}`,()=>this.saveAs(P,this.iscan,`${w}.${P}`))),D.add("endsub:"),!0}padContextMenu(D){var w=this;return(0,ve.A)(function*(){return D.stopPropagation&&(D.stopPropagation(),D.preventDefault(),w.getFramePainter()?.setLastEventPos()),(0,Re.ES)(D,w).then(P=>(w.fillContextMenu(P),w.fillObjectExecMenu(P,""))).then(P=>P.show())})()}redrawPad(D){var w=this;return(0,ve.A)(function*(){const P=w.syncDraw(D);if(!1===P)return console.log(`Prevent redrawing of ${w.pad.fName}`),!1;let x=!0;const v=_=>{for(;_<w.painters.length;){const C=w.painters[_++];let L=0;if((x||C.this_pad_name)&&(L=C.redraw(D)),(0,b.isPromise)(L))return L.then(()=>v(_))}return!0};return P.then(()=>(w.iscan?w.createCanvasSvg(2):x=w.createPadSvg(!0),v(0))).then(()=>(w.addPadInteractive(),w.confirmDraw(),(0,et.OZ)()===w&&w.getCanvPainter()?.producePadEvent("padredraw",w),!0))})()}redraw(D){this.redrawPad(D)}needRedrawByResize(){const D=this.svg_this_pad();return!D.empty()&&D.property("can3d")===b.constants.Embed3D.Overlay||this.painters.findIndex(w=>!!(0,b.isFunc)(w.needRedrawByResize)&&w.needRedrawByResize())>=0}checkCanvasResize(D,w){if(this._ignore_resize||!this.iscan&&this.has_canvas)return!1;const P=this.syncDraw("canvas_resize");if(!1===P)return!1;(!0===D||!1===D)&&(w=D,D=null),(0,b.isObject)(D)&&D.force&&(w=!0),w||(w=this.needRedrawByResize());let x=!1;const v=_=>!x||_>=this.painters.length?(this.confirmDraw(),x):(0,b.getPromise)(this.painters[_].redraw(w?"redraw":"resize")).then(()=>v(_+1));return P.then(()=>(x=this.createCanvasSvg(w?2:1,D),x&&this.iscan&&this.pad&&this.online_canvas&&!this.embed_canvas&&!this.isBatchMode()&&(this._resize_tmout&&clearTimeout(this._resize_tmout),this._resize_tmout=setTimeout(()=>{delete this._resize_tmout,(0,b.isFunc)(this.sendResized)&&this.sendResized()},1e3)),v(0)))}updateObject(D){if(!D)return!1;this.pad.fBits=D.fBits,this.pad.fTitle=D.fTitle,this.pad.fGridx=D.fGridx,this.pad.fGridy=D.fGridy,this.pad.fTickx=D.fTickx,this.pad.fTicky=D.fTicky,this.pad.fLogx=D.fLogx,this.pad.fLogy=D.fLogy,this.pad.fLogz=D.fLogz,this.pad.fUxmin=D.fUxmin,this.pad.fUxmax=D.fUxmax,this.pad.fUymin=D.fUymin,this.pad.fUymax=D.fUymax,this.pad.fX1=D.fX1,this.pad.fX2=D.fX2,this.pad.fY1=D.fY1,this.pad.fY2=D.fY2,this.pad.fLeftMargin=D.fLeftMargin,this.pad.fRightMargin=D.fRightMargin,this.pad.fBottomMargin=D.fBottomMargin,this.pad.fTopMargin=D.fTopMargin,this.pad.fFillColor=D.fFillColor,this.pad.fFillStyle=D.fFillStyle,this.pad.fLineColor=D.fLineColor,this.pad.fLineStyle=D.fLineStyle,this.pad.fLineWidth=D.fLineWidth,this.pad.fPhi=D.fPhi,this.pad.fTheta=D.fTheta,this.pad.fEditable=D.fEditable,this.iscan&&this.checkSpecialsInPrimitives(D);const w=this.getFramePainter();if(w&&w.updateAttributes(!w.modified_NDC),!D.fPrimitives)return!1;let P=!1,x=0;for(let v=0;v<D.fPrimitives.arr?.length;++v)for(;x<this.painters.length;){const _=this.painters[x++];if(_._primitive){_.updateObject(D.fPrimitives.arr[v],D.fPrimitives.opt[v])&&(P=!0);break}}return P}buildLegend(D,w,P,x,v,_){var C=this;return(0,ve.A)(function*(){const L=C.findPainterFor(null,"",b.clTLegend);if(!L&&!(0,b.isFunc)(C.drawObject))return Promise.reject(Error("Not possible to build legend while module draw.mjs was not load"));const F=L?.getObject()??(0,b.create)(b.clTLegend),U=C.getRootPad(!0);F.fPrimitives.Clear();for(let m=0;m<C.painters.length;++m){const I=C.painters[m],A=I.getObject();if(!A||A.fName===b.kTitle||"stats"===A.fName||!1===I.draw_content||A._typename===b.clTLegend||A._typename===b.clTHStack||A._typename===b.clTMultiGraph)continue;const R=(0,b.create)(b.clTLegendEntry);R.fObject=A,R.fLabel=I.getItemName(),("all"===_||!R.fLabel)&&(R.fLabel=A.fName),R.fOption="",R.fLabel&&(I.lineatt?.used&&(R.fOption+="l"),I.fillatt?.used&&(R.fOption+="f"),I.markeratt?.used&&(R.fOption+="p"),R.fOption||(R.fOption="l"),F.fPrimitives.Add(R))}if(L)return L.redraw();let te=F.fPrimitives.arr.length;if(!te)return null;te>8&&(te=8),te*=.1,D===P||w===x?(F.fX1NDC=.4*U.fLeftMargin+.6*(1-U.fRightMargin),F.fY1NDC=(1-te)*(1-U.fTopMargin)+te*U.fBottomMargin,F.fX2NDC=.99-U.fRightMargin,F.fY2NDC=.99-U.fTopMargin,void 0===_&&(_="autoplace")):(F.fX1NDC=D,F.fY1NDC=w,F.fX2NDC=P,F.fY2NDC=x),F.fFillStyle=1001,F.fTitle=v??"";const N=C.has_canvas?C.selectCurrentPad(C.this_pad_name):void 0;return C.drawObject(C.getDom(),F,_).then(m=>(C.selectCurrentPad(N),m))})()}addObjectPainter(D,w,P){if(D&&w&&w[P]&&void 0===D.snapid){this.painters.indexOf(D)<0&&this.painters.push(D),D.snapid=w[P].fObjectID;const x=v=>{if(v._unique_painter_id)for(let _=0;_<this.painters.length;++_){const C=this.painters[_];C._main_painter_id===v._unique_painter_id&&C._secondary_id&&(C.snapid=v.snapid+"#"+C._secondary_id,x(C))}};x(D)}}processSnapStyle(D){Object.assign(b.gStyle,D.fSnapshot)}processSnapColors(D){const w=(0,ke.LQ)(D.fSnapshot.fOper);(!this.options||this.options.GlobalColors)&&(0,ke.np)(w);const P=this.pad?.TestBit(ce)??!1,x=(0,ke.TZ)(null,w,P);if(this._custom_colors=this.options?.LocalColors?x:null,!D.fSnapshot.fBuf||this.options&&this.options.IgnorePalette)delete this._custom_palette_indexes,delete this._custom_palette_colors,delete this.custom_palette;else{const v=[],_=[];for(let C=0;C<D.fSnapshot.fBuf.length;++C)v[C]=Math.round(D.fSnapshot.fBuf[C]),_[C]=x[v[C]];this._custom_palette_indexes=v,this._custom_palette_colors=_,this.custom_palette=new ke.rE(_,P)}}processSnapFont(D){const w=D.fSnapshot.fOper.split(":");(0,Xe.uT)(Number.parseInt(w[0]),w[1],w[2],w[3])}processSpecialSnaps(D){for(;D?.length;){const w=D[0];if(5===w.fKind)D.shift(),this.processSnapStyle(w);else if(4===w.fKind)D.shift(),this.processSnapColors(w);else{if(6!==w.fKind)break;D.shift(),this.processSnapFont(w)}}}drawNextSnap(D,w){var P=this;return(0,ve.A)(function*(){if(void 0===w&&(w=-1,P._snaps_map={},P._num_primitives=D?D.length:0),++w,!D||w>=D.length)return delete P._snaps_map,P;const x=D[w];if(5===x.fKind)return P.processSnapStyle(x),P.drawNextSnap(D,w);if(4===x.fKind)return P.processSnapColors(x),P.drawNextSnap(D,w);const v=x.fObjectID,_=1===x.fKind&&x.fSnapshot?._typename===b.clTFrame;let C=(P._snaps_map[v]||0)+1,L=null;P._snaps_map[v]=C;for(let F=0;F<P.painters.length;++F){const U=P.painters[F];if(U.snapid===v){if(0==--C){L=U;break}}else if(_&&!U.snapid&&U===P.getFramePainter()){U.snapid=v,L=U;break}}if(L){if(3===x.fKind)return L.redrawPadSnap(x).then(()=>P.drawNextSnap(D,w));let F;return 1===x.fKind?L.updateObject(x.fSnapshot,x.fOption,!0)&&(F=L.redraw()):2===x.fKind&&L.updateObject(x.fSnapshot)&&(F=L.redraw()),(0,b.getPromise)(F).then(()=>P.drawNextSnap(D,w))}if(3===x.fKind){const F=x.fSnapshot;F.fPrimitives=null;const U=new Y(P.getDom(),F,!1);U.decodeOptions(x.fOption),U.addToPadPrimitives(P.this_pad_name),U.snapid=x.fObjectID,U.is_active_pad=!!x.fActive,U._readonly=x.fReadOnly??!1,U._snap_primitives=x.fPrimitives,U._has_execs=x.fHasExecs??!1,F.$disable_drawing&&(U.pad_draw_disabled=!0),U.processSpecialSnaps(x.fPrimitives),U.createPadSvg(),U.matchObjectType(b.clTPad)&&x.fPrimitives.length>0&&U.addPadButtons(!0);const j=U.selectCurrentPad(U.this_pad_name);return U.drawNextSnap(x.fPrimitives).then(()=>(U.addPadInteractive(),U.selectCurrentPad(j),P.drawNextSnap(D,w)))}return 1!==x.fKind&&2!==x.fKind||"__ignore_drawing__"===x.fOption?P.drawNextSnap(D,w):P.drawObject(P.getDom(),x.fSnapshot,x.fOption).then(F=>(P.addObjectPainter(F,D,w),P.drawNextSnap(D,w)))})()}findSnap(D){if(this.snapid===D)return this;if(!this.painters)return null;for(let w=0;w<this.painters.length;++w){let P=this.painters[w];if((0,b.isFunc)(P.findSnap)?P=P.findSnap(D):P.snapid!==D&&(P=null),P)return P}return null}redrawPadSnap(D){var w=this;return(0,ve.A)(function*(){if(!D?.fPrimitives)return w;w.is_active_pad=!!D.fActive,w._readonly=D.fReadOnly??!1,w._snap_primitives=D.fPrimitives,w._has_execs=D.fHasExecs??!1;const P=D.fSnapshot;if(P.fPrimitives=null,w._deliver_webcanvas_events=P.fExecs?.arr?.length>0,void 0===w.snapid){w.snapid=D.fObjectID,w.draw_object=w.pad=P,w.isBatchMode()&&(!P.fCw||!P.fCh)&&(P.fCw=900,P.fCh=700),(!P.fCw||!P.fCh)&&(w._fixed_size=!1);const L=w.selectDom().attr("id");!w.isBatchMode()&&!w.use_openui&&!w.brlayout&&L&&(0,b.isStr)(L)&&(w.brlayout=new Ie.jX(L,null,w),w.brlayout.create(L,!0),w.setDom(w.brlayout.drawing_divid()),(0,He.d7)(w.brlayout)),w.processSpecialSnaps(D.fPrimitives),w.createCanvasSvg(0),w.isBatchMode()||w.addPadButtons(!0),typeof D.fHighlightConnect<"u"&&(w._highlight_connect=D.fHighlightConnect);let F=Promise.resolve(!0);if((0,b.isStr)(D.fScripts)&&D.fScripts){let U="";0===D.fScripts.indexOf("load:")?U=D.fScripts.slice(5).split(";"):0===D.fScripts.indexOf("assert:")&&(U=D.fScripts.slice(7)),F=U?(0,b.loadScript)(U):(0,b.injectCode)(D.fScripts)}return F.then(()=>w.drawNextSnap(D.fPrimitives))}w.updateObject(P),w.iscan?w.createCanvasSvg(2):w.createPadSvg(!0);const x=(L,F,U,j)=>{const te=L.find(m=>!(void 0===m.snapid||!m.matchObjectType(U)||j&&(!m.getObject()||m.getObject().fName!==j)));if(!te)return;const N=F.find(m=>!(1!==m.fKind||!m.fSnapshot||m.fSnapshot._typename!==U||j&&m.fSnapshot.fName!==j));N&&te.snapid!==N.fObjectID&&(te.snapid=N.fObjectID)};D.fWithoutPrimitives||(x(w.painters,D.fPrimitives,b.clTFrame),x(w.painters,D.fPrimitives,b.clTPaveText,b.kTitle));let v=!1,_=!1;if(!D.fWithoutPrimitives)for(let L=0;L<w.painters.length;++L){const F=w.painters[L];if(!(0,b.isStr)(F.snapid)||F.isSecondary())continue;const U=D.fPrimitives.find(j=>j.fObjectID===F.snapid&&!j.$checked);if(U)v=!0,U.$checked=!0;else if(L=w.removePrimitive(L),_=!0,-111===L){v=!1;break}}if(_&&delete w.pads_cache,!v&&!D.fWithoutPrimitives){const L=w.getFramePainter(),F=w.painters;w.painters=[],F.forEach(U=>{L!==U&&U.cleanup()}),delete w.main_painter_ref,L&&(w.painters.push(L),L.cleanFrameDrawings(),L.redraw()),(0,b.isFunc)(w.removePadButtons)&&w.removePadButtons(),w.addPadButtons(!0)}const C=w.selectCurrentPad(w.this_pad_name);return w.drawNextSnap(D.fPrimitives).then(()=>(w.addPadInteractive(),w.selectCurrentPad(C),(0,et.OZ)()===w&&w.getCanvPainter()?.producePadEvent("padredraw",w),w))})()}deliverWebCanvasEvent(D,w,P,x){if(!this._deliver_webcanvas_events||!this.is_active_pad||this.doingDraw()||void 0===w||void 0===P)return;const v=this.getCanvPainter();if(!v||!v._websocket||!v._websocket.canSend(2)||v._readonly)return;let _="";x&&x[0]&&x[0].painter?.snapid&&(_=x[0].painter.snapid.toString());const C=JSON.stringify([this.snapid,D,w.toString(),P.toString(),_]);v.sendWebsocket(`EVENT:${C}`)}createImage(D){var w=this;return(0,ve.A)(function*(){return"png"===D||"jpeg"===D||"svg"===D||"pdf"===D?w.produceImage(!0,D).then(P=>{if(!P||"svg"===D)return P;const x=P.indexOf("base64,");return x>0?P.slice(x+7):""}):""})()}getWebPadOptions(D,w){let P=void 0===D,x=null,v=!0;if(P&&this._readonly)return"";if("only_this"===D?(P=!0,v=!1):"with_subpads"===D&&(P=!0,v=!0),P&&(D=[]),w||(w=this.iscan?this:this.getCanvPainter()),this.snapid){if(x={_typename:"TWebPadOptions",snapid:this.snapid.toString(),active:!!this.is_active_pad,cw:0,ch:0,w:[],bits:0,primitives:[],logx:this.pad.fLogx,logy:this.pad.fLogy,logz:this.pad.fLogz,gridx:this.pad.fGridx,gridy:this.pad.fGridy,tickx:this.pad.fTickx,ticky:this.pad.fTicky,mleft:this.pad.fLeftMargin,mright:this.pad.fRightMargin,mtop:this.pad.fTopMargin,mbottom:this.pad.fBottomMargin,xlow:0,ylow:0,xup:1,yup:1,zx1:0,zx2:0,zy1:0,zy2:0,zz1:0,zz2:0},this.iscan)x.bits=this.getStatusBits(),x.cw=this.getPadWidth(),x.ch=this.getPadHeight(),x.w=[window.screenLeft,window.screenTop,window.outerWidth,window.outerHeight];else if(w){const _=w.getPadWidth(),C=w.getPadHeight(),L=this.getPadRect();x.cw=_,x.ch=C,x.xlow=L.x/_,x.ylow=1-(L.y+L.height)/C,x.xup=x.xlow+L.width/_,x.yup=x.ylow+L.height/C}this.getPadRanges(x)?D.push(x):console.log(`fail to get ranges for pad ${this.pad.fName}`)}return this.painters.forEach(_=>{if((0,b.isFunc)(_.getWebPadOptions))v&&_.getWebPadOptions(D,w);else{const C=le(_);C&&x.primitives.push(C)}}),P?(0,b.toJSON)(D):void 0}getPadRanges(D){if(!D)return!1;const w=this.getFramePainter(),P=this.svg_this_pad();if(D.ranges=w?.ranges_set??!1,D.ux1=D.px1=D.ranges?w.scale_xmin:0,D.uy1=D.py1=D.ranges?w.scale_ymin:0,D.ux2=D.px2=D.ranges?w.scale_xmax:0,D.uy2=D.py2=D.ranges?w.scale_ymax:0,D.uz1=D.ranges?w.scale_zmin??0:0,D.uz2=D.ranges?w.scale_zmax??0:0,w&&(w.zoom_xmin!==w.zoom_xmax&&(D.zx1=w.zoom_xmin,D.zx2=w.zoom_xmax),w.zoom_ymin!==w.zoom_ymax&&(D.zy1=w.zoom_ymin,D.zy2=w.zoom_ymax),w.zoom_zmin!==w.zoom_zmax&&(D.zz1=w.zoom_zmin,D.zz2=w.zoom_zmax)),!D.ranges||P.empty())return!0;const x=(C,L,F)=>C?L<=0?F:(L=Math.log10(L),C>1&&(L/=Math.log10(C)),L):L,v=w.getFrameRect();D.ux1=x(w.logx,D.ux1,0),D.ux2=x(w.logx,D.ux2,1);let _=(D.ux2-D.ux1)/(v.width||10);return D.px1=D.ux1-_*v.x,D.px2=D.px1+_*this.getPadWidth(),D.uy1=x(w.logy,D.uy1,0),D.uy2=x(w.logy,D.uy2,1),_=(D.uy2-D.uy1)/(v.height||10),D.py1=D.uy1-_*v.y,D.py2=D.py1+_*this.getPadHeight(),!0}itemContextMenu(D){const w=this.svg_this_pad().node().getBoundingClientRect(),P={clientX:w.left+10,clientY:w.top+10};if("pad"===D)return(0,b.postponePromise)(()=>this.padContextMenu(P),50);let v,x=null;switch(D){case"xaxis":case"yaxis":case"zaxis":x=this.getFramePainter(),v=D[0];break;case"frame":x=this.getFramePainter();break;default:{const _=parseInt(D);Number.isInteger(_)&&(x=this.painters[_])}}return(0,b.isFunc)(x?.fillContextMenu)?(0,Re.ES)(P,x).then(_=>{if(x.fillContextMenu(_,v)||x.snapid)return x.fillObjectExecMenu(_,v).then(()=>(0,b.postponePromise)(()=>_.show(),50))}):void 0}saveAs(D,w,P){P||(P=(this.this_pad_name||(this.iscan?"canvas":"pad"))+"."+D),this.produceImage(w,D).then(x=>{if(!x)return console.error(`Fail to produce image ${P}`);(0,He.OJ)(P,"svg"!==D?x:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(x))})}findActivePad(){let D;return this.forEachPainterInPad(w=>{w.is_active_pad&&!D&&(D=w)},"pads"),D}produceImage(D,w){var P=this;return(0,ve.A)(function*(){const x="frame"===D,v=x?P.getFrameSvg(P.this_pad_name):D?P.getCanvSvg():P.svg_this_pad(),_=D&&!x?P.getCanvPainter():P,C=[];if(v.empty())return"";if(x||!D){const te=P.getCanvSvg().selectChild(".canvas_defs");te.empty()||(C.push({prnt:P.getCanvSvg(),defs:te}),v.node().insertBefore(te.node(),v.node().firstChild))}let L=null;_.forEachPainterInPad(te=>{if(te.is_active_pad&&!L&&(L=te,L.drawActiveBorder(null,!1)),x)return;const N={prnt:te.svg_this_pad()};C.push(N);const m=te.getLayerSvg("btns_layer",te.this_pad_name);N.btns_node=m.node(),N.btns_node&&(N.btns_prnt=N.btns_node.parentNode,N.btns_next=N.btns_node.nextSibling,m.remove());const I=te.getFramePainter();if(!(0,b.isFunc)(I?.render3D)||!(0,b.isFunc)(I?.access3dKind))return;const A=I.access3dKind();if(A!==b.constants.Embed3D.Overlay&&A!==b.constants.Embed3D.Embed)return;const R=I.getSizeFor3d(b.constants.Embed3D.Embed),k=I.renderer.domElement;I.render3D(0);const J=k.toDataURL("image/png");A===b.constants.Embed3D.Embed&&(N.foreign=N.prnt.select("."+R.clname),N.foreign.remove());const _e=I.getFrameSvg();N.frame_node=_e.node(),N.frame_node&&(N.frame_next=N.frame_node.nextSibling,_e.remove()),N.img=N.prnt.insert("image",".primitives_layer").attr("x",R.x).attr("y",R.y).attr("width",k.width).attr("height",k.height).attr("href",J)},"pads");let F=v.property("draw_width"),U=v.property("draw_height");if(x){const te=P.getFramePainter();F=te.getFrameWidth(),U=te.getFrameHeight()}const j="pdf"===w?{node:v.node(),width:F,height:U,reset_tranform:x}:(0,xe.NM)(`<svg width="${F}" height="${U}" xmlns="http://www.w3.org/2000/svg">${v.node().innerHTML}</svg>`);return(0,xe.Vm)(j,w).then(te=>{L?.drawActiveBorder(null,!0);for(let N=0;N<C.length;++N){const m=C[N];m.img?.remove();const I=m.prnt.selectChild(".primitives_layer");m.foreign&&m.prnt.node().insertBefore(m.foreign.node(),I.node()),m.frame_node&&I.node().insertBefore(m.frame_node,m.frame_next),m.btns_node&&m.btns_prnt.insertBefore(m.btns_node,m.btns_next),m.defs&&m.prnt.node().insertBefore(m.defs.node(),m.prnt.node().firstChild)}return te})})()}clickPadButton(D,w){if("CanvasSnapShot"===D)return this.saveAs("png",!0);if("enlargePad"===D)return this.enlargePad();if("PadSnapShot"===D)return this.saveAs("png",!1);if("PadContextMenus"===D)return w?.preventDefault(),w?.stopPropagation(),(0,Re.IV)()?void 0:(0,Re.ES)(w,this).then(v=>{v.add("header:Menus"),v.add(this.iscan?"Canvas":"Pad","pad",this.itemContextMenu),this.getFramePainter()&&v.add("Frame","frame",this.itemContextMenu);const _=this.getMainPainter();if(_&&(v.add("X axis","xaxis",this.itemContextMenu),v.add("Y axis","yaxis",this.itemContextMenu),(0,b.isFunc)(_.getDimension)&&_.getDimension()>1&&v.add("Z axis","zaxis",this.itemContextMenu)),this.painters?.length){v.add("separator");const C=[];this.painters.forEach((L,F)=>{const U=L?.getObject();if(!U||C.indexOf(U)>=0)return;let j=(0,b.isFunc)(L.getClassName)?L.getClassName():U._typename||"";j&&(j+="::"),j+=(0,b.isFunc)(L.getObjectName)?L.getObjectName():U.fName||`item${F}`,v.add(j,F,this.itemContextMenu),C.push(U)})}v.show()});let P=!1;const x=[];for(let v=0;v<this.painters.length;++v){const _=this.painters[v];(0,b.isFunc)(_.clickPadButton)&&x.push(_.clickPadButton(D,w)),!P&&(0,b.isFunc)(_.clickButton)&&(P=_.clickButton(D),(0,b.isPromise)(P)&&x.push(P))}return Promise.all(x)}addPadButton(D,w,P,x){if(b.settings.ToolBar&&!this.isBatchMode()){this._buttons||(this._buttons=[]);for(let _=0;_<this._buttons.length;++_)if(this._buttons[_].funcname===P)return;if(this._buttons.push({btn:D,tooltip:w,funcname:P,keyname:x}),!this.iscan&&this.has_canvas&&0!==P.indexOf("Pad")&&"enlargePad"!==P){const _=this.getCanvPainter();_&&_!==this&&_.addPadButton(D,w,P)}}}showPadButtons(){this._buttons&&(ue.assign(this),this.showPadButtons())}addPadButtons(D){this.addPadButton("camera","Create PNG",this.iscan?"CanvasSnapShot":"PadSnapShot","Ctrl PrintScreen"),b.settings.ContextMenu&&this.addPadButton("question","Access context menus","PadContextMenus"),(!this.iscan&&this.has_canvas&&this.hasObjectsToDraw()||this.enlargeMain("verify"))&&this.addPadButton("circle","Enlarge canvas","enlargePad"),D&&this.brlayout&&(this.addPadButton("diamand","Toggle Ged","ToggleGed"),this.addPadButton("three_circles","Toggle Status","ToggleStatus"))}decodeOptions(D){const w=this.getObject();if(!w)return;const P=new xe.nC(D);function x(v,_){_||(_=w),v(_);const C=_.fPrimitives?.arr||[];for(let L=0;L<C.length;++L)C[L]._typename===b.clTPad&&x(v,C[L])}this.options||(this.options={}),Object.assign(this.options,{GlobalColors:!0,LocalColors:!1,CreatePalette:0,IgnorePalette:!1,RotateFrame:!1,FixFrame:!1}),(P.check("NOCOLORS")||P.check("NOCOL"))&&(this.options.GlobalColors=this.options.LocalColors=!1),(P.check("LCOLORS")||P.check("LCOL"))&&(this.options.GlobalColors=!1,this.options.LocalColors=!0),(P.check("NOPALETTE")||P.check("NOPAL"))&&(this.options.IgnorePalette=!0),P.check("ROTATE")&&(this.options.RotateFrame=!0),P.check("FIXFRAME")&&(this.options.FixFrame=!0),P.check("FIXSIZE")&&this.iscan&&(this._fixed_size=!0),P.check("CP",!0)&&(this.options.CreatePalette=P.partAsInt(0,0)),P.check("NOZOOMX")&&(this.options.NoZoomX=!0),P.check("NOZOOMY")&&(this.options.NoZoomY=!0),P.check("GRAYSCALE")&&!w.TestBit(ce)&&w.InvertBit(ce),P.check("NOMARGINS")&&x(v=>{v.fLeftMargin=v.fRightMargin=v.fBottomMargin=v.fTopMargin=0}),P.check("WHITE")&&x(v=>{v.fFillColor=0}),P.check("LOG2X")&&x(v=>{v.fLogx=2,v.fUxmin=0,v.fUxmax=1,v.fX1=0,v.fX2=1}),P.check("LOGX")&&x(v=>{v.fLogx=1,v.fUxmin=0,v.fUxmax=1,v.fX1=0,v.fX2=1}),P.check("LOG2Y")&&x(v=>{v.fLogy=2,v.fUymin=0,v.fUymax=1,v.fY1=0,v.fY2=1}),P.check("LOGY")&&x(v=>{v.fLogy=1,v.fUymin=0,v.fUymax=1,v.fY1=0,v.fY2=1}),P.check("LOG2Z")&&x(v=>{v.fLogz=2}),P.check("LOGZ")&&x(v=>{v.fLogz=1}),P.check("LOGV")&&x(v=>{v.fLogv=1}),P.check("LOG2")&&x(v=>{v.fLogx=v.fLogy=v.fLogz=2}),P.check("LOG")&&x(v=>{v.fLogx=v.fLogy=v.fLogz=1}),P.check("LNX")&&x(v=>{v.fLogx=3,v.fUxmin=0,v.fUxmax=1,v.fX1=0,v.fX2=1}),P.check("LNY")&&x(v=>{v.fLogy=3,v.fUymin=0,v.fUymax=1,v.fY1=0,v.fY2=1}),P.check("LN")&&x(v=>{v.fLogx=v.fLogy=v.fLogz=3}),P.check("GRIDX")&&x(v=>{v.fGridx=1}),P.check("GRIDY")&&x(v=>{v.fGridy=1}),P.check("GRID")&&x(v=>{v.fGridx=v.fGridy=1}),P.check("TICKX")&&x(v=>{v.fTickx=1}),P.check("TICKY")&&x(v=>{v.fTicky=1}),P.check("TICKZ")&&x(v=>{v.fTickz=1}),P.check("TICK")&&x(v=>{v.fTickx=v.fTicky=1}),P.check("OTX")&&x(v=>{v.$OTX=!0}),P.check("OTY")&&x(v=>{v.$OTY=!0}),P.check("CTX")&&x(v=>{v.$CTX=!0}),P.check("CTY")&&x(v=>{v.$CTY=!0}),P.check("RX")&&x(v=>{v.$RX=!0}),P.check("RY")&&x(v=>{v.$RY=!0}),this.storeDrawOpt(D)}static draw(D,w,P){return(0,ve.A)(function*(){const x=new Y(D,w,!1);x.decodeOptions(P),x.getCanvSvg().empty()?(x.has_canvas=!1,x.this_pad_name="",x.setTopPainter()):x.addToPadPrimitives(x.pad_name),w?.$disable_drawing&&(x.pad_draw_disabled=!0),x.createPadSvg(),x.matchObjectType(b.clTPad)&&(!x.has_canvas||x.hasObjectsToDraw())&&x.addPadButtons();const v=x.has_canvas?x.selectCurrentPad(x.this_pad_name):void 0;return(0,et.QD)({pp:x,active:!0}),x.drawPrimitives().then(()=>(x.showPadButtons(),x.addPadInteractive(),x.selectCurrentPad(v),x))})()}}},7041:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{HierarchyPainter:()=>L,drawInspector:()=>j,drawList:()=>ie,drawStreamerInfo:()=>F,folderHierarchy:()=>ue,getHPainter:()=>Re.gZ,keysHierarchy:()=>Y,listHierarchy:()=>le,markAsStreamerInfo:()=>w,objectHierarchy:()=>V,taskHierarchy:()=>fe});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(471),xe=Ee(6823),et=Ee(9041),Je=Ee(6224),Xe=Ee(6370),ot=Ee(69),Re=Ee(5983),He=Ee(6714);const Ie="TopFolder";function ce(N){return N<1e4?N.toFixed(0)+"B":N<1e6?(N/1e3).toFixed(2)+"KiB":N<1e9?(N/1e6).toFixed(2)+"MiB":(N/1e9).toFixed(2)+"GiB"}function ie(N,m,I){return he.apply(this,arguments)}function he(){return(he=(0,ve.A)(function*(N,m,I){return m&&m.arr?{dom:N,lst:m,opt:I,indx:-1,painter:null,draw_next(){for(;++this.indx<this.lst.arr.length;){const R=this.lst.arr[this.indx];if(R)return(0,ot.$2)(this.dom,R,this.lst.opt&&this.lst.opt[this.indx]?this.lst.opt[this.indx]:this.opt).then(J=>(J&&!this.painter&&(this.painter=J),this.draw_next()))}return this.painter}}.draw_next():null})).apply(this,arguments)}function ue(N,m){if(!m?.fFolders)return!1;if(0===m.fFolders.arr.length)return N._more=!1,!0;N._childs=[];for(let I=0;I<m.fFolders.arr.length;++I){const A=m.fFolders.arr[I];N._childs.push({_name:A.fName,_kind:b.prROOT+A._typename,_obj:A})}return!0}function fe(N,m){if(!m?.fTasks)return!1;if(V(N,m,{exclude:["fTasks","fName"]}),0===m.fTasks.arr.length&&0===N._childs.length)return N._more=!1,!0;for(let I=0;I<m.fTasks.arr.length;++I){const A=m.fTasks.arr[I];N._childs.push({_name:A.fName,_kind:b.prROOT+A._typename,_obj:A})}return!0}function le(N,m){if(!(0,b.isRootCollection)(m))return!1;if(void 0===m.arr||0===m.arr.length)return N._more=!1,!0;let I=!1,A=N;for(;A;)A._do_context&&(I=!0),A=A._parent;const R=m._typename===b.clTMap,k=[],J=[],_e=[];for(let be=0;be<m.arr.length;++be){const Te=R?m.arr[be].first:m.arr[be];if(!Te)continue;const Pe=Te.fName||Te.name;if(!Pe)continue;const We=k.indexOf(Pe);We>=0?J[We]++:(J[k.length]=_e[k.length]=1,k.push(Pe))}N._childs=[];for(let be=0;be<m.arr.length;++be){const Te=R?m.arr[be].first:m.arr[be];let Pe;if(Te?._typename){switch(Pe={_name:Te.fName||Te.name,_kind:b.prROOT+Te._typename,_title:`${Te.fTitle||""} type:${Te._typename}`,_obj:Te},Te._typename){case b.clTColor:Pe._value=(0,xe.d_)(Te);break;case b.clTText:case b.clTLatex:Pe._value=Te.fTitle;break;case b.clTObjString:Pe._value=Te.fString;break;default:m.opt&&m.opt[be]&&m.opt[be].length&&(Pe._value=m.opt[be])}if(I&&(0,ot.Xv)(Te._typename)&&(Pe._direct_context=!0),!Pe._name||Number.isInteger(parseInt(Pe._name))&&parseInt(Pe._name)!==be||m.arr.indexOf(Te)<be)Pe._name=be.toString();else{const We=k.indexOf(Te.fName);We>=0&&J[We]>1&&(Pe._cycle=_e[We]++,Pe._keyname=Pe._name,Pe._name=Pe._keyname+";"+Pe._cycle)}}else Pe={_name:be.toString(),_kind:b.prROOT+"NULL",_title:"NULL",_value:"null",_obj:null};N._childs.push(Pe)}return!0}function Y(N,m,I,A){if(void 0===m)return!1;N._childs=[];for(let R=0;R<m.length;++R){const k=m[R];if(b.settings.OnlyLastCycle&&R>0&&k.fName===m[R-1].fName&&k.fCycle<m[R-1].fCycle)continue;const J={_name:k.fName+";"+k.fCycle,_cycle:k.fCycle,_kind:b.prROOT+k.fClassName,_title:k.fTitle+` (size: ${ce(k.fObjlen)})`,_keyname:k.fName,_readobj:null,_parent:N};if(k.fRealName&&(J._realname=k.fRealName+";"+k.fCycle),k.fClassName===ke.Fk||k.fClassName===ke.lZ){const _e=A&&I?I.getDir(A+k.fName):null;_e?(J._name=k.fName,Y(J,_e.fKeys,I,A+k.fName+"/")):(J._more=!0,J._expand=function(be,Te){return Y(be,Te.fKeys)})}else if(k.fClassName===b.clTList&&k.fName===ke.D1){if(b.settings.SkipStreamerInfos)continue;J._name=ke.D1,J._kind=b.prROOT+ke.R0,J._title="List of streamer infos for binary I/O",J._readobj=I.fStreamerInfos}N._childs.push(J)}return!0}function V(N,m,I=void 0){if(!N||null===m)return!1;N._childs=[];let A=Object.prototype.toString.apply(m);if("[object DataView]"===A){let Ke={_parent:N,_name:"size",_value:m.byteLength.toString(),_vclass:"h_value_num"};N._childs.push(Ke);const Ze=m.byteLength<10?1:Math.log10(m.byteLength);for(let Ue=0;Ue<m.byteLength;++Ue){if(Ue%16==0){for(Ke={_parent:N,_name:Ue.toString(),_value:"",_vclass:"h_value_num"};Ke._name.length<Ze;)Ke._name="0"+Ke._name;N._childs.push(Ke)}let Oe=m.getUint8(Ue).toString(16);for(;Oe.length<2;)Oe="0"+Oe;Ke._value&&(Ke._value+=Ue%4==0?" | ":" "),Ke._value+=Oe}return!0}let R=!0,k=!1,J=N;for(;J;){if(J._do_context&&(k=!0),"_nosimple"in J){R=J._nosimple;break}J=J._parent}const _e=(0,b.isArrayProto)(A)>0&&m.length,be=_e&&m.length>b.settings.HierarchyLimit;let Pe,We,dt,Q,Te=!1;if(_e&&"Object"===N._name&&!N._parent&&(N._name="Array"),be){Te=!0;for(let Ke=0;Ke<m.length;++Ke){const Ze=typeof m[Ke];if(!("number"===Ze||"boolean"===Ze||"string"===Ze&&m[Ke].length<16)){Te=!1;break}}}if("_obj"in N?N._obj!==m&&alert("object missmatch"):N._obj=m,N._title||(m._typename?N._title=b.prROOT+m._typename:_e&&(N._title="Array len: "+m.length)),Te){for(let Ke=0;Ke<m.length;){let Ze=Math.min(Ke+10,m.length),Ue=!0,Oe=Ke;for(;Ue;){Ue=!0;for(let gt=Oe;gt<Ze;++gt)m[Ke]!==m[gt]&&(Ue=!1);if(Ue){if(Ze===m.length)break;Oe=Ze,Ze=Math.min(Ze+10,m.length)}else if(Oe!==Ke){Ze=Oe,Ue=!0;break}}const lt={_parent:N,_name:Ke+".."+(Ze-1),_vclass:"h_value_num"};if(Ue)lt._value=m[Ke].toString();else{lt._value="";for(let gt=Ke;gt<Ze;++gt)lt._value+=(gt===Ke?"[ ":", ")+m[gt].toString();lt._value+=" ]"}N._childs.push(lt),Ke=Ze}return!0}for(const Ke in m){if("_typename"===Ke||"$"===Ke[0])continue;const Ze=m[Ke];if((0,b.isFunc)(Ze)||I?.exclude&&I.exclude.indexOf(Ke)>=0)continue;if(be&&Pe){if(dt===Ze){++Q,We=Ke;continue}Q>0&&(Pe._name+=".."+We)}const Ue={_parent:N,_name:Ke};if(be&&(Pe=Ue,We=Ke,dt=Ze,Q=0),null===Ze){Ue._value=Ue._title="null",R||N._childs.push(Ue);continue}let Oe=!1;if((0,b.isObject)(Ze))if(A=Object.prototype.toString.apply(Ze),(0,b.isArrayProto)(A)>0)Ue._title="array len="+Ze.length,Oe="[object Array]"!==A,0===Ze.length?(Ue._value="[ ]",Ue._more=!1):(Ue._value="[...]",Ue._more=!0,Ue._expand=V,Ue._obj=Ze);else if("[object DataView]"===A)Ue._title="DataView len="+Ze.byteLength,Ue._value="[...]",Ue._more=!0,Ue._expand=V,Ue._obj=Ze;else if("[object Date]"===A)Ue._more=!1,Ue._title="Date",Ue._value=Ze.toString(),Ue._vclass="h_value_num";else{(Ze.$kind||Ze._typename)&&(Ue._kind=Ue._title=b.prROOT+(Ze.$kind||Ze._typename)),Ze._typename&&(Ue._title=Ze._typename,k&&(0,ot.Xv)(Ze._typename)&&(Ue._direct_context=!0));let lt=N,gt=!1;for(;lt&&!gt;)gt=lt._obj===Ze,lt=lt._parent;if(gt)Ue._value="{ prnt }",Ue._vclass="h_value_num",Ue._more=!1,Oe=!0;else switch(Ue._obj=Ze,Ue._more=!1,Ze._typename){case b.clTColor:Ue._value=(0,xe.d_)(Ze);break;case b.clTText:case b.clTLatex:Ue._value=Ze.fTitle;break;case b.clTObjString:Ue._value=Ze.fString;break;default:(0,b.isRootCollection)(Ze)&&(0,b.isObject)(Ze.arr)?(Ue._value=Ze.arr.length?"[...]":"[]",Ue._title+=", size:"+Ze.arr.length,Ze.arr.length>0&&(Ue._more=!0)):(Ue._more=!0,Ue._value="{ }")}}else"number"==typeof Ze||"boolean"==typeof Ze?(Oe=!0,Ue._value="fBits"===Ke?"0x"+Ze.toString(16):Ze.toString(),Ue._vclass="h_value_num"):(0,b.isStr)(Ze)?(Oe=!0,Ue._value="&quot;"+Ze.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"&quot;",Ue._vclass="h_value_str"):typeof Ze>"u"?(Oe=!0,Ue._value="undefined",Ue._vclass="h_value_num"):(Oe=!0,alert(`miss ${Ke} type ${typeof Ze}`));(!Oe||!R)&&N._childs.push(Ue)}return be&&Pe&&Q>0&&(Pe._name+=".."+We),!0}function D(N){const m={_name:ke.D1,_childs:[]};for(let I=0;I<N.arr.length;++I){const A=N.arr[I];if(A._typename===b.clTList)continue;if(typeof A.fName>"u"){console.warn(`strange element in StreamerInfo with type ${A._typename}`);continue}const R={_name:`${A.fName};${A.fClassVersion}`,_kind:`class ${A.fName}`,_title:`class:${A.fName} version:${A.fClassVersion} checksum:${A.fCheckSum}`,_icon:"img_class",_childs:[]};if(A.fTitle&&(R._title+="  "+A.fTitle),m._childs.push(R),!(typeof A.fElements>"u")){for(let k=0;k<A.fElements.arr.length;++k){const J=A.fElements.arr[k];if(!J?.fName)continue;let _e=`${J.fTypeName} ${J.fName}`;const be=`${J.fTypeName} type:${J.fType}`;if(1===J.fArrayDim)_e+=`[${J.fArrayLength}]`;else for(let Te=0;Te<J.fArrayDim;++Te)_e+=`[${J.fMaxIndex[Te]}]`;4294967295===J.fBaseVersion?_e+=":-1":void 0!==J.fBaseVersion&&(_e+=`:${J.fBaseVersion}`),_e+=";",J.fTitle&&(_e+=` // ${J.fTitle}`),R._childs.push({_name:_e,_title:be,_kind:J.fTypeName,_icon:"BASE"===J.fTypeName?"img_class":"img_member"})}R._childs.length||delete R._childs}}return m}function w(N,m,I){I?._typename===b.clTList&&(I._typename=ke.R0)}function P(N){const m={_name:"Object",_title:"",_click_action:"expand",_nosimple:!1,_do_context:!0};return(0,b.isStr)(N.fName)&&N.fName&&(m._name=N.fName),(0,b.isStr)(N.fTitle)&&N.fTitle&&(m._title=N.fTitle),N._typename&&(m._title+=`  type:${N._typename}`),(0,b.isRootCollection)(N)?(m._name=N.name||N._typename,le(m,N)):V(m,N),m}function x(N){const m=[];if(!(0,b.isStr)(N)||!(N=N.trim()))return m;if(N.length<2||"["!==N[0]||"]"!==N[N.length-1])return m.push(N),m;let I=0,A=0,R=0,k=1;for(let J=1;J<N.length;++J)if(A>0)"'"===N[J]&&A--;else if(R>0)'"'===N[J]&&R--;else switch(N[J]){case"'":A++;break;case'"':R++;break;case"[":I++;break;case"]":if(J<N.length-1){I--;break}case",":if(0===I){let _e=N.substring(k,J).trim();_e.length>1&&_e[0]===_e[_e.length-1]&&('"'===_e[0]||"'"===_e[0])&&(_e=_e.slice(1,_e.length-1)),m.push(_e),k=J+1}}return 0===m.length&&m.push(N.slice(1,N.length-1).trim()),m}function v(N,m){if(m&&N&&"_childs"in m){for(let I=0;I<m._childs.length;++I)(m._childs[I]._more||m._childs[I]._childs)&&(m._childs[I]._expand=v);return N._childs=m._childs,m._childs=null,!0}return!1}function _(N){return N?.expand||N?.get_expand||N?.expand_item}const C=b.prROOT+b.clTFile;class L extends et.b8{constructor(m,I,A){super(I),this.name=m,this.h=null,this.with_icons=!0,"__as_dark_mode__"===A?this.setBasicColors():this.background=A,this.files_monitoring=!I,this.nobrowser=null===I,(0,Re.gZ)()||(0,Re.kV)(this)}setBasicColors(){this.background=b.settings.DarkMode?"black":"white",this.textcolor=b.settings.DarkMode?"#eee":"#111"}cleanup(){this.clearHierarchy(!0),super.cleanup(),(0,Re.gZ)()===this&&(0,Re.kV)(null)}fileHierarchy(m,I){const A=this;return I||(I={}),I._name=m.fFileName,I._title=(m.fTitle?m.fTitle+", path: ":"")+m.fFullURL+`, size: ${ce(m.fEND)}, modified: ${(0,et.ic)(m.fDatimeM.getDate())}`,I._kind=C,I._file=m,I._fullurl=m.fFullURL,I._localfile=m.fLocalFile,I._had_direct_read=!1,I._get=function(R,k){if(R?._readobj)return Promise.resolve(R._readobj);R&&(k=A.itemFullName(R,this));const J=_e=>(this._file||(this._file=_e),_e?_e.readObject(k).then(be=>{if(!R&&be){const Te=A.findItem({name:k,top:this,last_exists:!0,check_keys:!0});if(void 0!==Te?.last&&Te.last!==this){const Pe=_e.getDir(A.itemFullName(Te.last,this));if(Pe){Te.last._name=Te.last._keyname;const We=A.itemFullName(Te.last,this);Y(Te.last,Pe.fKeys,_e,We+"/")}}else Y(this,_e.fKeys,_e,"");R=A.findItem({name:k,top:this})}return R&&(R._readobj=be,"_expand"in R&&(R._name=R._keyname)),be}):Promise.resolve(null));return this._file?J(this._file):this._localfile?(0,ke.Tq)(this._localfile).then(_e=>J(_e)):this._fullurl?(0,ke.Tq)(this._fullurl).then(_e=>J(_e)):Promise.resolve(null)},Y(I,m.fKeys,m,""),I}forEachItem(m,I){(0,b.isFunc)(m)&&function A(R,k){if(R&&(k&&(R._parent=k),m(R),"_childs"in R))for(let J=0;J<R._childs.length;++J)A(R._childs[J],R)}(I||this.h)}findItem(m){let A=this.h,R="";if((0,b.isStr)(m))R=m,m={};else{if(!(0,b.isObject)(m))return null;R=m.name,"top"in m&&(A=m.top)}return"__top_folder__"===R?A:(0,b.isStr)(R)&&0===R.indexOf("img:")?null:function I(k,J){if(!J||!k)return k;let _e=J.length;if(!k._parent&&k._kind!==Ie&&0===J.indexOf(k._name)){if(J===k._name)return k;const Te=k._name.length;"/"===J[Te]&&(J=J.slice(Te+1),_e=J.length)}function be(Te,Pe){return Pe||(Te._parent=k),_e>=J.length-1||_e<0?Te:I(Te,J.slice(_e+1))}for(;_e>0;){let Te=_e>=J.length?J:J.slice(0,_e);if(k._childs){for(let We=0;We<k._childs.length;++We)if(k._childs[We]._name===Te)return be(k._childs[We]);if(k._kind===Ie&&void 0!==k._childs[0]._online)for(let We=0;We<k._childs[0]._childs.length;++We)if(k._childs[0]._childs[We]._name===Te)return be(k._childs[0]._childs[We],!0);if(m.check_keys){let We=null;for(let dt=0;dt<k._childs.length;++dt)k._childs[dt]._keyname===Te&&(!We||We._cycle<k._childs[dt]._cycle)&&(We=k._childs[dt]);if(We)return be(We)}let Pe=m.allow_index;if("["===Te[0]&&"]"===Te[Te.length-1]&&/^\d+$/.test(Te.slice(1,Te.length-1))&&(Pe=!0,Te=Te.slice(1,Te.length-1)),Pe&&/^\d+$/.test(Te)){const We=parseInt(Te);if(Number.isInteger(We)&&We>=0&&We<k._childs.length)return be(k._childs[We])}}_e=J.lastIndexOf("/",_e-1)}if(m.force){void 0===k._childs&&(k._childs=[]),_e=J.indexOf("/");const Te={_name:_e<0?J:J.slice(0,_e)};return k._childs.push(Te),be(Te)}return m.last_exists?{last:k,rest:J}:null}(A,R)}itemFullName(m,I,A){if(m?._kind===Ie)return"__top_folder__";let R="";for(;m;){if(void 0!==m._online&&!I)return R;if(m===I||m._kind===Ie||A&&!m._parent)break;R&&(R="/"+R),R=m._name+R,m=m._parent}return R}executeCommand(m,I){var A=arguments,R=this;return(0,ve.A)(function*(){const k=R.findItem(m),J=R.getOnlineItemUrl(k)+"/cmd.json",_e=(0,z.Lt)(I),be=[];if("_numargs"in k)for(let Pe=0;Pe<k._numargs;++Pe)be.push(Pe+2<A.length?A[Pe+2]:"");return(0!==be.length&&I?(0,Xe.ES)().then(Pe=>Pe.showCommandArgsDialog(k._name,be)):Promise.resolve(be)).then(Pe=>{if(null===Pe)return!1;let We="";for(let dt=0;dt<Pe.length;++dt)We+=`${dt>0?"&":"?"}arg${dt+1}=${Pe[dt]}`;return _e.empty()||(_e.style("background","yellow"),k._title&&_e.attr("title","Executing "+k._title)),(0,b.httpRequest)(J+We,"text").then(dt=>{if(_e.empty())return dt;const Q=dt&&"false"!==dt?"green":"red";return _e.style("background",Q),k._title&&_e.attr("title",k._title+" lastres="+dt),setTimeout(()=>{_e.style("background",null),k._icon&&_e.classed("jsroot_fastcmd_btn")&&_e.style("background-image",`url('${k._icon}')`)},2e3),"green"===Q&&"_hreload"in k&&R.reload(),"green"===Q&&"_update_item"in k&&R.updateItems(k._update_item.split(";")),dt})})})()}getObject(m,I){var A=this;return(0,ve.A)(function*(){const R={item:null,obj:null};let k,J;if(null===m)return R;if((0,b.isStr)(m)?k=m:(0,b.isObject)(m)&&(void 0!==m._parent&&void 0!==m._name&&void 0!==m._kind?J=m:void 0!==m.name?k=m.name:void 0!==m.arg?k=m.arg:void 0!==m.item&&(J=m.item)),(0,b.isStr)(k)&&0===k.indexOf("img:"))return R.obj={_typename:"TJSImage",fName:k.slice(4)},R;J?k=A.itemFullName(J):J=A.findItem({name:k,allow_index:!0,check_keys:!0});const _e=J?null:A.findItem({name:k,last_exists:!0,check_keys:!0,allow_index:!0});if(null!==_e&&"last"in _e&&null!==_e.last){const Te=A.itemFullName(_e.last);return(0,b.isObject)(m)&&"rest"in m&&(m.rest===_e.rest||m.rest.length<=_e.rest.length)?R:A.expandItem(Te,void 0,"hierarchy_expand_verbose"!==I).then(Pe=>{if(!Pe)return R;let We=A.itemFullName(_e.last);return We&&(We+="/"),A.getObject({name:We+_e.rest,rest:_e.rest},I)})}if(R.item=J,null!==J&&(0,b.isObject)(J._obj))return R.obj=J._obj,R;let be=J;for(;be;){if((0,b.isFunc)(be._get))return be._get(J,null,I).then(Te=>(R.obj=Te,R));be="_parent"in be?be._parent:null}return R})()}isLastSibling(m){if(!m||!m._parent||!m._parent._childs)return!1;const I=m._parent._childs;let A=I.indexOf(m);if(A<0)return!1;for(;++A<I.length;)if(!("_hidden"in I[A]))return!1;return!0}addItemHtml(m,I,A){if(!m||"_hidden"in m)return!0;const R=m===this.h,k="_childs"in m,J=(0,ot.hd)(m._kind),_e=this.itemFullName(m);let dt,be="",Te="",Pe=!1,We=!1;J&&("icon"in J&&(be=J.icon),"icon2"in J&&(Te=J.icon2),!be&&(0,b.isFunc)(J.icon_get)&&(be=J.icon_get(m,this)),((0,ot.Xv)(J)||"execute"in J||"aslink"in J||_(J)&&!1!==m._more)&&(Pe=!0)),"_icon"in m&&(be=m._icon),"_icon2"in m&&(Te=m._icon2),!be&&"_online"in m&&(m._icon=be="img_globe"),!be&&R&&(m._icon=be="img_base"),(m._more||m._expand||m._player||m._can_draw)&&(Pe=!0);let Q=Pe;!Q&&(0,b.isStr)(m._kind)&&0===m._kind.indexOf(b.prROOT)&&(Q=Pe=!0),Te||(Te=be),be||(be=k||m._more?"img_folder":"img_page"),Te||(Te=k||m._more?"img_folderopen":"img_page"),"update"===A?(I.selectAll("*").remove(),dt=I):(dt=I.append("div"),A&&A>=(m._parent._show_limit||b.settings.HierarchyLimit)&&(We=!0)),m._d3cont=dt.node(),dt.attr("item",_e);const Ke=dt.append("div").attr("class","h_line");let Ze=R?null:m._parent;for(;Ze&&Ze!==this.h;)Ke.insert("div",":first-child").attr("class",this.isLastSibling(Ze)?"img_empty":"img_line"),Ze=Ze._parent;let Ue="",Oe=!1;R||(k&&!We?(Ue=m._isopen?"img_minus":"img_plus",Oe=!0):Ue="img_join");const lt=this;if(Ue){(We||this.isLastSibling(m))&&(Ue+="bottom");const yt=Ke.append("div").attr("class",Ue);Oe&&yt.style("cursor","pointer").on("click",function(Kt){lt.tree_click(Kt,this,"plusminus")})}if(this.with_icons&&!We){const yt=m._isopen?Te:be,Kt=0===yt.indexOf("img_")?Ke.append("div").attr("class",yt).attr("title",m._kind):Ke.append("img").attr("src",yt).attr("alt","").attr("title",m._kind).style("vertical-align","top").style("width","18px").style("height","18px");("_icon_click"in m||J&&"icon_click"in J)&&Kt.on("click",function(Ot){lt.tree_click(Ot,this,"icon")})}const gt=Ke.append("a");if((Pe||k||We)&&gt.attr("class","h_item").on("click",function(yt){lt.tree_click(yt,this)}),We)return m._break_point=!0,gt.attr("title","there are "+(m._parent._childs.length-A)+" more items").text("...more..."),!1;"disp_kind"in lt?(b.settings.DragAndDrop&&Pe&&this.enableDrag(gt,_e),b.settings.ContextMenu&&Q&&gt.on("contextmenu",function(yt){lt.tree_contextmenu(yt,this)}),gt.on("mouseover",function(){lt.tree_mouseover(!0,this)}).on("mouseleave",function(){lt.tree_mouseover(!1,this)})):m._direct_context&&b.settings.ContextMenu&&gt.on("contextmenu",function(yt){lt.direct_contextmenu(yt,this)});let ht=m._name,st="";if("_realname"in m&&(ht=m._realname),"_title"in m&&(st=m._title),"_fullname"in m&&(st+="  fullname: "+m._fullname),st||(st=ht),gt.attr("title",st).text(ht+("_value"in m?":":"")).style("background",m._background?m._background:null),"_value"in m){const yt=Ke.append("p");"_vclass"in m&&yt.attr("class",m._vclass),m._isopen||yt.html(m._value)}if(k&&(R||m._isopen)){const yt=dt.append("div").attr("class","h_childs");this.show_overflow&&yt.style("overflow","initial");for(let Kt=0;Kt<m._childs.length;++Kt){const Ot=m._childs[Kt];if(Ot._parent=m,!this.addItemHtml(Ot,yt,Kt))break}}return!0}toggleOpenState(m,I,A){const R=I||this.h;if(void 0===R._childs){if(!m||this.with_icons&&!R._more&&!R._expand&&!this.canExpandItem(R))return!1;const J=this.expandItem(this.itemFullName(R));return(0,b.isPromise)(J)&&(0,b.isObject)(A)&&A.push(J),void 0!==R._childs&&(R._isopen=!0),R._isopen}if(R!==this.h&&m&&!R._isopen)return R._isopen=!0,!0;let k=!1;for(let J=0;J<R._childs.length;++J)this.toggleOpenState(m,R._childs[J],A)&&(k=!0);return R===this.h||m||!R._isopen||k?(I||this.refreshHtml(),!1):(delete R._isopen,!0)}exapndToLevel(m){var I=this;return(0,ve.A)(function*(){if(!m||!Number.isFinite(m)||m<0)return I;const A=[];return I.toggleOpenState(!0,I.h,A),Promise.all(A).then(()=>I.exapndToLevel(m-1))})()}refreshHtml(){var m=this;return(0,ve.A)(function*(){const I=m.selectDom();if(I.empty())return m;I.html("").style("overflow",m.show_overflow?"auto":"hidden").style("display","flex").style("flex-direction","column"),function O(N){function m(k,J,_e,be){return`.jsroot .img_${k} { display: inline-block; height: ${J}px; width: ${J}px; background-image: url("data:image/${_e};base64,${be}"); }`}(0,He.fz)(`\n.jsroot .h_tree { display: block; white-space: nowrap; }\n.jsroot .h_tree * { padding: 0; margin: 0; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; box-sizing: content-box; line-height: 14px }\n.jsroot .h_tree img { border: 0px; vertical-align: middle; }\n.jsroot .h_tree a { text-decoration: none; vertical-align: top; white-space: nowrap; padding: 1px 2px 0px 2px; display: inline-block; margin: 0; }\n.jsroot .h_tree p { font-weight: bold; white-space: nowrap; text-decoration: none; vertical-align: top; white-space: nowrap; padding: 1px 2px 0px 2px; display: inline-block; margin: 0; }\n.jsroot .h_value_str { color: green; }\n.jsroot .h_value_num { color: blue; }\n.jsroot .h_line { height: 18px; display: block; }\n.jsroot .h_button { cursor: pointer; color: blue; text-decoration: underline; }\n.jsroot .h_item { cursor: pointer; }\n.jsroot .h_item:hover { text-decoration: underline; }\n.jsroot .h_childs { overflow: hidden; display: block; }\n.jsroot_fastcmd_btn { height: 32px; width: 32px; display: inline-block; margin: 2px; padding: 2px; background-position: left 2px top 2px;\n                      background-repeat: no-repeat; background-size: 24px 24px; border-color: inherit; }\n.jsroot_inspector { border: 1px solid ${b.settings.DarkMode?"green":"black"}; box-shadow: 1px 1px 2px 2px ${b.settings.DarkMode?"#555":"#aaa"}; opacity: 0.95; background-color: ${b.settings.DarkMode?"black":"#E6E6FA"}; }\n.jsroot_drag_area { background-color: #007fff; }\n${m("minus",18,"gif","R0lGODlhEgASAJEDAIKCgoCAgAAAAP///yH5BAEAAAMALAAAAAASABIAAAInnD+By+2rnpyhWvsizE0zf4CIIpRlgiqaiDosa7zZdU22A9y6u98FADs=")}\n${m("minusbottom",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAImlC+Ay+2rnpygWvsizE0zf4CIEpRlgiqaiDosa7zZdU32jed6XgAAOw==")}\n${m("plus",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAIqlC+Ay+2rnpygWvsizCcczWieAW7BeSaqookfZ4yqU5LZdU06vfe8rysAADs=")}\n${m("plusbottom",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAIplC+Ay+2rnpygWvsizCcczWieAW7BeSaqookfZ4yqU5LZdU36zvd+XwAAOw==")}\n${m("empty",18,"gif","R0lGODlhEgASAJEAAAAAAP///4CAgP///yH5BAEAAAMALAAAAAASABIAAAIPnI+py+0Po5y02ouz3pwXADs=")}\n${m("line",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIZjB+Ay+2rnpwo0uss3kfz7X1XKE5k+ZxoAQA7")}\n${m("join",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIcjB+Ay+2rnpwo0uss3kf5BGocNJZiSZ2opK5BAQA7")}\n${m("joinbottom",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIZjB+Ay+2rnpwo0uss3kf5BGrcSJbmiaZGAQA7")}\n${m("base",18,"gif","R0lGODlhEwASAPcAAPv6/Pn4+mnN/4zf/764x2vO//Dv84HZ/5jl/0ZGmfTz9vLy8lHB/+zr70u+/7S03IODtd7d6c/P0ndqiq/w/4Pb/5SKo/Py9fPy9tTU121kjd/f4MzM062tx5+zy5rO67GwxNDM14d8mJzn/7awwry713zX/9bW27u71lFRmW5uoZ+fxjOy/zm1/9HQ2o3g/2xfgZeMplav7sn9/6Cgv37X/6Dp/3jU/2uJ2M7J1JC63vn5+v38/d7e38PD0Z7o/9LR4LS01cPDzPb1+Nzb5IJ2lHCEv5bk/53C3MrJ3X56t+np6YF7o3JsndTU5Wtgh5GHoKaesuLi4mrO/19RdnnV/4WBqF5QdWPK/4+PvW5uu4+PuuHh4q7w/97e68C9z63w/9PT0+zs7FtbmWVXerS0yaqitpuSqWVlpcL6/8jD0H/C9mVajqWu3nFwpYqHtFfE/42DnaWl0bTz/5OPt+7u7tra5Y+Yz+Tk56fM6Gek5pG50LGpvOHh72LJ/9XU5lbD/6GnwHpujfDu8mxpntzb45qav7PH41+n6JeXyUZGopyYsWeGyDu2/6LQ44re/1yV41TD/8LC1zix/sS/zdTU4Y+gsd/c5L7z+a6uzE+3+XG89L6+087O1sTD3K2twoGBtWVbgomo4P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKMALAAAAAATABIAAAjtAEcJFLgDTyE7SVCsAAJgoMNRYTII8fEpkAckOpiEaPhwlARLexxhmpEGzJEmBAJ0HMXhw6MfXeZQsDHADZ8hK13kMTEAwQgEL2oYiaJgJZFDU24cqHCgSgFGFgysBJAJkB8BBQRggQNJxKCVo0rIcMAgEgMHmnBMaADWEyIWLRptEqWETRG2K//ombSmjRZFoaCo4djRyZ0HchIlSECIRNGVXur0WcAlCJoUoOhcAltpyQIxPSRtGQPhjRkMKyN0krLhBCcaKrJoOCO1I48vi0CU6WDIyhNBKcEGyBEDBpUrZOJQugC2ufPnDwMCADs=")}\n${m("folder",18,"gif","R0lGODlhEgASANUAAPv7++/v79u3UsyZNOTk5MHBwaNxC8KPKre3t55sBrqHIpxqBMmWMb2KJbOBG5lnAdu3cbWCHaBuCMuYM///urB+GMWSLad1D8eUL6ampqVzDbeEH6t5E8iVMMCNKMbGxq58FppoAqh2EKx6FP/Ub//4k+vr6///nP/bdf/kf//viba2tv//////mQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAC4ALAAAAAASABIAAAaRQJdwSCwaj8ik0jUYTBidAEA5YFkplANhehxABGAwpKHYRByVwHBibbvbo8+Q0TrZ7/jWBTHEtP6AgX8GK0MWLSWJiostEoVCBy0qk5SVLQmPLh4tKZ2eny0LmQ0tKKanqC0hmQotJK+wsS0PfEIBZxUgHCIaBhIJCw8ZBUMABAUrycrLBQREAAEm0tPUUktKQQA7")}\n${m("folderopen",18,"gif","R0lGODlhEgASANUAAO/v76VzDfv7+8yZNMHBweTk5JpoAqBuCMuYM8mWMZ5sBpxqBPr7/Le3t///pcaaGvDker2KJc+iJqd1D7B+GOKzQ8KPKqJwCrOBG7WCHbeEH9e4QNq/bP/rhJlnAffwiaampuLBUMmgIf3VcKRyDP/XhLqHIqNxC8iVMMbGxqx6FP/kf//bdf/vievr67a2tv/4k8aaGf//nP//mf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAADUALAAAAAASABIAAAaVwJpwSCwaj8ikUjgYIBIogEA5oFkZDEtheqzKvl9axKTJYCiAIYIGblutqtQwQYPZ73jZpCGM+f+AfiEdJy99M21tMxwxJQeGNTGIeHcyHzEjCpAAki2en54OIhULkAKSMiuqqysOGxIGkDWcMyy2t7YQDx58QqcBwMAkFwcKCwYgBEQFBC/Oz9AEBUUALtbX2FJLSUEAOw==")}\n${m("page",18,"gif","R0lGODlhEgASAOYAAPv7++/v7/j7/+32/8HBweTk5P39/djr/8Df//7///P5/8Ph//T09fn5+YGVw2t0pc7n/15hkFWn7ZOq0nqDsMDA/9nh7YSbyoqo2eTx/5G46pK873N+sPX6//f395Cjy83m/7rd/9jl9m13qGVqmoeh0n+OvI+z5Yyu387T//b6/2dtnvz9/32JtpS/8sbGxv7+/tvn92lwom96rHJ8rnSAsoep3NHp/8nk/7e3t+vr67a2tun1/3V4o+Hw/9vt/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAEEALAAAAAASABIAAAejgEGCg4SFhoeILjaLjDY1AQCHG0AGAA0eDBY1E5CGGjBAoQkCMTUSHwGGJwaiAh0iNbEvhiihAgIDPDwpFRw5hhgsuLk8Pz8HNL+FJSoKuT4+xzczyoQXzjzQxjcgI9WDDrraPzc4OA/fgibZ0eTmCzLpQS0Z7TflCwgr8hT2EOYIQpCQ16OgwYMRCBgqQGCHw4cOCRQwBCCAjosYL3ZCxNFQIAA7")}\n${m("question",18,"gif","R0lGODlhEgASAPelAOP0//7//9bs//n///j//9Ls/8Pn//r//6rB1t3f5crO2N7g5k1livT4+7PW9dXt/+v4/+Xl5LHW9Ov6/+j1/6CyxrfCz9rd5Nzj6un1/Z6ouwcvj8HBzO7+/+3//+Ln7BUuXNHv/6K4y+/9/wEBZvX08snn/19qhufs8fP7/87n/+/t7czr/5q1yk55q97v/3Cfztnu//z//+X6/ypIdMHY7rPc/7fX9cbl/9/h52WHr2yKrd/0/9fw/4KTs9rm75Svzb2+ya690pu92mWJrcT3//H//+Dv/Xym35S216Ouwsvt/3N/mMnZ5gEBcMnq/wEBXs/o/wEBetzw/zdYpTdZpsvP2ClGml2N3b3H0Nzu/2Z2lF1ricrl/93w/97h6JqluktojM/u/+/z9g8pVff4+ebu9q+1xa6/zzdFaIiXr5Wyz0xslrTK4uL//2uIp11rh8Xj/NXn+Oz2/9bf6bG2xAEBePP//1xwkK/K5Nbr/8fp/2OBtG53kai3ykVCYwEBde/6/7O4xabI+fD//+by/x8+jDhZpM/q/6jK58nO19ny/7jV7ZO42NHr/9H4/2ZwimSV6VBxwMDX7Nvf5hYwX5m20sfb6Ieqyk9Yjr/k/cPM2NDp/+/098Tl9yQ9jLfW+Mne8sjU30JklP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKUALAAAAAASABIAAAjxAEsJHEiwoMEyGMaQWthg0xeDAlGUWKjoz5mFAegY/LBiIalMUK54JCWEoJkIpA6kSDmoAykKgRaqGSiq04A5A5r4AKOEAAAtE2S0USAwSwYIhUb8METiUwAvemLMCMVEoIUjAF5MIYXAThUCDzgVWDQJjkA0cngIEHAHCCAqRqJ0QeQoDxeBFS71KKDCwxonhwiZwPEkzo4+AimJqBFCjBs+UjZ4WmLgxhAQVgb6acGIBShJkbAgMSAhCQ1IBTW8sZRI055HDhoRqXQCYo4tDMJgsqGDTJo6EAlyYFNkVJDgBgXBcJEAucEFeC44n04wIAA7")}\n${m("histo1d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEW9vb2np6empqanpqenpqivr6//AAD3+fn09vb19vf3+Pv8+v//+//29/v3+fr19vbZ3Nza3d7X0+Lb3t7b3N3AwMP2+PimpqXe4+Th6uvQ0dTi6uzg5ebFx8nt6vb////r5/T2+fnl4e3a3uDN0NT7/P6lpqX3+vvn9vhcVVHu+//W1uH48//29P///f+mpqelpqb4/v/t/f9oY2H6///59v/x8fXw9fny9/78/v+lpqf7//9iXl12dHPW2t/R1tdtaGbT2dpoZmT6/v9ycnKCgoJpZGJ6dnT3///2///0//95entpa2t+gIKLjI55d3aDgYBvcXL1+/z9/v6lpaWGiIt7fH6Ji42SlJeEhIZubGyMjI17fYD+//+kpKSmpaaRk5WIioyRk5aYmp2OkJJ+f4KTlZilpKWcnqGVl5qcnqCfoaOYmp6PkZOdn6GsrrGoqq6qrK+rrbGpq66lp6uqrbCoqq20tLSsrKzc3NzMzMzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB6enrU4/9iYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmLU4/9KSkoAAAAAAAAAAAB6enrU4//m5uZiYmLm5uZiYmLm5uZiYmLm5uZiYmLm5ubU4/9KSkoAAAAAAAAAAAB6enrU4/9KSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkrU4/9KSkoAAAAAAAAAAABubm7U4//U4//U4//U4//U4//U4//U4//U4//U4//U4//U4/9KSkoAAAAAAAAAAABubm5KSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABt6dBwBYjWHVG2AAAAB3RSTlP///////8AGksDRgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOxJREFUeNpjYGBkggBmFmYmRlY2BkZ2DhDg5OLm4eblY2RjYOIXEBQSFhEFkgKCYkxsDOKcEpJS0jKycvJS8gpcIAFFJWUVGFIFCqipa8hrymtpy+sI6crr6bMxGBgayRvLm8iamkmZW1gCBayslWxs7ewd7OwdlZStrYC2ODm7uLrJu3t4usl7mRiwMeh7+/j6+VsHBMr7+wQFhwAFQsPCIyKjomOiIsOiYuPYGOITEpOSU1LTElNTElPlgQLpGZlZ2Tm5eZm5OZm5IAGm/ILCouKS0rKS4oISeaDDypniEICpgo2hsgoZVLMBAHIaNxuoIXy2AAAAAElFTkSuQmCC")}\n${m("histo2d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAACXBIWXMAAAsSAAALEgHS3X78AAABUUlEQVR42o1R0U7CQBDkU/w/v8qk1/OhCS+88miMiQYMBMNRTqiisQiRhF6h13adsuVKDEYvm81kdmdv9q7V7XallP65I30UrpErLGW73SaiFtDF5dXWmNNITJrubJ4RWUI2qU33GTorAdSJMeMwhOxpEE20noRTYISaajBcMrsdOlkgME+/vILtPw6j+BPg5vZuFRuUgZGX71tc2AjALuYrpWcP/WE1+ADAADMAY/OyFghfpJnlSTCAvLb1YDbJmArC5izwQa0K4g5EdgSbTQKTX8keOC8bgXSWAEbqmbs5BmPF3iyR8I+vdNrhIj3ewzdnlaBeWroCDHBZxWtm9DzaEyU2L8pSCNEI+N76+fVs8rE8fbeRUiWR53kHgWgs6cXbD2OOIScQnji7g7OE2UVZNILflnbrulx/XKfTAfL+OugJgqAShGF4/7/T6/Ug+AYZrx7y3UV8agAAAABJRU5ErkJggg==")}\n${m("histo3d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX////48OjIgTrHfjjKgTr78+yixH9HiQBHiACiw37jvJXfpVP6wzT7zTn7yj3lp1qOhyJzvgCa3wCa3gB2ugBinQ6Pt2D4+vfOjEr96p3986z83mT99rD99a3WhEvC0kaU3gCV3ADG71zo/KORzw1gowBonS3Z5snHfTb6uyD6tzD+/Nb7z0/70D3KdTXI1l3h+qTi+KXD7luU3ACY3gCc4QCi3g1QjwXHfjr710T6xi/+9sn70UH73E/MdDqhvQCi1BKkug2XxACU1wCS2ADD51rr9aJXkw/MpYDgpkb71U7+9MP7007hnEO3niOj0hGq3SCZtQCbtQCjtwj//+7F4Vui0wBDhgDk5eTMxcGxfi3TfTq+fyPPz4ak3xux5TG87kmZuwCZvACWtgDf8a+c0gCy3yNLiwD7/Ps1iwCiyAPF3F7j7bG67EW77kmq5yWYzwCZwwCTugDc8KTE51ve9YZCigCgwgCVuQDa5p7U9YSq4yWT2gCV2wCT2wCp2h/y+9HC6lW87DlChQBGigCixgCYvgDK3nyXvgC72UjG7mSj3xXL7XDK7W7b9J+36TrG9lBDhQBHigClywCbxQDJ33SXvwCYvQCcwADq+8S77Ei460Hd+KDD9VHU/2VEhgBdlR1rowCXwwDK4W6bxgCaxQCVvQDp/L+/8k7F91fn/6zC9V18tiNbkx/U1dSyv6RglihnoQCYwwChyQDs/7/P/2fE92F5tCBdkib19vXW1taoupVLiwNooQCWwADo/7h5tSBFhgaouZXx8vHOz86ftYVJiQBNjQKetIXt7u3Nzs0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBfAAAAAAAAAA2tmA2tmAAACQAAAAAAAAAAAAAAAAAAAAAATgAABNBfMAAAAAAAAA2tpQ2tpQAACQAAAAAAAAAAAAAAAAAAAAAAdQAABNBfMAAAAAAAAA2tsg2tsgAACQAAAAAAAAAAAAAAAAAAAAAAggAABNBfMCaVmCSAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAQVJREFUeNpjYGBkYmZhZWBj5+BkAAMubh5ePn4BQSFhEVExcaCAhKSUtIysnLyCopKyiqqaOoOGppa2jq6evoGhkbGJqZk5g4WllbWNrZ29g6OTs4urmzuDh6eXt4+vn39AYFBwSGhYOENEZFR0TGxcfEJiUnJKalo6A0NGZlZ2Tm5efkFhUXFJqTnQnrLyisqq6prauvqGxqZmoEBLa1t7R2dXd09vX/+EiUCBSZOnTJ02fcbMWbPnzJ03HyiwYOGixUuWLlu+YuWq1WvWAgXWrd+wcdPmTVu2btu+Y/06kHd27tq9Z+++/QcOHtq1E+JBhsNHjh47fuLIYQYEOHnq1EkwAwCuO1brXBOTOwAAAABJRU5ErkJggg==")}\n${m("graph",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AEFCgohaz8VogAAAT9JREFUOMulkz1LQlEYx39XmrIhcLa5i4mD4JBQrtHieDbb+gx3dbl9hca7tLi4VOsRMkKQVO7LLAQNNdSQgyJPg903tDT8w4HzPDznd56Xc1BKCVsokzTGjhPBXDcQAAEZDgPZCHDQaESH5/PYXyqZxp8A349vGHkjOXo3uXtp035sy79KABi8DQCwshb7x3U6gIYU6KNej+1kEwUEjbQeWtIb9mTsOCIgN1eXgiYd96OdcKNBOoCuQc47pFgoGmHw7skZTK9X16CUku5zV9BIkhz4vgSuG/nsWzvKIhmXAah+VpfJsxnGZMKkUln05NwykqOORq6UWkn+TRokXFEG/Vx/45c3fbrnFKjpRVkZgHKxbAC8NptrAfm9PAD2l42VtdJjDDwv2CSLpSaGMgsFc91hpdRFKtNtf6OxLeAbVYSb7ipFh3AAAAAASUVORK5CYII=")}\n${m("mgraph",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEW9vb2np6empqanpqenpqivr68AAAD3+fn09vb19vf3+Pv8+v//+//29/v3+fr19vbZ3Nza3d6/wcLb3t7b3N3AwMPi4et2oz0yfwDh3+n2+PimpqXe4+Th6uvD0NHi6uzg5ebFx8nt6vY2ggDs/881gQDr5/T2+fnFz9DDZVrAIhDEZVvJ0tTN0NTX0+IvZAA4hAAuYgDT0N77/P6lpqX3+vvn9vi/JRL81cHBJhTu+//W1uEkXgD48//29P8fWwD//f+mpqelpqb4/v/t/f+yCwDBKBi3CgD6//8kYAD59v/x8fXQ0dTw9fny9/78/v+lpqf7//+wAADV5ezZ5e7g6PQjZQDf4+/W2t/R1tfT2drT3+OvAAD9///6/v/////k4vIiXwC1AAD3///2///X6Oz0//9+rUgzfwAwdADa6u6xCwDAJxb5///1+/z9/v6lpaUwfADo/8vl4e3a3uDb6eu+IxL808C+IhDZ5+nW2tr+//+kpKSmpaaArUgvewB1oj39/v/e5ebVd227HgvJa2H8///6/PylpKXn4+ze4eLg5+j9/v20tLSsrKzc3NzMzMzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAPAAAAAAEAAAEAAABzL1z/CSMAAAAAAAAAAAAAAAMAAAAmCTsAAAAAAAAAAAAAAAAAAAQAAQEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7op0gAAAAB3RSTlP///////8AGksDRgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOhJREFUeNpjYGBkggBmFmYmRlY2BkZ2DhDg5OLm4eblY2RjYOIXEBQSFhEVE5cQl5RiYmOQ5pSRlZNXUFRSVlFV4wIJqGtoamnr6OrpGxgaGQMFTEzNzC0sraxtbPXs7B0c2RicnF1c3dw9PL28fXz9/IECAYFBwSGhYeERkVHRMYEBQFti4+ITEuOTklNSg9I8nNgYHOPTMzLjA7Oyc7Jz8/ILQAKFRRnFJaVl5RWVVdU1bAy18XX1DfGNTc0trW3t8UCBjvj4+M746q74+O7qHpAAUzwyADqsl6kGAZj62Bj6JyCDiWwAyPNF46u5fYIAAAAASUVORK5CYII=")}\n${m("tree",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAACjklEQVQ4y4WTy49LcRzFP+2tzmVUr9dIDJOWGGVBicgEyTQTCzIetUFssDKJSFhY2SARCYvBbGrj8QcIkYglk8xCmEQ9xqNexbQVY2Zub3un9/W7PwstHZH4Jie/7+Kc8/suzgnwr+kjBqSBbm2lkm6bHyH3XM9SZQ8Z8s3UQJPo0IJVof5EZ7v2faxMrKONlhmQWN5GSFEwLbhybjBPhDwVsmQ4AaA09Mou+k8d702EAzXiS6KEgzahoIthGOi6DtKlN71GS+/cEPs0WewaX2R9ZphssP776UhESY0WSpQNg7Jh4Anx+zgJVKpV3uZyvHjzir27NwGs/XVBH8c7N2nnjx7eSqlYxPM8JCCkxBU+rhA4dVhCYJgmyc4Ej96/7rLi8nNAPc/k2ZNp7cnTpziuiy8lvpSI+tvYhS/xpY8vJXMiEbZv3MzFq3cJqaqiPX72jnKt9kfQRPZ9f5qZ70sMawyAas1GseIy1rNtVXK8Mkm1VsP2PBzhYQuB5Qns+t6AJQSqqlIcrTAy+ONGENBWLF3MN71MxXGo1mE6DqbrYLou8z/a7L3uMKvgUnU8xk2T3u71ADGFDdgvCx/3TwkLEfKxhWDHbY+eYZ+Obz6tJcmRApRsuJ8Ex4Po7Jl8/TDBl7flm4Gm5F1vSZKaFQUh4cB9OLgaDB3UVrjwA+6tBnKAis4El8lwujmJSVQeoKAxFzqDcG0KWhZC6R30tUJRQD3Odxqy4G+DDFks4pisY5RLgRx5pZ5T4cKy95yhSrxZDBCaVqIMOpAd2EIeSEW7wLQh3Ar7RtCHbk0v0vQy1WdgCymgf147Sa0dhAOVMZgoALDu2BDZ/xloQAzQgIOhMCnPYQ+gHRvi4d/8n00kYDRVLifLAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDEwLTAyLTExVDE0OjUxOjE3LTA2OjAwHh/NoQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAwNC0wOS0yMFQxNzoxMDoyNi0wNTowMCcJijsAAAAASUVORK5CYII=")}\n${m("branch",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX///99plFAfADL27hpmyfP8YxyoilSiRiv0XGGygK02VtRiBmVwjh8xQCcziFZkhLz9+9BfQB2rwaCyACRygFQigXw9Ox0mkpXkQCJzwBblgBmkzP8/fxEgQBCfwBEgQejwITe3t5hkC1CfgBfjynZ2tmSq3eArDu72oNvoDJajyTY2dhFgQDCzLqhvn9EgAazx55XkwCVzC2824GMs1J0oUTY48xajiK72YR9qj2Tq3dhkix+th99xAB3uADA3oQ+fABEgABIgwW82oOUyi5VkgCf0CaEygB+wwCbzjN1mkrA3YZ1tAB7wAB+uB1vl0JdmgCJwwCKzwBoqAB4nVBikiuayzZ8wQCFywCg0Sjd3t1lkjFBfABLgwhKgwlmpgCK0QCJxQBclwDMzMzPz89GggCDpFxDfgCIpmPl5eUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABhAABQEABuZQBjYQBvcgAIZABiYQBlZAAABQDU/wCx/wCO/wBr/wBI/wAl/wAA/wAA3AAAuQAAlgAAcwAAUADU/wCx/wCO/wBr/wBI/wAl/wAA/gAA3AAAuQAAlgAAcwAAUADj/wDH/wCr/wCP/wBz/wBX/wBV/wBJ3AA9uQAxlgAlcwAZUADw/wDi/wDU/wDG/wC4/wCq/wCq/wCS3AB6uQBilgBKcwAyUAD//wD//wD//wD//wD//wD//wD+/gDc3AC5uQCWlgBzcwBQUAD/8AD/4gD/1AD/xgD/uAD/qgD/qgDckgC5egCWYgBzSgBQMgD/4wD/xwD/qwD/jwD/cwD/VwD/VQDcSQC5PQCWMQBzJQBQGQD/1AD/sQD/jgD/awD/SAD/JQD+AADcAAC5AACWAABzAABQAAD/1AD/sQD/jgD/awD/SAD/JQD/AADcAACwULzWAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAALZJREFUeNpjYAADRiZGBmTAzMLKxowswM7BycWNLMDEw8vHL4AkICgkLCIqhiQgLiEpJS0D5cjKySsoKimrqMJk1dQ1NLW0dXQZ9PTlZEECBoZGxiamOmbmmhaWViABaxtbO3sHRycTZxdXA7ANbu4enkxeDt4+vn7WIAH/gMCg4JBQprDwiEhBkEBUtGBMrI5OXHxCYpI/2BrV5OSU5NS09BjB6CiE01JTM5KTVZHcmpycCWEAANfrHJleKislAAAAAElFTkSuQmCC")}\n${m("leaf",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX////M27mQs2tilDA9eQA7egBbkhVTjAxJgwWBqVdGgQBrnySdxViu0WrE4oaYv2PC35NtoCqxvaSevX5FgAB7qje73nDK6neu109vpyVupCGo2kJ9xwBQhBtilC9pnx7G63PM6olgnAB/vQBDigCVv0yb1CaDzAB8uBJwmkNnnBnB52ui2Ca94WZopAE/hgCtz2ue2CmDywCByACKujtdjyqdvHpdlhLV9YdkowCFxwCw1lFXmAJvpC5jng1coABlpwBprAB8sitAfABDfgKx31Gr3TuCsi5sqABtqgBUkxTV85zL7I213mef0j+OxyKk00k/ewCp3TCSyhCw0mRRjQC23HmU0h55wQB5vQB4uQB1tgCIwBeJxgCBvQDC3ndCjACYx1204Fx6wwB7vQB1tABzsQBBfQBpkzdtpQB9tQA/iQCMu1SMukNUlQBYmQBsqAd4rh11rwZyrQBvqgBDfwCqvZVWkQBUnACp0Hq/43K733C+4X+w12eZyT2IvSN5sgpZkwBxmUSDqFlbnACJzQy742p/wwB2ugBysgBwrwBvqwBwqQBhmgBCfwDV2NN8pk1foACO1QBZmABRkABpqwB3uQB0sgB0rgBnogBUjgC7w7NymkFdnQBUhxmis41okjdCfgBGgQWHpWPMzMzb3NtumD5NhQzT09Pv8O/a2trOz87l5eXc3NzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtHAA4HXQAAEgAAB9CTigAAABCfCQ4HTxy6Kw4HXRy+8xy+8wAAMwAAAAAAAAAAAAAAAAAAAAAAAgAAAgAABgYAAG7AAAAACgAAAgAAAgYAAEAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4Hnw4HnwAAFRpRiYmO2V0aWRtSSY7ZWdsZVNpdGNBO251amRGO3R0bCYmO3J3ZWlvVCY7c2xuaVc7d28ABCwBG8q3AAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOtJREFUeNpjYIACRiZmFlY2dg4ol5OLm4eXj19AUAjMFRYRFROXkJSSlpEF8+XkFRSVlFVU1dQ1NMF8LW0dXT19A0MjYxNTIN/M3MLSytrG1s7ewdHJGSjg4urm7uHp5e3j6+cfABIIDAoOCVUJC4+IjIqOAQk4x8bFJyQmJadEpaalpQMFMjKzsnNy8/ILCouKS0qBAmXlFZVV1TW1dfUNJY1NQIHmlta29o7ozq7unt6+fgaGCRMnTZ4ydVrU9BkzZ5XOBiqYM3HuvPkL0tPTFy5avATkzqXLlq9YuWoJEKxeA/Ho2nUMyAAA9OtDOfv2TiUAAAAASUVORK5CYII=")}\n${m("leaf_method",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAKlBMVEUAAAAAgADzExMAgIAAAADAwMCAgADxGRnuFxLnHhHuIyPKJQ/rLi7////aW8ZOAAAAAXRSTlMAQObYZgAAAAFiS0dEDfa0YfUAAAAHdElNRQfgCxIPFR/msbP7AAAAaUlEQVQI12NggANBBiYFMMNQxAjCYA4UUoZIBRpBGMyiQorGIIaxWRCEwSYo3igiCNJlaLkwGSwkJn1QGMhgNDQ0TDU2dACqERYTDksGG5SkmGoApBnFhBRTBUAiaYJpDIJgs10cGBgdACxbDamu76Z5AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE3LTAxLTE3VDA5OjMwOjM1KzAxOjAwyGHxKQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0xOFQxNToyMTozMSswMTowMJgvuUkAAAAASUVORK5CYII=")}\n${m("globe",18,"gif","R0lGODlhEwASAPcAAPr7/AFyAQFCpwGD6jy3/wE9on7N0AE+pAFjyMLI0AE2mwF94wGP9QFpzgU3nISSopWgrmJsfTNLfgFHqAFuBilNiTp4sLnGzwWb/0xYb/P09mRygGl0hRlnMgR12V2Pr6e4xF9peS2Cyh5FpBdSfgF84YmisdPa30hjvw+foQFYvlWj4HWIlkWb5gk5n/b4+gw+kgFMscXb6ylmieDj5ju2pylTsniElgqd/u/x8wGW/O7v8SVMsUq+JSSJXQFiwfv+/AFqvB9ntobZeKbc/9vt+B+YmW2rvKruzQGPkm3PPrjmxQFIklrFLVbD4QGMYaXkoIPD13LC+nGw5AGFQHG66gF2eBaJxket9sLf84HI+wF7axBdbg2c0CR+1QFsEIfJ7yqoUIbH41tldgF+KzVTjn3QfitZgTJZkaDR8gKDsXeWrE+zogE3nCeKzQFtJ0tknjdnbQGB6EJgxQFqAcLJ0WC//yKm/wE+o7vI0ARozEOz/4/g/4KToyaX4/D09pCpuNHV24HA6gw7oAF/AXWKnEVSb5TI6VzDTrPprxBQts7e6FNdcBA9oySd9RRjPAhnD2NvgIydrF+6wdLo9v7//2K+twKSdDmKyeD56wGCyHq12VnF+ZXXsARdTjZWthShoo7gtilDlAFw1RCXvF+z6p/R8kqZzAF0Oj5jjFuJqgFoAkRgxtzr9YmcrJKsugFlylfBgxJGhjJIeFnFuhmi/+bo65ipt8Hn+UhVco7B5SZowAGBKoaZqAGGAVHBUwF8Qq7Y819qe4DEoVyYwrnb8QGN9GCy6QFTuHB9jgGY/gFRtuTu9ZOhr150iwFbwTFiwFus4h9mYt/y+kWZ35vM7hGfccz43Xy/6m3BuS1GiYveqDRfwnbUV4rdu////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAN8ALAAAAAATABIAAAj/AL8JHEiwVTVspar8ITiwiJhswyaBibJJUq9Trxh+S2OAVihvSzqRcoTpmy5ADIPFqrHtGpBETbrIuXJEBgiGbHoogTItExJOoAbw8rHmAkFTC8KYwTWkGx8COp4AozAjD8Epo4wQQfTLCQEcxqigoiONBUFqerRYspYCgzIGmgi98cRlA8EVLaR4UJPk0oASVgKs6kAiBMFDdrzAarDFF5kgCJA9ilNBGMFjWAQse/YjwBcVMfCcgTMr2UBKe0QIaHNgAiQmBRS4+CSKEYSBWe44E6JoEAxZDhrxmDPCEAcaA4vVinTCwi5uKFhBs6EtQ4QEOQYy8+NGUDRiqdCUJJGQa8yNQDsADHyxSNUHE4Vc3erzoFkdWxoAVNLIv7///98EBAA7")}\n${m("canvas",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX/AAC1t7etsLCsrq6rrq6rrq2tr6+0tratsK/////p6enIysrl5OTn5uXo5+ajpaXo5+dhhKdliKlmialgg6elp6f6+/vIycnr7Ozw7u7x7u7x7u3t6+vLzMvp7vbs7/bz8PD17+3z7u2rrq/6xS76xy13zv9+z/+EwLF4zP/38/NfgqWAoL36uCj6vCmR2f+TxamSrBmNvoj++fz8+Pf69/WZ3f+g4P+n4/+Cnw2Dox16nQ3//f9hg6eBob6x5/+46f+77P+p2NKSZhOi1s////7//fusrq98sB6CsyWDtSmFuC9+dBl/tilfgqasr6+sr7DbAADcAABcgqWAoLyusLC4urqssLCssLGrsLCrr7Ctr67c3NzMzMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoAAAKAgJldmV0dU8GB3JvTnZDBWVyb2xsYwdjYWxhUBB0bmVrY2F1b3IICGRPYmFyZWQAAAXj1P/Hsf+rjv+Pa/9zSP9XJf9VAP9JANw9ALkxAJYlAHMZAFDU1P+xsf+Ojv9ra/9ISP8lJf8AAP4AANwAALkAAJYAAHMAAFDU4/+xx/+Oq/9rj/9Ic/8lV/8AVf8ASdwAPbkAMZYAJXMAGVDU8P+x4v+O1P9rxv9IuP8lqv8Aqv8AktwAerkAYpYASnMAMlDU//+x//+O//9r//9I//8l//8A/v4A3NwAubkAlpYAc3MAUFDU//Cx/+KO/9Rr/8ZI/7gl/6oA/6oA3JIAuXoAlmIAc0oAUDLU/+Ox/8eO/6tr/49I/3Ml/1cA/1UA3EkAuT0AljEAcyUAUBnU/9Sx/7GO/45r/2tI/0gl/yUA/gAA3AAAuQAAlgAAcwAAUADj/9TH/7Gr/46P/2tz/0hX/yVV/wBJ3AAQ+AFLAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAALpJREFUeNpjYGBkYmZhYWFlYWNngAAOTijg4oYIMHPy8PLx8nDycwpwQwUEhYSFRDhFxTi5xCECEpJS0jKcsqL8nGwgARZOOXkFRSWwMcwgAWVOFVU1dQ1NLW0dmICunr6BoZGxiSlEgJnTzNzC0sraxtYOJmDv4Ojk7MLp6gYRcOf08PTy9vHl9IOa4c+JAGCBAM7AoEDOwEDO4BCIABOSilCQQBhTeERkVGS4f3R0aBhIICYWAWIYGAClIBsa7hXG7gAAAABJRU5ErkJggg==")}\n${m("profile",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVR42o1R22rCQBD1U/p//apCNtsHwRdfBaFIKbRoUVKMMTWBWIxVCq2b+07POrn4UKjDMpw9O2fm7G5vNBpJKe2/Qto4uEc2WMrBYEBEPaAky36UulwnlSRpUeZEBSGrpEiyHJVGAPVJqZvbO3ftv83Dle+vvPV4/LD0PGYAcKrSFJUsEOgHKoj3s9dFGH9uou3k8ekQKxyDQcYpBnYC7Hm9zBZmlL8BiIJDC0AWpa4FwhZJXoDCBgYAjgU5ToBt+k1tL14ssFNNvIEBAFwVljJlSDBfpwyg1ISnYoEsiHju5XLcd+T50q0tEQm7eaWKKNfUWgKApUsbPFY0lzY6DraEZm585Do/CLMzqLQWQnSC9k34lVa7PTsBs/zYOa4LB5ZlnQXCbif40Ra50jUwE6JtCcMlUiMQlugEQYisG8CWtGlRdQL+jmui/rjhcAhk/Reo6ff7RuB53vN1MZ1OIfgFQC1cuR3Y6lIAAAAASUVORK5CYII=")}\n${m("execute",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEXAwMAAxwCvbOAvAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAACBJREFUCFtjYIABHgYGfiA6wMD/gYH/B5g8ABLhYUAGAHniBNrUPuoHAAAAAElFTkSuQmCC")}\n${m("file",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAAA2klEQVRIx61VURbDIAgTX+9ljg4n2z5sNouj1ml+LE9rQkSU5PA6kTZBToTznj5aqKqq+py4lFJKScnMzCwlAAB6IbnNuyXycd1g3oHrf32CmR9mZqpVOdDHs2DmI+c+AiJixu1RAN9xFUcdWCjVIr8xCX8Jubc8Ao9CJF8nRFgNJBxZSCEkjmrIxxSS0yIAoBU4OkpfU8sCPEbEvqaOXcR31zWORbYJ8EI8rsK+DWm7gMVb8F/GK7eg6818jNjJZjMn0agY7x6oxqL5sWbIbhLHoQN78PQ5F3kDgX8u9tphBfoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMDItMDZUMTA6Mjc6MzErMDE6MDChLu/mAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjIwKzAxOjAwIGvf8wAAAABJRU5ErkJggg==")}\n${m("text",16,"gif","R0lGODlhEgASALMAAP/////MzP+Zmf9mZv8zM/8AAMzM/8zMzJmZ/5mZmWZm/2ZmZjMz/zMzMwAA/////yH5BAUUAA8ALAAAAAASABIAAARo8MlJq73SKGSwdSDjUQoIjhNYOujDnGAnFXRBZKoBIpMw1ICHaaigBAq/AUK1CVEIhcfPNFlRbAEBEvWr0VDYQLYgkCQWh8XiAfgRymPyoTFRa2uPO009maP8ZmsjAHxnBygLDQ1zihEAOw==")}\n${m("task",18,"png","iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAAAAACMfPpKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAATklEQVQY05XQUQoAIAgD0N3JY3fIChWttKR9xYvBCj0J0FsI3VVKQflwV22J0oyo3LOCc6pHW4dqi56v2CebbpMLtcmr+uTizz6UYpBnADSS8gvhaL5WAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTA0LTA3VDA5OjQyOjQ4KzAyOjAwMgzRmQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOCswMTowMJ0LlncAAAAASUVORK5CYII=")}\n${m("pavetext",18,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAsSURBVBjTY2CgCuBAAt1gASS5KKgARBpJACSEooIsARRbkABYoDsKCRDhEQBA2Am/6OrPewAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wMS0wNFQxMDoxODoyNyswMTowMHsz6UQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MjArMDE6MDAga9/zAAAAAElFTkSuQmCC")}\n${m("pavelabel",18,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAApSURBVBjTY2CgCuBAAt1gASS5KJgABzUEgABFANUWJAAWYIhCAkR4BAAHoAkEyi2U3wAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wMS0wNFQxMDoxODoyNyswMTowMHsz6UQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MjArMDE6MDAga9/zAAAAAElFTkSuQmCC")}\n${m("list",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AEECTc01vBgywAAAE9JREFUOMu1k8ERwDAMwqRc9l/Z/eeRpKZlABkOLFD0JQGgAAah5kp8Y30F2HEwDhGTCG6tX5yqtAV/acEdwHQHl0Y8RbA7pLIxRPziGyM9xLEOKSpp/5AAAAAASUVORK5CYII=")}\n${m("color",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAM1BMVEUAAAAA4xcavGZGS1xZT79lW+9wdvFz/3N6fo3RISTZwXbyniXz80v/AAD/zAD/66v//6vGWiYeAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADswAAA7MAbGhBn4AAAAHdElNRQfgAQQLLBhOmhPcAAAAIklEQVQY02NgRgEMDAzMnLzcfDwC7IxMbKwsQ10A3XMEAQA3JQVNowlkTAAAAABJRU5ErkJggg==")}\n${m("colz",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEV6fo0A4xcavGZGS1xZT79lW+9wdvFz/3PRISTZwXbyniXz80v/AAD/zAD/66v//6t1AkcGAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADswAAA7MAbGhBn4AAAAHdElNRQfgAQQLNwdqpNWzAAAAT0lEQVQI12NgYGAwNjZmAAOLjmY0hs2ZwxCG1arFEIbt3csQhvXuzRCG/f/PEIZ5eTGEYSgoDGEYKSlDGGZpyRCGaWgwhGHi4gxhwG0HAwCr3BFWzqCkcAAAAABJRU5ErkJggg==")}\n${m("frame",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfgAQQLOwq4oOYCAAAAcUlEQVQoz7WQMQqAMAxFX0Uk4OLgIbp4oZ7BA/cOXR0KDnGpRbGayT+EQF74nw+GHIBo+5hdWdqAaFDoLIsegCSeWE0VcMxXYM6xvmiZSYDTooSR4WlxzzBZwGYBuwWs4mWUpVHJe1H9F1J7yC4ov+kAkTYXFCNzDrEAAAAASUVORK5CYII=")}\n${m("class",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAvQC9AL1pQtWoAAAAjUlEQVR42p2T2wnAIAxFM0g/O6jDdBBHcAyHKKQYjfiI0UY4P8I9BG4CID8smB4+8SUsohpO3CFzKqmBFrhCO4kqQnCR6MJF4BEJTVQFhBAmASNIZkH6a0OMc8oUDAu8z7RhTTBVyIIEhxeCdYWjQApvK2TBrgGpwpP1livsBXC0ROMO/LqDKjKEzaf8AZWbJP6pTT9BAAAATHpUWHRTb2Z0d2FyZQAAeNpz0FDW9MxNTE/1TUzPTM5WMNEz0jNQsLTUNzDWNzBUSC7KLC6pdMitLC7JTNZLLdZLKS3IzyvRS87PBQDzvxJ8u4pLSgAAADN6VFh0U2lnbmF0dXJlAAB42ktKs0hLMkk2MzJKNEuzMLKwtEizSElMMbNITUw0NUtNAQCc7Qma0Goe1QAAAABJRU5ErkJggg==")}\n${m("member",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAvQC9AL1pQtWoAAAAX0lEQVR42mNgAAIVBob/+DADPgBS8GCPBV6M1xCKDcDnBRcoZhgW4D8DBV75v2bLATAmxyC4ZmRMrCFYNfeU9BBvwJwpS8AYWTNZBoAwTDPFBpAciDCDyNFMtXSAFwAAUyq0GRPbbz4AAABMelRYdFNvZnR3YXJlAAB42nPQUNb0zE1MT/VNTM9MzlYw0TPSM1CwtNQ3MNY3MFRILsosLql0yK0sLslM1kst1kspLcjPK9FLzs8FAPO/Eny7iktKAAAAM3pUWHRTaWduYXR1cmUAAHjaS01JNrE0S00zSbU0NEsxMbMwM0xOSjYwNzY3NLRIMjUCAJcdCJ2BHe6SAAAAAElFTkSuQmCC")}\n${m("tf1",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADFBMVEX/////AP8/SMz///+Cf5VqAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfgCw4QHgSCla+2AAAAL0lEQVQI12MQYAACrAQXiFBoABINCgwMQgwcDAwSDEwMDKmhodMYJjAwaKDrAAEAoRAEjHDJ/uQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMTEtMTRUMTc6Mjk6MjErMDE6MDDxcSccAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE2LTExLTE0VDE3OjI5OjA1KzAxOjAwNka8zgAAAABJRU5ErkJggg==")}\n${m("tf2",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADFBMVEX/////AP8A/wD////pL6WoAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfgCw4PNgzGaW1jAAAARUlEQVQI12NgEGDQZAASKkBigQKQ6GhgYBDiYgASIiAigIGBS8iBgUFhEpCnoAEkUkNDQxkagUIMrUDMMAVETAARQI0MAD5GCJ7tAr1aAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTExLTE0VDE2OjUxOjUzKzAxOjAwi1Gz3gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0xNFQxNjo1MTozNiswMTowMG5bLUIAAAAASUVORK5CYII=")}\n`,N,"jsroot_hstyle")}(I.node());const A=m,R=[];let k=null;if(m.forEachItem(be=>{delete be._d3cont,"_fastcmd"in be&&"Command"===be._kind&&R.push(be),"_status"in be&&!k&&(k=be)}),!m.h||I.empty())return m;if(R.length){const be=I.append("div").attr("style","display: inline; vertical-align: middle; white-space: nowrap;");for(let Te=0;Te<R.length;++Te){const Pe=be.append("button").text("").attr("class","jsroot_fastcmd_btn").attr("item",m.itemFullName(R[Te])).attr("title",R[Te]._title).on("click",function(){A.executeCommand((0,z.Lt)(this).attr("item"),this)});R[Te]._icon&&Pe.style("background-image",`url('${R[Te]._icon}')`)}}const J=I.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);J.append("a").attr("class","h_button").text("expand all").attr("title","expand all items in the browser").on("click",()=>m.toggleOpenState(!0)),J.append("text").text(" | "),J.append("a").attr("class","h_button").text("collapse all").attr("title","collapse all items in the browser").on("click",()=>m.toggleOpenState(!1)),(0,b.isFunc)(m.removeInspector)&&(J.append("text").text(" | "),J.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",()=>m.removeInspector())),"_online"in m.h&&(J.append("text").text(" | "),J.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",()=>m.reload())),"disp_kind"in m&&(J.append("text").text(" | "),J.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",()=>m.clearHierarchy(!1)));const _e=I.append("div").attr("class","jsroot").style("font-size",m.with_icons?"12px":"15px").style("flex","1");if(m.show_overflow||_e.style("overflow","auto"),m.background&&_e.style("background-color",m.background).style("margin","2px").style("padding","2px"),m.textcolor&&_e.style("color",m.textcolor),m.addItemHtml(m.h,_e.append("div").attr("class","h_tree")),m.setTopPainter(),k&&!m.status_disabled&&!(0,b.decodeUrl)().has("nostatus")){const be=(0,b.findFunction)(k._status);if((0,b.isFunc)(be))return m.createStatusLine().then(Te=>{Te&&be(Te,m.itemFullName(k))})}return m})()}updateTreeNode(m,I){if(void 0===I||I.empty()){I=(0,z.Lt)(m._d3cont?m._d3cont:null);const A=this.itemFullName(m);if(I.empty()&&(I=this.selectDom().select(`[item='${A}']`)),I.empty()&&"_cycle"in m&&(I=this.selectDom().select(`[item='${A};${m._cycle}']`)),I.empty())return}this.addItemHtml(m,I,"update"),this.brlayout?.adjustBrowserSize(!0)}updateBackground(m,I){if(!m||!m._d3cont)return;const A=(0,z.Lt)(m._d3cont);if(A.empty())return;const R=A.select(".h_item");R.style("background",m._background?m._background:null),I&&m._background&&R.node().scrollIntoView(!1)}focusOnItem(m){var I=this;return(0,ve.A)(function*(){(0,b.isStr)(m)&&(m=I.findItem(m));const A=m?I.itemFullName(m):"";if(!A)return!1;let R=m,k=!1;for(;R;)void 0!==R._childs&&!R._isopen&&(R._isopen=!0,k=!0),R=R._parent;return(k?I.refreshHtml():Promise.resolve(!0)).then(()=>{const _e=I.selectDom().select(`[item='${A}']`);return!_e.empty()&&(_e.node().scrollIntoView(),!0)})})()}tree_click(m,I,A){if(!I)return;const R=(0,z.Lt)(I.parentNode.parentNode),k=R.attr("item"),J=k?this.findItem(k):null;if(!J)return;if(J._break_point){delete J._break_point,this.addItemHtml(J,R,"update");const dt=J._parent,Q=dt._childs.indexOf(J),Ke=(0,z.Lt)(R.node().parentNode);if(Q<0)return console.error("internal error");dt._show_limit=2*(dt._show_limit||b.settings.HierarchyLimit);for(let Ze=Q+1;Ze<dt._childs.length;++Ze){const Ue=dt._childs[Ze];if(Ue._parent=dt,!this.addItemHtml(Ue,Ke,Ze))break}return}let be,_e=J;for(;_e&&void 0===(be=_e._click_action);)_e=_e._parent;A||(A="item");const Pe=(0,ot.iO)(J._kind,J._kind===b.prROOT+b.clTKey&&J._more?"noinspect":""),We=Pe.handle;if("icon"===A){let dt=null;return(0,b.isFunc)(J._icon_click)?dt=J._icon_click:(0,b.isFunc)(We?.icon_click)&&(dt=We.icon_click),void(dt&&dt(J,this)&&this.updateTreeNode(J,R))}if("item"===A&&"_expand"in J&&!m.ctrlKey&&!m.shiftKey&&(A="plusminus"),"plusminus"===A&&!("_childs"in J)&&J._more||"item"===A&&"expand"===be)return this.expandItem(k,R);if("item"===A){if(J._player)return this.player(k);if(We?.aslink)return window.open(k+"/");if(We?.execute)return this.executeCommand(k,I.parentNode);if(We?.ignore_online&&this.isOnlineItem(J))return;const dt="expand"===this.default_by_click;let Q=J._can_draw,Ke=J._more,Ze="";if(m.shiftKey&&(Ze=We?.shift||b.kInspect,(0,b.isStr)(Ze)&&0===Ze.indexOf(b.kInspect)&&We?.noinspect&&(Ze="")),m.ctrlKey&&We?.ctrl&&(Ze=We.ctrl),!Ze&&!We?.always_draw)for(let Ue=J._parent;Ue;Ue=Ue._parent)if(Ue._painter){Q=!1,void 0===Ke&&(Ke=!1);break}if(J._childs&&(Ke=!1),void 0===Q&&(Q=Pe.draw),void 0===Ke&&(Ke=Pe.expand||Pe.get_expand),Q&&Ke&&!Ze&&(dt||"expand"===We?.dflt||We?.exapnd_after_draw&&this.isItemDisplayed(k))&&(Q=!1),Q&&!Ze&&(Ze="__default_draw_option__"),Q)return this.display(k,Ze,!0);if(Ke||dt)return this.expandItem(k,R);if((0,b.isStr)(J._kind)&&0===J._kind.indexOf(b.prROOT)&&Pe.inspect&&!1!==Q)return this.display(k,b.kInspect,!0);if(!J._childs||J===this.h)return}J._isopen?delete J._isopen:J._isopen=!0,this.updateTreeNode(J,R)}tree_mouseover(m,I){const A=(0,z.Lt)(I.parentNode.parentNode).attr("item"),R=this.findItem(A);if(!R)return;let k,J=R;for(;J&&!k;)k=J._painter,J=J._parent;(0,b.isFunc)(k?.mouseOverHierarchy)&&k.mouseOverHierarchy(m,A,R)}direct_contextmenu(m,I){m.preventDefault();const A=(0,z.Lt)(I.parentNode.parentNode).attr("item"),R=this.findItem(A);R&&(0,b.isFunc)(this.fill_context)&&(0,Xe.ES)(m,this).then(k=>{this.fill_context(k,R),k.size()>0&&(k.tree_node=I.parentNode,k.show())})}fillSettingsMenu(m,I){m.addSettingsMenu(!0,I,A=>{"refresh"===A?(this.forEachRootFile(R=>Y(R,R._file.fKeys,R._file,"")),this.refreshHtml()):"dark"===A?this.changeDarkMode():"width"===A&&this.brlayout?.adjustSeparators(b.settings.BrowserWidth,null)})}changeDarkMode(){this.textcolor&&(this.setBasicColors(),this.refreshHtml()),this.brlayout?.createStyle(),this.createButtons(),(0,b.isFunc)(this.disp?.changeDarkMode)&&this.disp.changeDarkMode(),this.disp?.forEachFrame(m=>{let I=(0,Je.m6)(m);I||(I=(0,Je.Nn)(m)),(0,b.isFunc)(I?.changeDarkMode)&&I!==this&&I.changeDarkMode()})}toggleDarkMode(){b.settings.DarkMode=!b.settings.DarkMode,this.changeDarkMode()}tree_contextmenu(m,I){m.preventDefault();const A=(0,z.Lt)(I.parentNode.parentNode).attr("item"),R=this.findItem(A);if(!R)return;const k=this.getOnlineProp(A),J=this.getFileProp(A);return(0,Xe.ES)(m,this).then(be=>{if(A&&R._parent||"_jsonfile"in R)if(k)this.fillOnlineMenu(be,k,A);else{const Te=(0,ot.iO)(R._kind,"nosame");if(R._can_draw&&(Te.opts||(Te.opts=[""]),Te.opts.indexOf("")<0&&Te.opts.unshift("")),Te.opts){be.addDrawMenu("Draw",Te.opts,We=>this.display(A,We),"Draw item in the new frame");const Pe=this.disp?.getActiveFrame();!Te.noappend&&Pe&&((0,Je.m6)(Pe)||(0,Je.Nn)(Pe))&&be.addDrawMenu("Superimpose",Te.opts,We=>this.dropItem(A,Pe,We),"Superimpose item with drawing on active frame")}if(J&&Te.opts&&!J.localfile){const Pe=b.settings.NewTabUrl||b.source_dir;let We=function _e(be){const Pe=document.createElement("div");return Pe.innerHTML=`<a href="${We=be,We.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}">x</a>`,Pe.firstChild.href;var We}(J.fileurl);if(0===We.indexOf(Pe)&&(We=We.slice(Pe.length)),We=`${J.kind}=${We}`,J.itemname){let Q=J.itemname;Q.search(/\+| |,/)>=0&&(Q=`'${Q}'`),We+=`&item=${Q}`}let dt="nobrowser";b.settings.WithCredentials&&(dt+="&with_credentials"),b.settings.NewTabUrlPars&&(dt+="&"+b.settings.NewTabUrlPars),b.settings.NewTabUrlExportSettings&&(1111!==b.gStyle.fOptStat&&(dt+=`&optstat=${b.gStyle.fOptStat}`),0!==b.gStyle.fOptFit&&(dt+=`&optfit=${b.gStyle.fOptFit}`),0!==b.gStyle.fOptDate&&(dt+=`&optdate=${b.gStyle.fOptDate}`),0!==b.gStyle.fOptFile&&(dt+=`&optfile=${b.gStyle.fOptFile}`),1!==b.gStyle.fOptTitle&&(dt+=`&opttitle=${b.gStyle.fOptTitle}`),"UTC"===b.settings.TimeZone?dt+="&utc":b.settings.TimeZone&&(dt+=`&timezone='${b.settings.TimeZone}'`),Math.abs(b.gStyle.fDateX-.01)>.001&&(dt+=`&datex=${b.gStyle.fDateX.toFixed(3)}`),Math.abs(b.gStyle.fDateY-.01)>.001&&(dt+=`&datey=${b.gStyle.fDateY.toFixed(3)}`),b.gStyle.fHistMinimumZero&&(dt+="&histzero"),b.settings.DarkMode&&(dt+="&dark=on"),b.settings.UseStamp||(dt+="&usestamp=off"),b.settings.OnlyLastCycle&&(dt+="&lastcycle"),1!==b.settings.OptimizeDraw&&(dt+=`&optimize=${b.settings.OptimizeDraw}`),200!==b.settings.MaxRanges&&(dt+=`&maxranges=${b.settings.MaxRanges}`),b.settings.FuncAsCurve&&(dt+="&tf1=curve"),b.settings.ToolBar||b.settings.Tooltip||b.settings.ContextMenu||b.settings.Zooming||b.settings.MoveResize||b.settings.DragAndDrop?b.settings.ContextMenu||(dt+="&nomenu"):dt+="&interactive=0"),be.addDrawMenu("Draw in new tab",Te.opts,Q=>window.open(`${Pe}?${dt}&${We}&opt=${Q}`),"Draw item in the new browser tab or window")}(Te.expand||Te.get_expand)&&(R._more||void 0===R._more)&&(void 0===R._childs?be.add("Expand",()=>this.expandItem(A),"Exapnd content of object"):be.add("Unexpand",()=>{R._more=!0,delete R._childs,delete R._isopen,R.expand_item&&delete R._expand,this.updateTreeNode(R)},"Remove all childs from hierarchy")),R._kind===b.prROOT+b.clTStyle&&be.add("Apply",()=>this.applyStyle(A))}else{let Te="",Pe=0;const We=[],dt=()=>Pe++>0?"&":"?";this.forEachRootFile(Ze=>We.push(Ze._file.fFullURL)),this.getTopOnlineItem()||(Te=b.source_dir+"index.htm"),this.isMonitoring()&&(Te+=dt()+"monitoring="+this.getMonitoringInterval()),1===We.length?Te+=`${dt()}file=${We[0]}`:We.length>1&&(Te+=`${dt()}files=${JSON.stringify(We)}`),this.disp_kind&&(Te+=dt()+"layout="+this.disp_kind.replace(/ /g,""));const Q=[],Ke=[];this.disp?.forEachFrame(Ze=>{const Ue=new Je.JW(Ze);let gt,Oe=Ue.getTopPainter(),lt=Oe?Oe.getItemName():null;lt?gt=Oe.getDrawOpt()||Oe.getItemDrawOpt():(Oe=null,Ue.forEachPainter(ht=>{const st=ht.getItemName();if(!st)return;let yt=ht.getDrawOpt()||ht.getItemDrawOpt()||"";Oe?Oe.getPadPainter()===ht.getPadPainter()&&(0===yt.indexOf("same ")&&(yt=yt.slice(5)),lt+="+"+st,gt+="+"+yt):(Oe=ht,lt=st,gt=yt)})),lt&&(Q.push(lt),Ke.push(gt||""))}),1===Q.length?Te+=dt()+"item="+Q[0]+dt()+"opt="+Ke[0]:Q.length>1&&(Te+=dt()+"items="+JSON.stringify(Q)+dt()+"opts="+JSON.stringify(Ke)),be.add("Direct link",()=>window.open(Te)),be.add("Only items",()=>window.open(Te+"&nobrowser")),this.fillSettingsMenu(be)}(0,b.isFunc)(R._menu)&&R._menu(be,R,this),be.size()>0&&(be.tree_node=I.parentNode,be.separ&&be.add("separator"),be.add("Close"),be.show())}),!1}player(m,I){var A=this;return(0,ve.A)(function*(){const R=A.findItem(m);if(!R||!R._player||!(0,b.isStr)(R._player))return null;let k=null;if(R._module){const J=yield A.importModule(R._module);k=J?J[R._player]:null}else(R._prereq||R._player.indexOf("JSROOT.")>=0)&&(yield A.loadScripts("",R._prereq)),k=(0,b.findFunction)(R._player);return(0,b.isFunc)(k)?(yield A.createDisplay(),k(A,m,I)):null})()}canDisplay(m,I){if(!m)return!1;if(m._player)return!0;if(void 0!==m._can_draw)return m._can_draw;if((0,b.isStr)(I)&&0===I.indexOf(b.kInspect))return!0;const A=(0,ot.hd)(m._kind,I);return(0,ot.Xv)(A)}isItemDisplayed(m){const I=this.getDisplay();return!!I&&null!==I.findFrame(m)}display(m,I,A){var R=this;return(0,ve.A)(function*(){const k=m;let _e=null,be=!1,Te=null,Pe=m;const We=I?.indexOf("::_display_on_frame_::")??-1;We>=0&&(Pe=I.slice(We+22),I=I.slice(0,We));const dt=(Q,Ke)=>(Ke&&console.log("When display ",m,"got",Ke),be&&Te&&delete Te._doing_update,be||(0,He.Rh)(),(0,b.isFunc)(Q?.setItemName)&&(Q.setItemName(k,be?null:I,R),Te&&!Te._painter&&(Te._painter=Q)),Q||_e);return R.createDisplay().then(Q=>{if(!Q)return dt();if(Te=R.findItem(k),Te&&"_player"in Te)return R.player(k,I).then(Ue=>dt(Ue));if(be=(0,b.isStr)(I)&&0===I.indexOf("update:"),be){if(I=I.slice(7),!Te||Te._doing_update)return dt();Te._doing_update=!0}if(Te&&!R.canDisplay(Te,I))return dt();let Ke="",Ze=!1;if((0,b.isStr)(I)&&I.indexOf("divid:")>=0){const Ue=I.indexOf("divid:");Ke=I.slice(Ue+6),I=I.slice(0,Ue)}return"__default_draw_option__"===I&&(Ze=!0,I=""),be||(0,He.Rh)(`Loading ${k} ...`),R.getObject(k,I).then(Ue=>{be||(0,He.Rh)(),Te||(Te=Ue.item);let Oe=Ue.obj;if(!Oe)return dt();be||(0,He.Rh)(`Drawing ${k} ...`);let lt=Oe._typename?(0,ot.hd)(b.prROOT+Oe._typename):null;if(lt?.draw_field&&Oe[lt.draw_field]&&(Oe=Oe[lt.draw_field],I||(I=lt.draw_field_opt||""),lt=Oe._typename?(0,ot.hd)(b.prROOT+Oe._typename):null),Ze&&!I&&lt?.dflt&&"expand"!==lt.dflt&&(I=lt.dflt),Ke)return(be?ot.AI:ot.$2)(Ke,Oe,I).then(yt=>dt(yt)).catch(yt=>dt(null,yt));let gt=!1;if(Q.forEachPainter((st,yt)=>{if(st.getItemName()!==k)return;const Kt=st.getItemDrawOpt();Ze&&A&&(I=Kt),(be||!I||Kt===I)&&(A&&!gt&&(gt=!0,Q.activateFrame(yt)),(0,b.isFunc)(st.redrawObject)&&st.redrawObject(Oe,I)&&(_e=st))}),_e)return dt();if(be)return console.warn(`something went wrong - did not found painter when doing update of ${k}`),dt();const ht=Q.findFrame(Pe,!0);return(0,Je.tP)(ht),Q.activateFrame(ht),(0,ot.$2)(ht,Oe,I).then(st=>dt(st)).catch(st=>dt(null,st))})})})()}enableDrag(m){m.attr("draggable","true").on("dragstart",function(I){const A=this.parentNode.parentNode.getAttribute("item");I.dataTransfer.setData("item",A)})}enableDrop(m){const I=this;(0,z.Lt)(m).on("dragover",function(A){const R=A.dataTransfer.getData("item"),k=I.findItem(R);(0,b.isStr)(k?._kind)&&0===k._kind.indexOf(b.prROOT)&&A.preventDefault()}).on("dragenter",function(){(0,z.Lt)(this).classed("jsroot_drag_area",!0)}).on("dragleave",function(){(0,z.Lt)(this).classed("jsroot_drag_area",!1)}).on("drop",function(A){(0,z.Lt)(this).classed("jsroot_drag_area",!1);const R=A.dataTransfer.getData("item");R&&I.dropItem(R,this)})}clearDrop(m){(0,z.Lt)(m).on("dragover",null).on("dragenter",null).on("dragleave",null).on("drop",null)}dropItem(m,I,A){var R=this;return(0,ve.A)(function*(){(!A||!(0,b.isStr)(A))&&(A="");const k=(J,_e)=>(!_e&&(0,b.isFunc)(J?.setItemName)&&J.setItemName(m,null,R),J);if("$legend"===m){const J=(0,Je.m6)(I);return(0,b.isFunc)(J?.buildLegend)?J.buildLegend(0,0,0,0,"",A).then(_e=>k(_e)):(console.error("Not possible to build legend"),k(null))}return R.getObject(m).then(J=>{if(!J.obj)return null;const _e=(0,Je.Nn)(I);return(0,b.isFunc)(_e?.performDrop)?_e.performDrop(J.obj,m,J.item,A).then(be=>k(be,_e===be)):_e?.accept_drops?(0,ot.$2)(I,J.obj,"same "+A).then(be=>k(be,_e===be)):(R.cleanupFrame(I),(0,ot.$2)(I,J.obj,A).then(be=>k(be)))})})()}updateItems(m){var I=this;return(0,ve.A)(function*(){if(!I.disp)return!1;const A=[],R=[];let k=!1,J=!1;return(0,b.isStr)(m)?m=[m]:(0,b.isObject)(m)||(void 0===m&&(m=!I.isMonitoring()),J=!0,k=!!m),I.disp.forEachPainter(_e=>{const be=_e.getItemName();if((0,b.isStr)(be)&&!(A.indexOf(be)>=0)){if(J){const Te=I.findItem(be);if(!Te||"_not_monitor"in Te||"_player"in Te)return;if(!("_always_monitor"in Te)){const Pe=(0,ot.hd)(Te._kind);let We=!1;if(void 0!==Pe?.monitor){if(!1===Pe.monitor||"never"===Pe.monitor)return;"always"===Pe.monitor&&(We=!0)}if(!We&&k)return}}else if(m.indexOf(be)<0)return;A.push(be),R.push("update:"+_e.getItemDrawOpt())}},!0),I.files_monitoring&&!k&&J&&I.forEachRootFile(_e=>{I.forEachItem(be=>{delete be._readobj},_e),delete _e._file}),I.displayItems(A,R)})()}displayItems(m,I){var A=this;return(0,ve.A)(function*(){if(!m||0===m.length)return!0;const R=A;for(I||(I=[]);I.length<m.length;)I.push("__default_draw_option__");if(1===I.length&&"iotest"===I[0]){A.clearHierarchy(),(0,z.Lt)("#"+A.disp_frameid).html("<h2>Start I/O test</h2>");const Pe=new Date;return A.getObject(m[0]).then(()=>{const We=new Date;return(0,z.Lt)("#"+A.disp_frameid).append("h2").html("Item "+m[0]+" reading time = "+(We.getTime()-Pe.getTime())+"ms"),!0})}const k=new Array(m.length),J=new Array(m.length),_e=new Array(m.length);for(let Pe=0;Pe<m.length;++Pe){k[Pe]=J[Pe]=null;const We=m[Pe];let dt=!0;if(0===We?.indexOf("img:")){_e[Pe]=!0;continue}We?.length>1&&"'"===We[0]&&"'"===We[We.length-1]&&(m[Pe]=We.slice(1,We.length-1),dt=!1);let Q=R.findItem({name:m[Pe],check_keys:!0});if(Q){m[Pe]=R.itemFullName(Q);continue}if(dt&&"["===m[Pe][0]&&"]"===m[Pe][m[Pe].length-1]?(k[Pe]=x(m[Pe]),m[Pe]=k[Pe].shift()):dt&&m[Pe].indexOf("+")>0&&(k[Pe]=m[Pe].split("+"),m[Pe]=k[Pe].shift()),k[Pe]&&k[Pe].length>0){for(let Ze=0;Ze<k[Pe].length;++Ze){const Ue=k[Pe][Ze].indexOf("_same_");Ue>0&&null===R.findItem(k[Pe][Ze])&&(k[Pe][Ze]=k[Pe][Ze].slice(0,Ue)+m[Pe].slice(Ue)),Q=R.findItem({name:k[Pe][Ze],check_keys:!0}),Q&&(k[Pe][Ze]=R.itemFullName(Q))}for("["===I[Pe][0]&&"]"===I[Pe][I[Pe].length-1]?(J[Pe]=x(I[Pe]),I[Pe]=J[Pe].shift()):I[Pe].indexOf("+")>0?(J[Pe]=I[Pe].split("+"),I[Pe]=J[Pe].shift()):J[Pe]=[];J[Pe].length<k[Pe].length;)J[Pe].push("")}const Ke=m[Pe].indexOf("_same_");Ke>0&&!R.findItem(m[Pe])&&Pe>0&&(m[Pe]=m[Pe].slice(0,Ke)+m[0].slice(Ke)),Q=R.findItem({name:m[Pe],check_keys:!0}),Q&&(m[Pe]=R.itemFullName(Q))}for(let Pe=m.length-1;Pe>=0;--Pe){if(_e[Pe])continue;const We=R.findItem(m[Pe]);!We||R.canDisplay(We,I[Pe])||(R.expandItem(m[Pe],null,!0),m.splice(Pe,1),I.splice(Pe,1),k.splice(Pe,1))}if(0===m.length)return!0;const be=new Array(m.length),Te=new Array(m.length);for(let Pe=0;Pe<m.length;++Pe){Te[Pe]=0;let We=m[Pe],dt=0;m.indexOf(We)<Pe&&(Te[Pe]=!0);const Q=I[Pe].indexOf("frameid:");if(Q>=0)We=I[Pe].slice(Q+8),I[Pe]=I[Pe].slice(0,Q);else for(;be.indexOf(We)>=0;)We=m[Pe]+"_"+dt++;be[Pe]=We}for(let Pe=0;Pe<m.length;++Pe){if(0!==Te[Pe])continue;let We=Pe;for(let dt=0;dt<m.length;++dt)m[Pe]===m[dt]&&I[dt].indexOf("main")>=0&&(We=dt);for(let dt=0;dt<m.length;++dt)m[Pe]===m[dt]&&(Te[dt]=We!==dt)}return A.createDisplay().then(Pe=>{if(!Pe)return!1;for(let Q=0;Q<m.length;++Q)0!==I[Q].indexOf("update:")&&(Pe.createFrame(be[Q]),I[Q]+="::_display_on_frame_::"+be[Q]);function We(Q,Ke){if(Ke&&k[Q]&&k[Q].length>0)return R.dropItem(k[Q].shift(),Ke.getDom(),J[Q].shift()).then(()=>We(Q,Ke));k[Q]=null,m[Q]=null;for(let Ze=0;Ze<m.length;++Ze)if(null!==m[Ze]&&Te[Ze]&&m.indexOf(m[Ze])===Ze)return Te[Ze]=!1,R.display(m[Ze],I[Ze]).then(Ue=>We(Ze,Ue))}const dt=[];if(A._one_by_one){let Q=function(Ke){return Ke>=m.length||(Te[Ke]?Q(Ke+1):R.display(m[Ke],I[Ke]).then(Ze=>We(Ke,Ze)).then(()=>Q(Ke+1)))};dt.push(Q(0))}else for(let Q=0;Q<m.length;++Q)Te[Q]||dt.push(R.display(m[Q],I[Q]).then(Ke=>We(Q,Ke)));return Promise.all(dt)})})()}reload(){var m=this;return(0,ve.A)(function*(){return"_online"in m.h&&m.openOnline(m.h._online).then(()=>m.refreshHtml())})()}activateItems(m,I){(0,b.isStr)(m)&&(m=[m]);const A=[],R=[];this.forEachItem(_e=>{_e._background&&(A.push(_e),delete _e._background)});const k=()=>{for(let _e=R.length-1;_e>=0;--_e)this.updateTreeNode(R[_e]);for(let _e=0;_e<A.length;++_e)this.updateBackground(A[_e],I)},J=(_e,be)=>{if(void 0===_e){if(0===m.length)return k();_e=m.shift()}let Te=this.findItem(_e);if(!Te){const Pe=this.findItem({name:_e,last_exists:!0,check_keys:!0,allow_index:!0});if(!Pe||!Pe.last)return J();if(Pe.now_found=this.itemFullName(Pe.last),I)return void 0!==be&&Pe.now_found===be?J():this.expandItem(Pe.now_found).then(We=>{if(!We)return J();let dt=this.itemFullName(Pe.last);dt&&(dt+="/"),J(dt+Pe.rest,Pe.now_found)});Te=Pe.last}if(Te){let Pe=Te._parent;for(;Pe;){if(!Pe._isopen){if(!I){Te=Pe;break}Pe._isopen=!0,R.indexOf(Pe)<0&&R.push(Pe)}Pe=Pe._parent}Te._background="LightSteelBlue",A.indexOf(Te)<0&&A.push(Te)}J()};if(I&&this.brlayout){if(!this.brlayout.browser_kind)return this.createBrowser("float",!0).then(()=>J());this.brlayout.browser_visible||this.brlayout.toggleBrowserVisisbility()}J()}canExpandItem(m){if(!m)return!1;if(m._expand)return!0;const I=(0,ot.hd)(m._kind,"::expand");return I&&_(I)}expandItem(m,I,A){var R=this;return(0,ve.A)(function*(){const k=R.findItem(m),J=R;if(!k&&I)return;function _e(Pe,We){return be.apply(this,arguments)}function be(){return(be=(0,ve.A)(function*(Pe,We){if((0,b.isStr)(Pe._expand)&&(Pe._expand=(0,b.findFunction)(Pe._expand)),!(0,b.isFunc)(Pe._expand)){let dt=(0,ot.hd)(Pe._kind,"::expand");if(dt?.expand_item&&!J._inspector&&(We=We[dt.expand_item],Pe.expand_item=dt.expand_item,dt=We?._typename?(0,ot.hd)(b.prROOT+We._typename,"::expand"):null),dt?.expand||dt?.get_expand)if((0,b.isFunc)(dt.expand))Pe._expand=dt.expand;else if((0,b.isStr)(dt.expand)){if(!b.internals.ignore_v6){const Q=yield(0,b._ensureJSROOT)();yield Q.require(dt.prereq),yield Q._complete_loading()}Pe._expand=dt.expand=(0,b.findFunction)(dt.expand)}else(0,b.isFunc)(dt.get_expand)&&(Pe._expand=dt.expand=yield dt.get_expand())}return We&&(0,b.isFunc)(Pe._expand)&&Pe._expand(Pe,We)||We&&V(Pe,We)?(Pe._isopen=!0,Pe._parent&&!Pe._parent._isopen?(Pe._parent._isopen=!0,A||J.updateTreeNode(Pe._parent)):A||J.updateTreeNode(Pe,I),Pe):-1})).apply(this,arguments)}let Te=Promise.resolve(-1);if(k){if(!1===k._more||!k._parent&&k._childs)return;if(k._childs&&k._isopen)return k._isopen=!1,void(A||R.updateTreeNode(k,I));k._obj&&(Te=_e(k,k._obj))}return Te.then(Pe=>-1!==Pe?Pe:((0,He.Rh)("Loading "+m),R.getObject(m,A?"hierarchy_expand":"hierarchy_expand_verbose").then(We=>{if((0,He.Rh)(),We.obj)return _e(We.item,We.obj).then(dt=>-1!==dt?dt:void 0)})))})()}getTopOnlineItem(m){if(m){for(;m&&!("_online"in m);)m=m._parent;return m}return this.h?"_online"in this.h?this.h:this.h._childs&&"_online"in this.h._childs[0]?this.h._childs[0]:null:null}forEachJsonFile(m){if(this.h){if("_jsonfile"in this.h)return m(this.h);if(this.h._childs)for(let I=0;I<this.h._childs.length;++I){const A=this.h._childs[I];"_jsonfile"in A&&m(A)}}}openJsonFile(m){var I=this;return(0,ve.A)(function*(){let A=!1;if(I.forEachJsonFile(R=>{R._jsonfile===m&&(A=!0)}),!A)return(0,b.httpRequest)(m,"object").then(R=>{if(!R)return;const k={_jsonfile:m,_kind:b.prROOT+R._typename,_jsontmp:R,_name:m.split("/").pop()};if(R.fTitle&&(k._title=R.fTitle),k._get=function(J){return J._jsontmp?Promise.resolve(J._jsontmp):(0,b.httpRequest)(J._jsonfile,"object").then(_e=>(J._jsontmp=_e,_e))},I.h)if(I.h._kind===Ie)I.h._childs.push(k);else{const J=I.h;I.h={_name:"_jsonfile"in J?"Files":"Items",_kind:Ie,_childs:[J,k]}}else I.h=k;return I.refreshHtml()})})()}forEachRootFile(m){if(this.h){if(this.h._kind===C&&this.h._file)return m(this.h);if(this.h._childs)for(let I=0;I<this.h._childs.length;++I){const A=this.h._childs[I];A._kind===C&&"_fullurl"in A&&m(A)}}}findRootFileForItem(m){let I=this.findItem(m);for(;I;){if(I._kind===C&&I._fullurl&&I._file)return I;I=I?._parent}return null}openRootFile(m){var I=this;return(0,ve.A)(function*(){let A=!1;if(I.forEachRootFile(k=>{k._fullurl===m&&(A=!0)}),A)return;const R=(0,b.isStr)(m)?m:"file";return(0,He.Rh)(`Opening ${R} ...`),(0,ke.Tq)(m).then(k=>{const J=I.fileHierarchy(k);if(J._isopen=!0,I.h)if(I.h._kind===Ie)I.h._childs.push(J);else{const _e=I.h;I.h={_name:_e._kind===C?"Files":"Items",_kind:Ie,_childs:[_e,J],_isopen:!0}}else I.h=J,I._topname&&(J._name=I._topname);return I.refreshHtml()}).catch(()=>((0,b.isBatchMode)()?console.error(`Fail to open ${R} - check CORS headers`):(0,z.Lt)("#gui_fileCORS").style("background","red").empty()||setTimeout(()=>(0,z.Lt)("#gui_fileCORS").style("background",""),5e3),!1)).finally(()=>(0,He.Rh)())})()}listServerDir(m){var I=this;return(0,ve.A)(function*(){return(0,b.httpRequest)(m,"text").then(A=>{if(!A)return!1;const R={_name:"Files",_kind:Ie,_childs:[],_isopen:!0};let k=0;for(;k<A.length&&(k=A.indexOf('a href="',k+1),!(k<0));){k+=8;const J=A.indexOf('"',k+1);if(J<0)break;const _e=A.slice(k,J);k=J+1,_e.lastIndexOf(".root")===_e.length-5&&_e.length>5?R._childs.push({_name:_e,_title:m+_e,_url:m+_e,_kind:C,_click_action:"expand",_more:!0,_obj:{},_expand:be=>(0,ke.Tq)(be._url).then(Te=>{if(!Te)return!1;delete be._exapnd,delete be._more,delete be._click_action,delete be._obj,be._isopen=!0,I.fileHierarchy(Te,be),I.updateTreeNode(be)})}):(_e.lastIndexOf(".json.gz")===_e.length-8&&_e.length>8||_e.lastIndexOf(".json")===_e.length-5&&_e.length>5)&&R._childs.push({_name:_e,_title:m+_e,_jsonfile:m+_e,_can_draw:!0,_get:be=>(0,b.httpRequest)(be._jsonfile,"object").then(Te=>(Te&&(be._kind=b.prROOT+Te._typename,be._jsontmp=Te,I.updateTreeNode(be)),Te))})}return R._childs.length>0&&(I.h=R),!0})})()}applyStyle(m){var I=this;return(0,ve.A)(function*(){if(!m)return!0;let A=Promise.resolve(m);if((0,b.isStr)(m)){const R=I.findItem({name:m,allow_index:!0,check_keys:!0});null!==R?A=I.getObject(R).then(k=>k.obj):m.indexOf(".json")>0&&(A=(0,b.httpRequest)(m,"object"))}return A.then(R=>{R?._typename===b.clTStyle&&Object.assign(b.gStyle,R)})})()}getFileProp(m){let I=this.findItem(m);if(!I)return null;let A=I._name;for(;I._parent;){if(I=I._parent,"_file"in I)return{kind:"file",fileurl:I._file.fURL,itemname:A,localfile:!!I._file.fLocalFile};if("_jsonfile"in I)return{kind:"json",fileurl:I._jsonfile,itemname:A};A=I._name+"/"+A}return null}getOnlineItemUrl(m){(0,b.isStr)(m)&&(m=this.findItem(m));let I=m;for(;I&&void 0===I._online;)I=I._parent;return I?I._online+this.itemFullName(m,I):null}isOnlineItem(m){return null!==this.getOnlineItemUrl(m)}importModule(m){return(0,ve.A)(function*(){switch(m){case"core":return Promise.resolve().then(Ee.bind(Ee,6998));case"draw_tree":return Promise.all([Ee.e(693),Ee.e(76),Ee.e(716)]).then(Ee.bind(Ee,716));case"hierarchy":return{HierarchyPainter:L,markAsStreamerInfo:w}}return import(m)})()}getOnlineItem(m,I,A){var R=this;return(0,ve.A)(function*(){let k=I,J=!1,_e="",be="object",Te=null;if((0,b.isStr)(A)&&0===A.indexOf("hierarchy_expand")&&(J=!0,A=void 0),m){k=R.getOnlineItemUrl(m);let Pe=null;if("_kind"in m&&(Te=(0,ot.hd)(m._kind)),J?(_e="h.json?compact=3",m._expand=v):m._make_request?Pe=m._module?(yield R.importModule(m._module))[m._make_request]:(0,b.findFunction)(m._make_request):Te?.make_request&&(Pe=Te.make_request),(0,b.isFunc)(Pe)){const We=Pe(R,m,k,A);We&&((0,b.isStr)(We)?_e=We:("req"in We&&(_e=We.req),"kind"in We&&(be=We.kind)))}!_e&&0!==m._kind.indexOf(b.prROOT)&&(_e="item.json.gz?compact=3")}if(!I&&m&&"_cached_draw_object"in R&&!_e){const Pe=R._cached_draw_object;return delete R._cached_draw_object,Pe}return _e||(_e="root.json.gz?compact=23"),k&&(k+="/"),k+=_e,new Promise(Pe=>{let We=null;(0,b.createHttpRequest)(k,be,dt=>{const Q=Ke=>{if((0,b.isFunc)(Ke)){const Ze=Ke(R,m,dt,A,We);(0,b.isObject)(Ze)&&(dt=Ze)}Pe(dt)};!J&&m?._after_request?m._module?R.importModule(m._module).then(Ke=>Q(Ke[m._after_request])):Q((0,b.findFunction)(m._after_request)):Q(Te?.after_request)},void 0,!0).then(dt=>{We=dt,dt.send(null)})})})()}openOnline(m){var I=this;return(0,ve.A)(function*(){const A=function(){var R=(0,ve.A)(function*(k){if(I.h=k,!k)return Promise.resolve(null);I.h?._title&&typeof document<"u"&&(document.title=I.h._title),k._isopen=!0,I.h._online=m,I.h._get=(Pe,We,dt)=>I.getOnlineItem(Pe,We,dt),I.h._expand=v;const J=[],_e=[],be=[],Te=[];return I.forEachItem(Pe=>{void 0!==Pe._childs&&(Pe._expand=v),Pe._autoload&&Pe._autoload.split(";").forEach(dt=>{dt.length>4&&dt.lastIndexOf(".mjs")===dt.length-4?Te.push(I.importModule(dt)):dt.length>3&&dt.lastIndexOf(".js")===dt.length-3?_e.find(Q=>Q===dt)||_e.push(dt):dt.length>4&&dt.lastIndexOf(".css")===dt.length-4?J.find(Q=>Q===dt)||J.push(dt):dt&&!be.find(Q=>Q===dt)&&be.push(dt)})}),I.loadScripts(_e,be).then(()=>(0,b.loadScript)(J)).then(()=>Promise.all(Te)).then(()=>(I.forEachItem(Pe=>{if(!("_drawfunc"in Pe)||!("_kind"in Pe))return;let We="kind:"+Pe._kind;0===Pe._kind.indexOf(b.prROOT)&&(We=Pe._kind.slice(5));const dt=Pe._drawopt;(!(0,ot.Xv)(We)||dt)&&(0,ot.uA)({name:We,func:Pe._drawfunc,script:Pe._drawscript,opt:dt})}),I))});return function(J){return R.apply(this,arguments)}}();if(m||(m=""),(0,b.isObject)(m)){const R=m;return m="",A(R)}return(0,b.httpRequest)(m+"h.json?compact=3","object").then(R=>A(R))})()}getOnlineProp(m){let I=this.findItem(m);if(!I)return null;let A=I._name;for(;I._parent;){if(I=I._parent,"_online"in I)return{server:I._online,itemname:A};A=I._name+"/"+A}return null}fillOnlineMenu(m,I,A){const R=this.findItem(A),k=(0,ot.iO)(R._kind,"nosame;noinspect"),J=(0,ot.hd)(R._kind),_e=!!(0,b.isStr)(R._kind)&&0===R._kind.indexOf(b.prROOT);k.opts&&!1!==R._can_draw&&(k.opts.push(b.kInspect),m.addDrawMenu("Draw",k.opts,be=>this.display(A,be))),!R._childs&&!1!==R._more&&(R._more||_e||k.expand||k.get_expand)&&m.add("Expand",()=>this.expandItem(A)),J?.execute&&m.add("Execute",()=>this.executeCommand(A,m.tree_node)),k.opts&&!1!==R._can_draw&&m.addDrawMenu("Draw in new window",k.opts,be=>window.open(I.server+`?nobrowser&item=${I.itemname}`+(this.isMonitoring()?`&monitoring=${this.getMonitoringInterval()}`:"")+(be?`&opt=${be}`:""))),k.opts?.length&&_e&&!1!==R._can_draw&&m.addDrawMenu("Draw as png",k.opts,be=>window.open(I.server+I.itemname+"/root.png?w=600&h=400"+(be?"&opt="+be:"")),"Request PNG image from the server"),"_player"in R&&m.add("Player",()=>this.player(A))}setHierarchy(m){this.h=m,this.refreshHtml()}setMonitoring(m,I){this._runMonitoring("cleanup"),m&&(m=parseInt(m),Number.isInteger(m)&&m>0?(this._monitoring_interval=Math.max(100,m),I=!0):this._monitoring_interval=3e3),this._monitoring_on=I,this.isMonitoring()&&this._runMonitoring()}_runMonitoring(m){return"cleanup"!==m&&this.isMonitoring()?"frame"===m?(delete this._monitoring_handle,void(this._monitoring_frame=requestAnimationFrame(this._runMonitoring.bind(this,"draw")))):("draw"===m&&(delete this._monitoring_frame,this.updateItems()),void(this._monitoring_handle=setTimeout(this._runMonitoring.bind(this,"frame"),this.getMonitoringInterval()))):(this._monitoring_handle&&(clearTimeout(this._monitoring_handle),delete this._monitoring_handle),void(this._monitoring_frame&&(cancelAnimationFrame(this._monitoring_frame),delete this._monitoring_frame)))}getMonitoringInterval(){return this._monitoring_interval||3e3}isMonitoring(){return this._monitoring_on}setDisplay(m,I){!I&&(0,b.isObject)(m)?(this.disp=m,this.disp_kind="custom",this.disp_frameid=null):(this.disp_kind=m,this.disp_frameid=I),!this.register_resize&&"batch"!==this.disp_kind&&(this.register_resize=!0,(0,He.d7)(this))}getLayout(){return this.disp_kind}removePainter(m){this.forEachItem(I=>{I._painter===m&&(delete I._painter,(0,b.isFunc)(I.clear)&&I.clear())})}clearHierarchy(m){this.disp&&(this.disp.cleanup(),delete this.disp);const I=[];this.forEachItem(A=>{delete A._painter,!m&&(0,b.isFunc)(A.clear)&&A.clear(),m&&I.push(A)}),m&&(this.enableMonitoring(!1),this.selectDom().html(""),I.forEach(A=>{delete A._parent,delete A._childs,delete A._obj,delete A._d3cont}),delete this.h)}getDisplay(){return this.disp}cleanupFrame(m){(0,z.Lt)(m).attr("frame_title",null),this.clearDrop(m);const I=(0,Je.tP)(m);I.length>0&&this.forEachItem(A=>{A._painter&&I.indexOf(A._painter)>=0&&delete A._painter})}createDisplay(){var m=this;return(0,ve.A)(function*(){if("disp"in m){if(m.disp.numDraw()>0||"custom"===m.disp_kind)return m.disp;m.disp.cleanup(),delete m.disp}return"batch"===m.disp_kind?((0,b.isNodeJs)()?(0,et.lf)():Promise.resolve(null)).then(A=>(m.disp=new Re.bG(1200,800,A?.body),m.disp)):document.getElementById(m.disp_frameid)?(m.disp=0===m.disp_kind.indexOf("flex")||0===m.disp_kind.indexOf("coll")?new Re.o5(m.disp_frameid):"tabs"===m.disp_kind?new Re.Hb(m.disp_frameid):new Re.ho(m.disp_frameid,m.disp_kind),m.disp.cleanupFrame=m.cleanupFrame.bind(m),b.settings.DragAndDrop&&m.disp.setInitFrame(m.enableDrop.bind(m)),m.disp):null})()}createCustomDisplay(m,I){var A=this;return(0,ve.A)(function*(){if("simple"!==A.disp_kind)return A.createDisplay();if(A.disp_kind=I,A.disp){const R=A.disp.numDraw();if(R>1||1===R&&!A.disp.findFrame(m))return A.createDisplay();A.disp.cleanup(),delete A.disp}return A.createDisplay()})()}updateOnOtherFrames(m,I){const A=this.disp;if(!A)return!1;const R=I._typename?(0,ot.hd)(b.prROOT+I._typename):null;R?.draw_field&&I[R?.draw_field]&&(I=I[R?.draw_field]);let k=!1;return A.forEachPainter(J=>{J===m||J.getItemName()!==m.getItemName()||(0,b.isFunc)(J.redrawObject)&&J.redrawObject(I)&&(k=!0)}),k}checkResize(m){this.disp&&this.disp.checkMDIResize(null,m)}loadScripts(m,I,A){return(0,ve.A)(function*(){return!m?.length&&!I?.length||(A&&!globalThis.JSROOT&&(globalThis.JSROOT={version:b.version,gStyle:b.gStyle,create:b.create,httpRequest:b.httpRequest,loadScript:b.loadScript,decodeUrl:b.decodeUrl,source_dir:b.source_dir,settings:b.settings,addUserStreamer:ke.Ub,addDrawFunc:ot.uA,draw:ot.$2,redraw:ot.AI}),b.internals.ignore_v6||A?(0,b.loadScript)(m):(0,b._ensureJSROOT)().then(R=>R.require(I).then(()=>(0,b.loadScript)(m)).then(()=>R._complete_loading())))})()}startGUI(m,I){var A=this;return(0,ve.A)(function*(){const R=(0,b.decodeUrl)(I),k=Qt=>{let Bn=R.get(Qt,null);return null===Bn&&m&&!m.empty()&&m.node().hasAttribute(Qt)&&(Bn=m.attr(Qt)),Bn},_e=Qt=>{let Bn=(Qt=>{let Bn=[];for(;Qt;){const dn=Qt.indexOf(";");let yn=dn>0?Qt.slice(0,dn):Qt;Qt=dn>0?Qt.slice(dn+1):"";let Tn=!0;"#"===yn[0]&&(yn=yn.slice(1),Tn=!1);const Hn=R.get(yn,null);Tn?Bn=Bn.concat(x(Hn)):null!==Hn&&Bn.push(Hn)}return Bn})(Qt);if(Bn.length>0||!m||m.empty())return Bn;for(;Qt;){const dn=Qt.indexOf(";");let yn=dn>0?Qt.slice(0,dn):Qt;Qt=dn>0?Qt.slice(dn+1):"";let Tn=!0;if("#"===yn[0]&&(yn=yn.slice(1),Tn=!1),"files"===yn||!m.node().hasAttribute(yn))continue;const Hn=m.attr(yn);Tn?Bn=Bn.concat(x(Hn)):null!==Hn&&Bn.push(Hn)}return Bn},be=R.get("path")||"",Te=_e("#json;jsons"),Pe=_e("expand"),We=k("focus"),dt=k("layout"),Q=_e("#style"),Ke=k("title");A._one_by_one=b.settings.drop_items_one_by_one??null!==k("one_by_one");let Ze=k("prereq")||"",Ue=k("load"),Oe=k("dir"),lt=k("inject"),gt=_e("#file;files"),ht=_e("#item;items"),st=_e("#opt;opts"),yt=k("monitoring"),Kt=0,Ot=k("status"),It=k("browser"),An=!!It;if(yt=null===yt?0:""===yt?3e3:parseInt(yt),null!==k("float")?(It="float",An=!0):null!==k("fix")&&(It="fix",An=!0),!An&&b.browser.screenWidth<=640&&(It="float"),A.no_select=k("noselect"),null!==k("files_monitoring")&&(A.files_monitoring=!0),Ke&&typeof document<"u"&&(document.title=Ke),0===Pe.length&&""===k("expand")&&Pe.push(""),be){for(let Qt=0;Qt<gt.length;++Qt)gt[Qt]=be+gt[Qt];for(let Qt=0;Qt<Te.length;++Qt)Te[Qt]=be+Te[Qt]}if(0===ht.length&&""===k("item")&&ht.push(""),1===Te.length&&0===ht.length&&0===Pe.length&&ht.push(""),!A.disp_kind)if((0,b.isStr)(dt)&&dt)A.disp_kind=dt;else if(b.settings.DislpayKind&&"simple"!==b.settings.DislpayKind)A.disp_kind=b.settings.DislpayKind;else switch(ht.length){case 0:case 1:A.disp_kind="simple";break;case 2:A.disp_kind="vert2";break;case 3:A.disp_kind="vert21";break;case 4:A.disp_kind="vert22";break;case 5:A.disp_kind="vert32";break;case 6:A.disp_kind="vert222";break;case 7:A.disp_kind="vert322";break;case 8:A.disp_kind="vert332";break;case 9:A.disp_kind="vert333";break;default:A.disp_kind="flex"}"no"===Ot?Ot=null:"off"===Ot?(A.status_disabled=!0,Ot=null):"on"===Ot?Ot=!0:null!==Ot&&(Kt=parseInt(Ot),(!Number.isInteger(Kt)||Kt<5)&&(Kt=0),Ot=!0),""===A.no_select&&(A.no_select=!0),It?"no"===It?It="":"off"===It&&(It="",Ot=null,A.exclude_browser=!0):It="fix",null!==k("nofloat")&&(A.float_browser_disabled=!0),A.start_without_browser&&(It=""),A._topname=k("topname");const on=()=>{let Qt;if(Ue||Ze)Qt=A.loadScripts(Ue,Ze),Ue="",Ze="";else if(lt)Qt=A.loadScripts(lt,"",!0),lt="";else if(It)Qt=A.createBrowser(It),It="";else if(null!==Ot)Qt=A.createStatusLine(Kt,Ot),Ot=null;else if(Te.length>0)Qt=A.openJsonFile(Te.shift());else if(gt.length>0)Qt=A.openRootFile(gt.shift());else if(Oe)Qt=A.listServerDir(Oe),Oe="";else if(Pe.length>0)Qt=A.expandItem(Pe.shift());else{if(!(Q.length>0))return A.refreshHtml().then(()=>A.displayItems(ht,st)).then(()=>We?A.focusOnItem(We):A).then(()=>(A.setMonitoring(yt),ht?A.refreshHtml():A));Qt=A.applyStyle(Q.shift())}return Qt.then(on)};let pn=null;if(A.is_online){const Qt=b.internals.getCachedHierarchy||(0,b.findFunction)("GetCachedHierarchy");(0,b.isFunc)(Qt)&&(pn=Qt()),(0,b.isObject)(pn)||(pn=""),"draw"===A.is_online&&!ht.length&&ht.push("")}return null!==pn?A.openOnline(pn).then(()=>(!A.exclude_browser&&!An&&"_browser"in A.h&&(It=A.h._browser,"no"===It?It="":"off"===It&&(It="",Ot=null,A.exclude_browser=!0)),"_monitoring"in A.h&&!yt&&(yt=A.h._monitoring),"_loadfile"in A.h&&0===gt.length&&(gt=x(A.h._loadfile)),"_drawitem"in A.h&&0===ht.length&&(ht=x(A.h._drawitem),st=x(A.h._drawopt)),"_layout"in A.h&&!dt&&("draw"!==A.is_online||ht.length>1)&&(A.disp_kind=A.h._layout),"_toptitle"in A.h&&A.exclude_browser&&typeof document<"u"&&(document.title=A.h._toptitle),m&&A.prepareGuiDiv(m.attr("id"),A.disp_kind),on())):(m&&A.prepareGuiDiv(m.attr("id"),A.disp_kind),on())})()}prepareGuiDiv(m,I){this.gui_div=(0,b.isStr)(m)?m:m.attr("id"),this.brlayout=new Re.jX(this.gui_div,this),this.brlayout.create(!this.exclude_browser),this.createButtons(),this.setDisplay(I,this.brlayout.drawing_divid())}createButtons(){if(this.exclude_browser)return;const m=this.brlayout?.createBrowserBtns();m&&(He.IK.createSVG(m,He.IK.diamand,15,"toggle fix-pos browser","browser").style("margin","3px").on("click",()=>this.createBrowser("fix",!0)),this.float_browser_disabled||He.IK.createSVG(m,He.IK.circle,15,"toggle float browser","browser").style("margin","3px").on("click",()=>this.createBrowser("float",!0)),this.status_disabled||He.IK.createSVG(m,He.IK.three_circles,15,"toggle status line","browser").style("margin","3px").on("click",()=>this.createStatusLine(0,"toggle")))}hasStatusLine(){return!(this.status_disabled||!this.gui_div||!this.brlayout)&&this.brlayout.hasStatus()}createStatusLine(m,I){var A=this;return(0,ve.A)(function*(){return!A.status_disabled&&A.gui_div&&A.brlayout?A.brlayout.createStatusLine(m,I):""})()}redrawObject(m){return!(!this._inspector&&!this._streamer_info)&&(this.h=this._streamer_info?D(m):P(m),this.refreshHtml().then(()=>{this.setTopPainter()}))}createBrowser(m,I){var A=this;return(0,ve.A)(function*(){if(!A.gui_div||A.exclude_browser||!A.brlayout)return!1;const R=(0,z.Lt)(`#${A.gui_div} .jsroot_browser`);if(R.empty())return!1;if("float"===m&&A.float_browser_disabled&&(m="fix"),!R.select(".jsroot_browser_area").empty())return I&&A.brlayout.toggleKind(m),!0;let k=`<p class="jsroot_browser_version"><a href="https://root.cern/js/">JSROOT</a> version <span style="color:green"><b>${b.version}</b></span></p>`;if(A.is_online)k+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:inline; vertical-align:middle; white-space: nowrap;"><label style="margin-right:5px"><input type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';else if(A.no_select)"file"===A.no_select&&(k+='<div style="display:flex;flex-direction:row">');else{const be=(0,z.Lt)("#"+A.gui_div),Te=be.attr("files")||"../files/hsimple.root",Pe=(0,b.decodeUrl)().get("path")||be.attr("path")||"",We=Te.split(";");k+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>',We.forEach(dt=>{k+=`<option value="${Pe+dt}">${dt}</option>`}),k+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px" class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px" class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}(A.is_online||!A.no_select||"file"===A.no_select)&&(k+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>'),k+=`<div id="${A.gui_div}_browser_hierarchy" class="jsroot_browser_hierarchy"></div>`,A.brlayout.setBrowserContent(k),A.brlayout.setBrowserTitle(A.is_online?"ROOT online server":"Read a ROOT file")?.on("contextmenu",be=>{be.preventDefault(),(0,Xe.ES)(be).then(Te=>{A.fillSettingsMenu(Te,!0),Te.show()})}).on("dblclick",()=>{A.createBrowser("float"===A.brlayout?.browser_kind?"fix":"float",!0)}),!A.is_online&&!A.no_select&&(A.readSelectedFile=function(){const be=R.select(".gui_urlToLoad").property("value").trim();be&&(be.toLowerCase().lastIndexOf(".json")===be.length-5?this.openJsonFile(be):this.openRootFile(be))},R.select(".gui_selectFileName").property("value","").on("change",be=>R.select(".gui_urlToLoad").property("value",be.target.value)),R.select(".gui_fileBtn").on("click",()=>R.select(".gui_localFile").node().click()),R.select(".gui_ReadFileBtn").on("click",()=>A.readSelectedFile()),R.select(".gui_ResetUIBtn").on("click",()=>A.clearHierarchy(!0)),R.select(".gui_urlToLoad").on("keyup",be=>{"Enter"===be.code&&A.readSelectedFile()}),R.select(".gui_localFile").on("change",be=>{const Te=be.target.files;for(let Pe=0;Pe<Te.length;++Pe){const We=Te[Pe];R.select(".gui_urlToLoad").property("value",We.name),A.openRootFile(We)}}));const _e=R.select(".gui_layout");return _e.empty()||(["simple","vert2","vert3","vert231","horiz2","horiz32","flex","tabs","grid 2x2","grid 1x3","grid 2x3","grid 3x3","grid 4x4"].forEach(be=>_e.append("option").attr("value",be).html(be)),_e.on("change",be=>{const Te=be.target.value||"flex";A.setDisplay(Te,A.gui_div+"_drawing"),b.settings.DislpayKind=Te})),A.setDom(A.gui_div+"_browser_hierarchy"),I&&(A.refreshHtml(),A.initializeBrowser()),A.brlayout.toggleBrowserKind(m||"fix")})()}initializeBrowser(){const m=(0,z.Lt)(`#${this.gui_div} .jsroot_browser`);if(m.empty()||!this.brlayout)return;this.brlayout.adjustBrowserSize();const I=m.select(".gui_layout").node();if(I){let A=!1;for(const R in I.options){const k=I.options[R].text;if((0,b.isStr)(k)&&(k===this.getLayout()||k.replace(/ /g,"")===this.getLayout())){I.selectedIndex=R,A=!0;break}}if(!A){const R=document.createElement("option");R.innerHTML=R.value=this.getLayout(),I.appendChild(R),I.selectedIndex=I.options.length-1}}if(this.is_online)this.h?._toptitle&&this.brlayout.setBrowserTitle(this.h._toptitle),m.select(".gui_monitoring").property("checked",this.isMonitoring()).on("click",A=>{this.enableMonitoring(A.target.checked),this.updateItems()});else if(!this.no_select){let A="";this.forEachRootFile(R=>{A||(A=R._fullurl)}),m.select(".gui_urlToLoad").property("value",A)}}enableMonitoring(m){this.setMonitoring(void 0,m);const I=(0,z.Lt)(`#${this.gui_div} .jsroot_browser .gui_monitoring`);!I.empty()&&I.property("checked")!==m&&I.property("checked",m)}}function F(N,m){return U.apply(this,arguments)}function U(){return(U=(0,ve.A)(function*(N,m){const I=new L("sinfo",N,"__as_dark_mode__");return(0,b.isBatchMode)()?(I.selectDom().property("_json_object_",m),I):(I._streamer_info=!0,I.h=D(m),I.refreshHtml().then(()=>(I.setTopPainter(),I)))})).apply(this,arguments)}function j(N,m,I){return te.apply(this,arguments)}function te(){return(te=(0,ve.A)(function*(N,m,I){(0,Je.tP)(N);const A=new L("inspector",N,"__as_dark_mode__");if((0,b.isBatchMode)())return A.selectDom().property("_json_object_",m),A;A.default_by_click="expand",A.with_icons=!1,A._inspector=!0;let R=0;return(0,b.isStr)(I)&&0===I.indexOf(b.kInspect)&&(I=I.slice(b.kInspect.length)).length>0&&(R=Number.parseInt(I)),A.selectDom().classed("jsroot_inspector")&&(A.removeInspector=function(){this.selectDom().remove()}),A.fill_context=function(k,J){const _e=(0,ot.iO)(J._kind,"nosame");_e.opts&&k.addDrawMenu("nosub:Draw",_e.opts,be=>{if(!J?._obj)return;const Te=J._obj;let Pe=this.selectDom().node();if((0,b.isFunc)(this.removeInspector)&&(Pe=Pe.parentNode,this.removeInspector(),0===be.indexOf(b.kInspect)))return this.showInspector(be,Te);(0,Je.tP)(Pe),(0,ot.$2)(Pe,Te,be)})},A.h=P(m),A.refreshHtml().then(()=>(A.setTopPainter(),A.exapndToLevel(R)))})).apply(this,arguments)}Je.JW.prototype.showInspector=function(N,m){if("check"===N)return!0;const I=this.selectDom(),A=(0,et.xh)(I),R=Math.round(.05*A.width)+"px",k=Math.round(.05*A.height)+"px",J="root_inspector_"+b.internals.id_counter++;return I.append("div").attr("id",J).attr("class","jsroot_inspector").style("position","absolute").style("top",k).style("bottom",k).style("left",R).style("right",R),m?._typename||(m=(0,b.isFunc)(this.getPrimaryObject)?this.getPrimaryObject():this.getObject()),j(J,m,N)},b.internals.drawInspector=j},5983:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Hb:()=>ce,bG:()=>he,gZ:()=>ot,ho:()=>O,jX:()=>ue,kV:()=>Re,o5:()=>ie});var ve=Ee(467),b=Ee(5680),z=Ee(6998),ke=Ee(9041),xe=Ee(6224),et=Ee(6370),Je=Ee(6714);let Xe=null;function ot(){return Xe}function Re(fe){Xe=fe}class He extends ke.b8{constructor(le){super(),this.frameid=le,"$batch$"!==le&&(this.setDom(le),this.selectDom().property("mdi",this)),this.cleanupFrame=xe.tP,this.active_frame_title=""}setInitFrame(le){this.initFrame=le,this.forEachFrame(Y=>le(Y))}beforeCreateFrame(le){this.active_frame_title=le}afterCreateFrame(le){return(0,z.isFunc)(this.initFrame)&&this.initFrame(le),le}forEachFrame(le,Y){console.warn(`forEachFrame not implemented in MDIDisplay ${typeof le} ${Y}`)}forEachPainter(le,Y){this.forEachFrame(V=>{new xe.JW(V).forEachPainter(D=>le(D,V))},Y)}numDraw(){let le=0;return this.forEachFrame(()=>++le),le}findFrame(le,Y){let V=null;return this.forEachFrame(D=>{(0,b.Lt)(D).attr("frame_title")===le&&(V=D)}),!V&&Y&&(V=this.createFrame(le)),V}activateFrame(le){this.active_frame_title=le?(0,b.Lt)(le).attr("frame_title"):""}getActiveFrame(){return this.findFrame(this.active_frame_title)}checkMDIResize(le,Y){let V=null;this.forEachPainter((D,w)=>{if((!le||(0,b.Lt)(w).attr("id")===le)&&null!==D.getItemName()&&(0,z.isFunc)(D.checkResize)){if(V===w)return;D.checkResize(Y),V=w}})}cleanup(){this.active_frame_title="",this.forEachFrame(this.cleanupFrame),this.selectDom().html("").property("mdi",null)}}class O extends He{constructor(le,Y,V){super(le),this.framecnt=0,this.getcnt=0,this.groups=[],this.vertical=Y&&"v"===Y[0],this.use_separarators=!Y||Y.indexOf("x")<0,this.simple_layout=!1;const D=this.selectDom();if(D.style("overflow","hidden"),"simple"===Y)return this.simple_layout=!0,this.use_separarators=!1,void(this.framecnt=1);let P,x,v,w=2;if("projxy"===Y)this.vertical=!1,this.use_separarators=!0,P=[2,2],x=[1,3],v=[[3,1],[3,1]],Y="",this.match_sizes=!0;else if(0===Y.indexOf("grid")||V){Y=V?Y+"x"+V:Y.slice(4).trim(),this.use_separarators=!1,"i"===Y[0]&&(this.use_separarators=!0,Y=Y.slice(1));const _=Y.indexOf("x");let C,L;if(_>0?(L=parseInt(Y.slice(_+1)),C=parseInt(Y.slice(0,_))):C=L=parseInt(Y),Number.isInteger(C)||(C=3),Number.isInteger(L)||(L=3),L>1)this.vertical=!0,w=L,C>1&&(P=new Array(w).fill(C));else{if(!(C>1))return this.simple_layout=!0,this.use_separarators=!1,void(this.framecnt=1);this.vertical=!1,w=C}Y=""}if(Y&&Y.indexOf("_")>0){let _=parseInt(Y.slice(Y.indexOf("_")+1),10);if(Number.isInteger(_)&&_>10)for(Y=Y.slice(0,Y.indexOf("_")),x=[];_>0;)x.unshift(Math.max(_%10,1)),_=Math.round((_-x[0])/10),0===x[0]&&(x[0]=1)}if(Y=Y?parseInt(Y.replace(/^\D+/g,""),10):0,Number.isInteger(Y)&&Y>1)if(Y<10)w=Y;else{for(P=[];Y>0;)P.unshift(Y%10),Y=Math.round((Y-P[0])/10),0===P[0]&&(P[0]=1);w=P.length}x?.length!==w&&(x=void 0),v?.length!==w&&(v=void 0),this.simple_layout||this.createGroup(this,D,w,P,x,v)}createGroup(le,Y,V,D,w,P){w||(w=new Array(V));let x=0,v=0;for(let _=0;_<V;++_)x+=w[_]||1;for(let _=0;_<V;++_)w[_]=Math.round(100*(w[_]||1)/x),v+=w[_],_===V-1&&(w[_]+=100-v);for(let _=0;_<V;++_){const C={id:_,drawid:-1,position:0,size:w[_],parent:le};_>0&&(C.position=le.groups[_-1].position+le.groups[_-1].size),C.position0=C.position,(!D||!D[_]||D[_]<2)&&(C.drawid=this.framecnt++),le.groups.push(C);const L=Y.append("div").attr("groupid",C.id);le.match_sizes&&(C.node=L.node()),le.vertical?L.style("float","bottom").style("height",C.size.toFixed(2)+"%").style("width","100%"):L.style("float","left").style("width",C.size.toFixed(2)+"%").style("height","100%"),C.drawid>=0?(L.classed("jsroot_newgrid",!0),(0,z.isStr)(this.frameid)&&L.attr("id",`${this.frameid}_${C.drawid}`)):L.style("display","flex").style("flex-direction",le.vertical?"row":"column"),D&&D[_]>1&&(C.vertical=!le.vertical,C.groups=[],L.style("overflow","hidden"),this.createGroup(C,L,D[_],null,P?P[_]:null))}if(this.use_separarators&&(0,z.isFunc)(this.createSeparator))for(let _=1;_<V;++_)this.createSeparator(le,Y,le.groups[_])}handleSeparator(le,Y){const V=(j,te)=>{let N=j?.firstChild;for(;N;){if(N.getAttribute("groupid")===te)return(0,b.Lt)(N);N=N.nextSibling}return(0,b.Lt)(j).select(`[groupid='${te}']`)},D=(j,te,N)=>{const m=j.vertical?"height":"width",I=j.groups[N].size.toFixed(2)+"%";V(te,N).style(m,I).selectAll(".jsroot_separator").style(m,I)},w=(j,te)=>{let N=V(j,te);N.classed("jsroot_newgrid")||(N=N.select(".jsroot_newgrid")),N.each(function(){(0,xe.XR)(this)})},P=(j,te,N)=>{N.style(j.vertical?"top":"left",`calc(${te.position.toFixed(2)}% - 2px)`)},x=(0,b.Lt)(le),v=le.parentNode,_=x.property("handle"),C=x.property("separator_id"),L=_.groups[C];let F=!1,U=!1;if("start"===Y)return L.startpos=L.position,void(L.acc_drag=0);if("end"===Y){if(Math.abs(L.startpos-L.position)<.5)return;F=!0}else{let j;"restore"===Y?j=L.position0:_.vertical?(L.acc_drag+=Y.dy,j=L.startpos+(L.acc_drag+2)/v.clientHeight*100):(L.acc_drag+=Y.dx,j=L.startpos+(L.acc_drag+2)/v.clientWidth*100);const te=L.position-j;if(Math.abs(te)<.3||Math.min(_.groups[C-1].size-te,L.size+te)<3)return;_.groups[C-1].size-=te,L.size+=te,L.position=j,P(_,L,x),U=!0,F="restore"===Y}if(U&&(D(_,v,C-1),D(_,v,C)),F&&(w(v,C-1),w(v,C)),_.parent?.match_sizes)for(let j=0;j<_.parent.groups.length;++j){const te=_.parent.groups[j];te===_||!te.node||(te.groups[C].size=_.groups[C].size,te.groups[C].position=_.groups[C].position,te.groups[C-1].size=_.groups[C-1].size,te.groups[C-1].position=_.groups[C-1].position,U&&((0,b.Lt)(te.node).selectAll(".jsroot_separator").each(function(){const N=(0,b.Lt)(this);N.property("separator_id")===C&&P(te,te.groups[C],N)}),D(te,te.node,C-1),D(te,te.node,C)),F&&(w(te.node,C-1),w(te.node,C)))}}createSeparator(le,Y,V){const D=Y.append("div");D.classed("jsroot_separator",!0).property("handle",le).property("separator_id",V.id).attr("style","pointer-events: all; border: 0; margin: 0; padding: 0; position: absolute;").style(le.vertical?"top":"left",`calc(${V.position.toFixed(2)}% - 2px)`).style(le.vertical?"width":"height",(le.size?.toFixed(2)||100)+"%").style(le.vertical?"height":"width","5px").style("cursor",le.vertical?"ns-resize":"ew-resize").append("div").attr("style","position: absolute;"+(le.vertical?"left: 0; right: 0; top: 50%; height: 3px; border-top: 1px dotted #ff0000":"top: 0; bottom: 0; left: 50%; width: 3px; border-left: 1px dotted #ff0000"));const w=this,P=(0,b.$E)().on("start",function(){w.handleSeparator(this,"start")}).on("drag",function(x){w.handleSeparator(this,x)}).on("end",function(){w.handleSeparator(this,"end")});D.call(P).on("dblclick",function(){w.handleSeparator(this,"restore")}),z.browser.touches&&!Y.on("touchmove")&&Y.on("touchmove",()=>{})}forEachFrame(le){this.simple_layout?le(this.getGridFrame()):this.selectDom().selectAll(".jsroot_newgrid").each(function(){le(this)})}getActiveFrame(){if(this.simple_layout)return this.getGridFrame();let le=super.getActiveFrame();return le||(this.forEachFrame(Y=>{le||(le=Y)}),le)}numGridFrames(){return this.framecnt}getGridFrame(le){if(this.simple_layout)return this.selectDom("origin").node();let Y=null;return this.selectDom().selectAll(".jsroot_newgrid").each(function(){0==le--&&(Y=this)}),Y}createFrame(le){this.beforeCreateFrame(le);let Y=null,V=this.framecnt||2;for(;!Y&&V--;)Y=this.getGridFrame(this.getcnt),!this.simple_layout&&this.framecnt&&(this.getcnt=(this.getcnt+1)%this.framecnt),(0,b.Lt)(Y).classed("jsroot_fixed_frame")&&(Y=null);return Y&&(this.cleanupFrame(Y),(0,b.Lt)(Y).attr("frame_title",le)),this.afterCreateFrame(Y)}}class ce extends He{constructor(le){super(le),this.cnt=0,this.selectDom().style("overflow","hidden")}cleanup(){this.selectDom().style("overflow",null),this.cnt=0,super.cleanup()}forEachFrame(le,Y){if((0,z.isFunc)(le))if(Y){const D=this.getActiveFrame();D&&le(D)}else this.selectDom().select(".jsroot_tabs_main").selectAll(".jsroot_tabs_draw").each(function(){le(this)})}modifyTabsFrame(le,Y){const V=this.selectDom().select(".jsroot_tabs"),D=V.select(".jsroot_tabs_labels"),w=V.select(".jsroot_tabs_main");let P,x;if(D.selectAll(".jsroot_tabs_label").each(function(){const _=(0,b.Lt)(this).property("frame_id")===le,C=z.settings.DarkMode?"#333":"white";"activate"===Y?(0,b.Lt)(this).style("background",_?C:z.settings.DarkMode?"black":"#ddd").style("color",z.settings.DarkMode?"#ddd":"inherit").style("border-color",C):"close"===Y&&_&&this.parentNode.remove()}),w.selectAll(".jsroot_tabs_draw").each(function(){(0,b.Lt)(this).property("frame_id")===le?P=this:x=this,"activate"===Y&&(0,b.Lt)(this).style("background",z.settings.DarkMode?"black":"white")}),P)if("activate"===Y)P.parentNode.appendChild(P);else if("close"===Y){const v=P===this.getActiveFrame();(0,xe.tP)(P),P.remove(),v&&this.activateFrame(x)}}activateFrame(le){le&&this.modifyTabsFrame((0,b.Lt)(le).property("frame_id"),"activate"),super.activateFrame(le)}createFrame(le){this.beforeCreateFrame(le);const Y=this.selectDom();let D,w,V=Y.select(".jsroot_tabs");V.empty()?(V=Y.append("div").attr("class","jsroot_tabs").attr("style","display: flex; flex-direction: column; position: absolute; overflow: hidden; left: 0px; top: 0px; bottom: 0px; right: 0px;"),D=V.append("div").attr("class","jsroot_tabs_labels").attr("style","white-space: nowrap; position: relative; overflow-x: auto"),w=V.append("div").attr("class","jsroot_tabs_main").attr("style","margin: 0; flex: 1 1 0%; position: relative")):(D=V.select(".jsroot_tabs_labels"),w=V.select(".jsroot_tabs_main"));const P=this.cnt++,x=this;let v=le;if((!v||!(0,z.isStr)(v))&&(v=`frame_${P}`),v.length>15){let C=v.lastIndexOf("/");C===v.length-1&&(C=v.lastIndexOf("/",C-1)),v=C>0&&v.length-C<20&&v.length-C>1?v.slice(C+1):"..."+v.slice(v.length-17)}D.append("span").attr("tabindex",0).append("label").attr("class","jsroot_tabs_label").attr("style","border: 1px solid; display: inline-block; font-size: 1rem; left: 1px;margin-left: 3px; padding: 0px 5px 1px 5px; position: relative; vertical-align: bottom;").property("frame_id",P).text(v).attr("title",le).on("click",function(C){C.preventDefault(),x.modifyTabsFrame((0,b.Lt)(this).property("frame_id"),"activate")}).append("button").attr("title","close").attr("style","margin-left: .5em; padding: 0; font-size: 0.5em; width: 1.8em; height: 1.8em; vertical-align: center;").html("&#x2715;").on("click",function(){x.modifyTabsFrame((0,b.Lt)(this.parentNode).property("frame_id"),"close")});const _=w.append("div").attr("frame_title",le).attr("class","jsroot_tabs_draw").attr("style","overflow: hidden; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px;").property("frame_id",P);return this.modifyTabsFrame(P,"activate"),this.afterCreateFrame(_.node())}changeDarkMode(){const le=this.getActiveFrame();this.modifyTabsFrame((0,b.Lt)(le).property("frame_id"),"activate")}}class ie extends He{constructor(le){super(le),this.cnt=0,this.selectDom().on("contextmenu",Y=>this.showContextMenu(Y)).style("overflow","auto")}cleanup(){this.selectDom().style("overflow",null).on("contextmenu",null),this.cnt=0,super.cleanup()}forEachFrame(le,Y){if(!(0,z.isFunc)(le))return;const V=this;this.selectDom().select(".jsroot_flex_top").selectAll(".jsroot_flex_draw").each(function(){Y&&"min"===V.getFrameState(this)||le(this)})}getActiveFrame(){let le=super.getActiveFrame();return le&&"min"!==(0,b.Lt)(le.parentNode).property("state")||(le=null,this.forEachFrame(Y=>{le=Y},!0)),le}activateFrame(le){if("first"===le||"last"===le){let V=null;this.forEachFrame(D=>{("last"===le||!V)&&(V=D)},!0),le=V}if(!le||"jsroot_flex_draw"!==le.getAttribute("class")||this.getActiveFrame()===le)return;super.activateFrame(le);const Y=le.parentNode;Y.parentNode.append(Y),"min"!==this.getFrameState(le)&&((0,xe.QD)({pp:(0,xe.m6)(le),active:!0}),(0,xe.XR)(le))}getFrameState(le){return(0,b.Lt)(le.parentNode).property("state")}getFrameRect(le){if("max"===this.getFrameState(le)){const w=this.selectDom().select(".jsroot_flex_top");return{x:0,y:0,w:w.node().clientWidth,h:w.node().clientHeight}}const Y=(0,b.Lt)(le.parentNode),V=Y.style("left"),D=Y.style("top");return{x:parseInt(V.slice(0,V.length-2)),y:parseInt(D.slice(0,D.length-2)),w:Y.node().clientWidth,h:Y.node().clientHeight}}changeFrameState(le,Y,V){const D=(0,b.Lt)(le.parentNode),w=D.property("state"),P=this.selectDom().select(".jsroot_flex_top");if(w===Y)return!1;switch("normal"===w&&D.property("original_style",D.attr("style")),P.style("overflow",null),Y){case"min":D.style("height","auto").style("width","auto"),D.select(".jsroot_flex_draw").style("display","none");break;case"max":D.style("height","100%").style("width","100%").style("left","").style("top",""),D.select(".jsroot_flex_draw").style("display",null),P.style("overflow","hidden");break;default:D.select(".jsroot_flex_draw").style("display",null),D.attr("style",D.property("original_style"))}if(D.select(".jsroot_flex_header").selectAll("button").each(function(x){const v=(0,b.Lt)(this);"minimize"===x.t&&"min"===Y||"maximize"===x.t&&"max"===Y?v.html("&#x259E;").attr("title","restore"):v.html(x.n).attr("title",x.t)}),D.property("state",Y),D.select(".jsroot_flex_resize").style("display","normal"===Y?null:"none"),"min"===Y){const x=this.getFrameRect(le),v=this.selectDom().select(".jsroot_flex_top"),_=v.node().clientWidth,C=v.node().clientHeight,L=[],F=4,U=(te,N)=>te.x<=N.x&&te.x+te.w>=N.x||N.x<=te.x&&N.x+N.w>=te.x,j=(te,N)=>te.y<=N.y&&te.y+te.h>=N.y||N.y<=te.y&&N.y+N.h>=te.y;this.forEachFrame(te=>{te!==le&&"min"===this.getFrameState(te)&&L.push(this.getFrameRect(te))}),x.y=C;do{x.x=F,x.y-=x.h+F;let te=F,N=!1;L.forEach(m=>{j(m,x)&&(te=Math.max(te,m.x+m.w+F),U(m,x)&&(N=!0))}),N&&(x.x=te)}while(x.x+x.w>_-F&&x.y>0);x.y<0&&(x.x=F,x.y=C-x.h-F),D.style("left",x.x+"px").style("top",x.y+"px")}else V||(0,xe.XR)(le);return!0}_clickButton(le){const Y=(0,b.Lt)(le).datum(),V=(0,b.Lt)(le.parentNode.parentNode),D=V.select(".jsroot_flex_draw").node();if("close"===Y.t)return this.cleanupFrame(D),V.remove(),void this.activateFrame("last");const w=V.property("state");let P;P="maximize"===Y.t?"max"===w?"normal":"max":"min"===w?"normal":"min",this.changeFrameState(D,P)&&this.activateFrame("min"!==P?D:"last")}createFrame(le){this.beforeCreateFrame(le);const Y=this,V=this.selectDom();let D=V.select(".jsroot_flex_top");D.empty()&&(D=V.append("div").attr("class","jsroot_flex_top").attr("style","overflow: auto; position: relative; height: 100%; width: 100%"));const w=D.node().clientWidth,P=D.node().clientHeight,x=D.append("div");x.html(`<div class='jsroot_flex_header' style='height: 23px; overflow: hidden; background-color: lightblue'><p style='margin: 1px; float: left; font-size: 14px; padding-left: 5px'>${le}</p></div><div id='${this.frameid}_cont${this.cnt}' class='jsroot_flex_draw' style='overflow: hidden; width: 100%; height: calc(100% - 24px); background: white'></div><div class='jsroot_flex_resize' style='position: absolute; right: 3px; bottom: 1px; overflow: hidden; cursor: nwse-resize'>&#x25FF;</div>`),x.attr("class","jsroot_flex_frame").style("position","absolute").style("left",Math.round(w*(this.cnt%5)/10)+"px").style("top",Math.round(P*(this.cnt%5)/10)+"px").style("width",Math.round(.58*w)+"px").style("height",Math.round(.58*P)+"px").style("border","1px solid black").style("box-shadow","1px 1px 2px 2px #aaa").property("state","normal").select(".jsroot_flex_header").on("click",function(){Y.activateFrame((0,b.Lt)(this.parentNode).select(".jsroot_flex_draw").node())}).selectAll("button").data([{n:"&#x2715;",t:"close"},{n:"&#x2594;",t:"maximize"},{n:"&#x2581;",t:"minimize"}]).enter().append("button").attr("type","button").attr("style","float: right; padding: 0; width: 1.4em; text-align: center; font-size: 10px; margin-top: 2px; margin-right: 4px").attr("title",j=>j.t).html(j=>j.n).on("click",function(){Y._clickButton(this)});let v=null,_=null,C=!1,L=[];const F=(0,b.$E)().subject(Object);F.on("start",function(j){if("button"===j.sourceEvent.target.type)return Y._clickButton(j.sourceEvent.target);if((0,Je.iE)(j.sourceEvent))return;const te=(0,b.Lt)(this.parentNode);!te.classed("jsroot_flex_frame")||"max"===te.property("state")||(C=!(0,b.Lt)(this).classed("jsroot_flex_resize"),(C||"min"!==te.property("state"))&&(Y.activateFrame(te.select(".jsroot_flex_draw").node()),_=D.append("div").attr("style",te.attr("style")).style("border","2px dotted #00F"),"min"===te.property("state")&&_.style("width",te.node().clientWidth+"px").style("height",te.node().clientHeight+"px"),j.sourceEvent.preventDefault(),j.sourceEvent.stopPropagation(),v=te,L=[]))}).on("drag",function(j){if(!_)return;j.sourceEvent.preventDefault(),j.sourceEvent.stopPropagation();const te=(N,m,I)=>{if(N>=L.length){const A=_.style(m);L[N]=parseInt(A.slice(0,A.length-2))}L[N]+=I,_.style(m,Math.max(0,L[N])+"px")};C?(te(0,"left",j.dx),te(1,"top",j.dy)):(te(0,"width",j.dx),te(1,"height",j.dy))}).on("end",function(j){_&&(j.sourceEvent.preventDefault(),j.sourceEvent.stopPropagation(),C?(v.style("left",_.style("left")),v.style("top",_.style("top"))):(v.style("width",_.style("width")),v.style("height",_.style("height"))),_.remove(),_=null,C||(0,xe.XR)(v.select(".jsroot_flex_draw").node()))}),x.select(".jsroot_flex_header").call(F),x.select(".jsroot_flex_resize").call(F);const U=x.select(".jsroot_flex_draw").attr("frame_title",le).property("frame_cnt",this.cnt++).node();return this.afterCreateFrame(U)}minimizeAll(){this.forEachFrame(le=>this.changeFrameState(le,"min"))}showAll(){this.forEachFrame(le=>{"min"===this.getFrameState(le)&&this.changeFrameState(le,"normal")})}closeAllFrames(){const le=[];this.forEachFrame(Y=>le.push(Y)),le.forEach(Y=>{this.cleanupFrame(Y),(0,b.Lt)(Y.parentNode).remove()})}sortFrames(le){const Y=[];if(this.forEachFrame(C=>{const L=this.getFrameState(C);"min"!==L&&("max"===L&&this.changeFrameState(C,"normal",!0),Y.push(C))}),0===Y.length)return;const V=this.selectDom(),D=V.node().clientWidth,w=V.node().clientHeight,P=Math.min(40,Math.round(.4*D/Y.length)),x=Math.min(40,Math.round(.4*w/Y.length));let v=Math.ceil(Math.sqrt(Y.length)),_=v;v>1&&v*(v-1)>=Y.length&&(D>w?_--:v--),Y.forEach((C,L)=>{const F=(0,b.Lt)(C.parentNode);"cascade"===le?F.style("left",L*P+"px").style("top",L*x+"px").style("width",Math.round(.58*D)+"px").style("height",Math.round(.58*w)+"px"):F.style("left",Math.round(D/v*(L%v))+"px").style("top",Math.round(w/_*((L-L%v)/v))+"px").style("width",Math.round(D/v-4)+"px").style("height",Math.round(w/_-4)+"px"),(0,xe.XR)(C)})}showContextMenu(le){if("jsroot_flex_top"!==le.target.getAttribute("class")||0===this.numDraw())return;le.preventDefault();const Y=[];let V=0;this.forEachFrame(w=>{Y.push(w),"min"===this.getFrameState(w)&&V++});const D=this.getActiveFrame();Y.sort((w,P)=>(0,b.Lt)(w).property("frame_cnt")<(0,b.Lt)(P).property("frame_cnt")?-1:1),(0,et.ES)(le,this).then(w=>{w.add("header:Flex"),w.add("Cascade",()=>this.sortFrames("cascade"),"Cascade frames"),w.add("Tile",()=>this.sortFrames("tile"),"Tile all frames"),V<Y.length&&w.add("Minimize all",()=>this.minimizeAll(),"Minimize all frames"),V>0&&w.add("Show all",()=>this.showAll(),"Restore minimized frames"),w.add("Close all",()=>this.closeAllFrames()),w.add("separator"),Y.forEach((P,x)=>w.addchk(P===D,("min"===this.getFrameState(P)?"[min] ":"")+(0,b.Lt)(P).attr("frame_title"),x,v=>{const _=Y[v];"min"===this.getFrameState(_)&&this.changeFrameState(_,"normal"),this.activateFrame(_)})),w.show()})}}class he extends He{constructor(le,Y,V){super("$batch$"),this.frames=[],this.width=le||1200,this.height=Y||800,this.jsdom_body=V||(0,b.Lt)("body")}forEachFrame(le){this.frames.forEach(le)}createFrame(le){this.beforeCreateFrame(le);const Y=this.jsdom_body.append("div").style("visible","hidden").attr("width",this.width).attr("height",this.height).style("width",this.width+"px").style("height",this.height+"px").attr("id","jsroot_batch_"+this.frames.length).attr("frame_title",le);return this.frames.push(Y.node()),this.afterCreateFrame(Y.node())}numFrames(){return this.frames.length}makeJSON(le,Y){const V=this.frames[le];if(!V)return;const D=(0,b.Lt)(V).property("_json_object_");return D?((0,b.Lt)(V).property("_json_object_",null),(0,xe.tP)(V),(0,b.Lt)(V).remove(),(0,z.toJSON)(D,Y)):void 0}makeSVG(le){const Y=this.frames[le];if(!Y)return;const V=(0,b.Lt)(Y);function D(){const P=(0,b.Lt)(this);"none"===P.style("display")&&P.remove()}V.select("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("width",this.width).attr("height",this.height).attr("title",null).attr("style",null).attr("class",null).attr("x",null).attr("y",null),V.selectAll("g.root_frame").each(D),V.selectAll("svg").each(D);const w=(0,ke.NM)(V.html());return(0,xe.tP)(Y),V.remove(),w}}class ue{constructor(le,Y,V){this.gui_div=le,this.hpainter=Y,this.objpainter=V,this.browser_kind=null}main(){return(0,b.Lt)("#"+this.gui_div)}browser(){return this.main().select(".jsroot_browser")}drawing(){return(0,b.Lt)(`#${this.gui_div}_drawing`)}status(){return(0,b.Lt)(`#${this.gui_div}_status`)}drawing_divid(){return this.gui_div+"_drawing"}checkResize(){(0,z.isFunc)(this.hpainter?.checkResize)?this.hpainter.checkResize():(0,z.isFunc)(this.objpainter?.checkResize)&&this.objpainter.checkResize(!0)}createStyle(){const le=z.settings.DarkMode?"black":"#E6E6FA",V=z.settings.DarkMode?"#ddd":"inherit",D=z.settings.DarkMode?`background-color: #222; color: ${V}`:"";(0,Je.fz)(`.jsroot_browser { pointer-events: none; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px; margin: 0px; border: 0px; overflow: hidden; }.jsroot_draw_area { background-color: ${le}; overflow: hidden; margin: 0px; border: 0px; }.jsroot_browser_area { color: ${V}; background-color: ${le}; font-size: 12px; font-family: Verdana; pointer-events: all; box-sizing: initial; }.jsroot_browser_area input { ${D} }.jsroot_browser_area select { ${D} }.jsroot_browser_title { font-family: Verdana; font-size: 20px; color: ${z.settings.DarkMode?"#ccc":"inherit"}; }.jsroot_browser_btns { pointer-events: all; display: flex; flex-direction: column; }.jsroot_browser_area p { margin-top: 5px; margin-bottom: 5px; white-space: nowrap; }.jsroot_browser_hierarchy { flex: 1; margin-top: 2px; }.jsroot_status_area { background-color: ${le}; overflow: hidden; font-size: 12px; font-family: Verdana; pointer-events: all; }.jsroot_browser_resize { position: absolute; right: 3px; bottom: 3px; margin-bottom: 0px; margin-right: 0px; opacity: 0.5; cursor: se-resize; z-index: 1; }`,this.main().node(),"browser_layout_style")}create(le){const Y=this.main();Y.append("div").attr("id",this.drawing_divid()).classed("jsroot_draw_area",!0).style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("right",0),le&&Y.append("div").classed("jsroot_browser",!0),this.createStyle()}createBrowserBtns(){const le=this.browser();if(le.empty())return;let Y=le.select(".jsroot_browser_btns");return Y.empty()?Y=le.append("div").attr("class","jsroot jsroot_browser_btns").attr("style","position: absolute; left: 7px; top: 7px"):Y.html(""),Y}removeBrowserBtns(){this.browser().select(".jsroot_browser_btns").remove()}setBrowserContent(le){const Y=this.browser();Y.empty()||Y.insert("div",".jsroot_browser_btns").classed("jsroot_browser_area",!0).style("position","absolute").style("left","0px").style("top","0px").style("bottom","0px").style("width","250px").style("overflow","hidden").style("padding-left","5px").style("display","flex").style("flex-direction","column").html(`<p class='jsroot_browser_title'>title</p><div class='jsroot_browser_resize' style='display:none'>&#9727</div>${le}`)}hasContent(){const le=this.browser();return!le.empty()&&!le.select(".jsroot_browser_area").empty()}deleteContent(le){const Y=this.browser();Y.empty()||(le||this.createStatusLine(0,"delete"),this.toggleBrowserVisisbility(!0),le?(Y.select(".jsroot_browser_area").remove(),Y.select(".jsroot_browser_btns").remove(),Y.select(".jsroot_v_separator").remove()):Y.selectAll("*").remove(),delete this.browser_visible,delete this.browser_kind,this.checkResize())}hasStatus(){return!this.browser().empty()&&!this.status().empty()}setBrowserTitle(le){const Y=this.browser(),V=Y.empty()?null:Y.select(".jsroot_browser_title");return V&&V.text(le).style("cursor","flex"===this.browser_kind?"move":null),V}toggleKind(le){"changing"!==this.browser_visible&&(le===this.browser_kind?this.toggleBrowserVisisbility():this.toggleBrowserKind(le))}createStatusLine(le,Y){var V=this;return(0,ve.A)(function*(){const D=V.browser();if(D.empty())return"";const w=V.gui_div+"_status",P=(0,b.Lt)("#"+w),x=!P.empty();if("toggle"===Y?Y=!x:"delete"===Y?(Y=!1,le=0,delete V.status_layout):void 0===Y&&(Y=!0,V.status_layout="app"),x)return!0===Y?w:(D.select(".jsroot_h_separator").remove(),P.remove(),"app"!==V.status_layout&&delete V.status_layout,V.status_handler&&z.internals.showStatus===V.status_handler&&(delete z.internals.showStatus,delete V.status_handler),V.adjustSeparators(null,0,!0),"");if(!1===Y)return"";const v=V.drawing().style("left");D.insert("div",".jsroot_browser_area").attr("id",w).classed("jsroot_status_area",!0).style("position","absolute").style("left",v).style("height","20px").style("bottom","0px").style("right","0px").style("margin",0).style("border",0);const _=z.settings.DarkMode?"grey":"azure",C=D.insert("div",".jsroot_browser_area").classed("jsroot_h_separator",!0).attr("style",`pointer-events: all; border: 0; margin: 0; padding: 0; background-color: ${_}; position: absolute; left: ${v}; right: 0; bottom: 20px; height: 5px; cursor: ns-resize;`),L=(0,b.$E)().on("start",()=>{V._hsepar_move=V._hsepar_position,C.style("background-color","grey")}).on("drag",U=>{V._hsepar_move-=U.dy,V.adjustSeparators(null,Math.max(5,Math.round(V._hsepar_move)))}).on("end",()=>{delete V._hsepar_move,C.style("background-color",null),V.checkResize()});if(C.call(L),z.browser.touches&&!D.on("touchmove")&&D.on("touchmove",()=>{}),(!le||(0,z.isStr)(le))&&(le=V.last_hsepar_height||20),V.adjustSeparators(null,le,!0),"app"===V.status_layout)return w;V.status_layout=new O(w,"horizx4_1213");const F=["object name","object title","mouse coordinates","object info"];for(let U=0;U<4;++U)(0,b.Lt)(V.status_layout.getGridFrame(U)).attr("title",F[U]).style("overflow","hidden").append("label").attr("style","margin: 3px; margin-left: 5px; font-size: 14px; vertical-align: middle; white-space: nowrap;");return z.internals.showStatus=V.status_handler=V.showStatus.bind(V),w})()}adjustSeparators(le,Y,V,D){if(!this.gui_div)return;const w=this.browser();if(null===Y&&D&&!w.select(".jsroot_h_separator").empty()&&(Y=w.select(".jsroot_h_separator").style("bottom"),Y=(0,z.isStr)(Y)&&Y.length>2&&Y.indexOf("px")===Y.length-2?Y.slice(0,Y.length-2):null),null!==Y){Y=parseInt(Y);const x=w.select(".jsroot_h_separator");let v=0;if(!x.empty()){Y<5&&(Y=5);const _=w.node().clientHeight-5;_>0&&(Y<0&&(Y+=_),Y>_&&(Y=_)),this.last_hsepar_height=Y,x.style("bottom",Y+"px").style("height","5px"),this.status().style("height",Y+"px"),v=Y+5}this._hsepar_position=Y,this.drawing().style("bottom",`${v}px`)}null!==le&&(le=Math.max(50,Number.parseInt(le)),this._vsepar_position=le,w.select(".jsroot_browser_area").style("width",le-5+"px"),this.drawing().style("left",le+5+"px"),w.select(".jsroot_h_separator").style("left",le+5+"px"),this.status().style("left",le+5+"px"),w.select(".jsroot_v_separator").style("left",le+"px").style("width","5px")),V&&this.checkResize()}showStatus(...le){if(!(0,z.isObject)(this.status_layout)||!(0,z.isFunc)(this.status_layout.getGridFrame))return;let Y=0;for(let V=0;V<4;++V){const D=this.status_layout.getGridFrame(V).querySelector("label");Y=Math.max(Y,D.clientHeight),D.innerHTML=le[V]||""}this.status_layout.first_check||(this.status_layout.first_check=!0,Y>5&&(Y>this.last_hsepar_height||Y<this.last_hsepar_height+5)&&this.adjustSeparators(null,Y,!0))}toggleBrowserVisisbility(le){if(!this.gui_div||(0,z.isStr)(this.browser_visible))return;const Y=this.browser(),V=Y.select(".jsroot_browser_area");if(V.empty())return;const D=Y.select(".jsroot_v_separator"),w=(0,b.Lt)(`#${this.gui_div}_drawing`);let P=V.property("last_left"),x=V.property("last_vsepar"),v=V.property("last_drawing");if(this.browser_visible){V.property("last_left",V.style("left")),D.empty()||(V.property("last_vsepar",D.style("left")),V.property("last_drawing",w.style("left"))),P=-V.node().clientWidth-10+"px";const L=Y.node().clientWidth;D.empty()&&V.node().offsetLeft>L/2&&(P=L+10+"px"),x="-10px",v="0px"}else{if(le)return;V.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}const _=!this.browser_visible,C=le?0:700;this.browser_visible="changing",V.transition().style("left",P).duration(C).on("end",()=>{le||(this.browser_visible=_,_&&this.setButtonsPosition())}),_||Y.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(C),D.empty()||(D.transition().style("left",x).duration(C),w.transition().style("left",v).duration(C).on("end",this.checkResize.bind(this))),this.status_layout&&"fix"===this.browser_kind&&(Y.select(".jsroot_h_separator").transition().style("left",v).duration(C),Y.select(".jsroot_status_area").transition().style("left",v).duration(C))}adjustBrowserSize(le){if(!this.gui_div||"float"!==this.browser_kind)return;const Y=this.browser();if(Y.empty())return;const V=Y.select(".jsroot_browser_area"),D=Y.select(".jsroot_browser_hierarchy"),w=(0,b.Lt)(D.node().firstChild);if(le)return void(V.node().parentNode.clientHeight-10<V.node().clientHeight&&V.style("bottom","0px").style("top","0px"));if(w.empty())return;const P=D.node().clientHeight,x=w.node().clientHeight;void 0!==x&&x<.7*P&&V.style("bottom","")}setButtonsPosition(){if(!this.gui_div)return;const le=this.browser(),Y=le.select(".jsroot_browser_btns");if(Y.empty())return;let V=7,D=7;if(this.browser_visible){const w=le.select(".jsroot_browser_area");V=w.node().offsetTop+7,D=w.node().offsetLeft-le.node().offsetLeft+w.node().clientWidth-27}Y.style("left",`${D}px`).style("top",`${V}px`)}toggleBrowserKind(le){var Y=this;return(0,ve.A)(function*(){if(!Y.gui_div)return null;if(!le){if(!Y.browser_kind)return null;le="float"===Y.browser_kind?"fix":"float"}const V=Y.browser(),D=V.select(".jsroot_browser_area");if("float"===Y.browser_kind?D.style("bottom","0px").style("top","0px").style("width","").style("height","").classed("jsroot_float_browser",!1).style("border",null):"fix"===Y.browser_kind&&(V.select(".jsroot_v_separator").remove(),D.style("left","0px"),Y.drawing().style("left","0px"),V.select(".jsroot_h_separator").style("left","0px"),Y.status().style("left","0px"),Y.checkResize()),Y.browser_kind=le,Y.browser_visible=!0,V.select(".jsroot_browser_resize").style("display","float"===le?null:"none"),V.select(".jsroot_browser_title").style("cursor","float"===le?"move":null),"float"===le){D.style("bottom","40px").classed("jsroot_float_browser",!0).style("border","solid 3px white");const w=(0,b.$E)().on("start",()=>{const x=D.style("left"),v=D.style("top");Y._float_left=parseInt(x.slice(0,x.length-2)),Y._float_top=parseInt(v.slice(0,v.length-2)),Y._max_left=Math.max(0,V.node().clientWidth-D.node().offsetWidth-1),Y._max_top=Math.max(0,V.node().clientHeight-D.node().offsetHeight-1)}).filter(x=>V.select(".jsroot_browser_title").node()===x.target).on("drag",x=>{Y._float_left+=x.dx,Y._float_top+=x.dy,D.style("left",Math.min(Math.max(0,Y._float_left),Y._max_left)+"px").style("top",Math.min(Math.max(0,Y._float_top),Y._max_top)+"px"),Y.setButtonsPosition()}),P=(0,b.$E)().on("start",()=>{const x=D.style("width");Y._float_width=parseInt(x.slice(0,x.length-2)),Y._float_height=D.node().clientHeight,Y._max_width=V.node().clientWidth-D.node().offsetLeft-1,Y._max_height=V.node().clientHeight-D.node().offsetTop-1}).on("drag",x=>{Y._float_width+=x.dx,Y._float_height+=x.dy,D.style("width",Math.min(Math.max(100,Y._float_width),Y._max_width)+"px").style("height",Math.min(Math.max(100,Y._float_height),Y._max_height)+"px"),Y.setButtonsPosition()});V.call(w),V.select(".jsroot_browser_resize").call(P),Y.adjustBrowserSize()}else{D.style("left","0px").style("top","0px").style("bottom","0px").style("height",null);const w=z.settings.DarkMode?"grey":"azure",P=V.append("div").classed("jsroot_v_separator",!0).attr("style",`pointer-events: all; border: 0; margin: 0; padding: 0; background-color: ${w}; position: absolute; top: 0; bottom: 0; cursor: ew-resize;`),x=(0,b.$E)().on("start",()=>{Y._vsepar_move=Y._vsepar_position,P.style("background-color","grey")}).on("drag",v=>{Y._vsepar_move+=v.dx,Y.setButtonsPosition(),z.settings.BrowserWidth=Math.max(50,Math.round(Y._vsepar_move)),Y.adjustSeparators(z.settings.BrowserWidth,null)}).on("end",()=>{delete Y._vsepar_move,P.style("background-color",null),Y.checkResize()});P.call(x),z.browser.touches&&!V.on("touchmove")&&V.on("touchmove",()=>{}),Y.adjustSeparators(z.settings.BrowserWidth,null,!0,!0)}return Y.setButtonsPosition(),Y})()}}},6370:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{ES:()=>Ie,Ew:()=>ot,IV:()=>O,as:()=>ce,sj:()=>ie,wh:()=>he});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(6714),xe=Ee(6823),et=Ee(5284),Je=Ee(8732),Xe=Ee(528);const ot="__front__";class Re{constructor(fe,le,Y){this.painter=fe,this.menuname=le,(0,b.isObject)(Y)&&void 0!==Y.clientX&&void 0!==Y.clientY&&(this.show_evnt={clientX:Y.clientX,clientY:Y.clientY,skip_close:Y.skip_close}),this.remove_handler=()=>this.remove(),this.element=null,this.cnt=0}native(){return!1}load(){var fe=this;return(0,ve.A)(function*(){return fe})()}getEventPosition(){return this.show_evnt}add(){throw Error("add() method has to be implemented in the menu")}size(){return this.cnt}remove(){if(this.element){if(this.show_evnt?.skip_close)return void(this.show_evnt.skip_close=0);if(this.element.remove(),this.element=null,(0,b.isFunc)(this.resolveFunc)){const fe=this.resolveFunc;delete this.resolveFunc,fe()}document.body.removeEventListener("click",this.remove_handler)}}show(){throw Error("show() method has to be implemented in the menu class")}addchk(fe,le,Y,V,D){let w=V;(0,b.isFunc)(Y)&&(D=V,V=Y,w=P=>V("1"===P),Y=fe?"0":"1"),this.add((fe?"chk:":"unk:")+le,Y,w,D)}addDrawMenu(fe,le,Y,V){if(!le||!le.length)return;let D=!1;if(0===fe.indexOf("nosub:")&&(D=!0,fe=fe.slice(6)),1===le.length)return le[0]===b.kInspect&&(fe=fe.replace("Draw","Inspect")),void this.add(fe,le[0],Y);D||this.add("sub:"+fe,le[0],Y,V);for(let w=1;w<le.length;++w){let P=le[w]||(this._use_plain_text?"<dflt>":"&lt;dflt&gt;"),x=w+1;if(le.length>5)for(;x<le.length&&0===le[x].indexOf(P);)x++;if(D&&(P=fe+" "+P),x>=w+2){this.add("sub:"+P,le[w],Y);for(let v=w+1;v<x;++v)this.add(le[v],le[v],Y);this.add("endsub:"),w=x-1}else if(P===b.kInspect){this.add("sub:"+P,le[w],Y,"Inspect object content");for(let v=0;v<10;++v)this.add(v.toString(),b.kInspect+v,Y,`Inspect object and expand to level ${v}`);this.add("endsub:")}else this.add(P,le[w],Y)}D||(this.add("<input>",()=>{const w=(0,b.isFunc)(this.painter?.getDrawOpt)?this.painter.getDrawOpt():le[0];this.input("Provide draw option",w,"text").then(Y)},"Enter draw option in dialog"),this.add("endsub:"))}addColorMenu(fe,le,Y,V){if(void 0===le)return;const D=!(0,b.isStr)(le);this.add("sub:"+fe,()=>{this.input("Enter color "+(D?"(only id number)":"(name or id)"),le,D?"int":"text",D?0:void 0,D?9999:void 0).then(w=>{const P=parseInt(w);if(Number.isInteger(P)&&(0,xe.oU)(P))w=(0,xe.oU)(P);else if(D)return;Y(D?P:w)})});for(let w=0;w<5;++w){this.add("column:");for(let P=0;P<10;P++){let x=10*w+P;D||--x;let v=x<0?"none":(0,xe.oU)(x);0===x&&1===V&&(v="none"),this.add(`<svg width="50" height="18" style="margin:0px;background-color:${v}">${le===(D?x:v)?`<rect width="50" height="18" style="fill:none;stroke-width:3px;stroke:${1===x?"red":"black"}"></rect>`:""}<text x="4" y="12" style='font-size:12px' fill="${1===x?"white":"black"}">${x<=0||"#"!==v[0]?v:`col ${x}`}</text></svg>`,D?x:v,j=>Y(D?parseInt(j):j),"Select color "+v)}if(this.add("endcolumn:"),!this.native())break}this.add("endsub:")}addSizeMenu(fe,le,Y,V,D,w,P){if(void 0===D)return;let x=[],v=!1;if((0,b.isObject)(V))x=V,V=1;else for(let L=le;L<=Y;L+=V)x.push(L);const _=L=>Math.abs(L-D)<1e-5*(Y-le),C=(L,F)=>(L===D&&v&&(F=!0),L.toFixed(V>=1?0:V>=.1?F?2:1:F?4:2));x.findIndex(_)<0&&(v=!0,x.push(D),x=x.sort((L,F)=>L>F)),this.add("sub:"+fe,()=>this.input("Enter value of "+fe,C(D,!0),V>=1?"int":"float").then(w),P),x.forEach(L=>this.addchk(_(L),C(L),L,F=>w(V>=1?Number.parseInt(F):Number.parseFloat(F)))),this.add("endsub:")}addPaletteMenu(fe,le){const Y=(V,D,w,P)=>{D?w||(w=D):D=`pal ${V}`,w&&(w+=`, code ${V}`),this.addchk(V===fe||P,"<nobr>"+D+"</nobr>",V,le,w||D)};if(this.add("sub:Palette",()=>this.input("Enter palette code [1..113]",fe,"int",1,113).then(le)),this.add("column:"),Y(57,"Bird","Default color palette",fe>113),Y(55,"Rainbow"),Y(51,"Deep Sea"),Y(52,"Grayscale","New gray scale"),Y(1,"","Old gray scale",fe>0&&fe<10),Y(50,"ROOT 5","Default color palette in ROOT 5",fe>=10&&fe<51),Y(53,"","Dark body radiator"),Y(54,"","Two-color hue"),Y(56,"","Inverted dark body radiator"),Y(58,"Cubehelix"),Y(59,"","Green Red Violet"),Y(60,"","Blue Red Yellow"),Y(61,"Ocean"),this.add("endcolumn:"),!this.native())return this.add("endsub:");this.add("column:"),Y(62,"","Color Printable On Grey"),Y(63,"Alpine"),Y(64,"Aquamarine"),Y(65,"Army"),Y(66,"Atlantic"),Y(67,"Aurora"),Y(68,"Avocado"),Y(69,"Beach"),Y(70,"Black Body"),Y(71,"","Blue Green Yellow"),Y(72,"Brown Cyan"),Y(73,"CMYK"),Y(74,"Candy"),this.add("endcolumn:"),this.add("column:"),Y(75,"Cherry"),Y(76,"Coffee"),Y(77,"","Dark Rain Bow"),Y(78,"","Dark Terrain"),Y(79,"Fall"),Y(80,"Fruit Punch"),Y(81,"Fuchsia"),Y(82,"Grey Yellow"),Y(83,"","Green Brown Terrain"),Y(84,"Green Pink"),Y(85,"Island"),Y(86,"Lake"),Y(87,"","Light Temperature"),this.add("endcolumn:"),this.add("column:"),Y(88,"","Light Terrain"),Y(89,"Mint"),Y(90,"Neon"),Y(91,"Pastel"),Y(92,"Pearl"),Y(93,"Pigeon"),Y(94,"Plum"),Y(95,"Red Blue"),Y(96,"Rose"),Y(97,"Rust"),Y(98,"","Sandy Terrain"),Y(99,"Sienna"),Y(100,"Solar"),this.add("endcolumn:"),this.add("column:"),Y(101,"","South West"),Y(102,"","Starry Night"),Y(103,"","Sunset"),Y(104,"","Temperature Map"),Y(105,"","Thermometer"),Y(106,"Valentine"),Y(107,"","Visible Spectrum"),Y(108,"","Water Melon"),Y(109,"Cool"),Y(110,"Copper"),Y(111,"","Gist Earth"),Y(112,"Viridis"),Y(113,"Cividis"),this.add("endcolumn:"),this.add("endsub:")}addRebinMenu(fe){this.add("sub:Rebin",()=>this.input("Enter rebin value",2,"int",2).then(fe));for(let le=2;le<=7;le++)this.add(le.toString(),le,Y=>fe(parseInt(Y)));this.add("endsub:")}addSelectMenu(fe,le,Y,V){const D="number"==typeof Y;this.add("sub:"+fe);for(let w=0;w<le.length;++w)this.addchk(D?w===Y:le[w]===Y,le[w],D?w:le[w],P=>V(D?Number.parseInt(P):P));this.add("endsub:")}addRColorMenu(fe,le,Y){const V=["default","black","white","red","green","blue","yellow","magenta","cyan"];this.add("sub:"+fe,()=>{this.input("Enter color name - empty string will reset color",le).then(Y)});let D="black";for(let w=0;w<V.length;++w){const P=V[w];let x=!1,v="";w>0?(v="background-color:"+P,D="white"===P?"black":"white",(0,b.isStr)(le)&&le&&"auto"!==le&&"["!==le[0]&&(x=(0,z.Qh)(le).toString()===(0,z.Qh)(P).toString())):x=!le,this.addchk(x,`<svg width='100' height='18' style='margin:0px;${v}'><text x='4' y='12' style='font-size:12px' fill='${D}'>${P}</text></svg>`,P,C=>Y("default"===C?null:C))}this.add("endsub:")}addRAttrTextItems(fe,le,Y){le||(le={}),this.addRColorMenu("color",fe.color,V=>Y({name:"color",value:V})),fe.scaled?this.addSizeMenu("size",.01,.1,.01,fe.size/fe.scale,V=>Y({name:"size",value:V})):this.addSizeMenu("size",6,20,2,fe.size,V=>Y({name:"size",value:V})),this.addSelectMenu("family",["Arial","Times New Roman","Courier New","Symbol"],fe.name,V=>Y({name:"font_family",value:V})),this.addSelectMenu("style",["normal","italic","oblique"],fe.style||"normal",V=>Y({name:"font_style",value:"normal"===V?null:V})),this.addSelectMenu("weight",["normal","lighter","bold","bolder"],fe.weight||"normal",V=>Y({name:"font_weight",value:"normal"===V?null:V})),le.noalign||this.add("align"),le.noangle||this.add("angle")}addLineStyleMenu(fe,le,Y){this.add("sub:"+fe,()=>this.input("Enter line style id (1-solid)",le,"int",1,11).then(V=>{(0,Je.Ov)(V)&&Y(V)}));for(let V=1;V<11;++V){const D=(0,Je.Ov)(V);this.addchk(le===V,`<svg width='100' height='14'><text x='2' y='13' style='font-size:12px'>${V}</text><line x1='30' y1='7' x2='100' y2='7' stroke='black' stroke-width='3' stroke-dasharray='${D}'></line></svg>`,V,P=>Y(parseInt(P)))}this.add("endsub:")}addFillStyleMenu(fe,le,Y,V,D){this.add("sub:"+fe,()=>{this.input("Enter fill style id (1001-solid, 3000..3010)",le,"int",0,4e3).then(P=>{P>=0&&P<=4e3&&D(P)})});const w=[1,1001,3001,3002,3003,3004,3005,3006,3007,3010,3021,3022];for(let P=0;P<w.length;++P){let x=w[P];if(V){const v=V.createAttFill({std:!1,pattern:w[P],color:Y||1});x=`<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>${w[P].toString()}</text><rect x='40' y='0' width='60' height='18' stroke='none' fill='${v.getFillColor()}'></rect></svg>`}this.addchk(le===w[P],x,w[P],v=>D(parseInt(v)))}this.add("endsub:")}addFontMenu(fe,le,Y){const V=le&&Number.isInteger(le)?le%10:2;this.add("sub:"+fe,()=>{this.input("Enter font id from [0..20]",Math.floor(le/10),"int",0,20).then(w=>{w>=0&&w<=20&&Y(10*w+V)})}),this.add("column:");const D=(0,b.getDocument)();for(let w=1;w<20;++w){const P=10*w+V,x=new Xe.qg(P,14),v=(0,z.Lt)(D.createElementNS("http://www.w3.org/2000/svg","text"));let _=x.getFontName(),C="";x.weight&&(C+="b",_+=" "+x.weight),x.style&&(C+=x.style[0],_+=" "+x.style),C&&(C=" "+C),v.attr("x",1).attr("y",15).text(_.split(" ")[0]+C),x.setFont(v);const L=le!==P?"":"<rect width='90' height='18' style='fill:none;stroke:black'></rect>",F=`<svg width='90' height='18'>${v.node().outerHTML}${L}</svg>`;this.add(F,P,U=>Y(parseInt(U)),`${P}: ${_}`),10===w&&(this.add("endcolumn:"),this.add("column:"))}this.add("endcolumn:"),this.add("endsub:")}addAlignMenu(fe,le,Y){this.add(`sub:${fe}`,()=>{this.input("Enter align like 12 or 31",le).then(w=>{const P=parseInt(w);if(P<11||P>33)return;const x=Math.floor(P/10),v=P%10;x>0&&x<4&&v>0&&v<4&&Y(P)})});const V=["left","middle","right"],D=["bottom","centered","top"];for(let w=1;w<4;++w)for(let P=1;P<4;++P)this.addchk(10*w+P===le,`${10*w+P}: ${V[w-1]} ${D[P-1]}`,10*w+P,x=>Y(parseInt(x)));this.add("endsub:")}addAttributesMenu(fe,le){const Y=fe===fe.getFramePainter(),V=Y?fe.getPadPainter():null;if(le||(le=""),fe.lineatt?.used&&(this.add(`sub:${le}Line att`),this.addSizeMenu("width",1,10,1,fe.lineatt.width,D=>{fe.lineatt.change(void 0,D),(0,ke.sd)(fe,"fLineWidth",D),V&&(0,ke.sd)(V,"fFrameLineWidth",D),fe.interactiveRedraw(!0,`exec:SetLineWidth(${D})`)}),this.addColorMenu("color",fe.lineatt.color,D=>{fe.lineatt.change(D),(0,ke.sd)(fe,"fLineColor",D,!0),V&&(0,ke.sd)(V,"fFrameLineColor",D,!0),fe.interactiveRedraw(!0,(0,ke.pp)(D,"SetLineColor"))}),this.addLineStyleMenu("style",fe.lineatt.style,D=>{fe.lineatt.change(void 0,void 0,D),(0,ke.sd)(fe,"fLineStyle",D),V&&(0,ke.sd)(V,"fFrameLineStyle",D),fe.interactiveRedraw(!0,`exec:SetLineStyle(${D})`)}),this.add("endsub:"),!Y&&fe.lineatt?.excl_side)){this.add("sub:Exclusion"),this.add("sub:side");for(let D=-1;D<=1;++D)this.addchk(fe.lineatt.excl_side===D,D,D,w=>{fe.lineatt.changeExcl(parseInt(w)),fe.interactiveRedraw()});this.add("endsub:"),this.addSizeMenu("width",10,100,10,fe.lineatt.excl_width,D=>{fe.lineatt.changeExcl(void 0,D),fe.interactiveRedraw()}),this.add("endsub:")}if(fe.fillatt?.used&&(this.add(`sub:${le}Fill att`),this.addColorMenu("color",fe.fillatt.colorindx,D=>{fe.fillatt.change(D,void 0,fe.getCanvSvg()),(0,ke.sd)(fe,"fFillColor",D,!0),V&&(0,ke.sd)(V,"fFrameFillColor",D,!0),fe.interactiveRedraw(!0,(0,ke.pp)(D,"SetFillColor"))},fe.fillatt.kind),this.addFillStyleMenu("style",fe.fillatt.pattern,fe.fillatt.colorindx,fe,D=>{fe.fillatt.change(void 0,D,fe.getCanvSvg()),(0,ke.sd)(fe,"fFillStyle",D),V&&(0,ke.sd)(V,"fFrameFillStyle",D),fe.interactiveRedraw(!0,`exec:SetFillStyle(${D})`)}),this.add("endsub:")),fe.markeratt?.used){this.add(`sub:${le}Marker att`),this.addColorMenu("color",fe.markeratt.color,w=>{(0,ke.sd)(fe,"fMarkerColor",w,!0),fe.markeratt.change(w),fe.interactiveRedraw(!0,(0,ke.pp)(w,"SetMarkerColor"))}),this.addSizeMenu("size",.5,6,.5,fe.markeratt.size,w=>{(0,ke.sd)(fe,"fMarkerSize",w),fe.markeratt.change(void 0,void 0,w),fe.interactiveRedraw(!0,`exec:SetMarkerSize(${w})`)}),this.add("sub:style");const D=[1,2,3,4,5,6,7,8,21,22,23,24,25,26,27,28,29,30,31,32,33,34];for(let w=0;w<D.length;++w){const P=new et.e({style:D[w],color:fe.markeratt.color,size:1.7}),x=`<svg width='60' height='18'><text x='1' y='12' style='font-size:12px'>${D[w].toString()}</text><path stroke='black' fill='${P.fill?"black":"none"}' d='${P.create(40,8)}'></path></svg>`;this.addchk(fe.markeratt.style===D[w],x,D[w],v=>{fe.markeratt.change(void 0,parseInt(v)),fe.interactiveRedraw(!0,`exec:SetMarkerStyle(${v})`)})}this.add("endsub:"),this.add("endsub:")}if(fe.textatt?.used){this.add(`sub:${le}Text att`),this.addFontMenu("font",fe.textatt.font,w=>{(0,ke.sd)(fe,"fTextFont",w),fe.textatt.change(w),fe.interactiveRedraw(!0,`exec:SetTextFont(${w})`)});const D=fe.textatt.size<1;this.addSizeMenu("size",D?.03:6,D?.2:26,D?.01:2,fe.textatt.size,w=>{(0,ke.sd)(fe,"fTextSize",w),fe.textatt.change(void 0,w),fe.interactiveRedraw(!0,`exec:SetTextSize(${w})`)}),this.addColorMenu("color",fe.textatt.color,w=>{(0,ke.sd)(fe,"fTextColor",w,!0),fe.textatt.change(void 0,void 0,w),fe.interactiveRedraw(!0,(0,ke.pp)(w,"SetTextColor"))}),this.addAlignMenu("align",fe.textatt.align,w=>{(0,ke.sd)(fe,"fTextAlign",w),fe.textatt.change(void 0,void 0,void 0,w),fe.interactiveRedraw(!0,`exec:SetTextAlign(${w})`)}),fe.textatt.can_rotate&&this.addSizeMenu("angle",-180,180,45,fe.textatt.angle,w=>{(0,ke.sd)(fe,"fTextAngle",w),fe.textatt.change(void 0,void 0,void 0,void 0,w),fe.interactiveRedraw(!0,`exec:SetTextAngle(${w})`)}),this.add("endsub:")}}addTAxisMenu(fe,le,Y,V){const D=Y._typename===b.clTGaxis;this.add("Divisions",()=>this.input("Set Ndivisions",Y.fNdivisions,"int",0).then(P=>{Y.fNdivisions=P,le.interactiveRedraw("pad",`exec:SetNdivisions(${P})`,V)})),this.add("sub:Labels"),this.addchk(Y.TestBit(fe.kCenterLabels),"Center",P=>{Y.InvertBit(fe.kCenterLabels),le.interactiveRedraw("pad",`exec:CenterLabels(${P})`,V)}),this.addchk(Y.TestBit(fe.kLabelsVert),"Rotate",P=>{Y.InvertBit(fe.kLabelsVert),le.interactiveRedraw("pad",`exec:SetBit(TAxis::kLabelsVert,${P})`,V)}),this.addColorMenu("Color",Y.fLabelColor,P=>{Y.fLabelColor=P,le.interactiveRedraw("pad",(0,ke.pp)(P,"SetLabelColor"),V)}),this.addSizeMenu("Offset",-.02,.1,.01,Y.fLabelOffset,P=>{Y.fLabelOffset=P,le.interactiveRedraw("pad",`exec:SetLabelOffset(${P})`,V)});let w=Y.fLabelSize>=1;this.addSizeMenu("Size",w?2:.02,w?30:.11,w?2:.01,Y.fLabelSize,P=>{Y.fLabelSize=P,le.interactiveRedraw("pad",`exec:SetLabelSize(${P})`,V)}),this.add("endsub:"),this.add("sub:Title"),this.add("SetTitle",()=>{this.input("Enter axis title",Y.fTitle).then(P=>{Y.fTitle=P,le.interactiveRedraw("pad",`exec:SetTitle("${P}")`,V)})}),this.addchk(Y.TestBit(fe.kCenterTitle),"Center",P=>{Y.InvertBit(fe.kCenterTitle),le.interactiveRedraw("pad",`exec:CenterTitle(${P})`,V)}),this.addchk(Y.TestBit(fe.kOppositeTitle),"Opposite",()=>{Y.InvertBit(fe.kOppositeTitle),le.redrawPad()}),this.addchk(Y.TestBit(fe.kRotateTitle),"Rotate",P=>{Y.InvertBit(fe.kRotateTitle),le.interactiveRedraw("pad",D?`exec:SetBit(TAxis::kRotateTitle, ${P})`:`exec:RotateTitle(${P})`,V)}),D?this.addColorMenu("Color",Y.fTextColor,P=>{Y.fTextColor=P,le.interactiveRedraw("pad",(0,ke.pp)(P,"SetTitleColor"),V)}):this.addColorMenu("Color",Y.fTitleColor,P=>{Y.fTitleColor=P,le.interactiveRedraw("pad",(0,ke.pp)(P,"SetTitleColor"),V)}),this.addSizeMenu("Offset",0,3,.2,Y.fTitleOffset,P=>{Y.fTitleOffset=P,le.interactiveRedraw("pad",`exec:SetTitleOffset(${P})`,V)}),w=Y.fTitleSize>=1,this.addSizeMenu("Size",w?2:.02,w?30:.11,w?2:.01,Y.fTitleSize,P=>{Y.fTitleSize=P,le.interactiveRedraw("pad",`exec:SetTitleSize(${P})`,V)}),this.add("endsub:"),this.add("sub:Ticks"),D?(this.addColorMenu("Color",Y.fLineColor,P=>{Y.fLineColor=P,le.interactiveRedraw("pad",(0,ke.pp)(P,"SetLineColor"),V)}),this.addSizeMenu("Size",-.05,.055,.01,Y.fTickSize,P=>{Y.fTickSize=P,le.interactiveRedraw("pad",`exec:SetTickLength(${P})`,V)})):(this.addColorMenu("Color",Y.fAxisColor,P=>{Y.fAxisColor=P,le.interactiveRedraw("pad",(0,ke.pp)(P,"SetAxisColor"),V)}),this.addSizeMenu("Size",-.05,.055,.01,Y.fTickLength,P=>{Y.fTickLength=P,le.interactiveRedraw("pad",`exec:SetTickLength(${P})`,V)})),this.add("endsub:"),D&&this.add("Options",()=>this.input("Enter TGaxis options like +L or -G",Y.fChopt,"string").then(P=>{Y.fChopt=P,le.interactiveRedraw("pad",`exec:SetOption("${P}")`,V)}))}addSettingsMenu(fe,le,Y){this.add(le?"header:Settings":"sub:Settings"),this.add("sub:Files"),fe&&(this.addchk(b.settings.OnlyLastCycle,"Last cycle",w=>{b.settings.OnlyLastCycle=w,Y&&Y("refresh")}),this.addchk(!b.settings.SkipStreamerInfos,"Streamer infos",w=>{b.settings.SkipStreamerInfos=!w,Y&&Y("refresh")})),this.addchk(b.settings.UseStamp,"Use stamp arg",w=>{b.settings.UseStamp=w}),this.addSizeMenu("Max ranges",1,1e3,[1,10,20,50,200,1e3],b.settings.MaxRanges,w=>{b.settings.MaxRanges=w},"Maximal number of ranges in single http request"),this.addchk(b.settings.HandleWrongHttpResponse,"Handle wrong http response",w=>{b.settings.HandleWrongHttpResponse=w}),this.addchk(b.settings.WithCredentials,"With credentials",w=>{b.settings.WithCredentials=w},"Submit http request with user credentials"),this.add("endsub:"),this.add("sub:Toolbar"),this.addchk(!1===b.settings.ToolBar,"Off",w=>{b.settings.ToolBar=!w}),this.addchk(!0===b.settings.ToolBar,"On",w=>{b.settings.ToolBar=w}),this.addchk("popup"===b.settings.ToolBar,"Popup",w=>{b.settings.ToolBar=!!w&&"popup"}),this.add("separator"),this.addchk("left"===b.settings.ToolBarSide,"Left side",w=>{b.settings.ToolBarSide=w?"left":"right"}),this.addchk(b.settings.ToolBarVert,"Vertical",w=>{b.settings.ToolBarVert=w}),this.add("endsub:"),this.add("sub:Interactive"),this.addchk(b.settings.Tooltip,"Tooltip",w=>{b.settings.Tooltip=w}),this.addchk(b.settings.ContextMenu,"Context menus",w=>{b.settings.ContextMenu=w}),this.add("sub:Zooming"),this.addchk(b.settings.Zooming,"Global",w=>{b.settings.Zooming=w}),this.addchk(b.settings.ZoomMouse,"Mouse",w=>{b.settings.ZoomMouse=w}),this.addchk(b.settings.ZoomWheel,"Wheel",w=>{b.settings.ZoomWheel=w}),this.addchk(b.settings.ZoomTouch,"Touch",w=>{b.settings.ZoomTouch=w}),this.add("endsub:"),this.addchk(b.settings.HandleKeys,"Keypress handling",w=>{b.settings.HandleKeys=w}),this.addchk(b.settings.MoveResize,"Move and resize",w=>{b.settings.MoveResize=w}),this.addchk(b.settings.DragAndDrop,"Drag and drop",w=>{b.settings.DragAndDrop=w}),this.addchk(b.settings.DragGraphs,"Drag graph points",w=>{b.settings.DragGraphs=w}),this.addSelectMenu("Progress box",["off","on","modal"],(0,b.isStr)(b.settings.ProgressBox)?b.settings.ProgressBox:b.settings.ProgressBox?"on":"off",w=>{b.settings.ProgressBox="off"!==w&&(" on"===w||w)}),this.add("endsub:"),this.add("sub:Drawing"),this.addSelectMenu("Optimize",["None","Smart","Always"],b.settings.OptimizeDraw,w=>{b.settings.OptimizeDraw=w}),this.addPaletteMenu(b.settings.Palette,w=>{b.settings.Palette=w}),this.addchk(b.settings.AutoStat,"Auto stat box",w=>{b.settings.AutoStat=w}),this.addSelectMenu("Latex",["Off","Symbols","Normal","MathJax","Force MathJax"],b.settings.Latex,w=>{b.settings.Latex=w}),this.addSelectMenu("3D rendering",["Default","WebGL","Image"],b.settings.Render3D,w=>{b.settings.Render3D=w}),this.addSelectMenu("WebGL embeding",["Default","Overlay","Embed"],b.settings.Embed3D,w=>{b.settings.Embed3D=w}),this.add("endsub:"),this.add("sub:Geometry"),this.add("Grad per segment:  "+b.settings.GeoGradPerSegm,()=>this.input("Grad per segment in geometry",b.settings.GeoGradPerSegm,"int",1,60).then(w=>{b.settings.GeoGradPerSegm=w})),this.addchk(b.settings.GeoCompressComp,"Compress composites",w=>{b.settings.GeoCompressComp=w}),this.add("endsub:"),fe&&(this.add("sub:Browser"),this.add("Hierarchy limit:  "+b.settings.HierarchyLimit,()=>this.input("Max number of items in hierarchy",b.settings.HierarchyLimit,"int",10,1e5).then(w=>{b.settings.HierarchyLimit=w,Y&&Y("refresh")})),this.add("Browser width:  "+b.settings.BrowserWidth,()=>this.input("Browser width in px",b.settings.BrowserWidth,"int",50,2e3).then(w=>{b.settings.BrowserWidth=w,Y&&Y("width")})),this.add("endsub:")),this.add("Dark mode: "+(b.settings.DarkMode?"On":"Off"),()=>{b.settings.DarkMode=!b.settings.DarkMode,Y&&Y("dark")});const V=w=>{b.gStyle[w.slice(1)]=parseInt(w[0])},D=(w,P,x)=>{this.add("sub:"+w);const v=b.gStyle[P]>=x.length?1:b.gStyle[P];for(let _=0;_<x.length;++_)this.addchk(v===_,x[_],`${_}${P}`,V);this.add("endsub:")};this.add("sub:gStyle"),this.add("sub:Canvas"),this.addColorMenu("Color",b.gStyle.fCanvasColor,w=>{b.gStyle.fCanvasColor=w}),D("Draw date","fOptDate",["Off","Current time","File create time","File modify time"]),this.add(`Time zone: ${b.settings.TimeZone}`,()=>this.input("Input time zone like UTC. empty string - local timezone",b.settings.TimeZone,"string").then(w=>{b.settings.TimeZone=w})),D("Draw file","fOptFile",["Off","File name","Full file URL","Item name"]),this.addSizeMenu("Date X",.01,.1,.01,b.gStyle.fDateX,w=>{b.gStyle.fDateX=w},"configure gStyle.fDateX for date/item name drawings"),this.addSizeMenu("Date Y",.01,.1,.01,b.gStyle.fDateY,w=>{b.gStyle.fDateY=w},"configure gStyle.fDateY for date/item name drawings"),this.add("endsub:"),this.add("sub:Pad"),this.addColorMenu("Color",b.gStyle.fPadColor,w=>{b.gStyle.fPadColor=w}),this.add("sub:Grid"),this.addchk(b.gStyle.fPadGridX,"X",w=>{b.gStyle.fPadGridX=w}),this.addchk(b.gStyle.fPadGridY,"Y",w=>{b.gStyle.fPadGridY=w}),this.addColorMenu("Color",b.gStyle.fGridColor,w=>{b.gStyle.fGridColor=w}),this.addSizeMenu("Width",1,10,1,b.gStyle.fGridWidth,w=>{b.gStyle.fGridWidth=w}),this.addLineStyleMenu("Style",b.gStyle.fGridStyle,w=>{b.gStyle.fGridStyle=w}),this.add("endsub:"),D("Ticks X","fPadTickX",["normal","ticks on both sides","labels on both sides"]),D("Ticks Y","fPadTickY",["normal","ticks on both sides","labels on both sides"]),D("Log X","fOptLogx",["off","on","log 2"]),D("Log Y","fOptLogy",["off","on","log 2"]),D("Log Z","fOptLogz",["off","on","log 2"]),this.add("endsub:"),this.add("sub:Frame"),this.addColorMenu("Fill color",b.gStyle.fFrameFillColor,w=>{b.gStyle.fFrameFillColor=w}),this.addFillStyleMenu("Fill style",b.gStyle.fFrameFillStyle,b.gStyle.fFrameFillColor,null,w=>{b.gStyle.fFrameFillStyle=w}),this.addColorMenu("Line color",b.gStyle.fFrameLineColor,w=>{b.gStyle.fFrameLineColor=w}),this.addSizeMenu("Line width",1,10,1,b.gStyle.fFrameLineWidth,w=>{b.gStyle.fFrameLineWidth=w}),this.addLineStyleMenu("Line style",b.gStyle.fFrameLineStyle,w=>{b.gStyle.fFrameLineStyle=w}),this.addSizeMenu("Border size",0,10,1,b.gStyle.fFrameBorderSize,w=>{b.gStyle.fFrameBorderSize=w}),this.add("sub:Margins"),this.addSizeMenu("Bottom",0,.5,.05,b.gStyle.fPadBottomMargin,w=>{b.gStyle.fPadBottomMargin=w}),this.addSizeMenu("Top",0,.5,.05,b.gStyle.fPadTopMargin,w=>{b.gStyle.fPadTopMargin=w}),this.addSizeMenu("Left",0,.5,.05,b.gStyle.fPadLeftMargin,w=>{b.gStyle.fPadLeftMargin=w}),this.addSizeMenu("Right",0,.5,.05,b.gStyle.fPadRightMargin,w=>{b.gStyle.fPadRightMargin=w}),this.add("endsub:"),this.add("endsub:"),this.add("sub:Title"),this.addColorMenu("Fill color",b.gStyle.fTitleColor,w=>{b.gStyle.fTitleColor=w}),this.addFillStyleMenu("Fill style",b.gStyle.fTitleStyle,b.gStyle.fTitleColor,null,w=>{b.gStyle.fTitleStyle=w}),this.addColorMenu("Text color",b.gStyle.fTitleTextColor,w=>{b.gStyle.fTitleTextColor=w}),this.addSizeMenu("Border size",0,10,1,b.gStyle.fTitleBorderSize,w=>{b.gStyle.fTitleBorderSize=w}),this.addSizeMenu("Font size",.01,.1,.01,b.gStyle.fTitleFontSize,w=>{b.gStyle.fTitleFontSize=w}),this.addFontMenu("Font",b.gStyle.fTitleFont,w=>{b.gStyle.fTitleFont=w}),this.addSizeMenu("X: "+b.gStyle.fTitleX.toFixed(2),0,1,.1,b.gStyle.fTitleX,w=>{b.gStyle.fTitleX=w}),this.addSizeMenu("Y: "+b.gStyle.fTitleY.toFixed(2),0,1,.1,b.gStyle.fTitleY,w=>{b.gStyle.fTitleY=w}),this.addSizeMenu("W: "+b.gStyle.fTitleW.toFixed(2),0,1,.1,b.gStyle.fTitleW,w=>{b.gStyle.fTitleW=w}),this.addSizeMenu("H: "+b.gStyle.fTitleH.toFixed(2),0,1,.1,b.gStyle.fTitleH,w=>{b.gStyle.fTitleH=w}),this.add("endsub:"),this.add("sub:Stat box"),this.addColorMenu("Fill color",b.gStyle.fStatColor,w=>{b.gStyle.fStatColor=w}),this.addFillStyleMenu("Fill style",b.gStyle.fStatStyle,b.gStyle.fStatColor,null,w=>{b.gStyle.fStatStyle=w}),this.addColorMenu("Text color",b.gStyle.fStatTextColor,w=>{b.gStyle.fStatTextColor=w}),this.addSizeMenu("Border size",0,10,1,b.gStyle.fStatBorderSize,w=>{b.gStyle.fStatBorderSize=w}),this.addSizeMenu("Font size",0,30,5,b.gStyle.fStatFontSize,w=>{b.gStyle.fStatFontSize=w}),this.addFontMenu("Font",b.gStyle.fStatFont,w=>{b.gStyle.fStatFont=w}),this.add("Stat format",()=>this.input("Stat format",b.gStyle.fStatFormat).then(w=>{b.gStyle.fStatFormat=w})),this.addSizeMenu("X: "+b.gStyle.fStatX.toFixed(2),.2,1,.1,b.gStyle.fStatX,w=>{b.gStyle.fStatX=w}),this.addSizeMenu("Y: "+b.gStyle.fStatY.toFixed(2),.2,1,.1,b.gStyle.fStatY,w=>{b.gStyle.fStatY=w}),this.addSizeMenu("Width: "+b.gStyle.fStatW.toFixed(2),.1,1,.1,b.gStyle.fStatW,w=>{b.gStyle.fStatW=w}),this.addSizeMenu("Height: "+b.gStyle.fStatH.toFixed(2),.1,1,.1,b.gStyle.fStatH,w=>{b.gStyle.fStatH=w}),this.add("endsub:"),this.add("sub:Legend"),this.addColorMenu("Fill color",b.gStyle.fLegendFillColor,w=>{b.gStyle.fLegendFillColor=w}),this.addSizeMenu("Border size",0,10,1,b.gStyle.fLegendBorderSize,w=>{b.gStyle.fLegendBorderSize=w}),this.addFontMenu("Font",b.gStyle.fLegendFont,w=>{b.gStyle.fLegendFont=w}),this.addSizeMenu("Text size",0,.1,.01,b.gStyle.fLegendTextSize,w=>{b.gStyle.fLegendTextSize=w},"legend text size, when 0 - auto adjustment is used"),this.add("endsub:"),this.add("sub:Histogram"),this.addchk(1===b.gStyle.fOptTitle,"Hist title",w=>{b.gStyle.fOptTitle=w?1:0}),this.addchk(b.gStyle.fOrthoCamera,"Orthographic camera",w=>{b.gStyle.fOrthoCamera=w}),this.addchk(b.gStyle.fHistMinimumZero,"Base0",w=>{b.gStyle.fHistMinimumZero=w},"when true, BAR and LEGO drawing using base = 0"),this.add("Text format",()=>this.input("Paint text format",b.gStyle.fPaintTextFormat).then(w=>{b.gStyle.fPaintTextFormat=w})),this.add("Time offset",()=>this.input("Time offset in seconds, default is 788918400 for 1/1/1995",b.gStyle.fTimeOffset,"int").then(w=>{b.gStyle.fTimeOffset=w})),this.addSizeMenu("ErrorX: "+b.gStyle.fErrorX.toFixed(2),0,1,.1,b.gStyle.fErrorX,w=>{b.gStyle.fErrorX=w}),this.addSizeMenu("End error",0,12,1,b.gStyle.fEndErrorSize,w=>{b.gStyle.fEndErrorSize=w},"size in pixels of end error for E1 draw options, gStyle.fEndErrorSize"),this.addSizeMenu("Top margin",0,.5,.05,b.gStyle.fHistTopMargin,w=>{b.gStyle.fHistTopMargin=w},"Margin between histogram top and frame top"),this.addColorMenu("Fill color",b.gStyle.fHistFillColor,w=>{b.gStyle.fHistFillColor=w}),this.addFillStyleMenu("Fill style",b.gStyle.fHistFillStyle,b.gStyle.fHistFillColor,null,w=>{b.gStyle.fHistFillStyle=w}),this.addColorMenu("Line color",b.gStyle.fHistLineColor,w=>{b.gStyle.fHistLineColor=w}),this.addSizeMenu("Line width",1,10,1,b.gStyle.fHistLineWidth,w=>{b.gStyle.fHistLineWidth=w}),this.addLineStyleMenu("Line style",b.gStyle.fHistLineStyle,w=>{b.gStyle.fHistLineStyle=w}),this.add("endsub:"),this.add("separator"),this.add("sub:Predefined"),["Modern","Plain","Bold"].forEach(w=>this.addchk(b.gStyle.fName===w,w,w,ke.Jb)),this.add("endsub:"),this.add("endsub:"),this.add("separator"),this.add("Save settings",()=>{((0,ke.sb)(!0)?Promise.resolve(!0):this.confirm("Save settings","Pressing OK one agreess that JSROOT will store settings in browser local storage")).then(P=>{P&&((0,ke.DZ)(),(0,ke.PL)())})},"Store settings and gStyle in browser local storage"),this.add("Delete settings",()=>{(0,ke.DZ)(-1),(0,ke.PL)(-1)},"Delete settings and gStyle from browser local storage"),le||this.add("endsub:")}runModal(){return(0,ve.A)(function*(){throw Error("runModal() must be reimplemented")})()}info(fe,le){return this.runModal(fe,`<p>${le}</p>`,{height:120,width:400,resizable:!0})}confirm(fe,le){var Y=this;return(0,ve.A)(function*(){return Y.runModal(fe,le,{btns:!0,height:120,width:400}).then(V=>!!V)})()}input(fe,le,Y,V,D){var w=this;return(0,ve.A)(function*(){Y||(Y="text");let x="";null==le&&(le=""),"int"===Y&&(void 0!==V&&(x+=` min="${V}"`),void 0!==D&&(x+=` max="${D}"`));const v=`<form><fieldset style="padding:0; border:0"><input type="${"int"===Y?"number":"text"}" value="${le}" ${x} style="width:98%;display:block" class="jsroot_dlginp"/></fieldset></form>`;return new Promise(_=>{w.runModal(fe,v,{btns:!0,height:150,width:400}).then(C=>{if(!C)return;let L=C.querySelector(".jsroot_dlginp").value;"float"===Y?(L=Number.parseFloat(L),Number.isFinite(L)&&_(L)):"int"===Y?(L=parseInt(L),Number.isInteger(L)&&_(L)):_(L)})})})()}showMethodArgsDialog(fe){var le=this;return(0,ve.A)(function*(){const Y=le.menuname+"_dialog";let V='<form> <fieldset style="padding:0; border:0">';for(let D=0;D<fe.fArgs.length;++D){const w=fe.fArgs[D];w.fValue=w.fDefault,'""'===w.fValue&&(w.fValue=""),V+=`<label for="${Y}_inp${D}">${w.fName}</label>\n                          <input type='text' tabindex="${D+1}" id="${Y}_inp${D}" value="${w.fValue}" style="width:100%;display:block"/>`}return V+="</fieldset></form>",new Promise(D=>{le.runModal(fe.fClassName+"::"+fe.fName,V,{btns:!0,height:100+60*fe.fArgs.length,width:400,resizable:!0}).then(w=>{if(!w)return;let P="";for(let x=0;x<fe.fArgs.length;++x){const v=fe.fArgs[x];let _=w.querySelector(`#${Y}_inp${x}`).value;""===_&&(_=v.fDefault),("Option_t*"===v.fTitle||"const char*"===v.fTitle)&&(_||(_='""'),'"'!==_[0]&&(_='"'+_),'"'!==_[_.length-1]&&(_+='"')),P+=(x>0?",":"")+_}D(P)})})})()}showCommandArgsDialog(fe,le){var Y=this;return(0,ve.A)(function*(){const V=Y.menuname+"_dialog";let D='<form> <fieldset style="padding:0; border:0">';for(let w=0;w<le.length;++w)D+=`<label for="${V}_inp${w}">arg${w+1}</label><input type='text' id="${V}_inp${w}" value="${le[w]}" style="width:100%;display:block"/>`;return D+="</fieldset></form>",new Promise(w=>{Y.runModal("Arguments for command "+fe,D,{btns:!0,height:110+60*le.length,width:400,resizable:!0}).then(P=>{if(!P)return w(null);const x=[];for(let v=0;v<le.length;++v)x.push(P.querySelector(`#${V}_inp${v}`).value);w(x)})})})()}}class He extends Re{constructor(fe,le,Y){super(fe,le,Y),this.code=[],this._use_plain_text=!0,this.stack=[this.code]}native(){return!0}load(){var fe=this;return(0,ve.A)(function*(){return fe})()}add(fe,le,Y,V){let D=this.stack[this.stack.length-1];if("separator"===fe)return D.push({divider:!0});if(0===fe.indexOf("header:"))return D.push({text:fe.slice(7),header:!0});if("endsub:"===fe)return this.stack.pop(),D=this.stack[this.stack.length-1],void(0===D[D.length-1].sub.length&&(D[D.length-1].sub=void 0));if("endcolumn:"===fe)return this.stack.pop();(0,b.isFunc)(le)&&(V=Y,Y=le,le=fe);const w={};if(D.push(w),"column:"===fe)return w.column=!0,w.sub=[],void this.stack.push(w.sub);0===fe.indexOf("sub:")&&(fe=fe.slice(4),w.sub=[],this.stack.push(w.sub)),0===fe.indexOf("chk:")?(w.checked=!0,fe=fe.slice(4)):0===fe.indexOf("unk:")&&(w.checked=!1,fe=fe.slice(4)),w.text=fe,w.title=V,w.arg=le,w.func=Y}size(){return this.code.length}_buildContextmenu(fe,le,Y,V){const D=(0,b.getDocument)(),w=D.createElement("div"),P="position: absolute; top: 0; user-select: none; z-index: 100000; background-color: rgb(250, 250, 250); margin: 0; padding: 0px; width: auto;min-width: 100px; box-shadow: 0px 0px 10px rgb(0, 0, 0, 0.2); border: 3px solid rgb(215, 215, 215); font-family: Arial, helvetica, sans-serif, serif;font-size: 13px; color: rgb(0, 0, 0, 0.8); line-height: 15px;";if(V===D.body){const L=D.getElementsByClassName("jsroot_ctxt_container");for(;L.length>0;)L[0].parentNode.removeChild(L[0]);w.className="jsroot_ctxt_container",w.style=P,w.style.position="fixed",w.style.left=le+"px",w.style.top=Y+"px"}else le<0&&Y===le?(w.className="jsroot_ctxt_column",w.style.float="left",w.style.width=(100/-le).toFixed(1)+"%"):(w.className="jsroot_ctxt_container",w.style=P,w.style.left=-V.offsetLeft+V.offsetWidth+"px");let x=!1,v=0;fe.forEach(L=>{L.checked&&(x=!0),L.column&&v++}),fe.forEach(L=>{if(v>0)return w.style.display="flex",void(L.column&&this._buildContextmenu(L.sub,-v,-v,w));if(L.divider){const N=D.createElement("hr");return N.style="width: 85%; margin: 3px auto; border: 1px solid rgb(0, 0, 0, 0.15)",void w.appendChild(N)}const F=D.createElement("div");if(F.style.position="relative",w.appendChild(F),L.header)return F.style="background-color: lightblue; padding: 3px 7px; font-weight: bold; border-bottom: 1px;",void(F.innerHTML=L.text);const U=D.createElement("div");U.style.width="100%",U.style.height="100%",U.style.display="flex",U.style.justifyContent="space-between",U.style.cursor="pointer",L.title&&U.setAttribute("title",L.title),F.appendChild(U),L.text||(L.text="item");const j=D.createElement("div");if(j.style="margin: 0; padding: 3px 7px; pointer-events: none; white-space: nowrap",L.text.indexOf("<svg")>=0)if(x){j.style.display="flex";const N=D.createElement("span");N.innerHTML=L.checked?"\u2713":"",N.style.display="inline-block",N.style.width="1em",j.appendChild(N);const m=D.createElement("div");m.innerHTML=L.text,j.appendChild(m)}else j.innerHTML=L.text;else{if(x){const m=D.createElement("span");m.innerHTML=L.checked?"\u2713":"",m.style.display="inline-block",m.style.width="1em",j.appendChild(m)}const N=D.createElement("span");N.textContent=0===L.text.indexOf("<nobr>")?L.text.slice(6,L.text.length-7):L.text,j.appendChild(N)}function te(N,m){m?(N.classList.add("jsroot_ctxt_focus"),N.style["background-color"]="rgb(220, 220, 220)"):N.classList.contains("jsroot_ctxt_focus")&&(N.style["background-color"]=null,N.classList.remove("jsroot_ctxt_focus"),N.querySelector(".jsroot_ctxt_container")?.remove())}if(U.appendChild(j),L.extraText||L.sub){const N=D.createElement("span");N.className="jsroot_ctxt_extraText",N.style="margin: 0; padding: 3px 7px; color: rgb(0, 0, 0, 0.6);",N.textContent=L.sub?"\u25b6":L.extraText,U.appendChild(N),L.sub&&b.browser.touches&&N.addEventListener("click",m=>{m.preventDefault(),m.stopPropagation();const I=F.parentNode.querySelector(".jsroot_ctxt_focus");I&&te(I,!1),F!==I&&(te(F,!0),this._buildContextmenu(L.sub,0,0,F))})}b.browser.touches||U.addEventListener("mouseenter",()=>{this.prevHovArea&&(this.prevHovArea.style["background-color"]=null),U.style["background-color"]="rgb(235, 235, 235)",this.prevHovArea=U,w.childNodes.forEach(N=>te(N,!1)),L.sub&&(te(F,!0),this._buildContextmenu(L.sub,0,0,F))}),L.func&&F.addEventListener("click",N=>{(this.painter?L.func.bind(this.painter):L.func)(L.arg),N.stopPropagation(),this.remove()})}),V.appendChild(w);const _=D.documentElement.clientWidth,C=D.documentElement.clientHeight;if(V===D.body)le+w.offsetWidth>_&&(w.style.left=_-w.offsetWidth+"px"),w.offsetHeight>C?(w.style.top=0,w.style.overflowY="scroll",w.style.overflowX="hidden",w.style.height=C+"px"):Y+w.offsetHeight>C&&(w.style.top=C-w.offsetHeight+"px");else if("jsroot_ctxt_column"!==w.className){const L=V.getBoundingClientRect(),F=w.getBoundingClientRect();F.left+F.width>_&&(w.style.left=-V.offsetLeft-F.width+"px"),F.height>C?(w.style.top=-F.top+"px",w.style.overflowY="scroll",w.style.overflowX="hidden",w.style.height=C+"px"):F.height<C&&F.height>C/2?w.style.top=F.top-C/2>=0?-F.top-F.height+C+"px":-F.top+"px":F.top+F.height>C&&(w.style.top=-F.height+L.height+"px")}return w}show(fe){var le=this;return(0,ve.A)(function*(){le.remove(),!fe&&le.show_evnt&&(fe=le.show_evnt);const Y=(0,b.getDocument)(),V=typeof window>"u"?{x:0,y:0}:{x:window.scrollX,y:window.scrollY};Y.body.addEventListener("click",le.remove_handler);const D=Y.getElementById(le.menuname);return D&&D.remove(),le.element=le._buildContextmenu(le.code,(fe?.clientX||0)+V.x,(fe?.clientY||0)+V.y,Y.body),le.element.setAttribute("id",le.menuname),le})()}createModal(fe,le,Y){Y||(Y={}),Y.Ok||(Y.Ok="Ok");const V={args:Y},D=(this?.menuname??"root_modal")+"_dialog";(0,z.Lt)(`#${D}`).remove(),(0,z.Lt)(`#${D}_block`).remove();const w=Math.min(Y.width||450,Math.round(.9*b.browser.screenWidth));V.block=(0,z.Lt)("body").append("div").attr("id",`${D}_block`).attr("class","jsroot_dialog_block").attr("style","z-index: 100000; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px; opacity: 0.2; background-color: white"),V.element=(0,z.Lt)("body").append("div").attr("id",D).attr("class","jsroot_dialog").style("position","absolute").style("width",`${w}px`).style("left","50%").style("top","50%").style("z-index",100001).attr("tabindex","0").html(`<div style='position: relative; left: -50%; top: -50%; border: solid green 3px; padding: 5px; display: flex; flex-flow: column; background-color: white'><div style='flex: 0 1 auto; padding: 5px'>${fe}</div><div class='jsroot_dialog_content' style='flex: 1 1 auto; padding: 5px'>${le}</div><div class='jsroot_dialog_footer' style='flex: 0 1 auto; padding: 5px'><button class='jsroot_dialog_button' style='float: right; width: fit-content; margin-right: 1em'>${Y.Ok}</button>`+(Y.btns?"<button class='jsroot_dialog_button' style='float: right; width: fit-content; margin-right: 1em'>Cancel</button>":"")+"</div></div>"),V.done=function(x){this._done||(this._done=!0,(0,b.isFunc)(this.call_back)&&this.call_back(x),this.element.remove(),this.block.remove())},V.setContent=function(x,v){this._done||(this.element.select(".jsroot_dialog_content").html(x),v&&(this.args.Ok=v,this.element.select(".jsroot_dialog_button").text(v)))},V.element.on("keyup",x=>{("Enter"===x.code||"Escape"===x.code)&&(x.preventDefault(),x.stopPropagation(),V.done("Enter"===x.code?V.element.node():null))}),V.element.on("keydown",x=>{("Enter"===x.code||"Escape"===x.code)&&(x.preventDefault(),x.stopPropagation())}),V.element.selectAll(".jsroot_dialog_button").on("click",x=>{V.done(Y.btns&&(0,z.Lt)(x.target).text()===Y.Ok?V.element.node():null)});let P=V.element.select(".jsroot_dialog_content").select("input");return P.empty()&&(P=V.element.select(".jsroot_dialog_footer").select("button")),P.empty()||P.node().focus(),V}runModal(fe,le,Y){var V=this;return(0,ve.A)(function*(){const D=V.createModal(fe,le,Y);return new Promise(w=>{D.call_back=w})})()}}function Ie(ue,fe,le){return new He(fe,le||"root_ctx_menu",ue).load()}function O(ue){const fe=(0,b.getDocument)().getElementById(ue||"root_ctx_menu");return fe?.remove(),!!fe}function ce(ue){ue||(ue="root_ctx_menu");const fe=(0,b.getDocument)();return!(!fe.getElementById(ue)&&!fe.getElementById(ue+"_dialog"))}function ie(ue,fe,le){(0,b.isFunc)(ue.stopPropagation)&&(ue.stopPropagation(),ue.preventDefault()),Ie(ue,fe).then(Y=>(fe.fillContextMenu(Y),le===ot&&(0,b.isFunc)(fe.bringToFront)&&(Y.add("Bring to front",()=>fe.bringToFront(!0)),le=void 0),fe.fillObjectExecMenu(Y,le))).then(Y=>Y.show())}function he(ue,fe){!ue?.isBatchMode()&&ue?.draw_g&&ue.draw_g.on("contextmenu",b.settings.ContextMenu?le=>ie(le,ue,fe):null)}b.internals._modalProgress=function(ue,fe){if(!ue||!(0,b.isStr)(ue))return b.internals.modal?.done(),void delete b.internals.modal;b.internals.modal||(b.internals.modal=He.prototype.createModal("Progress",ue)),b.internals.modal.setContent(ue,fe?"Abort":"Ok"),b.internals.modal.call_back=fe}},6714:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{DZ:()=>D,IK:()=>Ie,Jb:()=>ue,OJ:()=>C,PL:()=>P,Rh:()=>Je,W4:()=>Xe,X2:()=>ie,cA:()=>Re,d7:()=>O,fz:()=>he,iE:()=>ce,pp:()=>j,sb:()=>w,sd:()=>te});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(9041),xe=Ee(6224),et=Ee(6823);function Je(N,m,I){if((0,b.isBatchMode)()||typeof document>"u")return;const A="jsroot_progressbox",R="modal"===b.settings.ProgressBox&&(0,b.isFunc)(b.internals._modalProgress)?b.internals._modalProgress:null;let k=(0,z.Lt)("#"+A);if(!b.settings.ProgressBox)return R&&R(),k.remove();if(0===arguments.length||!N)return(-1!==m||!k.empty()&&k.property("with_timeout"))&&k.remove(),void(R&&R());if(R)k.remove(),R(N,I);else{k.empty()&&(k=(0,z.Lt)(document.body).append("div").attr("id",A).attr("style","position: fixed; min-width: 100px; height: auto; overflow: visible; z-index: 101; border: 1px solid #999; background: #F8F8F8; left: 10px; bottom: 10px;"),k.append("p")),k.property("with_timeout",!1);const J=k.select("p");(0,b.isStr)(N)&&J.html(N).on("click",(0,b.isFunc)(I)?I:null).attr("title",(0,b.isFunc)(I)?"Click element to abort current operation":""),J.attr("style","font-size: 10px; margin-left: 10px; margin-right: 10px; margin-top: 3px; margin-bottom: 3px")}Number.isFinite(m)&&m>0&&(k.empty()||k.property("with_timeout",!0),setTimeout(()=>Je("",-1),m))}function Xe(){typeof window>"u"||(window.close(),window.open("","_self").close())}function ot(N,m){if(!N||0===N.length)return void((0,b.isFunc)(m.rejectFunc)&&(m.rejectFunc(Error("openui5 was not possible to load")),m.rejectFunc=null));let I=N.shift();0===I.indexOf("roothandler")&&I.indexOf("://")<0&&(I=I.replace(/:\//g,"://"));const A=document.createElement("script");A.setAttribute("type","text/javascript"),A.setAttribute("id","sap-ui-bootstrap"),A.setAttribute("src",I+(m.ui5dbg?"resources/sap-ui-core-dbg.js":"resources/sap-ui-core.js")),A.setAttribute("data-sap-ui-libs",m.openui5libs??"sap.m, sap.ui.layout, sap.ui.unified, sap.ui.commons"),A.setAttribute("data-sap-ui-theme",m.openui5theme||"sap_belize"),A.setAttribute("data-sap-ui-compatVersion","edge"),A.setAttribute("data-sap-ui-async","true"),A.setAttribute("data-sap-ui-preload","async"),A.setAttribute("data-sap-ui-evt-oninit","completeUI5Loading()"),A.onerror=function(){A.parentNode.removeChild(A),ot(N,m)},A.onload=function(){console.log(`Load openui5 from ${I}`)},document.head.appendChild(A)}function Re(N){return He.apply(this,arguments)}function He(){return(He=(0,ve.A)(function*(N){if("object"==typeof globalThis.sap)return globalThis.sap;N||(N={});let m=b.source_dir.replace(/jsrootsys/g,"rootui5sys");m===b.source_dir&&(m=window.location.port&&window.location.pathname.indexOf("/win")>=0&&(!N.openui5src||"nojsroot"===N.openui5src||"jsroot"===N.openui5src)?window.location.origin+window.location.pathname+"../rootui5sys/":void 0);const I=[];let A="https://openui5.hana.ondemand.com/1.98.0/",R=m?m+"distribution/":"";if((0,b.isStr)(N.openui5src))switch(N.openui5src){case"nodefault":A="";break;case"default":I.push(A),A="";break;case"nojsroot":break;case"jsroot":I.push(R),R="";break;default:I.push(N.openui5src)}else N.ui5dbg&&(R="");return R&&I.indexOf(R)<0&&I.push(R),A&&I.indexOf(A)<0&&I.push(A),new Promise((k,J)=>{N.resolveFunc=k,N.rejectFunc=J,globalThis.completeUI5Loading=function(){globalThis.sap.ui.loader.config({paths:{jsroot:b.source_dir,rootui5:m}}),N.resolveFunc&&(N.resolveFunc(globalThis.sap),N.resolveFunc=null)},ot(I,N)})})).apply(this,arguments)}const Ie={camera:{path:"M 152.00,304.00c0.00,57.438, 46.562,104.00, 104.00,104.00s 104.00-46.562, 104.00-104.00s-46.562-104.00-104.00-104.00S 152.00,246.562, 152.00,304.00z M 480.00,128.00L 368.00,128.00 c-8.00-32.00-16.00-64.00-48.00-64.00L 192.00,64.00 c-32.00,0.00-40.00,32.00-48.00,64.00L 32.00,128.00 c-17.60,0.00-32.00,14.40-32.00,32.00l0.00,288.00 c0.00,17.60, 14.40,32.00, 32.00,32.00l 448.00,0.00 c 17.60,0.00, 32.00-14.40, 32.00-32.00L 512.00,160.00 C 512.00,142.40, 497.60,128.00, 480.00,128.00z M 256.00,446.00c-78.425,0.00-142.00-63.574-142.00-142.00c0.00-78.425, 63.575-142.00, 142.00-142.00c 78.426,0.00, 142.00,63.575, 142.00,142.00 C 398.00,382.426, 334.427,446.00, 256.00,446.00z M 480.00,224.00l-64.00,0.00 l0.00-32.00 l 64.00,0.00 L 480.00,224.00 z"},disk:{path:"M384,0H128H32C14.336,0,0,14.336,0,32v448c0,17.656,14.336,32,32,32h448c17.656,0,32-14.344,32-32V96L416,0H384z M352,160   V32h32v128c0,17.664-14.344,32-32,32H160c-17.664,0-32-14.336-32-32V32h128v128H352z M96,288c0-17.656,14.336-32,32-32h256   c17.656,0,32,14.344,32,32v192H96V288z"},question:{path:"M256,512c141.375,0,256-114.625,256-256S397.375,0,256,0S0,114.625,0,256S114.625,512,256,512z M256,64   c63.719,0,128,36.484,128,118.016c0,47.453-23.531,84.516-69.891,110.016C300.672,299.422,288,314.047,288,320   c0,17.656-14.344,32-32,32c-17.664,0-32-14.344-32-32c0-40.609,37.25-71.938,59.266-84.031   C315.625,218.109,320,198.656,320,182.016C320,135.008,279.906,128,256,128c-30.812,0-64,20.227-64,64.672   c0,17.664-14.336,32-32,32s-32-14.336-32-32C128,109.086,193.953,64,256,64z M256,449.406c-18.211,0-32.961-14.75-32.961-32.969   c0-18.188,14.75-32.953,32.961-32.953c18.219,0,32.969,14.766,32.969,32.953C288.969,434.656,274.219,449.406,256,449.406z"},undo:{path:"M450.159,48.042c8.791,9.032,16.983,18.898,24.59,29.604c7.594,10.706,14.146,22.207,19.668,34.489  c5.509,12.296,9.82,25.269,12.92,38.938c3.113,13.669,4.663,27.834,4.663,42.499c0,14.256-1.511,28.863-4.532,43.822  c-3.009,14.952-7.997,30.217-14.953,45.795c-6.955,15.577-16.202,31.52-27.755,47.826s-25.88,32.9-42.942,49.807  c-5.51,5.444-11.787,11.67-18.834,18.651c-7.033,6.98-14.496,14.366-22.39,22.168c-7.88,7.802-15.955,15.825-24.187,24.069  c-8.258,8.231-16.333,16.203-24.252,23.888c-18.3,18.13-37.354,37.016-57.191,56.65l-56.84-57.445  c19.596-19.472,38.54-38.279,56.84-56.41c7.75-7.685,15.772-15.604,24.108-23.757s16.438-16.163,24.33-24.057  c7.894-7.893,15.356-15.33,22.402-22.312c7.034-6.98,13.312-13.193,18.821-18.651c22.351-22.402,39.165-44.648,50.471-66.738  c11.279-22.09,16.932-43.567,16.932-64.446c0-15.785-3.217-31.005-9.638-45.671c-6.422-14.665-16.229-28.504-29.437-41.529  c-3.282-3.282-7.358-6.395-12.217-9.325c-4.871-2.938-10.381-5.503-16.516-7.697c-6.121-2.201-12.815-3.992-20.058-5.373  c-7.242-1.374-14.9-2.064-23.002-2.064c-8.218,0-16.802,0.834-25.788,2.507c-8.961,1.674-18.053,4.429-27.222,8.271  c-9.189,3.842-18.456,8.869-27.808,15.089c-9.358,6.219-18.521,13.819-27.502,22.793l-59.92,60.271l93.797,94.058H0V40.91  l93.27,91.597l60.181-60.532c13.376-15.018,27.222-27.248,41.536-36.697c14.308-9.443,28.608-16.776,42.89-21.992  c14.288-5.223,28.505-8.74,42.623-10.557C294.645,0.905,308.189,0,321.162,0c13.429,0,26.389,1.185,38.84,3.562  c12.478,2.377,24.2,5.718,35.192,10.029c11.006,4.311,21.126,9.404,30.374,15.265C434.79,34.724,442.995,41.119,450.159,48.042z"},arrow_right:{path:"M30.796,226.318h377.533L294.938,339.682c-11.899,11.906-11.899,31.184,0,43.084c11.887,11.899,31.19,11.893,43.077,0  l165.393-165.386c5.725-5.712,8.924-13.453,8.924-21.539c0-8.092-3.213-15.84-8.924-21.551L338.016,8.925  C332.065,2.975,324.278,0,316.478,0c-7.802,0-15.603,2.968-21.539,8.918c-11.899,11.906-11.899,31.184,0,43.084l113.391,113.384  H30.796c-16.822,0-30.463,13.645-30.463,30.463C0.333,212.674,13.974,226.318,30.796,226.318z"},arrow_up:{path:"M295.505,629.446V135.957l148.193,148.206c15.555,15.559,40.753,15.559,56.308,0c15.555-15.538,15.546-40.767,0-56.304  L283.83,11.662C276.372,4.204,266.236,0,255.68,0c-10.568,0-20.705,4.204-28.172,11.662L11.333,227.859  c-7.777,7.777-11.666,17.965-11.666,28.158c0,10.192,3.88,20.385,11.657,28.158c15.563,15.555,40.762,15.555,56.317,0  l148.201-148.219v493.489c0,21.993,17.837,39.82,39.82,39.82C277.669,669.267,295.505,651.439,295.505,629.446z"},arrow_diag:{path:"M279.875,511.994c-1.292,0-2.607-0.102-3.924-0.312c-10.944-1.771-19.333-10.676-20.457-21.71L233.97,278.348  L22.345,256.823c-11.029-1.119-19.928-9.51-21.698-20.461c-1.776-10.944,4.031-21.716,14.145-26.262L477.792,2.149  c9.282-4.163,20.167-2.165,27.355,5.024c7.201,7.189,9.199,18.086,5.024,27.356L302.22,497.527  C298.224,506.426,289.397,511.994,279.875,511.994z M118.277,217.332l140.534,14.294c11.567,1.178,20.718,10.335,21.878,21.896  l14.294,140.519l144.09-320.792L118.277,217.332z"},auto_zoom:{path:"M505.441,242.47l-78.303-78.291c-9.18-9.177-24.048-9.171-33.216,0c-9.169,9.172-9.169,24.045,0.006,33.217l38.193,38.188  H280.088V80.194l38.188,38.199c4.587,4.584,10.596,6.881,16.605,6.881c6.003,0,12.018-2.297,16.605-6.875  c9.174-9.172,9.174-24.039,0.011-33.217L273.219,6.881C268.803,2.471,262.834,0,256.596,0c-6.229,0-12.202,2.471-16.605,6.881  l-78.296,78.302c-9.178,9.172-9.178,24.045,0,33.217c9.177,9.171,24.051,9.171,33.21,0l38.205-38.205v155.4H80.521l38.2-38.188  c9.177-9.171,9.177-24.039,0.005-33.216c-9.171-9.172-24.039-9.178-33.216,0L7.208,242.464c-4.404,4.403-6.881,10.381-6.881,16.611  c0,6.227,2.477,12.207,6.881,16.61l78.302,78.291c4.587,4.581,10.599,6.875,16.605,6.875c6.006,0,12.023-2.294,16.61-6.881  c9.172-9.174,9.172-24.036-0.005-33.211l-38.205-38.199h152.593v152.063l-38.199-38.211c-9.171-9.18-24.039-9.18-33.216-0.022  c-9.178,9.18-9.178,24.059-0.006,33.222l78.284,78.302c4.41,4.404,10.382,6.881,16.611,6.881c6.233,0,12.208-2.477,16.611-6.881  l78.302-78.296c9.181-9.18,9.181-24.048,0-33.205c-9.174-9.174-24.054-9.174-33.21,0l-38.199,38.188v-152.04h152.051l-38.205,38.199  c-9.18,9.175-9.18,24.037-0.005,33.211c4.587,4.587,10.596,6.881,16.604,6.881c6.01,0,12.024-2.294,16.605-6.875l78.303-78.285  c4.403-4.403,6.887-10.378,6.887-16.611C512.328,252.851,509.845,246.873,505.441,242.47z"},statbox:{path:"M28.782,56.902H483.88c15.707,0,28.451-12.74,28.451-28.451C512.331,12.741,499.599,0,483.885,0H28.782   C13.074,0,0.331,12.741,0.331,28.451C0.331,44.162,13.074,56.902,28.782,56.902zM483.885,136.845H28.782c-15.708,0-28.451,12.741-28.451,28.451c0,15.711,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.74,28.451-28.451C512.331,149.586,499.599,136.845,483.885,136.845zM483.885,273.275H28.782c-15.708,0-28.451,12.731-28.451,28.452c0,15.707,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.744,28.451-28.451C512.337,286.007,499.599,273.275,483.885,273.275zM256.065,409.704H30.492c-15.708,0-28.451,12.731-28.451,28.451c0,15.707,12.744,28.451,28.451,28.451h225.585   c15.707,0,28.451-12.744,28.451-28.451C284.516,422.436,271.785,409.704,256.065,409.704z"},circle:{path:"M256,256 m-150,0 a150,150 0 1,0 300,0 a150,150 0 1,0 -300,0"},three_circles:{path:"M256,85 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,255 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,425 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0 "},diamand:{path:"M256,0L384,256L256,511L128,256z"},rect:{path:"M90,90h352v352h-352z"},cross:{path:"M80,40l176,176l176,-176l40,40l-176,176l176,176l-40,40l-176,-176l-176,176l-40,-40l176,-176l-176,-176z"},vrgoggles:{size:"245.82 141.73",path:"M175.56,111.37c-22.52,0-40.77-18.84-40.77-42.07S153,27.24,175.56,27.24s40.77,18.84,40.77,42.07S198.08,111.37,175.56,111.37ZM26.84,69.31c0-23.23,18.25-42.07,40.77-42.07s40.77,18.84,40.77,42.07-18.26,42.07-40.77,42.07S26.84,92.54,26.84,69.31ZM27.27,0C11.54,0,0,12.34,0,28.58V110.9c0,16.24,11.54,30.83,27.27,30.83H99.57c2.17,0,4.19-1.83,5.4-3.7L116.47,118a8,8,0,0,1,12.52-.18l11.51,20.34c1.2,1.86,3.22,3.61,5.39,3.61h72.29c15.74,0,27.63-14.6,27.63-30.83V28.58C245.82,12.34,233.93,0,218.19,0H27.27Z"},th2colorz:{recs:[{x:128,y:486,w:256,h:26,f:"rgb(38,62,168)"},{y:461,f:"rgb(22,82,205)"},{y:435,f:"rgb(16,100,220)"},{y:410,f:"rgb(18,114,217)"},{y:384,f:"rgb(20,129,214)"},{y:358,f:"rgb(14,143,209)"},{y:333,f:"rgb(9,157,204)"},{y:307,f:"rgb(13,167,195)"},{y:282,f:"rgb(30,175,179)"},{y:256,f:"rgb(46,183,164)"},{y:230,f:"rgb(82,186,146)"},{y:205,f:"rgb(116,189,129)"},{y:179,f:"rgb(149,190,113)"},{y:154,f:"rgb(179,189,101)"},{y:128,f:"rgb(209,187,89)"},{y:102,f:"rgb(226,192,75)"},{y:77,f:"rgb(244,198,59)"},{y:51,f:"rgb(253,210,43)"},{y:26,f:"rgb(251,230,29)"},{y:0,f:"rgb(249,249,15)"}]},th2color:{recs:[{x:0,y:256,w:13,h:39,f:"rgb(38,62,168)"},{x:13,y:371,w:39,h:39},{y:294,h:39},{y:256,h:39},{y:218,h:39},{x:51,y:410,w:39,h:39},{y:371,h:39},{y:333,h:39},{y:294},{y:256,h:39},{y:218,h:39},{y:179,h:39},{y:141,h:39},{y:102,h:39},{y:64},{x:90,y:448,w:39,h:39},{y:410},{y:371,h:39},{y:333,h:39,f:"rgb(22,82,205)"},{y:294},{y:256,h:39,f:"rgb(16,100,220)"},{y:218,h:39},{y:179,h:39,f:"rgb(22,82,205)"},{y:141,h:39},{y:102,h:39,f:"rgb(38,62,168)"},{y:64},{y:0,h:27},{x:128,y:448,w:39,h:39},{y:410},{y:371,h:39},{y:333,h:39,f:"rgb(22,82,205)"},{y:294,f:"rgb(20,129,214)"},{y:256,h:39,f:"rgb(9,157,204)"},{y:218,h:39,f:"rgb(14,143,209)"},{y:179,h:39,f:"rgb(20,129,214)"},{y:141,h:39,f:"rgb(16,100,220)"},{y:102,h:39,f:"rgb(22,82,205)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{y:0,h:27},{x:166,y:486,h:14},{y:448,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39,f:"rgb(20,129,214)"},{y:294,f:"rgb(82,186,146)"},{y:256,h:39,f:"rgb(179,189,101)"},{y:218,h:39,f:"rgb(116,189,129)"},{y:179,h:39,f:"rgb(82,186,146)"},{y:141,h:39,f:"rgb(14,143,209)"},{y:102,h:39,f:"rgb(16,100,220)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:205,y:486,w:39,h:14},{y:448,h:39},{y:410},{y:371,h:39,f:"rgb(16,100,220)"},{y:333,h:39,f:"rgb(9,157,204)"},{y:294,f:"rgb(149,190,113)"},{y:256,h:39,f:"rgb(244,198,59)"},{y:218,h:39},{y:179,h:39,f:"rgb(226,192,75)"},{y:141,h:39,f:"rgb(13,167,195)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(22,82,205)"},{y:26,h:39,f:"rgb(38,62,168)"},{x:243,y:448,w:39,h:39},{y:410},{y:371,h:39,f:"rgb(18,114,217)"},{y:333,h:39,f:"rgb(30,175,179)"},{y:294,f:"rgb(209,187,89)"},{y:256,h:39,f:"rgb(251,230,29)"},{y:218,h:39,f:"rgb(249,249,15)"},{y:179,h:39,f:"rgb(226,192,75)"},{y:141,h:39,f:"rgb(30,175,179)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:282,y:448,h:39},{y:410},{y:371,h:39,f:"rgb(18,114,217)"},{y:333,h:39,f:"rgb(14,143,209)"},{y:294,f:"rgb(149,190,113)"},{y:256,h:39,f:"rgb(226,192,75)"},{y:218,h:39,f:"rgb(244,198,59)"},{y:179,h:39,f:"rgb(149,190,113)"},{y:141,h:39,f:"rgb(9,157,204)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:320,y:448,w:39,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39,f:"rgb(20,129,214)"},{y:294,f:"rgb(46,183,164)"},{y:256,h:39},{y:218,h:39,f:"rgb(82,186,146)"},{y:179,h:39,f:"rgb(9,157,204)"},{y:141,h:39,f:"rgb(20,129,214)"},{y:102,h:39,f:"rgb(16,100,220)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:358,y:448,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39},{y:294,f:"rgb(16,100,220)"},{y:256,h:39,f:"rgb(20,129,214)"},{y:218,h:39,f:"rgb(14,143,209)"},{y:179,h:39,f:"rgb(18,114,217)"},{y:141,h:39,f:"rgb(22,82,205)"},{y:102,h:39,f:"rgb(38,62,168)"},{y:64},{y:26,h:39},{x:397,y:448,w:39,h:39},{y:371,h:39},{y:333,h:39},{y:294,f:"rgb(22,82,205)"},{y:256,h:39},{y:218,h:39},{y:179,h:39,f:"rgb(38,62,168)"},{y:141,h:39},{y:102,h:39},{y:64},{y:26,h:39},{x:435,y:410,h:39},{y:371,h:39},{y:333,h:39},{y:294},{y:256,h:39},{y:218,h:39},{y:179,h:39},{y:141,h:39},{y:102,h:39},{y:64},{x:474,y:256,h:39},{y:179,h:39}]},th2draw3d:{path:"M172.768,0H51.726C23.202,0,0.002,23.194,0.002,51.712v89.918c0,28.512,23.2,51.718,51.724,51.718h121.042   c28.518,0,51.724-23.2,51.724-51.718V51.712C224.486,23.194,201.286,0,172.768,0z M177.512,141.63c0,2.611-2.124,4.745-4.75,4.745   H51.726c-2.626,0-4.751-2.134-4.751-4.745V51.712c0-2.614,2.125-4.739,4.751-4.739h121.042c2.62,0,4.75,2.125,4.75,4.739 L177.512,141.63L177.512,141.63z M460.293,0H339.237c-28.521,0-51.721,23.194-51.721,51.712v89.918c0,28.512,23.2,51.718,51.721,51.718h121.045   c28.521,0,51.721-23.2,51.721-51.718V51.712C512.002,23.194,488.802,0,460.293,0z M465.03,141.63c0,2.611-2.122,4.745-4.748,4.745   H339.237c-2.614,0-4.747-2.128-4.747-4.745V51.712c0-2.614,2.133-4.739,4.747-4.739h121.045c2.626,0,4.748,2.125,4.748,4.739 V141.63z M172.768,256.149H51.726c-28.524,0-51.724,23.205-51.724,51.726v89.915c0,28.504,23.2,51.715,51.724,51.715h121.042   c28.518,0,51.724-23.199,51.724-51.715v-89.915C224.486,279.354,201.286,256.149,172.768,256.149z M177.512,397.784   c0,2.615-2.124,4.736-4.75,4.736H51.726c-2.626-0.006-4.751-2.121-4.751-4.736v-89.909c0-2.626,2.125-4.753,4.751-4.753h121.042 c2.62,0,4.75,2.116,4.75,4.753L177.512,397.784L177.512,397.784z M460.293,256.149H339.237c-28.521,0-51.721,23.199-51.721,51.726v89.915c0,28.504,23.2,51.715,51.721,51.715h121.045   c28.521,0,51.721-23.199,51.721-51.715v-89.915C512.002,279.354,488.802,256.149,460.293,256.149z M465.03,397.784   c0,2.615-2.122,4.736-4.748,4.736H339.237c-2.614,0-4.747-2.121-4.747-4.736v-89.909c0-2.626,2.121-4.753,4.747-4.753h121.045 c2.615,0,4.748,2.116,4.748,4.753V397.784z"},createSVG(N,m,I,A,R){const k=!0===R||!1===R?R:b.settings.DarkMode,J="browser"===R?b.browser.touches?.2:0:k?.8:.2,_e=N.append("svg:svg").attr("width",I+"px").attr("height",I+"px").attr("viewBox","0 0 512 512").style("overflow","hidden").style("cursor","pointer").style("fill",k?"rgba(255, 224, 160)":"steelblue").style("opacity",J).property("opacity0",J).property("opacity1",k?1:.8).on("mouseenter",function(){const be=(0,z.Lt)(this);be.style("opacity",be.property("opacity1"));const Te=be.node()._mouseenter;(0,b.isFunc)(Te)&&Te()}).on("mouseleave",function(){const be=(0,z.Lt)(this);be.style("opacity",be.property("opacity0"));const Te=be.node()._mouseleave;(0,b.isFunc)(Te)&&Te()});if("recs"in m){const be={};for(let Te=0;Te<m.recs.length;++Te)Object.assign(be,m.recs[Te]),_e.append("rect").attr("x",be.x).attr("y",be.y).attr("width",be.w).attr("height",be.h).style("fill",be.f)}else _e.append("svg:path").attr("d",m.path);return _e.append("svg:rect").attr("x",0).attr("y",0).attr("width",512).attr("height",512).style("opacity",0).style("fill","none").style("pointer-events","visibleFill").append("svg:title").text(A),_e}};function O(N,m){if(!N||(0,b.isBatchMode)()||typeof window>"u"||typeof document>"u")return;let I=null,A=m||300;function R(){if(I=null,document.body.style.cursor="wait",(0,b.isFunc)(N))N();else if((0,b.isFunc)(N?.checkResize))N.checkResize();else{const k=new ke.b8(N).selectDom();if(!k.empty()){const J=k.property("mdi");(0,b.isFunc)(J?.checkMDIResize)?J.checkMDIResize():(0,xe.XR)(k.node())}}document.body.style.cursor="auto"}A<20&&(A=20),window.addEventListener("resize",()=>{null!==I&&clearTimeout(I),I=setTimeout(R,A)})}function ce(N){return 2===N?.buttons||2===N?.button}function ie(N,m=!0){if(!b.settings.MoveResize||N.isBatchMode()||!N.draw_g)return;if(!1===N.getPadPainter()?.isEditable()&&(m=!1),!m){if(N.draw_g.property("assigned_move")){const k=(0,z.$E)().subject(Object);k.on("start",null).on("drag",null).on("end",null),N.draw_g.style("cursor",null).property("assigned_move",null).call(k)}return}if(N.draw_g.property("assigned_move"))return;const I=(0,z.$E)().subject(Object);let A=!0,R=!1;I.on("start",function(k){if(R=!!this.moveEnabled&&!this.moveEnabled(),R||ce(k.sourceEvent))return;k.sourceEvent.preventDefault(),k.sourceEvent.stopPropagation();const J=(0,z.Wn)(k,this.draw_g.node());A=!0,this.moveStart&&this.moveStart(J[0],J[1])}.bind(N)).on("drag",function(k){R||(k.sourceEvent.preventDefault(),k.sourceEvent.stopPropagation(),A=!1,this.moveDrag&&this.moveDrag(k.dx,k.dy))}.bind(N)).on("end",function(k){if(R)return;k.sourceEvent.preventDefault(),k.sourceEvent.stopPropagation(),this.moveEnd&&this.moveEnd(A);let J=null;if(A){const _e=(0,z.Wn)(k,this.draw_g.node());J={x:_e[0],y:_e[1],dbl:!1}}this.getPadPainter()?.selectObjectPainter(this,J)}.bind(N)),N.draw_g.style("cursor","move").property("assigned_move",!0).call(I)}function he(N,m,I){if((0,b.isBatchMode)()||!N||typeof document>"u")return!0;const A=(m||document).getElementsByTagName("style");for(let k=0;k<A.length;++k){if(I&&A[k].getAttribute("tag")===I)return A[k].innerHTML=N,!0;if(A[k].innerHTML===N)return!0}const R=document.createElement("style");return I&&R.setAttribute("tag",I),R.innerHTML=N,(m||document.head).appendChild(R),!0}function ue(N){switch(b.gStyle.fName=N,N){case"Modern":Object.assign(b.gStyle,{fFrameBorderMode:0,fFrameFillColor:0,fCanvasBorderMode:0,fCanvasColor:0,fPadBorderMode:0,fPadColor:0,fStatColor:0,fTitleAlign:23,fTitleX:.5,fTitleBorderSize:0,fTitleColor:0,fTitleStyle:0,fOptStat:1111,fStatY:.935,fLegendBorderSize:1,fLegendFont:42,fLegendTextSize:0,fLegendFillColor:0});break;case"Plain":Object.assign(b.gStyle,{fFrameBorderMode:0,fCanvasBorderMode:0,fPadBorderMode:0,fPadColor:0,fCanvasColor:0,fTitleColor:0,fTitleBorderSize:0,fStatColor:0,fStatBorderSize:1,fLegendBorderSize:1});break;case"Bold":Object.assign(b.gStyle,{fCanvasColor:10,fCanvasBorderMode:0,fFrameLineWidth:3,fFrameFillColor:10,fPadColor:10,fPadTickX:1,fPadTickY:1,fPadBottomMargin:.15,fPadLeftMargin:.15,fTitleColor:10,fTitleTextColor:600,fStatColor:10})}}let fe="jsroot_";function Y(N,m,I){typeof localStorage>"u"||(Number.isFinite(m)&&m<0?localStorage.removeItem(fe+I):localStorage.setItem(fe+I,(0,b.btoa_func)(JSON.stringify(N))))}function D(N=365,m="settings"){Y(b.settings,N,m)}function w(N=!1,m="settings"){const I=function V(N){if(typeof localStorage>"u")return null;const m=localStorage.getItem(fe+N),I=m?JSON.parse((0,b.atob_func)(m)):null;return(0,b.isObject)(I)?I:null}(m);return!!I&&(N||Object.assign(b.settings,I),!0)}function P(N=365,m="style"){Y(b.gStyle,N,m)}let v=null;function _(N){if(0===N.indexOf("data:image/svg+xml;charset=utf-8,"))return decodeURIComponent(N.slice(33));if(0===N.indexOf("data:image/")){const I=N.indexOf("base64,");if(I>0){const A=N.slice(I+7);return(0,b.atob_func)(A)}}return N}function C(N,m){return L.apply(this,arguments)}function L(){return(L=(0,ve.A)(function*(N,m){if((0,b.isFunc)(v))return v(N,_(m));if((0,b.isNodeJs)())return Ee.e(559).then(Ee.t.bind(Ee,7559,19)).then(I=>(I.writeFileSync(N,_(m)),!0));if(typeof document<"u"){const I=document.createElement("a");return I.download=N,I.href=m,document.body.appendChild(I),new Promise(A=>{I.addEventListener("click",()=>{I.parentNode.removeChild(I),A(!0)}),I.click()})}return!1})).apply(this,arguments)}function U(N){const m=(0,et.HG)();let I=-1;if((0,b.isStr)(N)){if(N&&"none"!==N){for(let A=1;A<m.length;++A)if(m[A]===N){I=A;break}}else I=0;I<0&&0===N.indexOf("rgb")&&(I=9999)}else Number.isInteger(N)&&m[N]&&(I=N,N=m[I]);return{id:I,col:N}}function j(N,m){const I=U(N);if(I.id<0)return"";if(I.id>=50){const A=(0,z.yW)(I.col);I.id=`TColor::GetColor(${A.r},${A.g},${A.b})`}return`exec:${m}(${I.id})`}function te(N,m,I,A){if(A){const k=U(I);if(k.id<0||9999===k.id)return;I=k.id}const R=N?.getObject();R&&void 0!==R[m]&&(R[m]=I)}},1516:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{TH1Painter:()=>Je});var ve=Ee(467),b=Ee(6998),z=Ee(9407),ke=Ee(4468),xe=Ee(3277),et=Ee(5334);class Je extends et.N{draw3D(ot){this.mode3d=!0;const Re=this.getFramePainter(),He=this.isMainPainter(),Ie=this.getHisto(),O=1+2*b.gStyle.fHistTopMargin;let ce=Promise.resolve(!0);return"resize"===ot?He&&Re.resize3D()&&Re.render3D():(this.createHistDrawAttributes(!0),this.scanContent(!0),He&&((0,z.wx)(Re),ce=Re.create3DScene(this.options.Render3D,this.options.x3dscale,this.options.y3dscale,this.options.Ortho).then(()=>{Re.setAxesRanges(Ie.fXaxis,this.xmin,this.xmax,Ie.fYaxis,this.ymin,this.ymax,Ie.fZaxis,0,0,this),Re.set3DOptions(this.options),Re.drawXYZ(Re.toplevel,ke.TB,{use_y_for_z:!0,zmult:O,zoom:b.settings.Zooming,ndim:1,draw:-1!==this.options.Axis,drawany:this.options.isCartesian()})})),Re.mode3d&&(ce=ce.then(()=>{(0,z.CS)(this),Re.render3D(),this.updateStatWebCanvas(),Re.addKeysHandler()}))),He&&(ce=ce.then(()=>this.drawColorPalette(this.options.Zscale&&(12===this.options.Lego||14===this.options.Lego)))),ce.then(()=>this.updateFunctions()).then(()=>this.updateHistTitle()).then(()=>this)}static draw(ot,Re,He){return(0,ve.A)(function*(){return xe.mf._drawHist(new Je(ot,Re),He)})()}}},4149:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{TH2Painter:()=>Re});var ve=Ee(467),b=Ee(6998),z=Ee(357),ke=Ee(1069),xe=Ee(9407),et=Ee(4468),Je=Ee(3277),Xe=Ee(4571);class Re extends Xe.AJ{draw3D(Ie){var O=this;return(0,ve.A)(function*(){O.mode3d=!0;const ce=O.getFramePainter(),ie=O.isMainPainter(),he=O.getHisto();let ue=Promise.resolve(!0);if("resize"===Ie)ie&&ce.resize3D()&&ce.render3D();else{const fe=O.getPadPainter().getRootPad(!0),le=fe?.fLogv??fe?.fLogz;let Y=1;O.options.minimum!==b.kNoZoom&&O.options.maximum!==b.kNoZoom?(O.zmin=O.options.minimum,O.zmax=O.options.maximum):(O.draw_content||0!==O.gmaxbin)&&(O.zmin=le?.3*O.gminposbin:O.gminbin,O.zmax=O.gmaxbin,Y=1+2*b.gStyle.fHistTopMargin),le&&O.zmin<=0&&(O.zmin=1e-5*O.zmax),O.createHistDrawAttributes(!0),ie&&((0,xe.wx)(ce),ue=ce.create3DScene(O.options.Render3D,O.options.x3dscale,O.options.y3dscale,O.options.Ortho).then(()=>{ce.setAxesRanges(he.fXaxis,O.xmin,O.xmax,he.fYaxis,O.ymin,O.ymax,he.fZaxis,O.zmin,O.zmax,O),ce.set3DOptions(O.options),ce.drawXYZ(ce.toplevel,et.TB,{zmult:Y,zoom:b.settings.Zooming,ndim:2,draw:-1!==O.options.Axis,drawany:O.options.isCartesian(),reverse_x:O.options.RevX,reverse_y:O.options.RevY})})),ce.mode3d&&(ue=ue.then(()=>{O.draw_content?O.isTH2Poly()?function ot(He){const Ie=He.getHisto(),O=He.getFramePainter(),ce=O.z_handle.getScaleMin(),ie=O.z_handle.getScaleMax(),he=Ie.fBins.arr.length,ue=O.grz(ce);let fe,le,Y,V;He.maxbin=He.gmaxbin,He.minbin=He.gminbin,He.minposbin=He.gminposbin;const D=He.getContour(!0),w=He.getHistPalette();for(Y=0;Y<he;++Y){if(le=Ie.fBins.arr[Y],le.fContent<ce||(fe=D.getPaletteIndex(w,le.fContent),null===fe)||le.fXmin>O.scale_xmax||le.fXmax<O.scale_xmin||le.fYmin>O.scale_ymax||le.fYmax<O.scale_ymin)continue;V=O.grz(le.fContent>ie?ie:le.fContent);const P=[],x=[];let v=1,_=le.fPoly,C=0;_._typename===b.clTMultiGraph&&(v=le.fPoly.fGraphs.arr.length,_=null);for(let N=0;N<v;++N){(!_||N>0)&&(_=le.fPoly.fGraphs.arr[N]);const m=_.fX,I=_.fY;let R,k,A=_.fNpoints;for(;A>2&&m[0]===m[A-1]&&I[0]===I[A-1];)--A;for(let J=0;J<2;++J){let _e,be,Te,Pe,We=O.size_x3d*O.size_z3d;const dt=J>0?0:We/1e6;R=[],k=null;for(let Q=0;Q<A;++Q)Te=O.grx(m[Q]),Pe=O.gry(I[Q]),Q>0&&(We=(Te-_e)*(Te-_e)+(Pe-be)*(Pe-be)),We>dt&&(R.push(new z.I9Y(Te,Pe)),_e=Te,be=Pe);try{R.length>2&&(k=z.xJ6.triangulateShape(R,[]))}catch{k=null}if(k&&k.length>R.length-3)break}k?.length&&R&&(P.push(R),x.push(k),C+=2*k.length,V>ue&&(C+=2*R.length))}const L=new Float32Array(9*C);let F=0;for(let N=0;N<P.length;++N){const m=P[N],I=x[N];for(let A=0;A<2;++A)for(let R=0;R<I.length;++R){const k=I[R],J=m[k[0]],_e=m[k[0===A?2:1]],be=m[k[0===A?1:2]];L[F]=J.x,L[F+1]=J.y,L[F+2]=A?V:ue,F+=3,L[F]=_e.x,L[F+1]=_e.y,L[F+2]=A?V:ue,F+=3,L[F]=be.x,L[F+1]=be.y,L[F+2]=A?V:ue,F+=3}if(V>ue)for(let A=0;A<m.length;++A){const R=m[A],k=m[A>0?A-1:m.length-1];L[F]=R.x,L[F+1]=R.y,L[F+2]=ue,F+=3,L[F]=k.x,L[F+1]=k.y,L[F+2]=ue,F+=3,L[F]=k.x,L[F+1]=k.y,L[F+2]=V,F+=3,L[F]=R.x,L[F+1]=R.y,L[F+2]=ue,F+=3,L[F]=k.x,L[F+1]=k.y,L[F+2]=V,F+=3,L[F]=R.x,L[F+1]=R.y,L[F+2]=V,F+=3}}const U=new z.LoY;U.setAttribute("position",new z.THS(L,3)),U.computeVertexNormals();const j=new z.V9B((0,ke.Bx)(He._color_palette?.getColor(fe),{vertexColors:!1})),te=new z.eaF(U,j);O.add3DMesh(te),te.painter=He,te.bins_index=Y,te.draw_z0=ue,te.draw_z1=V,te.tip_color=65280,te.tooltip=function(){const N=this.painter,m=N.getFramePainter(),I=N.getObject().fBins.arr[this.bins_index];return{use_itself:!0,x1:m.grx(I.fXmin),x2:m.grx(I.fXmax),y1:m.gry(I.fYmin),y2:m.gry(I.fYmax),z1:this.draw_z0,z2:this.draw_z1,bin:this.bins_index,value:I.fContent,color:this.tip_color,lines:N.getPolyBinTooltips(this.bins_index)}}}}(O):O.options.Contour?(0,xe.SF)(O,!0):O.options.Surf?(0,xe.u$)(O):O.options.Error?(0,xe.s6)(O):(0,xe.CS)(O):O.options.Axis&&O.options.Zscale&&(O.getContourLevels(!0),O.getHistPalette()),ce.render3D(),O.updateStatWebCanvas(),ce.addKeysHandler()}))}return ie&&(ue=ue.then(()=>O.drawColorPalette(O.options.Zscale&&(12===O.options.Lego||14===O.options.Lego||11===O.options.Surf||12===O.options.Surf)))),ue.then(()=>O.updateFunctions()).then(()=>O.updateHistTitle()).then(()=>O)})()}static draw(Ie,O,ce){return(0,ve.A)(function*(){return Je.mf._drawHist(new Re(Ie,O),ce)})()}}},1462:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{TH3Painter:()=>He});var ve=Ee(467),b=Ee(6998),z=Ee(357),ke=Ee(9041),xe=Ee(9025),et=Ee(4468),Je=Ee(1069),Xe=Ee(3277),ot=Ee(9407),Re=Ee(3693);class He extends Xe.mf{getDimension(){return 3}scanContent(O){if(O&&this.nbinsx&&this.nbinsy&&this.nbinsz)return;const ce=this.getHisto();this.extractAxesProperties(3),this.gminbin=this.gmaxbin=ce.getBinContent(1,1,1),this.gminposbin=null;for(let ie=0;ie<this.nbinsx;++ie)for(let he=0;he<this.nbinsy;++he)for(let ue=0;ue<this.nbinsz;++ue){const fe=ce.getBinContent(ie+1,he+1,ue+1);fe<this.gminbin?this.gminbin=fe:fe>this.gmaxbin&&(this.gmaxbin=fe),fe>0&&(null===this.gminposbin||this.gminposbin>fe)&&(this.gminposbin=fe)}null===this.gminposbin&&this.gmaxbin>0&&(this.gminposbin=1e-4*this.gmaxbin),this.draw_content=0!==this.gmaxbin||0!==this.gminbin,this.transferFunc=this.findFunction(b.clTF1,"TransferFunction"),this.transferFunc&&!this.transferFunc.TestBit((0,b.BIT)(9))&&this.transferFunc.InvertBit((0,b.BIT)(9))}countStat(O,ce){const ie=this.getHisto(),he=ie.fXaxis,ue=ie.fYaxis,fe=ie.fZaxis,le=this.getSelectIndex("x","left"),Y=this.getSelectIndex("x","right"),V=this.getSelectIndex("y","left"),D=this.getSelectIndex("y","right"),w=this.getSelectIndex("z","left"),P=this.getSelectIndex("z","right"),x=this.getFramePainter(),v={name:ie.fName,entries:0,eff_entries:0,integral:0,meanx:0,meany:0,meanz:0,rmsx:0,rmsy:0,rmsz:0,skewx:0,skewy:0,skewz:0,skewd:0,kurtx:0,kurty:0,kurtz:0,kurtd:0},_=Math.abs(ie.fTsumw)>1e-300&&!x.isAxisZoomed("x")&&!x.isAxisZoomed("y")&&!x.isAxisZoomed("z");let C,L,F,U,j,te,N,m,I,A,R=0,k=0,J=0,_e=0,be=0,Te=0,Pe=0,We=0;for((0,b.isFunc)(O)||(O=null),C=0;C<this.nbinsx+2;++C)for(U=he.GetBinCoord(C-.5),j=C<le?0:C>Y?2:1,L=0;L<this.nbinsy+2;++L)for(te=ue.GetBinCoord(L-.5),N=L<V?0:L>D?2:1,F=0;F<this.nbinsz+2;++F)m=fe.GetBinCoord(F-.5),I=F<w?0:F>P?2:1,(!O||O(U,te,m))&&(A=ie.getBinContent(C,L,F),v.entries+=A,!_&&1===j&&1===N&&1===I&&(R+=A,k+=A*A,J+=U*A,_e+=te*A,be+=m*A,Te+=U**2*A,Pe+=te**2*A,We+=m**2*A));if(_&&(R=ie.fTsumw,k=ie.fTsumw2,J=ie.fTsumwx,Te=ie.fTsumwx2,_e=ie.fTsumwy,Pe=ie.fTsumwy2,be=ie.fTsumwz,We=ie.fTsumwz2),Math.abs(R)>1e-300&&(v.meanx=J/R,v.meany=_e/R,v.meanz=be/R,v.rmsx=Math.sqrt(Math.abs(Te/R-v.meanx*v.meanx)),v.rmsy=Math.sqrt(Math.abs(Pe/R-v.meany*v.meany)),v.rmsz=Math.sqrt(Math.abs(We/R-v.meanz*v.meanz))),v.integral=R,ie.fEntries>1&&(v.entries=ie.fEntries),v.eff_entries=k?R*R/k:Math.abs(R),ce&&!this.isTH2Poly()){let dt=0,Q=0,Ke=0,Ze=0,Ue=0,Oe=0,lt=0,gt=0;for(let An=le;An<Y;++An){U=he.GetBinCoord(An+.5);for(let on=V;on<D;++on){te=ue.GetBinCoord(on+.5);for(let pn=w;pn<P;++pn)m=fe.GetBinCoord(pn+.5),(!O||O(U,te,m))&&(gt=ie.getBinContent(An+1,on+1,pn+1),lt+=gt,dt+=gt*Math.pow(U-v.meanx,3),Q+=gt*Math.pow(te-v.meany,3),Ke+=gt*Math.pow(m-v.meany,3),Ze+=gt*Math.pow(U-v.meanx,4),Ue+=gt*Math.pow(te-v.meany,4),Oe+=gt*Math.pow(te-v.meany,4))}}const ht=Math.pow(v.rmsx,3),st=Math.pow(v.rmsy,3),yt=Math.pow(v.rmsz,3),Kt=Math.pow(v.rmsx,4),Ot=Math.pow(v.rmsy,4),It=Math.pow(v.rmsz,4);lt*ht!=0&&(v.skewx=dt/(lt*ht)),lt*st!=0&&(v.skewy=Q/(lt*st)),lt*yt!=0&&(v.skewz=Ke/(lt*yt)),v.skewd=v.eff_entries>0?Math.sqrt(6/v.eff_entries):0,lt*Kt!=0&&(v.kurtx=Ze/(lt*Kt)-3),lt*Ot!=0&&(v.kurty=Ue/(lt*Ot)-3),lt*It!=0&&(v.kurtz=Oe/(lt*It)-3),v.kurtd=v.eff_entries>0?Math.sqrt(24/v.eff_entries):0}return v}fillStatistic(O,ce,ie){if(this.isIgnoreStatsFill())return!1;1===ce&&(ce=1111);const he=ce%10,ue=Math.floor(ce/10)%10,fe=Math.floor(ce/100)%10,le=Math.floor(ce/1e3)%10,Y=Math.floor(ce/1e6)%10,V=Math.floor(ce/1e7)%10,D=Math.floor(ce/1e8)%10,w=this.countStat(void 0,V>0||D>0);return O.clearPave(),he>0&&O.addText(w.name),ue>0&&O.addText("Entries = "+O.format(w.entries,"entries")),fe>0&&(O.addText("Mean x = "+O.format(w.meanx)),O.addText("Mean y = "+O.format(w.meany)),O.addText("Mean z = "+O.format(w.meanz))),le>0&&(O.addText("Std Dev x = "+O.format(w.rmsx)),O.addText("Std Dev y = "+O.format(w.rmsy)),O.addText("Std Dev z = "+O.format(w.rmsz))),Y>0&&O.addText("Integral = "+O.format(w.integral,"entries")),2===V?(O.addText(`Skewness x = ${O.format(w.skewx)} #pm ${O.format(w.skewd)}`),O.addText(`Skewness y = ${O.format(w.skewy)} #pm ${O.format(w.skewd)}`),O.addText(`Skewness z = ${O.format(w.skewz)} #pm ${O.format(w.skewd)}`)):V>0&&(O.addText(`Skewness x = ${O.format(w.skewx)}`),O.addText(`Skewness y = ${O.format(w.skewy)}`),O.addText(`Skewness z = ${O.format(w.skewz)}`)),2===D?(O.addText(`Kurtosis x = ${O.format(w.kurtx)} #pm ${O.format(w.kurtd)}`),O.addText(`Kurtosis y = ${O.format(w.kurty)} #pm ${O.format(w.kurtd)}`),O.addText(`Kurtosis z = ${O.format(w.kurtz)} #pm ${O.format(w.kurtd)}`)):D>0&&(O.addText(`Kurtosis x = ${O.format(w.kurtx)}`),O.addText(`Kurtosis y = ${O.format(w.kurty)}`),O.addText(`Kurtosis z = ${O.format(w.kurtz)}`)),ie&&O.fillFunctionStat(this.findFunction(b.clTF3),ie,3),!0}getBinTooltips(O,ce,ie){const he=[],ue=this.getHisto();he.push(this.getObjectHint(),`x = ${this.getAxisBinTip("x",ue.fXaxis,O)}  xbin=${O+1}`,`y = ${this.getAxisBinTip("y",ue.fYaxis,ce)}  ybin=${ce+1}`,`z = ${this.getAxisBinTip("z",ue.fZaxis,ie)}  zbin=${ie+1}`);const fe=ue.getBinContent(O+1,ce+1,ie+1);if(fe===Math.round(fe)?he.push(`entries = ${fe}`):he.push(`entries = ${(0,ke.lg)(fe,b.gStyle.fStatFormat)}`),this.matchObjectType(b.clTProfile3D)){const le=ue.getBinError(ue.getBin(O+1,ce+1,ie+1));he.push("error = "+(le===Math.round(le)?le.toString():(0,ke.lg)(le,b.gStyle.fPaintTextFormat)))}return he}draw3DScatter(){const O=this.getObject(),ce=this.getFramePainter(),ie=this.getSelectIndex("x","left",.5),he=this.getSelectIndex("x","right",0),ue=this.getSelectIndex("y","left",.5),fe=this.getSelectIndex("y","right",0),le=this.getSelectIndex("z","left",.5),Y=this.getSelectIndex("z","right",0);let V,D,w,P;if(he<=ie||fe<=ue||Y<=le)return Promise.resolve(!0);const x=this.gmaxbin>1e3?1e3/this.gmaxbin:1,v=Math.max(0,this.gminbin);let _=0,C=0;for(V=ie;V<he;++V)for(D=ue;D<fe;++D)for(w=le;w<Y;++w)P=O.getBinContent(V+1,D+1,w+1),C+=P,!(P<=v)&&(_+=Math.round(P*x));if(_>(ce.webgl?1e5:3e4))return!1;const L=new Je._l(_,ce.webgl,ce.size_x3d/200),F=new Int32Array(_),U=new ke.YF(C);let j=0;for(V=ie;V<he;++V)for(D=ue;D<fe;++D)for(w=le;w<Y;++w){if(P=O.getBinContent(V+1,D+1,w+1),P<=v)continue;const te=Math.round(P*x);for(let N=0;N<te;++N){const m=O.fXaxis.GetBinCoord(V+U.random()),I=O.fYaxis.GetBinCoord(D+U.random()),A=O.fZaxis.GetBinCoord(w+U.random());F[j++]=O.getBin(V+1,D+1,w+1),L.addPoint(ce.grx(m),ce.gry(I),ce.grz(A))}}return L.createPoints({color:this.getColor(O.fMarkerColor)}).then(te=>(ce.add3DMesh(te),te.bins=F,te.painter=this,te.tip_color=3===O.fMarkerColor?16711680:65280,te.tooltip=function(N){const m=Math.floor(N.index/this.nvertex);if(m<0||m>=this.bins.length)return null;const I=this.painter,A=I.getHisto(),R=I.getFramePainter(),k=I.get3DToolTip(this.bins[m]);return k.x1=R.grx(A.fXaxis.GetBinLowEdge(k.ix)),k.x2=R.grx(A.fXaxis.GetBinLowEdge(k.ix+1)),k.y1=R.gry(A.fYaxis.GetBinLowEdge(k.iy)),k.y2=R.gry(A.fYaxis.GetBinLowEdge(k.iy+1)),k.z1=R.grz(A.fZaxis.GetBinLowEdge(k.iz)),k.z2=R.grz(A.fZaxis.GetBinLowEdge(k.iz+1)),k.color=this.tip_color,k.opacity=.3,k},!0))}draw3DBins(){var O=this;return(0,ve.A)(function*(){if(!O.draw_content)return!1;let ce=O.options.Box?O.options.BoxStyle:0;if(!ce&&O.options.Scat){const Qt=O.draw3DScatter();if(!1!==Qt)return Qt;ce=12}else!ce&&!O.options.GLBox&&!O.options.GLColor&&!O.options.Lego&&(ce=12);const ie=O.getHisto(),he=O.getFramePainter();let v,_,ue=0,fe=!1,le=!1,Y=!1,V=1,D=-1,w=O.getPadPainter()?.getRootPad()?.fLogv,P=!0,x=0,C=O.getColor(ie.fFillColor),L=.5;if(!ce&&O.options.Lego&&(ce=1===O.options.Lego?10:O.options.Lego),11===O.options.GLBox||12===O.options.GLBox){L=.4,fe=!0,12===O.options.GLBox&&(Y=!0);const Qt=he.webgl?new z.Gu$(.5,16,12):new z.Gu$(.5,8,6);Qt.applyMatrix4((new z.kn4).makeRotationX(Math.PI/2)),Qt.computeVertexNormals();const Bn=Qt.getIndex().array,dn=Qt.getAttribute("position").array,yn=Qt.getAttribute("normal").array;ue=3*Bn.length,v=new Float32Array(ue),_=new Float32Array(ue);for(let Tn=0;Tn<Bn.length;++Tn){const Hn=3*Bn[Tn];v[3*Tn]=dn[Hn],v[3*Tn+1]=dn[Hn+1],v[3*Tn+2]=dn[Hn+2],_[3*Tn]=yn[Hn],_[3*Tn+1]=yn[Hn+1],_[3*Tn+2]=yn[Hn+2]}}else{const Qt=Je.DJ.Indexes,Bn=Je.DJ.Normals,dn=Je.DJ.Vertices;ue=3*Qt.length,v=new Float32Array(ue),_=new Float32Array(ue);for(let yn=0,Tn=-3;yn<Qt.length;++yn){const Hn=dn[Qt[yn]];v[3*yn]=Hn.x-.5,v[3*yn+1]=Hn.y-.5,v[3*yn+2]=Hn.z-.5,yn%6==0&&(Tn+=3),_[3*yn]=Bn[Tn],_[3*yn+1]=Bn[Tn+1],_[3*yn+2]=Bn[Tn+2]}le=!0,12===ce?Y=!0:13===ce?(Y=!0,le=!1):O.options.GLColor&&(Y=!0,V=.5,P=!1,le=!1,D=0,fe=!0)}O._box_option=ce,P&&w?O.gminposbin&&O.gmaxbin>O.gminposbin?(x=Math.log(O.gminposbin)-.1,P=1/(Math.log(O.gmaxbin)-x)):(w=0,P=1):P&&(P=O.gminbin||O.gmaxbin?1/Math.max(Math.abs(O.gminbin),Math.abs(O.gmaxbin)):1);const F=Qt=>{if(D>=0&&Qt<D)return 0;if(!P)return 1;if(w){if(Qt<=0)return 0;Qt=Math.log(Qt)-x}return Math.pow(Math.abs(Qt*P),.3333)},U=O.getSelectIndex("x","left",.5),j=O.getSelectIndex("x","right",0),te=O.getSelectIndex("y","left",.5),N=O.getSelectIndex("y","right",0),m=O.getSelectIndex("z","left",.5),I=O.getSelectIndex("z","right",0);if(j<=U||N<=te||I<=m)return!1;const A={},R={},k=Y?O.getContour():null,J=Y?O.getHistPalette():null;let be,Te,Pe,We,dt,_e=0,Q=0,Ke=null;O.transferFunc&&(0,Re.Dx)(O.transferFunc,!0)&&(Ke=O.transferFunc);const Ze=Qt=>{const Bn=3*(0,Re.rr)(Ke,dt,!1);return!Bn||Bn<0||Bn>=1?Qt:Qt+1e4*Math.round(200*Bn)};for(be=U;be<j;++be)for(Te=te;Te<N;++Te)for(Pe=m;Pe<I;++Pe){if(dt=ie.getBinContent(be+1,Te+1,Pe+1),!O.options.GLColor&&(0===dt||dt<O.gminbin)||(We=F(dt),We<.001)||(_e++,!Y))continue;let Qt=k.getPaletteIndex(J,dt);null!==Qt?(Ke&&(Qt=Ze(Qt)),void 0===A[Qt]&&(A[Qt]=0,R[Qt]=Q++),A[Qt]+=1):console.error(`not found color for value = ${dt}`)}Y||(A[0]=_e,Q=1,R[0]=0);const Ue=new Array(Q),Oe=new Array(Q),lt=new Array(Q),gt=new Array(Q),ht=new Array(Q),st=new Array(Q),yt=new Array(Q);for(const Qt in A){_e=A[Qt];const Bn=R[Qt];Ue[Bn]=ht[Bn]=0,le&&(ht[Bn]=_e*ue/3>65520?2:1),Oe[Bn]=new Float32Array(_e*ue),lt[Bn]=new Float32Array(_e*ue),gt[Bn]=new Int32Array(_e),1===ht[Bn]&&(st[Bn]=new Uint16Array(_e*Je.DJ.MeshSegments.length)),2===ht[Bn]&&(yt[Bn]=new Float32Array(_e*Je.DJ.Segments.length*3))}let Kt,Ot,It,An,on,pn;for(be=U;be<j;++be)for(Kt=he.grx(ie.fXaxis.GetBinLowEdge(be+1)),Ot=he.grx(ie.fXaxis.GetBinLowEdge(be+2)),Te=te;Te<N;++Te)for(It=he.gry(ie.fYaxis.GetBinLowEdge(Te+1)),An=he.gry(ie.fYaxis.GetBinLowEdge(Te+2)),Pe=m;Pe<I;++Pe){if(dt=ie.getBinContent(be+1,Te+1,Pe+1),!O.options.GLColor&&(0===dt||dt<O.gminbin)||(We=F(dt),We<.001))continue;let Qt=0;if(Y){let Tn=k.getPaletteIndex(J,dt);if(null===Tn)continue;Ke&&(Tn=Ze(Tn)),Qt=R[Tn]}_e=Ue[Qt],on=he.grz(ie.fZaxis.GetBinLowEdge(Pe+1)),pn=he.grz(ie.fZaxis.GetBinLowEdge(Pe+2)),gt[Qt][_e]=ie.getBin(be+1,Te+1,Pe+1);const Bn=Oe[Qt],dn=lt[Qt];let yn=_e*ue;for(let Tn=0;Tn<ue;Tn+=3,yn+=3)Bn[yn]=(Ot+Kt)/2+v[Tn]*(Ot-Kt)*We,Bn[yn+1]=(An+It)/2+v[Tn+1]*(An-It)*We,Bn[yn+2]=(pn+on)/2+v[Tn+2]*(pn-on)*We,dn[yn]=_[Tn],dn[yn+1]=_[Tn+1],dn[yn+2]=_[Tn+2];if(1===ht[Qt]){const Tn=Je.DJ.MeshSegments;yn=_e*Tn.length;const Hn=Math.round(_e*ue/3),ti=st[Qt];for(let hi=0;hi<Tn.length;++hi)ti[yn+hi]=Hn+Tn[hi]}if(2===ht[Qt]){const Tn=Je.DJ.Segments,Hn=yt[Qt];yn=_e*Tn.length*3;for(let ti=0;ti<Tn.length;++ti,yn+=3){const hi=Je.DJ.Vertices[Tn[ti]];Hn[yn]=(Ot+Kt)/2+(hi.x-.5)*(Ot-Kt)*We,Hn[yn+1]=(An+It)/2+(hi.y-.5)*(An-It)*We,Hn[yn+2]=(pn+on)/2+(hi.z-.5)*(pn-on)*We}}Ue[Qt]=_e+1}for(const Qt in A){const Bn=R[Qt],dn=new z.LoY;dn.setAttribute("position",new z.THS(Oe[Bn],3)),dn.setAttribute("normal",new z.THS(lt[Bn],3));let yn=V;Y&&(C=O._color_palette.getColor(Qt%1e4),Qt>1e4&&(yn=Math.floor(Qt/1e4)/200));const Tn=fe?new z.G_z({color:C,opacity:yn,transparent:yn<1,vertexColors:!1}):new z.V9B({color:C,opacity:yn,transparent:yn<1,vertexColors:!1}),Hn=new z.eaF(dn,Tn);if(Hn.bins=gt[Bn],Hn.bins_faces=ue/9,Hn.painter=O,Hn.tipscale=L,Hn.tip_color=3===ie.fFillColor?16711680:65280,Hn.get_weight=F,Hn.tooltip=function(ti){const hi=Math.floor(ti.faceIndex/this.bins_faces);if(hi<0||hi>=this.bins.length)return null;const ai=this.painter,Xi=ai.getHisto(),Or=ai.getFramePainter(),Tr=ai.get3DToolTip(this.bins[hi]),ys=Or.grx(Xi.fXaxis.GetBinCoord(Tr.ix-1)),ds=Or.grx(Xi.fXaxis.GetBinCoord(Tr.ix)),wt=Or.gry(Xi.fYaxis.GetBinCoord(Tr.iy-1)),W=Or.gry(Xi.fYaxis.GetBinCoord(Tr.iy)),pe=Or.grz(Xi.fZaxis.GetBinCoord(Tr.iz-1)),me=Or.grz(Xi.fZaxis.GetBinCoord(Tr.iz)),Fe=this.get_weight(Tr.value)*this.tipscale;return Tr.x1=(ds+ys)/2-(ds-ys)*Fe,Tr.x2=(ds+ys)/2+(ds-ys)*Fe,Tr.y1=(W+wt)/2-(W-wt)*Fe,Tr.y2=(W+wt)/2+(W-wt)*Fe,Tr.z1=(me+pe)/2-(me-pe)*Fe,Tr.z2=(me+pe)/2+(me-pe)*Fe,Tr.color=this.tip_color,Tr},he.add3DMesh(Hn),ht[Bn]>0){const ti=new z.mrM({color:O.getColor(ie.fLineColor)}),hi=1===ht[Bn]?(0,Je.Fc)(Oe[Bn],ti,st[Bn]):(0,Je.Fc)(yt[Bn],ti);he.add3DMesh(hi)}}return!0})()}redraw(O){var ce=this;return(0,ve.A)(function*(){const ie=ce.getFramePainter(),he=ce.getHisto();let ue=Promise.resolve(!0);return"resize"===O?ie.resize3D()&&ie.render3D():((0,ot.wx)(ie),ue=ie.create3DScene(ce.options.Render3D,ce.options.x3dscale,ce.options.y3dscale,ce.options.Ortho).then(()=>(ie.setAxesRanges(he.fXaxis,ce.xmin,ce.xmax,he.fYaxis,ce.ymin,ce.ymax,he.fZaxis,ce.zmin,ce.zmax,ce),ie.set3DOptions(ce.options),ie.drawXYZ(ie.toplevel,et.TB,{zoom:b.settings.Zooming,ndim:3,draw:-1!==ce.options.Axis,drawany:ce.options.isCartesian()}),ce.draw3DBins())).then(()=>{ie.render3D(),ce.updateStatWebCanvas(),ie.addKeysHandler()})),ce.isMainPainter()&&(ue=ue.then(()=>ce.drawColorPalette(ce.options.Zscale&&(12===ce._box_option||13===ce._box_option)))),ue.then(()=>ce.updateFunctions()).then(()=>ce.updateHistTitle()).then(()=>ce)})()}fillToolbar(){const O=this.getPadPainter();O&&(O.addPadButton("auto_zoom","Unzoom all axes","ToggleZoom","Ctrl *"),this.draw_content&&O.addPadButton("statbox","Toggle stat box","ToggleStatBox"),O.showPadButtons())}canZoomInside(O,ce,ie){let he=this.getHisto();return he&&(he=he[`f${O.toUpperCase()}axis`]),!he||he.FindBin(ie,.5)-he.FindBin(ce,0)>1}autoZoom(){const O=this.getSelectIndex("x","left"),ce=this.getSelectIndex("x","right"),ie=this.getSelectIndex("y","left"),he=this.getSelectIndex("y","right"),ue=this.getSelectIndex("z","left"),fe=this.getSelectIndex("z","right"),le=this.getObject();let Y,V,D;if(O===ce||ie===he||ue===fe)return;let w=le.getBinContent(O+1,ie+1,ue+1);for(Y=O;Y<ce;++Y)for(V=ie;V<he;++V)for(D=ue;D<fe;++D)w=Math.min(w,le.getBinContent(Y+1,V+1,D+1));if(w>0)return;let P=ce,x=O,v=he,_=ie,C=fe,L=ue;for(Y=O;Y<ce;++Y)for(V=ie;V<he;++V)for(D=ue;D<fe;++D)le.getBinContent(Y+1,V+1,D+1)>w&&(Y<P&&(P=Y),Y>=x&&(x=Y+1),V<v&&(v=V),V>=_&&(_=V+1),D<C&&(C=D),D>=L&&(L=D+1));let F,U,j,te,N,m,I=!1;return P===x-1&&P>O+1&&x<ce-1&&(P--,x++),v===_-1&&v>ie+1&&_<he-1&&(v--,_++),C===L-1&&C>ue+1&&L<fe-1&&(C--,L++),(P>O||x<ce)&&P<x-1&&(F=le.fXaxis.GetBinLowEdge(P+1),U=le.fXaxis.GetBinLowEdge(x+1),I=!0),(v>ie||_<he)&&v<_-1&&(j=le.fYaxis.GetBinLowEdge(v+1),te=le.fYaxis.GetBinLowEdge(_+1),I=!0),(C>ue||L<fe)&&C<L-1&&(N=le.fZaxis.GetBinLowEdge(C+1),m=le.fZaxis.GetBinLowEdge(L+1),I=!0),I?this.getFramePainter().zoom(F,U,j,te,N,m):void 0}fillHistContextMenu(O){const ce=this.getSupportedDrawOptions();O.addDrawMenu("Draw with",ce,ie=>{if(0===ie.indexOf(b.kInspect))return this.showInspector(ie);this.decodeOptions(ie),this.interactiveRedraw(!0,"drawopt")})}static draw(O,ce,ie){return(0,ve.A)(function*(){const he=new He(O,ce);return he.mode3d=!0,(0,xe.ensureTCanvas)(he,"3d").then(()=>(he.setAsMainPainter(),he.decodeOptions(ie),he.checkPadRange(),he.scanContent(),he.createStat(),he.redraw())).then(()=>he.drawFunctions()).then(()=>(he.fillToolbar(),he))})()}}},4485:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{TPavePainter:()=>O});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(8977),xe=Ee(9041),et=Ee(6224),Je=Ee(6370),Xe=Ee(4468),ot=Ee(4952),Re=Ee(9025);const He=(0,b.BIT)(17);class O extends et.JW{constructor(ie,he){super(ie,he),this.Enabled=!0,this.UseContextMenu=!0}autoPlaceLegend(ie,he,ue){var fe=this;return(0,ve.A)(function*(){let Y=fe.getFrameSvg().selectChild(".main_layer").node().outerHTML;Y=(0,xe.NM)(Y),Y='<svg xmlns="http://www.w3.org/2000/svg"'+Y.slice(4);const V=he?.fLeftMargin??b.gStyle.fPadLeftMargin,D=he?.fRightMargin??b.gStyle.fPadRightMargin,w=he?.fTopMargin??b.gStyle.fPadTopMargin,P=he?.fBottomMargin??b.gStyle.fPadBottomMargin;return(0,xe.Vm)(Y).then(x=>{if(!x)return!1;let v=100,_=100;const L=x.getContext("2d").getImageData(0,0,x.width,x.height).data,F=Math.floor(x.width/v),U=Math.floor(x.height/_),j=new Array(v*_);L.length!==x.width*x.height*4&&(console.log(`Image size missmatch in TLegend autoplace ${L.length} expected ${x.width*x.height*4}`),v=_=0);for(let R=0;R<v;++R){const k=R*F,J=k+F;for(let _e=0;_e<_;++_e){const be=_e*U,Te=be+U;let Pe=0;for(let We=k;We<J&&!Pe;++We)for(let dt=be;dt<Te;++dt){const Q=4*(dt*x.width+We);if(L[Q]||L[Q+1]||L[Q+2]||L[Q+3]){Pe=1;break}}j[_e*v+R]=Pe}}const te=.3/Math.max(.2,1-V-D),N=Math.min(.5,Math.max(.1,.05*ie.fPrimitives.arr.length))/Math.max(.2,1-w-P),m=Math.round(te*v),I=Math.round(N*_),A=(R,k)=>{for(let J=R;J<R+m;++J)for(let _e=k;_e<k+I;++_e)if(j[_e*v+J])return!1;return!0};for(let R=0;R<v-m;++R)for(let k=_-I-1;k>=0;--k)if(A(R,k))return ie.fX1NDC=V+R/v*(1-V-D),ie.fX2NDC=ie.fX1NDC+te*(1-V-D),ie.fY2NDC=1-w-k/_*(1-P-w),ie.fY1NDC=ie.fY2NDC-N*(1-P-w),!0}).then(x=>{if(x||ue)return x;ie.fX1NDC=Math.max(V??0,ie.fX2NDC-.3),ie.fX2NDC=Math.min(ie.fX1NDC+.3,1-D);const v=Math.max(ie.fPrimitives?.05*ie.fPrimitives.arr.length:0,.2);return ie.fY2NDC=Math.min(1-w,ie.fY1NDC+v),ie.fY1NDC=Math.max(ie.fY2NDC-v,P),!0})})()}drawPave(ie){var he=this;return(0,ve.A)(function*(){if(!he.Enabled)return he.removeG(),he;const ue=he.getObject(),fe=ue.fOption.toUpperCase(),le=he.getFramePainter(),Y=he.getPadPainter(),V=Y.getRootPad(!0);let D,w,P;0===ue.fInit&&(he.stored=Object.assign({},ue),ue.fInit=1,ue._typename!==b.clTPaletteAxis||ue.fX1||ue.fX2||ue.fY1||ue.fY2?fe.indexOf("NDC")>=0?(ue.fX1NDC=ue.fX1,ue.fX2NDC=ue.fX2,ue.fY1NDC=ue.fY1,ue.fY2NDC=ue.fY2):V&&0===V.fX1&&1===V.fX2&&0===V.fY1&&1===V.fY2&&(0,b.isStr)(ie)&&ie.indexOf("postpone")>=0?(ue.fInit=0,ue.fX1NDC=ue.fY1NDC=.99,ue.fX2NDC=ue.fY2NDC=1):V?(V.fLogx&&(ue.fX1>0&&(ue.fX1=Math.log10(ue.fX1)),ue.fX2>0&&(ue.fX2=Math.log10(ue.fX2))),V.fLogy&&(ue.fY1>0&&(ue.fY1=Math.log10(ue.fY1)),ue.fY2>0&&(ue.fY2=Math.log10(ue.fY2))),ue.fX1NDC=(ue.fX1-V.fX1)/(V.fX2-V.fX1),ue.fY1NDC=(ue.fY1-V.fY1)/(V.fY2-V.fY1),ue.fX2NDC=(ue.fX2-V.fX1)/(V.fX2-V.fX1),ue.fY2NDC=(ue.fY2-V.fY1)/(V.fY2-V.fY1)):(ue.fX1NDC=ue.fY1NDC=.1,ue.fX2NDC=ue.fY2NDC=.9):le?(ue.fX1NDC=le.fX2NDC+.01,ue.fX2NDC=Math.min(.96,le.fX2NDC+.06),ue.fY1NDC=le.fY1NDC,ue.fY2NDC=le.fY2NDC):(ue.fX2NDC=.8,ue.fX1NDC=.9,ue.fY1NDC=.1,ue.fY2NDC=.9));let x=Promise.resolve(!0);return ue._typename===b.clTLegend&&(he.AutoPlace||ue.fX1NDC===ue.fX2NDC&&ue.fY1NDC===ue.fY2NDC)&&(x=he.autoPlaceLegend(ue,V).then(v=>(delete he.AutoPlace,v||(ue.fX1NDC=le.fX2NDC-.2,ue.fX2NDC=le.fX2NDC,ue.fY1NDC=le.fY2NDC-.1,ue.fY2NDC=le.fY2NDC),v))),x.then(()=>{if(he.isStats()&&!he.NoFillStats&&!Y._fast_drawing){const U=ue.$main_painter||he.getMainPainter();if((0,b.isFunc)(U?.fillStatistic)){let j=parseInt(ue.fOptStat),te=parseInt(ue.fOptFit);if((!Number.isInteger(j)||ue.TestBit(He))&&(j=b.gStyle.fOptStat),(!Number.isInteger(te)||ue.TestBit(He))&&(te=b.gStyle.fOptFit),U.fillStatistic(he,j,te)){let N=ue.fLines?.arr.length||0;if(N>0&&!he.moved_interactive&&function Ie(ce){const ie=(he,ue)=>Math.abs(he-ue)<.001;return ie(ce.fX1NDC,b.gStyle.fStatX-b.gStyle.fStatW)&&ie(ce.fY1NDC,b.gStyle.fStatY-b.gStyle.fStatH)&&ie(ce.fX2NDC,b.gStyle.fStatX)&&ie(ce.fY2NDC,b.gStyle.fStatY)}(ue)){const m=he._has_fit&&he._fit_dim>1?b.gStyle.fStatH:0;m&&(N-=he._fit_cnt);let I=b.gStyle.fStatH,A=b.gStyle.fStatW;he._has_fit&&(A=1.8*b.gStyle.fStatW),b.gStyle.fStatFontSize<=0||b.gStyle.fStatFont%10==3?I=.25*N*b.gStyle.fStatH:b.gStyle.fStatFontSize<1&&(I=N*b.gStyle.fStatFontSize),ue.fX1NDC=Math.max(.02,ue.fX2NDC-A),ue.fY1NDC=Math.max(.02,ue.fY2NDC-I-m)}}}}const v=Y.getPadRect(),_=ue.fBorderSize,C=fe.indexOf("NB")>=0,L=fe.indexOf("L")>=0?-1:fe.indexOf("R")>=0?1:0,F=fe.indexOf("T")>=0?-1:fe.indexOf("B")>=0?1:0;if(he.createG(),he._pave_x=Math.round(ue.fX1NDC*v.width),he._pave_y=Math.round((1-ue.fY2NDC)*v.height),w=Math.round((ue.fX2NDC-ue.fX1NDC)*v.width),P=Math.round((ue.fY2NDC-ue.fY1NDC)*v.height),(0,xe.bk)(he.draw_g,he._pave_x,he._pave_y),he.createAttLine({attr:ue,width:_>0?ue.fLineWidth:0}),he.createAttFill({attr:ue}),ue._typename===b.clTDiamond){const U=Math.round(P/2),j=Math.round(w/2),te=`l${j},${-U}l${j},${U}l${-j},${U}z`;_>1&&ue.fShadowColor>0&&(L||F)&&!he.fillatt.empty()&&!C&&he.draw_g.append("svg:path").attr("d","M0,"+(U+_)+te).style("fill",he.getColor(ue.fShadowColor)).style("stroke",he.getColor(ue.fShadowColor)).style("stroke-width","1px"),D=he.draw_g.append("svg:path").attr("d","M0,"+U+te).call(he.fillatt.func).call(he.lineatt.func);const N=he.draw_g.append("svg:g");return(0,xe.bk)(N,Math.round(w/4),Math.round(P/4)),he.drawPaveText(j,U,ie,N)}if(_>1&&ue.fShadowColor>0&&!ue.fNpaves&&(L||F)&&!C){const U=he.getColor(ue.fShadowColor);let j="";j=L<0&&F<0?`M0,0v${P-_}h${-_}v${-P}h${w}v${_}z`:L<0&&F>0?`M0,${P}v${_-P}h${-_}v${P}h${w}v${-_}z`:L>0&&F<0?`M${_},0v${-_}h${w}v${P}h${-_}v${_-P}z`:`M${w},${_}h${_}v${P}h${-w}v${-_}h${w-_}z`,he.draw_g.append("svg:path").attr("d",j).style("fill",U).style("stroke",U).style("stroke-width","1px")}if(ue.fNpaves)for(let U=ue.fNpaves-1;U>0;--U)he.draw_g.append("svg:path").attr("d",`M${4*L*U},${4*F*U}h${w}v${P}h${-w}z`).call(he.fillatt.func).call(he.lineatt.func);return(!he.isBatchMode()||!he.fillatt.empty()||!he.lineatt.empty()&&!C)&&(D=he.draw_g.append("svg:path").attr("d",`M0,0H${w}V${P}H0Z`).call(he.fillatt.func),C||D.call(he.lineatt.func)),!(0,b.isFunc)(he.paveDrawFunc)||he.paveDrawFunc(w,P,ie)}).then(()=>(he.isBatchMode()||ue._typename===b.clTPave||(D&&D.style("pointer-events","visibleFill").on("mouseenter",()=>he.showObjectStatus()),(0,ot.WJ)(he,{obj:ue,x:he._pave_x,y:he._pave_y,width:w,height:P,minwidth:10,minheight:20,canselect:!0,redraw:()=>{he.moved_interactive=!0,he.interactiveRedraw(!1,"pave_moved"),he.drawPave()},ctxmenu:b.browser.touches&&b.settings.ContextMenu&&he.UseContextMenu}),he.UseContextMenu&&b.settings.ContextMenu&&he.draw_g.on("contextmenu",v=>he.paveContextMenu(v)),ue._typename===b.clTPaletteAxis&&he.interactivePaletteAxis(w,P)),he))})()}fillWebObjectOptions(ie){const he=this.getObject();return he?.fInit&&(ie.fcust="pave",ie.fopt=[he.fX1NDC,he.fY1NDC,he.fX2NDC,he.fY2NDC],"stats"===he.fName&&this.isStats()&&he.fLines.arr.forEach(ue=>{(ue._typename===b.clTText||ue._typename===b.clTLatex)&&(ie.fcust+=`;;${ue.fTitle}`)})),ie}drawPaveLabel(ie,he){var ue=this;return(0,ve.A)(function*(){const fe=ue.getObject();return fe.fLabel&&fe.fLabel.trim()?(ue.createAttText({attr:fe,can_rotate:!1}),ue.startTextDrawing(ue.textatt.font,he/1.2),ue.drawText(ue.textatt.createArg({width:ie,height:he,text:fe.fLabel,norotate:!0})),ue.finishTextDrawing()):ue})()}drawPaveStats(ie,he){const ue=this.getObject(),fe=[],le=[];let Y=0,V=0,D=0;for(let C=0;C<ue.fLines.arr.length;++C){const L=ue.fLines.arr[C];(L._typename===b.clTText||L._typename===b.clTLatex)&&(fe.push(L.fTitle),le.push(L.fTextColor))}const w=fe.length;for(let C=0;C<w;++C){const L=fe[C];if(C>0&&(D=Math.max(D,L.length)),0===C||L.indexOf("|")<0)continue;0===Y&&(Y=C);const F=L.split("|");F.length>V&&(V=F.length)}const P=he/w,x=ue.fMargin*ie;let v=!1;if(this.createAttText({attr:ue,can_rotate:!1}),this.startTextDrawing(this.textatt.font,he/(1.2*w)),1===w)this.drawText(this.textatt.createArg({width:ie,height:he,text:fe[0],latex:1,norotate:!0}));else for(let C=0;C<w;++C){const L=C*P,F=le[C]>1?this.getColor(le[C]):this.textatt.color;if(Y&&C>=Y){const U=fe[C].split("|");for(let j=0;j<U.length;++j)this.drawText({align:"middle",x:ie*j/V,y:L,latex:0,width:ie/V,height:P,text:U[j],color:F})}else if(fe[C].indexOf("=")<0){if(0===C){v=!0;const U=Math.max(D,Math.round((ie-2*x)/P/.65));fe[C].length>U+5&&(fe[C]=fe[C].slice(0,U+2)+"...")}this.drawText({align:0===C?"middle":"start",x,y:L,width:ie-2*x,height:P,text:fe[C],color:F})}else{const U=fe[C].split("="),j=[];for(let te=0;te<2;++te)j.push({align:0===te?"start":"end",x,y:L,width:ie-2*x,height:P,text:U[te],color:F,_expected_width:ie-2*x,_args:j,post_process(m){this._args[0].ready&&this._args[1].ready&&m.scaleTextDrawing(1.05*(this._args[0].result_width+this._args[1].result_width)/this._expected_width,m.draw_g)}});for(let te=0;te<2;++te)this.drawText(j[te])}}let _="";if(ue.fBorderSize>0&&v&&(_+=`M0,${Math.round(P)}h${ie}`),Y>0&&V>1){for(let C=Y;C<w;++C)_+=`M0,${Math.round(C*P)}h${ie}`;for(let C=0;C<V-1;++C)_+=`M${Math.round(ie/V*(C+1))},${Math.round(Y*P)}V${he}`}return _&&this.draw_g.append("svg:path").attr("d",_).call(this.lineatt.func),this.finishTextDrawing(void 0,w>1)}drawPaveText(ie,he,ue,fe){const le=this.getObject(),Y=le.fLines?.arr||[],V=Y.length,D=this.getPadPainter(),w=D.getPadHeight(),P=le.fLabel.length>0,x=[],v=le.fMargin*ie,_=he/(V||1);let C=0;this.createAttText({attr:le,can_rotate:!1}),1===V&&this.textatt.size>0&&(C=Math.max(3,this.textatt.getSize(w))),fe||(fe=this.draw_g);const L=1===V&&D._fast_drawing;let F=0,U=!1;for(let j=0;j<V;++j){const te=Y[j],N=j*_;switch(te._typename){case b.clTText:case b.clTLatex:{if(!te.fTitle||!te.fTitle.trim())continue;let m=te.fTextColor?this.getColor(te.fTextColor):"";if(m||(m=this.textatt.color),U=!0,te.fX||te.fY||te.fTextSize){const I=te.fTextAlign||this.textatt.align,A=Math.floor(I/10),R=I%10,k=te.fX?te.fX*ie:1===A?v:2===A?ie/2:ie-v,J=te.fY?(1-te.fY)*he:N+(2===R?_/2:3===R?_:0),_e=fe.append("svg:g");this.startTextDrawing(this.textatt.font,this.textatt.getAltSize(te.fTextSize,w),_e),this.drawText({align:I,x:k,y:J,text:te.fTitle,color:m,latex:te._typename===b.clTText?0:1,draw_g:_e,fast:L}),x.push(this.finishTextDrawing(_e))}else 0==F++&&this.startTextDrawing(this.textatt.font,.85*he/V,fe,C),this.drawText({x:v,y:N,width:ie-2*v,height:_,align:te.fTextAlign||this.textatt.align,draw_g:fe,latex:te._typename===b.clTText?0:1,text:te.fTitle,color:m,fast:L});break}case b.clTLine:{const m=te.fX1?Math.round(te.fX1*ie):0,I=te.fX2?Math.round(te.fX2*ie):ie,A=te.fY1?Math.round((1-te.fY1)*he):Math.round(N+.5*_),R=te.fY2?Math.round((1-te.fY2)*he):Math.round(N+.5*_),k=this.createAttLine(te);fe.append("svg:path").attr("d",`M${m},${A}L${I},${R}`).call(k.func);break}case b.clTBox:{const m=te.fX1?Math.round(te.fX1*ie):0,I=te.fX2?Math.round(te.fX2*ie):ie,A=te.fY1?Math.round((1-te.fY1)*he):Math.round(N),R=te.fY2?Math.round((1-te.fY2)*he):Math.round(N+_),k=this.createAttFill(te);fe.append("svg:path").attr("d",`M${m},${A}H${I}V${R}H${m}Z`).call(k.func);break}}}if(F>0&&x.push(this.finishTextDrawing(fe,F>1)),this.isTitle()&&this.draw_g.style("display",U?null:"none"),P){const j=Math.round(.25*ie),te=Math.round(.02*-he),N=Math.round(.5*ie),m=Math.round(.04*he),I=fe.append("svg:g");I.append("svg:path").attr("d",`M${j},${te}h${N}v${m}h${-N}z`).call(this.fillatt.func).call(this.lineatt.func),this.startTextDrawing(this.textatt.font,m/1.5,I),this.drawText({align:22,x:j,y:te,width:N,height:m,text:le.fLabel,color:this.textatt.color,draw_g:I}),x.push(this.finishTextDrawing(I))}return Promise.all(x).then(()=>this)}format(ie,he){he||(he="stat");const ue=this.getObject();switch(he){case"stat":he=ue.fStatFormat||b.gStyle.fStatFormat;break;case"fit":he=ue.fFitFormat||b.gStyle.fFitFormat;break;case"entries":if(Math.abs(ie)<1e9&&Math.round(ie)===ie)return ie.toFixed(0);he="14.7g";break;case"last":he=this.lastformat}const fe=(0,xe.lg)(ie,he||"6.4g",!0);return this.lastformat=fe[1],fe[0]}drawLegend(ie,he){const ue=this.getObject(),fe=ue.fPrimitives.arr.length;let le=ue.fNColumns,Y=fe,V=!1,D=!1;if(le<2)le=1;else for(;(Y-1)*le>=fe;)Y--;const w=N=>!(N.fObject||N.fOption||N.fLabel&&" "!==N.fLabel);for(let N=0;N<fe;++N){const m=ue.fPrimitives.arr[N];w(m)?1===le&&Y--:m.fLabel&&(V=!0,(m.fTextFont&&m.fTextFont!==ue.fTextFont||m.fTextSize&&m.fTextSize!==ue.fTextSize)&&(D=!0))}Y<1&&(Y=1);const P=new Array(le+1).fill(0);if(le>1){const N=new Array(le).fill(1);for(let I=0;I<fe;++I){const A=ue.fPrimitives.arr[I];if(w(A))continue;const R=I%le;N[R]=Math.max(N[R],A.fLabel.length)}let m=0;for(let I=0;I<le;++I)m+=N[I];for(let I=0;I<le-1;++I)P[I+1]=P[I]+ue.fMargin*ie/le+N[I]*(1-ue.fMargin)*ie/m}P[le]=ie;const x=Math.round(.03*ie/le),v=Math.round(.03*he),_=(he-2*v)/Y,C=[],L=this.getPadPainter();let F=.9*_,U=0,j=!1;this.createAttText({attr:ue,can_rotate:!1});const te=this.textatt.getSize(L.getPadHeight());te&&te<F&&(F=U=te),V&&!D&&this.startTextDrawing(this.textatt.font,F,this.draw_g,U);for(let N=0,m=-1;N<fe;++N){const I=ue.fPrimitives.arr[N];if(w(I))continue;1===le?++m:m=N;const A=I.fOption.toLowerCase(),R=m%le,k=(m-R)/le,J=Math.round(P[R]),_e=Math.round(P[R+1]-P[R]),be=J+Math.round(ue.fMargin*ie/le),Te=Math.round((J+be)/2),Pe=Math.round(k*_+v),We=Math.round((k+.5)*_+v),dt=I.fObject,Q=-1!==A.indexOf("f"),Ke=-1!==A.indexOf("l"),Ze=-1!==A.indexOf("e"),Ue=-1!==A.indexOf("p");let Oe=I,lt=I,gt=I,ht=null,st=!1;if((0,b.isObject)(dt)&&("fLineColor"in dt&&(gt=dt),"fFillColor"in dt&&(Oe=dt),"fMarkerColor"in dt&&(lt=dt),ht=L.findPainterFor(dt)),Q){const Kt=ht?.fillatt?.used?ht.fillatt:this.createAttFill(Oe);let Ot;if(!Ke&&!Ze&&!Ue&&(Ot=ht?.lineatt?.used?ht.lineatt:this.createAttLine(gt),Ot.empty()&&(Ot=null)),!Kt.empty()||Ot){st=!0;const It=this.draw_g.append("svg:path").attr("d",`M${J+x},${Math.round(Pe+.1*_)}v${Math.round(.8*_)}h${be-2*x-J}v${-Math.round(.8*_)}z`);Kt.empty()?It.style("fill","none"):It.call(Kt.func),Ot&&It.call(Ot.func)}}if(Ke||Ze){const Kt=ht?.lineatt?.used?ht.lineatt:this.createAttLine(gt);if(!Kt.empty()&&(st=!0,Ke&&this.draw_g.append("svg:path").attr("d",`M${J+x},${We}H${be-x}`).call(Kt.func),Ze)){let Ot=0,It=.05*_;(0,b.isFunc)(ht?.getHisto)&&1===ht.options?.ErrorKind?Ot=1:(0,b.isFunc)(ht?.getGraph)&&void 0!==dt?.fLineWidth&&void 0!==dt?.fMarkerSize&&(Ot=ht.options?.Ends??1,It=dt.fLineWidth+b.gStyle.fEndErrorSize,Ot>1&&(It=Math.max(It,8*dt.fMarkerSize*.66)));const An=3===Ot?.03:0,on=Math.round(Pe+_*(.1+An)),pn=Math.round(Pe+_*(.9-An)),Qt=Math.round(.66*It);It=Math.round(It);let Bn=`M${Te},${on}V${pn}`;switch(Ot){case 1:Bn+=`M${Te-It},${on}h${2*It}M${Te-It},${pn}h${2*It}`;break;case 2:Bn+=`M${Te-It},${on+Qt}v${-Qt}h${2*It}v${Qt}M${Te-It},${pn-Qt}v${Qt}h${2*It}v${-Qt}`;break;case 3:Bn+=`M${Te-It},${on}h${2*It}l${-It},${-Qt}zM${Te-It},${pn}h${2*It}l${-It},${Qt}z`;break;case 4:Bn+=`M${Te-It},${on+Qt}l${It},${-Qt}l${It},${Qt}M${Te-It},${pn-Qt}l${It},${Qt}l${It},${-Qt}`}this.draw_g.append("svg:path").attr("d",Bn).call(Kt.func).style("fill",Ot>1?"none":null)}}if(Ue){const Kt=ht?.markeratt?.used?ht.markeratt:this.createAttMarker(lt);Kt.empty()||(st=!0,this.draw_g.append("svg:path").attr("d",Kt.create((J+be)/2,We)).call(Kt.func))}!st&&ht?.lineatt&&!ht.lineatt.empty()&&this.draw_g.append("svg:path").attr("d",`M${J+x},${Math.round(Pe+.1*_)}v${Math.round(.8*_)}h${be-2*x-J}v${-Math.round(.8*_)}z`).style("fill","none").call(ht.lineatt.func);let yt=be;if((0,b.isStr)(A)&&"h"!==A.toLowerCase()?j=!0:j||(yt=J+x),I.fLabel){let Kt=this.draw_g;const Ot=this.createAttText({attr:I,std:!1,attr_alt:ue});if(D){Kt=this.draw_g.append("svg:g");const It=Ot.getSize(L.getPadHeight());this.startTextDrawing(Ot.font,It,Kt,U)}this.drawText({draw_g:Kt,align:Ot.align,x:yt,y:Pe,scale:D&&!I.fTextSize||!ue.fTextSize,width:J+_e-yt-x,height:_,text:I.fLabel,color:Ot.color}),D&&C.push(this.finishTextDrawing(Kt))}}return V&&!D&&C.push(this.finishTextDrawing()),Promise.all(C)}drawPaletteAxis(ie,he,ue){const fe=this.getObject(),le=fe.fAxis,Y=(0,b.isStr)(ue)&&ue.indexOf("can_move")>=0,V=(0,b.isStr)(ue)&&ue.indexOf("postpone")>=0,D=(0,b.isStr)(ue)&&ue.indexOf("cjust")>=0,w=this.getPadPainter(),P=w.getPadWidth(),x=w.getPadHeight(),v=w.getRootPad(!0),_=fe.$main_painter||this.getMainPainter(),C=this.getFramePainter(),L=_.fContour,F=L?.getLevels(),U=(0,b.isFunc)(_.getDimension)&&3===_.getDimension(),j=v?.fLogv??(!U&&v?.fLogz),te=_._color_palette,N=_.getObject()?.fZaxis,m=v?.fTickz?.35:.7;let R,k,I=0,A=100,J="",_e=0;if(this._palette_vertical=fe.fX2NDC-fe.fX1NDC<fe.fY2NDC-fe.fY1NDC,le.fTickSize=.6*ie/P,typeof N?.fLabelOffset<"u"&&!U&&(le.fBits=N.fBits&~et.rb.kTickMinus&~et.rb.kTickPlus,le.fTitle=N.fTitle,le.fTitleSize=N.fTitleSize,le.fTitleOffset=N.fTitleOffset,le.fTextColor=N.fTitleColor,le.fTextFont=N.fTitleFont,le.fLineColor=N.fAxisColor,le.fLabelSize=N.fLabelSize,le.fLabelColor=N.fLabelColor,le.fLabelFont=N.fLabelFont,le.fLabelOffset=N.fLabelOffset,this.z_handle.setHistPainter(_,"z"),this.z_handle.source_axis=N),L&&C&&!U?void 0!==C.zmin&&void 0!==C.zmax&&C.zmin!==C.zmax?(R=C.zmin,k=C.zmax,I=C.zoom_zmin,A=C.zoom_zmax,I===A&&(I=R,A=k)):(I=F[0],A=F[F.length-1]):void 0!==_.gmaxbin&&void 0!==_.gminbin?(I=_.gminbin,A=_.gmaxbin):void 0!==_.hmin&&void 0!==_.hmax&&(I=_.hmin,A=_.hmax),this.draw_g.selectAll("rect").style("fill","white"),(void 0===R||void 0===k||R===k)&&(R=I,k=A),this._palette_vertical?(this._swap_side=fe.fX2NDC<.5,this.z_handle.configureAxis("zaxis",R,k,I,A,!0,[0,he],{log:j,fixed_ticks:D?F:null,maxTickSize:Math.round(ie*m),swap_side:this._swap_side}),J=this._swap_side?null:`translate(${ie})`,v?.fTickz&&(_e=this._swap_side?ie:-ie)):(this._swap_side=fe.fY1NDC>.5,this.z_handle.configureAxis("zaxis",R,k,I,A,!1,[0,ie],{log:j,fixed_ticks:D?F:null,maxTickSize:Math.round(he*m),swap_side:this._swap_side}),J=this._swap_side?null:`translate(0,${he})`,v?.fTickz&&(_e=this._swap_side?he:-he)),L&&te&&!V)for(let be=0;be<F.length-1;++be){let dt,Te=Math.round(this.z_handle.gr(F[be])),Pe=Math.round(this.z_handle.gr(F[be+1])),We=.5*(F[be]+F[be+1]);if(this._palette_vertical){if(Pe>=he||Te<0)continue;Te+=1,Te>he?(Te=he,We=.001*F[be]+.999*F[be+1],Pe<0&&(Pe=0)):Pe<0&&(Pe=0,We=.999*F[be]+.001*F[be+1]),dt=`M0,${Pe}H${ie}V${Te}H0Z`}else{if(Te>=ie||Pe<0)continue;Pe+=1,Pe>ie?(Pe=ie,We=.999*F[be]+.001*F[be+1],Te<0&&(Te=0)):Te<0&&(Te=0,We=.001*F[be]+.999*F[be+1]),dt=`M${Te},0V${he}H${Pe}V0Z`}const Q=L.getPaletteColor(te,We);if(!Q)continue;const Ke=this.draw_g.append("svg:path").attr("d",dt).style("fill",Q).property("fill0",Q).property("fill1",(0,z.Qh)(Q).darker(.5).formatHex());this.isTooltipAllowed()&&Ke.on("mouseover",function(){(0,z.Lt)(this).transition().duration(100).style("fill",(0,z.Lt)(this).property("fill1"))}).on("mouseout",function(){(0,z.Lt)(this).transition().duration(100).style("fill",(0,z.Lt)(this).property("fill0"))}).append("svg:title").text(F[be].toFixed(2)+" - "+F[be+1].toFixed(2)),b.settings.Zooming&&Ke.on("dblclick",()=>this.getFramePainter().unzoom("z"))}else this.draw_g.append("svg:path").attr("d",`M0,0H${ie}V${he}H0Z`).style("fill","white");return this.z_handle.drawAxis(this.draw_g,ie,he,J,_e).then(()=>{if(Y&&"getBoundingClientRect"in this.draw_g.node()){const be=this.draw_g.node().getBoundingClientRect();if(this._palette_vertical){const Te=this._pave_x+parseInt(be.width)-Math.round(.995*P)+3;Te>0&&(this._pave_x-=Te,(0,xe.bk)(this.draw_g,this._pave_x,this._pave_y),fe.fX1NDC-=Te/P,fe.fX2NDC-=Te/P)}else{const Te=Math.round((1.05-b.gStyle.fTitleY)*x)-be.y;Te>0&&(this._pave_y+=Te,(0,xe.bk)(this.draw_g,this._pave_x,this._pave_y),fe.fY1NDC-=Te/x,fe.fY2NDC-=Te/x)}}return this})}interactivePaletteAxis(ie,he){let ue=!1,fe=0,le=0,Y=null;const V=P=>{if(!ue)return;P.preventDefault();const x=(0,z.Wn)(P,this.draw_g.node());this._palette_vertical?(le=Math.min(Math.max(x[1],0),he),Y.attr("y",Math.min(fe,le)).attr("height",Math.abs(le-fe))):(le=Math.min(Math.max(x[0],0),ie),Y.attr("x",Math.min(fe,le)).attr("width",Math.abs(le-fe)))},D=P=>{if(!ue)return;P.preventDefault(),(0,z.Lt)(window).on("mousemove.colzoomRect",null).on("mouseup.colzoomRect",null),Y.remove(),Y=null,ue=!1;const x=this.z_handle.revertPoint(fe),v=this.z_handle.revertPoint(le);this.getFramePainter().zoom("z",Math.min(x,v),Math.max(x,v)),this.getFramePainter().zoomChangedInteractive("z",!0)};b.settings.Zooming&&this.draw_g.selectAll(".axis_zoom").on("mousedown",P=>{if(ue)return;ue=!0,P.preventDefault(),P.stopPropagation();const x=(0,z.Wn)(P,this.draw_g.node());Y=this.draw_g.append("svg:rect").attr("id","colzoomRect").call(xe.Ru,!0),this._palette_vertical?(fe=le=x[1],Y.attr("x","0").attr("width",ie).attr("y",fe).attr("height",1)):(fe=le=x[0],Y.attr("x",fe).attr("width",1).attr("y",0).attr("height",he)),(0,z.Lt)(window).on("mousemove.colzoomRect",V).on("mouseup.colzoomRect",D,!0)}).on("dblclick",()=>this.getFramePainter().unzoom("z")),b.settings.ZoomWheel&&this.draw_g.on("wheel",P=>{const x=(0,z.Wn)(P,this.draw_g.node()),_=this.z_handle.analyzeWheelEvent(P,this._palette_vertical?1-x[1]/he:x[0]/ie);_?.changed&&(this.getFramePainter().zoom("z",_.min,_.max),this.getFramePainter().zoomChangedInteractive("z",!0))})}fillContextMenuItems(ie){const he=this.getObject();if(this.isStats()){ie.add("Default position",()=>{he.fX2NDC=b.gStyle.fStatX,he.fX1NDC=he.fX2NDC-b.gStyle.fStatW,he.fY2NDC=b.gStyle.fStatY,he.fY1NDC=he.fY2NDC-b.gStyle.fStatH,he.fInit=1,this.interactiveRedraw(!0,"pave_moved")}),ie.add("Save to gStyle",()=>{b.gStyle.fStatX=he.fX2NDC,b.gStyle.fStatW=he.fX2NDC-he.fX1NDC,b.gStyle.fStatY=he.fY2NDC,b.gStyle.fStatH=he.fY2NDC-he.fY1NDC,this.fillatt?.saveToStyle("fStatColor","fStatStyle"),b.gStyle.fStatTextColor=he.fTextColor,b.gStyle.fStatFontSize=he.fTextSize,b.gStyle.fStatFont=he.fTextFont},"Store stats position and graphical attributes to gStyle"),ie.add("SetStatFormat",()=>{ie.input("Enter StatFormat",he.fStatFormat).then(fe=>{fe&&(he.fStatFormat=fe,this.interactiveRedraw(!0,`exec:SetStatFormat("${fe}")`))})}),ie.add("SetFitFormat",()=>{ie.input("Enter FitFormat",he.fFitFormat).then(fe=>{fe&&(he.fFitFormat=fe,this.interactiveRedraw(!0,`exec:SetFitFormat("${fe}")`))})}),ie.add("separator"),ie.add("sub:SetOptStat",()=>{ie.input("Enter OptStat",he.fOptStat,"int").then(fe=>{he.fOptStat=fe,this.interactiveRedraw(!0,`exec:SetOptStat(${fe})`)})});const ue=(fe,le)=>{let Y=fe<10?he.fOptStat:he.fOptFit;Y=parseInt(parseInt(Y)/parseInt(Math.pow(10,fe%10)))%10,ie.addchk(Y,le,100*Y+fe,V=>{const D=parseInt(V/100);let w=V%100<10?he.fOptStat:he.fOptFit;w-=(D>0?D:-1)*parseInt(Math.pow(10,V%10)),V%100<10?(he.fOptStat=w,this.interactiveRedraw(!0,`exec:SetOptStat(${w})`)):(he.fOptFit=w,this.interactiveRedraw(!0,`exec:SetOptFit(${w})`))})};ue(0,"Histogram name"),ue(1,"Entries"),ue(2,"Mean"),ue(3,"Std Dev"),ue(4,"Underflow"),ue(5,"Overflow"),ue(6,"Integral"),ue(7,"Skewness"),ue(8,"Kurtosis"),ie.add("endsub:"),ie.add("sub:SetOptFit",()=>{ie.input("Enter OptStat",he.fOptFit,"int").then(fe=>{he.fOptFit=fe,this.interactiveRedraw(!0,`exec:SetOptFit(${fe})`)})}),ue(10,"Fit parameters"),ue(11,"Par errors"),ue(12,"Chi square / NDF"),ue(13,"Probability"),ie.add("endsub:"),ie.add("separator")}else he._typename===b.clTLegend?ie.add("Autoplace",()=>{this.autoPlaceLegend(he,this.getPadPainter()?.getRootPad(!0),!0).then(ue=>{ue&&this.interactiveRedraw(!0,"pave_moved")})}):he.fName===b.kTitle&&(ie.add("Default position",()=>{he.fX1NDC=b.gStyle.fTitleW>0?b.gStyle.fTitleX-b.gStyle.fTitleW/2:b.gStyle.fPadLeftMargin,he.fY1NDC=b.gStyle.fTitleY-Math.min(1.1*b.gStyle.fTitleFontSize,.06),he.fX2NDC=b.gStyle.fTitleW>0?b.gStyle.fTitleX+b.gStyle.fTitleW/2:1-b.gStyle.fPadRightMargin,he.fY2NDC=b.gStyle.fTitleY,he.fInit=1,this.interactiveRedraw(!0,"pave_moved")}),ie.add("Save to gStyle",()=>{b.gStyle.fTitleX=(he.fX2NDC+he.fX1NDC)/2,b.gStyle.fTitleY=he.fY2NDC,this.fillatt?.saveToStyle("fTitleColor","fTitleStyle"),b.gStyle.fTitleTextColor=he.fTextColor,b.gStyle.fTitleFontSize=he.fTextSize,b.gStyle.fTitleFont=he.fTextFont},"Store title position and graphical attributes to gStyle"));ie.add("Bring to front",()=>this.bringToFront(!this.isStats()&&!this.z_handle))}paveContextMenu(ie){if(this.z_handle){const he=this.getFramePainter();(0,b.isFunc)(he?.showContextMenu)&&he.showContextMenu("pal",ie)}else(0,Je.sj)(ie,this,this.isTitle()?b.kTitle:void 0)}isStats(){return this.matchObjectType(b.clTPaveStats)}isTitle(){return this.matchObjectType(b.clTPaveText)&&this.getObject()?.fName===b.kTitle}clearPave(){this.getObject().Clear()}addText(ie){this.getObject().AddText(ie)}fillFunctionStat(ie,he,ue=1){if(this._has_fit=!1,!he||!ie)return!1;this._has_fit=!0,this._fit_dim=ue,this._fit_cnt=0;const fe=1===ue?he%10:1,le=1===ue?Math.floor(he/10)%10:1,Y=1===ue?Math.floor(he/100)%10:1,V=1===ue?Math.floor(he/1e3)%10:0;if(Y&&(this.addText("#chi^{2} / ndf = "+this.format(ie.fChisquare,"fit")+" / "+ie.fNDF),this._fit_cnt++),V&&(this.addText("Prob = "+this.format((0,ke.Prob)(ie.fChisquare,ie.fNDF))),this._fit_cnt++),fe)for(let D=0;D<ie.GetNumPars();++D){const w=ie.GetParName(D);let P=ie.GetParValue(D),x=ie.GetParError(D);P=void 0===P?"<not avail>":this.format(Number(P),"fit"),void 0!==x&&(x=this.format(x,"last"),0===Number(x)&&0!==ie.GetParError(D)&&(x=this.format(ie.GetParError(D),"4.2g"))),this.addText(le&&x?`${w} = ${P} #pm ${x}`:`${w} = ${P}`),this._fit_cnt++}return!0}isDummyPos(ie){return!ie||!(ie.fInit||ie.fX1||ie.fX2||ie.fY1||ie.fY2||ie.fX1NDC||ie.fX2NDC||ie.fY1NDC||ie.fY2NDC)}updateObject(ie,he){if(!this.matchObjectType(ie))return!1;const ue=this.getObject();switch(!ue.modified_NDC&&!this.isDummyPos(ie)&&(this.stored&&!ie.fInit&&this.stored.fX1===ie.fX1&&this.stored.fX2===ie.fX2&&this.stored.fY1===ie.fY1&&this.stored.fY2===ie.fY2?(this.stored.fX1NDC!==ie.fX1NDC&&(ue.fX1NDC=ie.fX1NDC),this.stored.fX2NDC!==ie.fX2NDC&&(ue.fX2NDC=ie.fX2NDC),this.stored.fY1NDC!==ie.fY1NDC&&(ue.fY1NDC=ie.fY1NDC),this.stored.fY2NDC!==ie.fY2NDC&&(ue.fY2NDC=ie.fY2NDC)):(ue.fInit=ie.fInit,ue.fX1=ie.fX1,ue.fX2=ie.fX2,ue.fY1=ie.fY1,ue.fY2=ie.fY2,ue.fX1NDC=ie.fX1NDC,ue.fX2NDC=ie.fX2NDC,ue.fY1NDC=ie.fY1NDC,ue.fY2NDC=ie.fY2NDC),this.stored=Object.assign({},ie)),ue.fOption=ie.fOption,ue.fBorderSize=ie.fBorderSize,void 0!==ue.fTextColor&&void 0!==ie.fTextColor&&(ue.fTextAngle=ie.fTextAngle,ue.fTextSize=ie.fTextSize,ue.fTextAlign=ie.fTextAlign,ue.fTextColor=ie.fTextColor,ue.fTextFont=ie.fTextFont),ie._typename){case b.clTDiamond:case b.clTPaveText:return ue.fLines=(0,b.clone)(ie.fLines),!0;case b.clTPavesText:return ue.fLines=(0,b.clone)(ie.fLines),ue.fNpaves=ie.fNpaves,!0;case b.clTPaveLabel:case b.clTPaveClass:return ue.fLabel=ie.fLabel,!0;case b.clTPaveStats:return ue.fOptStat=ie.fOptStat,ue.fOptFit=ie.fOptFit,!0;case b.clTLegend:{const fe=ue.fPrimitives;if(ue.fPrimitives=ie.fPrimitives,ue.fNColumns=ie.fNColumns,this.AutoPlace="autoplace"===he,fe?.arr?.length&&fe?.arr?.length===ue.fPrimitives?.arr?.length)for(let le=0;le<fe.arr.length;++le){const Y=fe.arr[le].fObject,V=ue.fPrimitives.arr[le].fObject;Y&&V&&Y._typename===V._typename&&Y.fName===V.fName&&(ue.fPrimitives.arr[le].fObject=Y)}return!0}case b.clTPaletteAxis:return ue.fBorderSize=1,ue.fShadowColor=0,!0}return!1}redraw(){var ie=this;return(0,ve.A)(function*(){return ie.drawPave()})()}cleanup(){this.z_handle&&(this.z_handle.cleanup(),delete this.z_handle),super.cleanup()}static canDraw(ie){const he=ie?._typename;return he===b.clTPave||he===b.clTPaveLabel||he===b.clTPaveClass||he===b.clTPaveStats||he===b.clTPaveText||he===b.clTPavesText||he===b.clTDiamond||he===b.clTLegend||he===b.clTPaletteAxis}static draw(ie,he,ue){return(0,ve.A)(function*(){const fe=new O(ie,he);return(0,Re.ensureTCanvas)(fe,!1).then(()=>{if(he.fName===b.kTitle&&he._typename===b.clTPaveText){const le=fe.getPadPainter().findPainterFor(null,b.kTitle,b.clTPaveText);if(le&&le!==fe)le.removeFromPadPrimitives(),le.cleanup();else if("postitle"===ue||fe.isDummyPos(he)){const Y=b.gStyle,V=fe.getFramePainter();if(Y&&V){const D=Y.fTitleX,w=Y.fTitleY;let P=Y.fTitleW,x=Y.fTitleH;x||(x=.7*(w-V.fY2NDC)),P||(P=V.fX2NDC-V.fX1NDC),(!Number.isFinite(x)||x<=0)&&(x=.06),(!Number.isFinite(P)||P<=0)&&(P=.44),he.fX1NDC=D-P/2,he.fY1NDC=w-x,he.fX2NDC=D+P/2,he.fY2NDC=w,he.fInit=1}}}else he._typename===b.clTPaletteAxis&&(he.fBorderSize=1,he.fShadowColor=0,he.fAxis&&(he.fAxis.fChopt||(he.fAxis.fChopt="+"),he.fAxis.fNdiv||(he.fAxis.fNdiv=12),he.fAxis.fLabelOffset||(he.fAxis.fLabelOffset=.005)),fe.z_handle=new Xe.TB(ie,he.fAxis,!0),fe.z_handle.setPadName(fe.getPadName()),fe.UseContextMenu=!0);switch(fe.NoFillStats="nofillstats"===ue||"stats"!==he.fName,he._typename){case b.clTPaveLabel:case b.clTPaveClass:fe.paveDrawFunc=fe.drawPaveLabel;break;case b.clTPaveStats:fe.paveDrawFunc=fe.drawPaveStats;break;case b.clTPaveText:case b.clTPavesText:case b.clTDiamond:fe.paveDrawFunc=fe.drawPaveText;break;case b.clTLegend:fe.AutoPlace="autoplace"===ue,fe.paveDrawFunc=fe.drawLegend;break;case b.clTPaletteAxis:fe.paveDrawFunc=fe.drawPaletteAxis}return fe.drawPave(ue)})})()}}},9407:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{CS:()=>_,QK:()=>He,SF:()=>L,cD:()=>Ie,s6:()=>C,u$:()=>F,wx:()=>v});var ve=Ee(6998),b=Ee(5680),z=Ee(357),ke=Ee(5193),xe=Ee(1069),et=Ee(1969),Je=Ee(3277),Xe=Ee(4571);function ot(U,j,te){if((0,et.KA)(j))return new ke._l((0,et.xV)(j),{font:xe.Te,size:te,height:0,curveSegments:5});const N=100*te,m=[];let I=5;class A{constructor(dt,Q){this.kind=dt??"g",this.childs=[],this.x=0,this.y=0,this.font_size=Q?.font_size??N,Q?.childs.push(this)}append(dt){return"svg:g"===dt?new A("g",this):"svg:text"===dt?new A("text",this):"svg:path"===dt?new A("path",this):void console.log("should create",dt)}style(dt,Q){return"stroke-width"===dt&&Q&&(I=Number.parseInt(Q)),this}translate(){this.geom&&this.geom.translate(this.x,this.y,0),this.childs.forEach(dt=>{dt.x+=this.x,dt.y+=this.y,dt.translate()})}attr(dt,Q){const Ke=()=>{if(!Q)return"";const Ue=Q[0];return Q=Q.slice(1),Ue},Ze=Ue=>{let Oe=0;for(;Q[Oe]>="0"&&Q[Oe]<="9"||"-"===Q[Oe];)Oe++;const lt=Number.parseInt(Q.slice(0,Oe));return Q=Q.slice(Oe),Ue&&Ke(),lt};if("font-size"===dt&&Q)this.font_size=Number.parseInt(Q);else if("transform"===dt&&(0,ve.isStr)(Q)&&0===Q.indexOf("translate")){const Ue=Q.slice(Q.indexOf("(")+1,Q.lastIndexOf(")")).split(",");this.x+=Ue[0]?.01*Number.parseInt(Ue[0]):0,this.y-=Ue[1]?.01*Number.parseInt(Ue[1]):0}else if("x"===dt&&"text"===this.kind)this.x+=.01*Number.parseInt(Q);else if("y"===dt&&"text"===this.kind)this.y-=.01*Number.parseInt(Q);else if("d"===dt&&"path"===this.kind){if("M"!==Ke())return console.error("Not starts with M");const Ue=[];let gt,Oe=Ze(!0),lt=Ze();for(;gt=Ke();){let st=Oe,yt=lt;switch(gt){case"L":st=Ze(!0),yt=Ze();break;case"l":st+=Ze(!0),yt+=Ze();break;case"H":st=Ze();break;case"h":st+=Ze();break;case"V":yt=Ze();break;case"v":yt+=Ze();break;default:console.log("not supported operator",gt)}const Kt=Math.atan2(yt-lt,st-Oe),Ot=.5*I*Math.sin(Kt),It=-.5*I*Math.cos(Kt);Ue.push(Oe-Ot,lt-It,0,st-Ot,yt-It,0,st+Ot,yt+It,0,Oe-Ot,lt-It,0,st+Ot,yt+It,0,Oe+Ot,lt+It,0),Oe=st,lt=yt}const ht=new Float32Array(Ue);this.geom=new z.LoY,this.geom.setAttribute("position",new z.THS(ht,3)),this.geom.scale(.01,-.01,.01),this.geom.computeVertexNormals(),m.push(this.geom)}return this}text(dt){"text"===this.kind&&(this.geom=new ke._l(dt,{font:xe.Te,size:Math.round(.01*this.font_size),height:0,curveSegments:5}),m.push(this.geom))}}const R=new A;if((0,et.Bm)(U,R,{font_size:N,latex:1,x:0,y:0,text:j,align:["start","top"],fast:!0,font:{size:N,isMonospace:()=>!1,aver_width:.9}}),!m.length)return new ke._l((0,et.xV)(j),{font:xe.Te,size:te,height:0,curveSegments:5});if(R.translate(),1===m.length)return m[0];let J=0;m.forEach(We=>{J+=We.getAttribute("position").array.length});const _e=new Float32Array(J),be=new Float32Array(J);let Te=0;m.forEach(We=>{const dt=We.getAttribute("position").array,Q=We.getAttribute("normal").array;for(let Ke=0;Ke<dt.length;++Ke,++Te)_e[Te]=dt[Ke],be[Te]=Q[Ke]});const Pe=new z.LoY;return Pe.setAttribute("position",new z.THS(_e,3)),Pe.setAttribute("normal",new z.THS(be,3)),Pe}function Re(U,j,te=!1,N=!1){let m;if(j?.children)for(let J=0;J<j.children.length&&(m=j.children[J],!m.axis_draw);++J)m=void 0;if(!m)return;if(!U)return void j.remove(m);const I=U.position;let A=1;I.x<0&&I.y>=0&&(A=2),I.x>=0&&I.y>=0&&(A=3),I.x>=0&&I.y<0&&(A=4);const R=(J,_e)=>(J<=A&&(J+=4),J>A&&J<A+_e),k=J=>{for(let _e=0;_e<J.children?.length;++_e)void 0!==J.children[_e].zoom&&(J.children[_e].zoom_disabled=!J.visible)};for(let J=0;J<m.children.length;++J){const _e=m.children[J];if(_e.grid)_e.visible=N&&R(_e.grid,3);else if(_e.zid)_e.visible=R(_e.zid,2),k(_e);else if(_e.xyid)_e.visible=R(_e.xyid,3),k(_e);else if(_e.xyboxid){let be=5,Te=0;N&&!te?(be=3,Te=-2):te&&!N?be=3:!te&&!N&&(be=_e.bottom?3:0),_e.visible=R(_e.xyboxid+Te,be),!_e.visible&&_e.bottom&&N&&(_e.visible=R(_e.xyboxid,3))}else if(_e.zboxid){let be=2,Te=0;te&&N?be=5:N&&!te?be=4:!N&&te&&(Te=-2,be=4),_e.visible=R(_e.zboxid+Te,be)}}}function He(U,j,te,N){if(U.options.System===Je.m)return j;const m=U.getFramePainter();let I=1/m.size_x3d,A=1/m.size_y3d;if(te&&N&&(I*=te/(te-1),A*=N/(N-1)),U.options.System===Je.Ee)for(let R=0;R<j.length;R+=3){const k=(1-j[R]*I)*Math.PI,J=.5+.5*j[R+1]*A;j[R]=Math.cos(k)*J*m.size_x3d,j[R+1]=Math.sin(k)*J*m.size_y3d}else if(U.options.System===Je.ef)for(let R=0;R<j.length;R+=3){const k=(1-j[R]*I)*Math.PI,J=.5+j[R+2]/m.size_z3d/4;j[R]=Math.cos(k)*J*m.size_x3d,j[R+2]=(1+Math.sin(k)*J)*m.size_z3d}else if(U.options.System===Je.ZE)for(let R=0;R<j.length;R+=3){const k=(1+j[R]*I)*Math.PI,J=j[R+1]*A*Math.PI,_e=.5+j[R+2]/m.size_z3d/4;j[R]=_e*Math.cos(J)*Math.cos(k)*m.size_x3d,j[R+1]=_e*Math.cos(J)*Math.sin(k)*m.size_y3d,j[R+2]=(1+_e*Math.sin(J))*m.size_z3d}else if(U.options.System===Je.kH)for(let R=0;R<j.length;R+=3){const k=(1-j[R]*I)*Math.PI,J=j[R+1]*A*Math.PI,_e=.5+j[R+2]/m.size_z3d/4;j[R]=_e*Math.cos(k)*m.size_x3d,j[R+1]=_e*Math.sin(J)/Math.cos(J)*m.size_y3d/2,j[R+2]=(1+_e*Math.sin(k))*m.size_z3d}return j}function Ie(U,j,te,N,m){const I=new z.LoY;return U.options.System===Je.m?(I.setAttribute("position",new z.THS(j,3)),te?I.setAttribute("normal",new z.THS(te,3)):I.computeVertexNormals()):(He(U,j,N,m),I.setAttribute("position",new z.THS(j,3)),I.computeVertexNormals()),I}function O(U,j){U.camera&&(U.scene.remove(U.camera),(0,xe.G1)(U.camera),delete U.camera),U.camera=j?new z.qUd(-1.3*U.size_x3d,1.3*U.size_x3d,2.3*U.size_z3d,-.7*U.size_z3d,.001,40*U.size_z3d):new z.ubm(45,U.scene_width/U.scene_height,1,40*U.size_z3d),U.camera.up.set(0,0,1),U.pointLight=new z.ZyN(16777215,3),U.pointLight.position.set(U.size_x3d/2,U.size_y3d/2,U.size_z3d/2),U.camera.add(U.pointLight),U.lookat=new z.Pq0(0,0,j?.3*U.size_z3d:.8*U.size_z3d),U.scene.add(U.camera)}function ce(U,j){const te=U.getPadPainter().getRootPad(!0),N=U.camera.isOrthographicCamera?1:1.4;let m=Math.max(.75*U.size_x3d,U.size_z3d),I=Math.max(.75*U.size_y3d,U.size_z3d);if(j&&(m===I?U.camera.position.set(-1.6*m,-3.5*I,N*U.size_z3d):m>I?U.camera.position.set(-2*m,-3.5*I,N*U.size_z3d):U.camera.position.set(-3.5*m,-2*I,N*U.size_z3d)),te&&(j||!U.zoomChangedInteractive())&&Number.isFinite(te.fTheta)&&Number.isFinite(te.fPhi)&&(te.fTheta!==U.camera_Theta||te.fPhi!==U.camera_Phi)){U.camera_Phi=te.fPhi,U.camera_Theta=te.fTheta,m=3*Math.max(U.size_x3d,U.size_z3d),I=3*Math.max(U.size_y3d,U.size_z3d);const A=(270-te.fPhi)/180*Math.PI,R=(te.fTheta-10)/180*Math.PI;U.camera.position.set(m*Math.cos(A)*Math.cos(R),I*Math.sin(A)*Math.cos(R),U.size_z3d+(N-.9)*(m+I)*Math.sin(R)),j=!0}if(j&&U.camera.lookAt(U.lookat),j&&U.camera.isOrthographicCamera&&U.scene_width&&U.scene_height){const A=U.scene_width/U.scene_height,R=U.camera.right-U.camera.left,k=U.camera.top-U.camera.bottom;if(A>R/k){const J=(U.camera.right+U.camera.left)/2;U.camera.left=J-k*A/2,U.camera.right=J+k*A/2}else{const J=(U.camera.top+U.camera.bottom)/2;U.camera.top=J+R/A/2,U.camera.bottom=J-R/A/2}}U.camera.updateProjectionMatrix()}function ie(U){U.control=(0,xe.Sc)(U,U.camera,U.scene,U.renderer,U.lookat);const j=U,te=U.getMainPainter();U.control.processMouseMove=function(N){let m=null,I=null,A=null;const R=j.isTooltipAllowed();for(let k=0;k<N.length;++k)if(R&&(0,ve.isFunc)(N[k].object?.tooltip)){if(m=N[k].object.tooltip(N[k]),m){I=N[k].object;break}}else N[k].object?.zoom&&!A&&(A=N[k].object);if(m&&!m.use_itself){const k=1e-4*j.size_x3d,J=1e-4*j.size_y3d,_e=1e-4*j.size_z3d;(m.x1>m.x2||m.y1>m.y2||m.z1>m.z2)&&console.warn("check 3D hints coordinates"),m.x1-=k,m.x2+=k,m.y1-=J,m.y2+=J,m.z1-=_e,m.z2+=_e}if(j.highlightBin3D(m,I),!m&&A&&(0,ve.isFunc)(j.get3dZoomCoord)){let k=A.zoom;const J=A.globalIntersect(this.raycaster),_e=j.get3dZoomCoord(J,k);return"z"===k&&A.use_y_for_z&&(k="y"),{name:k,title:"axis object",line:k+" : "+j.axisAsText(k,_e),only_status:!0}}return m?.lines?m:""},U.control.processMouseLeave=function(){j.highlightBin3D(null)},U.control.contextMenu=function(N,m){let I="painter",A=te;if(m)for(let k=0;k<m.length;++k){const J=m[k].object;if(J.zoom){I=J.zoom,A=null;break}if((0,ve.isFunc)(J.painter?.fillContextMenu)){A=J.painter;break}}const R=te.getFramePainter();(0,ve.isFunc)(R?.showContextMenu)&&R.showContextMenu(I,N,A)}}function he(U,j,te,N){if(-1===U){if(!this.mode3d)return;return(0,ve.isFunc)(this.clear3dCanvas)?(Re(null,this.toplevel),this.clear3dCanvas(),(0,xe.G1)(this.scene),this.control?.cleanup(),(0,xe.yW)(this.renderer),delete this.size_x3d,delete this.size_y3d,delete this.size_z3d,delete this.tooltip_mesh,delete this.scene,delete this.toplevel,delete this.camera,delete this.pointLight,delete this.renderer,delete this.control,this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),void(this.mode3d=!1)):void console.error(`Strange, why mode3d=${this.mode3d} is configured!!!!`)}if(this.mode3d=!0,"toplevel"in this){this.scene.remove(this.toplevel),(0,xe.G1)(this.toplevel),delete this.tooltip_mesh,delete this.toplevel,this.control&&this.control.HideTooltip();const I=new z.B69;return this.scene.add(I),this.toplevel=I,this.resize3D(),ce(this,!1),Promise.resolve(!0)}U=(0,xe.ke)(U,this.isBatchMode()),(0,xe.LR)(this);const m=this.getSizeFor3d(void 0,U);return this.size_z3d=100,this.size_x3d=this.size_y3d=m.height>10&&m.width>10?Math.round(m.width/m.height*this.size_z3d):this.size_z3d,j&&(this.size_x3d*=j),te&&(this.size_y3d*=te),this.scene=new z.Z58,this.toplevel=new z.B69,this.scene.add(this.toplevel),this.scene_width=m.width,this.scene_height=m.height,this.scene_x=m.x??0,this.scene_y=m.y??0,this.camera_Phi=30,this.camera_Theta=30,O(this,N),ce(this,!0),(0,xe.Yw)(this.scene_width,this.scene_height,U).then(I=>(this.renderer=I,this.webgl=U===ve.constants.Render3D.WebGL,this.add3dCanvas(m,this.renderer.jsroot_dom,this.webgl),this.first_render_tm=0,this.enable_highlight=!1,!this.isBatchMode()&&this.webgl&&!(0,ve.isNodeJs)()&&ie(this),this))}function ue(U){let j=!1;this.control&&(this.control.cleanup(),delete this.control,j=!0),O(this,U),ce(this,!0),j&&ie(this),this.render3D()}function fe(U,j,te){if(U){if(!this.toplevel)return console.error("3D objects are not yet created in the frame");j&&te&&this.remove3DMeshes(j),this.toplevel.add(U),U._painter=j}}function le(U){if(!U||!this.toplevel)return;let j=this.toplevel.children.length;for(;j>0;){const te=this.toplevel.children[--j];te._painter===U&&(this.toplevel.remove(te),(0,xe.G1)(te))}}function Y(U){if(-1111===U){const m=(0,ve.getDocument)(),I=(0,xe.mZ)(!1,0,m);if(I.setSize(this.scene_width,this.scene_height),I.render(this.scene,this.camera),I.makeOuterHTML){const A=m.createElement("div");return A.innerHTML=I.makeOuterHTML(),A.childNodes[0]}return I.domElement}void 0===U&&(U=5);const j=this.isBatchMode();if(U>0&&!this.usesvg&&!j)return void(this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),U)));if(this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),!this.renderer)return;(0,xe.rv)(this.renderer);const te=new Date;Re(this.camera,this.toplevel,this.opt3d?.FrontBox,this.opt3d?.BackBox),this.renderer.render(this.scene,this.camera),(0,xe.oE)(this.renderer),0===this.first_render_tm&&(this.first_render_tm=(new Date).getTime()-te.getTime(),this.enable_highlight=this.first_render_tm<1200&&this.isTooltipAllowed(),this.first_render_tm>500&&console.log(`three.js r${z.sPf}, first render tm = ${this.first_render_tm}`)),this.processRender3D&&this.getPadPainter()?.painters?.forEach(m=>{(0,ve.isFunc)(m.handleRender3D)&&m.handleRender3D()})}function V(){const U=this.getSizeFor3d(this.access3dKind());return this.apply3dSize(U),!(this.scene_width===U.width&&this.scene_height===U.height||U.width<10||U.height<10||(this.scene_width=U.width,this.scene_height=U.height,this.camera.aspect=this.scene_width/this.scene_height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.scene_width,this.scene_height),0))}function D(U,j){const te=!U||void 0===U.x1||!this.enable_highlight;let N=!1,m=null,I=!0,A=this.getMainPainter();if(A&&(!A.provideUserTooltip||!A.hasUserTooltip())&&(A=null),this.tooltip_selfmesh&&(I=this.tooltip_selfmesh!==j,this.tooltip_selfmesh.material.color=this.tooltip_selfmesh.save_color,delete this.tooltip_selfmesh,N=!0),this.tooltip_mesh&&(m=this.tooltip_mesh,this.toplevel.remove(this.tooltip_mesh),delete this.tooltip_mesh,N=!0),te)return N&&this.render3D(),void(N&&A&&A.provideUserTooltip(null));if(U.use_itself)j.save_color=j.material.color,j.material.color=new z.Q1f(U.color),this.tooltip_selfmesh=j,N=I;else{N=!0;const R=xe.DJ.Indexes,k=xe.DJ.Normals,J=xe.DJ.Vertices,_e=new z.Q1f(U.color?U.color:16711680),be=U.opacity||1;let Te,Pe;if(m)Te=m.geometry.attributes.position.array,m.geometry.attributes.position.needsUpdate=!0,m.material.color=_e,m.material.opacity=be;else{Te=new Float32Array(3*R.length),Pe=new Float32Array(3*R.length);const We=new z.LoY;We.setAttribute("position",new z.THS(Te,3)),We.setAttribute("normal",new z.THS(Pe,3));const dt=new z.V9B({color:_e,opacity:be,vertexColors:!1});m=new z.eaF(We,dt)}U.x1===U.x2&&console.warn(`same tip X ${U.x1} ${U.x2}`),U.y1===U.y2&&console.warn(`same tip Y ${U.y1} ${U.y2}`),U.z1===U.z2&&(U.z2=U.z1+1e-4);for(let We=0,dt=-3;We<R.length;++We){const Q=J[R[We]];Te[3*We]=U.x1+Q.x*(U.x2-U.x1),Te[3*We+1]=U.y1+Q.y*(U.y2-U.y1),Te[3*We+2]=U.z1+Q.z*(U.z2-U.z1),Pe&&(We%6==0&&(dt+=3),Pe[3*We]=k[dt],Pe[3*We+1]=k[dt+1],Pe[3*We+2]=k[dt+2])}this.tooltip_mesh=m,this.toplevel.add(m),U.$painter&&U.$painter.options.System!==Je.m&&(He(U.$painter,Te),m.geometry.computeVertexNormals())}N&&this.render3D(),N&&U.$projection&&(0,ve.isFunc)(U.$painter?.redrawProjection)&&U.$painter.redrawProjection(U.ix-1,U.ix,U.iy-1,U.iy),N&&A?.getObject()&&A.provideUserTooltip({obj:A.getObject(),name:A.getObject().fName,bin:U.bin,cont:U.value,binx:U.ix,biny:U.iy,binz:U.iz,grx:(U.x1+U.x2)/2,gry:(U.y1+U.y2)/2,grz:(U.z1+U.z2)/2})}function w(U){this.opt3d=U}function P(U,j,te){te||(te={}),!1===te.drawany?te.draw=!1:te.drawany=!0;const N=te.v7?null:this.getPadPainter().getRootPad(!0);let m=-this.size_x3d,I=this.size_x3d,A=-this.size_y3d,R=this.size_y3d,k=0,J=2*this.size_z3d,_e=this.size_z3d,be=this.xmin,Te=this.xmax,Pe=this.ymin,We=this.ymax,dt=this.zmin,Q=this.zmax,Ke=!1,Ze=!1;this.size_z3d||(m=this.xmin,I=this.xmax,A=this.ymin,R=this.ymax,k=this.zmin,J=this.zmax,_e=J-k),"zoom_xmin"in this&&"zoom_xmax"in this&&this.zoom_xmin!==this.zoom_xmax&&(be=this.zoom_xmin,Te=this.zoom_xmax),"zoom_ymin"in this&&"zoom_ymax"in this&&this.zoom_ymin!==this.zoom_ymax&&(Pe=this.zoom_ymin,We=this.zoom_ymax,Ke=!0),"zoom_zmin"in this&&"zoom_zmax"in this&&this.zoom_zmin!==this.zoom_zmax&&(dt=this.zoom_zmin,Q=this.zoom_zmax,Ze=!0),te.use_y_for_z&&(this.zmin=this.ymin,this.zmax=this.ymax,dt=Pe,Q=We,Ze=Ke,Pe=0,We=1),this.lego_zmin=dt,this.lego_zmax=Q,void 0!==te.zmult&&!Ze&&(Q*=te.zmult),this.x_handle=new j(null,this.xaxis),te.v7&&(this.x_handle.setPadName(this.getPadName()),this.x_handle.snapid=this.snapid),this.x_handle.configureAxis("xaxis",this.xmin,this.xmax,be,Te,!1,[m,I],{log:N?.fLogx??0,reverse:te.reverse_x}),this.x_handle.assignFrameMembers(this,"x"),this.x_handle.extractDrawAttributes(_e),this.y_handle=new j(null,this.yaxis),te.v7&&(this.y_handle.setPadName(this.getPadName()),this.y_handle.snapid=this.snapid),this.y_handle.configureAxis("yaxis",this.ymin,this.ymax,Pe,We,!1,[A,R],{log:N&&!te.use_y_for_z?N.fLogy:0,reverse:te.reverse_y}),this.y_handle.assignFrameMembers(this,"y"),this.y_handle.extractDrawAttributes(_e),this.z_handle=new j(null,this.zaxis),te.v7&&(this.z_handle.setPadName(this.getPadName()),this.z_handle.snapid=this.snapid),this.z_handle.configureAxis("zaxis",this.zmin,this.zmax,dt,Q,!1,[k,J],{log:(te.use_y_for_z||2===te.ndim?N?.fLogv:void 0)??N?.fLogz??0,reverse:te.reverse_z}),this.z_handle.assignFrameMembers(this,"z"),this.z_handle.extractDrawAttributes(_e),this.setRootPadRange(N,!0);const Ue={},Oe={},lt=this.x_handle.createTicks(!1,!0),gt=this.y_handle.createTicks(!1,!0),ht=this.z_handle.createTicks(!1,!0);let st=1;function yt(wt,W){const pe=("ticks"===W?wt.ticksColor:wt.lineatt.color)||"black",me="ticks"===W?wt.ticksWidth:wt.lineatt.width,Fe=`${pe}_${me}`;return Oe[Fe]||(Oe[Fe]=new z.mrM((0,xe.Bx)(pe,{linewidth:me,vertexColors:!1}))),Oe[Fe]}function Kt(wt,W,pe){const me=pe||("title"===W?wt.titleFont?.color:wt.labelsFont?.color)||"black";return Ue[me]||(Ue[me]=new z.V9B((0,xe.Bx)(me,{vertexColors:!1}))),Ue[me]}const Ot=new z.B69;Ot.axis_draw=!0,U.add(Ot);let It=[],An=[],on=0;for(;lt.next();){const wt=lt.grpos;let W=1===lt.kind,pe=this.x_handle.format(lt.tick,2);if(lt.last_major()?this.x_handle.fTitle||(pe="x"):null===pe&&(W=!1,pe=""),W&&pe&&te.draw){const me=lt.get_modifier();me?.fLabText&&(pe=me.fLabText);const Fe=ot(this,pe,this.x_handle.labelsFont.size);Fe.computeBoundingBox();const At=Fe.boundingBox.max.x-Fe.boundingBox.min.x,Et=Fe.boundingBox.max.y-Fe.boundingBox.min.y;Fe.center=!0,Fe.offsety=this.x_handle.labelsOffset+.005*(R-A),on=Math.max(on,Et),me?.fTextColor&&(Fe.color=this.getColor(me.fTextColor)),Fe.grx=wt,An.push(Fe);let St=0;lt.last_major()||(St=Math.abs(lt.next_major_grpos()-wt),At>0&&St>0&&(st=Math.min(st,.9*St/At))),this.x_handle.isCenteredLabels()&&(St||(St=Math.min(wt-m,I-wt)),Fe.grx+=St/2)}It.push(wt,0,0,wt,this.x_handle.ticksSize*(W?-1:-.6),0)}if(this.x_handle.fTitle&&te.draw){const wt=ot(this,this.x_handle.fTitle,this.x_handle.titleFont.size);wt.computeBoundingBox(),wt.center=this.x_handle.titleCenter,wt.opposite=this.x_handle.titleOpposite,wt.offsety=1.6*this.x_handle.titleOffset+.005*(R-A),wt.grx=(m+I)/2,wt.kind="title",An.push(wt)}this.get3dZoomCoord=function(wt,W){const pe=this[`scale_${W}min`],me=this[`scale_${W}max`];let Fe=wt[W];switch(W){case"x":Fe=(Fe+this.size_x3d)/2/this.size_x3d;break;case"y":Fe=(Fe+this.size_y3d)/2/this.size_y3d;break;case"z":Fe=Fe/2/this.size_z3d}return Fe=this["log"+W]?Math.exp(Math.log(pe)+Fe*(Math.log(me)-Math.log(pe))):pe+Fe*(me-pe),Fe};const pn=(wt,W,pe)=>{const me=new z.LoY,Fe=Math.max(this[wt+"_handle"].ticksSize,.005*W);let At;At="z"===wt?new Float32Array([0,0,0,4*Fe,0,2*W,4*Fe,0,0,0,0,0,0,0,2*W,4*Fe,0,2*W]):new Float32Array([-W,0,0,W,4*-Fe,0,W,0,0,-W,0,0,-W,4*-Fe,0,W,4*-Fe,0]),me.setAttribute("position",new z.THS(At,3)),me.computeVertexNormals();const Et=new z.V9B({transparent:!0,vertexColors:!1,side:z.$EB,opacity:0}),St=new z.eaF(me,Et);return St.zoom=wt,St.size_3d=W,St.tsz=Fe,St.use_y_for_z=pe,"y"===wt&&St.rotateZ(Math.PI/2).rotateX(Math.PI),St.v1=new z.Pq0(At[0],At[1],At[2]),St.v2=new z.Pq0(At[6],At[7],At[8]),St.v3=new z.Pq0(At[3],At[4],At[5]),St.globalIntersect=function(xt){if(!this.v1||!this.v2||!this.v3)return;const En=new z.Zcv;En.setFromCoplanarPoints(this.v1,this.v2,this.v3),En.applyMatrix4(this.matrixWorld);const jt=xt.ray.origin.clone(),Cn=jt.clone().addScaledVector(xt.ray.direction,1e10),ln=En.intersectLine(new z.cZY(jt,Cn),new z.Pq0);if(!ln)return;let Un=-this.size_3d,Ci=this.size_3d;return"z"===this.zoom&&(Un=0,Ci=2*this.size_3d),ln[this.zoom]<Un?ln[this.zoom]=Un:ln[this.zoom]>Ci&&(ln[this.zoom]=Ci),ln},St.showSelection=function(xt,En){const jt=this.zoom;let ln,Cn=this.children?this.children[0]:null;if(!xt||!En)return Cn&&(this.remove(Cn),(0,xe.G1)(Cn)),Cn;if(!this.geometry)return!1;if(Cn)ln=Cn.geometry;else{ln=this.geometry.clone();const Ci=ln.getAttribute("position").array;"z"===jt?Ci[6]=Ci[3]=Ci[15]=this.tsz:Ci[4]=Ci[16]=Ci[13]=-this.tsz,Cn=new z.eaF(ln,new z.V9B({color:65280,side:z.$EB,vertexColors:!1})),this.add(Cn)}const Un=ln.getAttribute("position").array;return"z"===jt?(Un[2]=Un[11]=Un[8]=xt[jt],Un[5]=Un[17]=Un[14]=En[jt]):(Un[0]=Un[9]=Un[12]=xt[jt],Un[6]=Un[3]=Un[15]=En[jt]),ln.getAttribute("position").needsUpdate=!0,!0},St};let Bn,Qt=new z.B69;for(Qt.position.set(0,A,k),Qt.rotation.x=1/4*Math.PI,Qt.xyid=2,te.draw&&(Bn=(0,xe.Fc)(It,yt(this.x_handle,"ticks")),Qt.add(Bn)),An.forEach(wt=>{const W=wt.boundingBox.max.x-wt.boundingBox.min.x,pe=wt.center?wt.grx-W/2:wt.opposite?m:I-W,me=new z.kn4;me.set(st,0,0,pe,0,st,0,-on*st-this.x_handle.ticksSize-wt.offsety,0,0,1,0,0,0,0,1);const Fe=new z.eaF(wt,Kt(this.x_handle,wt.kind,wt.color));Fe.applyMatrix4(me),Qt.add(Fe)}),te.zoom&&te.drawany&&Qt.add(pn("x",this.size_x3d)),Ot.add(Qt),Qt=new z.B69,Qt.position.set(0,R,k),Qt.rotation.x=3/4*Math.PI,te.draw&&Qt.add(new z.DXC(Bn.geometry,Bn.material)),An.forEach(wt=>{const W=wt.boundingBox.max.x-wt.boundingBox.min.x,pe=wt.center?wt.grx+W/2:wt.opposite?m+W:I,me=new z.kn4;me.set(-st,0,0,pe,0,st,0,-on*st-this.x_handle.ticksSize-wt.offsety,0,0,-1,0,0,0,0,1);const Fe=new z.eaF(wt,Kt(this.x_handle,wt.kind,wt.color));Fe.applyMatrix4(me),Qt.add(Fe)}),Qt.xyid=4,te.zoom&&te.drawany&&Qt.add(pn("x",this.size_x3d)),Ot.add(Qt),An=[],st=1,on=0,It=[];gt.next();){const wt=gt.grpos;let W=1===gt.kind,pe=this.y_handle.format(gt.tick,2);if(gt.last_major()?this.y_handle.fTitle||(pe="y"):null===pe&&(W=!1,pe=""),W&&pe&&te.draw){const me=gt.get_modifier();me?.fLabText&&(pe=me.fLabText);const Fe=ot(this,pe,this.y_handle.labelsFont.size);Fe.computeBoundingBox();const At=Fe.boundingBox.max.x-Fe.boundingBox.min.x,Et=Fe.boundingBox.max.y-Fe.boundingBox.min.y;Fe.center=!0,on=Math.max(on,Et),me?.fTextColor&&(Fe.color=this.getColor(me.fTextColor)),Fe.gry=wt,Fe.offsetx=this.y_handle.labelsOffset+.005*(I-m),An.push(Fe);let St=0;gt.last_major()||(St=Math.abs(gt.next_major_grpos()-wt),At>0&&(st=Math.min(st,.9*St/At))),this.y_handle.isCenteredLabels()&&(St||(St=Math.min(wt-A,R-wt)),Fe.gry+=St/2)}It.push(0,wt,0,this.y_handle.ticksSize*(W?-1:-.6),wt,0)}if(this.y_handle.fTitle&&te.draw){const wt=ot(this,this.y_handle.fTitle,this.y_handle.titleFont.size);wt.computeBoundingBox(),wt.center=this.y_handle.titleCenter,wt.opposite=this.y_handle.titleOpposite,wt.offsetx=1.6*this.y_handle.titleOffset+.005*(I-m),wt.gry=(A+R)/2,wt.kind="title",An.push(wt)}if(!te.use_y_for_z){let wt,W=new z.B69;W.position.set(m,0,k),W.rotation.y=-1/4*Math.PI,te.draw&&(wt=(0,xe.Fc)(It,yt(this.y_handle,"ticks")),W.add(wt)),An.forEach(pe=>{const me=pe.boundingBox.max.x-pe.boundingBox.min.x,Fe=pe.center?pe.gry+me/2:pe.opposite?A+me:R,At=new z.kn4;At.set(0,st,0,-on*st-this.y_handle.ticksSize-pe.offsetx,-st,0,0,Fe,0,0,1,0,0,0,0,1);const Et=new z.eaF(pe,Kt(this.y_handle,pe.kind,pe.color));Et.applyMatrix4(At),W.add(Et)}),W.xyid=3,te.zoom&&te.drawany&&W.add(pn("y",this.size_y3d)),Ot.add(W),W=new z.B69,W.position.set(I,0,k),W.rotation.y=-3/4*Math.PI,te.draw&&W.add(new z.DXC(wt.geometry,wt.material)),An.forEach(pe=>{const me=pe.boundingBox.max.x-pe.boundingBox.min.x,Fe=pe.center?pe.gry-me/2:pe.opposite?A:R-me,At=new z.kn4;At.set(0,st,0,-on*st-this.y_handle.ticksSize-pe.offsetx,st,0,0,Fe,0,0,-1,0,0,0,0,1);const Et=new z.eaF(pe,Kt(this.y_handle,pe.kind,pe.color));Et.applyMatrix4(At),W.add(Et)}),W.xyid=1,te.zoom&&te.drawany&&W.add(pn("y",this.size_y3d)),Ot.add(W)}An=[],st=1,It=[];let dn=null,yn=null,Tn=null,Hn=0;for(this.size_z3d&&te.drawany&&(dn=[],yn=[]);ht.next();){const wt=ht.grpos;let W=1===ht.kind,pe=this.z_handle.format(ht.tick,2);if(null===pe&&(W=!1,pe=""),W&&pe&&te.draw){const me=ht.get_modifier();me?.fLabText&&(pe=me.fLabText);const Fe=ot(this,pe,this.z_handle.labelsFont.size);Fe.computeBoundingBox();const At=Fe.boundingBox.max.x-Fe.boundingBox.min.x,Et=Fe.boundingBox.max.y-Fe.boundingBox.min.y;Fe.translate(-At,-Et/2,0),me?.fTextColor&&(Fe.color=this.getColor(me.fTextColor)),Fe.grz=wt,An.push(Fe),null!==Tn&&Et>0&&(st=Math.min(st,.9*(wt-Tn)/Et)),Hn=Math.max(Hn,At),Tn=wt}dn&&W&&dn.push(m,0,wt,I,0,wt),yn&&W&&yn.push(0,A,wt,0,R,wt),It.push(0,0,wt,this.z_handle.ticksSize*(W?1:.6),0,wt)}if(dn&&dn.length>0){const wt=new z.Fvt({color:this.x_handle.ticksColor,dashSize:2,gapSize:2}),W=(0,xe.Fc)(dn,wt);W.position.set(0,R,0),W.grid=2,W.visible=!1,Ot.add(W);const pe=new z.DXC(W.geometry,wt);pe.position.set(0,A,0),pe.grid=4,pe.visible=!1,Ot.add(pe)}if(yn&&yn.length>0){const wt=new z.Fvt({color:this.y_handle.ticksColor,dashSize:2,gapSize:2}),W=(0,xe.Fc)(yn,wt);W.position.set(I,0,0),W.grid=3,W.visible=!1,Ot.add(W);const pe=new z.DXC(W.geometry,wt);pe.position.set(m,0,0),pe.grid=1,pe.visible=!1,Ot.add(pe)}const ti=[],hi=te.draw?(0,xe.Fc)(It,yt(this.z_handle,"ticks")):null;for(let wt=0;wt<4;++wt){if(ti.push(new z.B69),An.forEach((W,pe)=>{const me=new z.kn4;let Fe=W.grz;this.z_handle.isCenteredLabels()&&(pe<An.length-1?Fe=(Fe+An[pe+1].grz)/2:pe>0&&(Fe=Math.min(1.5*Fe-.5*An[pe-1].grz,J))),me.set(-st,0,0,this.z_handle.ticksSize+.005*(I-m)+this.z_handle.labelsOffset,0,0,1,0,0,st,0,Fe);const At=new z.eaF(W,Kt(this.z_handle));At.applyMatrix4(me),ti[wt].add(At)}),this.z_handle.fTitle&&te.draw){const W=ot(this,this.z_handle.fTitle,this.z_handle.titleFont.size);W.computeBoundingBox();const pe=W.boundingBox.max.x-W.boundingBox.min.x,me=this.z_handle.titleCenter?(J+k-pe)/2:this.z_handle.titleOpposite?k:J-pe;W.rotateZ(Math.PI/2);const Fe=new z.kn4;Fe.set(-st,0,0,this.z_handle.ticksSize+.005*(I-m)+Hn+this.z_handle.titleOffset,0,0,1,0,0,st,0,me);const At=new z.eaF(W,Kt(this.z_handle,"title"));At.applyMatrix4(Fe),ti[wt].add(At)}te.draw&&hi&&ti[wt].add(0===wt?hi:new z.DXC(hi.geometry,hi.material)),te.zoom&&te.drawany&&ti[wt].add(pn("z",this.size_z3d,te.use_y_for_z)),ti[wt].zid=wt+2,Ot.add(ti[wt])}if(ti[0].position.set(m,R,0),ti[0].rotation.z=3/4*Math.PI,ti[1].position.set(I,R,0),ti[1].rotation.z=1/4*Math.PI,ti[2].position.set(I,A,0),ti[2].rotation.z=-1/4*Math.PI,ti[3].position.set(m,A,0),ti[3].rotation.z=-3/4*Math.PI,!te.drawany)return;const ai=yt(this.x_handle),Xi=(0,xe.Fc)([m,0,0,I,0,0],ai,null,!0);for(let wt=0;wt<2;++wt){let W=new z.DXC(Xi,ai);W.position.set(0,A,0===wt?k:J),W.xyboxid=2,W.bottom=0===wt,Ot.add(W),W=new z.DXC(Xi,ai),W.position.set(0,R,0===wt?k:J),W.xyboxid=4,W.bottom=0===wt,Ot.add(W)}const Or=yt(this.y_handle),Tr=(0,xe.Fc)([0,A,0,0,R,0],Or,null,!0);for(let wt=0;wt<2;++wt){let W=new z.DXC(Tr,Or);W.position.set(m,0,0===wt?k:J),W.xyboxid=3,W.bottom=0===wt,Ot.add(W),W=new z.DXC(Tr,Or),W.position.set(I,0,0===wt?k:J),W.xyboxid=1,W.bottom=0===wt,Ot.add(W)}const ys=yt(this.z_handle),ds=(0,xe.Fc)([0,0,k,0,0,J],ys,null,!0);for(let wt=0;wt<4;++wt){const W=new z.DXC(ds,ys);W.zboxid=ti[wt].zid,W.position.copy(ti[wt].position),Ot.add(W)}}function x(U,j,te){U=this.x_handle.gr(U),j=this.y_handle.gr(j),te=this.z_handle.gr(te);const N=(new z.Pq0).set(U,j,te);N.project(this.camera),N.x=(N.x+1)/2,N.y=(N.y+1)/2;const m=this.getPadPainter(),I=m?.getPadWidth(),A=m?.getPadHeight();return I&&A&&(N.x=(this.scene_x+N.x*this.scene_width)/I,N.y=(this.scene_y+N.y*this.scene_height)/A),N}function v(U){Object.assign(U,{create3DScene:he,add3DMesh:fe,remove3DMeshes:le,render3D:Y,resize3D:V,change3DCamera:ue,highlightBin3D:D,set3DOptions:w,drawXYZ:P,convert3DtoPadNDC:x})}function _(U,j=!1){if(!U.draw_content)return;const te=xe.DJ.Vertices,N=xe.DJ.Indexes,m=xe.DJ.Normals,I=xe.DJ.Segments,A=[0,1,1,2,2,3,3,0],R=[new z.Pq0(0,0,0),new z.Pq0(0,1,0),new z.Pq0(1,1,0),new z.Pq0(1,0,0)],k=U.getFramePainter(),J=U.prepareDraw({rounding:!1,use3d:!0,extra:1}),_e=U.options.cutg,be=J.i1,Te=J.i2,Pe=J.j1,We=J.j2,dt=U.getHisto(),Q=dt.$baseh,Ke=11===U.options.Lego||13===U.options.Lego,Ze=dt.getBin(Te,We)<65535;if(be>=Te||Pe>=We)return;let Ue,Oe,lt,gt,ht,st,yt,Kt,Ot,It,An,on,pn,Qt,Bn,dn=k.z_handle.getScaleMin(),yn=k.z_handle.getScaleMax();const Tn=(St,xt,En)=>(on=dt.getBinContent(St+1,xt+1),An=Q?Q.getBinContent(St+1,xt+1):!1!==U.options.BaseLine?U.options.BaseLine:U.options.Zero?dn:0,on<An&&([An,on]=[on,An]),!(An>=Oe||on<Ue||_e&&!_e.IsInside(dt.fXaxis.GetBinCoord(St+.5),dt.fYaxis.GetBinCoord(xt+.5)))&&(pn=on===Ue||An>=on,!pn||En>0||!Q&&(!!(U.options.Zero||dn>0)||U._show_empty_bins)));let Hn=[dn,yn],ti=null;(12===U.options.Lego||14===U.options.Lego)&&(j?(ti=k.getHistPalette(),U.createContour(k,ti,{full_z_range:!0}),Hn=ti.getContour(),dn=Hn[0],yn=Hn[Hn.length-1]):(Hn=U.createContour(dt.fContour?dt.fContour.length:20,k.lego_zmin,k.lego_zmax).arr,ti=U.getHistPalette()));for(let St=0;St<Hn.length-1;++St){Ue=Hn[St],Oe=Hn[St+1],ti&&St===Hn.length-2&&Oe<yn&&(Oe=yn);const xt=k.grz(Ue),En=k.grz(Oe);let jt=0,Cn=0,ln=0,Un=0;for(lt=be;lt<Te;++lt)for(gt=Pe;gt<We;++gt)Tn(lt,gt,St)&&(Qt=!pn&&St>0,Bn=!pn&&on>Oe&&St<Hn.length-2,ln+=pn?12:N.length,Qt&&(ln-=6),Bn&&(ln-=6),Ke&&!pn&&(ln-=12,Un+=12));const Ci=new Float32Array(3*ln),Rn=new Float32Array(3*ln),si=Ze?new Uint16Array(ln/3):new Uint32Array(ln/3),Fn=0===Un?null:new Float32Array(3*Un),Zt=0===Un?null:new Float32Array(3*Un),tr=0===Un?null:Ze?new Uint16Array(Un/3):new Uint32Array(Un/3);let S,Z,Ae,Ne=0,$=0;for(lt=be;lt<Te;++lt)for(yt=J.grx[lt]+J.xbar1*(J.grx[lt+1]-J.grx[lt]),Kt=J.grx[lt]+J.xbar2*(J.grx[lt+1]-J.grx[lt]),gt=Pe;gt<We;++gt){if(!Tn(lt,gt,St))continue;Qt=!pn&&St>0,Bn=!pn&&on>Oe&&St<Hn.length-2,Ot=J.gry[gt]+J.ybar1*(J.gry[gt+1]-J.gry[gt]),It=J.gry[gt]+J.ybar2*(J.gry[gt+1]-J.gry[gt]),jt=An<=Ue?xt:k.grz(An),Cn=on>Oe?En:k.grz(on),Ae=0,Z=0,pn&&(Ae+=12,Z+=24);const zt=dt.getBin(lt+1,gt+1);let at=N.length;for(Qt&&(at-=6);Z<at;)S=te[N[Z]],Ke&&Z<12?(Fn[$]=yt+S.x*(Kt-yt),Fn[$+1]=Ot+S.y*(It-Ot),Fn[$+2]=jt+S.z*(Cn-jt),Zt[$]=m[Ae],Zt[$+1]=m[Ae+1],Zt[$+2]=m[Ae+2],$%9==0&&(tr[$/9]=zt),$+=3):(Ci[Ne]=yt+S.x*(Kt-yt),Ci[Ne+1]=Ot+S.y*(It-Ot),Ci[Ne+2]=jt+S.z*(Cn-jt),Rn[Ne]=m[Ae],Rn[Ne+1]=m[Ae+1],Rn[Ne+2]=m[Ae+2],Ne%9==0&&(si[Ne/9]=zt),Ne+=3),++Z,Z%6==0&&(Ae+=3,Bn&&Z===N.length-12&&(Z+=6,Ae+=3))}const Ce=Ie(U,Ci,Rn);let $e=j?3:dt.fFillColor,nt=U.getColor($e);ti?nt=j?ti.getColor(St):ti.calcColor(St,Hn.length):(1===U.options.Lego||$e<2)&&($e=1,nt="white");const rt=new z.V9B((0,xe.Bx)(nt,{vertexColors:!1})),ct=new z.eaF(Ce,rt);if(ct.face_to_bins_index=si,ct.painter=U,ct.zmin=dn,ct.zmax=yn,ct.baseline=!1!==U.options.BaseLine?U.options.BaseLine:U.options.Zero?dn:0,ct.tip_color=3===$e?16711680:65280,ct.handle=J,ct.tooltip=function(zt){if(zt.faceIndex<0||zt.faceIndex>=this.face_to_bins_index.length)return null;const at=this.painter,nn=this.handle,Wt=at.getFramePainter(),gn=at.getHisto(),ze=at.get3DToolTip(this.face_to_bins_index[zt.faceIndex]),Qe=Math.min(Wt.size_x3d,Math.max(-Wt.size_x3d,nn.grx[ze.ix-1]+nn.xbar1*(nn.grx[ze.ix]-nn.grx[ze.ix-1]))),ut=Math.min(Wt.size_x3d,Math.max(-Wt.size_x3d,nn.grx[ze.ix-1]+nn.xbar2*(nn.grx[ze.ix]-nn.grx[ze.ix-1]))),_t=Math.min(Wt.size_y3d,Math.max(-Wt.size_y3d,nn.gry[ze.iy-1]+nn.ybar1*(nn.gry[ze.iy]-nn.gry[ze.iy-1]))),Lt=Math.min(Wt.size_y3d,Math.max(-Wt.size_y3d,nn.gry[ze.iy-1]+nn.ybar2*(nn.gry[ze.iy]-nn.gry[ze.iy-1])));ze.x1=Math.min(Qe,ut),ze.x2=Math.max(Qe,ut),ze.y1=Math.min(_t,Lt),ze.y2=Math.max(_t,Lt);let xn=this.baseline,rn=ze.value;return gn.$baseh&&(xn=gn.$baseh.getBinContent(ze.ix,ze.iy)),rn<xn&&([xn,rn]=[rn,xn]),ze.z1=Wt.grz(Math.max(this.zmin,xn)),ze.z2=Wt.grz(Math.min(this.zmax,rn)),ze.color=this.tip_color,ze.$painter=at,ze.$projection=at.is_projection&&2===at.getDimension(),ze},k.add3DMesh(ct),Un>0){const zt=Ie(U,Fn,Zt),at=new z.Q1f($e<2?16711680:(0,b.Qh)(nt).darker(.5).toString()),nn=new z.V9B({color:at,vertexColors:!1}),Wt=new z.eaF(zt,nn);Wt.face_to_bins_index=tr,Wt.painter=U,Wt.handle=ct.handle,Wt.tooltip=ct.tooltip,Wt.zmin=ct.zmin,Wt.zmax=ct.zmax,Wt.baseline=ct.baseline,Wt.tip_color=ct.tip_color,k.add3DMesh(Wt)}}if(U.options.Lego>12)return;let hi=0,ai=0;for(Oe=yn,Ue=dn,lt=be;lt<Te;++lt)for(gt=Pe;gt<We;++gt)Tn(lt,gt,0)&&(hi+=pn?R.length:te.length,ai+=pn?A.length:I.length);const Xi=hi<=65520;Xi||(hi=3*ai);const Or=new Float32Array(3*hi),Tr=Xi?new Uint16Array(ai):null,ys=k.grz(dn),ds=k.grz(yn);let wt=0,W=0,pe=0,me=0;for(lt=be;lt<Te;++lt)for(yt=J.grx[lt]+J.xbar1*(J.grx[lt+1]-J.grx[lt]),Kt=J.grx[lt]+J.xbar2*(J.grx[lt+1]-J.grx[lt]),gt=Pe;gt<We;++gt){if(!Tn(lt,gt,0))continue;Ot=J.gry[gt]+J.ybar1*(J.gry[gt+1]-J.gry[gt]),It=J.gry[gt]+J.ybar2*(J.gry[gt+1]-J.gry[gt]),wt=An<=dn?ys:k.grz(An),W=on>yn?ds:k.grz(on);const St=pn?A:I,xt=pn?R:te;if(Xi){for(ht=0;ht<St.length;++ht)Tr[me++]=pe/3+St[ht];for(ht=0;ht<xt.length;++ht)st=xt[ht],Or[pe]=yt+st.x*(Kt-yt),Or[pe+1]=Ot+st.y*(It-Ot),Or[pe+2]=wt+st.z*(W-wt),pe+=3}else for(ht=0;ht<St.length;++ht)st=xt[St[ht]],Or[pe]=yt+st.x*(Kt-yt),Or[pe+1]=Ot+st.y*(It-Ot),Or[pe+2]=wt+st.z*(W-wt),pe+=3}const Fe=j?U.v7EvalColor("line_color","lightblue"):U.getColor(dt.fLineColor),At=new z.mrM((0,xe.Bx)(Fe,{linewidth:j?U.v7EvalAttr("line_width",1):dt.fLineWidth})),Et=(0,xe.Fc)(He(U,Or),At,Xi?Tr:null);k.add3DMesh(Et)}function C(U,j=!1){const te=U.getFramePainter(),N=U.getHisto(),m=U.prepareDraw({rounding:!1,use3d:!0,extra:1}),I=te.z_handle.getScaleMin(),A=te.z_handle.getScaleMax(),R=U.options.cutg;let k,J,_e,be,Te,Pe,We,dt,Q,Ke,Ze,Ue=0,Oe=null,lt=null,gt=0;for(let Ot=0;Ot<2;++Ot){for(k=m.i1;k<m.i2;++k)for(Pe=m.grx[k],dt=m.grx[k+1],J=m.j1;J<m.j2;++J)if(be=N.getBinContent(k+1,J+1),!(be<I||be>A)&&(be!==I||U.options.Zero||I>0||U._show_empty_bins)&&(!R||R.IsInside(N.fXaxis.GetBinCoord(k+.5),N.fYaxis.GetBinCoord(J+.5)))){if(0===Ot){Ue+=3;continue}_e=N.getBin(k+1,J+1),Te=N.getBinError(_e),lt[gt/18]=_e,We=m.gry[J],Q=m.gry[J+1],Ke=te.grz(be-Te<I?I:be-Te),Ze=te.grz(be+Te>A?A:be+Te),Oe[gt]=Pe,Oe[gt+3]=dt,Oe[gt+1]=Oe[gt+4]=(We+Q)/2,Oe[gt+2]=Oe[gt+5]=(Ke+Ze)/2,gt+=6,Oe[gt]=Oe[gt+3]=(Pe+dt)/2,Oe[gt+1]=We,Oe[gt+4]=Q,Oe[gt+2]=Oe[gt+5]=(Ke+Ze)/2,gt+=6,Oe[gt]=Oe[gt+3]=(Pe+dt)/2,Oe[gt+1]=Oe[gt+4]=(We+Q)/2,Oe[gt+2]=Ke,Oe[gt+5]=Ze,gt+=6}if(0===Ot){if(0===Ue)return;Oe=new Float32Array(6*Ue),lt=new Int32Array(Ue/3)}}const st=j?U.v7EvalColor("line_color","lightblue"):U.getColor(N.fLineColor),yt=new z.mrM((0,xe.Bx)(st,{linewidth:j?U.v7EvalAttr("line_width",1):N.fLineWidth})),Kt=(0,xe.Fc)(Oe,yt);Kt.painter=U,Kt.intersect_index=lt,Kt.zmin=I,Kt.zmax=A,Kt.tip_color=3===N.fLineColor?16711680:65280,Kt.tooltip=function(Ot){const It=Math.floor(Ot.index/6);if(It<0||It>=this.intersect_index.length)return null;const An=this.painter,on=An.getHisto(),pn=An.getFramePainter(),Qt=An.get3DToolTip(this.intersect_index[It]),Bn=Math.min(pn.size_x3d,Math.max(-pn.size_x3d,pn.grx(on.fXaxis.GetBinLowEdge(Qt.ix)))),dn=Math.min(pn.size_x3d,Math.max(-pn.size_x3d,pn.grx(on.fXaxis.GetBinLowEdge(Qt.ix+1)))),yn=Math.min(pn.size_y3d,Math.max(-pn.size_y3d,pn.gry(on.fYaxis.GetBinLowEdge(Qt.iy)))),Tn=Math.min(pn.size_y3d,Math.max(-pn.size_y3d,pn.gry(on.fYaxis.GetBinLowEdge(Qt.iy+1))));return Qt.x1=Math.min(Bn,dn),Qt.x2=Math.max(Bn,dn),Qt.y1=Math.min(yn,Tn),Qt.y2=Math.max(yn,Tn),Qt.z1=pn.grz(Qt.value-Qt.error<this.zmin?this.zmin:Qt.value-Qt.error),Qt.z2=pn.grz(Qt.value+Qt.error>this.zmax?this.zmax:Qt.value+Qt.error),Qt.color=this.tip_color,Qt},te.add3DMesh(Kt)}function L(U,j=!1,te=!1){const N=U.getFramePainter(),m=U.prepareDraw({rounding:!1,use3d:!0,extra:100,middle:0}),I=U.getHisto(),A=U.getContourLevels(),R=U.getHistPalette(),k=[];let J=2*N.size_z3d;(0,Xe.Hn)(I,m,A,R,(be,Te,Pe,We,dt,Q)=>{if(!(dt-We<3||j&&(J=N.grz(A[Q]),J<0||J>2*N.size_z3d)))for(let Ke=We;Ke<dt;++Ke)k.push(Te[Ke],Pe[Ke],J),k.push(Te[Ke+1],Pe[Ke+1],J)});const _e=(0,xe.Fc)(k,(0,xe.DH)(U,te?"line_":I));N.add3DMesh(_e)}function F(U,j=!1){const te=U.getHisto(),N=U.getFramePainter(),m=N.z_handle.getScaleMin(),I=N.logz?Te=>Te<m?-.1:N.grz(Te):N.grz,R=2*N.size_z3d;let k=U.prepareDraw({rounding:!1,use3d:!0,extra:1,middle:.5,cutg:(0,ve.isFunc)(U.options?.cutg?.IsInside)?U.options?.cutg:null});if(k.i2-k.i1<2||k.j2-k.j1<2)return;let J=null,_e=null,be=null;if(k.dolines=!0,j){let Te=0;switch(U.options.Surf){case 11:Te=2;break;case 12:case 15:case 17:Te=2,k.dolines=!1;break;case 14:k.dolines=!1,k.donormals=!0;break;case 16:Te=1,k.dogrid=!0,k.dolines=!1;break;default:J=N.z_handle.createTicks(!0),k.dogrid=!0}Te>0&&(be=N.getHistPalette(),2===Te&&U.createContour(N,be,{full_z_range:!0}),J=be.getContour())}else switch(U.options.Surf){case 11:J=U.getContourLevels(),be=U.getHistPalette();break;case 12:case 15:case 17:J=U.getContourLevels(),be=U.getHistPalette(),k.dolines=!1;break;case 14:k.dolines=!1,k.donormals=!0;break;case 16:J=U.getContourLevels(),k.dogrid=!0,k.dolines=!1;break;default:J=N.z_handle.createTicks(!0),k.dogrid=!0}if(J){_e=new Float32Array(J.length);for(let Te=0;Te<J.length;++Te)_e[Te]=I(J[Te])}else _e=[0,R];if(k.grz=I,k.grz_min=0,k.grz_max=R,(0,Xe.YB)(te,k,J,(Te,Pe,We)=>{const dt=Ie(U,Pe,null,k.i2-k.i1,k.j2-k.j1),Q=dt.getAttribute("normal").array;if(k.donormals&&1===Te)for(let Oe=k.i1;Oe<k.i2;++Oe)for(let lt=k.j1;lt<k.j2;++lt){const gt=8*((Oe-k.i1)*(k.j2-k.j1)+(lt-k.j1));if(-1===We[gt])continue;const ht=We[gt]>=0?gt:gt+9+We[gt],st=gt+8;let yt=0,Kt=0,Ot=0;for(let It=ht;It<st;++It){const An=We[It];if(An<0)return console.error("FAILURE in NORMALS RECALCULATIONS");yt+=Q[An],Kt+=Q[An+1],Ot+=Q[An+2]}yt/=st-ht,Kt/=st-ht,Ot/=st-ht;for(let It=ht;It<st;++It){const An=We[It];Q[An]=yt,Q[An+1]=Kt,Q[An+2]=Ot}}let Ke,Ze;j?Ke=be?.getColor(Te-1)??U.getColor(5):be?Ke=be.calcColor(Te,_e.length):(Ke=te.fFillColor>1?U.getColor(te.fFillColor):"white",14===U.options.Surf&&te.fFillColor<2&&(Ke=U.getColor(48))),Ke||(Ke="white"),Ze=14===U.options.Surf?new z.G_z((0,xe.Bx)(Ke,{side:z.$EB,vertexColors:!1})):new z.V9B((0,xe.Bx)(Ke,{side:z.$EB,vertexColors:!1}));const Ue=new z.eaF(dt,Ze);N.add3DMesh(Ue),Ue.painter=U},(Te,Pe)=>{const We=U.getColor(te.fLineColor)??"white";let dt;dt=Te?1===U.options.Surf?new z.Fvt({color:0,dashSize:2,gapSize:2}):new z.mrM((0,xe.Bx)(We)):new z.mrM((0,xe.Bx)(We,{linewidth:te.fLineWidth}));const Q=(0,xe.Fc)(He(U,Pe,k.i2-k.i1,k.j2-k.j1),dt);Q.painter=U,N.add3DMesh(Q)}),17===U.options.Surf&&L(U,!1,j),13===U.options.Surf){k=U.prepareDraw({rounding:!1,use3d:!0,extra:100,middle:0});const Te=U.getContourLevels(),Pe=U.getHistPalette();let We=-1,dt=R;(0,Xe.Hn)(te,k,Te,Pe,(Q,Ke,Ze,Ue,Oe)=>{if(Ke[Oe]===Ke[Ue]&&Ze[Oe]===Ze[Ue]&&Oe--,Oe-Ue<3)return;const lt=[];for(let An=Ue;An<=Oe;++An)(An===Ue||Ke[An]!==Ke[An-1]||Ze[An]!==Ze[An-1])&&lt.push(new z.I9Y(Ke[An],Ze[An]));if(lt.length<3)return;const gt=z.xJ6.triangulateShape(lt,[]);if(!gt||0===gt.length)return;(We<0||We!==Q)&&(We=Q,dt+=5e-5*R);const ht=new Float32Array(9*gt.length),st=new Float32Array(9*gt.length);let yt=0;for(let An=0;An<gt.length;++An){const on=gt[An];for(let pn=0;pn<3;++pn){const Qt=lt[on[pn]];ht[yt]=Qt.x,ht[yt+1]=Qt.y,ht[yt+2]=dt,st[yt]=0,st[yt+1]=0,st[yt+2]=1,yt+=3}}const Kt=Ie(U,ht,st,k.i2-k.i1,k.j2-k.j1),Ot=new z.V9B((0,xe.Bx)(Pe.getColor(Q),{side:z.$EB,opacity:.5,vertexColors:!1})),It=new z.eaF(Kt,Ot);It.painter=U,N.add3DMesh(It)})}}},5334:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{N:()=>Xe,c:()=>Je});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(9041),xe=Ee(3277),et=Ee(3693);const Je=["LOGXY","LOGX","LOGY","LOGZ","LOGV","LOG","LOG2X","LOG2Y","LOG2","LNX","LNY","LN","GRIDXY","GRIDX","GRIDY","TICKXY","TICKX","TICKY","TICKZ","FB","GRAYSCALE"];class Xe extends xe.mf{convertTH1K(){const Re=this.getObject();if(Re.fReady)return;const He=Re.fArray,Ie=Re.fEntries;Re.fNcells=Re.fXaxis.fNbins+2,Re.fArray=new Float64Array(Re.fNcells).fill(0);for(let O=0;O<Re.fNIn;++O)Re.Fill(He[O]);Re.fReady=1,Re.fEntries=Ie}scanContent(Re){Re&&!this.nbinsx&&(Re=!1),this.isTH1K()&&this.convertTH1K();const He=this.getHisto();Re||this.extractAxesProperties(1);const Ie=this.getSelectIndex("x","left"),O=this.getSelectIndex("x","right"),ce=this.getPadPainter()?.getPadLog(this.options.BarStyle>=20?"x":"y"),ie=this.options.Func?this.findFunction(b.clTF1):null;if(Re&&Ie===this.scan_xleft&&O===this.scan_xright)return;this.draw_content=!(this.options.Axis>0),this.scan_xleft=Ie,this.scan_xright=O;const he=this.isTProfile();let D,w,ue=0,fe=0,le=0,Y=0,V=!0;for(let x=0;x<this.nbinsx;++x)if(D=He.getBinContent(x+1),Y+=he?He.fBinEntries[x+1]:D,!(x<Ie||x>=O)&&(D>0&&(0===fe||D<fe)&&(fe=D),V&&(ue=le=D,V=!1),w=this.options.Error?He.getBinError(x+1):0,ue=Math.min(ue,D-w),le=Math.max(le,D+w),ie)){const v=He.fXaxis.GetBinCenter(x+1),_=(0,et.rr)(ie,v);void 0!==_&&(le=Math.max(le,_),ce&&D>0&&_>.3*D&&(fe=Math.min(fe,_)))}Y+=he?He.fBinEntries[0]+He.fBinEntries[this.nbinsx+1]:He.getBinContent(0)+He.getBinContent(this.nbinsx+1),this.stat_entries=He.fEntries>1?He.fEntries:Y,this.hmin=ue,this.hmax=le,(0===this.nbinsx||Math.abs(ue)<1e-300&&Math.abs(le)<1e-300)&&(this.draw_content=!1);let P=!1;if((this.draw_content||this.isMainPainter()&&this.options.Axis>0&&!this.options.ohmin&&!this.options.ohmax&&He.fMinimum===b.kNoZoom&&He.fMaximum===b.kNoZoom)&&(ue>=le?0===ue?(this.ymin=0,this.ymax=1):ue<0?(this.ymin=2*ue,this.ymax=0):(this.ymin=0,this.ymax=2*ue):ce?(this.ymin=.5*(fe||ue),this.ymax=2*le*(.9/.95)):(this.ymin=ue,this.ymax=le)),!this._exact_y_range&&!this._set_y_range&&!ce){if(!1!==this.options.BaseLine&&this.ymin>=0)this.ymin=0;else{const x=this.ymin>=0;this.ymin-=b.gStyle.fHistTopMargin*(this.ymax-this.ymin),x&&this.ymin<0&&(this.ymin=0)}this.ymax+=b.gStyle.fHistTopMargin*(this.ymax-this.ymin)}this.options.ignore_min_max?ue=le=b.kNoZoom:(ue=this.options.minimum,le=this.options.maximum),ue===le&&ue!==b.kNoZoom&&(ue<0?(ue*=2,le=0):(ue=0,le*=2,le||(le=1))),this._set_y_range=!1,this.options.ohmin&&this.options.ohmax&&!this.draw_content?P=!this.options.ignore_min_max:ue!==b.kNoZoom&&le!==b.kNoZoom&&!this.draw_content&&(this.ymin===this.ymax||this.ymin>ue||this.ymax<le)?(this.ymin=ue,this.ymax=le,this._set_y_range=!0):(ue!==b.kNoZoom&&(this._set_y_range=!0,ue<this.ymin&&(this.ymin=ue),P=!0),le!==b.kNoZoom&&(this._set_y_range=!0,le>this.ymax&&(this.ymax=le),P=!0)),Re||(P?(this.zoom_ymin=ue===b.kNoZoom?this.ymin:ue,this.zoom_ymax=le===b.kNoZoom?this.ymax:le):(delete this.zoom_ymin,delete this.zoom_ymax)),this.wheel_zoomy=this.getDimension()>1||!this.draw_content}countStat(Re,He){const Ie=this.isTProfile(),O=this.getHisto(),ce=O.fXaxis,ie=this.getSelectIndex("x","left"),he=this.getSelectIndex("x","right"),ue=this.getFramePainter(),fe={name:O.fName,meanx:0,meany:0,rmsx:0,rmsy:0,integral:0,entries:this.stat_entries,eff_entries:0,xmax:0,wmax:0,skewx:0,skewd:0,kurtx:0,kurtd:0},le=!ue.isAxisZoomed("x")&&Math.abs(O.fTsumw)>1e-300;let v,Y=0,V=0,D=0,w=0,P=0,x=0,_=0,C=0,L=null,F=null;for((0,b.isFunc)(Re)||(Re=null),v=ie;v<he;++v)_=ce.GetBinCoord(v+.5),(!Re||Re(_))&&(Ie?(C=O.fBinEntries[v+1],P+=O.fArray[v+1],x+=O.fSumw2[v+1]):C=O.getBinContent(v+1),(null===L||C>F)&&(L=_,F=C),le||(Y+=C,V+=C*C,D+=C*_,w+=C*_**2));if(le&&(Y=O.fTsumw,V=O.fTsumw2,D=O.fTsumwx,w=O.fTsumwx2),fe.integral=Y,fe.eff_entries=V?Y*Y/V:Math.abs(Y),Math.abs(Y)>1e-300&&(fe.meanx=D/Y,fe.meany=P/Y,fe.rmsx=Math.sqrt(Math.abs(w/Y-fe.meanx**2)),fe.rmsy=Math.sqrt(Math.abs(x/Y-fe.meany**2))),null!==L&&(fe.xmax=L,fe.wmax=F),He){let U=0,j=0,te=0;for(v=ie;v<he;++v)_=ce.GetBinCoord(v+.5),(!Re||Re(_))&&(C=Ie?O.fBinEntries[v+1]:O.getBinContent(v+1),te+=C,U+=C*Math.pow(_-fe.meanx,3),j+=C*Math.pow(_-fe.meanx,4));const N=Math.pow(fe.rmsx,3),m=Math.pow(fe.rmsx,4);te*N!=0&&(fe.skewx=U/(te*N)),fe.skewd=fe.eff_entries>0?Math.sqrt(6/fe.eff_entries):0,te*m!=0&&(fe.kurtx=j/(te*m)-3),fe.kurtd=fe.eff_entries>0?Math.sqrt(24/fe.eff_entries):0}return fe}fillStatistic(Re,He,Ie){if(this.isIgnoreStatsFill())return!1;1===He&&(He=1111),1===Ie&&(Ie=111);const O=this.getHisto(),ce=He%10,ie=Math.floor(He/10)%10,he=Math.floor(He/100)%10,ue=Math.floor(He/1e3)%10,fe=Math.floor(He/1e4)%10,le=Math.floor(He/1e5)%10,Y=Math.floor(He/1e6)%10,V=Math.floor(He/1e7)%10,D=Math.floor(He/1e8)%10,w=this.countStat(void 0,V>0||D>0);return Re.clearPave(),ce>0&&Re.addText(w.name),this.isTProfile()?(ie>0&&Re.addText("Entries = "+Re.format(w.entries,"entries")),he>0&&(Re.addText("Mean = "+Re.format(w.meanx)),Re.addText("Mean y = "+Re.format(w.meany))),ue>0&&(Re.addText("Std Dev = "+Re.format(w.rmsx)),Re.addText("Std Dev y = "+Re.format(w.rmsy)))):(ie>0&&Re.addText("Entries = "+Re.format(w.entries,"entries")),he>0&&Re.addText("Mean = "+Re.format(w.meanx)),ue>0&&Re.addText("Std Dev = "+Re.format(w.rmsx)),fe>0&&Re.addText("Underflow = "+Re.format(O.fArray.length>0?O.fArray[0]:0,"entries")),le>0&&Re.addText("Overflow = "+Re.format(O.fArray.length>0?O.fArray[O.fArray.length-1]:0,"entries")),Y>0&&Re.addText("Integral = "+Re.format(w.integral,"entries")),2===V?Re.addText(`Skewness = ${Re.format(w.skewx)} #pm ${Re.format(w.skewd)}`):V>0&&Re.addText(`Skewness = ${Re.format(w.skewx)}`),2===D?Re.addText(`Kurtosis = ${Re.format(w.kurtx)} #pm ${Re.format(w.kurtd)}`):D>0&&Re.addText(`Kurtosis = ${Re.format(w.kurtx)}`)),Ie&&Re.fillFunctionStat(this.findFunction(b.clTF1),Ie,1),!0}drawBars(Re,He){var Ie=this;return(0,ve.A)(function*(){const O=Ie.getSelectIndex("x","left",-1),ce=Ie.getSelectIndex("x","right",1),ie=Ie.getHisto(),he=ie.fXaxis,ue=Ie.options.Text;let fe,le,Y,V,D,w,P,x,v,_,C,L,F="",U="",j="",te=Ie.options.BarStyle>10?Ie.options.BarStyle%10:0;for(te>4&&(te=4),C=Re.swap_xy?0:He,Number.isFinite(Ie.options.BaseLine)&&Ie.options.BaseLine>=Re.scale_ymin&&(C=Math.round(Re.gry(Ie.options.BaseLine))),ue&&(fe=Ie.getColor(ie.fMarkerColor),le=-1*Ie.options.TextAngle,Y=20,1!==ie.fMarkerSize&&le&&(Y=.02*He*ie.fMarkerSize),Ie.startTextDrawing(42,Y,Ie.draw_g,Y)),V=O;V<ce;++V)if(D=he.GetBinLowEdge(V+1),w=he.GetBinLowEdge(V+2),!(Re.logx&&w<=0)&&(P=Math.round(Re.grx(D)),x=Math.round(Re.grx(w)),v=ie.getBinContent(V+1),!(Re.logy&&v<Re.scale_ymin)&&(_=Math.round(Re.gry(v)),L=x-P,P+=Math.round(ie.fBarOffset/1e3*L),L=Math.round(ie.fBarWidth/1e3*L),F+=Re.swap_xy?`M${C},${P}h${_-C}v${L}h${C-_}z`:`M${P},${_}h${L}v${C-_}h${-L}z`,te>0&&(x=P+L,L=Math.round(L*te/10),Re.swap_xy?(U+=`M${C},${P}h${_-C}v${L}h${C-_}z`,j+=`M${C},${x}h${_-C}v${-L}h${C-_}z`):(U+=`M${P},${_}h${L}v${C-_}h${-L}z`,j+=`M${x},${_}h${-L}v${C-_}h${L}z`)),ue&&v))){const N=v===Math.round(v)?v.toString():(0,ke.lg)(v,b.gStyle.fPaintTextFormat);Ie.drawText(Re.swap_xy?{align:12,x:Math.round(_+Y/2),y:Math.round(P+.1),height:Math.round(.8*L),text:N,color:fe,latex:0}:le?{align:12,x:P+L/2,y:Math.round(_-2-Y/5),width:0,height:0,rotate:le,text:N,color:fe,latex:0}:{align:22,x:Math.round(P+.1*L),y:Math.round(_-2-Y),width:Math.round(.8*L),height:Y,text:N,color:fe,latex:0})}if(F&&Ie.draw_g.append("svg:path").attr("d",F).call(Ie.fillatt.func),U&&Ie.draw_g.append("svg:path").attr("d",U).call(Ie.fillatt.func).style("fill",(0,z.Qh)(Ie.fillatt.color).brighter(.5).formatHex()),j&&Ie.draw_g.append("svg:path").attr("d",j).call(Ie.fillatt.func).style("fill",(0,z.Qh)(Ie.fillatt.color).darker(.5).formatHex()),ue)return Ie.finishTextDrawing()})()}drawFilledErrors(Re){const He=this.getSelectIndex("x","left",0),Ie=this.getSelectIndex("x","right",0),O=this.getHisto(),ce=[],ie=[];for(let le=He;le<Ie;++le){const Y=O.fXaxis.GetBinCoord(le+.5);if(Re.logx&&Y<=0)continue;const V=Math.round(Re.grx(Y)),D=O.getBinContent(le+1),w=O.getBinError(le+1);Re.logy&&D-w<Re.scale_ymin||(ce.push({grx:V,gry:Math.round(Re.gry(D+w))}),ie.unshift({grx:V,gry:Math.round(Re.gry(D-w))}))}const he=4!==this.options.ErrorKind,ue=(0,ke.Mw)(ce,{line:he}),fe=(0,ke.Mw)(ie,{line:he,cmd:"L"});this.draw_g.append("svg:path").attr("d",ue+fe+"Z").call(this.fillatt.func)}drawNormal(Re,He,Ie){const O=this.getSelectIndex("x","left",-1),ce=this.getSelectIndex("x","right",2),ie=this.getHisto(),he=!this.isBatchMode()&&b.settings.Tooltip,ue=ie.fXaxis,fe=!this.options.Zero,le=this.options.Error,Y=this.options.Curve,V=this.options.Text,D=V&&"E"===this.options.TextKind&&this.isTProfile()&&ie.fBinEntries,w=[];let C,L,F,U,j,te,N,m,I,A,R,k,J,_e,be,ht,st,yt,Kt,Ot,It,An,on,pn,Qt,Bn,dn,yn,Tn,Hn,P="",x=!1,v=this.options.Mark,_=this.options.Line,Te=null,Pe=null,We=null,dt="",Q=null,Ke=null,Ze=5,Ue=!1,Oe=!1,lt=0,gt=0;if(le&&!v&&ie.fMarkerStyle>1&&(v=!0),2===this.options.ErrorKind?this.fillatt.empty()?v=!0:Te="":le&&(_=!1,Pe="",Q=he?"":null,Oe=!0),gt=this.lineatt.width+b.gStyle.fEndErrorSize,1===this.options.ErrorKind&&(lt=Math.floor((this.lineatt.width-1)/2)),v){let me=this.options.MarkStyle;!me&&1===ie.fMarkerStyle&&(me=8),this.createAttMarker({attr:ie,style:me}),this.markeratt.size>0?(We="",Ue=!0,this.markeratt.resetPos(),null===Q&&he&&(!this.markeratt.fill||this.markeratt.getFullSize()<7)&&(Ke="",Ze=Math.max(5,Math.round(.7*this.markeratt.getFullSize())))):v=!1}const ti=le||v,hi=ti||V||_||Y,ai=this.options.Hist&&(!this.lineatt.empty()||!this.fillatt.empty());if(!ai&&!hi)return this.removeG();if(V){if(yn=this.getColor(ie.fMarkerColor),Tn=-1*this.options.TextAngle,Hn=20,1!==ie.fMarkerSize&&Tn&&(Hn=.02*Ie*ie.fMarkerSize),!Tn&&!this.options.TextKind){const me=He/(ce-O+1);me<3*Hn&&(Tn=270,Hn=Math.round(.7*me))}this.startTextDrawing(42,Hn,this.draw_g,Hn)}const Xi=hi||ce-O>3*He,Or=me=>(Kt=ie.getBinContent(me+1),!(fe&&0===Kt||(It=Math.round(Re.grx(ue.GetBinLowEdge(me+1))),An=Math.round(Re.grx(ue.GetBinLowEdge(me+2))),on=Math.round((It+An)/2),void 0===L&&(L=on),ht=Math.round(Re.gry(Kt)),le?(Ot=ie.getBinError(me+1),st=Math.round(ht-Re.gry(Kt+Ot)),yt=Math.round(Re.gry(Kt-Ot)-ht)):st=yt=20,0))),Tr=()=>{let me=5;if(this.options.errorX>0&&(me=Math.round((An-It)*this.options.errorX),Bn=on-me,dn=on+me,Pe+=1===this.options.ErrorKind?`M${Bn+lt},${ht-gt}v${2*gt}m0,-${gt}h${dn-Bn-2*lt}m0,-${gt}v${2*gt}`:`M${Bn+lt},${ht}h${dn-Bn-2*lt}`),Pe+=1===this.options.ErrorKind?`M${on-gt},${ht-st+lt}h${2*gt}m${-gt},0v${st+yt-2*lt}m${-gt},0h${2*gt}`:`M${on},${ht-st+lt}v${st+yt-2*lt}`,null!==Q){const Fe=Math.max(st,5),At=Math.max(yt,5);Q+=`M${on-me},${ht-Fe}h${2*me}v${Fe+At}h${-2*me}z`}},ys=me=>{if(Or(me)){if(V){const Fe=D?ie.fBinEntries[me+1]:Kt;if(0!==Fe){const At=Fe===Math.round(Fe)?Fe.toString():(0,ke.lg)(Fe,b.gStyle.fPaintTextFormat);this.drawText(Tn?{align:12,x:on,y:Math.round(ht-2-Hn/5),width:0,height:0,rotate:Tn,text:At,color:yn,latex:0}:{align:22,x:Math.round(It+.1*(An-It)),y:Math.round(ht-2-Hn),width:Math.round(.8*(An-It)),height:Hn,text:At,color:yn,latex:0})}}_?(0===dt.length?dt=`M${on},${ht}`:dt+=pn===on?"v"+(ht-Qt):Qt===ht?"h"+(on-pn):`l${on-pn},${ht-Qt}`,pn=on,Qt=ht):Y&&w.push({grx:(It+An)/2,gry:Re.gry(Kt)}),ti&&ht>=-st&&ht<=Ie+yt&&(null!==Te&&(Te+=`M${It},${ht-st}h${An-It}v${st+yt+1}h${It-An}z`),null!==We&&Ue&&(We+=this.markeratt.create(on,ht),null!==Ke&&(Ke+=`M${on-Ze},${ht-Ze}h${2*Ze}v${2*Ze}h${-2*Ze}z`)),null!==Pe&&Oe&&Tr())}};if((Ue||Oe)&&(!b.settings.OptimizeDraw||ce-O<5e4&&1===b.settings.OptimizeDraw)){for(J=O;J<ce;++J)Or(J)&&(null!==We&&(We+=this.markeratt.create(on,ht)),null!==Ke&&(Ke+=`M${on-Ze},${ht-Ze}h${2*Ze}v${2*Ze}h${-2*Ze}z`),null!==Pe&&Tr());Oe=Ue=!1}for(J=O;J<=ce;++J)j=ue.GetBinLowEdge(J+1),!(this.logx&&j<=0)&&(te=Math.round(Re.grx(j)),x=J===ce,x&&O<ce?m=U:(N=ie.getBinContent(J+1),m=Math.round(Re.gry(N))),0===P.length?(_e=be=J,k=C=F=te,R=I=A=U=m,P=`M${F},${U}`):Xi?te!==F||x?(hi&&(_e===be?ys(_e):_e<be?(ys(_e),ys(be)):(ys(be),ys(_e))),ai&&(I!==A||R!==I)&&(k!==F&&(P+="h"+(F-k)),U===I?(A!==R&&(P+="v"+(A-R)),I!==A&&(P+="v"+(I-A))):(I!==R&&(P+="v"+(I-R)),A!==I&&(P+="v"+(A-I)),U!==A&&(P+="v"+(U-A))),k=F,R=U),x&&k!==te&&(P+="h"+(te-k)),_e=be=J,I=A=U=m,F=te):(m<I?be=J:m>A&&(_e=J),I=Math.min(I,m),A=Math.max(A,m),U=m):(m!==U||x)&&(te!==F&&(P+="h"+(te-F)),m!==U&&(P+="v"+(m-U)),U=m,F=te));const ds=he&&this.fillatt.empty()&&ai&&!ti&&!_&&!Y,wt=()=>{this.draw_g.append("svg:path").attr("d",P+(!this.fillatt.empty()||ds?pe:"")).style("stroke-linejoin","miter").call(this.lineatt.func).call(this.fillatt.func)};let W=Ie+3;if(!ds){const me=Math.round(Re.gry(0));me<=0?W=-3:me<Ie&&(W=me)}const pe=`L${F},${W}H${C}Z`;return P&&ai&&!this.fillatt.empty()&&(wt(),P=""),(ti||_||Y)&&(!dt&&w.length&&(dt=(0,ke.Mw)(w)),Te?this.draw_g.append("svg:path").attr("d",Te).call(this.fillatt.func):dt&&!this.fillatt.empty()&&!ai&&this.draw_g.append("svg:path").attr("d",dt+`L${on},${W}H${L}Z`).call(this.fillatt.func),Pe&&this.draw_g.append("svg:path").attr("d",Pe).call(this.lineatt.func),Q&&this.draw_g.append("svg:path").attr("d",Q).style("fill","none").style("pointer-events",this.isBatchMode()?null:"visibleFill"),dt&&this.draw_g.append("svg:path").attr("d",dt).style("fill","none").call(this.lineatt.func),We&&this.draw_g.append("svg:path").attr("d",We).call(this.markeratt.func),Ke&&this.draw_g.append("svg:path").attr("d",Ke).style("fill","none").style("pointer-events",this.isBatchMode()?null:"visibleFill")),P&&ai&&wt(),V?this.finishTextDrawing():void 0}draw1DBins(){this.createHistDrawAttributes();const Re=this.getFramePainter(),He=Re.getGrFuncs(this.options.second_x,this.options.second_y),Ie=Re.getFrameWidth(),O=Re.getFrameHeight();return!this.draw_content||Ie<=0||O<=0?this.removeG():(this.createG(!0),this.options.Bar?this.drawBars(He,O).then(()=>{if(1===this.options.ErrorKind)return this.drawNormal(He,Ie,O)}):3===this.options.ErrorKind||4===this.options.ErrorKind?this.drawFilledErrors(He):this.drawNormal(He,Ie,O))}getBinTooltips(Re){const He=[],Ie=this.getObjectHint(),ce=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),ie=this.getHisto(),he=ie.fXaxis.GetBinLowEdge(Re+1),ue=ie.fXaxis.GetBinLowEdge(Re+2),fe=this.getAxisBinTip("x",ie.fXaxis,Re);let le=ie.getBinContent(Re+1);return Ie&&He.push(Ie),this.options.Error||this.options.Mark||this.isTF1()?(He.push(`x = ${fe}`,`y = ${ce.axisAsText("y",le)}`),this.options.Error&&("["===fe[0]&&He.push(`error x = ${((ue-he)/2).toPrecision(4)}`),He.push(`error y = ${ie.getBinError(Re+1).toPrecision(4)}`))):(He.push(`bin = ${Re+1}`,`x = ${fe}`),ie.$baseh&&(le-=ie.$baseh.getBinContent(Re+1)),le===Math.round(le)?He.push(`entries = ${le}`):He.push(`entries = ${(0,ke.lg)(le,b.gStyle.fStatFormat)}`)),He}processTooltipEvent(Re){if(!Re||!this.draw_content||!this.draw_g||this.options.Mode3D)return this.draw_g?.selectChild(".tooltip_bin").remove(),null;const He=this.getFramePainter(),Ie=He.getGrFuncs(this.options.second_x,this.options.second_y),O=this.getHisto(),ce=this.getSelectIndex("x","left",-1),ie=this.getSelectIndex("x","right",2);let le,Y,V,D,w,he=He.getFrameWidth(),ue=He.getFrameHeight(),fe=null,P=2,x=ce,v=ie,_=Re.x,C=Re.y;const L=I=>{const A=O.fXaxis.GetBinLowEdge(I+1);return Ie.logx&&A<=0?null:Ie.grx(A)},F=I=>{const A=O.getBinContent(I+1);return Ie.logy&&A<Ie.scale_ymin?Ie.swap_xy?-1e3:10*ue:Math.round(Ie.gry(A))};Ie.swap_xy&&([_,C,he,ue]=[C,_,ue,he]);const U=Ie.swap_xy!==He.x_handle.reverse;for(;x<v-1;){const I=Math.round(.5*(x+v)),A=L(I);null===A||A<_-.5?U?v=I:x=I:A>_+.5?U?x=I:v=I:(x++,v--)}if(fe=v=x,Y=L(fe),U){for(;x>ce&&L(x-1)<Y+2;)--x;for(;v<ie&&L(v+1)>Y-2;)++v}else{for(;x>ce&&L(x-1)>Y-2;)--x;for(;v<ie&&L(v+1)<Y+2;)++v}if(x<v){let I=ue;for(let A=x;A<=v;A++){const R=Math.abs(F(A)-C);R<I&&(I=R,fe=A)}I>ue/10&&(fe=Math.round(x+(v-x)/ue*C)),Y=L(fe)}if(Y=Math.round(Y),V=Math.round(L(fe+1)),this.options.Bar){const I=V-Y;Y+=Math.round(O.fBarOffset/1e3*I),V=Y+Math.round(O.fBarWidth/1e3*I)}Y>V&&([Y,V]=[V,Y]);const j=Math.round((Y+V)/2),te=D=w=F(fe);if(this.options.Bar)le=!0,P=0,D=Math.round(Ie.gry(!1!==this.options.BaseLine&&this.options.BaseLine>Ie.scale_ymin?this.options.BaseLine:Ie.scale_ymin)),D>w&&([D,w]=[w,D]),!Re.touch&&1===Re.nproc&&(C<D||C>w)&&(fe=null);else if(this.options.Error&&!0!==this.options.Hist||this.options.Mark||this.options.Line||this.options.Curve){le=!this.isTF1();let I=3;if(this.markeratt&&(I=Math.max(I,this.markeratt.getFullSize())),this.options.Error){const A=O.getBinContent(fe+1),R=O.getBinError(fe+1);D=Math.round(Ie.gry(A+R)),w=Math.round(Ie.gry(A-R)),0===A&&this.isTProfile()&&(fe=null);const k=(V-Y)*this.options.errorX;Y=Math.round(j-k),V=Math.round(j+k)}V-Y<2*I&&(Y=j-I,V=j+I),D=Math.min(D,te-I),w=Math.max(w,te+I),!Re.touch&&1===Re.nproc&&(C<D||C>w)&&(fe=null)}else le=1===Re.nproc&&ie-ce<he,le&&(w=ue,this.fillatt.empty()||(w=Math.min(ue,Math.max(0,Math.round(Ie.gry(0)))),w<D&&([D,w]=[w,D])),(Re.y<D||Re.y>w)&&!Re.touch&&(fe=null));null!==fe&&(fe===ce&&Y>_+P||fe===ie-1&&V<_-P||_<Y-P||_>V+P||!this.options.Zero&&0===O.getBinContent(fe+1))&&(fe=null);let N=this.draw_g.selectChild(".tooltip_bin");if(null===fe||w<=0||D>=ue)return N.remove(),null;const m={name:this.getObjectName(),title:O.fTitle,x:j,y:te,exact:!0,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getBinTooltips(fe)};if(Re.disabled)N.remove(),m.changed=!0;else if(le)N.empty()&&(N=this.draw_g.append("svg:rect").attr("class","tooltip_bin").style("pointer-events","none").call(ke.Ru)),m.changed=N.property("current_bin")!==fe,m.changed&&N.attr("x",Ie.swap_xy?D:Y).attr("width",Ie.swap_xy?w-D:V-Y).attr("y",Ie.swap_xy?Y:D).attr("height",Ie.swap_xy?V-Y:w-D).style("opacity","0.3").property("current_bin",fe),m.exact=Math.abs(te-C)<=5||C>=D&&C<=w,m.menu=m.exact,m.menu_dist=Math.sqrt((j-_)**2+(te-C)**2);else{const I=this.lineatt.width+3;N.empty()&&(N=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").attr("r",I).call(this.lineatt.func).call(this.fillatt.func)),m.exact=Math.abs(j-Re.x)<=I&&Math.abs(te-Re.y)<=I,m.menu=m.exact,m.menu_dist=Math.sqrt((j-Re.x)**2+(te-Re.y)**2),m.changed=N.property("current_bin")!==fe,m.changed&&N.attr("cx",j).attr("cy",te).property("current_bin",fe)}return m.changed&&(m.user_info={obj:O,name:O.fName,bin:fe,cont:O.getBinContent(fe+1),grx:j,gry:te}),m}fillHistContextMenu(Re){Re.add("Auto zoom-in",()=>this.autoZoom());const He=this.getSupportedDrawOptions();Re.addDrawMenu("Draw with",He,Ie=>{if(0===Ie.indexOf(b.kInspect))return this.showInspector(Ie);this.decodeOptions(Ie),this.options.need_fillcol&&this.fillatt?.empty()&&this.fillatt.change(5,1001),this.interactiveRedraw("pad","drawopt")}),!this.snapid&&!this.isTProfile()&&!this.isTF1()&&Re.addRebinMenu(Ie=>this.rebinHist(Ie))}rebinHist(Re){const He=this.getHisto(),Ie=He.fXaxis,O=Math.floor(Ie.fNbins/Re);if(O<2)return;const ce=new Array(O+2),ie=Ie.fXbins.length>0?new Array(O):null;ce[0]=He.fArray[0];let he=1;for(let fe=1;fe<=O;++fe){ie&&(ie[fe-1]=Ie.fXbins[he-1]);let le=0;for(let Y=0;Y<Re;++Y)le+=He.fArray[he++];ce[fe]=le}ie?(he<=Ie.fXbins.length&&(Ie.fXmax=Ie.fXbins[he-1]),Ie.fXbins=ie):Ie.fXmax=Ie.fXmin+(Ie.fXmax-Ie.fXmin)/Ie.fNbins*O*Re,Ie.fNbins=O;let ue=0;for(;he<He.fArray.length;)ue+=He.fArray[he++];ce[O+1]=ue,He.fArray=ce,He.fSumw2=[],this.scanContent(),this.interactiveRedraw("pad")}autoZoom(){let Re=this.getSelectIndex("x","left",-1),He=this.getSelectIndex("x","right",1);const Ie=He-Re,O=this.getHisto();if(0===Ie||!O)return;let ce=O.getBinContent(Re+1);for(let ie=Re;ie<He;++ie)ce=Math.min(ce,O.getBinContent(ie+1));if(!(ce>0)){for(;Re<He&&O.getBinContent(Re+1)<=ce;)++Re;for(;Re<He&&O.getBinContent(He)<=ce;)--He;if(Re===He-1&&Re>2&&He<this.nbinsx-2&&(--Re,++He),He-Re<Ie&&Re<He)return this.getFramePainter().zoom(O.fXaxis.GetBinLowEdge(Re+1),O.fXaxis.GetBinLowEdge(He+1))}}canZoomInside(Re,He,Ie){const O=this.getHisto();return!!("x"===Re&&O&&O.fXaxis.FindBin(Ie,.5)-O.fXaxis.FindBin(He,0)>1||"y"===Re&&Math.abs(Ie-He)>1e-6*Math.abs(this.ymax-this.ymin))}callDrawFunc(Re){var He=this;return(0,ve.A)(function*(){const Ie=He.getMainPainter(),O=He.getFramePainter();return Ie!==He&&O&&O.mode3d!==He.options.Mode3D&&He.copyOptionsFrom(Ie),He.options.Mode3D?He.draw3D(Re):He.draw2D(Re)})()}draw2D(){var Re=this;return(0,ve.A)(function*(){return Re.clear3DScene(),Re.scanContent(!0),(Re.isMainPainter()?Re.drawColorPalette(!1):Promise.resolve(!0)).then(()=>Re.drawAxes()).then(()=>Re.draw1DBins()).then(()=>Re.updateFunctions()).then(()=>Re.updateHistTitle()).then(()=>(Re.updateStatWebCanvas(),Re.addInteractivity()))})()}draw3D(Re){var He=this;return(0,ve.A)(function*(){return console.log("3D drawing is disabled, load ./hist/TH1Painter.mjs"),He.draw2D(Re)})()}redraw(Re){return this.callDrawFunc(Re)}static draw(Re,He,Ie){return(0,ve.A)(function*(){return xe.mf._drawHist(new Xe(Re,He),Ie)})()}}},4571:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{AJ:()=>He,Hn:()=>Xe,N7:()=>ot,YB:()=>Re});var ve=Ee(467),b=Ee(6998),z=Ee(5680),ke=Ee(6823),xe=Ee(9041),et=Ee(6224),Je=Ee(3277);function Xe(Ie,O,ce,ie,he){const le=new Float32Array(4008),Y=new Float32Array(4008),V=new Int32Array(4008),D=ce.length,w=ce[0],P=ce[D-1],x=[],v=[0,0,0,0],_=[0,0,0,0],C=[0,0,0,0],L=[0,0,0,0],F=O.grx,U=O.gry;let te,N,m,A,R,k,J,_e,be,Te,Pe,We,dt,Q,Ke,j=0,I=0;const Oe=D<10?Ot=>{if(Ot>=P)return D-1;for(let It=0;It<D;++It)if(Ot<ce[It])return It-1;return D-1}:Ot=>{if(Ot<w)return-1;if(Ot>=P)return D-1;let on,It=0,An=D-1;for(;An-It>1;)on=Math.round((An+It)/2),Ot<ce[on]?An=on:It=on;return It},lt=(Ot,It,An,on,pn,Qt,Bn,dn)=>{const yn=An===Bn,Tn=yn?dn-on:Bn-An,Hn=pn-Ot;let Xi,Or,Tr,ys,ti=It+1,hi=j-1,ai=0;const ds=hi+1002-3;for(;ti<=Qt&&hi<=ds;)ys=ce[ti],Tr=ys-Ot,Or=Tr/Hn,Xi=Tn*Or,yn?(le[hi]=An,Y[hi]=on+Xi):(le[hi]=An+Xi,Y[hi]=on),V[hi]=ti,ai++,hi+=2,ti++;return ai};for(R=O.j1;R<O.j2-1;++R)for(_[1]=_[0]=(U[R]+U[R+1])/2,_[3]=_[2]=(U[R+1]+U[R+2])/2,A=O.i1;A<O.i2-1;++A){for(C[0]=Ie.getBinContent(A+1,R+1),C[1]=Ie.getBinContent(A+2,R+1),C[2]=Ie.getBinContent(A+2,R+2),C[3]=Ie.getBinContent(A+1,R+2),k=0;k<4;k++)L[k]=Oe(C[k]);if(L[0]!==L[1]||L[1]!==L[2]||L[2]!==L[3]||L[3]!==L[0]){for(v[3]=v[0]=(F[A]+F[A+1])/2,v[2]=v[1]=(F[A+1]+F[A+2])/2,J=C[0]<=C[1]?0:1,_e=C[2]<=C[3]?2:3,C[J]>C[_e]&&(J=_e),J++,j=1,Q=1;Q<=4;Q++)_e=J%4+1,be=lt(C[J-1],L[J-1],v[J-1],_[J-1],C[_e-1],L[_e-1],v[_e-1],_[_e-1]),j+=2*be,J=_e;for(J=C[0]<=C[1]?0:1,_e=C[2]<=C[3]?2:3,C[J]>C[_e]&&(J=_e),J++,j=2,Q=1;Q<=4;Q++)_e=1===J?4:J-1,be=lt(C[J-1],L[J-1],v[J-1],_[J-1],C[_e-1],L[_e-1],v[_e-1],_[_e-1]),j+=2*be,J=_e;for(Te=0,Q=1;Q<=j-5;Q+=2)for(;V[Q-1]!==V[Q];){for(Pe=le[Q],We=Y[Q],dt=V[Q],Ke=Q;Ke<=j-5;Ke+=2)le[Ke]=le[Ke+2],Y[Ke]=Y[Ke+2],V[Ke]=V[Ke+2];if(le[j-3]=Pe,Y[j-3]=We,V[j-3]=dt,Te>2e3)break;Te++}if(Te>100)continue;for(Q=1;Q<=j-2;Q+=2)te=V[Q-1],te>=0&&te<ce.length&&(N=x[te],N||(N=x[te]=(0,b.createTPolyLine)(8016,!0)),m=N.fLastPoint,m<N.fN-2&&(N.fX[m+1]=Math.round(le[Q-1]),N.fY[m+1]=Math.round(Y[Q-1]),N.fX[m+2]=Math.round(le[Q]),N.fY[m+2]=Math.round(Y[Q]),N.fLastPoint=m+2,I=Math.max(I,N.fLastPoint+1)))}}const gt=new Int32Array(ce.length);let ht=0;for(te=0;te<ce.length;te++)if(ce[te]>=0){ht=te;break}for(k=0,te=ht-1;te>=0;te--)gt[k]=te,k++;for(te=ht;te<ce.length;te++)gt[k]=te,k++;const st=new Float32Array(2*I),yt=new Float32Array(2*I),Kt=(0,b.isFunc)(ie.calcColorIndex);for(k=0;k<ce.length;++k){if(te=gt[k],N=x[te],!N)continue;const Ot=Kt?ie.calcColorIndex(te,ce.length):te,It=N.fX,An=N.fY,on=N.fLastPoint+1,pn=0,Qt=0;let dn,yn,Tn,Bn=0;for(;;){for(dn=I,yn=dn+1,st[dn]=It[Bn],yt[dn]=An[Bn],st[yn]=It[Bn+1],yt[yn]=An[Bn+1],It[Bn]=It[Bn+1]=pn,An[Bn]=An[Bn+1]=Qt;;){for(Tn=0,A=2;A<on;A+=2)yn<2*I-1&&It[A]===st[yn]&&An[A]===yt[yn]&&(yn++,st[yn]=It[A+1],yt[yn]=An[A+1],It[A]=It[A+1]=pn,An[A]=An[A+1]=Qt,Tn++),dn>0&&It[A+1]===st[dn]&&An[A+1]===yt[dn]&&(dn--,st[dn]=It[A],yt[dn]=An[A],It[A]=It[A+1]=pn,An[A]=An[A+1]=Qt,Tn++);if(0===Tn)break}for(dn+1<yn&&dn>=0&&he(Ot,st,yt,dn,yn,te),Bn=0,A=2;A<on;A+=2)if(It[A]!==pn&&An[A]!==Qt){Bn=A;break}if(0===Bn)break}}}class ot{constructor(O,ce,ie,he,ue,fe,le){let Y=[ie,he];if(O){Y=new Float32Array(O.length);for(let J=0;J<O.length;++J)Y[J]=ce(O[J])}Object.assign(this,{grz_min:ie,grz_max:he,dolines:ue,donormals:fe,dogrid:le}),this.loop=0;const V=[],D=[],w=[],P=new Float32Array(18),x=new Float32Array(6),v=(Y[Y.length-1]-Y[0])/Y.length/100;let _=0,C=null,L=0,F=0,U=null,j=0,te=[],N=0,m=0,I=0;function A(J,_e,be,Te){return J<_e-Te?-1:J>be+Te?1:0}function R(J,_e,be,Te,Pe,We,dt,Q){N>=P.length&&console.log("more than 6 points???");const Ke=(dt-be)/(We-be);let Ze=3;0!==m&&Math.abs(Ke)<Math.abs(m)&&(P[N]=P[N-3],P[N+1]=P[N-2],P[N+2]=P[N-1],N-=3,Ze=6),P[N]=J+Ke*(Te-J),P[N+1]=_e+Ke*(Pe-_e),P[N+2]=dt,Q&&U&&(x[I]=P[N],x[I+1]=P[N+1],x[I+2]=P[N+2],I+=3),N+=Ze,m=Ke}function k(J,_e,be,Te){const Pe=8*((be-_e.i1)*(_e.j2-_e.j1)+(Te-_e.j1));if(te[Pe]>=0)return console.error("More than 8 vertexes for the bin");const We=Pe+8+te[Pe];te[Pe]--,te[We]=J}this.createNormIndex=function(J){J.donormals&&(te=new Int32Array((J.i2-J.i1)*(J.j2-J.j1)*8).fill(-1))},this.createBuffers=function(){if(this.loop){for(let J=1;J<Y.length;++J)V[J]&&(D[J]=new Float32Array(9*V[J]),w[J]=0);this.dolines&&_>0&&(C=new Float32Array(6*_)),this.dogrid&&F>0&&(U=new Float32Array(6*F))}},this.addLineSegment=function(J,_e,be,Te,Pe,We){if(!this.dolines)return;const dt=A(be,this.grz_min,this.grz_max,0),Q=A(We,this.grz_min,this.grz_max,0);if(dt!==Q||0===dt){if(!this.loop)return++_;if(0!==dt){const Ke=We-be;J=Te-(Te-J)/Ke*(We-(be=dt<0?this.grz_min:this.grz_max)),_e=Pe-(Pe-_e)/Ke*(We-be)}if(0!==Q){const Ke=be-We;Te=J-(J-Te)/Ke*(be-(We=Q<0?this.grz_min:this.grz_max)),Pe=_e-(_e-Pe)/Ke*(be-We)}C[L]=J,C[L+1]=_e,C[L+2]=be,L+=3,C[L]=Te,C[L+1]=Pe,C[L+2]=We,L+=3}},this.addMainTriangle=function(J,_e,be,Te,Pe,We,dt,Q,Ke,Ze,Ue,Oe,lt){for(let gt=1;gt<Y.length;++gt){let ht=A(be,Y[gt-1],Y[gt],v),st=A(We,Y[gt-1],Y[gt],v),yt=A(Ke,Y[gt-1],Y[gt],v),Kt=ht+st+yt;if(gt>1&&gt===Y.length-1&&3===Kt&&be<=this.grz_max&&(ht=st=yt=Kt=0),3===Kt)continue;if(-3===Kt)return;if(!this.loop){let An=Math.abs(st-ht)+Math.abs(yt-st)+Math.abs(ht-yt);0===ht&&++An,0===st&&++An,0===yt&&++An,(1===An||2===An)&&console.error(`FOUND npnts = ${An}`),An>2&&(void 0===V[gt]&&(V[gt]=0),V[gt]+=An-2),(ht>0||st>0||yt>0)&&(ht!==st||st!==yt||yt!==ht)&&++F;continue}if(I=0,N=0,0===ht&&(P[N]=J,P[N+1]=_e,P[N+2]=be,N+=3),ht!==st&&(m=0,(ht<0||st<0)&&R(J,_e,be,Te,Pe,We,Y[gt-1]),(ht>0||st>0)&&R(J,_e,be,Te,Pe,We,Y[gt],!0)),0===st&&(P[N]=Te,P[N+1]=Pe,P[N+2]=We,N+=3),st!==yt&&(m=0,(st<0||yt<0)&&R(Te,Pe,We,dt,Q,Ke,Y[gt-1]),(st>0||yt>0)&&R(Te,Pe,We,dt,Q,Ke,Y[gt],!0)),0===yt&&(P[N]=dt,P[N+1]=Q,P[N+2]=Ke,N+=3),yt!==ht&&(m=0,(yt<0||ht<0)&&R(dt,Q,Ke,J,_e,be,Y[gt-1]),(yt>0||ht>0)&&R(dt,Q,Ke,J,_e,be,Y[gt],!0)),0===N)continue;if(N<9){console.log(`found ${N/3} points, must be at least 3`);continue}if(U&&6===I){for(let An=0;An<6;++An)U[j+An]=x[An];j+=6}const Ot=D[gt];let It=w[gt];this.donormals&&9===N&&(k(It,Ue,Oe,lt),k(It+3,Ue,Oe+1,Ze?lt+1:lt),k(It+6,Ue,Ze?Oe:Oe+1,lt+1));for(let An=3;An<N-3;An+=3)Ot[It]=P[0],Ot[It+1]=P[1],Ot[It+2]=P[2],It+=3,Ot[It]=P[An],Ot[It+1]=P[An+1],Ot[It+2]=P[An+2],It+=3,Ot[It]=P[An+3],Ot[It+1]=P[An+4],Ot[It+2]=P[An+5],It+=3;w[gt]=It}},this.callFuncs=function(J,_e){for(let be=1;be<Y.length;++be)D[be]&&J&&J(be,D[be],te);C&&_e&&(6*_!==L&&console.error(`SURF lines mismmatch nsegm=${_} lindx=${L} diff=${6*_-L}`),_e(!1,C)),U&&_e&&(6*F!==j&&console.error(`SURF grid draw mismatch ngridsegm=${F} gindx=${j} diff=${6*F-j}`),_e(!0,U))}}}function Re(Ie,O,ce,ie,he){const ue=O.grz,fe=O.original?O.origx:O.grx,le=O.original?O.origy:O.gry,Y=new ot(ce,O.grz,O.grz_min,O.grz_max,O.dolines,O.donormals,O.dogrid);let V,D,w,P,x,v,_,C,L,F;for(Y.createNormIndex(O),Y.loop=0;Y.loop<2;++Y.loop)for(Y.createBuffers(),V=O.i1;V<O.i2-1;++V)for(w=O.original?.5*(fe[V]+fe[V+1]):fe[V],P=O.original?.5*(fe[V+1]+fe[V+2]):fe[V+1],D=O.j1;D<O.j2-1;++D)x=O.original?.5*(le[D]+le[D+1]):le[D],v=O.original?.5*(le[D+1]+le[D+2]):le[D+1],_=ue(Ie.getBinContent(V+1,D+1)),C=ue(Ie.getBinContent(V+1,D+2)),L=ue(Ie.getBinContent(V+2,D+1)),F=ue(Ie.getBinContent(V+2,D+2)),Y.addMainTriangle(w,x,_,P,v,F,w,v,C,!0,O,V,D),Y.addMainTriangle(w,x,_,P,x,L,P,v,F,!1,O,V,D),Y.addLineSegment(w,v,C,w,x,_),Y.addLineSegment(w,x,_,P,x,L),V===O.i2-2&&Y.addLineSegment(P,x,L,P,v,F),D===O.j2-2&&Y.addLineSegment(w,v,C,P,v,F);Y.callFuncs(ie,he)}class He extends Je.mf{constructor(O,ce){super(O,ce),this.wheel_zoomy=!0,this._show_empty_bins=!1}cleanup(){delete this.tt_handle,super.cleanup()}toggleProjection(O,ce){("Projections"===O||"Off"===O)&&(O="");let ie=ce,he=ce;if((0,b.isStr)(O)&&0===O.indexOf("XY")){const fe=O.length>2?O.slice(2):"";O="XY",ie=he=parseInt(fe)||1}else if((0,b.isStr)(O)&&O.length>1){const fe=O.indexOf("_");fe>0&&"X"===O[0]&&"Y"===O[fe+1]?(ie=parseInt(O.slice(1,fe))||1,he=parseInt(O.slice(fe+2))||1,O="XY"):fe>0&&"Y"===O[0]&&"X"===O[fe+1]?(he=parseInt(O.slice(1,fe))||1,ie=parseInt(O.slice(fe+2))||1,O="XY"):(ie=he=parseInt(O.slice(1))||1,O=O[0])}if(!ie&&!he&&(ie=he=1),O&&this.is_projection===O){if(this.projection_widthX!==ie||this.projection_widthY!==he)return this.projection_widthX=ie,void(this.projection_widthY=he);O=""}delete this.proj_hist;const ue=this.is_projection===O?"":O;return this.projection_widthX=ie,this.projection_widthY=he,this.is_projection="",this.provideSpecialDrawArea(ue).then(()=>(this.is_projection=ue,this.redrawProjection()))}redrawProjection(O,ce,ie,he){var ue=this;return(0,ve.A)(function*(){if(!ue.is_projection)return!1;if(void 0===he){if(!ue.tt_handle)return;O=Math.round((ue.tt_handle.i1+ue.tt_handle.i2)/2),ce=O+1,ie=Math.round((ue.tt_handle.j1+ue.tt_handle.j2)/2),he=ie+1}const fe=ue.getCanvPainter();if(fe&&!fe._readonly&&void 0!==ue.snapid)return("X"===ue.is_projection||"XY"===ue.is_projection)&&!fe.websocketTimeout("projX")&&fe.sendWebsocket(`EXECANDSEND:DXPROJ:${ue.snapid}:ProjectionX("_projx",${ie+1},${he},"")`)&&fe.websocketTimeout("projX",1e3),("Y"===ue.is_projection||"XY"===ue.is_projection)&&!fe.websocketTimeout("projY")&&fe.sendWebsocket(`EXECANDSEND:DYPROJ:${ue.snapid}:ProjectionY("_projy",${O+1},${ce},"")`)&&fe.websocketTimeout("projY",1e3),!0;if(ue.doing_projection)return!1;ue.doing_projection=!0;const le=ue.getHisto(),Y=()=>{const w=(0,b.createHistogram)(b.clTH1D,ue.nbinsx);return Object.assign(w.fXaxis,le.fXaxis),w.fName="xproj",w.fTitle="X projection",w},V=()=>{const w=(0,b.createHistogram)(b.clTH1D,ue.nbinsy);return Object.assign(w.fXaxis,le.fYaxis),w.fName="yproj",w.fTitle="Y projection",w},D=(w,P)=>{let x=0,v=-1;if("X"===w){for(let _=0;_<ue.nbinsx;++_){let C=0;for(let L=ie;L<he;++L)C+=le.getBinContent(_+1,L+1);P.setBinContent(_+1,C)}P.fTitle="X projection "+(ie+1===he?`bin ${he}`:`bins [${ie+1} .. ${he}]`),ue.tt_handle&&(x=ue.tt_handle.i1+1,v=ue.tt_handle.i2)}else{for(let _=0;_<ue.nbinsy;++_){let C=0;for(let L=O;L<ce;++L)C+=le.getBinContent(L+1,_+1);P.setBinContent(_+1,C)}P.fTitle="Y projection "+(O+1===ce?`bin ${ce}`:`bins [${O+1} .. ${ce}]`),ue.tt_handle&&(x=ue.tt_handle.j1+1,v=ue.tt_handle.j2)}if(x<v){const _=P.fXaxis;_.fFirst=x,_.fLast=v,(1===_.fFirst&&_.fLast===_.fNbins)===_.TestBit(et.rb.kAxisRange)&&_.InvertBit(et.rb.kAxisRange)}P.fEntries=0,P.fTsumw=0};if(!ue.proj_hist)switch(ue.is_projection){case"X":ue.proj_hist=Y();break;case"XY":ue.proj_hist=Y(),ue.proj_hist2=V();break;default:ue.proj_hist=V()}return"XY"===ue.is_projection?(D("X",ue.proj_hist),D("Y",ue.proj_hist2),ue.drawInSpecialArea(ue.proj_hist,"","X").then(()=>ue.drawInSpecialArea(ue.proj_hist2,"","Y")).then(w=>(delete ue.doing_projection,w))):(D(ue.is_projection,ue.proj_hist),ue.drawInSpecialArea(ue.proj_hist).then(w=>(delete ue.doing_projection,w)))})()}executeMenuCommand(O,ce){return!!super.executeMenuCommand(O,ce)||("SetShowProjectionX"===O.fName||"SetShowProjectionY"===O.fName?(this.toggleProjection(O.fName[17],ce&&parseInt(ce)?parseInt(ce):1),!0):"SetShowProjectionXY"===O.fName&&(this.toggleProjection("X"+ce.replaceAll(",","_Y")),!0))}fillHistContextMenu(O){if(!this.isTH2Poly()&&this.getPadPainter()?.iscan){let ie=this.is_projection||"";ie&&(ie+=this.projection_widthX),this.projection_widthX!==this.projection_widthY&&"XY"===this.is_projection&&(ie=`X${this.projection_widthX}_Y${this.projection_widthY}`);const he=["X1","X2","X3","X5","X10","Y1","Y2","Y3","Y5","Y10","XY1","XY2","XY3","XY5","XY10"];ie&&he.unshift("Off"),O.add("sub:Projections",()=>O.input("Input projection kind X1 or XY2 or X3_Y4",ie,"string").then(ue=>this.toggleProjection(ue)));for(let ue=0;ue<he.length;++ue)O.addchk(ie===he[ue],he[ue],he[ue],fe=>this.toggleProjection(fe));O.add("endsub:")}this.isTH2Poly()||O.add("Auto zoom-in",()=>this.autoZoom());const ce=this.getSupportedDrawOptions();O.addDrawMenu("Draw with",ce,ie=>{if(0===ie.indexOf(b.kInspect))return this.showInspector(ie);const he=this.options.Project;this.decodeOptions(ie),he===this.options.Project||this.mode3d?this.interactiveRedraw("pad","drawopt"):this.toggleProjection(this.options.Project)}),(this.options.Color||this.options.Contour||this.options.Hist||this.options.Surf||12===this.options.Lego||14===this.options.Lego)&&this.fillPaletteMenu(O,!0)}clickButton(O){const ce=super.clickButton(O);if(ce)return ce;if(this.isMainPainter())switch(O){case"ToggleColor":return this.toggleColor();case"ToggleColorZ":return this.toggleColz();case"Toggle3D":return this.toggleMode3D()}return!1}fillToolbar(){super.fillToolbar(!0);const O=this.getPadPainter();O&&(!this.isTH2Poly()&&!this.options.Axis&&O.addPadButton("th2color","Toggle color","ToggleColor"),this.options.Axis||O.addPadButton("th2colorz","Toggle color palette","ToggleColorZ"),O.addPadButton("th2draw3d","Toggle 3D mode","Toggle3D"),O.showPadButtons())}toggleColor(){return this.options.Mode3D?(this.options.Mode3D=!1,this.options.Color=!0):(this.options.Color=!this.options.Color,this.options.Scat=!this.options.Color),this._can_move_colz=!0,this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}autoZoom(){if(this.isTH2Poly())return;const O=this.getSelectIndex("x","left",-1),ce=this.getSelectIndex("x","right",1),ie=this.getSelectIndex("y","left",-1),he=this.getSelectIndex("y","right",1),ue=this.getObject();if(O===ce||ie===he)return;let fe=ue.getBinContent(O+1,ie+1);for(let C=O;C<ce;++C)for(let L=ie;L<he;++L)fe=Math.min(fe,ue.getBinContent(C+1,L+1));if(fe>0)return;let le=ce,Y=O,V=he,D=ie;for(let C=O;C<ce;++C)for(let L=ie;L<he;++L)ue.getBinContent(C+1,L+1)>fe&&(C<le&&(le=C),C>=Y&&(Y=C+1),L<V&&(V=L),L>=D&&(D=L+1));let w,P,x,v,_=!1;return le===Y-1&&le>O+1&&Y<ce-1&&(le--,Y++),V===D-1&&V>ie+1&&D<he-1&&(V--,D++),(le>O||Y<ce)&&le<Y-1&&(w=ue.fXaxis.GetBinLowEdge(le+1),P=ue.fXaxis.GetBinLowEdge(Y+1),_=!0),(V>ie||D<he)&&V<D-1&&(x=ue.fYaxis.GetBinLowEdge(V+1),v=ue.fYaxis.GetBinLowEdge(D+1),_=!0),_?this.getFramePainter().zoom(w,P,x,v):void 0}scanContent(O){if(O&&this.nbinsx&&this.nbinsy)return;const ce=this.getObject();let ie,he;if(this.extractAxesProperties(2),this.isTH2Poly()){this.gminposbin=null,this.gminbin=this.gmaxbin=0;for(let fe=0,le=ce.fBins.arr.length;fe<le;++fe){const Y=ce.fBins.arr[fe].fContent;0===fe&&(this.gminbin=this.gmaxbin=Y),Y<this.gminbin?this.gminbin=Y:Y>this.gmaxbin&&(this.gmaxbin=Y),Y>0&&(null===this.gminposbin||this.gminposbin>Y)&&(this.gminposbin=Y)}}else for(this.gminbin=this.gmaxbin=ce.getBinContent(1,1),this.gminposbin=null,ie=0;ie<this.nbinsx;++ie)for(he=0;he<this.nbinsy;++he){const fe=ce.getBinContent(ie+1,he+1);fe<this.gminbin?this.gminbin=fe:fe>this.gmaxbin&&(this.gmaxbin=fe),fe>0&&(null===this.gminposbin||this.gminposbin>fe)&&(this.gminposbin=fe)}null===this.gminposbin&&this.gmaxbin>0&&(this.gminposbin=1e-4*this.gmaxbin);const ue=0!==this.gmaxbin||0!==this.gminbin;this.options.Axis>0?this.draw_content=!1:this.isTH2Poly()?(this.draw_content=ue||this.options.Line||this.options.Fill||this.options.Mark,!this.draw_content&&this.options.Zero&&(this.draw_content=!0,this.options.Line=1)):this.draw_content=ue}countStat(O,ce){(0,b.isFunc)(O)||(O=this.options.cutg?(A,R)=>this.options.cutg.IsInside(A,R):null);const ie=this.getHisto(),he=ie.fXaxis,ue=ie.fYaxis,fe=this.getFramePainter(),le=fe.getGrFuncs(this.options.second_x,this.options.second_y),Y={name:ie.fName,entries:0,eff_entries:0,integral:0,meanx:0,meany:0,rmsx:0,rmsy:0,matrix:[0,0,0,0,0,0,0,0,0],xmax:0,ymax:0,wmax:null,skewx:0,skewy:0,skewd:0,kurtx:0,kurty:0,kurtd:0},V=!fe.isAxisZoomed("x")&&!fe.isAxisZoomed("y")&&Math.abs(ie.fTsumw)>1e-300&&!O;let C,L,F,U,j,te,N,m,I,D=0,w=0,P=0,x=0,v=0,_=0;if(this.isTH2Poly()){const A=ie.fBins.arr.length;let R,k,J,_e,be,Te,Pe;for(R=0;R<A;++R){for(k=ie.fBins.arr[R],C=k.fXmin>le.scale_xmax?2:k.fXmax<le.scale_xmin?0:1,L=k.fYmin>le.scale_ymax?2:k.fYmax<le.scale_ymin?0:1,F=U=Pe=0,_e=k.fPoly,Te=1,_e._typename===b.clTMultiGraph&&(Te=k.fPoly.fGraphs.arr.length,_e=null),be=0;be<Te;++be)for((!_e||be>0)&&(_e=k.fPoly.fGraphs.arr[be]),J=0;J<_e.fNpoints;++J)++Pe,F+=_e.fX[J],U+=_e.fY[J];Pe>1&&(F/=Pe,U/=Pe),j=k.fContent,Y.entries+=j,Y.matrix[3*L+C]+=j,1===C&&1===L&&(!O||O(F,U))&&((null===Y.wmax||j>Y.wmax)&&(Y.wmax=j,Y.xmax=F,Y.ymax=U),V||(D+=j,w+=j*j,P+=F*j,x+=U*j,v+=F*F*j,_+=U*U*j))}}else{te=this.getSelectIndex("x","left"),N=this.getSelectIndex("x","right"),m=this.getSelectIndex("y","left"),I=this.getSelectIndex("y","right");for(let A=0;A<=this.nbinsx+1;++A){C=A<=te?0:A>N?2:1,F=he.GetBinCoord(A-.5);for(let R=0;R<=this.nbinsy+1;++R)L=R<=m?0:R>I?2:1,U=ue.GetBinCoord(R-.5),j=ie.getBinContent(A,R),Y.entries+=j,Y.matrix[3*L+C]+=j,1===C&&1===L&&(!O||O(F,U))&&((null===Y.wmax||j>Y.wmax)&&(Y.wmax=j,Y.xmax=F,Y.ymax=U),V||(D+=j,w+=j*j,P+=F*j,x+=U*j,v+=F**2*j,_+=U**2*j))}}if(V&&(D=ie.fTsumw,w=ie.fTsumw2,P=ie.fTsumwx,v=ie.fTsumwx2,x=ie.fTsumwy,_=ie.fTsumwy2),Math.abs(D)>1e-300&&(Y.meanx=P/D,Y.meany=x/D,Y.rmsx=Math.sqrt(Math.abs(v/D-Y.meanx**2)),Y.rmsy=Math.sqrt(Math.abs(_/D-Y.meany**2))),null===Y.wmax&&(Y.wmax=0),Y.integral=D,ie.fEntries>1&&(Y.entries=ie.fEntries),Y.eff_entries=w?D*D/w:Math.abs(D),ce&&!this.isTH2Poly()){let A=0,R=0,k=0,J=0,_e=0,be=0;for(let Q=te;Q<N;++Q){F=he.GetBinCoord(Q+.5);for(let Ke=m;Ke<I;++Ke)U=ue.GetBinCoord(Ke+.5),(!O||O(F,U))&&(be=ie.getBinContent(Q+1,Ke+1),_e+=be,A+=be*Math.pow(F-Y.meanx,3),R+=be*Math.pow(U-Y.meany,3),k+=be*Math.pow(F-Y.meanx,4),J+=be*Math.pow(U-Y.meany,4))}const Te=Math.pow(Y.rmsx,3),Pe=Math.pow(Y.rmsy,3),We=Math.pow(Y.rmsx,4),dt=Math.pow(Y.rmsy,4);_e*Te!=0&&(Y.skewx=A/(_e*Te)),_e*Pe!=0&&(Y.skewy=R/(_e*Pe)),Y.skewd=Y.eff_entries>0?Math.sqrt(6/Y.eff_entries):0,_e*We!=0&&(Y.kurtx=k/(_e*We)-3),_e*dt!=0&&(Y.kurty=J/(_e*dt)-3),Y.kurtd=Y.eff_entries>0?Math.sqrt(24/Y.eff_entries):0}return Y}fillStatistic(O,ce,ie){if(this.isIgnoreStatsFill())return!1;1===ce&&(ce=1111);const he=Math.floor(ce%10),ue=Math.floor(ce/10)%10,fe=Math.floor(ce/100)%10,le=Math.floor(ce/1e3)%10,Y=Math.floor(ce/1e4)%10,V=Math.floor(ce/1e5)%10,D=Math.floor(ce/1e6)%10,w=Math.floor(ce/1e7)%10,P=Math.floor(ce/1e8)%10,x=this.countStat(void 0,w>0||P>0);if(O.clearPave(),he>0&&O.addText(x.name),ue>0&&O.addText("Entries = "+O.format(x.entries,"entries")),fe>0&&(O.addText("Mean x = "+O.format(x.meanx)),O.addText("Mean y = "+O.format(x.meany))),le>0&&(O.addText("Std Dev x = "+O.format(x.rmsx)),O.addText("Std Dev y = "+O.format(x.rmsy))),D>0&&O.addText("Integral = "+O.format(x.matrix[4],"entries")),2===w?(O.addText(`Skewness x = ${O.format(x.skewx)} #pm ${O.format(x.skewd)}`),O.addText(`Skewness y = ${O.format(x.skewy)} #pm ${O.format(x.skewd)}`)):w>0&&(O.addText(`Skewness x = ${O.format(x.skewx)}`),O.addText(`Skewness y = ${O.format(x.skewy)}`)),2===P?(O.addText(`Kurtosis x = ${O.format(x.kurtx)} #pm ${O.format(x.kurtd)}`),O.addText(`Kurtosis y = ${O.format(x.kurty)} #pm ${O.format(x.kurtd)}`)):P>0&&(O.addText(`Kurtosis x = ${O.format(x.kurtx)}`),O.addText(`Kurtosis y = ${O.format(x.kurty)}`)),Y>0||V>0){const v=_=>x.matrix[_].toFixed(0);O.addText(`${v(6)} | ${v(7)} | ${v(7)}`),O.addText(`${v(3)} | ${v(4)} | ${v(5)}`),O.addText(`${v(0)} | ${v(1)} | ${v(2)}`)}return ie&&O.fillFunctionStat(this.findFunction(b.clTF2),ie,2),!0}drawBinsColor(){const O=this.getHisto(),ce=this.prepareDraw(),ie=this.getContour(),he=this.getHistPalette(),ue=[],fe=this._show_empty_bins,le=1===ce.xbar2&&0===ce.xbar1,Y=1===ce.ybar2&&0===ce.ybar1;let V,D,w,P,x,v,_,C=null,L=!this.options.Zero;const F=this.options.cutg,U=()=>{C.path+=`h${V}v${C.y1-C.y2}h${-V}z`,C=null};!L&&!fe&&null===ie.getPaletteIndex(he,0)&&(L=!0);for(let j=ce.i1;j<ce.i2;++j){V=ce.grx[j+1]-ce.grx[j]||1,le?w=ce.grx[j]:(w=Math.round(ce.grx[j]+V*ce.xbar1),V=Math.round(V*(ce.xbar2-ce.xbar1))||1);for(let te=ce.j2-1;te>=ce.j1;--te){if(x=O.getBinContent(j+1,te+1),v=0===x,v&&L||F&&!F.IsInside(O.fXaxis.GetBinCoord(j+.5),O.fYaxis.GetBinCoord(te+.5))){C&&U();continue}if(_=ie.getPaletteIndex(he,x),null===_){if(!v||!fe){C&&U();continue}_=0}D=ce.gry[te]-ce.gry[te+1]||1,Y?P=ce.gry[te+1]:(P=Math.round(ce.gry[te]-D*ce.ybar2),D=Math.round(D*(ce.ybar2-ce.ybar1))||1);const N=`M${w},${P}`;let m=ue[_];if(m){if(Y&&m===C){m.y1=P+D;continue}{const I=w-m.x1,A=P-m.y2;if(I||A){const R=`m${I},${A}`;m.path+=R.length<N.length?R:N}}}else m=ue[_]={path:N};C&&U(),m.x1=w,m.y2=P,Y?(m.y1=P+D,C=m):m.path+=`h${V}v${D}h${-V}z`}C&&U()}return ue.forEach((j,te)=>{j&&this.draw_g.append("svg:path").attr("fill",he.getColor(te)).attr("d",j.path)}),ce}drawBinsProjected(){const O=this.prepareDraw({rounding:!1,nozoom:!0,extra:100,original:!0}),ce=this.getFramePainter(),ie=ce.getGrFuncs(this.options.second_x,this.options.second_y),he=this.getContourLevels(),ue=this.getHistPalette(),fe=ce.getProjectionFunc();return O.grz=le=>le,O.grz_min=he[0],O.grz_max=he[he.length-1],Re(this.getHisto(),O,he,(le,Y)=>{let D,w,V="";for(let P=0;P<Y.length;P+=3){const x=fe(Y[P],Y[P+1]),v=Math.round(ie.grx(x.x)),_=Math.round(ie.gry(x.y));if(0===P)V=`M${v},${_}`;else{if(v===D&&_===w)continue;V+=P%9==0?`m${v-D},${_-w}`:_===w?"h"+(v-D):v===D?"v"+(_-w):`l${v-D},${_-w}`}D=v,w=_}this.draw_g.append("svg:path").attr("d",V).style("fill",ue.calcColor(le,he.length))}),O}drawBinsContour(){const O=this.prepareDraw({rounding:!1,extra:100}),ce=this.getFramePainter(),ie=ce.getFrameWidth(),he=ce.getFrameHeight(),ue=this.getContourLevels(),fe=this.getHistPalette(),le=(V,D)=>{const w=V.x2-V.x1,P=V.y2-V.y1,x=D.x2-D.x1,v=D.y2-D.y1,_=w*v-x*P;if(0===_)return 0;const C=_>0,L=V.x1-D.x1,F=V.y1-D.y1,U=w*F-P*L;if(U<0===C)return null;const j=x*F-v*L;if(j<0===C||U>_===C||j>_===C)return null;const te=j/_;return{x:Math.round(V.x1+te*w),y:Math.round(V.y1+te*P)}},Y=(V,D,w,P,x,v)=>{let C,L,F,U,te,N,m,_="",j=!1;for(let Pe=w;Pe<=P;++Pe){if(N=Math.round(V[Pe]),m=Math.round(D[Pe]),_)if(Pe===P&&w!==P&&N===F&&m===U){if(!j)return"";_+="z",x=!1,te=!0}else{const We=N-C,dt=m-L;We?(j=!0,_+=dt?`l${We},${dt}`:`h${We}`):dt&&(j=!0,_+=`v${dt}`)}else _=`M${N},${m}`,F=N,U=m;C=N,L=m}if(!x||te||!v)return x?_+"z":_;const I=[{x:0,y:0},{x:ie,y:0},{x:ie,y:he},{x:0,y:he}],A=(Pe,We)=>{const dt={x1:V[Pe],y1:D[Pe],x2:2*V[Pe]-V[Pe+We],y2:2*D[Pe]-D[Pe+We]};for(let Q=0;Q<4;++Q){const Ke=le(dt,{x1:I[Q].x,y1:I[Q].y,x2:I[(Q+1)%4].x,y2:I[(Q+1)%4].y});if(Ke)return Ke.indx=Q+.5,Ke}return null};let R,k;for(w--;w<P-1&&!R;)R=A(++w,1);if(!R)return"";for(P++;w<P-1&&!k;)k=A(--P,-1);if(!k)return"";let J=Y(V,D,w,P),_e=k.indx;for(J+=`L${k.x},${k.y}`;Math.abs(_e-R.indx)>.1;)_e=Math.round(_e+.5)%4,J+=`L${I[_e].x},${I[_e].y}`,_e+=.5;return J+`L${R.x},${R.y}z`};return 14===this.options.Contour&&this.draw_g.append("svg:path").attr("d",`M0,0h${ie}v${he}h${-ie}z`).style("fill",fe.calcColor(0,ue.length)),Xe(this.getHisto(),O,ue,fe,(V,D,w,P,x,v)=>{const _=fe.getColor(V);let L,C=_;switch(this.options.Contour){case 1:case 14:break;case 11:C="none",L=this.createAttLine({color:_,std:!1});break;case 12:C="none",L=this.createAttLine({color:1,style:v%5+1,width:1,std:!1});break;case 13:C="none",L=this.lineatt}const F=Y(D,w,P,x,"none"!==C,!0);if(!F)return;const U=this.draw_g.append("svg:path").attr("d",F).style("fill",C);L&&U.call(L.func)}),O.hide_only_zeros=!0,O}getGrNPoints(O){const ce=O.fX,ie=O.fY;let he=O.fNpoints;return he>2&&ce[0]===ce[he-1]&&ie[0]===ie[he-1]&&he--,he}createPolyGr(O,ce,ie){let he="",ue=0,fe=0;const le=ce.fX,Y=ce.fY,V=()=>{ue&&(he+="h"+ue,ue=0),fe&&(he+="v"+fe,fe=0)},D=(C,L,F,U)=>{const j=Math.sqrt((C-F)**2+(L-U)**2);ie.sumx+=(C+F)*j/2,ie.sumy+=(L+U)*j/2,ie.sum+=j},w=this.getGrNPoints(ce);if(w<2)return"";const P=Math.round(O.grx(le[0])),x=Math.round(O.gry(Y[0]));let v=P,_=x;for(let C=1;C<w;++C){const L=Math.round(O.grx(le[C])),F=Math.round(O.gry(Y[C])),U=L-v,j=F-_;ie&&D(v,_,L,F),(U||j)&&(0===U?((0===fe||j<0!=fe<0)&&V(),fe+=j):0===j?((0===ue||U<0!=ue<0)&&V(),ue+=U):(V(),he+=`l${U},${j}`),v=L,_=F)}return ie&&D(v,_,P,x),V(),he?`M${P},${x}`+he+"z":""}createPolyBin(O,ce){const ie=ce.fPoly._typename===b.clTMultiGraph?ce.fPoly.fGraphs.arr:[ce.fPoly];let he="";for(let ue=0;ue<ie.length;++ue)he+=this.createPolyGr(O,ie[ue]);return he}drawPolyBins(){var O=this;return(0,ve.A)(function*(){const ce=O.getObject(),ie=O.getFramePainter(),he=ie.getGrFuncs(O.options.second_x,O.options.second_y),ue=O.options.Color||!O.options.Line&&!O.options.Fill&&!O.options.Text&&!O.options.Mark,fe=O.options.Line||O.options.Text&&!ue,le=O.options.Fill&&!ue,Y=O.options.Mark,V=ie.getFrameHeight(),D=[],w=ce.fBins.arr.length;let P,x,C,L,F,v="",_="",U=null,j=fe,te=le,N=Y;O.maxbin=O.gmaxbin,O.minbin=O.gminbin,O.minposbin=O.gminposbin;const m=ue?O.getContour(!0):null,I=m?O.getHistPalette():null,A=Te=>Te.fXmin>he.scale_xmax||Te.fXmax<he.scale_xmin||Te.fYmin>he.scale_ymax||Te.fYmax<he.scale_ymin;for(F=0;F<w;++F){if(C=ce.fBins.arr[F],A(C))continue;const Te=C.fPoly._typename===b.clTMultiGraph?C.fPoly.fGraphs.arr:[C.fPoly];for(let Pe=0;Pe<Te.length;++Pe){const We=Te[Pe];U?(j&&(U.fLineColor!==We.fLineColor||U.fLineWidth!==We.fLineWidth||U.fLineStyle!==We.fLineStyle)&&(j=!1),te&&(U.fFillColor!==We.fFillColor||U.fFillStyle!==We.fFillStyle)&&(te=!1),N&&(U.fMarkerColor!==We.fMarkerColor||U.fMarkerStyle!==We.fMarkerStyle||U.fMarkerSize!==We.fMarkerSize)&&(N=!1)):U=We}if(!j&&!te&&!N)break}const R=j&&U?O.createAttLine(U):null,k=te&&U?O.createAttFill(U):null,J=N&&U?O.createAttMarker({attr:U,style:O.options.MarkStyle,std:!1}):null,_e=!ue&&(!fe||j)&&(!le||te);for(F=0;F<w;++F){if(C=ce.fBins.arr[F],A(C))continue;const Te=C.fContent||O.options.Zero,Pe=C.fPoly._typename===b.clTMultiGraph?C.fPoly.fGraphs.arr:[C.fPoly];P=ue&&Te?m.getPaletteIndex(I,C.fContent):null;const We=O.options.Text&&Te?{bin:C,sumx:0,sumy:0,sum:0}:null;for(let dt=0;dt<Pe.length;++dt){const Q=Pe[dt];if(J){const Ke=O.getGrNPoints(Q);for(let Ze=0;Ze<Ke;++Ze)_+=J.create(he.grx(Q.fX[Ze]),he.gry(Q.fY[Ze]))}x=O.createPolyGr(he,Q,We),x&&(_e?v+=x:(null!==P||le||fe)&&(L=O.draw_g.append("svg:path").attr("d",x),ue&&null!==P?L.style("fill",O._color_palette.getColor(P)):le?L.call("fill",O.createAttFill(Q).func):L.style("fill","none"),fe&&L.call(O.createAttLine(Q).func)))}We?.sum&&D.push(We)}if(_e&&(L=O.draw_g.append("svg:path").attr("d",v),le&&k?L.call(k.func):L.style("fill","none"),fe&&R&&L.call(R.func)),J&&!J.empty()&&_)O.draw_g.append("svg:path").attr("d",_).call(J.func);else if(Y)for(F=0;F<w;++F){if(C=ce.fBins.arr[F],A(C))continue;const Te=C.fPoly._typename===b.clTMultiGraph?C.fPoly.fGraphs.arr:[C.fPoly];for(let Pe=0;Pe<Te.length;++Pe){const We=Te[Pe],dt=O.getGrNPoints(We),Q=O.createAttMarker({attr:We,style:O.options.MarkStyle,std:!1});if(!dt||Q.empty())continue;let Ke="";for(let Ze=0;Ze<dt;++Ze)Ke+=Q.create(he.grx(We.fX[Ze]),he.gry(We.fY[Ze]));O.draw_g.append("svg:path").attr("d",Ke).call(Q.func)}}let be=Promise.resolve(!0);if(D.length>0){const Te=O.getColor(ce.fMarkerColor),Pe=-1*O.options.TextAngle,We=O.draw_g.append("svg:g").attr("class","th2poly_text"),dt=1!==ce.fMarkerSize&&Pe?Math.round(.02*V*ce.fMarkerSize):12;for(O.startTextDrawing(42,dt,We,dt),F=0;F<D.length;++F){const Q=D[F];let Ke;C=Q.bin,Q.sum>0?(Q.midx=Math.round(Q.sumx/Q.sum),Q.midy=Math.round(Q.sumy/Q.sum)):(Q.midx=Math.round(he.grx((C.fXmin+C.fXmax)/2)),Q.midy=Math.round(he.gry((C.fYmin+C.fYmax)/2))),O.options.TextKind?(Ke=C.fPoly?.fName,(!Ke||"Graph"===Ke)&&(Ke=C.fNumber.toString())):Ke=Math.round(C.fContent)===C.fContent?C.fContent.toString():(0,xe.lg)(C.fContent,b.gStyle.fPaintTextFormat),O.drawText({align:22,x:Q.midx,y:Q.midy,rotate:Pe,text:Ke,color:Te,latex:0,draw_g:We})}be=O.finishTextDrawing(We,!0)}return be.then(()=>({poly:!0}))})()}drawBinsText(O){var ce=this;return(0,ve.A)(function*(){const ie=ce.getObject(),he=ce.options.cutg,ue=ce.getColor(ie.fMarkerColor),fe=-1*ce.options.TextAngle,le=ce.draw_g.append("svg:g").attr("class","th2_text"),Y="E"===ce.options.TextKind,V=Y&&!ce.options.TextLine?1:0;let D,w,P,x,v=20,_=0;O||(O=ce.prepareDraw({rounding:!1})),1!==ie.fMarkerSize&&fe&&(v=Math.round(.02*ie.fMarkerSize*ce.getFramePainter().getFrameHeight())),0!==ie.fBarOffset&&(_=.001*ie.fBarOffset),ce.startTextDrawing(42,v,le,v);for(let C=O.i1;C<O.i2;++C){const L=O.grx[C+1]-O.grx[C];for(let F=O.j1;F<O.j2;++F){const U=ie.getBinContent(C+1,F+1);if(0===U&&!ce._show_empty_bins||he&&!he.IsInside(ie.fXaxis.GetBinCoord(C+.5),ie.fYaxis.GetBinCoord(F+.5)))continue;const j=O.gry[F]-O.gry[F+1];let te=U===Math.round(U)?U.toString():(0,xe.lg)(U,b.gStyle.fPaintTextFormat);if(Y){const N=ie.getBinError(ie.getBin(C+1,F+1)),m=N===Math.round(N)?N.toString():(0,xe.lg)(N,b.gStyle.fPaintTextFormat);ce.options.TextLine?te+="\xb1"+m:te=`#splitline{${te}}{#pm${m}}`}fe?(D=Math.round(O.grx[C]+.5*L),w=Math.round(O.gry[F+1]+j*(.5+_)),P=x=0):(D=Math.round(O.grx[C]+.1*L),w=Math.round(O.gry[F+1]+j*(.1+_)),P=Math.round(.8*L),x=Math.round(.8*j)),ce.drawText({align:22,x:D,y:w,width:P,height:x,rotate:fe,text:te,color:ue,latex:V,draw_g:le})}}return O.hide_only_zeros=!0,ce.finishTextDrawing(le,!0).then(()=>O)})()}drawBinsArrow(){const O=this.getObject(),ce=this.options.cutg,ie=this.prepareDraw({rounding:!1}),he=(ie.grx[ie.i2]-ie.grx[ie.i1])/(ie.i2-ie.i1+1)/2,ue=(ie.gry[ie.j2]-ie.gry[ie.j1])/(ie.j2-ie.j1+1)/2,fe=(I,A)=>I?A?`l${I},${A}`:`h${I}`:A?`v${A}`:"";let le,Y,D,w,P,x,_,C,L,F,U,j,te,N,m,V=1e-30,v="";for(let I=0;I<2;++I)for(le=ie.i1;le<ie.i2;++le)for(Y=ie.j1;Y<ie.j2;++Y)ce&&!ce.IsInside(O.fXaxis.GetBinCoord(le+.5),O.fYaxis.GetBinCoord(Y+.5))||(D=le===ie.i1?O.getBinContent(le+2,Y+1)-O.getBinContent(le+1,Y+1):le===ie.i2-1?O.getBinContent(le+1,Y+1)-O.getBinContent(le,Y+1):.5*(O.getBinContent(le+2,Y+1)-O.getBinContent(le,Y+1)),w=Y===ie.j1?O.getBinContent(le+1,Y+2)-O.getBinContent(le+1,Y+1):Y===ie.j2-1?O.getBinContent(le+1,Y+1)-O.getBinContent(le+1,Y):.5*(O.getBinContent(le+1,Y+2)-O.getBinContent(le+1,Y)),0===I?V=Math.max(V,Math.abs(D),Math.abs(w)):(P=(ie.grx[le]+ie.grx[le+1])/2,x=(ie.gry[Y]+ie.gry[Y+1])/2,_=he*D/V,C=ue*w/V,L=P-_,F=P+_,U=x-C,j=x+C,D=Math.round(F-L),w=Math.round(j-U),(D||w)&&(v+=`M${Math.round(L)},${Math.round(U)}${fe(D,w)}`,(Math.abs(D)>5||Math.abs(w)>5)&&(te=Math.sqrt(9/(D**2+w**2)),N=Math.round(te*(D+w)),m=Math.round(te*(D-w)),(N||m)&&(v+=`m${-N},${m}${fe(N,-m)}${fe(-m,-N)}`)))));return this.draw_g.append("svg:path").attr("d",v).style("fill","none").call(this.lineatt.func),ie}drawBinsBox(){const O=this.getObject(),ce=this.prepareDraw({rounding:!1}),ie=this.getMainPainter();ie===this&&(ie.maxbin===ie.minbin&&(ie.maxbin=ie.gmaxbin,ie.minbin=ie.gminbin,ie.minposbin=ie.gminposbin),ie.maxbin===ie.minbin&&(ie.minbin=Math.min(0,ie.maxbin-1)));const he=Math.max(Math.abs(ie.maxbin),Math.abs(ie.minbin)),ue=Math.max(0,ie.minbin),fe=this.getPadPainter().getRootPad(!0),le=this.options.cutg;let Y,V,D,w,C,L,F,U,j,te,N,m,P="",x="",v="",_="",I=!1,A=0;if((fe?.fLogv??fe?.fLogz)&&he>0){I=!0;const R=Math.log(he);A=ue>0?Math.log(ue):ie.minposbin>=1&&ie.minposbin<100?Math.log(.7):ie.minposbin>0?Math.log(.7*ie.minposbin):R-10,A>=R&&(A=R-10),m=1/(R-A)}else m=1/(he-ue);for(Y=ce.i1;Y<ce.i2;++Y)for(V=ce.j1;V<ce.j2;++V)if(D=O.getBinContent(Y+1,V+1),w=Math.abs(D),!(0===w||w<ue)&&(!le||le.IsInside(O.fXaxis.GetBinCoord(Y+.5),O.fYaxis.GetBinCoord(V+.5)))&&(C=I?w>0?Math.log(w)-A:0:w-ue,C=.5*(C<0?1:1-Math.sqrt(C*m)),C<0&&(C=0),te=ce.grx[Y+1]-ce.grx[Y],N=ce.gry[V]-ce.gry[V+1],L=C*te,F=C*N,U=Math.round(ce.grx[Y]+L),j=Math.round(ce.gry[V+1]+F),te=Math.max(Math.round(te-2*L),1),N=Math.max(Math.round(N-2*F),1),P+=`M${U},${j}v${N}h${te}v${-N}z`,D<0&&10===this.options.BoxStyle&&(x+=`M${U},${j}l${te},${N}m0,${-N}l${-te},${N}`),11===this.options.BoxStyle&&te>5&&N>5)){const R=Math.round(.1*te),k=Math.round(.1*N),J=`M${U},${j}h${te}l${-R},${k}h${2*R-te}v${N-2*k}l${-R},${k}z`,_e=`M${U+te},${j+N}v${-N}l${-R},${k}v${N-2*k}h${2*R-te}l${-R},${k}z`;v+=D<0?_e:J,_+=D<0?J:_e}if(P){const R=this.draw_g.append("svg:path").attr("d",P).call(this.fillatt.func);11!==this.options.BoxStyle&&this.fillatt.empty()&&R.call(this.lineatt.func)}if(v&&this.fillatt.hasColor()&&this.draw_g.append("svg:path").attr("d",v).call(this.fillatt.func).style("fill",(0,z.Qh)(this.fillatt.color).brighter(.5).formatHex()),_&&this.draw_g.append("svg:path").attr("d",_).call(this.fillatt.func).style("fill",this.fillatt.hasColor()?(0,z.Qh)(this.fillatt.color).darker(.5).formatHex():"red"),x){const R=this.draw_g.append("svg:path").attr("d",x).style("fill","none");this.lineatt.empty()?R.style("stroke","black"):R.call(this.lineatt.func)}return ce}drawBinsCandle(){let te=0;const N=dn=>{let yn=1;for(;dn>=yn;)yn*=10;return yn/=10,Math.floor(te/yn)%10===Math.floor(dn/yn)},m=(dn,yn)=>{let Tn="",Hn="",ti=0;const hi=dn[0],ai=dn[1];if(hi>="A"&&hi<="Z"&&(Tn=hi),hi>="1"&&hi<="9"&&(Hn=hi),ai>="A"&&ai<="Z"&&Hn&&(Tn=ai),ai>="1"&&ai<="9"&&Tn&&(Hn=ai),yn)switch(Hn){case"1":default:ti+=11311;break;case"2":ti+=112111;break;case"3":ti+=112311;break;case"4":ti+=112321;break;case"5":ti+=212111;break;case"6":ti+=312311}else switch(Hn){case"1":default:ti+=13001300;break;case"2":ti+=13102300}const Xi=dn.indexOf("("),Or=dn.lastIndexOf(")");Xi>=0&&Or>Xi+1&&(ti=parseInt(dn.slice(Xi+1,Or))),te=ti,("Y"===Tn||"H"===Tn)&&!N(1e8)&&(te+=1e8)};this.options.Candle?m(this.options.Candle,!0):this.options.Violin&&m(this.options.Violin,!1);const A=this.getHisto(),R=this.prepareDraw(),k=this.getFramePainter(),J=this.getCanvPainter(),_e=k.getGrFuncs(this.options.second_x,this.options.second_y),be=N(1e8);let Oe,lt,Te="",Pe="",We="",dt="",Q="",Ke="",Ze="",Ue=null,gt=b.gStyle.fViolinScaled,ht=b.gStyle.fCandleScaled,st=0,yt=0;if(null!==this.options.Scaled?gt=ht=this.options.Scaled:J?.online_canvas||(A.fTitle.indexOf("unscaled")>=0?gt=ht=!1:A.fTitle.indexOf("scaled")>=0&&(gt=ht=!0)),gt&&(N(2e6)||N(1e6)||N(3e6)))for(let dn=0;dn<this.nbinsx;++dn)for(let yn=0;yn<this.nbinsy;++yn)st=Math.max(st,A.getBinContent(dn+1,yn+1));const Kt=(...dn)=>{"array"===dn[1]&&(dn=dn[0]);const yn=dn.length;let Tn=2,Hn=dn[0],ti=dn[1],hi=be?`M${ti},${Hn}`:`M${Hn},${ti}`;for(;Tn<yn;){switch(dn[Tn]){case"Z":return hi+"z";case"V":ti!==dn[Tn+1]&&(hi+=(be?"h":"v")+(dn[Tn+1]-ti),ti=dn[Tn+1]);break;case"H":Hn!==dn[Tn+1]&&(hi+=(be?"v":"h")+(dn[Tn+1]-Hn),Hn=dn[Tn+1]);break;default:hi+=be?`l${dn[Tn+1]-ti},${dn[Tn]-Hn}`:`l${dn[Tn]-Hn},${dn[Tn+1]-ti}`,Hn=dn[Tn],ti=dn[Tn+1]}Tn+=2}return hi},Ot=(dn,yn)=>{Ke||(this.createAttMarker({attr:A,style:N(3e5)?0:5}),this.markeratt.resetPos()),Ke+=be?this.markeratt.create(yn,dn):this.markeratt.create(dn,yn)},It=(dn,yn)=>{Ue||(Ue=this.createAttMarker({attr:A,style:24,std:!1}),Ue.resetPos()),Ze+=be?Ue.create(yn,dn):Ue.create(dn,yn)};1===A.fMarkerColor&&(A.fMarkerColor=A.fLineColor),R.candle=[];const An=b.gStyle.fCandleWhiskerRange,on=b.gStyle.fCandleBoxRange,pn=[An>=1?1e-15:.5-An/2,on>=1?1e-14:.5-on/2,.5,on>=1?1-1e-14:.5+on/2,An>=1?1-1e-15:.5+An/2],Qt=(dn,yn,Tn,Hn,ti)=>{const hi=((dn,yn,Tn)=>{let Hn=0,ti=0,hi=0;const ai={max:0,first:-1,last:-1,entries:0};for(let Xi=0;Xi<yn.length;++Xi)yn[Xi]>0&&(ai.max=Math.max(ai.max,yn[Xi]),ai.first<0&&(ai.first=Xi),ai.last=Xi),Hn+=yn[Xi],hi+=yn[Xi]*(dn[Xi]+dn[Xi+1])/2;if(Hn<=0)return null;ai.entries=Hn,ai.mean=hi/Hn,ai.quantiles=new Array(Tn.length),ai.indx=new Array(Tn.length);for(let Xi=0,Or=0,Tr=0;Xi<yn.length;++Xi){const ys=Tr;let ds=dn[Xi];if(ys===Tn[ti]&&0===yn[Xi]&&ys<.99){for(;0===yn[Xi]&&Xi<yn.length;)Xi++;ds=(dn[Xi]+ds)/2}for(Or+=yn[Xi],Tr=Or/Hn;Tn[ti]>=ys&&Tn[ti]<Tr;){if(ai.indx[ti]=Xi,ai.quantiles[ti]=ds+(Tn[ti]-ys)/(Tr-ys)*(dn[Xi+1]-ds),ti++===Tn.length)return ai;ds=dn[Xi]}}for(;ti<Tn.length;)ai.indx[ti]=yn.length-1,ai.quantiles[ti++]=dn[dn.length-1];return ai})(Oe,lt,pn);if(!hi)return;const ai={bin:dn,swapXY:be,fBoxDown:hi.quantiles[1],fMedian:hi.quantiles[2],fBoxUp:hi.quantiles[3]},Xi=ai.fBoxUp-ai.fBoxDown;let Or=hi.quantiles[0],Tr=hi.quantiles[4];if(N(2e3)){let jt=ai.fBoxDown-1.5*Xi,Cn=hi.indx[1];for(;Oe[Cn]>jt&&Cn>0;)Cn--;for(;!lt[Cn];)Cn++;for(Or=Oe[Cn],jt=ai.fBoxUp+1.5*Xi,Cn=hi.indx[3];Oe[Cn]<jt&&Cn<lt.length;)Cn++;for(;!lt[Cn];)Cn--;Tr=Oe[Cn+1]}const ys=hi.mean,ds=1.57*Xi/Math.sqrt(hi.entries);if(Or<=0&&(be&&_e.logx||!be&&_e.logy))return;const wt=Tn-yn;let W,pe,me=(yn+Tn)/2+A.fBarOffset/1e3*wt;A.fBarWidth>0&&1e3!==A.fBarWidth?W=pe=wt*A.fBarWidth/1e3:(W=.66*wt,pe=.8*wt),gt&&st>0&&(pe*=hi.max/st),ht&&yt>0&&(W*=hi.entries/yt),ai.x1=Math.round(me-W/2),ai.x2=Math.round(me+W/2),me=Math.round(me);const Fe=Math.round(me-W/3),At=Math.round(me+W/3),Et=be?_e.grx:_e.gry;ai.yy1=Math.round(Et(Tr)),ai.y1=Math.round(Et(ai.fBoxUp)),ai.y0=Math.round(Et(ai.fMedian)),ai.y2=Math.round(Et(ai.fBoxDown)),ai.yy2=Math.round(Et(Or));const St=Math.round(Et(ys)),xt=Math.round(Et(ai.fMedian+ds)),En=Math.round(Et(ai.fMedian-ds));if(N(1e7)&&(Q+=Kt(me,Math.round(Et(Oe[Hn])),"V",Math.round(Et(Oe[ti])))),N(10)?Pe+=Kt(ai.x1,ai.y0,"H",ai.x2):N(20)?Pe+=Kt(Fe,ai.y0,"H",At):N(30)&&It(me,ai.y0),N(300)?It(me,St):N(100)&&(We+=Kt(ai.x1,St,"H",ai.x2)),N(1)&&(N(20)?Te+=Kt(ai.x1,ai.y1,"V",xt,Fe,ai.y0,ai.x1,En,"V",ai.y2,"H",ai.x2,"V",En,At,ai.y0,ai.x2,xt,"V",ai.y1,"Z"):Te+=Kt(ai.x1,ai.y1,"V",ai.y2,"H",ai.x2,"V",ai.y1,"Z")),N(1e4)&&(Pe+=Kt(ai.x1,ai.yy1,"H",ai.x2)+Kt(ai.x1,ai.yy2,"H",ai.x2)),N(1e3)&&!N(1e7)?We+=Kt(me,ai.y1,"V",ai.yy1)+Kt(me,ai.y2,"V",ai.yy2):(N(1e3)&&N(1e7)||N(2e3))&&(Pe+=Kt(me,ai.y1,"V",ai.yy1)+Kt(me,ai.y2,"V",ai.yy2)),N(1e5)||N(2e5)||N(3e5)){const jt=new xe.YF(7521*dn+Math.round(hi.integral)),Cn=!N(1e5),ln=N(3e5);for(let Un=0;Un<lt.length;++Un){const Ci=lt[Un],Rn=(Oe[Un]+Oe[Un+1])/2;let si=me,Fn=0;if(Ci&&!(!Cn&&Rn>=Or&&Rn<=Tr))for(let Zt=0;Zt<Ci;Zt++)ln&&(si=me+Math.round((jt.random()-.5)*W)),Fn=1!==Ci||ln?Math.round(Et(Oe[Un]+jt.random()*(Oe[Un+1]-Oe[Un]))):Math.round(Et(Rn)),Ot(si,Fn)}}if((N(2e6)||N(1e6)||N(3e6))&&hi.max>0&&hi.first>=0){const jt=[],Cn=(be?-.5:.5)*pe/hi.max;if(Hn=Math.max(Hn,hi.first),ti=Math.min(ti-1,hi.last),N(2e6)||N(3e6)){let ln=me,Un=Math.round(Et(Oe[Hn]));jt.push(ln,Un);for(let Ci=Hn;Ci<=ti;Ci++){const Rn=Math.round(me+Cn*lt[Ci]),si=Math.round(Et(Oe[Ci+1]));Rn!==ln&&(Ci!==Hn&&jt.push("V",Un),jt.push("H",Rn)),ln=Rn,Un=si}jt.push("V",Un)}if(N(1e6)||N(3e6)){let ln=me,Un=Math.round(Et(Oe[ti+1]));0===jt.length&&jt.push(ln,Un);for(let Ci=ti;Ci>=Hn;Ci--){const Rn=Math.round(me-Cn*lt[Ci]),si=Math.round(Et(Oe[Ci]));Rn!==ln&&(Ci!==ti&&jt.push("V",Un),jt.push("H",Rn)),ln=Rn,Un=si}jt.push("V",Un)}jt.push("H",me),dt+=Kt(jt,"array"),this.fillatt.empty()||(dt+="Z")}R.candle.push(ai)};if(be){Oe=new Array(this.nbinsx+1),lt=new Array(this.nbinsx);for(let dn=0;dn<this.nbinsx+1;++dn)Oe[dn]=A.fXaxis.GetBinLowEdge(dn+1);if(ht)for(let dn=0;dn<this.nbinsy;++dn){let yn=0;for(let Tn=0;Tn<this.nbinsx;++Tn)yn+=A.getBinContent(Tn+1,dn+1);yt=Math.max(yt,yn)}for(let dn=R.j1;dn<R.j2;++dn){for(let yn=0;yn<this.nbinsx;++yn)lt[yn]=A.getBinContent(yn+1,dn+1);Qt(dn,R.gry[dn+1],R.gry[dn],R.i1,R.i2)}}else{Oe=new Array(this.nbinsy+1),lt=new Array(this.nbinsy);for(let dn=0;dn<this.nbinsy+1;++dn)Oe[dn]=A.fYaxis.GetBinLowEdge(dn+1);if(ht)for(let dn=0;dn<this.nbinsx;++dn){let yn=0;for(let Tn=0;Tn<this.nbinsy;++Tn)yn+=A.getBinContent(dn+1,Tn+1);yt=Math.max(yt,yn)}for(let dn=R.i1;dn<R.i2;++dn){for(let yn=0;yn<this.nbinsy;++yn)lt[yn]=A.getBinContent(dn+1,yn+1);Qt(dn,R.grx[dn],R.grx[dn+1],R.j1,R.j2)}}Q&&A.fFillColor>0&&this.draw_g.append("svg:path").attr("d",Q).style("stroke",this.getColor(A.fFillColor));const Bn=N(1e7)&&0!==A.fFillStyle?this.fillatt.color:this.lineatt.color;if(dt&&(!this.fillatt.empty()||"none"!==Bn)&&this.draw_g.append("svg:path").attr("d",dt).style("stroke","none"!==Bn?Bn:null).style("pointer-events",this.isBatchMode()?null:"visibleFill").call(this.fillatt.func),Te&&this.draw_g.append("svg:path").attr("d",Te).call(this.lineatt.func).call(this.fillatt.func),Pe&&this.draw_g.append("svg:path").attr("d",Pe).call(this.lineatt.func).style("fill","none"),We){const dn=this.createAttLine({attr:A,style:2,std:!1,color:ke.tA});this.draw_g.append("svg:path").attr("d",We).call(dn.func).style("fill","none")}return Ze&&this.draw_g.append("svg:path").attr("d",Ze).call(Ue.func),Ke&&this.draw_g.append("svg:path").attr("d",Ke).call(this.markeratt.func),R}drawBinsScatter(){const O=this.getObject(),ce=this.prepareDraw({rounding:!0,pixel_density:!0}),ie=this.options.cutg,he=[],ue=[],fe=[],le=[],Y=[],V=this.options.ScatCoef*(this.gmaxbin>2e3?2e3/this.gmaxbin:1),D=new xe.YF(ce.sumz);let w,P,x,v,_,C,L,F,U=1;if(ce.ScatterPlot=!0,V*ce.sumz<1e5){this.createAttMarker({attr:O}),this.markeratt.resetPos();let I="";for(v=ce.i1;v<ce.i2;++v)for(L=ce.grx[v+1]-ce.grx[v],_=ce.j1;_<ce.j2;++_){F=ce.gry[_]-ce.gry[_+1],C=O.getBinContent(v+1,_+1);const A=Math.round(V*C);if(!(A<=0)&&(!ie||ie.IsInside(O.fXaxis.GetBinCoord(v+.5),O.fYaxis.GetBinCoord(_+.5))))for(let R=0;R<A;++R)I+=this.markeratt.create(Math.round(ce.grx[v]+L*D.random()),Math.round(ce.gry[_+1]+F*D.random()))}return this.draw_g.append("svg:path").attr("d",I).call(this.markeratt.func),ce}this.maxbin>.7&&(U=.7/this.maxbin);const j=Math.round(ce.max-ce.min),te=this.createContour(j>50?50:j,this.minposbin,this.maxbin,this.minposbin);for(v=ce.i1;v<ce.i2;++v)for(_=ce.j1;_<ce.j2;++_)C=O.getBinContent(v+1,_+1),!(C<=0||C<this.minbin)&&(L=ce.grx[v+1]-ce.grx[v],F=ce.gry[_]-ce.gry[_+1],!(L*F<=0)&&(w=te.getContourIndex(C/L/F),!(w<0)&&(ie&&!ie.IsInside(O.fXaxis.GetBinCoord(v+.5),O.fYaxis.GetBinCoord(_+.5))||(P=`M${ce.grx[v]},${ce.gry[_+1]}`,void 0===he[w]?(he[w]=P,le[w]=L,Y[w]=F):(x=`m${ce.grx[v]-ue[w]},${ce.gry[_+1]-fe[w]}`,he[w]+=x.length<P.length?x:P,le[w]=Math.max(le[w],L),Y[w]=Math.max(Y[w],F)),ue[w]=ce.grx[v],fe[w]=ce.gry[_+1],he[w]+=`v${F}h${L}v${-F}z`))));const N=this.getFrameSvg().selectChild(".main_layer");let m=N.selectChild("defs");for(m.empty()&&he.length>0&&(m=N.insert("svg:defs",":first-child")),this.createAttMarker({attr:O}),w=0;w<he.length;++w)if(void 0!==he[w]&&w<te.arr.length){const I=(this.pad_name||"canv")+`_scatter_${w}`;let A=m.selectChild(`#${I}`);A.empty()?A=m.append("svg:pattern").attr("id",I).attr("patternUnits","userSpaceOnUse"):A.selectAll("*").remove();let R=Math.round(U*te.arr[w]*le[w]*Y[w]);R<1&&(R=1);const k=new Float32Array(R),J=new Float32Array(R);if(1===R)k[0]=J[0]=.5;else for(let be=0;be<R;++be)k[be]=D.random(),J[be]=D.random();this.markeratt.resetPos();let _e="";for(let be=0;be<R;++be)_e+=this.markeratt.create(k[be]*le[w],J[be]*Y[w]);A.attr("width",le[w]).attr("height",Y[w]).append("svg:path").attr("d",_e).call(this.markeratt.func),this.draw_g.append("svg:path").attr("scatter-index",w).style("fill",`url(#${I})`).attr("d",he[w])}return ce}draw2DBins(){if(this._hide_frame&&this.isMainPainter()&&(this.getFrameSvg().style("display",null),delete this._hide_frame),!this.draw_content)return this.removeG();let O,ce;if(this.createHistDrawAttributes(),this.createG(!0),this.isTH2Poly()?ce=this.drawPolyBins():(this.options.Scat&&(O=this.drawBinsScatter()),this.options.Color?O=this.drawBinsColor():this.options.Box?O=this.drawBinsBox():this.options.Arrow?O=this.drawBinsArrow():this.options.Proj?O=this.drawBinsProjected():this.options.Contour?O=this.drawBinsContour():(this.options.Candle||this.options.Violin)&&(O=this.drawBinsCandle()),this.options.Text&&(ce=this.drawBinsText(O)),!O&&!ce&&(O=this.drawBinsColor())),O)this.tt_handle=O;else if(ce)return ce.then(ie=>{this.tt_handle=ie})}drawBinsCircular(){this.getFrameSvg().style("display","none"),this._hide_frame=!0;const O=this.getPadPainter().getFrameRect(),ce=this.getHisto(),ie=this.options.Circular>10?this.getHistPalette():null,fe=ce.fXaxis,le=x=>{if(fe.fLabels)for(let v=0;v<fe.fLabels.arr.length;++v){const _=fe.fLabels.arr[v];if(_.fUniqueID===x+1)return _.fString}return x.toString()};this.createG(),(0,xe.bk)(this.draw_g,Math.round(O.x+O.width/2),Math.round(O.y+O.height/2));const Y=Math.min(this.nbinsx,this.nbinsy);this.startTextDrawing(42,20,this.draw_g);const V=[];for(let x=0;x<Y;x++){const v=(.5-x/Y)*Math.PI*2,_=Math.round((.9*O.width/2-32)*Math.cos(v)),C=Math.round((.9*O.height/2-32)*Math.sin(v)),L=Math.round(.9*O.width/2*Math.cos(v)),F=Math.round(.9*O.height/2*Math.sin(v)),U=ie?.calcColor(x,Y)??"black";let j=Math.round(v/Math.PI*180),te=12;V.push({x:_,y:C,a:v,color:U}),(j<-90||j>90)&&(j+=180,te=32);const N=Math.round(10),m=2*N;this.draw_g.append("path").attr("d",`M${_-N},${C} a${N},${N},0,1,0,${m},0a${N},${N},0,1,0,${-m},0z`).style("stroke",U).style("fill","none"),this.drawText({align:te,rotate:j,x:L,y:F,text:le(x)})}let w=0,P=0;if(this.options.Circular>11)for(let x=0;x<Y-1;++x)for(let v=x+1;v<Y;++v){const _=ce.getBinContent(x+1,v+1);_>0&&(w=Math.max(w,_),(!P||_<P)&&(P=_))}for(let x=0;x<Y-1;++x){const v=V[x];let _="";for(let C=x+1;C<Y;++C){const L=ce.getBinContent(x+1,C+1);if(L<=0)continue;const F=V[C],U=(v.a+F.a)/2,j=.5*(1-Math.abs(v.a-F.a)/Math.PI),te=Math.round(j*O.width/2*Math.cos(U)),N=Math.round(j*O.height/2*Math.sin(U));if(_+=`M${v.x},${v.y}Q${te},${N},${F.x},${F.y}`,this.options.Circular>11&&w>P){const m=Math.round((L-P)/(w-P)*7+1);this.draw_g.append("path").attr("d",_).style("stroke",v.color).style("stroke-width",m).style("fill","none"),_=""}}_&&this.draw_g.append("path").attr("d",_).style("stroke",v.color).style("fill","none")}return this.finishTextDrawing()}drawBinsChord(){var O=this;return(0,ve.A)(function*(){O.getFrameSvg().style("display","none"),O._hide_frame=!0;const ce=[],ie=Math.min(O.nbinsx,O.nbinsy),he=O.getHisto();let ue=0,fe=!0;for(let R=0;R<ie;++R){let k=0;for(let J=0;J<ie;++J){const _e=he.getBinContent(R+1,J+1);_e>0&&(k+=_e,fe&&Math.round(_e)!==_e&&(fe=!1))}k>0&&ce.push(R),ue+=k}if(ce.length<2)return!0;let le=0,Y=1;const V=O.getPadPainter().getFrameRect(),D=O.getHistPalette(),w=Math.max(10,.5*Math.min(V.width,V.height)-60),P=Math.max(2,w-10),x=[],v=[],_=R=>D.calcColor(R,ce.length),C=R=>R.toString(),F=(R,k)=>k<R?-1:k>R?1:k>=R?0:Number.NaN;if(!fe&&ue<10){const R=Math.round(Math.log10(ue)-2.3);le=-R,Y=Math.pow(10,R)}else if(ue>200){const R=Math.round(Math.log10(ue)-2.3);Y=Math.pow(10,R)}250*Y<ue?Y*=5:100*Y<ue&&(Y*=2);for(let R=0;R<ce.length;++R){x[R]=[];for(let _e=0;_e<ce.length;++_e)x[R].push(he.getBinContent(ce[R]+1,ce[_e]+1));const k=he.fXaxis;let J="indx_"+ce[R].toString();if(k.fLabels)for(let _e=0;_e<k.fLabels.arr.length;++_e){const be=k.fLabels.arr[_e];if(be.fUniqueID===ce[R]+1){J=be.fString;break}}v.push(J)}O.createG(),(0,xe.bk)(O.draw_g,Math.round(V.x+V.width/2),Math.round(V.y+V.height/2));const j=(0,z.JQ)().padAngle(10/P).sortSubgroups(F).sortChords(F)(x),te=O.draw_g.append("g").attr("font-size",10).attr("font-family","sans-serif").selectAll("g").data(j.groups).join("g"),N=(0,z.JL)().innerRadius(P).outerRadius(w),m=(0,z.F6)().radius(P-1).padAngle(1/P);te.append("path").attr("fill",R=>_(R.index)).attr("d",N),te.append("title").text(R=>`${v[R.index]} ${C(R.value)}`);const A=te.append("g").selectAll("g").data(function I({startAngle:R,endAngle:k,value:J}){const _e=(k-R)/J,be=[];for(let Te=0;Te<=J;Te+=Y)be.push({value:Te,angle:Te*_e+R});return be}).join("g").attr("transform",R=>`rotate(${Math.round(180*R.angle/Math.PI-90)}) translate(${w})`);return A.append("line").attr("stroke","currentColor").attr("x2",6),A.append("text").attr("x",8).attr("dy","0.35em").attr("transform",R=>R.angle>Math.PI?"rotate(180) translate(-16)":null).attr("text-anchor",R=>R.angle>Math.PI?"end":null).text(R=>(R=>le>3?R.toExponential(0):R.toFixed(le))(R.value)),te.select("text").attr("font-weight","bold").text(function(R){return"end"===this.getAttribute("text-anchor")?`\u2191 ${v[R.index]}`:`${v[R.index]} \u2193`}),O.draw_g.append("g").attr("fill-opacity",.8).selectAll("path").data(j).join("path").style("mix-blend-mode","multiply").attr("fill",R=>_(R.source.index)).attr("d",m).append("title").text(R=>`${C(R.source.value)} ${v[R.target.index]} \u2192 ${v[R.source.index]}${R.source.index===R.target.index?"":`\n${C(R.target.value)} ${v[R.source.index]} \u2192 ${v[R.target.index]}`}`),!0})()}getBinTooltips(O,ce){const ie=this.getHisto();let he=ie.getBinContent(O+1,ce+1);ie.$baseh&&(he-=ie.$baseh.getBinContent(O+1,ce+1));const ue=[this.getObjectHint(),"x = "+this.getAxisBinTip("x",ie.fXaxis,O),"y = "+this.getAxisBinTip("y",ie.fYaxis,ce),`bin = ${ie.getBin(O+1,ce+1)}  x: ${O+1}  y: ${ce+1}`,"entries = "+(he===Math.round(he)?he:(0,xe.lg)(he,b.gStyle.fStatFormat))];if("E"===this.options.TextKind||this.matchObjectType(b.clTProfile2D)){const fe=ie.getBinError(ie.getBin(O+1,ce+1));ue.push("error = "+(fe===Math.round(fe)?fe.toString():(0,xe.lg)(fe,b.gStyle.fPaintTextFormat)))}return ue}getCandleTooltips(O){const ie=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),he=this.getHisto();return[this.getObjectHint(),O.swapXY?"y = "+ie.axisAsText("y",he.fYaxis.GetBinLowEdge(O.bin+1)):"x = "+ie.axisAsText("x",he.fXaxis.GetBinLowEdge(O.bin+1)),"m-25%  = "+(0,xe.lg)(O.fBoxDown,b.gStyle.fStatFormat),"median = "+(0,xe.lg)(O.fMedian,b.gStyle.fStatFormat),"m+25%  = "+(0,xe.lg)(O.fBoxUp,b.gStyle.fStatFormat)]}getPolyBinTooltips(O,ce,ie){const ue=this.getHisto().fBins.arr[O],le=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),Y=[];let V=ue.fPoly.fName,D=0;if("Graph"===V&&(V=""),0===V.length&&(V=ue.fNumber),void 0===ce&&void 0===ie){ce=ie=0;let w=ue.fPoly,P=1;w._typename===b.clTMultiGraph&&(P=ue.fPoly.fGraphs.arr.length,w=null);for(let x=0;x<P;++x){(!w||x>0)&&(w=ue.fPoly.fGraphs.arr[x]);for(let v=0;v<w.fNpoints;++v)++D,ce+=w.fX[v],ie+=w.fY[v]}D>1&&(ce/=D,ie/=D)}return Y.push(this.getObjectHint(),"x = "+le.axisAsText("x",ce),"y = "+le.axisAsText("y",ie)),D>0&&Y.push("npnts = "+D),Y.push(`bin = ${V}`),ue.fContent===Math.round(ue.fContent)?Y.push("content = "+ue.fContent):Y.push("content = "+(0,xe.lg)(ue.fContent,b.gStyle.fStatFormat)),Y}processTooltipEvent(O){const ce=this.getHisto(),ie=this.tt_handle;let he=this.draw_g?.selectChild(".tooltip_bin");if(!O||!this.draw_content||!this.draw_g||!ie||this.options.Proj)return he?.remove(),null;if(ie.poly){const j=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),te=j.revertAxis("x",O.x),N=j.revertAxis("y",O.y);let I,m=-1;if(void 0!==te&&void 0!==N){const R=ce.fBins.arr.length;for(let k=0;k<R&&m<0;++k){if(I=ce.fBins.arr[k],te<I.fXmin||te>I.fXmax||N<I.fYmin||N>I.fYmax||!I.fContent&&!this.options.Zero)continue;let J=I.fPoly,_e=1;J._typename===b.clTMultiGraph&&(_e=I.fPoly.fGraphs.arr.length,J=null);for(let be=0;be<_e;++be)if((!J||be>0)&&(J=I.fPoly.fGraphs.arr[be]),J.IsInside(te,N)){m=k;break}}}if(m<0)return he.remove(),null;const A={name:ce.fName,title:ce.fTitle,x:O.x,y:O.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",exact:!0,menu:!0,lines:this.getPolyBinTooltips(m,te,N)};return O.disabled?(he.remove(),A.changed=!0):(he.empty()&&(he=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(xe.Ru)),A.changed=he.property("current_bin")!==m,A.changed&&he.attr("d",this.createPolyBin(j,I)).style("opacity","0.7").property("current_bin",m)),A.changed&&(A.user_info={obj:ce,name:ce.fName,bin:m,cont:I.fContent,grx:O.x,gry:O.y}),A}if(ie.candle){let U,j,te;for(U=0;U<ie.candle.length&&(j=ie.candle[U],te=j.swapXY?j.x1<=O.y&&O.y<=j.x2&&j.yy1>=O.x&&O.x>=j.yy2:j.x1<=O.x&&O.x<=j.x2&&j.yy1<=O.y&&O.y<=j.yy2,!te);++U);if(!te)return he.remove(),null;const N={name:ce.fName,title:ce.fTitle,x:O.x,y:O.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getCandleTooltips(j),exact:!0,menu:!0};return O.disabled?(he.remove(),N.changed=!0):(he.empty()&&(he=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(xe.Ru).style("opacity","0.7")),N.changed=he.property("current_bin")!==U,N.changed&&he.attr("d",j.swapXY?`M${j.yy1},${j.x1}H${j.yy2}V${j.x2}H${j.yy1}Z`:`M${j.x1},${j.yy1}H${j.x2}V${j.yy2}H${j.x1}Z`).property("current_bin",U)),N.changed&&(N.user_info={obj:ce,name:ce.fName,bin:U+1,cont:j.fMedian,binx:U+1,biny:1,grx:O.x,gry:O.y}),N}const ue=this.getFramePainter();let fe,le,D,w,P,x,v,_,C,L,Y=0,V=null;if(ue.reverse_x)for(fe=ie.i1;fe<ie.i2&&!(O.x<=ie.grx[fe]&&O.x>=ie.grx[fe+1]);++fe);else for(fe=ie.i1;fe<ie.i2&&!(O.x>=ie.grx[fe]&&O.x<=ie.grx[fe+1]);++fe);if(ue.reverse_y)for(le=ie.j1;le<ie.j2&&!(O.y<=ie.gry[le+1]&&O.y>=ie.gry[le]);++le);else for(le=ie.j1;le<ie.j2&&!(O.y>=ie.gry[le+1]&&O.y<=ie.gry[le]);++le);if(fe<ie.i2&&le<ie.j2){D=fe,w=fe+1,P=le,x=le+1,v=ie.grx[D],_=ie.grx[w],C=ie.gry[x],L=ie.gry[P];let U=!0;if(this.options.Color){const j=_-v,te=L-C;_=Math.round(v+j*ie.xbar2),v=Math.round(v+j*ie.xbar1),L=Math.round(C+te*ie.ybar2),C=Math.round(C+te*ie.ybar1),ue.reverse_x?(O.x>v||O.x<=_)&&(U=!1):(O.x<v||O.x>=_)&&(U=!1),ue.reverse_y?(O.y>C||O.y<=L)&&(U=!1):(O.y<C||O.y>=L)&&(U=!1)}Y=ce.getBinContent(fe+1,le+1),this.is_projection?V=0:U?ie.hide_only_zeros?V=0!==Y||this._show_empty_bins?0:null:(V=this.getContour().getPaletteIndex(this.getHistPalette(),Y),null===V&&0===Y&&this._show_empty_bins&&(V=0)):V=null}if(null===V)return he.remove(),null;const F={name:ce.fName,title:ce.fTitle,x:O.x,y:O.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getBinTooltips(fe,le),exact:!0,menu:!0};if(this.options.Color&&(F.color2=this.getHistPalette().getColor(V)),O.disabled&&!this.is_projection)he.remove(),F.changed=!0;else{he.empty()&&(he=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(xe.Ru));let j,U=1e4*fe+le;if(this.is_projection){const te=this.projection_widthX||1,N=(te-1)/2;this.is_projection.indexOf("X")>=0&&te>1&&(x+N>=ie.j2?(x=Math.min(Math.round(x+N),ie.j2),P=Math.max(x-te,ie.j1)):(P=Math.max(Math.round(P-N),ie.j1),x=Math.min(P+te,ie.j2)));const m=this.projection_widthY||1,I=(m-1)/2;this.is_projection.indexOf("Y")>=0&&m>1&&(w+I>=ie.i2?(w=Math.min(Math.round(w+I),ie.i2),D=Math.max(w-m,ie.i1)):(D=Math.max(Math.round(D-I),ie.i1),w=Math.min(D+m,ie.i2)))}"X"===this.is_projection?(v=0,_=ue.getFrameWidth(),C=ie.gry[x],L=ie.gry[P],U=777*P+333*x):"Y"===this.is_projection?(C=0,L=ue.getFrameHeight(),v=ie.grx[D],_=ie.grx[w],U=777*D+333*w):"XY"===this.is_projection&&(C=ie.gry[x],L=ie.gry[P],v=ie.grx[D],_=ie.grx[w],U=789*D+653*w+12345*P+654321*x,j=`M${v},0H${_}V${C}H${ue.getFrameWidth()}V${L}H${_}V${ue.getFrameHeight()}H${v}V${L}H0V${C}H${v}Z`),F.changed=he.property("current_bin")!==U,F.changed&&he.attr("d",j||`M${v},${C}H${_}V${L}H${v}Z`).style("opacity","0.7").property("current_bin",U),this.is_projection&&F.changed&&this.redrawProjection(D,w,P,x)}return F.changed&&(F.user_info={obj:ce,name:ce.fName,bin:ce.getBin(fe+1,le+1),cont:Y,binx:fe+1,biny:le+1,grx:O.x,gry:O.y}),F}canZoomInside(O,ce,ie){if("z"===O||this.options.Proj)return!0;let he=this.getHisto();return he&&(he="y"===O?he.fYaxis:he.fXaxis),!he||he.FindBin(ie,.5)-he.FindBin(ce,0)>1}completePalette(O){return!O||(O.$main_painter=this,this.options.Zvert=O._palette_vertical,O.drawPave(this.options.Cjust?"cjust":""))}draw2D(){var O=this;return(0,ve.A)(function*(){O.clear3DScene();const ce=O.options.Zscale&&O.options.canHavePalette();return O.drawColorPalette(ce,!0).then(function(){var ie=(0,ve.A)(function*(he){let ue;return ue=O.options.Circular&&O.isMainPainter()?O.drawBinsCircular():O.options.Chord&&O.isMainPainter()?O.drawBinsChord():O.drawAxes().then(()=>O.draw2DBins()),ue.then(()=>O.completePalette(he))});return function(he){return ie.apply(this,arguments)}}()).then(()=>O.updateFunctions()).then(()=>O.updateHistTitle()).then(()=>(O.updateStatWebCanvas(),O.addInteractivity()))})()}draw3D(O){var ce=this;return(0,ve.A)(function*(){return console.log("3D drawing is disabled, load ./hist/TH2Painter.mjs"),ce.draw2D(O)})()}callDrawFunc(O){var ce=this;return(0,ve.A)(function*(){const ie=ce.getMainPainter(),he=ce.getFramePainter();return ie!==ce&&he&&he.mode3d!==ce.options.Mode3D&&ce.copyOptionsFrom(ie),ce.options.Mode3D?ce.draw3D(O):ce.draw2D(O)})()}redraw(O){var ce=this;return(0,ve.A)(function*(){return ce.callDrawFunc(O)})()}static draw(O,ce,ie){return(0,ve.A)(function*(){return Je.mf._drawHist(new He(O,ce),ie)})()}}},3277:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{Ee:()=>ot,Z8:()=>ce,ZE:()=>He,eP:()=>ie,ef:()=>Re,kH:()=>Ie,m:()=>Xe,mf:()=>le});var ve=Ee(467),b=Ee(6998),z=Ee(6823),ke=Ee(9041),xe=Ee(6224),et=Ee(4485),Je=Ee(9025);const Xe=1,ot=2,Re=3,He=4,Ie=5;class O{constructor(){this.reset()}reset(){Object.assign(this,{Axis:0,RevX:!1,RevY:!1,SymlogX:0,SymlogY:0,Bar:!1,BarStyle:0,Curve:!1,Hist:1,Line:!1,Fill:!1,Error:0,ErrorKind:-1,errorX:b.gStyle.fErrorX,Mark:!1,Same:!1,Scat:!1,ScatCoef:1,Func:!0,AllFunc:!1,Arrow:!1,Box:!1,BoxStyle:0,Text:!1,TextAngle:0,TextKind:"",Char:0,Color:!1,Contour:0,Cjust:!1,Lego:0,Surf:0,Off:0,Tri:0,Proj:0,AxisPos:0,Ortho:b.gStyle.fOrthoCamera,Spec:!1,Pie:!1,List:!1,Zscale:!1,Zvert:!0,PadPalette:!1,Candle:"",Violin:"",Scaled:null,Circular:0,GLBox:0,GLColor:!1,Project:"",System:Xe,AutoColor:!1,NoStat:!1,ForceStat:!1,PadStats:!1,PadTitle:!1,AutoZoom:!1,HighRes:0,Zero:1,Palette:0,BaseLine:!1,Optimize:b.settings.OptimizeDraw,adjustFrame:!1,Mode3D:!1,x3dscale:1,y3dscale:1,Render3D:b.constants.Render3D.Default,FrontBox:!0,BackBox:!0,need_fillcol:!1,minimum:b.kNoZoom,maximum:b.kNoZoom,ymin:0,ymax:0,cutg:null,IgnoreMainScale:!1,IgnorePalette:!1})}isCartesian(){return this.System===Xe}is3d(){return this.Lego||this.Surf}decodeSumw2(V,D){const w=V.fSumw2?.length??0;let P=!1;for(let x=0;x<w;++x)if(V.fSumw2[x]>0){P=!0;break}(Number.isInteger(this.Error)||D)&&(this.Error=P?1:0),(Number.isInteger(this.Hist)||D)&&(this.Hist=P?0:1),(Number.isInteger(this.Zero)||D)&&(this.Zero=P?0:1)}canHavePalette(){return 2===this.ndim&&(this.Mode3D?12===this.Lego||14===this.Lego||11===this.Surf||12===this.Surf:!!(this.Color||this.Contour||this.Hist||this.Axis)||!(this.Scat||this.Box||this.Arrow||this.Proj||this.Candle||this.Violin||this.Text))}decode(V,D,w,P,x,v){if(this.orginal=V,this.cutg_name="",(0,b.isStr)(V)&&2===D){const te=V.lastIndexOf("["),N=V.lastIndexOf("]");te>=0&&N>te+1&&(this.cutg_name=V.slice(te+1,N),V=V.slice(0,te)+V.slice(N+1),this.cutg=P?.findInPrimitives(this.cutg_name,b.clTCutG),this.cutg&&(this.cutg.$redraw_pad=!0))}const _=new ke.nC(V);1===D&&this.decodeSumw2(w,!0),this.ndim=D||1,_.check("USE_PAD_TITLE"),_.check("USE_PAD_PALETTE"),_.check("USE_PAD_STATS"),_.check("IGNORE_PALETTE")&&(this.IgnorePalette=!0),_.check("PAL",!0)&&(this.Palette=_.partAsInt()),_.check("MINIMUM:",!0)?(this.ominimum=!0,this.minimum=parseFloat(_.part)):(this.ominimum=!1,this.minimum=w.fMinimum),_.check("MAXIMUM:",!0)?(this.omaximum=!0,this.maximum=parseFloat(_.part)):(this.omaximum=!1,this.maximum=w.fMaximum),_.check("HMIN:",!0)?(this.ohmin=!0,this.hmin=parseFloat(_.part)):(this.ohmin=!1,delete this.hmin),_.check("HMAX:",!0)?(this.ohmax=!0,this.hmax=parseFloat(_.part)):(this.ohmax=!1,delete this.hmax),this.ignore_min_max=_.check("IGNORE_MIN_MAX"),_.check("HTITLE:",!0)&&(w.fTitle=decodeURIComponent(_.part.toLowerCase())),_.check("XTITLE:",!0)&&(w.fXaxis.fTitle=decodeURIComponent(_.part.toLowerCase())),_.check("YTITLE:",!0)&&(w.fYaxis.fTitle=decodeURIComponent(_.part.toLowerCase())),_.check("ZTITLE:",!0)&&(w.fZaxis.fTitle=decodeURIComponent(_.part.toLowerCase())),_.check("_ADJUST_FRAME_")&&(this.adjustFrame=!0),_.check("NOOPTIMIZE")&&(this.Optimize=0),_.check("OPTIMIZE")&&(this.Optimize=2),_.check("AUTOCOL")&&(this.AutoColor=!0),_.check("AUTOZOOM")&&(this.AutoZoom=!0),_.check("OPTSTAT",!0)&&(this.optstat=_.partAsInt()),_.check("OPTFIT",!0)&&(this.optfit=_.partAsInt()),(this.optstat||this.optstat)&&w?.TestBit(b.kNoStats)&&w?.InvertBit(b.kNoStats),_.check("NOSTAT")&&(this.NoStat=!0),_.check("STAT")&&(this.ForceStat=!0),_.check("NOTOOLTIP")&&v&&v.setTooltipAllowed(!1),_.check("TOOLTIP")&&v&&v.setTooltipAllowed(!0),_.check("SYMLOGX",!0)&&(this.SymlogX=_.partAsInt(0,3)),_.check("SYMLOGY",!0)&&(this.SymlogY=_.partAsInt(0,3)),_.check("X3DSC",!0)&&(this.x3dscale=_.partAsInt(0,100)/100),_.check("Y3DSC",!0)&&(this.y3dscale=_.partAsInt(0,100)/100),(_.check("PERSPECTIVE")||_.check("PERSP"))&&(this.Ortho=!1),_.check("ORTHO")&&(this.Ortho=!0);let C=0,L=0,F="";_.check("LOG2XY")&&(C=L=2),_.check("LOGXY")&&(C=L=1),_.check("LOG2X")&&(C=2),_.check("LOGX")&&(C=1),_.check("LOG2Y")&&(L=2),_.check("LOGY")&&(L=1),C&&x&&(x.fLogx=C,x.fUxmin=0,x.fUxmax=1,x.fX1=0,x.fX2=1),L&&x&&(x.fLogy=L,x.fUymin=0,x.fUymax=1,x.fY1=0,x.fY2=1),_.check("LOG2Z")&&x&&(x.fLogz=2),_.check("LOGZ")&&x&&(x.fLogz=1),_.check("LOGV")&&x&&(x.fLogv=1),_.check("GRIDXY")&&x&&(x.fGridx=x.fGridy=1),_.check("GRIDX")&&x&&(x.fGridx=1),_.check("GRIDY")&&x&&(x.fGridy=1),_.check("TICKXY")&&x&&(x.fTickx=x.fTicky=1),_.check("TICKX")&&x&&(x.fTickx=1),_.check("TICKY")&&x&&(x.fTicky=1),_.check("TICKZ")&&x&&(x.fTickz=1),_.check("GRAYSCALE")&&P?.setGrayscale(!0),_.check("FILL_","color")&&(this.histoFillColor=_.color,this.histoFillPattern=1001),_.check("LINE_","color")&&(this.histoLineColor=(0,z.oU)(_.color)),_.check("XAXIS_","color")&&(w.fXaxis.fAxisColor=w.fXaxis.fLabelColor=w.fXaxis.fTitleColor=_.color),_.check("YAXIS_","color")&&(w.fYaxis.fAxisColor=w.fYaxis.fLabelColor=w.fYaxis.fTitleColor=_.color);const U=!!v&&!!v.getMainPainter();_.check("X+")&&(this.AxisPos=10,this.second_x=U),_.check("Y+")&&(this.AxisPos+=1,this.second_y=U),_.check("SAME0")&&(this.Same=!0,this.IgnoreMainScale=!0),_.check("SAMES")&&(this.Same=!0,this.ForceStat=!0),_.check("SAME")&&(this.Same=!0,this.Func=!0),_.check("SPEC")&&(this.Spec=!0),(_.check("BASE0")||_.check("MIN0")||b.gStyle.fHistMinimumZero)&&(this.BaseLine=0),_.check("PIE")&&(this.Pie=!0),_.check("CANDLE",!0)&&(this.Candle=_.part||"1"),_.check("VIOLIN",!0)&&(this.Violin=_.part||"1",delete this.Candle),_.check("NOSCALED")&&(this.Scaled=!1),_.check("SCALED")&&(this.Scaled=!0),_.check("GLBOX",!0)&&(this.GLBox=10+_.partAsInt()),_.check("GLCOL")&&(this.GLColor=!0),_.check("GL"),(_.check("CIRCULAR",!0)||_.check("CIRC",!0))&&(this.Circular=11,_.part.indexOf("0")>=0&&(this.Circular=10),_.part.indexOf("1")>=0&&(this.Circular=11),_.part.indexOf("2")>=0&&(this.Circular=12)),this.Chord=_.check("CHORD"),_.check("LEGO",!0)&&(this.Lego=1,_.part.indexOf("0")>=0&&(this.Zero=!1),_.part.indexOf("1")>=0&&(this.Lego=11),_.part.indexOf("2")>=0&&(this.Lego=12),_.part.indexOf("3")>=0&&(this.Lego=13),_.part.indexOf("4")>=0&&(this.Lego=14),F=_.part,_.part.indexOf("Z")>=0&&(this.Zscale=!0),_.part.indexOf("H")>=0&&(this.Zvert=!1)),_.check("R3D_",!0)&&(this.Render3D=b.constants.Render3D.fromString(_.part.toLowerCase())),_.check("POL")&&(this.System=ot),_.check("CYL")&&(this.System=Re),_.check("SPH")&&(this.System=He),_.check("PSR")&&(this.System=Ie),_.check("SURF",!0)&&(this.Surf=_.partAsInt(10,1),F=_.part,_.part.indexOf("Z")>=0&&(this.Zscale=!0),_.part.indexOf("H")>=0&&(this.Zvert=!1)),_.check("TF3",!0)&&(F=_.part),_.check("ISO",!0)&&(F=_.part),_.check("LIST")&&(this.List=!0),_.check("CONT",!0)&&D>1&&(this.Contour=1,_.part.indexOf("Z")>=0&&(this.Zscale=!0),_.part.indexOf("H")>=0&&(this.Zvert=!1),_.part.indexOf("1")>=0?this.Contour=11:_.part.indexOf("2")>=0?this.Contour=12:_.part.indexOf("3")>=0?this.Contour=13:_.part.indexOf("4")>=0&&(this.Contour=14)),_.check("HBAR",!0)?this.BarStyle=20:_.check("BAR",!0)&&(this.BarStyle=10),this.BarStyle>0&&(this.Hist=!1,this.need_fillcol=!0,this.BarStyle+=_.partAsInt()),_.check("ARR")&&(this.Arrow=!0),_.check("BOX",!0)&&(this.BoxStyle=10,_.part.indexOf("1")>=0?this.BoxStyle=11:_.part.indexOf("2")>=0?this.BoxStyle=12:_.part.indexOf("3")>=0&&(this.BoxStyle=13),_.part.indexOf("Z")>=0&&(this.Zscale=!0),_.part.indexOf("H")>=0&&(this.Zvert=!1)),this.Box=this.BoxStyle>0,_.check("CJUST")&&(this.Cjust=!0),_.check("COL")&&(this.Color=!0),_.check("CHAR")&&(this.Char=1),_.check("ALLFUNC")&&(this.AllFunc=!0),_.check("FUNC")&&(this.Func=!0,this.Hist=!1),_.check("AXIS")&&(this.Axis=1),_.check("AXIG")&&(this.Axis=2),_.check("TEXT",!0)&&(this.Text=!0,this.Hist=!1,this.TextAngle=Math.min(_.partAsInt(),90),_.part.indexOf("N")>=0&&(this.TextKind="N"),_.part.indexOf("E0")>=0&&(this.TextLine=!0),_.part.indexOf("E")>=0&&(this.TextKind="E")),_.check("SCAT=",!0)&&(this.Scat=!0,this.ScatCoef=parseFloat(_.part),(!Number.isFinite(this.ScatCoef)||this.ScatCoef<=0)&&(this.ScatCoef=1)),_.check("SCAT")&&(this.Scat=!0),_.check("TRI",!0)&&(this.Color=!1,this.Tri=1,F=_.part,_.part.indexOf("ERR")>=0&&(this.Error=!0)),_.check("AITOFF")&&(this.Proj=1),_.check("MERCATOR")&&(this.Proj=2),_.check("SINUSOIDAL")&&(this.Proj=3),_.check("PARABOLIC")&&(this.Proj=4),_.check("MOLLWEIDE")&&(this.Proj=5),this.Proj>0&&(this.Contour=14),_.check("PROJXY",!0)&&(this.Project="XY"+_.partAsInt(0,1)),_.check("PROJX",!0)&&(this.Project="X"+_.part),_.check("PROJY",!0)&&(this.Project="Y"+_.part),_.check("PROJ")&&(this.Project="Y1"),F&&(F.indexOf("FB")>=0&&(this.FrontBox=!1),F.indexOf("BB")>=0&&(this.BackBox=!1)),3===D&&_.check("FB")&&(this.FrontBox=!1),3===D&&_.check("BB")&&(this.BackBox=!1),_.check("PFC")&&!this._pfc&&(this._pfc=2),(_.check("PLC")||this.AutoColor)&&!this._plc&&(this._plc=2),_.check("PMC")&&!this._pmc&&(this._pmc=2);const j=(te,N,m)=>{if("fZaxis"===N&&D<3&&!this.Lego&&!this.Surf)return;let I=_.check(te);x&&x["$"+te]&&(I=!0,x["$"+te]=void 0),I&&w&&(w[N].TestBit(m)||w[N].InvertBit(m))};if(j("OTX","fXaxis",xe.rb.kOppositeTitle),j("OTY","fYaxis",xe.rb.kOppositeTitle),j("OTZ","fZaxis",xe.rb.kOppositeTitle),j("CTX","fXaxis",xe.rb.kCenterTitle),j("CTY","fYaxis",xe.rb.kCenterTitle),j("CTZ","fZaxis",xe.rb.kCenterTitle),j("MLX","fXaxis",xe.rb.kMoreLogLabels),j("MLY","fYaxis",xe.rb.kMoreLogLabels),j("MLZ","fZaxis",xe.rb.kMoreLogLabels),(_.check("RX")||x?.$RX)&&(this.RevX=!0),(_.check("RY")||x?.$RY)&&(this.RevY=!0),_.check("L")&&(this.Line=!0,this.Hist=!1),_.check("F")&&(this.Fill=!0,this.need_fillcol=!0),_.check("A")&&(this.Axis=-1),"up"===x?.$ratio_pad)this.Same||(this.Axis=0),w.fXaxis.fLabelSize=0,w.fXaxis.fTitle="",w.fYaxis.$use_top_pad=!0;else if("low"===x?.$ratio_pad){this.Same||(this.Axis=0),w.fXaxis.$use_top_pad=!0,w.fYaxis.$use_top_pad=!0,w.fXaxis.fTitle="x";const te=v?.getCanvPainter().findPainterFor(null,"upper_pad",b.clTPad)?.getFramePainter();te&&(v.zoom_xmin=te.scale_xmin,v.zoom_xmax=te.scale_xmax)}_.check("B1")&&(this.BarStyle=1,this.BaseLine=0,this.Hist=!1,this.need_fillcol=!0),_.check("B")&&(this.BarStyle=1,this.Hist=!1,this.need_fillcol=!0),_.check("C")&&(this.Curve=!0,this.Hist=!1),_.check("][")&&(this.Off=1,this.Hist=!0),_.check("HIST")&&(this.Hist=!0,this.Func=!0,this.Error=!1),this.Bar=this.BarStyle>0,delete this.MarkStyle,_.check("P0")&&(this.Mark=!0,this.Hist=!1,this.Zero=!0),_.check("P")&&(this.Mark=!0,this.Hist=!1,this.Zero=!1),_.check("HZ")&&(this.Zscale=!0,this.Zvert=!1),_.check("Z")&&(this.Zscale=!0),_.check("*")&&(this.Mark=!0,this.MarkStyle=3,this.Hist=!1),_.check("H")&&(this.Hist=!0),_.check("E",!0)&&(this.Error=!0,1===D&&(this.Zero=!1,1===this.Hist&&(this.Hist=!1),Number.isInteger(parseInt(_.part[0]))&&(this.ErrorKind=parseInt(_.part[0])),(3===this.ErrorKind||4===this.ErrorKind)&&(this.need_fillcol=!0),0===this.ErrorKind&&(this.Zero=!0),_.part.indexOf("X0")>=0&&(this.errorX=0))),_.check("9")&&(this.HighRes=1),_.check("0")&&(this.Zero=!1),this.Color&&_.check("1")&&(this.Zero=!1),(this.Lego>0||3===D||(this.Surf>0||this.Error)&&2===D)&&(this.Mode3D=!0),v?.isTF1()&&1===D&&1===this.Hist&&!this.Line&&!this.Fill&&!this.Curve&&!this.Mark&&(this.Hist=!1,this.Curve=b.settings.FuncAsCurve,this.Line=!this.Curve,this.Fill=!0),15===this.Surf&&(this.System===ot||this.System===Xe)&&(this.Surf=13)}asString(V,D){let w="",P="";return this.Zscale&&(P=this.Zvert?"Z":"HZ"),this.Mode3D?(this.Lego?(w="LEGO",this.Zero||(w+="0"),this.Lego>10&&(w+=this.Lego-10),w+=P):this.Surf&&(w="SURF"+(this.Surf-10),w+=P),this.FrontBox||(w+="FB"),this.BackBox||(w+="BB"),1!==this.x3dscale&&(w+=`_X3DSC${Math.round(100*this.x3dscale)}`),1!==this.y3dscale&&(w+=`_Y3DSC${Math.round(100*this.y3dscale)}`)):(this.Candle?w="CANDLE"+this.Candle:this.Violin?w="VIOLIN"+this.Violin:this.Scat?w="SCAT":this.Color?(w="COL",this.Zero||(w+="0"),w+=P,this.Axis<0&&(w+="A")):this.Contour?(w="CONT",this.Contour>10&&(w+=this.Contour-10),w+=P):this.Bar?w=!1===this.BaseLine?"B":"B1":this.Mark?w=this.Zero?"P0":"P":this.Line?(w+="L",this.Fill&&(w+="F")):this.Off&&(w="]["),this.Error&&(w+="E",this.ErrorKind>=0&&(w+=this.ErrorKind),0===this.errorX&&(w+="X0")),this.Cjust&&(w+=" CJUST"),!0===this.Hist&&(w+="HIST"),this.Text&&(w+="TEXT",this.TextAngle&&(w+=this.TextAngle),w+=this.TextKind)),this.Palette&&this.canHavePalette()&&(w+=`_PAL${this.Palette}`),this.is3d()&&this.Ortho&&V&&(w+="_ORTHO"),this.Same?w+=this.ForceStat?"SAMES":"SAME":V&&w&&(this.ForceStat||!0===this.StatEnabled?w+="_STAT":(this.NoStat||!1===this.StatEnabled)&&(w+="_NOSTAT")),V&&D&&w&&(2===D.fLogx?w+="_LOG2X":D.fLogx&&(w+="_LOGX"),2===D.fLogy?w+="_LOG2Y":D.fLogy&&(w+="_LOGY"),2===D.fLogz?w+="_LOG2Z":D.fLogz&&(w+="_LOGZ"),D.fGridx&&(w+="_GRIDX"),D.fGridy&&(w+="_GRIDY"),D.fTickx&&(w+="_TICKX"),D.fTicky&&(w+="_TICKY"),D.fTickz&&(w+="_TICKZ")),this.cutg_name&&(w+=` [${this.cutg_name}]`),w}}class ce{constructor(V,D){this.arr=[],this.colzmin=V,this.colzmax=D,this.below_min_indx=-1,this.exact_min_indx=0}getLevels(){return this.arr}createNormal(V,D,w){if(D){this.colzmax<=0&&(this.colzmax=1),this.colzmin<=0&&(this.colzmin=void 0===w||w<=0?1e-4*this.colzmax:w<3||w>100?.3*w:1),this.colzmin>=this.colzmax&&(this.colzmin=1e-4*this.colzmax);const P=Math.log(this.colzmin)/Math.log(10),v=(Math.log(this.colzmax)/Math.log(10)-P)/V;this.arr.push(this.colzmin);for(let _=1;_<V;_++)this.arr.push(Math.exp((P+v*_)*Math.log(10)));this.arr.push(this.colzmax),this.custom=!0}else{this.colzmin===this.colzmax&&0!==this.colzmin&&(this.colzmax+=.01*Math.abs(this.colzmax),this.colzmin-=.01*Math.abs(this.colzmin));const P=(this.colzmax-this.colzmin)/V;for(let x=0;x<=V;x++)this.arr.push(this.colzmin+P*x)}}createCustom(V){this.custom=!0;for(let D=0;D<V.length;++D)this.arr.push(V[D]);this.colzmax>this.arr[this.arr.length-1]&&this.arr.push(this.colzmax)}configIndicies(V,D){this.below_min_indx=V,this.exact_min_indx=D}getContourIndex(V){if(V<this.colzmin)return this.below_min_indx;if(V===this.colzmin)return this.exact_min_indx;if(!this.custom)return Math.floor(.01+(V-this.colzmin)*(this.arr.length-1)/(this.colzmax-this.colzmin));let D=0,w=this.arr.length-1;if(V<this.arr[0])return-1;if(V>=this.arr[w])return w;for(;D<w-1;){const P=Math.round((D+w)/2);this.arr[P]>V?w=P:D=P}return D}getPaletteColor(V,D){const w=this.getContourIndex(D);if(w<0)return null;const P=V.calcColorIndex(w,this.arr.length);return V.getColor(P)}getPaletteIndex(V,D){const w=this.getContourIndex(D);return w<0?null:V.calcColorIndex(w,this.arr.length)}}class ie{constructor(V,D,w,P){this.painter=V,this.pp=D;const x=[],v=[],_=!0===P;this.newfuncs=[],this.newopts=[],_||D?.forEachPainterInPad(C=>{C.isSecondary(V)&&C._secondary_id?.match(/^func_|^indx_/)&&x.push(C)},"objects");for(let C=0;C<w?.arr.length;++C){const L=w.arr[C],F=w.opt[C];if(!L?._typename||(0,b.isFunc)(V.needDrawFunc)&&!V.needDrawFunc(V.getObject(),L))continue;let U=null,j=-1;if(!_){for(let te=0;te<x.length;++te)if(x[te].matchObjectType(L._typename)&&x[te].getObjectName()===L.fName){U=x[te],j=te;break}!U&&L.fName&&(U=D?.findPainterFor(null,L.fName,L._typename))}U?(U.updateObject(L,F),j>=0&&(x.splice(j,1),v.push(U))):(this.newfuncs[C]=L,this.newopts[C]=F)}if((0,b.isObject)(P)){const C=x.indexOf(P);C>=0&&x.splice(C,1)}x.length>0&&D?.cleanPrimitives(C=>x.indexOf(C)>=0),v.length>0&&(this._extraPainters=v)}drawNext(V){if(this._extraPainters){const v=this._extraPainters.shift();return 0===this._extraPainters.length&&delete this._extraPainters,(0,b.getPromise)(v.redraw()).then(()=>this.drawNext(0))}if(!this.newfuncs||V>=this.newfuncs.length)return delete this.newfuncs,delete this.newopts,Promise.resolve(this.painter);const D=this.newfuncs[V],w=this.newopts[V];if(!D||this.pp?.findPainterFor(D))return this.drawNext(V+1);const P=D?.fName?`func_${D.fName}`:`indx_${V}`;return D.$main_painter=this.painter,(et.TPavePainter.canDraw(D)?et.TPavePainter.draw(this.painter.getDom(),D,w):this.pp.drawObject(this.painter.getDom(),D,w)).then(v=>(v.setSecondaryId(this.painter,P),this.drawNext(V+1)))}}const he=(0,b.BIT)(10),ue=(0,b.BIT)(16),fe=(0,b.BIT)(17);class le extends xe.JW{constructor(V,D){super(V,D),this.draw_content=!0,this.nbinsx=this.nbinsy=0,this.accept_drops=!0,this.mode3d=!1}getHisto(){return this.getObject()}getAxis(V){const D=this.getObject();switch(V){case"x":return D?.fXaxis;case"y":return D?.fYaxis;case"z":return D?.fZaxis}return null}isTProfile(){return this.matchObjectType(b.clTProfile)}isTF1(){return!1}isTH1K(){return this.matchObjectType("TH1K")}isTH2Poly(){return this.matchObjectType(/^TH2Poly/)||this.matchObjectType(/^TProfile2Poly/)}clear3DScene(){const V=this.getFramePainter();(0,b.isFunc)(V?.create3DScene)&&V.create3DScene(-1),this.mode3d=!1}cleanup(){this.clear3DScene(),delete this._color_palette,delete this.fContour,delete this.options,super.cleanup()}getDimension(){const V=this.getHisto();return V?V._typename.match(/^TH2/)||V._typename===b.clTProfile2D?2:V._typename.match(/^TH3/)||V._typename===b.clTProfile3D?3:this.isTH2Poly()?2:1:0}decodeOptions(V){const D=this.getHisto(),w=this.getDimension(),P=this.getPadPainter(),x=P?.getRootPad(!0);this.options?this.options.reset():this.options=new O,this.lineatt?.setUsed(!1),this.fillatt?.setUsed(!1),this.markeratt?.setUsed(!1),this.options.decode(V||D.fOption,w,D,P,x,this),this.storeDrawOpt(V)}copyOptionsFrom(V){if(V===this)return;const D=this.options,w=V.options;D.Mode3D=w.Mode3D,D.Zero=w.Zero,w.Mode3D?(D.Lego=w.Lego,D.Surf=w.Surf):(D.Color=w.Color,D.Contour=w.Contour)}copyOptionsToOthers(){this.forEachPainter(V=>{V!==this&&(0,b.isFunc)(V.copyOptionsFrom)&&V.copyOptionsFrom(this)},"objects")}scanContent(){}checkPadRange(){this.isMainPainter()&&(this.check_pad_range=!this.options.Same||"pad_range")}createHistDrawAttributes(V){const D=this.getHisto(),w=this.options;if(w._pfc>1||w._plc>1||w._pmc>1){const P=this.getPadPainter();if((0,b.isFunc)(P?.getAutoColor)){const x=P.getAutoColor(D.$num_histos);this._auto_exec="",w._pfc>1&&(w._pfc=1,D.fFillColor=x,this._auto_exec+=`SetFillColor(${x});;`,delete this.fillatt),w._plc>1&&(w._plc=1,D.fLineColor=x,this._auto_exec+=`SetLineColor(${x});;`,delete this.lineatt),w._pmc>1&&(w._pmc=1,D.fMarkerColor=x,this._auto_exec+=`SetMarkerColor(${x});;`,delete this.markeratt)}}V?this.deleteAttr():(this.createAttFill({attr:D,color:this.options.histoFillColor,pattern:this.options.histoFillPattern,kind:1}),this.createAttLine({attr:D,color0:this.options.histoLineColor}))}updateAxes(V,D,w){const P=(x,v,_)=>{x.fTitle=v.fTitle,x.fLabels=v.fLabels,x.fXmin=v.fXmin,x.fXmax=v.fXmax,x.fTimeDisplay=v.fTimeDisplay,x.fTimeFormat=v.fTimeFormat,x.fAxisColor=v.fAxisColor,x.fLabelColor=v.fLabelColor,x.fLabelFont=v.fLabelFont,x.fLabelOffset=v.fLabelOffset,x.fLabelSize=v.fLabelSize,x.fNdivisions=v.fNdivisions,x.fTickLength=v.fTickLength,x.fTitleColor=v.fTitleColor,x.fTitleFont=v.fTitleFont,x.fTitleOffset=v.fTitleOffset,x.fTitleSize=v.fTitleSize,_&&(x.fFirst=v.fFirst,x.fLast=v.fLast,x.fBits=v.fBits)};P(V.fXaxis,D.fXaxis,this.snapid&&!w?.zoomChangedInteractive("x")),P(V.fYaxis,D.fYaxis,this.snapid&&!w?.zoomChangedInteractive("y")),P(V.fZaxis,D.fZaxis,this.snapid&&!w?.zoomChangedInteractive("z"))}updateObject(V,D){const w=this.getHisto(),P=this.getFramePainter(),x=this.getPadPainter(),v=this.options;if(V!==w){if(!this.matchObjectType(V))return!1;const _=x?.findPainterFor(this.findStat());w.TestBit(b.kNoStats)!==V.TestBit(b.kNoStats)&&(w.InvertBit(b.kNoStats),_&&(_.Enabled=!w.TestBit(b.kNoStats)&&!this.options.NoStat)),w.TestBit(ue)!==V.TestBit(ue)&&w.InvertBit(ue),void 0!==this.snapid&&(w.fName=V.fName,v._pfc=v._plc=v._pmc=0),v._pfc||(w.fFillColor=V.fFillColor),w.fFillStyle=V.fFillStyle,v._plc||(w.fLineColor=V.fLineColor),w.fLineStyle=V.fLineStyle,w.fLineWidth=V.fLineWidth,v._pmc||(w.fMarkerColor=V.fMarkerColor),w.fMarkerSize=V.fMarkerSize,w.fMarkerStyle=V.fMarkerStyle,w.fEntries=V.fEntries,w.fTsumw=V.fTsumw,w.fTsumwx=V.fTsumwx,w.fTsumwx2=V.fTsumwx2,w.fXaxis.fNbins=V.fXaxis.fNbins,this.getDimension()>1&&(w.fTsumwy=V.fTsumwy,w.fTsumwy2=V.fTsumwy2,w.fTsumwxy=V.fTsumwxy,w.fYaxis.fNbins=V.fYaxis.fNbins,this.getDimension()>2&&(w.fTsumwz=V.fTsumwz,w.fTsumwz2=V.fTsumwz2,w.fTsumwxz=V.fTsumwxz,w.fTsumwyz=V.fTsumwyz,w.fZaxis.fNbins=V.fZaxis.fNbins)),this.updateAxes(w,V,P),w.fArray=V.fArray,w.fNcells=V.fNcells,w.fTitle=V.fTitle,w.fMinimum=V.fMinimum,w.fMaximum=V.fMaximum,w.fSumw2=V.fSumw2,v.ominimum||(v.minimum=w.fMinimum),v.omaximum||(v.maximum=w.fMaximum),1===this.getDimension()&&v.decodeSumw2(w),this.isTProfile()?w.fBinEntries=V.fBinEntries:this.isTH1K()?(w.fNIn=V.fNIn,w.fReady=0):this.isTH2Poly()&&(w.fBins=V.fBins),this._funcHandler=new ie(this,x,V.fFunctions,_);const C=w.fOption!==V.fOption;w.fOption=V.fOption,(void 0!==D&&v.original!==D||C)&&this.decodeOptions(D||w.fOption)}return v.ominimum||(v.minimum=w.fMinimum),v.omaximum||(v.maximum=w.fMaximum),(!P||!P.zoomChangedInteractive())&&this.checkPadRange(),this.scanContent(),this.histogram_updated=!0,!0}extractAxesProperties(V){const D=P=>{P.fXbins.length>=P.fNbins?(P.GetBinCoord=function(x){const v=Math.round(x);if(v<=0)return this.fXmin;if(v>this.fNbins)return this.fXmax;if(v===x)return this.fXbins[v];const _=x<v?v-1:v+1;return this.fXbins[v]*Math.abs(x-_)+this.fXbins[_]*Math.abs(x-v)},P.FindBin=function(x,v){for(let _=1;_<this.fXbins.length;++_)if(x<this.fXbins[_])return Math.floor(_-1+v);return this.fNbins}):(P.$binwidth=(P.fXmax-P.fXmin)/(P.fNbins||1),P.GetBinCoord=function(x){return this.fXmin+x*this.$binwidth},P.FindBin=function(x,v){return Math.floor((x-this.fXmin)/this.$binwidth+v)})};this.nbinsx=this.nbinsy=this.nbinsz=0;const w=this.getHisto();this.nbinsx=w.fXaxis.fNbins,this.xmin=w.fXaxis.fXmin,this.xmax=w.fXaxis.fXmax,D(w.fXaxis),this.ymin=w.fYaxis.fXmin,this.ymax=w.fYaxis.fXmax,this._exact_y_range=1===V&&this.options.ohmin&&this.options.ohmax,this._exact_y_range&&(this.ymin=this.options.hmin,this.ymax=this.options.hmax),V>1&&(this.nbinsy=w.fYaxis.fNbins,D(w.fYaxis),this.zmin=w.fZaxis.fXmin,this.zmax=w.fZaxis.fXmax,2===V&&this.options.ohmin&&this.options.ohmax&&(this.zmin=this.options.hmin,this.zmax=this.options.hmax)),V>2&&(this.nbinsz=w.fZaxis.fNbins,D(w.fZaxis))}drawAxes(){var V=this;return(0,ve.A)(function*(){const D=V.getFramePainter();if(!D)return!1;const w=V.getHisto();if(V.ymin===V.ymax&&(V.ymax+=1),!V.isMainPainter()){const x={second_x:V.options.AxisPos>=10,second_y:V.options.AxisPos%10==1,hist_painter:V};return!(!x.second_x&&!x.second_y||D.hasDrawnAxes(x.second_x,x.second_y))&&(D.setAxes2Ranges(x.second_x,w.fXaxis,V.xmin,V.xmax,x.second_y,w.fYaxis,V.ymin,V.ymax),D.createXY2(x),D.drawAxes2(x.second_x,x.second_y))}if(V.options.adjustFrame){const x=V.getPadPainter().getRootPad();x&&(x.fUxmin<x.fUxmax&&(D.fX1NDC=(V.xmin-x.fUxmin)/(x.fUxmax-x.fUxmin),D.fX2NDC=(V.xmax-x.fUxmin)/(x.fUxmax-x.fUxmin)),x.fUymin<x.fUymax&&(D.fY1NDC=(V.ymin-x.fUymin)/(x.fUymax-x.fUymin),D.fY2NDC=(V.ymax-x.fUymin)/(x.fUymax-x.fUymin)),x.fLeftMargin=D.fX1NDC,x.fRightMargin=1-D.fX2NDC,x.fBottomMargin=D.fY1NDC,x.fTopMargin=1-D.fY2NDC,x.fFrameLineColor=0,x.fFrameLineWidth=0,D.setRootPadRange(x),D.fillatt.setSolidColor("none"),D.redraw()),V.options.adjustFrame=!1}if(D.setAxesRanges(w.fXaxis,V.xmin,V.xmax,w.fYaxis,V.ymin,V.ymax,w.fZaxis,0,0),D.createXY({ndim:V.getDimension(),check_pad_range:V.check_pad_range,zoom_xmin:V.zoom_xmin,zoom_xmax:V.zoom_xmax,zoom_ymin:V.zoom_ymin,zoom_ymax:V.zoom_ymax,ymin_nz:V.ymin_nz,swap_xy:V.options.BarStyle>=20,reverse_x:V.options.RevX,reverse_y:V.options.RevY,symlog_x:V.options.SymlogX,symlog_y:V.options.SymlogY,Proj:V.options.Proj,extra_y_space:V.options.Text&&V.options.BarStyle>0,hist_painter:V}),delete V.check_pad_range,delete V.zoom_xmin,delete V.zoom_xmax,delete V.zoom_ymin,delete V.zoom_ymax,V.options.Same)return!1;const P=V.options.Axis<0||2===V.options.Axis;return D.drawAxes(!1,P,P,V.options.AxisPos,V.options.Zscale&&V.options.Zvert,V.options.Zscale&&!V.options.Zvert,1!==V.options.Axis)})()}processOnlineChange(V){const D=this.getCanvPainter();(0,b.isFunc)(D?.processChanges)&&D.processChanges(V,this)}fillWebObjectOptions(V){this._auto_exec&&V&&(V.fcust="auto_exec:"+this._auto_exec,delete this._auto_exec)}toggleTitle(V){const D=this.getHisto();return!(!this.isMainPainter()||!D)&&("only-check"===V?!D.TestBit(fe):(D.InvertBit(fe),void this.updateHistTitle().then(()=>this.processOnlineChange(`exec:SetBit(TH1::kNoTitle,${D.TestBit(fe)?1:0})`))))}updateHistTitle(){var V=this;return(0,ve.A)(function*(){if(!V.isMainPainter()||V.options.Same||V.options.Axis>0)return V;const D=V.getPadPainter()?.findPainterFor(null,b.kTitle,b.clTPaveText),w=D?.getObject();if(!D||!w)return V;const P=V.getHisto(),x=b.gStyle,v=!P.TestBit(fe)&&x.fOptTitle>0;return w.Clear(),v&&w.AddText(P.fTitle),D.redraw().then(()=>V)})()}drawHistTitle(){var V=this;return(0,ve.A)(function*(){if(!V.isMainPainter()||V.options.Same||V.options.Axis>0)return V;const D=V.getHisto(),w=b.gStyle,P=!D.TestBit(fe)&&w.fOptTitle>0;let x=V.getPadPainter()?.findInPrimitives(b.kTitle,b.clTPaveText);return x?(x.Clear(),P&&x.AddText(D.fTitle),V):(x=(0,b.create)(b.clTPaveText),Object.assign(x,{fName:b.kTitle,fFillColor:w.fTitleColor,fFillStyle:w.fTitleStyle,fBorderSize:w.fTitleBorderSize,fTextFont:w.fTitleFont,fTextSize:w.fTitleFontSize,fTextColor:w.fTitleTextColor,fTextAlign:w.fTitleAlign}),P&&x.AddText(D.fTitle),et.TPavePainter.draw(V.getDom(),x,"postitle"))})()}processTitleChange(V){const D=this.getHisto(),w=this.getPadPainter()?.findPainterFor(null,b.kTitle);return D&&w?"check"===V?!this.isMainPainter()||this.options.Same?null:D:(w.clearPave(),w.addText(D.fTitle),w.redraw(),void this.submitCanvExec(`SetTitle("${D.fTitle}")`)):null}updateStatWebCanvas(){if(!this.snapid)return;const V=this.findStat(),D=this.getPadPainter()?.findPainterFor(V);D&&!D.snapid&&D.redraw()}findStat(){return this.findFunction(b.clTPaveStats,"stats")}toggleStat(V){let w,P,D=this.findStat();if(V||(V=""),D)w=this.getPadPainter()?.findPainterFor(D);else{if(V.indexOf("-check")>0)return!1;D=this.createStat(!0)}if("only-check"===V)return w?.Enabled||!1;if("fitpar-check"===V)return D?.fOptFit||!1;if("fitpar-toggle"===V)return!!D&&(D.fOptFit=D.fOptFit?0:1111,w?.redraw(),!0);if(w)w.Enabled=!w.Enabled,this.options.StatEnabled=w.Enabled,w.redraw(),P=w.Enabled;else{const x=this.selectCurrentPad(this.getPadName());P=et.TPavePainter.draw(this.getDom(),D).then(()=>this.selectCurrentPad(x))}return this.processOnlineChange(`exec:SetBit(TH1::kNoStats,${P?0:1})`,this),P}isIgnoreStatsFill(){return!this.getObject()||!this.draw_content&&!this.create_stats&&!this.snapid}createStat(V){const D=this.getHisto();if(!D||!V&&!this.options.ForceStat&&(this.options.NoStat||D.TestBit(b.kNoStats)||!b.settings.AutoStat||!this.isMainPainter()))return null;const w=b.gStyle;let P=this.findStat(),x=this.options.optstat,v=this.options.optfit;return void 0!==x?(P&&(P.fOptStat=x),delete this.options.optstat):x=D.$custom_stat||w.fOptStat,void 0!==v?(P&&(P.fOptFit=v),delete this.options.optfit):v=w.fOptFit,P||x||v?(this.create_stats=!0,P||(P=(0,b.create)(b.clTPaveStats),Object.assign(P,{fName:"stats",fOptStat:x,fOptFit:v,fX1NDC:w.fStatX-w.fStatW,fY1NDC:w.fStatY-w.fStatH,fX2NDC:w.fStatX,fY2NDC:w.fStatY,fTextAlign:12}),P.AddText(D.fName),this.addFunction(P),P)):null}findFunction(V,D){const w=this.getHisto()?.fFunctions?.arr;if(!w)return null;for(let P=0;P<w.length;++P){const x=w[P];if((!D||x.fName===D)&&x._typename===V)return x}return null}addFunction(V,D){const w=this.getHisto();!w||!V||(w.fFunctions||(w.fFunctions=(0,b.create)(b.clTList)),D?w.fFunctions.AddFirst(V):w.fFunctions.Add(V))}needDrawFunc(V,D){return D._typename===b.clTPaveStats?"stats"!==D.fName||!V.TestBit(b.kNoStats)&&!this.options.NoStat:D._typename===b.clTF1||D._typename===b.clTF2?this.options.AllFunc||!D.TestBit((0,b.BIT)(9)):"TGraphDelaunay"!==D._typename&&"TGraphDelaunay2D"!==D._typename&&D._typename!==b.clTPaletteAxis}drawFunctions(){var V=this;return(0,ve.A)(function*(){return new ie(V,V.getPadPainter(),V.getHisto().fFunctions,!0).drawNext(0)})()}updateFunctions(){var V=this;return(0,ve.A)(function*(){const D=V._funcHandler?.drawNext(0)??V;return delete V._funcHandler,D})()}getSelectIndex(V,D,w){let P=0,x=this.getAxis(V);const v=this[`nbins${V}`]??0;this.options.second_x&&"x"===V&&(V="x2"),this.options.second_y&&"y"===V&&(V="y2");const _=this.getFramePainter(),C=_?_[`zoom_${V}min`]:0,L=_?_[`zoom_${V}max`]:0;return C!==L&&x?(P="left"===D?x.FindBin(C,w||0):x.FindBin(L,(w||0)+.5),P<0?P=0:P>v&&(P=v)):P="left"===D?0:v,x&&(x.fFirst===x.fLast||!x.TestBit(xe.rb.kAxisRange)||x.fFirst<=1&&x.fLast>=v)&&(x=void 0),"left"===D?(P<0&&(P=0),x&&x.fFirst>1&&P<x.fFirst&&(P=x.fFirst-1)):(P>v&&(P=v),x&&x.fLast<=v&&P>x.fLast&&(P=x.fLast)),P}unzoomUserRange(V,D,w){const P=this.getHisto();if(!P)return!1;let x=!1;const v=C=>!(!C||!C.TestBit(xe.rb.kAxisRange)||C.fFirst===C.fLast||C.fFirst<=1&&C.fLast>=C.fNbins||(C.InvertBit(xe.rb.kAxisRange),0)),_=C=>!(this.getDimension()!==C||this.options.minimum===b.kNoZoom&&this.options.maximum===b.kNoZoom||!this.draw_content||(this.options.minimum=this.options.maximum=b.kNoZoom,this.scanContent(!0),0));return V&&v(P.fXaxis)&&(x=!0),D&&(v(P.fYaxis)||_(1))&&(x=!0),w&&(v(P.fZaxis)||_(2))&&(x=!0),x}addInteractivity(){var V=this;return(0,ve.A)(function*(){const D=V.isMainPainter(),w=V.options.AxisPos>0;return(D||w?V.getFramePainter():null)?.addInteractivity(!D&&w)??!1})()}changeUserRange(V,D){const w=this.getHisto(),P=w?w[`f${D}axis`]:null;if(!P)return;let x=`[1,${P.fNbins}]`;P.TestBit(xe.rb.kAxisRange)&&(x=`[${P.fFirst},${P.fLast}]`),V.input(`Enter user range for axis ${D} like [1,${P.fNbins}]`,x).then(v=>{if(!v||!(v=JSON.parse(v))||2!==v.length)return;const _=parseInt(v[0]),C=parseInt(v[1]);Number.isInteger(_)&&Number.isInteger(C)&&(P.fFirst=_,P.fLast=C,(P.fFirst<P.fLast&&P.fFirst>=1&&P.fLast<=P.fNbins)!==P.TestBit(xe.rb.kAxisRange)&&P.InvertBit(xe.rb.kAxisRange),this.interactiveRedraw())})}changeValuesRange(V){let D;D=this.options.minimum!==b.kNoZoom&&this.options.maximum!==b.kNoZoom?`[${this.options.minimum},${this.options.maximum}]`:`[${this.gminbin},${this.gmaxbin}]`,V.input("Enter min/max hist values or empty string to reset",D).then(w=>{w=w?JSON.parse(w):[],(0,b.isObject)(w)&&2===w.length&&Number.isFinite(w[0])&&Number.isFinite(w[1])?(this.options.minimum=w[0],this.options.maximum=w[1]):this.options.minimum=this.options.maximum=b.kNoZoom,this.interactiveRedraw()})}executeMenuCommand(V,D){if(super.executeMenuCommand(V,D))return!0;if(V.fClassName===b.clTAxis){const w=(0,b.isStr)(V.$execid)?V.$execid.indexOf("#"):-1,P=w>0?V.$execid.slice(w+1):"x",x=this.getFramePainter();if("UnZoom"===V.fName)return x?.unzoom(P),!0;if("SetRange"===V.fName){const v=x?.getAxis(P),_=JSON.parse(`[${D}]`);v&&2===_?.length&&x?.zoom(P,v.GetBinLowEdge(_[0]),v.GetBinLowEdge(_[1]+1))}else if("SetRangeUser"===V.fName){const v=JSON.parse(`[${D}]`);2===v?.length&&x?.zoom(P,v[0],v[1])}}return!1}fillContextMenuItems(V){const D=this.getHisto(),w=this.getFramePainter();if(D){if(this.options.Axis<=0&&!this.isTF1()&&V.addchk(this.toggleStat("only-check"),"Show statbox",()=>this.toggleStat()),D.fTitle&&this.isMainPainter()&&V.addchk(this.toggleTitle("only-check"),"Show title",()=>this.toggleTitle()),this.draw_content&&(1===this.getDimension()?V.add("User range X",()=>this.changeUserRange(V,"X")):(V.add("sub:User ranges"),V.add("X",()=>this.changeUserRange(V,"X")),V.add("Y",()=>this.changeUserRange(V,"Y")),this.getDimension()>2?V.add("Z",()=>this.changeUserRange(V,"Z")):V.add("Values",()=>this.changeValuesRange(V)),V.add("endsub:")),(0,b.isFunc)(this.fillHistContextMenu)&&this.fillHistContextMenu(V)),this.options.Mode3D){V.size()>0&&V.add("separator");const P=this.getMainPainter()||this;V.addchk(P.isTooltipAllowed(),"Show tooltips",()=>P.setTooltipAllowed("toggle")),V.addchk(w?.enable_highlight,"Highlight bins",()=>{w.enable_highlight=!w.enable_highlight,!w.enable_highlight&&w.mode3d&&(0,b.isFunc)(w.highlightBin3D)&&w.highlightBin3D(null)}),(0,b.isFunc)(w?.render3D)&&(V.addchk(P.options.FrontBox,"Front box",()=>{P.options.FrontBox=!P.options.FrontBox,w.render3D()}),V.addchk(P.options.BackBox,"Back box",()=>{P.options.BackBox=!P.options.BackBox,w.render3D()}),V.addchk(w.camera?.isOrthographicCamera,"Orthographic camera",x=>{P.options.Ortho=x,w.change3DCamera(x)})),this.draw_content&&(V.addchk(!this.options.Zero,"Suppress zeros",()=>{this.options.Zero=!this.options.Zero,this.interactiveRedraw("pad")}),(12===this.options.Lego||14===this.options.Lego)&&(V.addchk(this.options.Zscale,"Z scale",()=>this.toggleColz()),this.fillPaletteMenu(V,!0))),(0,b.isFunc)(P.control?.reset)&&V.add("Reset camera",()=>P.control.reset())}this.histogram_updated&&w.zoomChangedInteractive()&&V.add("Let update zoom",()=>w.zoomChangedInteractive("reset"))}}getSnapId(V){if(!this.snapid)return"";let D=this.snapid.toString();return V&&(D+="#",this.isTF1()&&("x"===V||"y"===V||"z"===V)&&(D+="hist#"),D+=V),D}autoZoom(){}clickButton(V){const D=this.getFramePainter();if(!this.isMainPainter()||!D)return!1;switch(V){case"ToggleZoom":if(D.zoom_xmin!==D.zoom_xmax||D.zoom_ymin!==D.zoom_ymax||D.zoom_zmin!==D.zoom_zmax){const w=D.unzoom();return D.zoomChangedInteractive("reset"),w}if(this.draw_content)return this.autoZoom();break;case"ToggleLogX":return D.toggleAxisLog("x");case"ToggleLogY":return D.toggleAxisLog("y");case"ToggleLogZ":return D.toggleAxisLog("z");case"ToggleStatBox":return(0,b.getPromise)(this.toggleStat())}return!1}fillToolbar(V){const D=this.getPadPainter();D&&(D.addPadButton("auto_zoom","Toggle between unzoom and autozoom-in","ToggleZoom","Ctrl *"),D.addPadButton("arrow_right","Toggle log x","ToggleLogX","PageDown"),D.addPadButton("arrow_up","Toggle log y","ToggleLogY","PageUp"),this.getDimension()>1&&D.addPadButton("arrow_diag","Toggle log z","ToggleLogZ"),D.addPadButton("statbox","Toggle stat box","ToggleStatBox"),V||D.showPadButtons())}get3DToolTip(V){const D=this.getHisto(),w={bin:V,name:D.fName,title:D.fTitle};switch(this.getDimension()){case 1:w.ix=V,w.iy=1,w.value=D.getBinContent(w.ix),w.error=D.getBinError(V),w.lines=this.getBinTooltips(V-1);break;case 2:w.ix=V%(this.nbinsx+2),w.iy=(V-w.ix)/(this.nbinsx+2),w.value=D.getBinContent(w.ix,w.iy),w.error=D.getBinError(V),w.lines=this.getBinTooltips(w.ix-1,w.iy-1);break;case 3:w.ix=V%(this.nbinsx+2),w.iy=(V-w.ix)/(this.nbinsx+2)%(this.nbinsy+2),w.iz=(V-w.ix-w.iy*(this.nbinsx+2))/(this.nbinsx+2)/(this.nbinsy+2),w.value=D.getBinContent(w.ix,w.iy,w.iz),w.error=D.getBinError(V),w.lines=this.getBinTooltips(w.ix-1,w.iy-1,w.iz-1)}return w}createContour(V,D,w,P,x){const v=new ce(D,w),_=this.getDimension();if(x)v.createCustom(x);else{V<2&&(V=b.gStyle.fNumberContours);const L=this.getPadPainter().getRootPad(!0);v.createNormal(V,L?.fLogv??(2===_&&L?.fLogz)??0,P)}v.configIndicies(this.options.Zero?-1:0,0!==v.colzmin||!this.options.Zero||this.isTH2Poly()?0:-1);const C=this.getFramePainter();return C&&_<3&&!C.mode3d&&(C.zmin=v.colzmin,C.zmax=v.colzmax),this.fContour=v,v}getContour(V){if(this.fContour&&!V)return this.fContour;const D=this.getMainPainter(),w=this.getFramePainter();if(D?.fContour&&D!==this&&!this.options.IgnoreMainScale)return this.fContour=D.fContour,this.fContour;const P=this.getObject(),x=this===D||void 0===D?.minbin||this.options.IgnoreMainScale||D?.tt_handle?.ScatterPlot?this:D;let _,U,v=0,C=x.minbin,L=x.maxbin,F=x.minposbin;C===L&&(C=x.gminbin,L=x.gmaxbin,F=x.gminposbin);let j=C,te=L;this.options.minimum!==b.kNoZoom&&(C=this.options.minimum,j=Math.min(j,C),_=!0),this.options.maximum!==b.kNoZoom&&(L=this.options.maximum,te=Math.max(te,L),_=!1),C>=L&&(_?L=C+1:C=L-1),w&&w.zoom_zmin!==w.zoom_zmax&&(C=w.zoom_zmin,L=w.zoom_zmax),P.fContour?.length>1&&(P.TestBit(he)?U=P.fContour:v=P.fContour.length);const N=this.createContour(v,C,L,F,U);return this.getDimension()<3&&w&&(w.zmin=j,w.zmax=te,j!==N.colzmin||te!==N.colzmax?(w.zoom_zmin=N.colzmin,w.zoom_zmax=N.colzmax):w.zoom_zmin=w.zoom_zmax=void 0),N}getContourLevels(V){return this.getContour(V).getLevels()}getHistPalette(V){V&&(this._color_palette=null);const D=this.getPadPainter();return!this._color_palette&&!this.options.Palette&&(0,b.isFunc)(D?.getCustomPalette)&&(this._color_palette=D.getCustomPalette()),this._color_palette||(this._color_palette=(0,z.jh)(this.options.Palette,D?.isGrayscale())),this._color_palette}fillPaletteMenu(V,D){if(V.addPaletteMenu(this.options.Palette||b.settings.Palette,w=>{this.options.Palette=parseInt(w),this.getHistPalette(!0),this.redraw()}),!D){V.add("Default position",()=>{this.drawColorPalette(this.options.Zscale,!1,!0).then(()=>this.processOnlineChange("drawopt"))},"Set default position for palette");const w=this.findFunction(b.clTPaletteAxis);V.addchk(!w||w.fX2NDC-w.fX1NDC<w.fY2NDC-w.fY1NDC,"Vertical",x=>{this.options.Zvert=x,this.drawColorPalette(this.options.Zscale,!1,"toggle").then(()=>this.processOnlineChange("drawopt"))},"Toggle palette vertical/horizontal flag"),V.add("Bring to front",()=>this.getPadPainter()?.findPainterFor(w)?.bringToFront())}}drawColorPalette(V,D,w){var P=this;return(0,ve.A)(function*(){if(P.options.IgnorePalette)return null;const x=P.getMainPainter(),v=P.getPadPainter();if(x!==P&&x&&!1!==x.draw_content&&x.options.Zscale)return null;let _=P.findFunction(b.clTPaletteAxis),C=v?.findPainterFor(_);const L=!!_;if(P._can_move_colz&&(delete P._can_move_colz,w||(w=!0)),!C&&!_&&!P.options.Axis&&(C=v?.findPainterFor(void 0,void 0,b.clTPaletteAxis),C&&(_=C.getObject(),P.addFunction(_,!0))),!V)return C&&(P.options.Zvert=C._palette_vertical,C.Enabled=!1,C.removeG()),null;if(_)void 0!==v?._palette_vertical&&(P.options.Zvert=v._palette_vertical);else{if(_=(0,b.create)(b.clTPaletteAxis),_.fInit=1,_.$can_move=!0,_.$generated=!0,Object.assign(_,P.options.Zvert?{fX1NDC:1.005-b.gStyle.fPadRightMargin,fX2NDC:1.045-b.gStyle.fPadRightMargin,fY1NDC:b.gStyle.fPadBottomMargin,fY2NDC:1-b.gStyle.fPadTopMargin}:{fX1NDC:b.gStyle.fPadLeftMargin,fX2NDC:1-b.gStyle.fPadRightMargin,fY1NDC:1.005-b.gStyle.fPadTopMargin,fY2NDC:1.045-b.gStyle.fPadTopMargin}),Object.assign(_.fAxis,{fChopt:"+",fLineSyle:1,fLineWidth:1,fTextAngle:0,fTextAlign:11}),2===P.getDimension()){const te=P.getHisto().fZaxis;Object.assign(_.fAxis,{fTitle:te.fTitle,fTitleSize:te.fTitleSize,fTitleOffset:te.fTitleOffset,fTitleColor:te.fTitleColor,fLineColor:te.fAxisColor,fTextSize:te.fLabelSize,fTextColor:te.fLabelColor,fTextFont:te.fLabelFont,fLabelOffset:te.fLabelOffset})}P.addFunction(_,!0),w=!0}const F=P.getFramePainter();if(w&&F&&_.$can_move)if(P.options.Zvert){if("toggle"===w){const te=_.fY2NDC-_.fY1NDC;_.fX1NDC=F.fX2NDC+.005,_.fX2NDC=_.fX1NDC+te}_.fX1NDC>.5*(F.fX1NDC+F.fX2NDC)?(_.fX2NDC=F.fX2NDC+.005+(_.fX2NDC-_.fX1NDC),_.fX1NDC=F.fX2NDC+.005):(_.fX1NDC=F.fX1NDC-.03-(_.fX2NDC-_.fX1NDC),_.fX2NDC=F.fX1NDC-.03),_.fY1NDC=F.fY1NDC,_.fY2NDC=F.fY2NDC}else{if("toggle"===w){const te=_.fX2NDC-_.fX1NDC;_.fY1NDC=F.fY2NDC+.005,_.fY2NDC=_.fY1NDC+te}_.fX1NDC=F.fX1NDC,_.fX2NDC=F.fX2NDC,_.fY2NDC>.5*(F.fY1NDC+F.fY2NDC)?(_.fY2NDC=F.fY2NDC+.005+(_.fY2NDC-_.fY1NDC),_.fY1NDC=F.fY2NDC+.005):(_.fY1NDC=F.fY1NDC-.05-(_.fY2NDC-_.fY1NDC),_.fY2NDC=F.fY1NDC-.05)}_.$main_painter=P;let j,U="";if(D&&(U+=";postpone"),w&&!P.do_redraw_palette&&(U+=";can_move"),P.options.Cjust&&(U+=";cjust"),C){if(C.Enabled=!0,D)return C;j=C.drawPave(U)}else{const te=P.selectCurrentPad(P.getPadName());j=et.TPavePainter.draw(P.getDom(),_,U).then(N=>{C=N,P.selectCurrentPad(te),C.setSecondaryId(P,L&&!_.$generated?`func_${_.fName}`:void 0)})}return j.then(()=>{P.options.Zvert=C._palette_vertical,C.redraw=()=>{};let te=!1;if(w&&F&&!P.do_redraw_palette){const m=v?.getRootPad(!0);P.options.Zvert?(_.fX1NDC>.5&&F.fX2NDC>_.fX1NDC?(te=!0,F.fX2NDC=_.fX1NDC-.01,F.fX1NDC>F.fX2NDC-.1&&(F.fX1NDC=Math.max(0,F.fX2NDC-.1))):_.fX2NDC<.5&&F.fX1NDC<_.fX2NDC&&(te=!0,F.fX1NDC=_.fX2NDC+.05,F.fX2NDC<F.fX1NDC+.1&&(F.fX2NDC=Math.min(1,F.fX1NDC+.1))),te&&m&&(m.fLeftMargin=F.fX1NDC,m.fRightMargin=1-F.fX2NDC)):(_.fY1NDC>.5&&F.fY2NDC>_.fY1NDC?(te=!0,F.fY2NDC=_.fY1NDC-.01,F.fY1NDC>F.fY2NDC-.1&&(F.fY1NDC=Math.max(0,F.fXYNDC-.1))):_.fY2NDC<.5&&F.fY1NDC<_.fY2NDC&&(te=!0,F.fY1NDC=_.fY2NDC+.05,F.fXYNDC<F.fY1NDC+.1&&(F.fY2NDC=Math.min(1,F.fY1NDC+.1))),te&&m&&(m.fTopMargin=F.fY1NDC,m.fBottomMargin=1-F.fY2NDC))}return te?(P.do_redraw_palette=!0,F.redraw(),(D?Promise.resolve(!0):P.redraw()).then(()=>(delete P.do_redraw_palette,C))):C})})()}toggleColz(){if(this.options.canHavePalette())return this.options.Zscale=!this.options.Zscale,this.drawColorPalette(this.options.Zscale,!1,!0).then(()=>this.processOnlineChange("drawopt"))}toggleMode3D(){return this.options.Mode3D=!this.options.Mode3D,this.options.Mode3D&&!this.options.Surf&&!this.options.Lego&&!this.options.Error&&(this.options.Lego=this.nbinsx>=50||this.nbinsy>=50?this.options.Scat?13:14:this.options.Scat?1:12,this.options.Zero=!1),this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}prepareDraw(V){V||(V={rounding:!0,extra:0,middle:0}),void 0===V.extra&&(V.extra=0),void 0===V.middle&&(V.middle=0);const D=this.getHisto(),w=D.fXaxis,P=D.fYaxis,x=this.getFramePainter(),v=this.getDimension(),_={i1:V.nozoom?0:this.getSelectIndex("x","left",0-V.extra),i2:V.nozoom?this.nbinsx:this.getSelectIndex("x","right",1+V.extra),j1:1===v||V.nozoom?0:this.getSelectIndex("y","left",0-V.extra),j2:1===v?1:V.nozoom?this.nbinsy:this.getSelectIndex("y","right",1+V.extra),min:0,max:0,sumz:0,xbar1:0,xbar2:1,ybar1:0,ybar2:1};if(V.cutg){let m=_.i2,I=_.i1,A=_.j2,R=_.j1;for(let k=_.i1;k<_.i2;++k)for(let J=_.j1;J<_.j2;++J)V.cutg.IsInside(w.GetBinCoord(k+V.middle),P.GetBinCoord(J+V.middle))&&(m=Math.min(m,k),I=Math.max(I,k+1),A=Math.min(A,J),R=Math.max(R,J+1));_.i1=m,_.i2=I,_.j1=A,_.j2=R}let C,L,F,U,j,te;if(_.grx=new Float32Array(_.i2+1),_.gry=new Float32Array(_.j2+1),"number"==typeof D.fBarOffset&&"number"==typeof D.fBarWidth&&(D.fBarOffset||1e3!==D.fBarWidth)&&(D.fBarOffset<=1e3?_.xbar1=_.ybar1=.001*D.fBarOffset:D.fBarOffset<=3e3?_.xbar1=.001*(D.fBarOffset-2e3):D.fBarOffset<=5e3&&(_.ybar1=.001*(D.fBarOffset-4e3)),D.fBarWidth<=1e3?(_.xbar2=Math.min(1,_.xbar1+.001*D.fBarWidth),_.ybar2=Math.min(1,_.ybar1+.001*D.fBarWidth)):D.fBarWidth<=3e3?_.xbar2=Math.min(1,_.xbar1+.001*(D.fBarWidth-2e3)):D.fBarWidth<=5e3&&(_.ybar2=Math.min(1,_.ybar1+.001*(D.fBarWidth-4e3)))),V.original&&(_.original=!0,_.origx=new Float32Array(_.i2+1),_.origy=new Float32Array(_.j2+1)),V.pixel_density&&(V.rounding=!0),!x)return console.warn("cannot draw histogram without frame"),_;const N=x.getGrFuncs(this.options.second_x,this.options.second_y);for(C=_.i1;C<=_.i2;++C)F=w.GetBinCoord(C+V.middle),N.logx&&F<=0?_.i1=C+1:(_.origx&&(_.origx[C]=F),_.grx[C]=N.grx(F),V.rounding&&(_.grx[C]=Math.round(_.grx[C])),V.use3d&&(_.grx[C]<-x.size_x3d&&(_.grx[C]=-x.size_x3d,this.options.RevX?_.i2=C:_.i1=C),_.grx[C]>x.size_x3d&&(_.grx[C]=x.size_x3d,this.options.RevX?_.i1=C:_.i2=C)));if(1===v)_.gry[0]=N.gry(0),_.gry[1]=N.gry(1);else for(L=_.j1;L<=_.j2;++L)U=P.GetBinCoord(L+V.middle),N.logy&&U<=0?_.j1=L+1:(_.origy&&(_.origy[L]=U),_.gry[L]=N.gry(U),V.rounding&&(_.gry[L]=Math.round(_.gry[L])),V.use3d&&(_.gry[L]<-x.size_y3d&&(_.gry[L]=-x.size_y3d,this.options.RevY?_.j2=L:_.j1=L),_.gry[L]>x.size_y3d&&(_.gry[L]=x.size_y3d,this.options.RevY?_.j1=L:_.j2=L)));for(this.maxbin=this.minbin=this.minposbin=null,C=_.i1;C<_.i2;++C)for(L=_.j1;L<_.j2;++L){if(j=D.getBinContent(C+1,L+1),_.sumz+=j,V.pixel_density){if(te=(_.grx[C+1]-_.grx[C])*(_.gry[L]-_.gry[L+1]),te<=0)continue;_.max=Math.max(_.max,j),j>0&&(j<_.min||0===_.min)&&(_.min=j),j/=te}null===this.maxbin?this.maxbin=this.minbin=j:(this.maxbin=Math.max(this.maxbin,j),this.minbin=Math.min(this.minbin,j)),j>0&&(null===this.minposbin||j<this.minposbin)&&(this.minposbin=j)}return this.fContour=null,_}getAxisBinTip(V,D,w){const x=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),v=x[`${V}_handle`],_=D.GetBinLowEdge(w+1);if(v.kind===xe.ei)return x.axisAsText(V,_);const C=D.GetBinLowEdge(w+2);return v.kind===xe.Yu||this.isTF1()?x.axisAsText(V,(_+C)/2):`[${x.axisAsText(V,_)}, ${x.axisAsText(V,C)})`}static _drawHist(V,D){return(0,ve.A)(function*(){return(0,Je.ensureTCanvas)(V).then(()=>(V.setAsMainPainter(),V.decodeOptions(D),V.isTH2Poly()&&V.options.Mode3D&&(V.options.Lego=12),V.checkPadRange(),V.scanContent(),V.createStat(),V.callDrawFunc())).then(()=>V.drawFunctions()).then(()=>V.drawHistTitle()).then(()=>{if(!V.Mode3D&&V.options.AutoZoom)return V.autoZoom()}).then(()=>{if(V.options.Project&&!V.mode3d&&(0,b.isFunc)(V.toggleProjection))return V.toggleProjection(V.options.Project)}).then(()=>(V.fillToolbar(),V))})()}}},471:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{$o:()=>We,D1:()=>Ie,FF:()=>A,Fk:()=>Je,Hg:()=>Y,Mx:()=>Or,N8:()=>dt,NE:()=>L,PI:()=>U,Ph:()=>m,Pk:()=>N,Q_:()=>V,Ql:()=>Te,Qu:()=>F,R0:()=>et,Tq:()=>Ne,Ub:()=>Tn,V$:()=>k,_T:()=>ai,aM:()=>ce,bP:()=>P,bm:()=>te,c4:()=>x,h0:()=>w,k:()=>le,k1:()=>ue,lW:()=>jt,lZ:()=>Xe,mU:()=>Q,nc:()=>ie,ry:()=>xt,s4:()=>C,v5:()=>Pe,w1:()=>I,yd:()=>O,ym:()=>Re});var ve=Ee(467),b=Ee(6998);const z="TStreamerElement",ke="TStreamerObject",xe="TStreamerSTL",et="TStreamerInfoList",Je="TDirectory",Xe="TDirectoryFile",Re="TBasket",He="TDatime",Ie="StreamerInfo",O=1,ce=2,ie=3,he=4,ue=5,fe=6,le=7,Y=8,V=9,D=10,w=11,P=12,x=13,v=14,_=15,C=16,L=17,F=18,U=19,j=0,te=20,N=40,m=61,I=62,A=63,R=64,k=65,J=66,_e=67,be=68,Te=69,Pe=71,We=300,dt=500,Q=501,Ze=1073741824,Ue=4294967295,Oe=2147483648,lt=(0,b.BIT)(14),gt=0,ht=1,st=2,yt=3,Kt=4,Ot=5,It=6,An=7,on=8,pn=["BASE","char","short","int","long","float","int","const char*","double","Double32_t","char","unsigned  char","unsigned short","unsigned","unsigned long","unsigned","Long64_t","ULong64_t","bool","Float16_t"],Qt=["","vector","list","deque","map","multimap","set","multiset","bitset"],Bn=(0,b.BIT)(4),dn=(0,b.BIT)(5),yn={TObject($,S){S.fUniqueID=$.ntou4(),S.fBits=$.ntou4(),S.fBits&Bn&&$.ntou2()},TNamed:[{basename:b.clTObject,base:1,func($,S){S._typename||(S._typename=b.clTNamed),$.classStreamer(S,b.clTObject)}},{name:"fName",func($,S){S.fName=$.readTString()}},{name:"fTitle",func($,S){S.fTitle=$.readTString()}}],TObjString:[{basename:b.clTObject,base:1,func($,S){S._typename||(S._typename=b.clTObjString),$.classStreamer(S,b.clTObject)}},{name:"fString",func($,S){S.fString=$.readTString()}}],TClonesArray($,S){S._typename||(S._typename=b.clTClonesArray),S.$kind=b.clTClonesArray,S.name="";const Z=$.last_read_version;Z>2&&$.classStreamer(S,b.clTObject),Z>1&&(S.name=$.readTString());let Ae=$.readTString(),Ce=0;const $e=Ae.lastIndexOf(";");$e>0&&(Ce=Number.parseInt(Ae.slice($e+1)),Ae=Ae.slice(0,$e));let nt=$.ntou4();nt<0&&(nt=-nt),S.arr=new Array(nt),S.fLast=nt-1,S.fLowerBound=$.ntou4();let rt=$.fFile.getStreamer(Ae,{val:Ce});if(rt=$.fFile.getSplittedStreamer(rt),rt){for(let ct=0;ct<nt;++ct)S.arr[ct]={_typename:Ae};for(let ct=0;ct<rt.length;++ct)for(let zt=0;zt<nt;++zt)rt[ct].func($,S.arr[zt])}else console.log(`Cannot get member-wise streamer for ${Ae}:${Ce}`)},TMap($,S){S._typename||(S._typename=b.clTMap),S.name="",S.arr=[];const Z=$.last_read_version;Z>2&&$.classStreamer(S,b.clTObject),Z>1&&(S.name=$.readTString());const Ae=$.ntou4();for(let Ce=0;Ce<Ae;++Ce){const $e={_typename:"TPair"};$e.first=$.readObjectAny(),$e.second=$.readObjectAny(),$e.first&&S.arr.push($e)}},TTreeIndex($,S){const Z=$.last_read_version;S._typename="TTreeIndex",$.classStreamer(S,"TVirtualIndex"),S.fMajorName=$.readTString(),S.fMinorName=$.readTString(),S.fN=$.ntoi8(),S.fIndexValues=$.readFastArray(S.fN,C),Z>1&&(S.fIndexValuesMinor=$.readFastArray(S.fN,C)),S.fIndex=$.readFastArray(S.fN,C)},TRefArray($,S){S._typename="TRefArray",$.classStreamer(S,b.clTObject),S.name=$.readTString();const Z=$.ntoi4();S.fLast=Z-1,S.fLowerBound=$.ntoi4(),$.ntou2(),S.fUIDs=$.readFastArray(Z,x)},TCanvas($,S){S._typename=b.clTCanvas,$.classStreamer(S,b.clTPad),S.fDISPLAY=$.readTString(),S.fDoubleBuffer=$.ntoi4(),S.fRetained=0!==$.ntou1(),S.fXsizeUser=$.ntoi4(),S.fYsizeUser=$.ntoi4(),S.fXsizeReal=$.ntoi4(),S.fYsizeReal=$.ntoi4(),S.fWindowTopX=$.ntoi4(),S.fWindowTopY=$.ntoi4(),S.fWindowWidth=$.ntoi4(),S.fWindowHeight=$.ntoi4(),S.fCw=$.ntou4(),S.fCh=$.ntou4(),S.fCatt=$.classStreamer({},b.clTAttCanvas),$.ntou1(),$.ntou1(),S.fHighLightColor=$.ntoi2(),S.fBatch=0!==$.ntou1(),$.ntou1(),$.ntou1(),$.ntou1()},TObjArray($,S){S._typename||(S._typename=b.clTObjArray),S.$kind=b.clTObjArray,S.name="";const Z=$.last_read_version;Z>2&&$.classStreamer(S,b.clTObject),Z>1&&(S.name=$.readTString());const Ae=$.ntou4();let Ce=0;for(S.arr=new Array(Ae),S.fLast=Ae-1,S.fLowerBound=$.ntou4();Ce<Ae;)S.arr[Ce++]=$.readObjectAny()},TPolyMarker3D($,S){const Z=$.last_read_version;$.classStreamer(S,b.clTObject),$.classStreamer(S,b.clTAttMarker),S.fN=$.ntoi4(),S.fP=$.readFastArray(3*S.fN,ue),S.fOption=$.readTString(),S.fName=Z>1?$.readTString():b.clTPolyMarker3D},TPolyLine3D($,S){$.classStreamer(S,b.clTObject),$.classStreamer(S,b.clTAttLine),S.fN=$.ntoi4(),S.fP=$.readFastArray(3*S.fN,ue),S.fOption=$.readTString()},TStreamerInfo($,S){$.classStreamer(S,b.clTNamed),S.fCheckSum=$.ntou4(),S.fClassVersion=$.ntou4(),S.fElements=$.readObjectAny()},TStreamerElement($,S){const Z=$.last_read_version;if($.classStreamer(S,b.clTNamed),S.fType=$.ntou4(),S.fSize=$.ntou4(),S.fArrayLength=$.ntou4(),S.fArrayDim=$.ntou4(),S.fMaxIndex=$.readFastArray(1===Z?$.ntou4():5,x),S.fTypeName=$.readTString(),S.fType===w&&("Bool_t"===S.fTypeName||"bool"===S.fTypeName)&&(S.fType=F),S.fXmin=S.fXmax=S.fFactor=0,3===Z)S.fXmin=$.ntod(),S.fXmax=$.ntod(),S.fFactor=$.ntod();else if(Z>3&&S.fBits&(0,b.BIT)(6)){let Ae=S.fTitle.indexOf("[");Ae>=0&&S.fType>N&&(Ae=S.fTitle.indexOf("[",Ae+1));const Ce=S.fTitle.indexOf("]",Ae+1);if(Ae>=0&&Ce>=Ae+2){const $e=S.fTitle.slice(Ae+1,Ce).split(",");let nt=32;if(!$e||$e.length<2)throw new Error(`Problem to decode range setting from streamer element title ${S.fTitle}`);3===$e.length&&(nt=parseInt($e[2])),(!Number.isInteger(nt)||nt<2||nt>32)&&(nt=32);const rt=zt=>{if(!zt)return 0;if(zt.indexOf("pi")<0)return parseFloat(zt);let at=1;switch("-"===(zt=zt.trim())[0]&&(at=-1,zt=zt.slice(1)),zt){case"2pi":case"2*pi":case"twopi":return 2*at*Math.PI;case"pi/2":return at*Math.PI/2;case"pi/4":return at*Math.PI/4}return at*Math.PI};S.fXmin=rt($e[0]),S.fXmax=rt($e[1]);const ct=nt>=0&&nt<32?Math.pow(2,nt):4294967295;S.fXmin<S.fXmax?S.fFactor=ct/(S.fXmax-S.fXmin):nt<15&&(S.fXmin=nt)}}},TStreamerBase($,S){const Z=$.last_read_version;$.classStreamer(S,z),Z>2&&(S.fBaseVersion=$.ntou4())},TStreamerSTL($,S){$.classStreamer(S,z),S.fSTLtype=$.ntou4(),S.fCtype=$.ntou4(),S.fSTLtype===Ot&&(0===S.fTypeName.indexOf("std::set")||0===S.fTypeName.indexOf("set"))&&(S.fSTLtype=It),S.fSTLtype===It&&(0===S.fTypeName.indexOf("std::multimap")||0===S.fTypeName.indexOf("multimap"))&&(S.fSTLtype=Ot)},TStreamerSTLstring($,S){$.last_read_version>0&&$.classStreamer(S,xe)},TList($,S){if(S._typename||(S._typename=this.typename),S.$kind=b.clTList,$.last_read_version>3){$.classStreamer(S,b.clTObject),S.name=$.readTString();const Z=$.ntou4();S.arr=new Array(Z),S.opt=new Array(Z);for(let Ae=0;Ae<Z;++Ae)S.arr[Ae]=$.readObjectAny(),S.opt[Ae]=$.readTString()}else S.name="",S.arr=[],S.opt=[]},THashList:b.clTList,TStreamerLoop($,S){$.last_read_version>1&&($.classStreamer(S,z),S.fCountVersion=$.ntou4(),S.fCountName=$.readTString(),S.fCountClass=$.readTString())},TStreamerBasicPointer:"TStreamerLoop",TStreamerObject($,S){$.last_read_version>1&&$.classStreamer(S,z)},TStreamerBasicType:ke,TStreamerObjectAny:ke,TStreamerString:ke,TStreamerObjectPointer:ke,TStreamerObjectAnyPointer($,S){$.last_read_version>0&&$.classStreamer(S,z)},TTree:{name:"$file",func($,S){S.$kind="TTree",S.$file=$.fFile}},RooRealVar($,S){const Z=$.last_read_version;$.classStreamer(S,"RooAbsRealLValue"),1===Z&&($.ntod(),$.ntod(),$.ntoi4()),S._error=$.ntod(),S._asymErrLo=$.ntod(),S._asymErrHi=$.ntod(),Z>=2&&(S._binning=$.readObjectAny()),3===Z&&(S._sharedProp=$.readObjectAny()),Z>=4&&(S._sharedProp=$.classStreamer({},"RooRealVarSharedProperties"))},RooAbsBinning($,S){$.classStreamer(S,1===$.last_read_version?b.clTObject:b.clTNamed),$.classStreamer(S,"RooPrintable")},RooCategory($,S){const Z=$.last_read_version;$.classStreamer(S,"RooAbsCategoryLValue"),S._sharedProp=1===Z?$.readObjectAny():$.classStreamer({},"RooCategorySharedProperties")},"RooWorkspace::CodeRepo":$=>{const S=2===$.last_read_version?3:2;for(let Z=0;Z<S;++Z){let Ae=$.ntoi4()*(0===Z?4:3);for(;Ae--;)$.readTString()}},RooLinkedList($,S){const Z=$.last_read_version;$.classStreamer(S,b.clTObject);let Ae=$.ntoi4();for(S.arr=(0,b.create)(b.clTList);Ae--;)S.arr.Add($.readObjectAny());Z>1&&(S._name=$.readTString())},TImagePalette:[{basename:b.clTObject,base:1,func($,S){S._typename||(S._typename=b.clTImagePalette),$.classStreamer(S,b.clTObject)}},{name:"fNumPoints",func($,S){S.fNumPoints=$.ntou4()}},{name:"fPoints",func($,S){S.fPoints=$.readFastArray(S.fNumPoints,Y)}},{name:"fColorRed",func($,S){S.fColorRed=$.readFastArray(S.fNumPoints,P)}},{name:"fColorGreen",func($,S){S.fColorGreen=$.readFastArray(S.fNumPoints,P)}},{name:"fColorBlue",func($,S){S.fColorBlue=$.readFastArray(S.fNumPoints,P)}},{name:"fColorAlpha",func($,S){S.fColorAlpha=$.readFastArray(S.fNumPoints,P)}}],TAttImage:[{name:"fImageQuality",func($,S){S.fImageQuality=$.ntoi4()}},{name:"fImageCompression",func($,S){S.fImageCompression=$.ntou4()}},{name:"fConstRatio",func($,S){S.fConstRatio=0!==$.ntou1()}},{name:"fPalette",func($,S){S.fPalette=$.classStreamer({},b.clTImagePalette)}}],TASImage($,S){if(1===$.last_read_version&&$.fFile.fVersion>0&&$.fFile.fVersion<5e4)return console.warn("old TASImage version - not yet supported");if($.classStreamer(S,b.clTNamed),0!==$.ntou1()){const Z=$.ntoi4();S.fPngBuf=$.readFastArray(Z,w)}else $.classStreamer(S,"TAttImage"),S.fWidth=$.ntoi4(),S.fHeight=$.ntoi4(),S.fImgBuf=$.readFastArray(S.fWidth*S.fHeight,Y)},TMaterial($,S){const Z=$.last_read_version;$.classStreamer(S,b.clTNamed),S.fNumber=$.ntoi4(),S.fA=$.ntof(),S.fZ=$.ntof(),S.fDensity=$.ntof(),Z>2?($.classStreamer(S,b.clTAttFill),S.fRadLength=$.ntof(),S.fInterLength=$.ntof()):S.fRadLength=S.fInterLength=0},TMixture($,S){$.classStreamer(S,"TMaterial"),S.fNmixt=$.ntoi4(),S.fAmixt=$.readFastArray($.ntoi4(),ue),S.fZmixt=$.readFastArray($.ntoi4(),ue),S.fWmixt=$.readFastArray($.ntoi4(),ue)},TVirtualPerfStats:b.clTObject,TMethodCall:b.clTObject};function Tn($,S){yn[$]=S}function Hn(){const $=new Date;return $.setFullYear(1995+(this.fDatime>>>26)),$.setMonth((this.fDatime<<6>>>28)-1),$.setDate(this.fDatime<<10>>>27),$.setHours(this.fDatime<<15>>>27),$.setMinutes(this.fDatime<<20>>>26),$.setSeconds(this.fDatime<<26>>>26),$.setMilliseconds(0),$}const ti={TQObject(){},TGraphStruct(){},TGraphNode(){},TGraphEdge(){},TDatime($,S){S.fDatime=$.ntou4(),S.getDate=Hn},TKey($,S){S.fNbytes=$.ntoi4(),S.fVersion=$.ntoi2(),S.fObjlen=$.ntou4(),S.fDatime=$.classStreamer({},He),S.fKeylen=$.ntou2(),S.fCycle=$.ntou2(),S.fVersion>1e3?(S.fSeekKey=$.ntou8(),$.shift(8)):(S.fSeekKey=$.ntou4(),$.shift(4)),S.fClassName=$.readTString(),S.fName=$.readTString(),S.fTitle=$.readTString()},TDirectory($,S){const Z=$.ntou2();S.fDatimeC=$.classStreamer({},He),S.fDatimeM=$.classStreamer({},He),S.fNbytesKeys=$.ntou4(),S.fNbytesName=$.ntou4(),S.fSeekDir=Z>1e3?$.ntou8():$.ntou4(),S.fSeekParent=Z>1e3?$.ntou8():$.ntou4(),S.fSeekKeys=Z>1e3?$.ntou8():$.ntou4()},TBasket($,S){$.classStreamer(S,b.clTKey);const Z=$.readVersion();S.fBufferSize=$.ntoi4(),S.fNevBufSize=$.ntoi4(),S.fNevBuf=$.ntoi4(),S.fLast=$.ntoi4(),S.fLast>S.fBufferSize&&(S.fBufferSize=S.fLast);const Ae=$.ntoi1();if(0!==Ae){if(Ae%10!=2){if(S.fNevBuf&&(S.fEntryOffset=$.readFastArray($.ntoi4(),ie),Ae>20&&Ae<40))for(let Ce=0,$e=4278190080;Ce<S.fNevBuf;++Ce)S.fEntryOffset[Ce]&=~$e;Ae>40&&(S.fDisplacement=$.readFastArray($.ntoi4(),ie))}if(1===Ae||Ae>10){const Ce=Z.val<=1?$.ntoi4():S.fLast;if(Ce>S.fKeylen){const $e=$.extract([$.o+S.fKeylen,Ce-S.fKeylen]);S.fBufferRef=new jt($e,0,$.fFile,Ce-S.fKeylen),S.fBufferRef.fTagOffset=S.fKeylen}$.shift(Ce)}}},TRef($,S){$.classStreamer(S,b.clTObject),S.fBits&dn?S.fUUID=$.readTString():S.fPID=$.ntou2()},"TMatrixTSym<float>":($,S)=>{$.classStreamer(S,"TMatrixTBase<float>"),S.fElements=new Float32Array(S.fNelems);const Z=$.readFastArray(S.fNrows*(S.fNcols+1)/2,ue);for(let Ae=0,Ce=0;Ae<S.fNrows;++Ae)for(let $e=Ae;$e<S.fNcols;++$e)S.fElements[$e*S.fNcols+Ae]=S.fElements[Ae*S.fNcols+$e]=Z[Ce++]},"TMatrixTSym<double>":($,S)=>{$.classStreamer(S,"TMatrixTBase<double>"),S.fElements=new Float64Array(S.fNelems);const Z=$.readFastArray(S.fNrows*(S.fNcols+1)/2,Y);for(let Ae=0,Ce=0;Ae<S.fNrows;++Ae)for(let $e=Ae;$e<S.fNcols;++$e)S.fElements[$e*S.fNcols+Ae]=S.fElements[Ae*S.fNcols+$e]=Z[Ce++]}};function hi($,S){switch($){case"bool":case"Bool_t":return F;case"char":case"signed char":case"Char_t":return O;case"Color_t":case"Style_t":case"Width_t":case"short":case"Short_t":return ce;case"int":case"EErrorType":case"Int_t":return ie;case"long":case"Long_t":return he;case"float":case"Float_t":return ue;case"double":case"Double_t":return Y;case"unsigned char":case"UChar_t":return w;case"unsigned short":case"UShort_t":return P;case"unsigned":case"unsigned int":case"UInt_t":return x;case"unsigned long":case"ULong_t":return v;case"int64_t":case"long long":case"Long64_t":return C;case"uint64_t":case"unsigned long long":case"ULong64_t":return L;case"Double32_t":return V;case"Float16_t":return U;case"char*":case"const char*":case"const Char_t*":return le}if(!S){const Z=yn[$];if((0,b.isStr)(Z))return hi(Z,!0)}return-1}function ai($,S,Z){const Ae={_typename:z,fName:$,fTypeName:S,fType:0,fSize:0,fArrayLength:0,fArrayDim:0,fMaxIndex:[0,0,0,0,0],fXmin:0,fXmax:0,fFactor:0};if((0,b.isStr)(S)?(Ae.fType=hi(S),Ae.fType<0&&Z&&Z.fBasicTypes[S]&&(Ae.fType=Z.fBasicTypes[S])):(Ae.fType=S,S=Ae.fTypeName=pn[Ae.fType]||"int"),Ae.fType>0)return Ae;const Ce=S.indexOf("<");let $e=gt;if(Ce>0&&S.indexOf(">")>Ce+2)for(let rt=1;rt<Qt.length;++rt)if(S.slice(0,Ce)===Qt[rt]){$e=rt;break}if($e!==gt)return Ae._typename=xe,Ae.fType=dt,Ae.fSTLtype=$e,Ae.fCtype=0,Ae;const nt=S.lastIndexOf("*")===S.length-1;return nt&&(Ae.fTypeName=S=S.slice(0,S.length-1)),0===Tr(S)?(Ae.fType=k,Ae):(Ae.fType=nt?Te:I,Ae)}function Xi($,S,Z){if(!$){if(0!==S.indexOf("pair"))return null;if(!($=Z.findStreamerInfo(S))){let nt=function(){let rt="",ct=Ce+1,zt=0;for(;ct<$e&&zt>=0;){switch(S[ct]){case"<":zt++;break;case",":0===zt&&zt--;break;case">":zt--}zt>=0&&(rt+=S[ct]),ct++}return Ce=ct-1,rt.trim()},Ce=S.indexOf("<");const $e=S.lastIndexOf(">");($={_typename:"TStreamerInfo",fVersion:1,fName:S,fElements:(0,b.create)(b.clTList)}).fElements.Add(ai("first",nt(),Z)),$.fElements.Add(ai("second",nt(),Z))}}const Ae=Z.getStreamer(S,null,$);if(!Ae)return null;if(2!==Ae.length)return console.error(`Streamer for pair class contains ${Ae.length} elements`),null;for(let Ce=0;Ce<2;++Ce)Ae[Ce].readelem&&!Ae[Ce].pair_name&&(Ae[Ce].pair_name=0===Ce?"first":"second",Ae[Ce].func=function($e,nt){nt[this.pair_name]=this.readelem($e)});return Ae}function Or($,S){const Z={name:$.fName,type:$.fType,fArrayLength:$.fArrayLength,fArrayDim:$.fArrayDim,fMaxIndex:$.fMaxIndex};switch("BASE"===$.fTypeName&&(Tr(Z.name)>0?(Z.name="fArray",Z.type=I):Z.type=j),Z.type){case j:Z.base=$.fBaseVersion,Z.basename=$.fName,Z.func=function(Ae,Ce){Ae.classStreamer(Ce,this.basename)};break;case ce:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi2()};break;case ie:case fe:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi4()};break;case he:case C:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi8()};break;case Y:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntod()};break;case ue:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntof()};break;case D:case w:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntou1()};break;case P:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntou2()};break;case _:case x:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntou4()};break;case L:case v:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntou8()};break;case F:Z.func=function(Ae,Ce){Ce[this.name]=0!==Ae.ntou1()};break;case te+F:case te+ie:case te+fe:case te+Y:case te+w:case te+ce:case te+P:case te+_:case te+x:case te+v:case te+L:case te+he:case te+C:case te+ue:$.fArrayDim<2?(Z.arrlength=$.fArrayLength,Z.func=function(Ae,Ce){Ce[this.name]=Ae.readFastArray(this.arrlength,this.type-te)}):(Z.arrlength=$.fMaxIndex[$.fArrayDim-1],Z.minus1=!0,Z.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,($e,nt)=>$e.readFastArray(nt.arrlength,nt.type-te))});break;case te+O:$.fArrayDim<2?(Z.arrlength=$.fArrayLength,Z.func=function(Ae,Ce){Ce[this.name]=Ae.readFastString(this.arrlength)}):(Z.minus1=!0,Z.arrlength=$.fMaxIndex[$.fArrayDim-1],Z.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,($e,nt)=>$e.readFastString(nt.arrlength))});break;case N+F:case N+ie:case N+Y:case N+w:case N+ce:case N+P:case N+_:case N+x:case N+v:case N+L:case N+he:case N+C:case N+ue:Z.cntname=$.fCountName,Z.func=function(Ae,Ce){Ce[this.name]=1===Ae.ntou1()?Ae.readFastArray(Ce[this.cntname],this.type-N):[]};break;case N+O:Z.cntname=$.fCountName,Z.func=function(Ae,Ce){Ce[this.name]=1===Ae.ntou1()?Ae.readFastString(Ce[this.cntname]):null};break;case V:case te+V:case N+V:Z.double32=!0;case U:case te+U:case N+U:0!==$.fFactor?(Z.factor=1/$.fFactor,Z.min=$.fXmin,Z.read=function(Ae){return Ae.ntou4()*this.factor+this.min}):0===$.fXmin&&Z.double32?Z.read=function(Ae){return Ae.ntof()}:(Z.nbits=Math.round($.fXmin),0===Z.nbits&&(Z.nbits=12),Z.dv=new DataView(new ArrayBuffer(8),0),Z.read=function(Ae){const Ce=Ae.ntou1(),$e=Ae.ntou2();return this.dv.setUint32(0,Ce<<23|($e&(1<<this.nbits+1)-1)<<23-this.nbits),(1<<this.nbits+1&$e?-1:1)*this.dv.getFloat32(0)}),Z.readarr=function(Ae,Ce){const $e=this.double32?new Float64Array(Ce):new Float32Array(Ce);for(let nt=0;nt<Ce;++nt)$e[nt]=this.read(Ae);return $e},Z.type<te?Z.func=function(Ae,Ce){Ce[this.name]=this.read(Ae)}:Z.type>N?(Z.cntname=$.fCountName,Z.func=function(Ae,Ce){Ce[this.name]=1===Ae.ntou1()?this.readarr(Ae,Ce[this.cntname]):null}):$.fArrayDim<2?(Z.arrlength=$.fArrayLength,Z.func=function(Ae,Ce){Ce[this.name]=this.readarr(Ae,this.arrlength)}):(Z.arrlength=$.fMaxIndex[$.fArrayDim-1],Z.minus1=!0,Z.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,($e,nt)=>nt.readarr($e,nt.arrlength))});break;case Te:case R:Z.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,$e=>$e.readObjectAny())};break;case I:case be:case A:case m:{let Ae="BASE"===$.fTypeName?$.fName:$.fTypeName;"*"===Ae[Ae.length-1]&&(Ae=Ae.slice(0,Ae.length-1));const Ce=Tr(Ae);Ce>0?(Z.arrkind=Ce,Z.func=function($e,nt){nt[this.name]=$e.readFastArray($e.ntou4(),this.arrkind)}):0===Ce?Z.func=function($e,nt){nt[this.name]=$e.readTString()}:(Z.classname=Ae,Z.func=$.fArrayLength>1?function($e,nt){nt[this.name]=$e.readNdimArray(this,(rt,ct)=>rt.classStreamer({},ct.classname))}:function($e,nt){nt[this.name]=$e.classStreamer({},this.classname)});break}case te+m:case te+I:case te+be:case te+A:{let Ae=$.fTypeName;"*"===Ae[Ae.length-1]&&(Ae=Ae.slice(0,Ae.length-1)),Z.arrkind=Tr(Ae),Z.arrkind<0&&(Z.classname=Ae),Z.func=function(Ce,$e){$e[this.name]=Ce.readNdimArray(this,(nt,rt)=>rt.arrkind>0?nt.readFastArray(nt.ntou4(),rt.arrkind):0===rt.arrkind?nt.readTString():nt.classStreamer({},rt.classname))};break}case O:Z.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi1()};break;case le:Z.func=function(Ae,Ce){const $e=Ae.ntoi4();Ce[this.name]=Ae.substring(Ae.o,Ae.o+$e),Ae.o+=$e};break;case k:Z.func=function(Ae,Ce){Ce[this.name]=Ae.readTString()};break;case J:case _e:Z.typename=$.fTypeName,Z.func=function(Ae,Ce){Ce[this.name]=Ae.classStreamer({},this.typename)};break;case te+k:case te+J:case te+_e:Z.typename=$.fTypeName,Z.func=function(Ae,Ce){const $e=Ae.readVersion();Ce[this.name]=Ae.readNdimArray(this,(nt,rt)=>rt.typename===b.clTString?nt.readTString():nt.classStreamer({},rt.typename)),Ae.checkByteCount($e,this.typename+"[]")};break;case Q:case te+Q:Z.typename=$.fTypeName,Z.cntname=$.fCountName,Z.typename.lastIndexOf("**")>0?(Z.typename=Z.typename.slice(0,Z.typename.lastIndexOf("**")),Z.isptrptr=!0):(Z.typename=Z.typename.slice(0,Z.typename.lastIndexOf("*")),Z.isptrptr=!1),Z.isptrptr?Z.readitem=function(Ae){return Ae.readObjectAny()}:(Z.arrkind=Tr(Z.typename),Z.readitem=Z.arrkind>0?function(Ae){return Ae.readFastArray(Ae.ntou4(),this.arrkind)}:0===Z.arrkind?function(Ae){return Ae.readTString()}:function(Ae){return Ae.classStreamer({},this.typename)}),void 0!==Z.readitem?(Z.read_loop=function(Ae,Ce){return Ae.readNdimArray(this,($e,nt)=>{const rt=new Array(Ce);for(let ct=0;ct<Ce;++ct)rt[ct]=nt.readitem($e);return rt})},Z.func=function(Ae,Ce){const $e=Ae.readVersion(),nt=this.read_loop(Ae,Ce[this.cntname]);Ce[this.name]=Ae.checkByteCount($e,this.typename)?nt:null},Z.branch_func=function(Ae,Ce){const $e=Ae.readVersion(),nt=Ce[this.stl_size],rt=new Array(nt);for(let ct=0;ct<nt;++ct)rt[ct]=this.read_loop(Ae,Ce[this.cntname][ct]);Ce[this.name]=Ae.checkByteCount($e,this.typename)?rt:null},Z.objs_branch_func=function(Ae,Ce){const $e=Ae.readVersion(),nt=Ce[this.name0];for(let rt=0;rt<nt.length;++rt){const ct=this.get(nt,rt);ct[this.name]=this.read_loop(Ae,ct[this.cntname])}Ae.checkByteCount($e,this.typename)}):(console.error(`fail to provide function for ${$.fName} (${$.fTypeName})  typ = ${$.fType}`),Z.func=function(Ae,Ce){const $e=Ae.readVersion();Ae.checkByteCount($e),Ce[this.name]=null});break;case dt:{Z.typename=$.fTypeName;const Ae=($.fSTLtype||0)%40;if("TStreamerSTLstring"===$._typename||"string"===Z.typename||"string*"===Z.typename)Z.readelem=Ce=>Ce.readTString();else if(Ae===ht||Ae===st||Ae===yt||Ae===It||Ae===An){const Ce=Z.typename.indexOf("<"),$e=Z.typename.lastIndexOf(">");if(Z.conttype=Z.typename.slice(Ce+1,$e).trim(),Z.typeid=hi(Z.conttype),Z.typeid<0&&S.fBasicTypes[Z.conttype]&&(Z.typeid=S.fBasicTypes[Z.conttype],console.log(`!!! Reuse basic type ${Z.conttype} from file streamer infos`)),$.fCtype&&$.fCtype<20&&$.fCtype!==Z.typeid&&(console.warn(`Contained type ${Z.conttype} not recognized as basic type ${$.fCtype} FORCE`),Z.typeid=$.fCtype),Z.typeid>0)Z.readelem=function(nt){return nt.readFastArray(nt.ntoi4(),this.typeid)};else if(Z.isptr=!1,Z.conttype.lastIndexOf("*")===Z.conttype.length-1&&(Z.isptr=!0,Z.conttype=Z.conttype.slice(0,Z.conttype.length-1)),$.fCtype===A&&(Z.isptr=!0),Z.arrkind=Tr(Z.conttype),Z.readelem=Ci,!Z.isptr&&Z.arrkind<0){const nt=ai("temp",Z.conttype);nt.fType===dt&&(nt.$fictional=!0,Z.submember=Or(nt,S))}}else if(Ae===Kt||Ae===Ot){const Ce=Z.typename.indexOf("<"),$e=Z.typename.lastIndexOf(">");Z.pairtype="pair<"+Z.typename.slice(Ce+1,$e)+">",Z.si=S.findStreamerInfo(Z.pairtype),Z.streamer=Xi(Z.si,Z.pairtype,S),(!Z.streamer||2!==Z.streamer.length)&&(console.error(`Fail to build streamer for pair ${Z.pairtype}`),delete Z.streamer),Z.streamer&&(Z.readelem=Rn)}else Ae===on&&(Z.readelem=Ce=>Ce.readFastArray(Ce.ntou4(),F));Z.readelem?$.$fictional||(Z.read_version=function(Ce,$e){if(0===$e)return null;const nt=Ce.readVersion();return this.member_wise=!!(nt.val&lt),this.stl_version=void 0,this.member_wise&&(nt.val=nt.val&~lt,this.stl_version={val:Ce.ntoi2()},this.stl_version.val<=0&&(this.stl_version.checksum=Ce.ntou4())),nt},Z.func=function(Ce,$e){const nt=this.read_version(Ce);let rt=Ce.readNdimArray(this,(ct,zt)=>zt.readelem(ct));Ce.checkByteCount(nt,this.typename)||(rt=null),$e[this.name]=rt},Z.branch_func=function(Ce,$e){const nt=$e[this.stl_size],rt=this.read_version(Ce,nt),ct=new Array(nt);for(let zt=0;zt<nt;++zt)ct[zt]=Ce.readNdimArray(this,(at,nn)=>nn.readelem(at));rt&&Ce.checkByteCount(rt,`branch ${this.typename}`),$e[this.name]=ct},Z.split_func=function(Ce,$e,nt){const rt=this.read_version(Ce);for(let ct=0;ct<nt;++ct)$e[ct][this.name]=Ce.readNdimArray(this,(zt,at)=>at.readelem(zt));Ce.checkByteCount(rt,this.typename)},Z.objs_branch_func=function(Ce,$e){const nt=$e[this.name0],rt=this.read_version(Ce,nt.length);for(let ct=0;ct<nt.length;++ct)this.get(nt,ct)[this.name]=Ce.readNdimArray(this,(at,nn)=>nn.readelem(at));rt&&Ce.checkByteCount(rt,`branch ${this.typename}`)}):(console.error(`failed to create streamer for element ${Z.typename} ${Z.name} element ${$._typename} STL type ${$.fSTLtype}`),Z.func=function(Ce,$e){const nt=Ce.readVersion();Ce.checkByteCount(nt),$e[this.name]=null});break}default:console.error(`fail to provide function for ${$.fName} (${$.fTypeName})  typ = ${$.fType}`),Z.func=function(){}}return Z}function Tr($){if($===b.clTString||"string"===$||yn[$]===b.clTString)return 0;if($.length<7||0!==$.indexOf("TArray"))return-1;if(7===$.length)switch($[6]){case"I":return ie;case"D":return Y;case"F":return ue;case"S":return ce;case"C":return O;case"L":return he;default:return-1}return"TArrayL64"===$?C:-1}function ys($,S){if(null===S)return S;const Z=(0,b.getMethods)($);if(Z)for(const Ae in Z)((0,b.isFunc)(Z[Ae])||0===Ae.indexOf("_"))&&S.push({name:Ae,method:Z[Ae],func(Ce,$e){$e[this.name]=this.method}});return S}const ds=32768,wt=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],pe=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Fe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Et($,S){const Z=new Array(2*ds),Ae=$,Ce=$.byteLength;let rt,ct,zt,_t,Lt,xn,$e=0,nt=null,at=0,nn=0,Wt=-1,gn=!1,ze=0,Qe=0,ut=null,rn=0;function Xt(vs){for(;nn<vs;)rn<Ce&&(at|=Ae[rn++]<<nn),nn+=8}function cn(vs){return at&wt[vs]}function Pn(vs){at>>=vs,nn-=vs}function Zn(vs,Us,mn,jn,Ht,Oi){const Sn={status:0,root:null,m:0},cr=Array(17).fill(0),Cs=Array(17).fill(0),Zr=Array(16).fill(null),ci=Array(288).fill(0),Gs=Array(17).fill(0),os={e:0,b:0,n:0,t:null},Sa=Us>256?vs[256]:16;let hu,Yu,da,aa,Sd,Mi,rl,Yc,Iu,Kc,ef,Md=null,ic=vs,Wd=0,Ra=null,Vo=Us;do{cr[ic[Wd++]]++}while(--Vo>0);if(cr[0]===Us)return Sn;for(aa=1;aa<=16&&0===cr[aa];++aa);for(Sd=aa,Oi<aa&&(Oi=aa),Vo=16;0!==Vo&&0===cr[Vo];--Vo);const qf=Vo;for(Oi>Vo&&(Oi=Vo),Iu=1<<aa;aa<Vo;++aa,Iu<<=1)if((Iu-=cr[aa])<0)return Sn.status=2,Sn.m=Oi,Sn;if((Iu-=cr[Vo])<0)return Sn.status=2,Sn.m=Oi,Sn;for(cr[Vo]+=Iu,Gs[1]=aa=0,ic=cr,Wd=1,Yc=2;--Vo>0;)Gs[Yc++]=aa+=ic[Wd++];ic=vs,Wd=0,Vo=0;do{0!==(aa=ic[Wd++])&&(ci[Gs[aa]++]=Vo)}while(++Vo<Us);for(Us=Gs[qf],Gs[0]=Vo=0,ic=ci,Wd=0,da=-1,rl=Cs[0]=0,Mi=null,Kc=0;Sd<=qf;++Sd)for(hu=cr[Sd];hu-- >0;){for(;Sd>rl+Cs[1+da];){if(rl+=Cs[1+da++],Kc=(Kc=qf-rl)>Oi?Oi:Kc,(Yu=1<<(aa=Sd-rl))>hu+1)for(Yu-=hu+1,Yc=Sd;++aa<Kc&&!((Yu<<=1)<=cr[++Yc]);)Yu-=cr[Yc];for(rl+aa>Sa&&rl<Sa&&(aa=Sa-rl),Kc=1<<aa,Cs[1+da]=aa,Mi=new Array(Kc),ef=0;ef<Kc;++ef)Mi[ef]={e:0,b:0,n:0,t:null};Ra=null==Ra?Sn.root={next:null,list:null}:Ra.next={next:null,list:null},Ra.next=null,Ra.list=Mi,Zr[da]=Mi,da>0&&(Gs[da]=Vo,os.b=Cs[da],os.e=16+aa,os.t=Mi,aa=(Vo&(1<<rl)-1)>>rl-Cs[da],Md=Zr[da-1][aa],Md.e=os.e,Md.b=os.b,Md.n=os.n,Md.t=os.t)}for(os.b=Sd-rl,Wd>=Us?os.e=99:ic[Wd]<mn?(os.e=ic[Wd]<256?16:15,os.n=ic[Wd++]):(os.e=Ht[ic[Wd]-mn],os.n=jn[ic[Wd++]-mn]),Yu=1<<Sd-rl,aa=Vo>>rl;aa<Kc;aa+=Yu)Md=Mi[aa],Md.e=os.e,Md.b=os.b,Md.n=os.n,Md.t=os.t;for(aa=1<<Sd-1;Vo&aa;aa>>=1)Vo^=aa;for(Vo^=aa;(Vo&(1<<rl)-1)!==Gs[da];)rl-=Cs[da--]}return Sn.m=Cs[1],Sn.status=0!==Iu&&1!==qf?1:0,Sn}function Ui(vs,Us,mn){if(0===mn)return 0;let jn,Ht,Oi=0;for(;;){for(Xt(Lt),Ht=ut.list[cn(Lt)],jn=Ht.e;jn>16;){if(99===jn)return-1;Pn(Ht.b),jn-=16,Xt(jn),Ht=Ht.t[cn(jn)],jn=Ht.e}if(Pn(Ht.b),16!==jn){if(15===jn)break;for(Xt(jn),ze=Ht.n+cn(jn),Pn(jn),Xt(xn),Ht=_t.list[cn(xn)],jn=Ht.e;jn>16;){if(99===jn)return-1;Pn(Ht.b),jn-=16,Xt(jn),Ht=Ht.t[cn(jn)],jn=Ht.e}for(Pn(Ht.b),Xt(jn),Qe=$e-Ht.n-cn(jn),Pn(jn);ze>0&&Oi<mn;)--ze,Qe&=ds-1,$e&=ds-1,vs[Us+Oi++]=Z[$e++]=Z[Qe++];if(Oi===mn)return mn}else if($e&=ds-1,vs[Us+Oi++]=Z[$e++]=Ht.n,Oi===mn)return mn}return Wt=-1,Oi}function Ki(vs,Us,mn){let jn=7&nn;if(Pn(jn),Xt(16),jn=cn(16),Pn(16),Xt(16),jn!==(65535&~at))return-1;for(Pn(16),ze=jn,jn=0;ze>0&&jn<mn;)--ze,$e&=ds-1,Xt(8),vs[Us+jn++]=Z[$e++]=cn(8),Pn(8);return 0===ze&&(Wt=-1),jn}function Ii(vs,Us,mn){if(null==nt){const jn=Array(288).fill(8,0,144).fill(9,144,256).fill(7,256,280).fill(8,280,288);ct=7;let Ht=Zn(jn,288,257,W,pe,ct);if(0!==Ht.status)throw new Error("HufBuild error: "+Ht.status);if(nt=Ht.root,ct=Ht.m,jn.fill(5,0,30),zt=5,Ht=Zn(jn,30,0,me,Fe,zt),Ht.status>1)throw nt=null,new Error("HufBuild error: "+Ht.status);rt=Ht.root,zt=Ht.m}return ut=nt,_t=rt,Lt=ct,xn=zt,Ui(vs,Us,mn)}function vr(vs,Us,mn){let jn,Ht,Oi,Sn,Wn;const yr=new Array(316).fill(0);Xt(5);const cr=257+cn(5);Pn(5),Xt(5);const Cs=1+cn(5);Pn(5),Xt(4);const Zr=4+cn(4);if(Pn(4),cr>286||Cs>30)return-1;for(Ht=0;Ht<Zr;++Ht)Xt(3),yr[At[Ht]]=cn(3),Pn(3);for(;Ht<19;++Ht)yr[At[Ht]]=0;if(Lt=7,Wn=Zn(yr,19,19,null,null,Lt),0!==Wn.status)return-1;ut=Wn.root,Lt=Wn.m;const ci=cr+Cs;for(jn=Oi=0;jn<ci;)if(Xt(Lt),Sn=ut.list[cn(Lt)],Ht=Sn.b,Pn(Ht),Ht=Sn.n,Ht<16)yr[jn++]=Oi=Ht;else if(16===Ht){if(Xt(2),Ht=3+cn(2),Pn(2),jn+Ht>ci)return-1;for(;Ht-- >0;)yr[jn++]=Oi}else if(17===Ht){if(Xt(3),Ht=3+cn(3),Pn(3),jn+Ht>ci)return-1;for(;Ht-- >0;)yr[jn++]=0;Oi=0}else{if(Xt(7),Ht=11+cn(7),Pn(7),jn+Ht>ci)return-1;for(;Ht-- >0;)yr[jn++]=0;Oi=0}if(Lt=9,Wn=Zn(yr,cr,257,W,pe,Lt),0===Lt&&(Wn.status=1),0!==Wn.status)return-1;for(ut=Wn.root,Lt=Wn.m,jn=0;jn<Cs;++jn)yr[jn]=yr[jn+cr];return xn=6,Wn=Zn(yr,Cs,0,me,Fe,xn),_t=Wn.root,xn=Wn.m,0===xn&&cr>257||0!==Wn.status?-1:Ui(vs,Us,mn)}function $r(vs,Us,mn){let Ht,jn=0;for(;jn<mn;){if(gn&&-1===Wt)return jn;if(ze>0){if(0!==Wt)for(;ze>0&&jn<mn;)--ze,Qe&=ds-1,$e&=ds-1,vs[Us+jn++]=Z[$e++]=Z[Qe++];else{for(;ze>0&&jn<mn;)--ze,$e&=ds-1,Xt(8),vs[Us+jn++]=Z[$e++]=cn(8),Pn(8);0===ze&&(Wt=-1)}if(jn===mn)return jn}if(-1===Wt){if(gn)break;Xt(1),0!==cn(1)&&(gn=!0),Pn(1),Xt(2),Wt=cn(2),Pn(2),ut=null,ze=0}switch(Wt){case 0:Ht=Ki(vs,Us+jn,mn-jn);break;case 1:Ht=null!=ut?Ui(vs,Us+jn,mn-jn):Ii(vs,Us+jn,mn-jn);break;case 2:Ht=null!=ut?Ui(vs,Us+jn,mn-jn):vr(vs,Us+jn,mn-jn);break;default:Ht=-1}if(-1===Ht)return gn?0:-1;jn+=Ht}return jn}let yo,Ho=0;for(;(yo=$r(S,Ho,Math.min(1024,S.byteLength-Ho)))>0;)Ho+=yo;return Ho}function St($,S,Z,Ae){let Ce=0;for(let $e=Z=Z||0,nt=Ae=Ae||$.length-Z;$e<nt;){const rt=$[$e++];let ct=rt>>4;if(ct>0){let ze=ct+240;for(;255===ze;)ze=$[$e++],ct+=ze;const Qe=$e+ct;for(;$e<Qe;)S[Ce++]=$[$e++];if($e===nt)return Ce}const zt=$[$e++]|$[$e++]<<8;if(0===zt||zt>Ce)return-($e-2);let at=15&rt,nn=at+240;for(;255===nn;)nn=$[$e++],at+=nn;let Wt=Ce-zt;const gn=Ce+at+4;for(;Ce<gn;)S[Ce++]=S[Wt++]}return Ce}function xt($,S,Z,Ae){return En.apply(this,arguments)}function En(){return(En=(0,ve.A)(function*($,S,Z,Ae){const $e=$.byteLength,nt=(Wt,gn)=>String.fromCharCode($.getUint8(Wt))===gn,rt=Wt=>$.getUint8(Wt);let ct=Ae||0,zt=0,at=null;const nn=()=>{for(;zt<S;){let Wt="unknown",gn=0,ze=0;if(ct+9>=$e)return Z||console.error("Error R__unzip: header size exceeds buffer size"),Promise.resolve(null);if(nt(ct,"Z")&&nt(ct+1,"L")&&8===rt(ct+2)?(Wt="new",gn=2):nt(ct,"C")&&nt(ct+1,"S")&&8===rt(ct+2)?(Wt="old",gn=0):nt(ct,"X")&&nt(ct+1,"Z")&&0===rt(ct+2)?(Wt="LZMA",gn=0):nt(ct,"Z")&&nt(ct+1,"S")&&1===rt(ct+2)?Wt="ZSTD":nt(ct,"L")&&nt(ct+1,"4")&&(Wt="LZ4",gn=0,ze=8),"new"!==Wt&&"old"!==Wt&&"LZ4"!==Wt&&"ZSTD"!==Wt&&"LZMA"!==Wt)return Z||console.error(`R__unzip: ${Wt} format is not supported!`),Promise.resolve(null);const Qe=9+(255&rt(ct+3)|(255&rt(ct+4))<<8|(255&rt(ct+5))<<16),ut=new Uint8Array($.buffer,$.byteOffset+ct+9+gn+ze,Math.min($.byteLength-ct-9-gn-ze,Qe-9-ze));at||(at=new ArrayBuffer(S));const _t=new Uint8Array(at,zt);if("ZSTD"===Wt)return(b.internals._ZstdStream?Promise.resolve(b.internals._ZstdStream):((0,b.isNodeJs)()?Ee.e(474).then(Ee.t.bind(Ee,6474,19)):import("./base/zstd.mjs")).then(({ZstdInit:rn})=>rn()).then(({ZstdStream:rn})=>(b.internals._ZstdStream=rn,rn))).then(rn=>{const Xt=rn.decompress(ut),cn=Xt.length;for(let Pn=0;Pn<cn;++Pn)_t[Pn]=Xt[Pn];return zt+=cn,ct+=Qe,nn()});if("LZMA"===Wt)return import("./base/lzma.mjs").then(xn=>{const rn=255&rt(ct+6)|(255&rt(ct+7))<<8|(255&rt(ct+8))<<16,Xt=xn.decompress(ut,_t,rn);return zt+=Xt,ct+=Qe,nn()});const Lt="LZ4"===Wt?St(ut,_t):Et(ut,_t);if(Lt<=0)break;zt+=Lt,ct+=Qe}return zt!==S?(Z||console.error(`R__unzip: fail to unzip data expects ${S}, got ${zt}`),Promise.resolve(null)):Promise.resolve(new DataView(at))};return nn()})).apply(this,arguments)}class jt{constructor(S,Z,Ae,Ce){this._typename="TBuffer",this.arr=S,this.o=Z||0,this.fFile=Ae,this.length=Ce||(S?S.byteLength:0),this.clearObjectMap(),this.fTagOffset=0,this.last_read_version=0}locate(S){this.o=S}shift(S){this.o+=S}remain(){return this.length-this.o}getMappedObject(S){return this.fObjectMap[S]}mapObject(S,Z){null!==Z&&(this.fObjectMap[S]=Z)}mapClass(S,Z){this.fClassMap[S]=Z}getMappedClass(S){return S in this.fClassMap?this.fClassMap[S]:-1}clearObjectMap(){this.fObjectMap={},this.fClassMap={},this.fObjectMap[0]=null,this.fDisplacement=0}readVersion(){const S={},Z=this.ntou4();return Z&Ze?S.bytecnt=Z-Ze-2:this.o-=4,this.last_read_version=S.val=this.ntoi2(),this.last_read_checksum=0,S.off=this.o,S.val<=0&&S.bytecnt&&S.bytecnt>=4&&(S.checksum=this.ntou4(),this.fFile.findStreamerInfo(void 0,void 0,S.checksum)?this.last_read_checksum=S.checksum:(this.o-=4,delete S.checksum)),S}checkByteCount(S,Z){return void 0===S.bytecnt||S.off+S.bytecnt===this.o||(Z&&console.log(`Missmatch in ${Z} bytecount expected = ${S.bytecnt}  got = ${this.o-S.off}`),this.o=S.off+S.bytecnt,!1)}readTString(){let S=this.ntou1();if(255===S&&(S=this.ntou4()),0===S)return"";const Z=this.o;return this.o+=S,0===this.codeAt(Z)?"":this.substring(Z,Z+S)}readFastString(S){let Ae,Z="",Ce=!1;for(let $e=0;(S<0||$e<S)&&(Ae=this.ntou1(),!(0===Ae&&(Ce=!0,S<0)));++$e)Ce||(Z+=String.fromCharCode(Ae));return Z}ntou1(){return this.arr.getUint8(this.o++)}ntou2(){const S=this.o;return this.o+=2,this.arr.getUint16(S)}ntou4(){const S=this.o;return this.o+=4,this.arr.getUint32(S)}ntou8(){const S=this.arr.getUint32(this.o);this.o+=4;const Z=this.arr.getUint32(this.o);return this.o+=4,S<2097152?4294967296*S+Z:BigInt(S)*BigInt(4294967296)+BigInt(Z)}ntoi1(){return this.arr.getInt8(this.o++)}ntoi2(){const S=this.o;return this.o+=2,this.arr.getInt16(S)}ntoi4(){const S=this.o;return this.o+=4,this.arr.getInt32(S)}ntoi8(){const S=this.arr.getUint32(this.o);this.o+=4;const Z=this.arr.getUint32(this.o);return this.o+=4,S<2147483648?S<2097152?4294967296*S+Z:BigInt(S)*BigInt(4294967296)+BigInt(Z):~S<2097152?-1-(4294967296*~S+~Z):BigInt(-1)-(BigInt(~S)*BigInt(4294967296)+BigInt(~Z))}ntof(){const S=this.o;return this.o+=4,this.arr.getFloat32(S)}ntod(){const S=this.o;return this.o+=8,this.arr.getFloat64(S)}readFastArray(S,Z){let Ae,Ce=0,$e=this.o;const nt=this.arr;switch(Z){case Y:for(Ae=new Float64Array(S);Ce<S;++Ce,$e+=8)Ae[Ce]=nt.getFloat64($e);break;case ue:for(Ae=new Float32Array(S);Ce<S;++Ce,$e+=4)Ae[Ce]=nt.getFloat32($e);break;case he:case C:for(Ae=new Array(S);Ce<S;++Ce)Ae[Ce]=this.ntoi8();return Ae;case v:case L:for(Ae=new Array(S);Ce<S;++Ce)Ae[Ce]=this.ntou8();return Ae;case ie:case fe:for(Ae=new Int32Array(S);Ce<S;++Ce,$e+=4)Ae[Ce]=nt.getInt32($e);break;case ce:for(Ae=new Int16Array(S);Ce<S;++Ce,$e+=2)Ae[Ce]=nt.getInt16($e);break;case P:for(Ae=new Uint16Array(S);Ce<S;++Ce,$e+=2)Ae[Ce]=nt.getUint16($e);break;case O:for(Ae=new Int8Array(S);Ce<S;++Ce)Ae[Ce]=nt.getInt8($e++);break;case F:case w:for(Ae=new Uint8Array(S);Ce<S;++Ce)Ae[Ce]=nt.getUint8($e++);break;case k:for(Ae=new Array(S);Ce<S;++Ce)Ae[Ce]=this.readTString();return Ae;case V:throw new Error("kDouble32 should not be used in readFastArray");case U:throw new Error("kFloat16 should not be used in readFastArray");default:for(Ae=new Uint32Array(S);Ce<S;++Ce,$e+=4)Ae[Ce]=nt.getUint32($e)}return this.o=$e,Ae}canExtract(S){for(let Z=0;Z<S.length;Z+=2)if(S[Z]+S[Z+1]>this.length)return!1;return!0}extract(S){if(!this.arr||!this.arr.buffer||!this.canExtract(S))return null;if(2===S.length)return new DataView(this.arr.buffer,this.arr.byteOffset+S[0],S[1]);const Z=new Array(S.length/2);for(let Ae=0;Ae<S.length;Ae+=2)Z[Ae/2]=new DataView(this.arr.buffer,this.arr.byteOffset+S[Ae],S[Ae+1]);return Z}codeAt(S){return this.arr.getUint8(S)}substring(S,Z){let Ae="";for(let Ce=S;Ce<Z;++Ce)Ae+=String.fromCharCode(this.arr.getUint8(Ce));return Ae}readNdimArray(S,Z){let $e,Ae=S.fArrayDim,Ce=S.fMaxIndex;if(Ae<1&&S.fArrayLength>0&&(Ae=1,Ce=[S.fArrayLength]),S.minus1&&--Ae,Ae<1)return Z(this,S);if(1===Ae){$e=new Array(Ce[0]);for(let nt=0;nt<Ce[0];++nt)$e[nt]=Z(this,S)}else if(2===Ae){$e=new Array(Ce[0]);for(let nt=0;nt<Ce[0];++nt){const rt=new Array(Ce[1]);for(let ct=0;ct<Ce[1];++ct)rt[ct]=Z(this,S);$e[nt]=rt}}else{const nt=new Array(Ae).fill(0),rt=new Array(Ae);for(let ct=0;ct<Ae;++ct)rt[ct]=[];for($e=rt[0];nt[0]<Ce[0];){let ct=Ae-1;for(rt[ct].push(Z(this,S)),++nt[ct];nt[ct]===Ce[ct]&&ct>0;)nt[ct]=0,rt[ct-1].push(rt[ct]),rt[ct]=[],++nt[--ct]}}return $e}readTKey(S){S||(S={}),this.classStreamer(S,b.clTKey);const Z=S.fName.replace(/['"]/g,"");return Z!==S.fName&&(S.fRealName=S.fName,S.fName=Z),S}readBasketEntryOffset(S,Z){if(this.locate(S.fLast-Z),this.remain()<=0)return!S.fEntryOffset&&S.fNevBuf<=1&&(S.fEntryOffset=[S.fKeylen]),void(S.fEntryOffset||console.warn(`No fEntryOffset when expected for basket with ${S.fNevBuf} entries`));const Ae=this.ntoi4();if(Ae<0||Ae>4*this.remain())return console.error(`Error when reading entries offset from basket fNevBuf ${S.fNevBuf} remains ${this.remain()} want to read ${Ae}`),void(S.fNevBuf<=1&&(S.fEntryOffset=[S.fKeylen]));S.fEntryOffset=this.readFastArray(Ae,ie),S.fEntryOffset||(S.fEntryOffset=[S.fKeylen]),S.fDisplacement=this.remain()>0?this.readFastArray(this.ntoi4(),ie):void 0}readClass(){const S={name:-1},Z=this.ntou4(),Ae=this.o;let Ce;if(Ce=Z&Ze&&Z!==Ue?this.ntou4():Z,!(Ce&Oe))return S.objtag=Ce+this.fDisplacement,S;if(Ce===Ue)S.name=this.readFastString(-1),-1===this.getMappedClass(this.fTagOffset+Ae+2)&&this.mapClass(this.fTagOffset+Ae+2,S.name);else{const $e=(Ce&~Oe)+this.fDisplacement;S.name=this.getMappedClass($e),-1===S.name&&console.error(`Did not found class with tag ${$e}`)}return S}readObjectAny(){const S=this.fTagOffset+this.o+2,Z=this.readClass();if("objtag"in Z)return this.getMappedObject(Z.objtag);if(-1===Z.name)return null;const Ae=Tr(Z.name);let Ce;return 0===Ae?Ce=this.readTString():Ae>0?(Ce=this.readFastArray(this.ntou4(),Ae),this.mapObject(S,Ce)):(Ce={},this.mapObject(S,Ce),this.classStreamer(Ce,Z.name)),Ce}classStreamer(S,Z){void 0===S._typename&&(S._typename=Z);const Ae=ti[Z];if(Ae)return Ae(this,S),S;const Ce=this.readVersion(),$e=this.fFile.getStreamer(Z,Ce);if(null!==$e){const nt=$e.length;for(let rt=0;rt<nt;++rt)$e[rt].func(this,S)}else(0,b.addMethods)(S);return this.checkByteCount(Ce,Z),S}}class Cn{constructor(S,Z,Ae){this.fFile=S,this._typename=Je,this.dir_name=Z,this.dir_cycle=Ae,this.fKeys=[]}getKey(S,Z,Ae){"number"!=typeof Z&&(Z=-1);let Ce=null;for(let nt=0;nt<this.fKeys.length;++nt){const rt=this.fKeys[nt];if(rt&&rt.fName===S){if(rt.fCycle===Z){Ce=rt;break}Z<0&&(!Ce||rt.fCycle>Ce.fCycle)&&(Ce=rt)}}if(Ce)return Ae?Ce:Promise.resolve(Ce);let $e=S.lastIndexOf("/");for(;$e>0;){const nt=S.slice(0,$e),rt=S.slice($e+1),ct=this.getKey(nt,void 0,!0);if(ct&&!Ae&&0===ct.fClassName.indexOf(Je))return this.fFile.readObject(this.dir_name+"/"+nt,1).then(zt=>zt.getKey(rt,Z));$e=S.lastIndexOf("/",$e-1)}return Ae?null:Promise.reject(Error(`Key not found ${S}`))}readObject(S,Z){return this.fFile.readObject(this.dir_name+"/"+S,Z)}readKeys(S){var Z=this;return(0,ve.A)(function*(){return S.classStreamer(Z,Je),Z.fSeekKeys<=0||Z.fNbytesKeys<=0?Z:Z.fFile.readBuffer([Z.fSeekKeys,Z.fNbytesKeys]).then(Ae=>{const Ce=new jt(Ae,0,Z.fFile);Ce.readTKey();const $e=Ce.ntoi4();for(let nt=0;nt<$e;++nt)Z.fKeys.push(Ce.readTKey());return Z.fFile.fDirectories.push(Z),Z})})()}}class ln{constructor(S){if(this._typename=b.clTFile,this.fEND=0,this.fFullURL=S,this.fURL=S,this.fAcceptRanges=!0,this.fUseStampPar=!!b.settings.UseStamp&&"stamp="+(new Date).getTime(),this.fFileContent=null,this.fMaxRanges=b.settings.MaxRanges||200,this.fDirectories=[],this.fKeys=[],this.fSeekInfo=0,this.fNbytesInfo=0,this.fTagOffset=0,this.fStreamers=0,this.fStreamerInfos=null,this.fFileName="",this.fStreamers=[],this.fBasicTypes={},!(0,b.isStr)(this.fURL))return this;"+"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fAcceptRanges=!1),"^"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fSkipHeadRequest=!0),"-"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fUseStampPar=!1),0===this.fURL.indexOf("file://")&&(this.fUseStampPar=!1,this.fAcceptRanges=!1);const Z=Math.max(this.fURL.lastIndexOf("/"),this.fURL.lastIndexOf("\\"));this.fFileName=Z>=0?this.fURL.slice(Z+1):this.fURL}assignFileContent(S){this.fFileContent=new jt(new DataView(S)),this.fAcceptRanges=!1,this.fUseStampPar=!1,this.fEND=this.fFileContent.length}_open(){var S=this;return(0,ve.A)(function*(){return S.readKeys()})()}readBuffer(S,Z,Ae){var Ce=this;return(0,ve.A)(function*(){if(null!==Ce.fFileContent&&!Z&&(!Ce.fAcceptRanges||Ce.fFileContent.canExtract(S)))return Ce.fFileContent.extract(S);let $e,nt;const rt=Ce,ct=0===S[0]&&2===S.length,zt=[],at=new Promise((Lt,xn)=>{$e=Lt,nt=xn});let ze,Qe,nn=rt.fURL,Wt=0,gn=0,ut=!1;if((0,b.isStr)(Z)&&Z){const Lt=nn.lastIndexOf("/");nn=Lt<0?Z:nn.slice(0,Lt+1)+Z}function _t(Lt){if(Lt&&(Wt=gn,gn=Math.min(Wt+2*rt.fMaxRanges,S.length),Wt>=S.length))return $e(zt);let xn=nn,rn="bytes",Xt=0;rt.fUseStampPar&&(xn+=(xn.indexOf("?")<0?"?":"&")+rt.fUseStampPar);for(let cn=Wt;cn<gn;cn+=2)rn+=(cn>Wt?",":"=")+`${S[cn]}-${S[cn]+S[cn+1]-1}`,Xt+=S[cn+1];return gn-Wt>2&&(Xt+=60*(gn-Wt)),rt.fAcceptRanges&&ct&&(Xt=Math.max(Xt,1e7)),(0,b.createHttpRequest)(xn,"buf",ze,void 0,!0).then(cn=>{if(rt.fAcceptRanges&&(cn.setRequestHeader("Range",rn),cn.expected_size=Math.max(Math.round(1.1*Xt),Xt+200)),(0,b.isFunc)(Ae)&&(0,b.isFunc)(cn.addEventListener)){let Pn=0,Zn=0,Ui=0;for(let vr=1;vr<S.length;vr+=2)Ui+=S[vr],vr<Wt&&(Pn+=S[vr]),vr<gn&&(Zn+=S[vr]);Ui||(Ui=1);const Ki=Pn/Ui,Ii=(Zn-Pn)/Ui;cn.addEventListener("progress",vr=>{vr.lengthComputable&&"break"===Ae(Ki+Ii*vr.loaded/vr.total)&&cn.abort()})}else ut&&(0,b.isFunc)(cn.addEventListener)&&cn.addEventListener("progress",Pn=>{Pn.total?Pn.total>5e7&&(console.error(`Try to load very large file ${Pn.total} at once - abort`),cn.abort()):console.warn("Fail to get file size information")});Qe=ct?cn:null,cn.send(null)})}return ze=function(Lt){if(!Lt&&ct){if(rt.fUseStampPar)return rt.fUseStampPar=!1,_t();if(rt.fAcceptRanges)return rt.fAcceptRanges=!1,ut=!0,_t()}if(Lt&&Qe){rt.fAcceptRanges&&206===Qe.status&&Lt?.byteLength===S[1]&&!Qe.getResponseHeader("Content-Range")&&rt.fMaxRanges>1&&(console.warn('Server response with 206 code but browser does not provide access to Content-Range header - setting fMaxRanges = 1, consider to load full file with "filename.root+" argument or adjust server configurations'),rt.fMaxRanges=1);const Ki=b.browser.isFirefox?Qe.getResponseHeader("Server"):"";(0,b.isStr)(Ki)&&0===Ki.indexOf("SimpleHTTP")&&(rt.fMaxRanges=1,rt.fUseStampPar=!1)}if(Lt&&ct&&!rt.fFileContent)return rt.fFileContent=new jt((0,b.isStr)(Lt)?Lt:new DataView(Lt)),rt.fAcceptRanges||(rt.fEND=rt.fFileContent.length),$e(rt.fFileContent.extract(S));if(!Lt)return 0===Wt&&gn>2&&rt.fMaxRanges>1?(rt.fMaxRanges=gn/2>200?200:gn/2>50?50:gn/2>20?20:gn/2>5?5:1,gn=Math.min(gn,2*rt.fMaxRanges),_t()):nt(Error("Fail to read with several ranges"));if(gn-Wt==2){const Ki=new DataView(Lt);return 2===S.length?$e(Ki):(zt.push(Ki),_t(!0))}const xn=this.getResponseHeader("Content-Type"),rn=(0,b.isStr)(xn)&&xn.indexOf("multipart")>=0,Xt=new DataView(Lt);if(!rn){const Ki=this.getResponseHeader("Content-Range");let Ii=0,vr=-1;if((0,b.isStr)(Ki)&&Ki.indexOf("bytes")>=0){const yo=Ki.slice(Ki.indexOf("bytes")+6).split(/[\s-/]+/);3===yo.length&&(Ii=Number.parseInt(yo[0]),vr=Number.parseInt(yo[1]),(!Number.isInteger(Ii)||!Number.isInteger(vr)||Ii>vr)&&(Ii=0,vr=-1))}let $r=Ii<=vr;for(let yo=Wt;yo<gn;yo+=2)(S[yo]<Ii||S[yo]+S[yo+1]-1>vr)&&($r=!1);if($r){for(let yo=Wt;yo<gn;yo+=2)zt.push(new DataView(Lt,S[yo]-Ii,S[yo+1]));return _t(!0)}return 1===rt.fMaxRanges||0!==Wt?nt(Error("Server returns normal response when multipart was requested, disable multirange support")):(rt.fMaxRanges=1,gn=Math.min(gn,2*rt.fMaxRanges),_t())}const cn=xn.indexOf("boundary=");let Pn="",Zn=Wt,Ui=0;for(cn>0?(Pn=xn.slice(cn+9),'"'===Pn[0]&&'"'===Pn[Pn.length-1]&&(Pn=Pn.slice(1,Pn.length-1)),Pn="--"+Pn):console.error("Did not found boundary id in the response header");Zn<gn;){let Ki,Ii=Xt.getUint8(Ui),vr=0,$r="",yo=!1,Ho=0,vs=-1;for(;Ui<Xt.byteLength-1&&!yo&&vr<5;){if(Ki=Ii,Ii=Xt.getUint8(Ui+1),13===Ki&&10===Ii||10===Ki){if($r.length>2&&"--"===$r.slice(0,2)&&$r!==Pn)return nt(Error(`Decode multipart message, expect boundary ${Pn} got ${$r}`));if($r=$r.toLowerCase(),$r.indexOf("content-range")>=0&&$r.indexOf("bytes")>0){const Us=$r.slice($r.indexOf("bytes")+6).split(/[\s-/]+/);3===Us.length?(Ho=Number.parseInt(Us[0]),vs=Number.parseInt(Us[1]),(!Number.isInteger(Ho)||!Number.isInteger(vs)||Ho>vs)&&(Ho=0,vs=-1)):console.error(`Fail to decode content-range ${$r} ${Us}`)}vr>1&&0===$r.length&&(yo=!0),vr++,$r="",10!==Ki&&(Ui++,Ii=Xt.getUint8(Ui+1))}else $r+=String.fromCharCode(Ki);Ui++}if(!yo)return nt(Error("Cannot decode header in multipart message"));if(Ho>vs)zt.push(new DataView(Lt,Ui,S[Zn+1])),Ui+=S[Zn+1],Zn+=2;else{for(;Zn<gn&&S[Zn]>=Ho&&S[Zn]+S[Zn+1]-1<=vs;)zt.push(new DataView(Lt,Ui+S[Zn]-Ho,S[Zn+1])),Zn+=2;Ui+=vs-Ho+1}}_t(!0)},_t(!0).then(()=>at)})()}getFileName(){return this.fFileName}getDir(S,Z){if(void 0===Z&&(0,b.isStr)(S)){const Ae=S.lastIndexOf(";");Ae>0&&(Z=Number.parseInt(S.slice(Ae+1)),S=S.slice(0,Ae))}for(let Ae=0;Ae<this.fDirectories.length;++Ae){const Ce=this.fDirectories[Ae];if(Ce.dir_name===S&&(void 0===Z||Ce.dir_cycle===Z))return Ce}return null}getKey(S,Z,Ae){"number"!=typeof Z&&(Z=-1);let Ce=null;for(let nt=0;nt<this.fKeys.length;++nt){const rt=this.fKeys[nt];if(rt&&rt.fName===S){if(rt.fCycle===Z){Ce=rt;break}Z<0&&(!Ce||rt.fCycle>Ce.fCycle)&&(Ce=rt)}}if(Ce)return Ae?Ce:Promise.resolve(Ce);let $e=S.lastIndexOf("/");for(;$e>0;){const nt=S.slice(0,$e),rt=S.slice($e+1),ct=this.getDir(nt);if(ct)return ct.getKey(rt,Z,Ae);const zt=this.getKey(nt,void 0,!0);if(zt&&!Ae&&0===zt.fClassName.indexOf(Je))return this.readObject(nt).then(at=>at.getKey(rt,Z));$e=S.lastIndexOf("/",$e-1)}return Ae?null:Promise.reject(Error(`Key not found ${S}`))}readObjBuffer(S){var Z=this;return(0,ve.A)(function*(){return Z.readBuffer([S.fSeekKey+S.fKeylen,S.fNbytes-S.fKeylen]).then(Ae=>{if(S.fObjlen<=S.fNbytes-S.fKeylen){const Ce=new jt(Ae,0,Z);return Ce.fTagOffset=S.fKeylen,Ce}return xt(Ae,S.fObjlen).then(Ce=>{if(!Ce)return Promise.reject(Error(`Fail to UNZIP buffer for ${S.fName}`));const $e=new jt(Ce,0,Z);return $e.fTagOffset=S.fKeylen,$e})})})()}readObject(S,Z,Ae){var Ce=this;return(0,ve.A)(function*(){const $e=S.lastIndexOf(";");for($e>=0&&(Z=Number.parseInt(S.slice($e+1)),S=S.slice(0,$e)),"number"!=typeof Z&&(Z=-1);S.length&&"/"===S[0];)S=S.slice(1);return Ce.getKey(S,Z).then(nt=>{if(S===Ie&&nt.fClassName===b.clTList)return Ce.fStreamerInfos;let rt=!1;if(nt.fClassName===Je||nt.fClassName===Xe){const ct=Ce.getDir(S,Z);if(ct)return ct;rt=!0}return!rt&&Ae?Promise.reject(Error(`Key ${S} is not directory}`)):Ce.readObjBuffer(nt).then(ct=>{if(rt){const at=new Cn(Ce,S,Z);return at.fTitle=nt.fTitle,at.readKeys(ct)}const zt={};return ct.mapObject(1,zt),ct.classStreamer(zt,nt.fClassName),nt.fClassName===b.clTF1||nt.fClassName===b.clTF2?Ce._readFormulas(zt):zt})})})()}_readFormulas(S){var Z=this;return(0,ve.A)(function*(){const Ae=[];for(let Ce=0;Ce<Z.fKeys.length;++Ce)"TFormula"===Z.fKeys[Ce].fClassName&&Ae.push(Z.readObject(Z.fKeys[Ce].fName,Z.fKeys[Ce].fCycle));return Promise.all(Ae).then(Ce=>(Ce.forEach($e=>S.addFormula($e)),S))})()}extractStreamerInfos(S){if(!S)return;const Z={};S.mapObject(1,Z);try{S.classStreamer(Z,b.clTList)}catch(Ae){return void console.error("Fail extract streamer infos",Ae)}Z._typename=et,this.fStreamerInfos=Z,(0,b.isFunc)(b.internals.addStreamerInfosForPainter)&&b.internals.addStreamerInfosForPainter(Z);for(let Ae=0;Ae<Z.arr.length;++Ae){const Ce=Z.arr[Ae];if(Ce.fElements)for(let $e=0;$e<Ce.fElements.arr.length;++$e){const nt=Ce.fElements.arr[$e];if(!nt.fTypeName||!nt.fType)continue;let rt=nt.fType,ct=nt.fTypeName;if(rt>=60){if(rt===dt&&nt._typename===xe&&nt.fSTLtype&&nt.fCtype&&nt.fCtype<20){const at=(Qt[nt.fSTLtype]||"undef")+"<";if(0===ct.indexOf(at)&&">"===ct[ct.length-1]&&(rt=nt.fCtype,ct=ct.slice(at.length,ct.length-1).trim(),nt.fSTLtype===Kt||nt.fSTLtype===Ot)){if(!(ct.indexOf(",")>0))continue;ct=ct.slice(0,ct.indexOf(",")).trim()}}if(rt>=60)continue}else rt>20&&"*"===ct[ct.length-1]&&(ct=ct.slice(0,ct.length-1)),rt%=20;const zt=hi(ct);zt!==rt&&(rt===_&&zt===x||rt===fe&&zt===ie||ct&&rt&&this.fBasicTypes[ct]!==rt&&(this.fBasicTypes[ct]=rt))}}}readKeys(){var S=this;return(0,ve.A)(function*(){return S.readBuffer([0,1024]).then(Z=>{const Ae=new jt(Z,0,S);if("root"!==Ae.substring(0,4))return Promise.reject(Error(`Not a ROOT file ${S.fURL}`));if(Ae.shift(4),S.fVersion=Ae.ntou4(),S.fBEGIN=Ae.ntou4(),S.fVersion<1e6?(S.fEND=Ae.ntou4(),S.fSeekFree=Ae.ntou4(),S.fNbytesFree=Ae.ntou4(),Ae.shift(4),S.fNbytesName=Ae.ntou4(),S.fUnits=Ae.ntou1(),S.fCompress=Ae.ntou4(),S.fSeekInfo=Ae.ntou4(),S.fNbytesInfo=Ae.ntou4()):(S.fEND=Ae.ntou8(),S.fSeekFree=Ae.ntou8(),S.fNbytesFree=Ae.ntou4(),Ae.shift(4),S.fNbytesName=Ae.ntou4(),S.fUnits=Ae.ntou1(),S.fCompress=Ae.ntou4(),S.fSeekInfo=Ae.ntou8(),S.fNbytesInfo=Ae.ntou4()),!S.fSeekInfo||!S.fNbytesInfo)return Promise.reject(Error(`File ${S.fURL} does not provide streamer infos`));if(!S.fNbytesName||S.fNbytesName>1e5)return Promise.reject(Error(`Cannot read directory info of the file ${S.fURL}`));let Ce=S.fNbytesName+22;return Ce+=4,Ce+=4,Ce+=18,S.fVersion>=4e4&&(Ce+=12),S.readBuffer([S.fBEGIN,Math.max(300,Ce)])}).then(Z=>{const Ae=new jt(Z,0,S);return S.fTitle=Ae.readTKey().fTitle,Ae.locate(S.fNbytesName),Ae.classStreamer(S,Je),S.fSeekKeys?S.readBuffer([S.fSeekKeys,S.fNbytesKeys,S.fSeekInfo,S.fNbytesInfo]):Promise.reject(Error(`Empty keys list in ${S.fURL}`))}).then(Z=>{const Ae=new jt(Z[0],0,S);Ae.readTKey();const Ce=Ae.ntoi4();for(let rt=0;rt<Ce;++rt)S.fKeys.push(Ae.readTKey());const nt=new jt(Z[1],0,S).readTKey();return nt?(S.fKeys.push(nt),S.readObjBuffer(nt)):Promise.reject(Error(`Fail to read StreamerInfo data in ${S.fURL}`))}).then(Z=>(S.extractStreamerInfos(Z),S))})()}readDirectory(S,Z){var Ae=this;return(0,ve.A)(function*(){return Ae.readObject(S,Z,!0)})()}findStreamerInfo(S,Z,Ae){if(!this.fStreamerInfos)return null;const Ce=this.fStreamerInfos.arr,$e=Ce.length;if(void 0!==Ae){let nt=this.fStreamerInfos.cache;nt||(nt=this.fStreamerInfos.cache={});let rt=nt[Ae];if(void 0!==rt)return rt;for(let ct=0;ct<$e;++ct)if(rt=Ce[ct],rt.fCheckSum===Ae)return nt[Ae]=rt,rt;nt[Ae]=null}else for(let nt=0;nt<$e;++nt){const rt=Ce[nt];if(rt.fName===S&&(rt.fClassVersion===Z||void 0===Z))return rt}return null}getStreamer(S,Z,Ae){if("TQObject"===S||S===Re)return null;let Ce,$e=S;if(Z&&($e+=Z.checksum?`$chksum${Z.checksum}`:`$ver${Z.val}`,Ce=this.fStreamers[$e],void 0!==Ce))return Ce;const nt=yn[S];if((0,b.isStr)(nt))return this.getStreamer(nt,Z,Ae);if((0,b.isFunc)(nt))return Ce=[{typename:S,func:nt}],ys(S,Ce);if(Ce=[],(0,b.isObject)(nt)){if(!nt.name&&!nt.func)return nt;Ce.push(nt)}if(Ae||(Ae=this.findStreamerInfo(S,Z.val,Z.checksum)),!Ae)return delete this.fStreamers[$e],Z.nowarning||console.warn(`Not found streamer for ${S} ver ${Z.val} checksum ${Z.checksum} full ${$e}`),null;if(Ae.fName===b.clTStyle&&Ae.fElements&&Ae.fElements.arr.forEach(rt=>{"fLineStyle"===rt.fName&&(rt.fName="fLineStyles")}),Ae.fElements)for(let rt=0;rt<Ae.fElements.arr.length;++rt)Ce.push(Or(Ae.fElements.arr[rt],this));return this.fStreamers[$e]=Ce,ys(S,Ce)}getSplittedStreamer(S,Z){if(!S)return Z;Z||(Z=[]);for(let Ae=0;Ae<S.length;++Ae){const Ce=S[Ae];if(void 0===Ce.base){Z.push(Ce);continue}if(Ce.basename===b.clTObject){Z.push({func(rt,ct){rt.ntoi2(),ct.fUniqueID=rt.ntou4(),ct.fBits=rt.ntou4(),ct.fBits&Bn&&rt.ntou2()}});continue}const $e={val:Ce.base};4294967295===$e.val&&($e.val=1);const nt=this.getStreamer(Ce.basename,$e);nt&&this.getSplittedStreamer(nt,Z)}return Z}delete(){this.fDirectories=null,this.fKeys=null,this.fStreamers=null,this.fSeekInfo=0,this.fNbytesInfo=0,this.fTagOffset=0}}function Ci($){if(this.member_wise){const Ce=$.ntou4(),$e=this.stl_version;let nt=null;if(0===Ce)return[];if(Ce>1e6)throw new Error(`member-wise streaming of ${this.conttype} num ${Ce} member ${this.name}`);$e.val===this.member_ver&&$e.checksum===this.member_checksum?nt=this.member_streamer:(nt=$.fFile.getStreamer(this.conttype,$e),this.member_streamer=nt=$.fFile.getSplittedStreamer(nt),this.member_ver=$e.val,this.member_checksum=$e.checksum);const rt=new Array(Ce);let ct,zt,at;for(ct=0;ct<Ce;++ct)rt[ct]={_typename:this.conttype};if(nt)for(zt=0;zt<nt.length;++zt)if(at=nt[zt],at.split_func)at.split_func($,rt,Ce);else for(ct=0;ct<Ce;++ct)at.func($,rt[ct]);else console.error(`Fail to create split streamer for ${this.conttype} need to read ${Ce} objects version ${$e}`);return rt}const S=$.ntou4(),Z=new Array(S);let Ae=0;if(S>2e5)return console.error(`vector streaming for ${this.conttype} at ${S}`),Z;if(this.arrkind>0)for(;Ae<S;)Z[Ae++]=$.readFastArray($.ntou4(),this.arrkind);else if(0===this.arrkind)for(;Ae<S;)Z[Ae++]=$.readTString();else if(this.isptr)for(;Ae<S;)Z[Ae++]=$.readObjectAny();else if(this.submember)for(;Ae<S;)Z[Ae++]=this.submember.readelem($);else for(;Ae<S;)Z[Ae++]=$.classStreamer({},this.conttype);return Z}function Rn($){let S=this.streamer;if(this.member_wise){const Ce=this.stl_version;if(this.si){const $e=$.fFile.findStreamerInfo(this.pairtype,Ce.val,Ce.checksum);if(this.si!==$e&&(S=Xi($e,this.pairtype,$.fFile),!S||2!==S.length))return console.log(`Fail to produce streamer for ${this.pairtype}`),null}}const Z=$.ntoi4(),Ae=new Array(Z);this.member_wise&&$.remain()>=6&&($.ntoi2()===lt?$.shift(4):$.shift(-2));for(let Ce=0;Ce<Z;++Ce)Ae[Ce]={_typename:this.pairtype},S[0].func($,Ae[Ce]),this.member_wise||S[1].func($,Ae[Ce]);if(this.member_wise){$.remain()>=6&&($.ntoi2()===lt?$.shift(4):$.shift(-2));for(let Ce=0;Ce<Z;++Ce)S[1].func($,Ae[Ce])}return Ae}class si extends ln{constructor(S){super(null),this.fUseStampPar=!1,this.fLocalFile=S,this.fEND=S.size,this.fFullURL=S.name,this.fURL=S.name,this.fFileName=S.name}_open(){var S=this;return(0,ve.A)(function*(){return S.readKeys()})()}readBuffer(S,Z){var Ae=this;return(0,ve.A)(function*(){const Ce=Ae.fLocalFile;return new Promise(($e,nt)=>{if(Z)return nt(Error(`Cannot access other local file ${Z}`));const rt=new FileReader,ct=[];let zt=0;rt.onload=function(at){const nn=new DataView(at.target.result);return 2===S.length?$e(nn):(ct.push(nn),zt+=2,zt>=S.length?$e(ct):void rt.readAsArrayBuffer(Ce.slice(S[zt],S[zt]+S[zt+1])))},rt.readAsArrayBuffer(Ce.slice(S[0],S[0]+S[1]))})})()}}class Fn extends ln{constructor(S){super(null),this.fUseStampPar=!1,this.fEND=0,this.fFullURL=S,this.fURL=S,this.fFileName=S}_open(){var S=this;return(0,ve.A)(function*(){return Ee.e(535).then(Ee.t.bind(Ee,8535,19)).then(Z=>(S.fs=Z,new Promise((Ae,Ce)=>S.fs.open(S.fFileName,"r",($e,nt)=>{if($e)return console.log($e.message),Ce(Error(`Not possible to open ${S.fFileName} inside node.js`));const rt=S.fs.fstatSync(nt);S.fEND=rt.size,S.fd=nt,S.readKeys().then(Ae).catch(Ce)}))))})()}readBuffer(S,Z){var Ae=this;return(0,ve.A)(function*(){return new Promise((Ce,$e)=>{if(Z)return $e(Error(`Cannot access other local file ${Z}`));if(!Ae.fs||!Ae.fd)return $e(Error(`File is not opened ${Ae.fFileName}`));const nt=[];let rt=0;const ct=(zt,at,nn)=>{const Wt=new DataView(nn.buffer,nn.byteOffset,S[rt+1]);return 2===S.length?Ce(Wt):(nt.push(Wt),rt+=2,rt>=S.length?Ce(nt):void Ae.fs.read(Ae.fd,Buffer.alloc(S[rt+1]),0,S[rt+1],S[rt],ct))};Ae.fs.read(Ae.fd,Buffer.alloc(S[1]),0,S[1],S[0],ct)})})()}}class Zt{openFile(){return(0,ve.A)(function*(){return!1})()}getFileName(){return""}getFileSize(){return 0}readBuffer(){return(0,ve.A)(function*(){return null})()}}class tr extends ln{constructor(S){super(null),this.fUseStampPar=!1,this.proxy=S}_open(){var S=this;return(0,ve.A)(function*(){return S.proxy.openFile().then(Z=>{if(!Z)return!1;if(S.fEND=S.proxy.getFileSize(),S.fFullURL=S.fURL=S.fFileName=S.proxy.getFileName(),(0,b.isStr)(S.fFileName)){const Ae=S.fFileName.lastIndexOf("/");Ae>0&&Ae<S.fFileName.length-4&&(S.fFileName=S.fFileName.slice(Ae+1))}return S.readKeys()})})()}readBuffer(S,Z){var Ae=this;return(0,ve.A)(function*(){if(Z)return Promise.reject(Error(`Cannot access other file ${Z}`));if(!Ae.proxy)return Promise.reject(Error(`File is not opened ${Ae.fFileName}`));if(2===S.length)return Ae.proxy.readBuffer(S[0],S[1]);const Ce=[];for(let $e=0;$e<S.length;$e+=2)Ce.push(Ae.proxy.readBuffer(S[$e],S[$e+1]));return Promise.all(Ce)})()}}function Ne($){let S;return(0,b.isNodeJs)()&&(0,b.isStr)($)&&(0===$.indexOf("file://")?S=new Fn($.slice(7)):0!==$.indexOf("http")&&(S=new Fn($))),!S&&(0,b.isObject)($)&&$ instanceof Zt&&(S=new tr($)),!S&&(0,b.isObject)($)&&$ instanceof ArrayBuffer&&(S=new ln("localfile.root"),S.assignFileContent($)),!S&&(0,b.isObject)($)&&$.size&&$.name&&(S=new si($)),S||(S=new ln($)),S._open()}ys(b.clTNamed,yn[b.clTNamed]),ys(b.clTObjString,yn[b.clTObjString])},357:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{$EB:()=>ie,$p8:()=>l3,B69:()=>Nl,BH$:()=>ry,BKk:()=>Pc,CSG:()=>ha,DXC:()=>BT,Df:()=>R_,EZo:()=>fe,FNr:()=>zM,Fvt:()=>yw,GOR:()=>ZL,G_z:()=>cy,Gu$:()=>Wv,I9Y:()=>Si,IUQ:()=>Za,JeP:()=>KL,Ld9:()=>vP,LlO:()=>Al,LoY:()=>us,NRn:()=>Ys,O9p:()=>Ec,ONl:()=>PT,PPD:()=>BA,PTz:()=>Lo,Pq0:()=>Dn,Q1f:()=>to,QCA:()=>A0,Qev:()=>li,RlV:()=>uf,THS:()=>pl,Tap:()=>jT,UtB:()=>yP,V9B:()=>gu,XIg:()=>he,YHV:()=>_P,YJl:()=>J1,Z58:()=>Zx,ZLX:()=>AM,ZM4:()=>pN,Zcv:()=>Zf,ZyN:()=>a3,_4j:()=>gw,cZY:()=>C3,cj9:()=>th,dth:()=>n3,dwI:()=>vo,eaF:()=>gl,er$:()=>rl,hB5:()=>O,i7d:()=>sl,iNn:()=>Eh,ix0:()=>ln,jUj:()=>pM,kBv:()=>z,kn4:()=>lo,mrM:()=>ty,nWS:()=>ku,qBx:()=>_w,qUd:()=>x_,qtW:()=>xo,sPf:()=>b,tBo:()=>v3,tXL:()=>jv,tcD:()=>zu,uSd:()=>qT,ubm:()=>yl,wtR:()=>ke,xJ6:()=>mp,zD7:()=>x3});var ve=Ee(467);const b="162",z={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ke={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Re=1,He=2,Ie=3,O=0,ie=2,he=0,fe=2,D=100,Ue=0,Oe=1,lt=2,gt=0,ht=1,st=2,yt=3,Kt=4,Ot=5,It=6,An=7,Bn=301,dn=302,Hn=306,hi=1001,Xi=1003,ys=1005,wt=1006,W=1007,me=1008,At=1009,jt=1014,Cn=1015,ln=1016,Rn=1020,Fn=1023,Ne=1026,$=1027,rl="srgb",Yc="srgb-linear",Iu="display-p3",Kc="display-p3-linear",ef="linear",Ra="srgb",Vo="rec709",qf="p3",wA=7680,xh="300 es",pi=2e3;class li{addEventListener(a,c){void 0===this._listeners&&(this._listeners={});const h=this._listeners;void 0===h[a]&&(h[a]=[]),-1===h[a].indexOf(c)&&h[a].push(c)}hasEventListener(a,c){if(void 0===this._listeners)return!1;const h=this._listeners;return void 0!==h[a]&&-1!==h[a].indexOf(c)}removeEventListener(a,c){if(void 0===this._listeners)return;const p=this._listeners[a];if(void 0!==p){const E=p.indexOf(c);-1!==E&&p.splice(E,1)}}dispatchEvent(a){if(void 0===this._listeners)return;const h=this._listeners[a.type];if(void 0!==h){a.target=this;const p=h.slice(0);for(let E=0,H=p.length;E<H;E++)p[E].call(this,a);a.target=null}}}const Cc=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Sm=1234567;const fu=Math.PI/180,Bu=180/Math.PI;function Yl(){const M=4294967295*Math.random()|0,a=4294967295*Math.random()|0,c=4294967295*Math.random()|0,h=4294967295*Math.random()|0;return(Cc[255&M]+Cc[M>>8&255]+Cc[M>>16&255]+Cc[M>>24&255]+"-"+Cc[255&a]+Cc[a>>8&255]+"-"+Cc[a>>16&15|64]+Cc[a>>24&255]+"-"+Cc[63&c|128]+Cc[c>>8&255]+"-"+Cc[c>>16&255]+Cc[c>>24&255]+Cc[255&h]+Cc[h>>8&255]+Cc[h>>16&255]+Cc[h>>24&255]).toLowerCase()}function Gl(M,a,c){return Math.max(a,Math.min(c,M))}function Ku(M,a){return(M%a+a)%a}function fl(M,a,c,h,p){return h+(M-a)*(p-h)/(c-a)}function $0(M,a,c){return M!==a?(c-M)/(a-M):0}function bl(M,a,c){return(1-c)*M+c*a}function Bg(M,a,c,h){return bl(M,a,1-Math.exp(-c*h))}function dd(M,a=1){return a-Math.abs(Ku(M,2*a)-a)}function Em(M,a,c){return M<=a?0:M>=c?1:(M=(M-a)/(c-a))*M*(3-2*M)}function Ko(M,a,c){return M<=a?0:M>=c?1:(M=(M-a)/(c-a))*M*M*(M*(6*M-15)+10)}function Wf(M,a){return M+Math.floor(Math.random()*(a-M+1))}function Pg(M,a){return M+Math.random()*(a-M)}function jf(M){return M*(.5-Math.random())}function mc(M){void 0!==M&&(Sm=M);let a=Sm+=1831565813;return a=Math.imul(a^a>>>15,1|a),a^=a+Math.imul(a^a>>>7,61|a),((a^a>>>14)>>>0)/4294967296}function Pu(M){return M*fu}function C1(M){return M*Bu}function Zu(M){return!(M&M-1)&&0!==M}function Ju(M){return Math.pow(2,Math.ceil(Math.log(M)/Math.LN2))}function Ll(M){return Math.pow(2,Math.floor(Math.log(M)/Math.LN2))}function eh(M,a,c,h,p){const E=Math.cos,H=Math.sin,K=E(c/2),de=H(c/2),ge=E((a+h)/2),Me=H((a+h)/2),Le=E((a-h)/2),Be=H((a-h)/2),Ge=E((h-a)/2),it=H((h-a)/2);switch(p){case"XYX":M.set(K*Me,de*Le,de*Be,K*ge);break;case"YZY":M.set(de*Be,K*Me,de*Le,K*ge);break;case"ZXZ":M.set(de*Le,de*Be,K*Me,K*ge);break;case"XZX":M.set(K*Me,de*it,de*Ge,K*ge);break;case"YXY":M.set(de*Ge,K*Me,de*it,K*ge);break;case"ZYZ":M.set(de*it,de*Ge,K*Me,K*ge);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+p)}}function Zo(M,a){switch(a.constructor){case Float32Array:return M;case Uint32Array:return M/4294967295;case Uint16Array:return M/65535;case Uint8Array:return M/255;case Int32Array:return Math.max(M/2147483647,-1);case Int16Array:return Math.max(M/32767,-1);case Int8Array:return Math.max(M/127,-1);default:throw new Error("Invalid component type.")}}function mo(M,a){switch(a.constructor){case Float32Array:return M;case Uint32Array:return Math.round(4294967295*M);case Uint16Array:return Math.round(65535*M);case Uint8Array:return Math.round(255*M);case Int32Array:return Math.round(2147483647*M);case Int16Array:return Math.round(32767*M);case Int8Array:return Math.round(127*M);default:throw new Error("Invalid component type.")}}var th=Object.freeze({__proto__:null,DEG2RAD:fu,MathUtils:{DEG2RAD:fu,RAD2DEG:Bu,generateUUID:Yl,clamp:Gl,euclideanModulo:Ku,mapLinear:fl,inverseLerp:$0,lerp:bl,damp:Bg,pingpong:dd,smoothstep:Em,smootherstep:Ko,randInt:Wf,randFloat:Pg,randFloatSpread:jf,seededRandom:mc,degToRad:Pu,radToDeg:C1,isPowerOfTwo:Zu,ceilPowerOfTwo:Ju,floorPowerOfTwo:Ll,setQuaternionFromProperEuler:eh,normalize:mo,denormalize:Zo},RAD2DEG:Bu,ceilPowerOfTwo:Ju,clamp:Gl,damp:Bg,degToRad:Pu,denormalize:Zo,euclideanModulo:Ku,floorPowerOfTwo:Ll,generateUUID:Yl,inverseLerp:$0,isPowerOfTwo:Zu,lerp:bl,mapLinear:fl,normalize:mo,pingpong:dd,radToDeg:C1,randFloat:Pg,randFloatSpread:jf,randInt:Wf,seededRandom:mc,setQuaternionFromProperEuler:eh,smootherstep:Ko,smoothstep:Em});class Si{constructor(a=0,c=0){Si.prototype.isVector2=!0,this.x=a,this.y=c}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,c){return this.x=a,this.y=c,this}setScalar(a){return this.x=a,this.y=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y)}copy(a){return this.x=a.x,this.y=a.y,this}add(a){return this.x+=a.x,this.y+=a.y,this}addScalar(a){return this.x+=a,this.y+=a,this}addVectors(a,c){return this.x=a.x+c.x,this.y=a.y+c.y,this}addScaledVector(a,c){return this.x+=a.x*c,this.y+=a.y*c,this}sub(a){return this.x-=a.x,this.y-=a.y,this}subScalar(a){return this.x-=a,this.y-=a,this}subVectors(a,c){return this.x=a.x-c.x,this.y=a.y-c.y,this}multiply(a){return this.x*=a.x,this.y*=a.y,this}multiplyScalar(a){return this.x*=a,this.y*=a,this}divide(a){return this.x/=a.x,this.y/=a.y,this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){const c=this.x,h=this.y,p=a.elements;return this.x=p[0]*c+p[3]*h+p[6],this.y=p[1]*c+p[4]*h+p[7],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this}clamp(a,c){return this.x=Math.max(a.x,Math.min(c.x,this.x)),this.y=Math.max(a.y,Math.min(c.y,this.y)),this}clampScalar(a,c){return this.x=Math.max(a,Math.min(c,this.x)),this.y=Math.max(a,Math.min(c,this.y)),this}clampLength(a,c){const h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(c,h)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){const c=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===c)return Math.PI/2;const h=this.dot(a)/c;return Math.acos(Gl(h,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const c=this.x-a.x,h=this.y-a.y;return c*c+h*h}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){return this.x+=(a.x-this.x)*c,this.y+=(a.y-this.y)*c,this}lerpVectors(a,c,h){return this.x=a.x+(c.x-a.x)*h,this.y=a.y+(c.y-a.y)*h,this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,c=0){return this.x=a[c],this.y=a[c+1],this}toArray(a=[],c=0){return a[c]=this.x,a[c+1]=this.y,a}fromBufferAttribute(a,c){return this.x=a.getX(c),this.y=a.getY(c),this}rotateAround(a,c){const h=Math.cos(c),p=Math.sin(c),E=this.x-a.x,H=this.y-a.y;return this.x=E*h-H*p+a.x,this.y=E*p+H*h+a.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class vo{constructor(a,c,h,p,E,H,K,de,ge){vo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==a&&this.set(a,c,h,p,E,H,K,de,ge)}set(a,c,h,p,E,H,K,de,ge){const Me=this.elements;return Me[0]=a,Me[1]=p,Me[2]=K,Me[3]=c,Me[4]=E,Me[5]=de,Me[6]=h,Me[7]=H,Me[8]=ge,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){const c=this.elements,h=a.elements;return c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],this}extractBasis(a,c,h){return a.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),h.setFromMatrix3Column(this,2),this}setFromMatrix4(a){const c=a.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,c){const h=a.elements,p=c.elements,E=this.elements,H=h[0],K=h[3],de=h[6],ge=h[1],Me=h[4],Le=h[7],Be=h[2],Ge=h[5],it=h[8],bt=p[0],Ye=p[3],qe=p[6],Ft=p[1],mt=p[4],Ut=p[7],kn=p[2],bn=p[5],wn=p[8];return E[0]=H*bt+K*Ft+de*kn,E[3]=H*Ye+K*mt+de*bn,E[6]=H*qe+K*Ut+de*wn,E[1]=ge*bt+Me*Ft+Le*kn,E[4]=ge*Ye+Me*mt+Le*bn,E[7]=ge*qe+Me*Ut+Le*wn,E[2]=Be*bt+Ge*Ft+it*kn,E[5]=Be*Ye+Ge*mt+it*bn,E[8]=Be*qe+Ge*Ut+it*wn,this}multiplyScalar(a){const c=this.elements;return c[0]*=a,c[3]*=a,c[6]*=a,c[1]*=a,c[4]*=a,c[7]*=a,c[2]*=a,c[5]*=a,c[8]*=a,this}determinant(){const a=this.elements,c=a[0],h=a[1],p=a[2],E=a[3],H=a[4],K=a[5],de=a[6],ge=a[7],Me=a[8];return c*H*Me-c*K*ge-h*E*Me+h*K*de+p*E*ge-p*H*de}invert(){const a=this.elements,c=a[0],h=a[1],p=a[2],E=a[3],H=a[4],K=a[5],de=a[6],ge=a[7],Me=a[8],Le=Me*H-K*ge,Be=K*de-Me*E,Ge=ge*E-H*de,it=c*Le+h*Be+p*Ge;if(0===it)return this.set(0,0,0,0,0,0,0,0,0);const bt=1/it;return a[0]=Le*bt,a[1]=(p*ge-Me*h)*bt,a[2]=(K*h-p*H)*bt,a[3]=Be*bt,a[4]=(Me*c-p*de)*bt,a[5]=(p*E-K*c)*bt,a[6]=Ge*bt,a[7]=(h*de-ge*c)*bt,a[8]=(H*c-h*E)*bt,this}transpose(){let a;const c=this.elements;return a=c[1],c[1]=c[3],c[3]=a,a=c[2],c[2]=c[6],c[6]=a,a=c[5],c[5]=c[7],c[7]=a,this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){const c=this.elements;return a[0]=c[0],a[1]=c[3],a[2]=c[6],a[3]=c[1],a[4]=c[4],a[5]=c[7],a[6]=c[2],a[7]=c[5],a[8]=c[8],this}setUvTransform(a,c,h,p,E,H,K){const de=Math.cos(E),ge=Math.sin(E);return this.set(h*de,h*ge,-h*(de*H+ge*K)+H+a,-p*ge,p*de,-p*(-ge*H+de*K)+K+c,0,0,1),this}scale(a,c){return this.premultiply($f.makeScale(a,c)),this}rotate(a){return this.premultiply($f.makeRotation(-a)),this}translate(a,c){return this.premultiply($f.makeTranslation(a,c)),this}makeTranslation(a,c){return a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,c,0,0,1),this}makeRotation(a){const c=Math.cos(a),h=Math.sin(a);return this.set(c,-h,0,h,c,0,0,0,1),this}makeScale(a,c){return this.set(a,0,0,0,c,0,0,0,1),this}equals(a){const c=this.elements,h=a.elements;for(let p=0;p<9;p++)if(c[p]!==h[p])return!1;return!0}fromArray(a,c=0){for(let h=0;h<9;h++)this.elements[h]=a[h+c];return this}toArray(a=[],c=0){const h=this.elements;return a[c]=h[0],a[c+1]=h[1],a[c+2]=h[2],a[c+3]=h[3],a[c+4]=h[4],a[c+5]=h[5],a[c+6]=h[6],a[c+7]=h[7],a[c+8]=h[8],a}clone(){return(new this.constructor).fromArray(this.elements)}}const $f=new vo;function Ch(M){for(let a=M.length-1;a>=0;--a)if(M[a]>=65535)return!0;return!1}function Ed(M){return document.createElementNS("http://www.w3.org/1999/xhtml",M)}function mi(){const M=Ed("canvas");return M.style.display="block",M}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const TA={};const X0=(new vo).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),pu=(new vo).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),rf={[Yc]:{transfer:ef,primaries:Vo,toReference:M=>M,fromReference:M=>M},[rl]:{transfer:Ra,primaries:Vo,toReference:M=>M.convertSRGBToLinear(),fromReference:M=>M.convertLinearToSRGB()},[Kc]:{transfer:ef,primaries:qf,toReference:M=>M.applyMatrix3(pu),fromReference:M=>M.applyMatrix3(X0)},[Iu]:{transfer:Ra,primaries:qf,toReference:M=>M.convertSRGBToLinear().applyMatrix3(pu),fromReference:M=>M.applyMatrix3(X0).convertLinearToSRGB()}},M1=new Set([Yc,Kc]),va={enabled:!0,_workingColorSpace:Yc,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(M){if(!M1.has(M))throw new Error(`Unsupported working color space, "${M}".`);this._workingColorSpace=M},convert:function(M,a,c){return!1!==this.enabled&&a!==c&&a&&c?(0,rf[c].fromReference)((0,rf[a].toReference)(M)):M},fromWorkingColorSpace:function(M,a){return this.convert(M,this._workingColorSpace,a)},toWorkingColorSpace:function(M,a){return this.convert(M,a,this._workingColorSpace)},getPrimaries:function(M){return rf[M].primaries},getTransfer:function(M){return""===M?ef:rf[M].transfer}};function sf(M){return M<.04045?.0773993808*M:Math.pow(.9478672986*M+.0521327014,2.4)}function Dp(M){return M<.0031308?12.92*M:1.055*Math.pow(M,.41666)-.055}let Ip;class kg{static getDataURL(a){if(/^data:/i.test(a.src)||typeof HTMLCanvasElement>"u")return a.src;let c;if(a instanceof HTMLCanvasElement)c=a;else{void 0===Ip&&(Ip=Ed("canvas")),Ip.width=a.width,Ip.height=a.height;const h=Ip.getContext("2d");a instanceof ImageData?h.putImageData(a,0,0):h.drawImage(a,0,0,a.width,a.height),c=Ip}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",a),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}static sRGBToLinear(a){if(typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap){const c=Ed("canvas");c.width=a.width,c.height=a.height;const h=c.getContext("2d");h.drawImage(a,0,0,a.width,a.height);const p=h.getImageData(0,0,a.width,a.height),E=p.data;for(let H=0;H<E.length;H++)E[H]=255*sf(E[H]/255);return h.putImageData(p,0,0),c}if(a.data){const c=a.data.slice(0);for(let h=0;h<c.length;h++)c[h]=c instanceof Uint8Array||c instanceof Uint8ClampedArray?Math.floor(255*sf(c[h]/255)):sf(c[h]);return{data:c,width:a.width,height:a.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),a}}let Ru=0;class Tm{constructor(a=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Ru++}),this.uuid=Yl(),this.data=a,this.dataReady=!0,this.version=0}set needsUpdate(a){!0===a&&this.version++}toJSON(a){const c=void 0===a||"string"==typeof a;if(!c&&void 0!==a.images[this.uuid])return a.images[this.uuid];const h={uuid:this.uuid,url:""},p=this.data;if(null!==p){let E;if(Array.isArray(p)){E=[];for(let H=0,K=p.length;H<K;H++)E.push(DA(p[H].isDataTexture?p[H].image:p[H]))}else E=DA(p);h.url=E}return c||(a.images[this.uuid]=h),h}}function DA(M){return typeof HTMLImageElement<"u"&&M instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&M instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&M instanceof ImageBitmap?kg.getDataURL(M):M.data?{data:Array.from(M.data),width:M.width,height:M.height,type:M.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Dm=0,$d=(()=>{class M extends li{constructor(c=M.DEFAULT_IMAGE,h=M.DEFAULT_MAPPING,p=hi,E=hi,H=wt,K=me,de=Fn,ge=At,Me=M.DEFAULT_ANISOTROPY,Le=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Dm++}),this.uuid=Yl(),this.name="",this.source=new Tm(c),this.mipmaps=[],this.mapping=h,this.channel=0,this.wrapS=p,this.wrapT=E,this.magFilter=H,this.minFilter=K,this.anisotropy=Me,this.format=de,this.internalFormat=null,this.type=ge,this.offset=new Si(0,0),this.repeat=new Si(1,1),this.center=new Si(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new vo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=Le,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(c=null){this.source.data=c}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(c){return this.name=c.name,this.source=c.source,this.mipmaps=c.mipmaps.slice(0),this.mapping=c.mapping,this.channel=c.channel,this.wrapS=c.wrapS,this.wrapT=c.wrapT,this.magFilter=c.magFilter,this.minFilter=c.minFilter,this.anisotropy=c.anisotropy,this.format=c.format,this.internalFormat=c.internalFormat,this.type=c.type,this.offset.copy(c.offset),this.repeat.copy(c.repeat),this.center.copy(c.center),this.rotation=c.rotation,this.matrixAutoUpdate=c.matrixAutoUpdate,this.matrix.copy(c.matrix),this.generateMipmaps=c.generateMipmaps,this.premultiplyAlpha=c.premultiplyAlpha,this.flipY=c.flipY,this.unpackAlignment=c.unpackAlignment,this.colorSpace=c.colorSpace,this.userData=JSON.parse(JSON.stringify(c.userData)),this.needsUpdate=!0,this}toJSON(c){const h=void 0===c||"string"==typeof c;if(!h&&void 0!==c.textures[this.uuid])return c.textures[this.uuid];const p={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(c).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(p.userData=this.userData),h||(c.textures[this.uuid]=p),p}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(c){if(300!==this.mapping)return c;if(c.applyMatrix3(this.matrix),c.x<0||c.x>1)switch(this.wrapS){case 1e3:c.x=c.x-Math.floor(c.x);break;case hi:c.x=c.x<0?0:1;break;case 1002:c.x=1===Math.abs(Math.floor(c.x)%2)?Math.ceil(c.x)-c.x:c.x-Math.floor(c.x)}if(c.y<0||c.y>1)switch(this.wrapT){case 1e3:c.y=c.y-Math.floor(c.y);break;case hi:c.y=c.y<0?0:1;break;case 1002:c.y=1===Math.abs(Math.floor(c.y)%2)?Math.ceil(c.y)-c.y:c.y-Math.floor(c.y)}return this.flipY&&(c.y=1-c.y),c}set needsUpdate(c){!0===c&&(this.version++,this.source.needsUpdate=!0)}}return M.DEFAULT_IMAGE=null,M.DEFAULT_MAPPING=300,M.DEFAULT_ANISOTROPY=1,M})();class Za{constructor(a=0,c=0,h=0,p=1){Za.prototype.isVector4=!0,this.x=a,this.y=c,this.z=h,this.w=p}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,c,h,p){return this.x=a,this.y=c,this.z=h,this.w=p,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this.w=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setW(a){return this.w=a,this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this}addVectors(a,c){return this.x=a.x+c.x,this.y=a.y+c.y,this.z=a.z+c.z,this.w=a.w+c.w,this}addScaledVector(a,c){return this.x+=a.x*c,this.y+=a.y*c,this.z+=a.z*c,this.w+=a.w*c,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this}subVectors(a,c){return this.x=a.x-c.x,this.y=a.y-c.y,this.z=a.z-c.z,this.w=a.w-c.w,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}applyMatrix4(a){const c=this.x,h=this.y,p=this.z,E=this.w,H=a.elements;return this.x=H[0]*c+H[4]*h+H[8]*p+H[12]*E,this.y=H[1]*c+H[5]*h+H[9]*p+H[13]*E,this.z=H[2]*c+H[6]*h+H[10]*p+H[14]*E,this.w=H[3]*c+H[7]*h+H[11]*p+H[15]*E,this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);const c=Math.sqrt(1-a.w*a.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/c,this.y=a.y/c,this.z=a.z/c),this}setAxisAngleFromRotationMatrix(a){let c,h,p,E;const de=a.elements,ge=de[0],Me=de[4],Le=de[8],Be=de[1],Ge=de[5],it=de[9],bt=de[2],Ye=de[6],qe=de[10];if(Math.abs(Me-Be)<.01&&Math.abs(Le-bt)<.01&&Math.abs(it-Ye)<.01){if(Math.abs(Me+Be)<.1&&Math.abs(Le+bt)<.1&&Math.abs(it+Ye)<.1&&Math.abs(ge+Ge+qe-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const mt=(ge+1)/2,Ut=(Ge+1)/2,kn=(qe+1)/2,bn=(Me+Be)/4,wn=(Le+bt)/4,$n=(it+Ye)/4;return mt>Ut&&mt>kn?mt<.01?(h=0,p=.707106781,E=.707106781):(h=Math.sqrt(mt),p=bn/h,E=wn/h):Ut>kn?Ut<.01?(h=.707106781,p=0,E=.707106781):(p=Math.sqrt(Ut),h=bn/p,E=$n/p):kn<.01?(h=.707106781,p=.707106781,E=0):(E=Math.sqrt(kn),h=wn/E,p=$n/E),this.set(h,p,E,c),this}let Ft=Math.sqrt((Ye-it)*(Ye-it)+(Le-bt)*(Le-bt)+(Be-Me)*(Be-Me));return Math.abs(Ft)<.001&&(Ft=1),this.x=(Ye-it)/Ft,this.y=(Le-bt)/Ft,this.z=(Be-Me)/Ft,this.w=Math.acos((ge+Ge+qe-1)/2),this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this}clamp(a,c){return this.x=Math.max(a.x,Math.min(c.x,this.x)),this.y=Math.max(a.y,Math.min(c.y,this.y)),this.z=Math.max(a.z,Math.min(c.z,this.z)),this.w=Math.max(a.w,Math.min(c.w,this.w)),this}clampScalar(a,c){return this.x=Math.max(a,Math.min(c,this.x)),this.y=Math.max(a,Math.min(c,this.y)),this.z=Math.max(a,Math.min(c,this.z)),this.w=Math.max(a,Math.min(c,this.w)),this}clampLength(a,c){const h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(c,h)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){return this.x+=(a.x-this.x)*c,this.y+=(a.y-this.y)*c,this.z+=(a.z-this.z)*c,this.w+=(a.w-this.w)*c,this}lerpVectors(a,c,h){return this.x=a.x+(c.x-a.x)*h,this.y=a.y+(c.y-a.y)*h,this.z=a.z+(c.z-a.z)*h,this.w=a.w+(c.w-a.w)*h,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,c=0){return this.x=a[c],this.y=a[c+1],this.z=a[c+2],this.w=a[c+3],this}toArray(a=[],c=0){return a[c]=this.x,a[c+1]=this.y,a[c+2]=this.z,a[c+3]=this.w,a}fromBufferAttribute(a,c){return this.x=a.getX(c),this.y=a.getY(c),this.z=a.getZ(c),this.w=a.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class uv extends li{constructor(a=1,c=1,h={}){super(),this.isRenderTarget=!0,this.width=a,this.height=c,this.depth=1,this.scissor=new Za(0,0,a,c),this.scissorTest=!1,this.viewport=new Za(0,0,a,c);const p={width:a,height:c,depth:1};h=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:wt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},h);const E=new $d(p,h.mapping,h.wrapS,h.wrapT,h.magFilter,h.minFilter,h.format,h.type,h.anisotropy,h.colorSpace);E.flipY=!1,E.generateMipmaps=h.generateMipmaps,E.internalFormat=h.internalFormat,this.textures=[];const H=h.count;for(let K=0;K<H;K++)this.textures[K]=E.clone(),this.textures[K].isRenderTargetTexture=!0;this.depthBuffer=h.depthBuffer,this.stencilBuffer=h.stencilBuffer,this.depthTexture=h.depthTexture,this.samples=h.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}setSize(a,c,h=1){if(this.width!==a||this.height!==c||this.depth!==h){this.width=a,this.height=c,this.depth=h;for(let p=0,E=this.textures.length;p<E;p++)this.textures[p].image.width=a,this.textures[p].image.height=c,this.textures[p].image.depth=h;this.dispose()}this.viewport.set(0,0,a,c),this.scissor.set(0,0,a,c)}clone(){return(new this.constructor).copy(this)}copy(a){this.width=a.width,this.height=a.height,this.depth=a.depth,this.scissor.copy(a.scissor),this.scissorTest=a.scissorTest,this.viewport.copy(a.viewport),this.textures.length=0;for(let h=0,p=a.textures.length;h<p;h++)this.textures[h]=a.textures[h].clone(),this.textures[h].isRenderTargetTexture=!0;const c=Object.assign({},a.texture.image);return this.texture.source=new Tm(c),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,null!==a.depthTexture&&(this.depthTexture=a.depthTexture.clone()),this.samples=a.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ku extends uv{constructor(a=1,c=1,h={}){super(a,c,h),this.isWebGLRenderTarget=!0}}const S1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xf={h:0,s:0,l:0},Bp={h:0,s:0,l:0};function Qr(M,a,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?M+6*(a-M)*c:c<.5?a:c<2/3?M+6*(a-M)*(2/3-c):M}class to{constructor(a,c,h){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(a,c,h)}set(a,c,h){if(void 0===c&&void 0===h){const p=a;p&&p.isColor?this.copy(p):"number"==typeof p?this.setHex(p):"string"==typeof p&&this.setStyle(p)}else this.setRGB(a,c,h);return this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a,c=rl){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,va.toWorkingColorSpace(this,c),this}setRGB(a,c,h,p=va.workingColorSpace){return this.r=a,this.g=c,this.b=h,va.toWorkingColorSpace(this,p),this}setHSL(a,c,h,p=va.workingColorSpace){if(a=Ku(a,1),c=Gl(c,0,1),h=Gl(h,0,1),0===c)this.r=this.g=this.b=h;else{const E=h<=.5?h*(1+c):h+c-h*c,H=2*h-E;this.r=Qr(H,E,a+1/3),this.g=Qr(H,E,a),this.b=Qr(H,E,a-1/3)}return va.toWorkingColorSpace(this,p),this}setStyle(a,c=rl){function h(E){void 0!==E&&parseFloat(E)<1&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}let p;if(p=/^(\w+)\(([^\)]*)\)/.exec(a)){let E;const K=p[2];switch(p[1]){case"rgb":case"rgba":if(E=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(K))return h(E[4]),this.setRGB(Math.min(255,parseInt(E[1],10))/255,Math.min(255,parseInt(E[2],10))/255,Math.min(255,parseInt(E[3],10))/255,c);if(E=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(K))return h(E[4]),this.setRGB(Math.min(100,parseInt(E[1],10))/100,Math.min(100,parseInt(E[2],10))/100,Math.min(100,parseInt(E[3],10))/100,c);break;case"hsl":case"hsla":if(E=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(K))return h(E[4]),this.setHSL(parseFloat(E[1])/360,parseFloat(E[2])/100,parseFloat(E[3])/100,c);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(p=/^\#([A-Fa-f\d]+)$/.exec(a)){const E=p[1],H=E.length;if(3===H)return this.setRGB(parseInt(E.charAt(0),16)/15,parseInt(E.charAt(1),16)/15,parseInt(E.charAt(2),16)/15,c);if(6===H)return this.setHex(parseInt(E,16),c);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,c);return this}setColorName(a,c=rl){const h=S1[a.toLowerCase()];return void 0!==h?this.setHex(h,c):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copySRGBToLinear(a){return this.r=sf(a.r),this.g=sf(a.g),this.b=sf(a.b),this}copyLinearToSRGB(a){return this.r=Dp(a.r),this.g=Dp(a.g),this.b=Dp(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(a=rl){return va.fromWorkingColorSpace(ud.copy(this),a),65536*Math.round(Gl(255*ud.r,0,255))+256*Math.round(Gl(255*ud.g,0,255))+Math.round(Gl(255*ud.b,0,255))}getHexString(a=rl){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,c=va.workingColorSpace){va.fromWorkingColorSpace(ud.copy(this),c);const h=ud.r,p=ud.g,E=ud.b,H=Math.max(h,p,E),K=Math.min(h,p,E);let de,ge;const Me=(K+H)/2;if(K===H)de=0,ge=0;else{const Le=H-K;switch(ge=Me<=.5?Le/(H+K):Le/(2-H-K),H){case h:de=(p-E)/Le+(p<E?6:0);break;case p:de=(E-h)/Le+2;break;case E:de=(h-p)/Le+4}de/=6}return a.h=de,a.s=ge,a.l=Me,a}getRGB(a,c=va.workingColorSpace){return va.fromWorkingColorSpace(ud.copy(this),c),a.r=ud.r,a.g=ud.g,a.b=ud.b,a}getStyle(a=rl){va.fromWorkingColorSpace(ud.copy(this),a);const c=ud.r,h=ud.g,p=ud.b;return a!==rl?`color(${a} ${c.toFixed(3)} ${h.toFixed(3)} ${p.toFixed(3)})`:`rgb(${Math.round(255*c)},${Math.round(255*h)},${Math.round(255*p)})`}offsetHSL(a,c,h){return this.getHSL(Xf),this.setHSL(Xf.h+a,Xf.s+c,Xf.l+h)}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,c){return this.r=a.r+c.r,this.g=a.g+c.g,this.b=a.b+c.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,c){return this.r+=(a.r-this.r)*c,this.g+=(a.g-this.g)*c,this.b+=(a.b-this.b)*c,this}lerpColors(a,c,h){return this.r=a.r+(c.r-a.r)*h,this.g=a.g+(c.g-a.g)*h,this.b=a.b+(c.b-a.b)*h,this}lerpHSL(a,c){this.getHSL(Xf),a.getHSL(Bp);const h=bl(Xf.h,Bp.h,c),p=bl(Xf.s,Bp.s,c),E=bl(Xf.l,Bp.l,c);return this.setHSL(h,p,E),this}setFromVector3(a){return this.r=a.x,this.g=a.y,this.b=a.z,this}applyMatrix3(a){const c=this.r,h=this.g,p=this.b,E=a.elements;return this.r=E[0]*c+E[3]*h+E[6]*p,this.g=E[1]*c+E[4]*h+E[7]*p,this.b=E[2]*c+E[5]*h+E[8]*p,this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,c=0){return this.r=a[c],this.g=a[c+1],this.b=a[c+2],this}toArray(a=[],c=0){return a[c]=this.r,a[c+1]=this.g,a[c+2]=this.b,a}fromBufferAttribute(a,c){return this.r=a.getX(c),this.g=a.getY(c),this.b=a.getZ(c),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ud=new to;to.NAMES=S1;class Lo{constructor(a=0,c=0,h=0,p=1){this.isQuaternion=!0,this._x=a,this._y=c,this._z=h,this._w=p}static slerpFlat(a,c,h,p,E,H,K){let de=h[p+0],ge=h[p+1],Me=h[p+2],Le=h[p+3];const Be=E[H+0],Ge=E[H+1],it=E[H+2],bt=E[H+3];if(0===K)return a[c+0]=de,a[c+1]=ge,a[c+2]=Me,void(a[c+3]=Le);if(1===K)return a[c+0]=Be,a[c+1]=Ge,a[c+2]=it,void(a[c+3]=bt);if(Le!==bt||de!==Be||ge!==Ge||Me!==it){let Ye=1-K;const qe=de*Be+ge*Ge+Me*it+Le*bt,Ft=qe>=0?1:-1,mt=1-qe*qe;if(mt>Number.EPSILON){const kn=Math.sqrt(mt),bn=Math.atan2(kn,qe*Ft);Ye=Math.sin(Ye*bn)/kn,K=Math.sin(K*bn)/kn}const Ut=K*Ft;if(de=de*Ye+Be*Ut,ge=ge*Ye+Ge*Ut,Me=Me*Ye+it*Ut,Le=Le*Ye+bt*Ut,Ye===1-K){const kn=1/Math.sqrt(de*de+ge*ge+Me*Me+Le*Le);de*=kn,ge*=kn,Me*=kn,Le*=kn}}a[c]=de,a[c+1]=ge,a[c+2]=Me,a[c+3]=Le}static multiplyQuaternionsFlat(a,c,h,p,E,H){const K=h[p],de=h[p+1],ge=h[p+2],Me=h[p+3],Le=E[H],Be=E[H+1],Ge=E[H+2],it=E[H+3];return a[c]=K*it+Me*Le+de*Ge-ge*Be,a[c+1]=de*it+Me*Be+ge*Le-K*Ge,a[c+2]=ge*it+Me*Ge+K*Be-de*Le,a[c+3]=Me*it-K*Le-de*Be-ge*Ge,a}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a,this._onChangeCallback()}set(a,c,h,p){return this._x=a,this._y=c,this._z=h,this._w=p,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this}setFromEuler(a,c=!0){const h=a._x,p=a._y,E=a._z,H=a._order,K=Math.cos,de=Math.sin,ge=K(h/2),Me=K(p/2),Le=K(E/2),Be=de(h/2),Ge=de(p/2),it=de(E/2);switch(H){case"XYZ":this._x=Be*Me*Le+ge*Ge*it,this._y=ge*Ge*Le-Be*Me*it,this._z=ge*Me*it+Be*Ge*Le,this._w=ge*Me*Le-Be*Ge*it;break;case"YXZ":this._x=Be*Me*Le+ge*Ge*it,this._y=ge*Ge*Le-Be*Me*it,this._z=ge*Me*it-Be*Ge*Le,this._w=ge*Me*Le+Be*Ge*it;break;case"ZXY":this._x=Be*Me*Le-ge*Ge*it,this._y=ge*Ge*Le+Be*Me*it,this._z=ge*Me*it+Be*Ge*Le,this._w=ge*Me*Le-Be*Ge*it;break;case"ZYX":this._x=Be*Me*Le-ge*Ge*it,this._y=ge*Ge*Le+Be*Me*it,this._z=ge*Me*it-Be*Ge*Le,this._w=ge*Me*Le+Be*Ge*it;break;case"YZX":this._x=Be*Me*Le+ge*Ge*it,this._y=ge*Ge*Le+Be*Me*it,this._z=ge*Me*it-Be*Ge*Le,this._w=ge*Me*Le-Be*Ge*it;break;case"XZY":this._x=Be*Me*Le-ge*Ge*it,this._y=ge*Ge*Le-Be*Me*it,this._z=ge*Me*it+Be*Ge*Le,this._w=ge*Me*Le+Be*Ge*it;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+H)}return!0===c&&this._onChangeCallback(),this}setFromAxisAngle(a,c){const h=c/2,p=Math.sin(h);return this._x=a.x*p,this._y=a.y*p,this._z=a.z*p,this._w=Math.cos(h),this._onChangeCallback(),this}setFromRotationMatrix(a){const c=a.elements,h=c[0],p=c[4],E=c[8],H=c[1],K=c[5],de=c[9],ge=c[2],Me=c[6],Le=c[10],Be=h+K+Le;if(Be>0){const Ge=.5/Math.sqrt(Be+1);this._w=.25/Ge,this._x=(Me-de)*Ge,this._y=(E-ge)*Ge,this._z=(H-p)*Ge}else if(h>K&&h>Le){const Ge=2*Math.sqrt(1+h-K-Le);this._w=(Me-de)/Ge,this._x=.25*Ge,this._y=(p+H)/Ge,this._z=(E+ge)/Ge}else if(K>Le){const Ge=2*Math.sqrt(1+K-h-Le);this._w=(E-ge)/Ge,this._x=(p+H)/Ge,this._y=.25*Ge,this._z=(de+Me)/Ge}else{const Ge=2*Math.sqrt(1+Le-h-K);this._w=(H-p)/Ge,this._x=(E+ge)/Ge,this._y=(de+Me)/Ge,this._z=.25*Ge}return this._onChangeCallback(),this}setFromUnitVectors(a,c){let h=a.dot(c)+1;return h<Number.EPSILON?(h=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0,this._w=h):(this._x=0,this._y=-a.z,this._z=a.y,this._w=h)):(this._x=a.y*c.z-a.z*c.y,this._y=a.z*c.x-a.x*c.z,this._z=a.x*c.y-a.y*c.x,this._w=h),this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(Gl(this.dot(a),-1,1)))}rotateTowards(a,c){const h=this.angleTo(a);if(0===h)return this;const p=Math.min(1,c/h);return this.slerp(a,p),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,c){const h=a._x,p=a._y,E=a._z,H=a._w,K=c._x,de=c._y,ge=c._z,Me=c._w;return this._x=h*Me+H*K+p*ge-E*de,this._y=p*Me+H*de+E*K-h*ge,this._z=E*Me+H*ge+h*de-p*K,this._w=H*Me-h*K-p*de-E*ge,this._onChangeCallback(),this}slerp(a,c){if(0===c)return this;if(1===c)return this.copy(a);const h=this._x,p=this._y,E=this._z,H=this._w;let K=H*a._w+h*a._x+p*a._y+E*a._z;if(K<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,K=-K):this.copy(a),K>=1)return this._w=H,this._x=h,this._y=p,this._z=E,this;const de=1-K*K;if(de<=Number.EPSILON){const Ge=1-c;return this._w=Ge*H+c*this._w,this._x=Ge*h+c*this._x,this._y=Ge*p+c*this._y,this._z=Ge*E+c*this._z,this.normalize(),this}const ge=Math.sqrt(de),Me=Math.atan2(ge,K),Le=Math.sin((1-c)*Me)/ge,Be=Math.sin(c*Me)/ge;return this._w=H*Le+this._w*Be,this._x=h*Le+this._x*Be,this._y=p*Le+this._y*Be,this._z=E*Le+this._z*Be,this._onChangeCallback(),this}slerpQuaternions(a,c,h){return this.copy(a).slerp(c,h)}random(){const a=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),h=Math.random(),p=Math.sqrt(1-h),E=Math.sqrt(h);return this.set(p*Math.sin(a),p*Math.cos(a),E*Math.sin(c),E*Math.cos(c))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,c=0){return this._x=a[c],this._y=a[c+1],this._z=a[c+2],this._w=a[c+3],this._onChangeCallback(),this}toArray(a=[],c=0){return a[c]=this._x,a[c+1]=this._y,a[c+2]=this._z,a[c+3]=this._w,a}fromBufferAttribute(a,c){return this._x=a.getX(c),this._y=a.getY(c),this._z=a.getZ(c),this._w=a.getW(c),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Dn{constructor(a=0,c=0,h=0){Dn.prototype.isVector3=!0,this.x=a,this.y=c,this.z=h}set(a,c,h){return void 0===h&&(h=this.z),this.x=a,this.y=c,this.z=h,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this}addVectors(a,c){return this.x=a.x+c.x,this.y=a.y+c.y,this.z=a.z+c.z,this}addScaledVector(a,c){return this.x+=a.x*c,this.y+=a.y*c,this.z+=a.z*c,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this}subVectors(a,c){return this.x=a.x-c.x,this.y=a.y-c.y,this.z=a.z-c.z,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}multiplyVectors(a,c){return this.x=a.x*c.x,this.y=a.y*c.y,this.z=a.z*c.z,this}applyEuler(a){return this.applyQuaternion(Vc.setFromEuler(a))}applyAxisAngle(a,c){return this.applyQuaternion(Vc.setFromAxisAngle(a,c))}applyMatrix3(a){const c=this.x,h=this.y,p=this.z,E=a.elements;return this.x=E[0]*c+E[3]*h+E[6]*p,this.y=E[1]*c+E[4]*h+E[7]*p,this.z=E[2]*c+E[5]*h+E[8]*p,this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){const c=this.x,h=this.y,p=this.z,E=a.elements,H=1/(E[3]*c+E[7]*h+E[11]*p+E[15]);return this.x=(E[0]*c+E[4]*h+E[8]*p+E[12])*H,this.y=(E[1]*c+E[5]*h+E[9]*p+E[13])*H,this.z=(E[2]*c+E[6]*h+E[10]*p+E[14])*H,this}applyQuaternion(a){const c=this.x,h=this.y,p=this.z,E=a.x,H=a.y,K=a.z,de=a.w,ge=2*(H*p-K*h),Me=2*(K*c-E*p),Le=2*(E*h-H*c);return this.x=c+de*ge+H*Le-K*Me,this.y=h+de*Me+K*ge-E*Le,this.z=p+de*Le+E*Me-H*ge,this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){const c=this.x,h=this.y,p=this.z,E=a.elements;return this.x=E[0]*c+E[4]*h+E[8]*p,this.y=E[1]*c+E[5]*h+E[9]*p,this.z=E[2]*c+E[6]*h+E[10]*p,this.normalize()}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}clamp(a,c){return this.x=Math.max(a.x,Math.min(c.x,this.x)),this.y=Math.max(a.y,Math.min(c.y,this.y)),this.z=Math.max(a.z,Math.min(c.z,this.z)),this}clampScalar(a,c){return this.x=Math.max(a,Math.min(c,this.x)),this.y=Math.max(a,Math.min(c,this.y)),this.z=Math.max(a,Math.min(c,this.z)),this}clampLength(a,c){const h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(c,h)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){return this.x+=(a.x-this.x)*c,this.y+=(a.y-this.y)*c,this.z+=(a.z-this.z)*c,this}lerpVectors(a,c,h){return this.x=a.x+(c.x-a.x)*h,this.y=a.y+(c.y-a.y)*h,this.z=a.z+(c.z-a.z)*h,this}cross(a){return this.crossVectors(this,a)}crossVectors(a,c){const h=a.x,p=a.y,E=a.z,H=c.x,K=c.y,de=c.z;return this.x=p*de-E*K,this.y=E*H-h*de,this.z=h*K-p*H,this}projectOnVector(a){const c=a.lengthSq();if(0===c)return this.set(0,0,0);const h=a.dot(this)/c;return this.copy(a).multiplyScalar(h)}projectOnPlane(a){return Sr.copy(this).projectOnVector(a),this.sub(Sr)}reflect(a){return this.sub(Sr.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){const c=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===c)return Math.PI/2;const h=this.dot(a)/c;return Math.acos(Gl(h,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const c=this.x-a.x,h=this.y-a.y,p=this.z-a.z;return c*c+h*h+p*p}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,c,h){const p=Math.sin(c)*a;return this.x=p*Math.sin(h),this.y=Math.cos(c)*a,this.z=p*Math.cos(h),this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,c,h){return this.x=a*Math.sin(c),this.y=h,this.z=a*Math.cos(c),this}setFromMatrixPosition(a){const c=a.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(a){const c=this.setFromMatrixColumn(a,0).length(),h=this.setFromMatrixColumn(a,1).length(),p=this.setFromMatrixColumn(a,2).length();return this.x=c,this.y=h,this.z=p,this}setFromMatrixColumn(a,c){return this.fromArray(a.elements,4*c)}setFromMatrix3Column(a,c){return this.fromArray(a.elements,3*c)}setFromEuler(a){return this.x=a._x,this.y=a._y,this.z=a._z,this}setFromColor(a){return this.x=a.r,this.y=a.g,this.z=a.b,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,c=0){return this.x=a[c],this.y=a[c+1],this.z=a[c+2],this}toArray(a=[],c=0){return a[c]=this.x,a[c+1]=this.y,a[c+2]=this.z,a}fromBufferAttribute(a,c){return this.x=a.getX(c),this.y=a.getY(c),this.z=a.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const a=Math.random()*Math.PI*2,c=2*Math.random()-1,h=Math.sqrt(1-c*c);return this.x=h*Math.cos(a),this.y=c,this.z=h*Math.sin(a),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Sr=new Dn,Vc=new Lo;class Ys{constructor(a=new Dn(1/0,1/0,1/0),c=new Dn(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=a,this.max=c}set(a,c){return this.min.copy(a),this.max.copy(c),this}setFromArray(a){this.makeEmpty();for(let c=0,h=a.length;c<h;c+=3)this.expandByPoint(hl.fromArray(a,c));return this}setFromBufferAttribute(a){this.makeEmpty();for(let c=0,h=a.count;c<h;c++)this.expandByPoint(hl.fromBufferAttribute(a,c));return this}setFromPoints(a){this.makeEmpty();for(let c=0,h=a.length;c<h;c++)this.expandByPoint(a[c]);return this}setFromCenterAndSize(a,c){const h=hl.copy(c).multiplyScalar(.5);return this.min.copy(a).sub(h),this.max.copy(a).add(h),this}setFromObject(a,c=!1){return this.makeEmpty(),this.expandByObject(a,c)}clone(){return(new this.constructor).copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}expandByObject(a,c=!1){a.updateWorldMatrix(!1,!1);const h=a.geometry;if(void 0!==h){const E=h.getAttribute("position");if(!0===c&&void 0!==E&&!0!==a.isInstancedMesh)for(let H=0,K=E.count;H<K;H++)!0===a.isMesh?a.getVertexPosition(H,hl):hl.fromBufferAttribute(E,H),hl.applyMatrix4(a.matrixWorld),this.expandByPoint(hl);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),Gc.copy(a.boundingBox)):(null===h.boundingBox&&h.computeBoundingBox(),Gc.copy(h.boundingBox)),Gc.applyMatrix4(a.matrixWorld),this.union(Gc)}const p=a.children;for(let E=0,H=p.length;E<H;E++)this.expandByObject(p[E],c);return this}containsPoint(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,c){return c.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)}intersectsSphere(a){return this.clampPoint(a.center,hl),hl.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let c,h;return a.normal.x>0?(c=a.normal.x*this.min.x,h=a.normal.x*this.max.x):(c=a.normal.x*this.max.x,h=a.normal.x*this.min.x),a.normal.y>0?(c+=a.normal.y*this.min.y,h+=a.normal.y*this.max.y):(c+=a.normal.y*this.max.y,h+=a.normal.y*this.min.y),a.normal.z>0?(c+=a.normal.z*this.min.z,h+=a.normal.z*this.max.z):(c+=a.normal.z*this.max.z,h+=a.normal.z*this.min.z),c<=-a.constant&&h>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(Mh),IA.subVectors(this.max,Mh),rc.subVectors(a.a,Mh),Pp.subVectors(a.b,Mh),Rp.subVectors(a.c,Mh),Kl.subVectors(Pp,rc),Mc.subVectors(Rp,Pp),Yf.subVectors(rc,Rp);let c=[0,-Kl.z,Kl.y,0,-Mc.z,Mc.y,0,-Yf.z,Yf.y,Kl.z,0,-Kl.x,Mc.z,0,-Mc.x,Yf.z,0,-Yf.x,-Kl.y,Kl.x,0,-Mc.y,Mc.x,0,-Yf.y,Yf.x,0];return!(!Kf(c,rc,Pp,Rp,IA)||(c=[1,0,0,0,1,0,0,0,1],!Kf(c,rc,Pp,Rp,IA)))&&(kp.crossVectors(Kl,Mc),c=[kp.x,kp.y,kp.z],Kf(c,rc,Pp,Rp,IA))}clampPoint(a,c){return c.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,hl).distanceTo(a)}getBoundingSphere(a){return this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(hl).length()),a}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}applyMatrix4(a){return this.isEmpty()||(ul[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),ul[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),ul[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),ul[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),ul[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),ul[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),ul[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),ul[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(ul)),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const ul=[new Dn,new Dn,new Dn,new Dn,new Dn,new Dn,new Dn,new Dn],hl=new Dn,Gc=new Ys,rc=new Dn,Pp=new Dn,Rp=new Dn,Kl=new Dn,Mc=new Dn,Yf=new Dn,Mh=new Dn,IA=new Dn,kp=new Dn,Sh=new Dn;function Kf(M,a,c,h,p){for(let E=0,H=M.length-3;E<=H;E+=3){Sh.fromArray(M,E);const K=p.x*Math.abs(Sh.x)+p.y*Math.abs(Sh.y)+p.z*Math.abs(Sh.z),de=a.dot(Sh),ge=c.dot(Sh),Me=h.dot(Sh);if(Math.max(-Math.max(de,ge,Me),Math.min(de,ge,Me))>K)return!1}return!0}const zx=new Ys,Fp=new Dn,Y0=new Dn;class sc{constructor(a=new Dn,c=-1){this.isSphere=!0,this.center=a,this.radius=c}set(a,c){return this.center.copy(a),this.radius=c,this}setFromPoints(a,c){const h=this.center;void 0!==c?h.copy(c):zx.setFromPoints(a).getCenter(h);let p=0;for(let E=0,H=a.length;E<H;E++)p=Math.max(p,h.distanceToSquared(a[E]));return this.radius=Math.sqrt(p),this}copy(a){return this.center.copy(a.center),this.radius=a.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){const c=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=c*c}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,c){const h=this.center.distanceToSquared(a);return c.copy(a),h>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(a){return this.isEmpty()?(a.makeEmpty(),a):(a.set(this.center,this.center),a.expandByScalar(this.radius),a)}applyMatrix4(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this}translate(a){return this.center.add(a),this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;Fp.subVectors(a,this.center);const c=Fp.lengthSq();if(c>this.radius*this.radius){const h=Math.sqrt(c),p=.5*(h-this.radius);this.center.addScaledVector(Fp,p/h),this.radius+=p}return this}union(a){return a.isEmpty()?this:this.isEmpty()?(this.copy(a),this):(!0===this.center.equals(a.center)?this.radius=Math.max(this.radius,a.radius):(Y0.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(Fp.copy(a.center).add(Y0)),this.expandByPoint(Fp.copy(a.center).sub(Y0))),this)}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Op=new Dn,E1=new Dn,Lp=new vo;class Zf{constructor(a=new Dn(1,0,0),c=0){this.isPlane=!0,this.normal=a,this.constant=c}set(a,c){return this.normal.copy(a),this.constant=c,this}setComponents(a,c,h,p){return this.normal.set(a,c,h),this.constant=p,this}setFromNormalAndCoplanarPoint(a,c){return this.normal.copy(a),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(a,c,h){const p=Op.subVectors(h,c).cross(E1.subVectors(a,c)).normalize();return this.setFromNormalAndCoplanarPoint(p,a),this}copy(a){return this.normal.copy(a.normal),this.constant=a.constant,this}normalize(){const a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,c){return c.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,c){const h=a.delta(Op),p=this.normal.dot(h);if(0===p)return 0===this.distanceToPoint(a.start)?c.copy(a.start):null;const E=-(a.start.dot(this.normal)+this.constant)/p;return E<0||E>1?null:c.copy(a.start).addScaledVector(h,E)}intersectsLine(a){const c=this.distanceToPoint(a.start),h=this.distanceToPoint(a.end);return c<0&&h>0||h<0&&c>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,c){const h=c||Lp.getNormalMatrix(a),p=this.coplanarPoint(Op).applyMatrix4(a),E=this.normal.applyMatrix3(h).normalize();return this.constant=-p.dot(E),this}translate(a){return this.constant-=a.dot(this.normal),this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const af=new sc,Jc=new Dn;class BA{constructor(a=new Zf,c=new Zf,h=new Zf,p=new Zf,E=new Zf,H=new Zf){this.planes=[a,c,h,p,E,H]}set(a,c,h,p,E,H){const K=this.planes;return K[0].copy(a),K[1].copy(c),K[2].copy(h),K[3].copy(p),K[4].copy(E),K[5].copy(H),this}copy(a){const c=this.planes;for(let h=0;h<6;h++)c[h].copy(a.planes[h]);return this}setFromProjectionMatrix(a,c=pi){const h=this.planes,p=a.elements,E=p[0],H=p[1],K=p[2],de=p[3],ge=p[4],Me=p[5],Le=p[6],Be=p[7],Ge=p[8],it=p[9],bt=p[10],Ye=p[11],qe=p[12],Ft=p[13],mt=p[14],Ut=p[15];if(h[0].setComponents(de-E,Be-ge,Ye-Ge,Ut-qe).normalize(),h[1].setComponents(de+E,Be+ge,Ye+Ge,Ut+qe).normalize(),h[2].setComponents(de+H,Be+Me,Ye+it,Ut+Ft).normalize(),h[3].setComponents(de-H,Be-Me,Ye-it,Ut-Ft).normalize(),h[4].setComponents(de-K,Be-Le,Ye-bt,Ut-mt).normalize(),c===pi)h[5].setComponents(de+K,Be+Le,Ye+bt,Ut+mt).normalize();else{if(2001!==c)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+c);h[5].setComponents(K,Le,bt,mt).normalize()}return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),af.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{const c=a.geometry;null===c.boundingSphere&&c.computeBoundingSphere(),af.copy(c.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(af)}intersectsSprite(a){return af.center.set(0,0,0),af.radius=.7071067811865476,af.applyMatrix4(a.matrixWorld),this.intersectsSphere(af)}intersectsSphere(a){const c=this.planes,h=a.center,p=-a.radius;for(let E=0;E<6;E++)if(c[E].distanceToPoint(h)<p)return!1;return!0}intersectsBox(a){const c=this.planes;for(let h=0;h<6;h++){const p=c[h];if(Jc.x=p.normal.x>0?a.max.x:a.min.x,Jc.y=p.normal.y>0?a.max.y:a.min.y,Jc.z=p.normal.z>0?a.max.z:a.min.z,p.distanceToPoint(Jc)<0)return!1}return!0}containsPoint(a){const c=this.planes;for(let h=0;h<6;h++)if(c[h].distanceToPoint(a)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class lo{constructor(a,c,h,p,E,H,K,de,ge,Me,Le,Be,Ge,it,bt,Ye){lo.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==a&&this.set(a,c,h,p,E,H,K,de,ge,Me,Le,Be,Ge,it,bt,Ye)}set(a,c,h,p,E,H,K,de,ge,Me,Le,Be,Ge,it,bt,Ye){const qe=this.elements;return qe[0]=a,qe[4]=c,qe[8]=h,qe[12]=p,qe[1]=E,qe[5]=H,qe[9]=K,qe[13]=de,qe[2]=ge,qe[6]=Me,qe[10]=Le,qe[14]=Be,qe[3]=Ge,qe[7]=it,qe[11]=bt,qe[15]=Ye,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new lo).fromArray(this.elements)}copy(a){const c=this.elements,h=a.elements;return c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],c[9]=h[9],c[10]=h[10],c[11]=h[11],c[12]=h[12],c[13]=h[13],c[14]=h[14],c[15]=h[15],this}copyPosition(a){const c=this.elements,h=a.elements;return c[12]=h[12],c[13]=h[13],c[14]=h[14],this}setFromMatrix3(a){const c=a.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(a,c,h){return a.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),h.setFromMatrixColumn(this,2),this}makeBasis(a,c,h){return this.set(a.x,c.x,h.x,0,a.y,c.y,h.y,0,a.z,c.z,h.z,0,0,0,0,1),this}extractRotation(a){const c=this.elements,h=a.elements,p=1/nh.setFromMatrixColumn(a,0).length(),E=1/nh.setFromMatrixColumn(a,1).length(),H=1/nh.setFromMatrixColumn(a,2).length();return c[0]=h[0]*p,c[1]=h[1]*p,c[2]=h[2]*p,c[3]=0,c[4]=h[4]*E,c[5]=h[5]*E,c[6]=h[6]*E,c[7]=0,c[8]=h[8]*H,c[9]=h[9]*H,c[10]=h[10]*H,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(a){const c=this.elements,h=a.x,p=a.y,E=a.z,H=Math.cos(h),K=Math.sin(h),de=Math.cos(p),ge=Math.sin(p),Me=Math.cos(E),Le=Math.sin(E);if("XYZ"===a.order){const Be=H*Me,Ge=H*Le,it=K*Me,bt=K*Le;c[0]=de*Me,c[4]=-de*Le,c[8]=ge,c[1]=Ge+it*ge,c[5]=Be-bt*ge,c[9]=-K*de,c[2]=bt-Be*ge,c[6]=it+Ge*ge,c[10]=H*de}else if("YXZ"===a.order){const Be=de*Me,Ge=de*Le,it=ge*Me,bt=ge*Le;c[0]=Be+bt*K,c[4]=it*K-Ge,c[8]=H*ge,c[1]=H*Le,c[5]=H*Me,c[9]=-K,c[2]=Ge*K-it,c[6]=bt+Be*K,c[10]=H*de}else if("ZXY"===a.order){const Be=de*Me,Ge=de*Le,it=ge*Me,bt=ge*Le;c[0]=Be-bt*K,c[4]=-H*Le,c[8]=it+Ge*K,c[1]=Ge+it*K,c[5]=H*Me,c[9]=bt-Be*K,c[2]=-H*ge,c[6]=K,c[10]=H*de}else if("ZYX"===a.order){const Be=H*Me,Ge=H*Le,it=K*Me,bt=K*Le;c[0]=de*Me,c[4]=it*ge-Ge,c[8]=Be*ge+bt,c[1]=de*Le,c[5]=bt*ge+Be,c[9]=Ge*ge-it,c[2]=-ge,c[6]=K*de,c[10]=H*de}else if("YZX"===a.order){const Be=H*de,Ge=H*ge,it=K*de,bt=K*ge;c[0]=de*Me,c[4]=bt-Be*Le,c[8]=it*Le+Ge,c[1]=Le,c[5]=H*Me,c[9]=-K*Me,c[2]=-ge*Me,c[6]=Ge*Le+it,c[10]=Be-bt*Le}else if("XZY"===a.order){const Be=H*de,Ge=H*ge,it=K*de,bt=K*ge;c[0]=de*Me,c[4]=-Le,c[8]=ge*Me,c[1]=Be*Le+bt,c[5]=H*Me,c[9]=Ge*Le-it,c[2]=it*Le-Ge,c[6]=K*Me,c[10]=bt*Le+Be}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(a){return this.compose(Jf,a,Fg)}lookAt(a,c,h){const p=this.elements;return Td.subVectors(a,c),0===Td.lengthSq()&&(Td.z=1),Td.normalize(),mu.crossVectors(h,Td),0===mu.lengthSq()&&(1===Math.abs(h.z)?Td.x+=1e-4:Td.z+=1e-4,Td.normalize(),mu.crossVectors(h,Td)),mu.normalize(),Np.crossVectors(Td,mu),p[0]=mu.x,p[4]=Np.x,p[8]=Td.x,p[1]=mu.y,p[5]=Np.y,p[9]=Td.y,p[2]=mu.z,p[6]=Np.z,p[10]=Td.z,this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,c){const h=a.elements,p=c.elements,E=this.elements,H=h[0],K=h[4],de=h[8],ge=h[12],Me=h[1],Le=h[5],Be=h[9],Ge=h[13],it=h[2],bt=h[6],Ye=h[10],qe=h[14],Ft=h[3],mt=h[7],Ut=h[11],kn=h[15],bn=p[0],wn=p[4],$n=p[8],wi=p[12],Nt=p[1],In=p[5],dr=p[9],hr=p[13],ei=p[2],Yi=p[6],Pi=p[10],or=p[14],rr=p[3],nr=p[7],Gr=p[11],zr=p[15];return E[0]=H*bn+K*Nt+de*ei+ge*rr,E[4]=H*wn+K*In+de*Yi+ge*nr,E[8]=H*$n+K*dr+de*Pi+ge*Gr,E[12]=H*wi+K*hr+de*or+ge*zr,E[1]=Me*bn+Le*Nt+Be*ei+Ge*rr,E[5]=Me*wn+Le*In+Be*Yi+Ge*nr,E[9]=Me*$n+Le*dr+Be*Pi+Ge*Gr,E[13]=Me*wi+Le*hr+Be*or+Ge*zr,E[2]=it*bn+bt*Nt+Ye*ei+qe*rr,E[6]=it*wn+bt*In+Ye*Yi+qe*nr,E[10]=it*$n+bt*dr+Ye*Pi+qe*Gr,E[14]=it*wi+bt*hr+Ye*or+qe*zr,E[3]=Ft*bn+mt*Nt+Ut*ei+kn*rr,E[7]=Ft*wn+mt*In+Ut*Yi+kn*nr,E[11]=Ft*$n+mt*dr+Ut*Pi+kn*Gr,E[15]=Ft*wi+mt*hr+Ut*or+kn*zr,this}multiplyScalar(a){const c=this.elements;return c[0]*=a,c[4]*=a,c[8]*=a,c[12]*=a,c[1]*=a,c[5]*=a,c[9]*=a,c[13]*=a,c[2]*=a,c[6]*=a,c[10]*=a,c[14]*=a,c[3]*=a,c[7]*=a,c[11]*=a,c[15]*=a,this}determinant(){const a=this.elements,c=a[0],h=a[4],p=a[8],E=a[12],H=a[1],K=a[5],de=a[9],ge=a[13],Me=a[2],Le=a[6],Be=a[10],Ge=a[14];return a[3]*(+E*de*Le-p*ge*Le-E*K*Be+h*ge*Be+p*K*Ge-h*de*Ge)+a[7]*(+c*de*Ge-c*ge*Be+E*H*Be-p*H*Ge+p*ge*Me-E*de*Me)+a[11]*(+c*ge*Le-c*K*Ge-E*H*Le+h*H*Ge+E*K*Me-h*ge*Me)+a[15]*(-p*K*Me-c*de*Le+c*K*Be+p*H*Le-h*H*Be+h*de*Me)}transpose(){const a=this.elements;let c;return c=a[1],a[1]=a[4],a[4]=c,c=a[2],a[2]=a[8],a[8]=c,c=a[6],a[6]=a[9],a[9]=c,c=a[3],a[3]=a[12],a[12]=c,c=a[7],a[7]=a[13],a[13]=c,c=a[11],a[11]=a[14],a[14]=c,this}setPosition(a,c,h){const p=this.elements;return a.isVector3?(p[12]=a.x,p[13]=a.y,p[14]=a.z):(p[12]=a,p[13]=c,p[14]=h),this}invert(){const a=this.elements,c=a[0],h=a[1],p=a[2],E=a[3],H=a[4],K=a[5],de=a[6],ge=a[7],Me=a[8],Le=a[9],Be=a[10],Ge=a[11],it=a[12],bt=a[13],Ye=a[14],qe=a[15],Ft=Le*Ye*ge-bt*Be*ge+bt*de*Ge-K*Ye*Ge-Le*de*qe+K*Be*qe,mt=it*Be*ge-Me*Ye*ge-it*de*Ge+H*Ye*Ge+Me*de*qe-H*Be*qe,Ut=Me*bt*ge-it*Le*ge+it*K*Ge-H*bt*Ge-Me*K*qe+H*Le*qe,kn=it*Le*de-Me*bt*de-it*K*Be+H*bt*Be+Me*K*Ye-H*Le*Ye,bn=c*Ft+h*mt+p*Ut+E*kn;if(0===bn)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const wn=1/bn;return a[0]=Ft*wn,a[1]=(bt*Be*E-Le*Ye*E-bt*p*Ge+h*Ye*Ge+Le*p*qe-h*Be*qe)*wn,a[2]=(K*Ye*E-bt*de*E+bt*p*ge-h*Ye*ge-K*p*qe+h*de*qe)*wn,a[3]=(Le*de*E-K*Be*E-Le*p*ge+h*Be*ge+K*p*Ge-h*de*Ge)*wn,a[4]=mt*wn,a[5]=(Me*Ye*E-it*Be*E+it*p*Ge-c*Ye*Ge-Me*p*qe+c*Be*qe)*wn,a[6]=(it*de*E-H*Ye*E-it*p*ge+c*Ye*ge+H*p*qe-c*de*qe)*wn,a[7]=(H*Be*E-Me*de*E+Me*p*ge-c*Be*ge-H*p*Ge+c*de*Ge)*wn,a[8]=Ut*wn,a[9]=(it*Le*E-Me*bt*E-it*h*Ge+c*bt*Ge+Me*h*qe-c*Le*qe)*wn,a[10]=(H*bt*E-it*K*E+it*h*ge-c*bt*ge-H*h*qe+c*K*qe)*wn,a[11]=(Me*K*E-H*Le*E-Me*h*ge+c*Le*ge+H*h*Ge-c*K*Ge)*wn,a[12]=kn*wn,a[13]=(Me*bt*p-it*Le*p+it*h*Be-c*bt*Be-Me*h*Ye+c*Le*Ye)*wn,a[14]=(it*K*p-H*bt*p-it*h*de+c*bt*de+H*h*Ye-c*K*Ye)*wn,a[15]=(H*Le*p-Me*K*p+Me*h*de-c*Le*de-H*h*Be+c*K*Be)*wn,this}scale(a){const c=this.elements,h=a.x,p=a.y,E=a.z;return c[0]*=h,c[4]*=p,c[8]*=E,c[1]*=h,c[5]*=p,c[9]*=E,c[2]*=h,c[6]*=p,c[10]*=E,c[3]*=h,c[7]*=p,c[11]*=E,this}getMaxScaleOnAxis(){const a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,c,h){return a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,c,0,0,1,h,0,0,0,1),this}makeRotationX(a){const c=Math.cos(a),h=Math.sin(a);return this.set(1,0,0,0,0,c,-h,0,0,h,c,0,0,0,0,1),this}makeRotationY(a){const c=Math.cos(a),h=Math.sin(a);return this.set(c,0,h,0,0,1,0,0,-h,0,c,0,0,0,0,1),this}makeRotationZ(a){const c=Math.cos(a),h=Math.sin(a);return this.set(c,-h,0,0,h,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(a,c){const h=Math.cos(c),p=Math.sin(c),E=1-h,H=a.x,K=a.y,de=a.z,ge=E*H,Me=E*K;return this.set(ge*H+h,ge*K-p*de,ge*de+p*K,0,ge*K+p*de,Me*K+h,Me*de-p*H,0,ge*de-p*K,Me*de+p*H,E*de*de+h,0,0,0,0,1),this}makeScale(a,c,h){return this.set(a,0,0,0,0,c,0,0,0,0,h,0,0,0,0,1),this}makeShear(a,c,h,p,E,H){return this.set(1,h,E,0,a,1,H,0,c,p,1,0,0,0,0,1),this}compose(a,c,h){const p=this.elements,E=c._x,H=c._y,K=c._z,de=c._w,ge=E+E,Me=H+H,Le=K+K,Be=E*ge,Ge=E*Me,it=E*Le,bt=H*Me,Ye=H*Le,qe=K*Le,Ft=de*ge,mt=de*Me,Ut=de*Le,kn=h.x,bn=h.y,wn=h.z;return p[0]=(1-(bt+qe))*kn,p[1]=(Ge+Ut)*kn,p[2]=(it-mt)*kn,p[3]=0,p[4]=(Ge-Ut)*bn,p[5]=(1-(Be+qe))*bn,p[6]=(Ye+Ft)*bn,p[7]=0,p[8]=(it+mt)*wn,p[9]=(Ye-Ft)*wn,p[10]=(1-(Be+bt))*wn,p[11]=0,p[12]=a.x,p[13]=a.y,p[14]=a.z,p[15]=1,this}decompose(a,c,h){const p=this.elements;let E=nh.set(p[0],p[1],p[2]).length();const H=nh.set(p[4],p[5],p[6]).length(),K=nh.set(p[8],p[9],p[10]).length();this.determinant()<0&&(E=-E),a.x=p[12],a.y=p[13],a.z=p[14],xl.copy(this);const ge=1/E,Me=1/H,Le=1/K;return xl.elements[0]*=ge,xl.elements[1]*=ge,xl.elements[2]*=ge,xl.elements[4]*=Me,xl.elements[5]*=Me,xl.elements[6]*=Me,xl.elements[8]*=Le,xl.elements[9]*=Le,xl.elements[10]*=Le,c.setFromRotationMatrix(xl),h.x=E,h.y=H,h.z=K,this}makePerspective(a,c,h,p,E,H,K=pi){const de=this.elements,ge=2*E/(c-a),Me=2*E/(h-p),Le=(c+a)/(c-a),Be=(h+p)/(h-p);let Ge,it;if(K===pi)Ge=-(H+E)/(H-E),it=-2*H*E/(H-E);else{if(2001!==K)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+K);Ge=-H/(H-E),it=-H*E/(H-E)}return de[0]=ge,de[4]=0,de[8]=Le,de[12]=0,de[1]=0,de[5]=Me,de[9]=Be,de[13]=0,de[2]=0,de[6]=0,de[10]=Ge,de[14]=it,de[3]=0,de[7]=0,de[11]=-1,de[15]=0,this}makeOrthographic(a,c,h,p,E,H,K=pi){const de=this.elements,ge=1/(c-a),Me=1/(h-p),Le=1/(H-E),Be=(c+a)*ge,Ge=(h+p)*Me;let it,bt;if(K===pi)it=(H+E)*Le,bt=-2*Le;else{if(2001!==K)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+K);it=E*Le,bt=-1*Le}return de[0]=2*ge,de[4]=0,de[8]=0,de[12]=-Be,de[1]=0,de[5]=2*Me,de[9]=0,de[13]=-Ge,de[2]=0,de[6]=0,de[10]=bt,de[14]=-it,de[3]=0,de[7]=0,de[11]=0,de[15]=1,this}equals(a){const c=this.elements,h=a.elements;for(let p=0;p<16;p++)if(c[p]!==h[p])return!1;return!0}fromArray(a,c=0){for(let h=0;h<16;h++)this.elements[h]=a[h+c];return this}toArray(a=[],c=0){const h=this.elements;return a[c]=h[0],a[c+1]=h[1],a[c+2]=h[2],a[c+3]=h[3],a[c+4]=h[4],a[c+5]=h[5],a[c+6]=h[6],a[c+7]=h[7],a[c+8]=h[8],a[c+9]=h[9],a[c+10]=h[10],a[c+11]=h[11],a[c+12]=h[12],a[c+13]=h[13],a[c+14]=h[14],a[c+15]=h[15],a}}const nh=new Dn,xl=new lo,Jf=new Dn(0,0,0),Fg=new Dn(1,1,1),mu=new Dn,Np=new Dn,Td=new Dn;function lf(){let M=null,a=!1,c=null,h=null;function p(E,H){c(E,H),h=M.requestAnimationFrame(p)}return{start:function(){!0!==a&&null!==c&&(h=M.requestAnimationFrame(p),a=!0)},stop:function(){M.cancelAnimationFrame(h),a=!1},setAnimationLoop:function(E){c=E},setContext:function(E){M=E}}}function Og(M,a){const c=a.isWebGL2,h=new WeakMap;return{get:function H(ge){return ge.isInterleavedBufferAttribute&&(ge=ge.data),h.get(ge)},remove:function K(ge){ge.isInterleavedBufferAttribute&&(ge=ge.data);const Me=h.get(ge);Me&&(M.deleteBuffer(Me.buffer),h.delete(ge))},update:function de(ge,Me){if(ge.isGLBufferAttribute){const Be=h.get(ge);return void((!Be||Be.version<ge.version)&&h.set(ge,{buffer:ge.buffer,type:ge.type,bytesPerElement:ge.elementSize,version:ge.version}))}ge.isInterleavedBufferAttribute&&(ge=ge.data);const Le=h.get(ge);if(void 0===Le)h.set(ge,function p(ge,Me){const Le=ge.array,Be=ge.usage,Ge=Le.byteLength,it=M.createBuffer();let bt;if(M.bindBuffer(Me,it),M.bufferData(Me,Le,Be),ge.onUploadCallback(),Le instanceof Float32Array)bt=M.FLOAT;else if(Le instanceof Uint16Array)if(ge.isFloat16BufferAttribute){if(!c)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");bt=M.HALF_FLOAT}else bt=M.UNSIGNED_SHORT;else if(Le instanceof Int16Array)bt=M.SHORT;else if(Le instanceof Uint32Array)bt=M.UNSIGNED_INT;else if(Le instanceof Int32Array)bt=M.INT;else if(Le instanceof Int8Array)bt=M.BYTE;else if(Le instanceof Uint8Array)bt=M.UNSIGNED_BYTE;else{if(!(Le instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Le);bt=M.UNSIGNED_BYTE}return{buffer:it,type:bt,bytesPerElement:Le.BYTES_PER_ELEMENT,version:ge.version,size:Ge}}(ge,Me));else if(Le.version<ge.version){if(Le.size!==ge.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function E(ge,Me,Le){const Be=Me.array,Ge=Me._updateRange,it=Me.updateRanges;if(M.bindBuffer(Le,ge),-1===Ge.count&&0===it.length&&M.bufferSubData(Le,0,Be),0!==it.length){for(let bt=0,Ye=it.length;bt<Ye;bt++){const qe=it[bt];c?M.bufferSubData(Le,qe.start*Be.BYTES_PER_ELEMENT,Be,qe.start,qe.count):M.bufferSubData(Le,qe.start*Be.BYTES_PER_ELEMENT,Be.subarray(qe.start,qe.start+qe.count))}Me.clearUpdateRanges()}-1!==Ge.count&&(c?M.bufferSubData(Le,Ge.offset*Be.BYTES_PER_ELEMENT,Be,Ge.offset,Ge.count):M.bufferSubData(Le,Ge.offset*Be.BYTES_PER_ELEMENT,Be.subarray(Ge.offset,Ge.offset+Ge.count)),Ge.count=-1),Me.onUploadCallback()})(Le.buffer,ge,Me),Le.version=ge.version}}}}const Il=new Dn,Up=new Si;class pl{constructor(a,c,h=!1){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=a,this.itemSize=c,this.count=void 0!==a?a.length/c:0,this.normalized=h,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Cn,this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}get updateRange(){return function Rg(M){M in TA||(TA[M]=!0,console.warn(M))}("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(a){return this.usage=a,this}addUpdateRange(a,c){this.updateRanges.push({start:a,count:c})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this.gpuType=a.gpuType,this}copyAt(a,c,h){a*=this.itemSize,h*=c.itemSize;for(let p=0,E=this.itemSize;p<E;p++)this.array[a+p]=c.array[h+p];return this}copyArray(a){return this.array.set(a),this}applyMatrix3(a){if(2===this.itemSize)for(let c=0,h=this.count;c<h;c++)Up.fromBufferAttribute(this,c),Up.applyMatrix3(a),this.setXY(c,Up.x,Up.y);else if(3===this.itemSize)for(let c=0,h=this.count;c<h;c++)Il.fromBufferAttribute(this,c),Il.applyMatrix3(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}applyMatrix4(a){for(let c=0,h=this.count;c<h;c++)Il.fromBufferAttribute(this,c),Il.applyMatrix4(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}applyNormalMatrix(a){for(let c=0,h=this.count;c<h;c++)Il.fromBufferAttribute(this,c),Il.applyNormalMatrix(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}transformDirection(a){for(let c=0,h=this.count;c<h;c++)Il.fromBufferAttribute(this,c),Il.transformDirection(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}set(a,c=0){return this.array.set(a,c),this}getComponent(a,c){let h=this.array[a*this.itemSize+c];return this.normalized&&(h=Zo(h,this.array)),h}setComponent(a,c,h){return this.normalized&&(h=mo(h,this.array)),this.array[a*this.itemSize+c]=h,this}getX(a){let c=this.array[a*this.itemSize];return this.normalized&&(c=Zo(c,this.array)),c}setX(a,c){return this.normalized&&(c=mo(c,this.array)),this.array[a*this.itemSize]=c,this}getY(a){let c=this.array[a*this.itemSize+1];return this.normalized&&(c=Zo(c,this.array)),c}setY(a,c){return this.normalized&&(c=mo(c,this.array)),this.array[a*this.itemSize+1]=c,this}getZ(a){let c=this.array[a*this.itemSize+2];return this.normalized&&(c=Zo(c,this.array)),c}setZ(a,c){return this.normalized&&(c=mo(c,this.array)),this.array[a*this.itemSize+2]=c,this}getW(a){let c=this.array[a*this.itemSize+3];return this.normalized&&(c=Zo(c,this.array)),c}setW(a,c){return this.normalized&&(c=mo(c,this.array)),this.array[a*this.itemSize+3]=c,this}setXY(a,c,h){return a*=this.itemSize,this.normalized&&(c=mo(c,this.array),h=mo(h,this.array)),this.array[a+0]=c,this.array[a+1]=h,this}setXYZ(a,c,h,p){return a*=this.itemSize,this.normalized&&(c=mo(c,this.array),h=mo(h,this.array),p=mo(p,this.array)),this.array[a+0]=c,this.array[a+1]=h,this.array[a+2]=p,this}setXYZW(a,c,h,p,E){return a*=this.itemSize,this.normalized&&(c=mo(c,this.array),h=mo(h,this.array),p=mo(p,this.array),E=mo(E,this.array)),this.array[a+0]=c,this.array[a+1]=h,this.array[a+2]=p,this.array[a+3]=E,this}onUpload(a){return this.onUploadCallback=a,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(a.name=this.name),35044!==this.usage&&(a.usage=this.usage),a}}class D1 extends pl{constructor(a,c,h){super(new Uint16Array(a),c,h)}}class Im extends pl{constructor(a,c,h){super(new Uint32Array(a),c,h)}}class xo extends pl{constructor(a,c,h){super(new Float32Array(a),c,h)}}const I1=new lo,zp=new Lo;let Ec=(()=>{class M{constructor(c=0,h=0,p=0,E=M.DEFAULT_ORDER){this.isEuler=!0,this._x=c,this._y=h,this._z=p,this._order=E}get x(){return this._x}set x(c){this._x=c,this._onChangeCallback()}get y(){return this._y}set y(c){this._y=c,this._onChangeCallback()}get z(){return this._z}set z(c){this._z=c,this._onChangeCallback()}get order(){return this._order}set order(c){this._order=c,this._onChangeCallback()}set(c,h,p,E=this._order){return this._x=c,this._y=h,this._z=p,this._order=E,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(c){return this._x=c._x,this._y=c._y,this._z=c._z,this._order=c._order,this._onChangeCallback(),this}setFromRotationMatrix(c,h=this._order,p=!0){const E=c.elements,H=E[0],K=E[4],de=E[8],ge=E[1],Me=E[5],Le=E[9],Be=E[2],Ge=E[6],it=E[10];switch(h){case"XYZ":this._y=Math.asin(Gl(de,-1,1)),Math.abs(de)<.9999999?(this._x=Math.atan2(-Le,it),this._z=Math.atan2(-K,H)):(this._x=Math.atan2(Ge,Me),this._z=0);break;case"YXZ":this._x=Math.asin(-Gl(Le,-1,1)),Math.abs(Le)<.9999999?(this._y=Math.atan2(de,it),this._z=Math.atan2(ge,Me)):(this._y=Math.atan2(-Be,H),this._z=0);break;case"ZXY":this._x=Math.asin(Gl(Ge,-1,1)),Math.abs(Ge)<.9999999?(this._y=Math.atan2(-Be,it),this._z=Math.atan2(-K,Me)):(this._y=0,this._z=Math.atan2(ge,H));break;case"ZYX":this._y=Math.asin(-Gl(Be,-1,1)),Math.abs(Be)<.9999999?(this._x=Math.atan2(Ge,it),this._z=Math.atan2(ge,H)):(this._x=0,this._z=Math.atan2(-K,Me));break;case"YZX":this._z=Math.asin(Gl(ge,-1,1)),Math.abs(ge)<.9999999?(this._x=Math.atan2(-Le,Me),this._y=Math.atan2(-Be,H)):(this._x=0,this._y=Math.atan2(de,it));break;case"XZY":this._z=Math.asin(-Gl(K,-1,1)),Math.abs(K)<.9999999?(this._x=Math.atan2(Ge,Me),this._y=Math.atan2(de,H)):(this._x=Math.atan2(-Le,it),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+h)}return this._order=h,!0===p&&this._onChangeCallback(),this}setFromQuaternion(c,h,p){return I1.makeRotationFromQuaternion(c),this.setFromRotationMatrix(I1,h,p)}setFromVector3(c,h=this._order){return this.set(c.x,c.y,c.z,h)}reorder(c){return zp.setFromEuler(this),this.setFromQuaternion(zp,c)}equals(c){return c._x===this._x&&c._y===this._y&&c._z===this._z&&c._order===this._order}fromArray(c){return this._x=c[0],this._y=c[1],this._z=c[2],void 0!==c[3]&&(this._order=c[3]),this._onChangeCallback(),this}toArray(c=[],h=0){return c[h]=this._x,c[h+1]=this._y,c[h+2]=this._z,c[h+3]=this._order,c}_onChange(c){return this._onChangeCallback=c,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return M.DEFAULT_ORDER="XYZ",M})();class wl{constructor(){this.mask=1}set(a){this.mask=1<<a>>>0}enable(a){this.mask|=1<<a}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a}disable(a){this.mask&=~(1<<a)}disableAll(){this.mask=0}test(a){return!!(this.mask&a.mask)}isEnabled(a){return!!(this.mask&1<<a)}}let Rr=0;const Ks=new Dn,Na=new Lo,oc=new lo,Tc=new Dn,Dc=new Dn,Bm=new Dn,ml=new Lo,Zl=new Dn(1,0,0),Au=new Dn(0,1,0),Ao=new Dn(0,0,1),Pm={type:"added"},B1={type:"removed"},ih={type:"childadded",child:null},ko={type:"childremoved",child:null};let Nl=(()=>{class M extends li{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Rr++}),this.uuid=Yl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=M.DEFAULT_UP.clone();const c=new Dn,h=new Ec,p=new Lo,E=new Dn(1,1,1);h._onChange(function H(){p.setFromEuler(h,!1)}),p._onChange(function K(){h.setFromQuaternion(p,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:c},rotation:{configurable:!0,enumerable:!0,value:h},quaternion:{configurable:!0,enumerable:!0,value:p},scale:{configurable:!0,enumerable:!0,value:E},modelViewMatrix:{value:new lo},normalMatrix:{value:new vo}}),this.matrix=new lo,this.matrixWorld=new lo,this.matrixAutoUpdate=M.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=M.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new wl,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(c){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(c),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(c){return this.quaternion.premultiply(c),this}setRotationFromAxisAngle(c,h){this.quaternion.setFromAxisAngle(c,h)}setRotationFromEuler(c){this.quaternion.setFromEuler(c,!0)}setRotationFromMatrix(c){this.quaternion.setFromRotationMatrix(c)}setRotationFromQuaternion(c){this.quaternion.copy(c)}rotateOnAxis(c,h){return Na.setFromAxisAngle(c,h),this.quaternion.multiply(Na),this}rotateOnWorldAxis(c,h){return Na.setFromAxisAngle(c,h),this.quaternion.premultiply(Na),this}rotateX(c){return this.rotateOnAxis(Zl,c)}rotateY(c){return this.rotateOnAxis(Au,c)}rotateZ(c){return this.rotateOnAxis(Ao,c)}translateOnAxis(c,h){return Ks.copy(c).applyQuaternion(this.quaternion),this.position.add(Ks.multiplyScalar(h)),this}translateX(c){return this.translateOnAxis(Zl,c)}translateY(c){return this.translateOnAxis(Au,c)}translateZ(c){return this.translateOnAxis(Ao,c)}localToWorld(c){return this.updateWorldMatrix(!0,!1),c.applyMatrix4(this.matrixWorld)}worldToLocal(c){return this.updateWorldMatrix(!0,!1),c.applyMatrix4(oc.copy(this.matrixWorld).invert())}lookAt(c,h,p){c.isVector3?Tc.copy(c):Tc.set(c,h,p);const E=this.parent;this.updateWorldMatrix(!0,!1),Dc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?oc.lookAt(Dc,Tc,this.up):oc.lookAt(Tc,Dc,this.up),this.quaternion.setFromRotationMatrix(oc),E&&(oc.extractRotation(E.matrixWorld),Na.setFromRotationMatrix(oc),this.quaternion.premultiply(Na.invert()))}add(c){if(arguments.length>1){for(let h=0;h<arguments.length;h++)this.add(arguments[h]);return this}return c===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",c),this):(c&&c.isObject3D?(null!==c.parent&&c.parent.remove(c),c.parent=this,this.children.push(c),c.dispatchEvent(Pm),ih.child=c,this.dispatchEvent(ih),ih.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",c),this)}remove(c){if(arguments.length>1){for(let p=0;p<arguments.length;p++)this.remove(arguments[p]);return this}const h=this.children.indexOf(c);return-1!==h&&(c.parent=null,this.children.splice(h,1),c.dispatchEvent(B1),ko.child=c,this.dispatchEvent(ko),ko.child=null),this}removeFromParent(){const c=this.parent;return null!==c&&c.remove(this),this}clear(){return this.remove(...this.children)}attach(c){return this.updateWorldMatrix(!0,!1),oc.copy(this.matrixWorld).invert(),null!==c.parent&&(c.parent.updateWorldMatrix(!0,!1),oc.multiply(c.parent.matrixWorld)),c.applyMatrix4(oc),this.add(c),c.updateWorldMatrix(!1,!0),this}getObjectById(c){return this.getObjectByProperty("id",c)}getObjectByName(c){return this.getObjectByProperty("name",c)}getObjectByProperty(c,h){if(this[c]===h)return this;for(let p=0,E=this.children.length;p<E;p++){const K=this.children[p].getObjectByProperty(c,h);if(void 0!==K)return K}}getObjectsByProperty(c,h,p=[]){this[c]===h&&p.push(this);const E=this.children;for(let H=0,K=E.length;H<K;H++)E[H].getObjectsByProperty(c,h,p);return p}getWorldPosition(c){return this.updateWorldMatrix(!0,!1),c.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(c){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Dc,c,Bm),c}getWorldScale(c){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Dc,ml,c),c}getWorldDirection(c){this.updateWorldMatrix(!0,!1);const h=this.matrixWorld.elements;return c.set(h[8],h[9],h[10]).normalize()}raycast(){}traverse(c){c(this);const h=this.children;for(let p=0,E=h.length;p<E;p++)h[p].traverse(c)}traverseVisible(c){if(!1===this.visible)return;c(this);const h=this.children;for(let p=0,E=h.length;p<E;p++)h[p].traverseVisible(c)}traverseAncestors(c){const h=this.parent;null!==h&&(c(h),h.traverseAncestors(c))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(c){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||c)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,c=!0);const h=this.children;for(let p=0,E=h.length;p<E;p++){const H=h[p];(!0===H.matrixWorldAutoUpdate||!0===c)&&H.updateMatrixWorld(c)}}updateWorldMatrix(c,h){const p=this.parent;if(!0===c&&null!==p&&!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===h){const E=this.children;for(let H=0,K=E.length;H<K;H++){const de=E[H];!0===de.matrixWorldAutoUpdate&&de.updateWorldMatrix(!1,!0)}}}toJSON(c){const h=void 0===c||"string"==typeof c,p={};h&&(c={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},p.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const E={};function H(de,ge){return void 0===de[ge.uuid]&&(de[ge.uuid]=ge.toJSON(c)),ge.uuid}if(E.uuid=this.uuid,E.type=this.type,""!==this.name&&(E.name=this.name),!0===this.castShadow&&(E.castShadow=!0),!0===this.receiveShadow&&(E.receiveShadow=!0),!1===this.visible&&(E.visible=!1),!1===this.frustumCulled&&(E.frustumCulled=!1),0!==this.renderOrder&&(E.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(E.userData=this.userData),E.layers=this.layers.mask,E.matrix=this.matrix.toArray(),E.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(E.matrixAutoUpdate=!1),this.isInstancedMesh&&(E.type="InstancedMesh",E.count=this.count,E.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(E.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(E.type="BatchedMesh",E.perObjectFrustumCulled=this.perObjectFrustumCulled,E.sortObjects=this.sortObjects,E.drawRanges=this._drawRanges,E.reservedRanges=this._reservedRanges,E.visibility=this._visibility,E.active=this._active,E.bounds=this._bounds.map(de=>({boxInitialized:de.boxInitialized,boxMin:de.box.min.toArray(),boxMax:de.box.max.toArray(),sphereInitialized:de.sphereInitialized,sphereRadius:de.sphere.radius,sphereCenter:de.sphere.center.toArray()})),E.maxGeometryCount=this._maxGeometryCount,E.maxVertexCount=this._maxVertexCount,E.maxIndexCount=this._maxIndexCount,E.geometryInitialized=this._geometryInitialized,E.geometryCount=this._geometryCount,E.matricesTexture=this._matricesTexture.toJSON(c),null!==this.boundingSphere&&(E.boundingSphere={center:E.boundingSphere.center.toArray(),radius:E.boundingSphere.radius}),null!==this.boundingBox&&(E.boundingBox={min:E.boundingBox.min.toArray(),max:E.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?E.background=this.background.toJSON():this.background.isTexture&&(E.background=this.background.toJSON(c).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(E.environment=this.environment.toJSON(c).uuid);else if(this.isMesh||this.isLine||this.isPoints){E.geometry=H(c.geometries,this.geometry);const de=this.geometry.parameters;if(void 0!==de&&void 0!==de.shapes){const ge=de.shapes;if(Array.isArray(ge))for(let Me=0,Le=ge.length;Me<Le;Me++)H(c.shapes,ge[Me]);else H(c.shapes,ge)}}if(this.isSkinnedMesh&&(E.bindMode=this.bindMode,E.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(H(c.skeletons,this.skeleton),E.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const de=[];for(let ge=0,Me=this.material.length;ge<Me;ge++)de.push(H(c.materials,this.material[ge]));E.material=de}else E.material=H(c.materials,this.material);if(this.children.length>0){E.children=[];for(let de=0;de<this.children.length;de++)E.children.push(this.children[de].toJSON(c).object)}if(this.animations.length>0){E.animations=[];for(let de=0;de<this.animations.length;de++)E.animations.push(H(c.animations,this.animations[de]))}if(h){const de=K(c.geometries),ge=K(c.materials),Me=K(c.textures),Le=K(c.images),Be=K(c.shapes),Ge=K(c.skeletons),it=K(c.animations),bt=K(c.nodes);de.length>0&&(p.geometries=de),ge.length>0&&(p.materials=ge),Me.length>0&&(p.textures=Me),Le.length>0&&(p.images=Le),Be.length>0&&(p.shapes=Be),Ge.length>0&&(p.skeletons=Ge),it.length>0&&(p.animations=it),bt.length>0&&(p.nodes=bt)}return p.object=E,p;function K(de){const ge=[];for(const Me in de){const Le=de[Me];delete Le.metadata,ge.push(Le)}return ge}}clone(c){return(new this.constructor).copy(this,c)}copy(c,h=!0){if(this.name=c.name,this.up.copy(c.up),this.position.copy(c.position),this.rotation.order=c.rotation.order,this.quaternion.copy(c.quaternion),this.scale.copy(c.scale),this.matrix.copy(c.matrix),this.matrixWorld.copy(c.matrixWorld),this.matrixAutoUpdate=c.matrixAutoUpdate,this.matrixWorldAutoUpdate=c.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=c.matrixWorldNeedsUpdate,this.layers.mask=c.layers.mask,this.visible=c.visible,this.castShadow=c.castShadow,this.receiveShadow=c.receiveShadow,this.frustumCulled=c.frustumCulled,this.renderOrder=c.renderOrder,this.animations=c.animations.slice(),this.userData=JSON.parse(JSON.stringify(c.userData)),!0===h)for(let p=0;p<c.children.length;p++)this.add(c.children[p].clone());return this}}return M.DEFAULT_UP=new Dn(0,1,0),M.DEFAULT_MATRIX_AUTO_UPDATE=!0,M.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,M})(),Rm=0;const Ac=new lo,Hp=new Nl,Vp=new Dn,ac=new Ys,Bd=new Ys,Bl=new Dn;class us extends li{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Rm++}),this.uuid=Yl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(a){return this.index=Array.isArray(a)?new(Ch(a)?Im:D1)(a,1):a,this}getAttribute(a){return this.attributes[a]}setAttribute(a,c){return this.attributes[a]=c,this}deleteAttribute(a){return delete this.attributes[a],this}hasAttribute(a){return void 0!==this.attributes[a]}addGroup(a,c,h=0){this.groups.push({start:a,count:c,materialIndex:h})}clearGroups(){this.groups=[]}setDrawRange(a,c){this.drawRange.start=a,this.drawRange.count=c}applyMatrix4(a){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(a),c.needsUpdate=!0);const h=this.attributes.normal;if(void 0!==h){const E=(new vo).getNormalMatrix(a);h.applyNormalMatrix(E),h.needsUpdate=!0}const p=this.attributes.tangent;return void 0!==p&&(p.transformDirection(a),p.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(a){return Ac.makeRotationFromQuaternion(a),this.applyMatrix4(Ac),this}rotateX(a){return Ac.makeRotationX(a),this.applyMatrix4(Ac),this}rotateY(a){return Ac.makeRotationY(a),this.applyMatrix4(Ac),this}rotateZ(a){return Ac.makeRotationZ(a),this.applyMatrix4(Ac),this}translate(a,c,h){return Ac.makeTranslation(a,c,h),this.applyMatrix4(Ac),this}scale(a,c,h){return Ac.makeScale(a,c,h),this.applyMatrix4(Ac),this}lookAt(a){return Hp.lookAt(a),Hp.updateMatrix(),this.applyMatrix4(Hp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vp).negate(),this.translate(Vp.x,Vp.y,Vp.z),this}setFromPoints(a){const c=[];for(let h=0,p=a.length;h<p;h++){const E=a[h];c.push(E.x,E.y,E.z||0)}return this.setAttribute("position",new xo(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ys);const a=this.attributes.position,c=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Dn(-1/0,-1/0,-1/0),new Dn(1/0,1/0,1/0));if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),c)for(let h=0,p=c.length;h<p;h++)ac.setFromBufferAttribute(c[h]),this.morphTargetsRelative?(Bl.addVectors(this.boundingBox.min,ac.min),this.boundingBox.expandByPoint(Bl),Bl.addVectors(this.boundingBox.max,ac.max),this.boundingBox.expandByPoint(Bl)):(this.boundingBox.expandByPoint(ac.min),this.boundingBox.expandByPoint(ac.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new sc);const a=this.attributes.position,c=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Dn,1/0);if(a){const h=this.boundingSphere.center;if(ac.setFromBufferAttribute(a),c)for(let E=0,H=c.length;E<H;E++)Bd.setFromBufferAttribute(c[E]),this.morphTargetsRelative?(Bl.addVectors(ac.min,Bd.min),ac.expandByPoint(Bl),Bl.addVectors(ac.max,Bd.max),ac.expandByPoint(Bl)):(ac.expandByPoint(Bd.min),ac.expandByPoint(Bd.max));ac.getCenter(h);let p=0;for(let E=0,H=a.count;E<H;E++)Bl.fromBufferAttribute(a,E),p=Math.max(p,h.distanceToSquared(Bl));if(c)for(let E=0,H=c.length;E<H;E++){const K=c[E],de=this.morphTargetsRelative;for(let ge=0,Me=K.count;ge<Me;ge++)Bl.fromBufferAttribute(K,ge),de&&(Vp.fromBufferAttribute(a,ge),Bl.add(Vp)),p=Math.max(p,h.distanceToSquared(Bl))}this.boundingSphere.radius=Math.sqrt(p),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const a=this.index,c=this.attributes;if(null===a||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const h=c.position,p=c.normal,E=c.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new pl(new Float32Array(4*h.count),4));const H=this.getAttribute("tangent"),K=[],de=[];for(let $n=0;$n<h.count;$n++)K[$n]=new Dn,de[$n]=new Dn;const ge=new Dn,Me=new Dn,Le=new Dn,Be=new Si,Ge=new Si,it=new Si,bt=new Dn,Ye=new Dn;function qe($n,wi,Nt){ge.fromBufferAttribute(h,$n),Me.fromBufferAttribute(h,wi),Le.fromBufferAttribute(h,Nt),Be.fromBufferAttribute(E,$n),Ge.fromBufferAttribute(E,wi),it.fromBufferAttribute(E,Nt),Me.sub(ge),Le.sub(ge),Ge.sub(Be),it.sub(Be);const In=1/(Ge.x*it.y-it.x*Ge.y);isFinite(In)&&(bt.copy(Me).multiplyScalar(it.y).addScaledVector(Le,-Ge.y).multiplyScalar(In),Ye.copy(Le).multiplyScalar(Ge.x).addScaledVector(Me,-it.x).multiplyScalar(In),K[$n].add(bt),K[wi].add(bt),K[Nt].add(bt),de[$n].add(Ye),de[wi].add(Ye),de[Nt].add(Ye))}let Ft=this.groups;0===Ft.length&&(Ft=[{start:0,count:a.count}]);for(let $n=0,wi=Ft.length;$n<wi;++$n){const Nt=Ft[$n],In=Nt.start;for(let hr=In,ei=In+Nt.count;hr<ei;hr+=3)qe(a.getX(hr+0),a.getX(hr+1),a.getX(hr+2))}const mt=new Dn,Ut=new Dn,kn=new Dn,bn=new Dn;function wn($n){kn.fromBufferAttribute(p,$n),bn.copy(kn);const wi=K[$n];mt.copy(wi),mt.sub(kn.multiplyScalar(kn.dot(wi))).normalize(),Ut.crossVectors(bn,wi);const In=Ut.dot(de[$n])<0?-1:1;H.setXYZW($n,mt.x,mt.y,mt.z,In)}for(let $n=0,wi=Ft.length;$n<wi;++$n){const Nt=Ft[$n],In=Nt.start;for(let hr=In,ei=In+Nt.count;hr<ei;hr+=3)wn(a.getX(hr+0)),wn(a.getX(hr+1)),wn(a.getX(hr+2))}}computeVertexNormals(){const a=this.index,c=this.getAttribute("position");if(void 0!==c){let h=this.getAttribute("normal");if(void 0===h)h=new pl(new Float32Array(3*c.count),3),this.setAttribute("normal",h);else for(let Be=0,Ge=h.count;Be<Ge;Be++)h.setXYZ(Be,0,0,0);const p=new Dn,E=new Dn,H=new Dn,K=new Dn,de=new Dn,ge=new Dn,Me=new Dn,Le=new Dn;if(a)for(let Be=0,Ge=a.count;Be<Ge;Be+=3){const it=a.getX(Be+0),bt=a.getX(Be+1),Ye=a.getX(Be+2);p.fromBufferAttribute(c,it),E.fromBufferAttribute(c,bt),H.fromBufferAttribute(c,Ye),Me.subVectors(H,E),Le.subVectors(p,E),Me.cross(Le),K.fromBufferAttribute(h,it),de.fromBufferAttribute(h,bt),ge.fromBufferAttribute(h,Ye),K.add(Me),de.add(Me),ge.add(Me),h.setXYZ(it,K.x,K.y,K.z),h.setXYZ(bt,de.x,de.y,de.z),h.setXYZ(Ye,ge.x,ge.y,ge.z)}else for(let Be=0,Ge=c.count;Be<Ge;Be+=3)p.fromBufferAttribute(c,Be+0),E.fromBufferAttribute(c,Be+1),H.fromBufferAttribute(c,Be+2),Me.subVectors(H,E),Le.subVectors(p,E),Me.cross(Le),h.setXYZ(Be+0,Me.x,Me.y,Me.z),h.setXYZ(Be+1,Me.x,Me.y,Me.z),h.setXYZ(Be+2,Me.x,Me.y,Me.z);this.normalizeNormals(),h.needsUpdate=!0}}normalizeNormals(){const a=this.attributes.normal;for(let c=0,h=a.count;c<h;c++)Bl.fromBufferAttribute(a,c),Bl.normalize(),a.setXYZ(c,Bl.x,Bl.y,Bl.z)}toNonIndexed(){function a(K,de){const ge=K.array,Me=K.itemSize,Le=K.normalized,Be=new ge.constructor(de.length*Me);let Ge=0,it=0;for(let bt=0,Ye=de.length;bt<Ye;bt++){Ge=K.isInterleavedBufferAttribute?de[bt]*K.data.stride+K.offset:de[bt]*Me;for(let qe=0;qe<Me;qe++)Be[it++]=ge[Ge++]}return new pl(Be,Me,Le)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new us,h=this.index.array,p=this.attributes;for(const K in p){const ge=a(p[K],h);c.setAttribute(K,ge)}const E=this.morphAttributes;for(const K in E){const de=[],ge=E[K];for(let Me=0,Le=ge.length;Me<Le;Me++){const Ge=a(ge[Me],h);de.push(Ge)}c.morphAttributes[K]=de}c.morphTargetsRelative=this.morphTargetsRelative;const H=this.groups;for(let K=0,de=H.length;K<de;K++){const ge=H[K];c.addGroup(ge.start,ge.count,ge.materialIndex)}return c}toJSON(){const a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){const de=this.parameters;for(const ge in de)void 0!==de[ge]&&(a[ge]=de[ge]);return a}a.data={attributes:{}};const c=this.index;null!==c&&(a.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const h=this.attributes;for(const de in h)a.data.attributes[de]=h[de].toJSON(a.data);const p={};let E=!1;for(const de in this.morphAttributes){const ge=this.morphAttributes[de],Me=[];for(let Le=0,Be=ge.length;Le<Be;Le++)Me.push(ge[Le].toJSON(a.data));Me.length>0&&(p[de]=Me,E=!0)}E&&(a.data.morphAttributes=p,a.data.morphTargetsRelative=this.morphTargetsRelative);const H=this.groups;H.length>0&&(a.data.groups=JSON.parse(JSON.stringify(H)));const K=this.boundingSphere;return null!==K&&(a.data.boundingSphere={center:K.center.toArray(),radius:K.radius}),a}clone(){return(new this.constructor).copy(this)}copy(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=a.name;const h=a.index;null!==h&&this.setIndex(h.clone(c));const p=a.attributes;for(const ge in p)this.setAttribute(ge,p[ge].clone(c));const E=a.morphAttributes;for(const ge in E){const Me=[],Le=E[ge];for(let Be=0,Ge=Le.length;Be<Ge;Be++)Me.push(Le[Be].clone(c));this.morphAttributes[ge]=Me}this.morphTargetsRelative=a.morphTargetsRelative;const H=a.groups;for(let ge=0,Me=H.length;ge<Me;ge++){const Le=H[ge];this.addGroup(Le.start,Le.count,Le.materialIndex)}const K=a.boundingBox;null!==K&&(this.boundingBox=K.clone());const de=a.boundingSphere;return null!==de&&(this.boundingSphere=de.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Eh extends us{constructor(a=1,c=1,h=1,p=1,E=1,H=1){super(),this.type="BoxGeometry",this.parameters={width:a,height:c,depth:h,widthSegments:p,heightSegments:E,depthSegments:H};const K=this;p=Math.floor(p),E=Math.floor(E),H=Math.floor(H);const de=[],ge=[],Me=[],Le=[];let Be=0,Ge=0;function it(bt,Ye,qe,Ft,mt,Ut,kn,bn,wn,$n,wi){const Nt=Ut/wn,In=kn/$n,dr=Ut/2,hr=kn/2,ei=bn/2,Yi=wn+1,Pi=$n+1;let or=0,rr=0;const nr=new Dn;for(let Gr=0;Gr<Pi;Gr++){const zr=Gr*In-hr;for(let Ps=0;Ps<Yi;Ps++)nr[bt]=(Ps*Nt-dr)*Ft,nr[Ye]=zr*mt,nr[qe]=ei,ge.push(nr.x,nr.y,nr.z),nr[bt]=0,nr[Ye]=0,nr[qe]=bn>0?1:-1,Me.push(nr.x,nr.y,nr.z),Le.push(Ps/wn),Le.push(1-Gr/$n),or+=1}for(let Gr=0;Gr<$n;Gr++)for(let zr=0;zr<wn;zr++){const Jo=Be+zr+Yi*(Gr+1),Li=Be+(zr+1)+Yi*(Gr+1),Br=Be+(zr+1)+Yi*Gr;de.push(Be+zr+Yi*Gr,Jo,Br),de.push(Jo,Li,Br),rr+=6}K.addGroup(Ge,rr,wi),Ge+=rr,Be+=or}it("z","y","x",-1,-1,h,c,a,H,E,0),it("z","y","x",1,-1,h,c,-a,H,E,1),it("x","z","y",1,1,a,h,c,p,H,2),it("x","z","y",1,-1,a,h,-c,p,H,3),it("x","y","z",1,-1,a,c,h,p,E,4),it("x","y","z",-1,-1,a,c,-h,p,E,5),this.setIndex(de),this.setAttribute("position",new xo(ge,3)),this.setAttribute("normal",new xo(Me,3)),this.setAttribute("uv",new xo(Le,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Eh(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}class Th extends us{constructor(a=1,c=1,h=1,p=1){super(),this.type="PlaneGeometry",this.parameters={width:a,height:c,widthSegments:h,heightSegments:p};const E=a/2,H=c/2,K=Math.floor(h),de=Math.floor(p),ge=K+1,Me=de+1,Le=a/K,Be=c/de,Ge=[],it=[],bt=[],Ye=[];for(let qe=0;qe<Me;qe++){const Ft=qe*Be-H;for(let mt=0;mt<ge;mt++)it.push(mt*Le-E,-Ft,0),bt.push(0,0,1),Ye.push(mt/K),Ye.push(1-qe/de)}for(let qe=0;qe<de;qe++)for(let Ft=0;Ft<K;Ft++){const Ut=Ft+ge*(qe+1),kn=Ft+1+ge*(qe+1),bn=Ft+1+ge*qe;Ge.push(Ft+ge*qe,Ut,bn),Ge.push(Ut,kn,bn)}this.setIndex(Ge),this.setAttribute("position",new xo(it,3)),this.setAttribute("normal",new xo(bt,3)),this.setAttribute("uv",new xo(Ye,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Th(a.width,a.height,a.widthSegments,a.heightSegments)}}let rh=0;class Ic extends li{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:rh++}),this.uuid=Yl(),this.name="",this.type="Material",this.blending=1,this.side=O,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=D,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new to(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=wA,this.stencilZFail=wA,this.stencilZPass=wA,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(a){this._alphaTest>0!=a>0&&this.version++,this._alphaTest=a}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(void 0!==a)for(const c in a){const h=a[c];if(void 0===h){console.warn(`THREE.Material: parameter '${c}' has value of undefined.`);continue}const p=this[c];void 0!==p?p&&p.isColor?p.set(h):p&&p.isVector3&&h&&h.isVector3?p.copy(h):this[c]=h:console.warn(`THREE.Material: '${c}' is not a property of THREE.${this.type}.`)}}toJSON(a){const c=void 0===a||"string"==typeof a;c&&(a={textures:{},images:{}});const h={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function p(E){const H=[];for(const K in E){const de=E[K];delete de.metadata,H.push(de)}return H}if(h.uuid=this.uuid,h.type=this.type,""!==this.name&&(h.name=this.name),this.color&&this.color.isColor&&(h.color=this.color.getHex()),void 0!==this.roughness&&(h.roughness=this.roughness),void 0!==this.metalness&&(h.metalness=this.metalness),void 0!==this.sheen&&(h.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(h.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(h.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(h.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(h.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(h.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(h.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(h.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(h.shininess=this.shininess),void 0!==this.clearcoat&&(h.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(h.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(h.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(h.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(h.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,h.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(h.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(h.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(h.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(h.iridescenceMap=this.iridescenceMap.toJSON(a).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(h.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid),void 0!==this.anisotropy&&(h.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(h.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(h.anisotropyMap=this.anisotropyMap.toJSON(a).uuid),this.map&&this.map.isTexture&&(h.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(h.matcap=this.matcap.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(h.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(h.lightMap=this.lightMap.toJSON(a).uuid,h.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(h.aoMap=this.aoMap.toJSON(a).uuid,h.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(h.bumpMap=this.bumpMap.toJSON(a).uuid,h.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(h.normalMap=this.normalMap.toJSON(a).uuid,h.normalMapType=this.normalMapType,h.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(h.displacementMap=this.displacementMap.toJSON(a).uuid,h.displacementScale=this.displacementScale,h.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(h.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(h.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(h.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(h.specularMap=this.specularMap.toJSON(a).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(h.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(h.specularColorMap=this.specularColorMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(h.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(h.combine=this.combine)),void 0!==this.envMapRotation&&(h.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(h.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(h.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(h.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(h.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.transmission&&(h.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(h.transmissionMap=this.transmissionMap.toJSON(a).uuid),void 0!==this.thickness&&(h.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(h.thicknessMap=this.thicknessMap.toJSON(a).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(h.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(h.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(h.size=this.size),null!==this.shadowSide&&(h.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(h.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(h.blending=this.blending),this.side!==O&&(h.side=this.side),!0===this.vertexColors&&(h.vertexColors=!0),this.opacity<1&&(h.opacity=this.opacity),!0===this.transparent&&(h.transparent=!0),204!==this.blendSrc&&(h.blendSrc=this.blendSrc),205!==this.blendDst&&(h.blendDst=this.blendDst),this.blendEquation!==D&&(h.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(h.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(h.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(h.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(h.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(h.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(h.depthFunc=this.depthFunc),!1===this.depthTest&&(h.depthTest=this.depthTest),!1===this.depthWrite&&(h.depthWrite=this.depthWrite),!1===this.colorWrite&&(h.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(h.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(h.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(h.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(h.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==wA&&(h.stencilFail=this.stencilFail),this.stencilZFail!==wA&&(h.stencilZFail=this.stencilZFail),this.stencilZPass!==wA&&(h.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(h.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(h.rotation=this.rotation),!0===this.polygonOffset&&(h.polygonOffset=!0),0!==this.polygonOffsetFactor&&(h.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(h.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(h.linewidth=this.linewidth),void 0!==this.dashSize&&(h.dashSize=this.dashSize),void 0!==this.gapSize&&(h.gapSize=this.gapSize),void 0!==this.scale&&(h.scale=this.scale),!0===this.dithering&&(h.dithering=!0),this.alphaTest>0&&(h.alphaTest=this.alphaTest),!0===this.alphaHash&&(h.alphaHash=!0),!0===this.alphaToCoverage&&(h.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(h.premultipliedAlpha=!0),!0===this.forceSinglePass&&(h.forceSinglePass=!0),!0===this.wireframe&&(h.wireframe=!0),this.wireframeLinewidth>1&&(h.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(h.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(h.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(h.flatShading=!0),!1===this.visible&&(h.visible=!1),!1===this.toneMapped&&(h.toneMapped=!1),!1===this.fog&&(h.fog=!1),Object.keys(this.userData).length>0&&(h.userData=this.userData),c){const E=p(a.textures),H=p(a.images);E.length>0&&(h.textures=E),H.length>0&&(h.images=H)}return h}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name,this.blending=a.blending,this.side=a.side,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.blendColor.copy(a.blendColor),this.blendAlpha=a.blendAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite;const c=a.clippingPlanes;let h=null;if(null!==c){const p=c.length;h=new Array(p);for(let E=0;E!==p;++E)h[E]=c[E].clone()}return this.clippingPlanes=h,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.alphaHash=a.alphaHash,this.alphaToCoverage=a.alphaToCoverage,this.premultipliedAlpha=a.premultipliedAlpha,this.forceSinglePass=a.forceSinglePass,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){!0===a&&this.version++}}function Xr(M){const a={};for(const c in M){a[c]={};for(const h in M[c]){const p=M[c][h];p&&(p.isColor||p.isMatrix3||p.isMatrix4||p.isVector2||p.isVector3||p.isVector4||p.isTexture||p.isQuaternion)?p.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),a[c][h]=null):a[c][h]=p.clone():a[c][h]=Array.isArray(p)?p.slice():p}}return a}function Ea(M){const a={};for(let c=0;c<M.length;c++){const h=Xr(M[c]);for(const p in h)a[p]=h[p]}return a}function Bc(M){return null===M.getRenderTarget()?M.outputColorSpace:va.workingColorSpace}const Al={clone:Xr,merge:Ea};class Pc extends Ic{constructor(a){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==a&&this.setValues(a)}copy(a){return super.copy(a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=Xr(a.uniforms),this.uniformsGroups=function J0(M){const a=[];for(let c=0;c<M.length;c++)a.push(M[c].clone());return a}(a.uniformsGroups),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.fog=a.fog,this.lights=a.lights,this.clipping=a.clipping,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this}toJSON(a){const c=super.toJSON(a);c.glslVersion=this.glslVersion,c.uniforms={};for(const p in this.uniforms){const H=this.uniforms[p].value;c.uniforms[p]=H&&H.isTexture?{type:"t",value:H.toJSON(a).uuid}:H&&H.isColor?{type:"c",value:H.getHex()}:H&&H.isVector2?{type:"v2",value:H.toArray()}:H&&H.isVector3?{type:"v3",value:H.toArray()}:H&&H.isVector4?{type:"v4",value:H.toArray()}:H&&H.isMatrix3?{type:"m3",value:H.toArray()}:H&&H.isMatrix4?{type:"m4",value:H.toArray()}:{value:H}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader,c.lights=this.lights,c.clipping=this.clipping;const h={};for(const p in this.extensions)!0===this.extensions[p]&&(h[p]=!0);return Object.keys(h).length>0&&(c.extensions=h),c}}const ql=new Dn,Gp=new Dn,RA=new Dn,df=new Dn,sh=new Dn,qp=new Dn,Qp=new Dn;class uf{constructor(a=new Dn,c=new Dn(0,0,-1)){this.origin=a,this.direction=c}set(a,c){return this.origin.copy(a),this.direction.copy(c),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,c){return c.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){return this.direction.copy(a).sub(this.origin).normalize(),this}recast(a){return this.origin.copy(this.at(a,ql)),this}closestPointToPoint(a,c){c.subVectors(a,this.origin);const h=c.dot(this.direction);return h<0?c.copy(this.origin):c.copy(this.origin).addScaledVector(this.direction,h)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){const c=ql.subVectors(a,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(a):(ql.copy(this.origin).addScaledVector(this.direction,c),ql.distanceToSquared(a))}distanceSqToSegment(a,c,h,p){Gp.copy(a).add(c).multiplyScalar(.5),RA.copy(c).sub(a).normalize(),df.copy(this.origin).sub(Gp);const E=.5*a.distanceTo(c),H=-this.direction.dot(RA),K=df.dot(this.direction),de=-df.dot(RA),ge=df.lengthSq(),Me=Math.abs(1-H*H);let Le,Be,Ge,it;if(Me>0)if(Le=H*de-K,Be=H*K-de,it=E*Me,Le>=0)if(Be>=-it)if(Be<=it){const bt=1/Me;Le*=bt,Be*=bt,Ge=Le*(Le+H*Be+2*K)+Be*(H*Le+Be+2*de)+ge}else Be=E,Le=Math.max(0,-(H*Be+K)),Ge=-Le*Le+Be*(Be+2*de)+ge;else Be=-E,Le=Math.max(0,-(H*Be+K)),Ge=-Le*Le+Be*(Be+2*de)+ge;else Be<=-it?(Le=Math.max(0,-(-H*E+K)),Be=Le>0?-E:Math.min(Math.max(-E,-de),E),Ge=-Le*Le+Be*(Be+2*de)+ge):Be<=it?(Le=0,Be=Math.min(Math.max(-E,-de),E),Ge=Be*(Be+2*de)+ge):(Le=Math.max(0,-(H*E+K)),Be=Le>0?E:Math.min(Math.max(-E,-de),E),Ge=-Le*Le+Be*(Be+2*de)+ge);else Be=H>0?-E:E,Le=Math.max(0,-(H*Be+K)),Ge=-Le*Le+Be*(Be+2*de)+ge;return h&&h.copy(this.origin).addScaledVector(this.direction,Le),p&&p.copy(Gp).addScaledVector(RA,Be),Ge}intersectSphere(a,c){ql.subVectors(a.center,this.origin);const h=ql.dot(this.direction),p=ql.dot(ql)-h*h,E=a.radius*a.radius;if(p>E)return null;const H=Math.sqrt(E-p),K=h-H,de=h+H;return de<0?null:this.at(K<0?de:K,c)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){const c=a.normal.dot(this.direction);if(0===c)return 0===a.distanceToPoint(this.origin)?0:null;const h=-(this.origin.dot(a.normal)+a.constant)/c;return h>=0?h:null}intersectPlane(a,c){const h=this.distanceToPlane(a);return null===h?null:this.at(h,c)}intersectsPlane(a){const c=a.distanceToPoint(this.origin);return 0===c||a.normal.dot(this.direction)*c<0}intersectBox(a,c){let h,p,E,H,K,de;const ge=1/this.direction.x,Me=1/this.direction.y,Le=1/this.direction.z,Be=this.origin;return ge>=0?(h=(a.min.x-Be.x)*ge,p=(a.max.x-Be.x)*ge):(h=(a.max.x-Be.x)*ge,p=(a.min.x-Be.x)*ge),Me>=0?(E=(a.min.y-Be.y)*Me,H=(a.max.y-Be.y)*Me):(E=(a.max.y-Be.y)*Me,H=(a.min.y-Be.y)*Me),h>H||E>p||((E>h||isNaN(h))&&(h=E),(H<p||isNaN(p))&&(p=H),Le>=0?(K=(a.min.z-Be.z)*Le,de=(a.max.z-Be.z)*Le):(K=(a.max.z-Be.z)*Le,de=(a.min.z-Be.z)*Le),h>de||K>p)||((K>h||h!=h)&&(h=K),(de<p||p!=p)&&(p=de),p<0)?null:this.at(h>=0?h:p,c)}intersectsBox(a){return null!==this.intersectBox(a,ql)}intersectTriangle(a,c,h,p,E){sh.subVectors(c,a),qp.subVectors(h,a),Qp.crossVectors(sh,qp);let K,H=this.direction.dot(Qp);if(H>0){if(p)return null;K=1}else{if(!(H<0))return null;K=-1,H=-H}df.subVectors(this.origin,a);const de=K*this.direction.dot(qp.crossVectors(df,qp));if(de<0)return null;const ge=K*this.direction.dot(sh.cross(df));if(ge<0||de+ge>H)return null;const Me=-K*df.dot(Qp);return Me<0?null:this.at(Me/H,E)}applyMatrix4(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}const Dh=new Dn,hf=new Dn,Ng=new Dn,ep=new Dn,kA=new Dn,FA=new Dn,pv=new Dn,Ug=new Dn,zg=new Dn,gc=new Dn;class Xd{constructor(a=new Dn,c=new Dn,h=new Dn){this.a=a,this.b=c,this.c=h}static getNormal(a,c,h,p){p.subVectors(h,c),Dh.subVectors(a,c),p.cross(Dh);const E=p.lengthSq();return E>0?p.multiplyScalar(1/Math.sqrt(E)):p.set(0,0,0)}static getBarycoord(a,c,h,p,E){Dh.subVectors(p,c),hf.subVectors(h,c),Ng.subVectors(a,c);const H=Dh.dot(Dh),K=Dh.dot(hf),de=Dh.dot(Ng),ge=hf.dot(hf),Me=hf.dot(Ng),Le=H*ge-K*K;if(0===Le)return E.set(0,0,0),null;const Be=1/Le,Ge=(ge*de-K*Me)*Be,it=(H*Me-K*de)*Be;return E.set(1-Ge-it,it,Ge)}static containsPoint(a,c,h,p){return null!==this.getBarycoord(a,c,h,p,ep)&&ep.x>=0&&ep.y>=0&&ep.x+ep.y<=1}static getInterpolation(a,c,h,p,E,H,K,de){return null===this.getBarycoord(a,c,h,p,ep)?(de.x=0,de.y=0,"z"in de&&(de.z=0),"w"in de&&(de.w=0),null):(de.setScalar(0),de.addScaledVector(E,ep.x),de.addScaledVector(H,ep.y),de.addScaledVector(K,ep.z),de)}static isFrontFacing(a,c,h,p){return Dh.subVectors(h,c),hf.subVectors(a,c),Dh.cross(hf).dot(p)<0}set(a,c,h){return this.a.copy(a),this.b.copy(c),this.c.copy(h),this}setFromPointsAndIndices(a,c,h,p){return this.a.copy(a[c]),this.b.copy(a[h]),this.c.copy(a[p]),this}setFromAttributeAndIndices(a,c,h,p){return this.a.fromBufferAttribute(a,c),this.b.fromBufferAttribute(a,h),this.c.fromBufferAttribute(a,p),this}clone(){return(new this.constructor).copy(this)}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}getArea(){return Dh.subVectors(this.c,this.b),hf.subVectors(this.a,this.b),.5*Dh.cross(hf).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return Xd.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,c){return Xd.getBarycoord(a,this.a,this.b,this.c,c)}getInterpolation(a,c,h,p,E){return Xd.getInterpolation(a,this.a,this.b,this.c,c,h,p,E)}containsPoint(a){return Xd.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return Xd.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,c){const h=this.a,p=this.b,E=this.c;let H,K;kA.subVectors(p,h),FA.subVectors(E,h),Ug.subVectors(a,h);const de=kA.dot(Ug),ge=FA.dot(Ug);if(de<=0&&ge<=0)return c.copy(h);zg.subVectors(a,p);const Me=kA.dot(zg),Le=FA.dot(zg);if(Me>=0&&Le<=Me)return c.copy(p);const Be=de*Le-Me*ge;if(Be<=0&&de>=0&&Me<=0)return H=de/(de-Me),c.copy(h).addScaledVector(kA,H);gc.subVectors(a,E);const Ge=kA.dot(gc),it=FA.dot(gc);if(it>=0&&Ge<=it)return c.copy(E);const bt=Ge*ge-de*it;if(bt<=0&&ge>=0&&it<=0)return K=ge/(ge-it),c.copy(h).addScaledVector(FA,K);const Ye=Me*it-Ge*Le;if(Ye<=0&&Le-Me>=0&&Ge-it>=0)return pv.subVectors(E,p),K=(Le-Me)/(Le-Me+(Ge-it)),c.copy(p).addScaledVector(pv,K);const qe=1/(Ye+bt+Be);return H=bt*qe,K=Be*qe,c.copy(h).addScaledVector(kA,H).addScaledVector(FA,K)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}class gu extends Ic{constructor(a){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new to(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ec,this.combine=Ue,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}const Yd=new lo,fd=new uf,oh=new sc,Hg=new Dn,km=new Dn,Ih=new Dn,Fu=new Dn,tp=new Dn,Pl=new Dn,np=new Si,Wp=new Si,ip=new Si,jp=new Dn,Fm=new Dn,Bh=new Dn,Ph=new Dn,rp=new Dn;class gl extends Nl{constructor(a=new us,c=new gu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=a,this.material=c,this.updateMorphTargets()}copy(a,c){return super.copy(a,c),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}updateMorphTargets(){const c=this.geometry.morphAttributes,h=Object.keys(c);if(h.length>0){const p=c[h[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,H=p.length;E<H;E++){const K=p[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[K]=E}}}}getVertexPosition(a,c){const h=this.geometry,E=h.morphAttributes.position,H=h.morphTargetsRelative;c.fromBufferAttribute(h.attributes.position,a);const K=this.morphTargetInfluences;if(E&&K){Pl.set(0,0,0);for(let de=0,ge=E.length;de<ge;de++){const Me=K[de];0!==Me&&(tp.fromBufferAttribute(E[de],a),Pl.addScaledVector(H?tp:tp.sub(c),Me))}c.add(Pl)}return c}raycast(a,c){const h=this.geometry,E=this.matrixWorld;void 0!==this.material&&(null===h.boundingSphere&&h.computeBoundingSphere(),oh.copy(h.boundingSphere),oh.applyMatrix4(E),fd.copy(a.ray).recast(a.near),(!1!==oh.containsPoint(fd.origin)||!(null===fd.intersectSphere(oh,Hg)||fd.origin.distanceToSquared(Hg)>(a.far-a.near)**2))&&(Yd.copy(E).invert(),fd.copy(a.ray).applyMatrix4(Yd),(null===h.boundingBox||!1!==fd.intersectsBox(h.boundingBox))&&this._computeIntersections(a,c,fd)))}_computeIntersections(a,c,h){let p;const E=this.geometry,H=this.material,K=E.index,de=E.attributes.position,ge=E.attributes.uv,Me=E.attributes.uv1,Le=E.attributes.normal,Be=E.groups,Ge=E.drawRange;if(null!==K)if(Array.isArray(H))for(let it=0,bt=Be.length;it<bt;it++){const Ye=Be[it],qe=H[Ye.materialIndex];for(let Ut=Math.max(Ye.start,Ge.start),kn=Math.min(K.count,Math.min(Ye.start+Ye.count,Ge.start+Ge.count));Ut<kn;Ut+=3)p=Ou(this,qe,a,h,ge,Me,Le,K.getX(Ut),K.getX(Ut+1),K.getX(Ut+2)),p&&(p.faceIndex=Math.floor(Ut/3),p.face.materialIndex=Ye.materialIndex,c.push(p))}else for(let Ye=Math.max(0,Ge.start),qe=Math.min(K.count,Ge.start+Ge.count);Ye<qe;Ye+=3)p=Ou(this,H,a,h,ge,Me,Le,K.getX(Ye),K.getX(Ye+1),K.getX(Ye+2)),p&&(p.faceIndex=Math.floor(Ye/3),c.push(p));else if(void 0!==de)if(Array.isArray(H))for(let it=0,bt=Be.length;it<bt;it++){const Ye=Be[it],qe=H[Ye.materialIndex];for(let Ut=Math.max(Ye.start,Ge.start),kn=Math.min(de.count,Math.min(Ye.start+Ye.count,Ge.start+Ge.count));Ut<kn;Ut+=3)p=Ou(this,qe,a,h,ge,Me,Le,Ut,Ut+1,Ut+2),p&&(p.faceIndex=Math.floor(Ut/3),p.face.materialIndex=Ye.materialIndex,c.push(p))}else for(let Ye=Math.max(0,Ge.start),qe=Math.min(de.count,Ge.start+Ge.count);Ye<qe;Ye+=3)p=Ou(this,H,a,h,ge,Me,Le,Ye,Ye+1,Ye+2),p&&(p.faceIndex=Math.floor(Ye/3),c.push(p))}}function Ou(M,a,c,h,p,E,H,K,de,ge){M.getVertexPosition(K,km),M.getVertexPosition(de,Ih),M.getVertexPosition(ge,Fu);const Me=function e_(M,a,c,h,p,E,H,K){let de;if(de=1===a.side?h.intersectTriangle(H,E,p,!0,K):h.intersectTriangle(p,E,H,a.side===O,K),null===de)return null;rp.copy(K),rp.applyMatrix4(M.matrixWorld);const ge=c.ray.origin.distanceTo(rp);return ge<c.near||ge>c.far?null:{distance:ge,point:rp.clone(),object:M}}(M,a,c,h,km,Ih,Fu,Ph);if(Me){p&&(np.fromBufferAttribute(p,K),Wp.fromBufferAttribute(p,de),ip.fromBufferAttribute(p,ge),Me.uv=Xd.getInterpolation(Ph,km,Ih,Fu,np,Wp,ip,new Si)),E&&(np.fromBufferAttribute(E,K),Wp.fromBufferAttribute(E,de),ip.fromBufferAttribute(E,ge),Me.uv1=Xd.getInterpolation(Ph,km,Ih,Fu,np,Wp,ip,new Si)),H&&(jp.fromBufferAttribute(H,K),Fm.fromBufferAttribute(H,de),Bh.fromBufferAttribute(H,ge),Me.normal=Xd.getInterpolation(Ph,km,Ih,Fu,jp,Fm,Bh,new Dn),Me.normal.dot(h.direction)>0&&Me.normal.multiplyScalar(-1));const Le={a:K,b:de,c:ge,normal:new Dn,materialIndex:0};Xd.getNormal(km,Ih,Fu,Le.normal),Me.face=Le}return Me}const $o={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tfloat startCompression = 0.8 - 0.04;\n\tfloat desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min(color.r, min(color.g, color.b));\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max(color.r, max(color.g, color.b));\n\tif (peak < startCompression) return color;\n\tfloat d = 1. - startCompression;\n\tfloat newPeak = 1. - d * d / (peak + d - startCompression);\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);\n\treturn mix(color, vec3(1, 1, 1), g);\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},qr={common:{diffuse:{value:new to(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new vo},alphaMap:{value:null},alphaMapTransform:{value:new vo},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new vo}},envmap:{envMap:{value:null},envMapRotation:{value:new vo},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new vo}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new vo}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new vo},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new vo},normalScale:{value:new Si(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new vo},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new vo}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new vo}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new vo}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new to(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new to(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new vo},alphaTest:{value:0},uvTransform:{value:new vo}},sprite:{diffuse:{value:new to(16777215)},opacity:{value:1},center:{value:new Si(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new vo},alphaMap:{value:null},alphaMapTransform:{value:new vo},alphaTest:{value:0}}},fh={basic:{uniforms:Ea([qr.common,qr.specularmap,qr.envmap,qr.aomap,qr.lightmap,qr.fog]),vertexShader:$o.meshbasic_vert,fragmentShader:$o.meshbasic_frag},lambert:{uniforms:Ea([qr.common,qr.specularmap,qr.envmap,qr.aomap,qr.lightmap,qr.emissivemap,qr.bumpmap,qr.normalmap,qr.displacementmap,qr.fog,qr.lights,{emissive:{value:new to(0)}}]),vertexShader:$o.meshlambert_vert,fragmentShader:$o.meshlambert_frag},phong:{uniforms:Ea([qr.common,qr.specularmap,qr.envmap,qr.aomap,qr.lightmap,qr.emissivemap,qr.bumpmap,qr.normalmap,qr.displacementmap,qr.fog,qr.lights,{emissive:{value:new to(0)},specular:{value:new to(1118481)},shininess:{value:30}}]),vertexShader:$o.meshphong_vert,fragmentShader:$o.meshphong_frag},standard:{uniforms:Ea([qr.common,qr.envmap,qr.aomap,qr.lightmap,qr.emissivemap,qr.bumpmap,qr.normalmap,qr.displacementmap,qr.roughnessmap,qr.metalnessmap,qr.fog,qr.lights,{emissive:{value:new to(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$o.meshphysical_vert,fragmentShader:$o.meshphysical_frag},toon:{uniforms:Ea([qr.common,qr.aomap,qr.lightmap,qr.emissivemap,qr.bumpmap,qr.normalmap,qr.displacementmap,qr.gradientmap,qr.fog,qr.lights,{emissive:{value:new to(0)}}]),vertexShader:$o.meshtoon_vert,fragmentShader:$o.meshtoon_frag},matcap:{uniforms:Ea([qr.common,qr.bumpmap,qr.normalmap,qr.displacementmap,qr.fog,{matcap:{value:null}}]),vertexShader:$o.meshmatcap_vert,fragmentShader:$o.meshmatcap_frag},points:{uniforms:Ea([qr.points,qr.fog]),vertexShader:$o.points_vert,fragmentShader:$o.points_frag},dashed:{uniforms:Ea([qr.common,qr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$o.linedashed_vert,fragmentShader:$o.linedashed_frag},depth:{uniforms:Ea([qr.common,qr.displacementmap]),vertexShader:$o.depth_vert,fragmentShader:$o.depth_frag},normal:{uniforms:Ea([qr.common,qr.bumpmap,qr.normalmap,qr.displacementmap,{opacity:{value:1}}]),vertexShader:$o.meshnormal_vert,fragmentShader:$o.meshnormal_frag},sprite:{uniforms:Ea([qr.sprite,qr.fog]),vertexShader:$o.sprite_vert,fragmentShader:$o.sprite_frag},background:{uniforms:{uvTransform:{value:new vo},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:$o.background_vert,fragmentShader:$o.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new vo}},vertexShader:$o.backgroundCube_vert,fragmentShader:$o.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:$o.cube_vert,fragmentShader:$o.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$o.equirect_vert,fragmentShader:$o.equirect_frag},distanceRGBA:{uniforms:Ea([qr.common,qr.displacementmap,{referencePosition:{value:new Dn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$o.distanceRGBA_vert,fragmentShader:$o.distanceRGBA_frag},shadow:{uniforms:Ea([qr.lights,qr.fog,{color:{value:new to(0)},opacity:{value:1}}]),vertexShader:$o.shadow_vert,fragmentShader:$o.shadow_frag}};fh.physical={uniforms:Ea([fh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new vo},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new vo},clearcoatNormalScale:{value:new Si(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new vo},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new vo},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new vo},sheen:{value:0},sheenColor:{value:new to(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new vo},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new vo},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new vo},transmissionSamplerSize:{value:new Si},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new vo},attenuationDistance:{value:0},attenuationColor:{value:new to(0)},specularColor:{value:new to(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new vo},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new vo},anisotropyVector:{value:new Si},anisotropyMap:{value:null},anisotropyMapTransform:{value:new vo}}]),vertexShader:$o.meshphysical_vert,fragmentShader:$o.meshphysical_frag};const QA={r:0,b:0,g:0},dp=new Ec,WA=new lo;function Cv(M,a,c,h,p,E,H){const K=new to(0);let ge,Me,de=!0===E?0:1,Le=null,Be=0,Ge=null;function bt(Ye,qe){Ye.getRGB(QA,Bc(M)),h.buffers.color.setClear(QA.r,QA.g,QA.b,qe,H)}return{getClearColor:function(){return K},setClearColor:function(Ye,qe=1){K.set(Ye),de=qe,bt(K,de)},getClearAlpha:function(){return de},setClearAlpha:function(Ye){de=Ye,bt(K,de)},render:function it(Ye,qe){let Ft=!1,mt=!0===qe.isScene?qe.background:null;mt&&mt.isTexture&&(mt=(qe.backgroundBlurriness>0?c:a).get(mt)),null===mt?bt(K,de):mt&&mt.isColor&&(bt(mt,1),Ft=!0);const Ut=M.xr.getEnvironmentBlendMode();"additive"===Ut?h.buffers.color.setClear(0,0,0,1,H):"alpha-blend"===Ut&&h.buffers.color.setClear(0,0,0,0,H),(M.autoClear||Ft)&&M.clear(M.autoClearColor,M.autoClearDepth,M.autoClearStencil),mt&&(mt.isCubeTexture||mt.mapping===Hn)?(void 0===Me&&(Me=new gl(new Eh(1,1,1),new Pc({name:"BackgroundCubeMaterial",uniforms:Xr(fh.backgroundCube.uniforms),vertexShader:fh.backgroundCube.vertexShader,fragmentShader:fh.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),Me.geometry.deleteAttribute("normal"),Me.geometry.deleteAttribute("uv"),Me.onBeforeRender=function(kn,bn,wn){this.matrixWorld.copyPosition(wn.matrixWorld)},Object.defineProperty(Me.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),p.update(Me)),dp.copy(qe.backgroundRotation),dp.x*=-1,dp.y*=-1,dp.z*=-1,mt.isCubeTexture&&!1===mt.isRenderTargetTexture&&(dp.y*=-1,dp.z*=-1),Me.material.uniforms.envMap.value=mt,Me.material.uniforms.flipEnvMap.value=mt.isCubeTexture&&!1===mt.isRenderTargetTexture?-1:1,Me.material.uniforms.backgroundBlurriness.value=qe.backgroundBlurriness,Me.material.uniforms.backgroundIntensity.value=qe.backgroundIntensity,Me.material.uniforms.backgroundRotation.value.setFromMatrix4(WA.makeRotationFromEuler(dp)),Me.material.toneMapped=va.getTransfer(mt.colorSpace)!==Ra,(Le!==mt||Be!==mt.version||Ge!==M.toneMapping)&&(Me.material.needsUpdate=!0,Le=mt,Be=mt.version,Ge=M.toneMapping),Me.layers.enableAll(),Ye.unshift(Me,Me.geometry,Me.material,0,0,null)):mt&&mt.isTexture&&(void 0===ge&&(ge=new gl(new Th(2,2),new Pc({name:"BackgroundMaterial",uniforms:Xr(fh.background.uniforms),vertexShader:fh.background.vertexShader,fragmentShader:fh.background.fragmentShader,side:O,depthTest:!1,depthWrite:!1,fog:!1})),ge.geometry.deleteAttribute("normal"),Object.defineProperty(ge.material,"map",{get:function(){return this.uniforms.t2D.value}}),p.update(ge)),ge.material.uniforms.t2D.value=mt,ge.material.uniforms.backgroundIntensity.value=qe.backgroundIntensity,ge.material.toneMapped=va.getTransfer(mt.colorSpace)!==Ra,!0===mt.matrixAutoUpdate&&mt.updateMatrix(),ge.material.uniforms.uvTransform.value.copy(mt.matrix),(Le!==mt||Be!==mt.version||Ge!==M.toneMapping)&&(ge.material.needsUpdate=!0,Le=mt,Be=mt.version,Ge=M.toneMapping),ge.layers.enableAll(),Ye.unshift(ge,ge.geometry,ge.material,0,0,null))}}}function Qm(M,a,c,h){const p=M.getParameter(M.MAX_VERTEX_ATTRIBS),E=h.isWebGL2?null:a.get("OES_vertex_array_object"),H=h.isWebGL2||null!==E,K={},de=Ye(null);let ge=de,Me=!1;function Ge(ei){return h.isWebGL2?M.bindVertexArray(ei):E.bindVertexArrayOES(ei)}function it(ei){return h.isWebGL2?M.deleteVertexArray(ei):E.deleteVertexArrayOES(ei)}function Ye(ei){const Yi=[],Pi=[],or=[];for(let rr=0;rr<p;rr++)Yi[rr]=0,Pi[rr]=0,or[rr]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Yi,enabledAttributes:Pi,attributeDivisors:or,object:ei,attributes:{},index:null}}function mt(){const ei=ge.newAttributes;for(let Yi=0,Pi=ei.length;Yi<Pi;Yi++)ei[Yi]=0}function Ut(ei){kn(ei,0)}function kn(ei,Yi){const or=ge.enabledAttributes,rr=ge.attributeDivisors;ge.newAttributes[ei]=1,0===or[ei]&&(M.enableVertexAttribArray(ei),or[ei]=1),rr[ei]!==Yi&&((h.isWebGL2?M:a.get("ANGLE_instanced_arrays"))[h.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ei,Yi),rr[ei]=Yi)}function bn(){const ei=ge.newAttributes,Yi=ge.enabledAttributes;for(let Pi=0,or=Yi.length;Pi<or;Pi++)Yi[Pi]!==ei[Pi]&&(M.disableVertexAttribArray(Pi),Yi[Pi]=0)}function wn(ei,Yi,Pi,or,rr,nr,Gr){!0===Gr?M.vertexAttribIPointer(ei,Yi,Pi,rr,nr):M.vertexAttribPointer(ei,Yi,Pi,or,rr,nr)}function dr(){hr(),Me=!0,ge!==de&&(ge=de,Ge(ge.object))}function hr(){de.geometry=null,de.program=null,de.wireframe=!1}return{setup:function Le(ei,Yi,Pi,or,rr){let nr=!1;if(H){const Gr=function bt(ei,Yi,Pi){const or=!0===Pi.wireframe;let rr=K[ei.id];void 0===rr&&(rr={},K[ei.id]=rr);let nr=rr[Yi.id];void 0===nr&&(nr={},rr[Yi.id]=nr);let Gr=nr[or];return void 0===Gr&&(Gr=Ye(function Be(){return h.isWebGL2?M.createVertexArray():E.createVertexArrayOES()}()),nr[or]=Gr),Gr}(or,Pi,Yi);ge!==Gr&&(ge=Gr,Ge(ge.object)),nr=function qe(ei,Yi,Pi,or){const rr=ge.attributes,nr=Yi.attributes;let Gr=0;const zr=Pi.getAttributes();for(const Ps in zr)if(zr[Ps].location>=0){const Li=rr[Ps];let Br=nr[Ps];if(void 0===Br&&("instanceMatrix"===Ps&&ei.instanceMatrix&&(Br=ei.instanceMatrix),"instanceColor"===Ps&&ei.instanceColor&&(Br=ei.instanceColor)),void 0===Li||Li.attribute!==Br||Br&&Li.data!==Br.data)return!0;Gr++}return ge.attributesNum!==Gr||ge.index!==or}(ei,or,Pi,rr),nr&&function Ft(ei,Yi,Pi,or){const rr={},nr=Yi.attributes;let Gr=0;const zr=Pi.getAttributes();for(const Ps in zr)if(zr[Ps].location>=0){let Li=nr[Ps];void 0===Li&&("instanceMatrix"===Ps&&ei.instanceMatrix&&(Li=ei.instanceMatrix),"instanceColor"===Ps&&ei.instanceColor&&(Li=ei.instanceColor));const Br={};Br.attribute=Li,Li&&Li.data&&(Br.data=Li.data),rr[Ps]=Br,Gr++}ge.attributes=rr,ge.attributesNum=Gr,ge.index=or}(ei,or,Pi,rr)}else{const Gr=!0===Yi.wireframe;(ge.geometry!==or.id||ge.program!==Pi.id||ge.wireframe!==Gr)&&(ge.geometry=or.id,ge.program=Pi.id,ge.wireframe=Gr,nr=!0)}null!==rr&&c.update(rr,M.ELEMENT_ARRAY_BUFFER),(nr||Me)&&(Me=!1,function $n(ei,Yi,Pi,or){if(!1===h.isWebGL2&&(ei.isInstancedMesh||or.isInstancedBufferGeometry)&&null===a.get("ANGLE_instanced_arrays"))return;mt();const rr=or.attributes,nr=Pi.getAttributes(),Gr=Yi.defaultAttributeValues;for(const zr in nr){const Ps=nr[zr];if(Ps.location>=0){let Jo=rr[zr];if(void 0===Jo&&("instanceMatrix"===zr&&ei.instanceMatrix&&(Jo=ei.instanceMatrix),"instanceColor"===zr&&ei.instanceColor&&(Jo=ei.instanceColor)),void 0!==Jo){const Li=Jo.normalized,Br=Jo.itemSize,Rs=c.get(Jo);if(void 0===Rs)continue;const co=Rs.buffer,no=Rs.type,$s=Rs.bytesPerElement,_a=!0===h.isWebGL2&&(no===M.INT||no===M.UNSIGNED_INT||1013===Jo.gpuType);if(Jo.isInterleavedBufferAttribute){const uo=Jo.data,Nn=uo.stride,Jr=Jo.offset;if(uo.isInstancedInterleavedBuffer){for(let lr=0;lr<Ps.locationSize;lr++)kn(Ps.location+lr,uo.meshPerAttribute);!0!==ei.isInstancedMesh&&void 0===or._maxInstanceCount&&(or._maxInstanceCount=uo.meshPerAttribute*uo.count)}else for(let lr=0;lr<Ps.locationSize;lr++)Ut(Ps.location+lr);M.bindBuffer(M.ARRAY_BUFFER,co);for(let lr=0;lr<Ps.locationSize;lr++)wn(Ps.location+lr,Br/Ps.locationSize,no,Li,Nn*$s,(Jr+Br/Ps.locationSize*lr)*$s,_a)}else{if(Jo.isInstancedBufferAttribute){for(let uo=0;uo<Ps.locationSize;uo++)kn(Ps.location+uo,Jo.meshPerAttribute);!0!==ei.isInstancedMesh&&void 0===or._maxInstanceCount&&(or._maxInstanceCount=Jo.meshPerAttribute*Jo.count)}else for(let uo=0;uo<Ps.locationSize;uo++)Ut(Ps.location+uo);M.bindBuffer(M.ARRAY_BUFFER,co);for(let uo=0;uo<Ps.locationSize;uo++)wn(Ps.location+uo,Br/Ps.locationSize,no,Li,Br*$s,Br/Ps.locationSize*uo*$s,_a)}}else if(void 0!==Gr){const Li=Gr[zr];if(void 0!==Li)switch(Li.length){case 2:M.vertexAttrib2fv(Ps.location,Li);break;case 3:M.vertexAttrib3fv(Ps.location,Li);break;case 4:M.vertexAttrib4fv(Ps.location,Li);break;default:M.vertexAttrib1fv(Ps.location,Li)}}}}bn()}(ei,Yi,Pi,or),null!==rr&&M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,c.get(rr).buffer))},reset:dr,resetDefaultState:hr,dispose:function wi(){dr();for(const ei in K){const Yi=K[ei];for(const Pi in Yi){const or=Yi[Pi];for(const rr in or)it(or[rr].object),delete or[rr];delete Yi[Pi]}delete K[ei]}},releaseStatesOfGeometry:function Nt(ei){if(void 0===K[ei.id])return;const Yi=K[ei.id];for(const Pi in Yi){const or=Yi[Pi];for(const rr in or)it(or[rr].object),delete or[rr];delete Yi[Pi]}delete K[ei.id]},releaseStatesOfProgram:function In(ei){for(const Yi in K){const Pi=K[Yi];if(void 0===Pi[ei.id])continue;const or=Pi[ei.id];for(const rr in or)it(or[rr].object),delete or[rr];delete Pi[ei.id]}},initAttributes:mt,enableAttribute:Ut,disableUnusedAttributes:bn}}function em(M,a,c,h){const p=h.isWebGL2;let E;this.setMode=function H(Me){E=Me},this.render=function K(Me,Le){M.drawArrays(E,Me,Le),c.update(Le,E,1)},this.renderInstances=function de(Me,Le,Be){if(0===Be)return;let Ge,it;if(p)Ge=M,it="drawArraysInstanced";else if(Ge=a.get("ANGLE_instanced_arrays"),it="drawArraysInstancedANGLE",null===Ge)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Ge[it](E,Me,Le,Be),c.update(Le,E,Be)},this.renderMultiDraw=function ge(Me,Le,Be){if(0===Be)return;const Ge=a.get("WEBGL_multi_draw");if(null===Ge)for(let it=0;it<Be;it++)this.render(Me[it],Le[it]);else{Ge.multiDrawArraysWEBGL(E,Me,0,Le,0,Be);let it=0;for(let bt=0;bt<Be;bt++)it+=Le[bt];c.update(it,E,1)}}}function td(M,a,c){let h;function E(wn){if("highp"===wn){if(M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.HIGH_FLOAT).precision>0&&M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.HIGH_FLOAT).precision>0)return"highp";wn="mediump"}return"mediump"===wn&&M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.MEDIUM_FLOAT).precision>0&&M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const H=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===M.constructor.name;let K=void 0!==c.precision?c.precision:"highp";const de=E(K);de!==K&&(console.warn("THREE.WebGLRenderer:",K,"not supported, using",de,"instead."),K=de);const ge=H||a.has("WEBGL_draw_buffers"),Me=!0===c.logarithmicDepthBuffer,Le=M.getParameter(M.MAX_TEXTURE_IMAGE_UNITS),Be=M.getParameter(M.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ge=M.getParameter(M.MAX_TEXTURE_SIZE),it=M.getParameter(M.MAX_CUBE_MAP_TEXTURE_SIZE),bt=M.getParameter(M.MAX_VERTEX_ATTRIBS),Ye=M.getParameter(M.MAX_VERTEX_UNIFORM_VECTORS),qe=M.getParameter(M.MAX_VARYING_VECTORS),Ft=M.getParameter(M.MAX_FRAGMENT_UNIFORM_VECTORS),mt=Be>0,Ut=H||a.has("OES_texture_float");return{isWebGL2:H,drawBuffers:ge,getMaxAnisotropy:function p(){if(void 0!==h)return h;if(!0===a.has("EXT_texture_filter_anisotropic")){const wn=a.get("EXT_texture_filter_anisotropic");h=M.getParameter(wn.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else h=0;return h},getMaxPrecision:E,precision:K,logarithmicDepthBuffer:Me,maxTextures:Le,maxVertexTextures:Be,maxTextureSize:Ge,maxCubemapSize:it,maxAttributes:bt,maxVertexUniforms:Ye,maxVaryings:qe,maxFragmentUniforms:Ft,vertexTextures:mt,floatFragmentTextures:Ut,floatVertexTextures:mt&&Ut,maxSamples:H?M.getParameter(M.MAX_SAMPLES):0}}function r0(M){const a=this;let c=null,h=0,p=!1,E=!1;const H=new Zf,K=new vo,de={value:null,needsUpdate:!1};function Me(Le,Be,Ge,it){const bt=null!==Le?Le.length:0;let Ye=null;if(0!==bt){if(Ye=de.value,!0!==it||null===Ye){const qe=Ge+4*bt,Ft=Be.matrixWorldInverse;K.getNormalMatrix(Ft),(null===Ye||Ye.length<qe)&&(Ye=new Float32Array(qe));for(let mt=0,Ut=Ge;mt!==bt;++mt,Ut+=4)H.copy(Le[mt]).applyMatrix4(Ft,K),H.normal.toArray(Ye,Ut),Ye[Ut+3]=H.constant}de.value=Ye,de.needsUpdate=!0}return a.numPlanes=bt,a.numIntersection=0,Ye}this.uniform=de,this.numPlanes=0,this.numIntersection=0,this.init=function(Le,Be){const Ge=0!==Le.length||Be||0!==h||p;return p=Be,h=Le.length,Ge},this.beginShadows=function(){E=!0,Me(null)},this.endShadows=function(){E=!1},this.setGlobalState=function(Le,Be){c=Me(Le,Be,0)},this.setState=function(Le,Be,Ge){const it=Le.clippingPlanes,bt=Le.clipIntersection,Ye=Le.clipShadows,qe=M.get(Le);if(!p||null===it||0===it.length||E&&!Ye)E?Me(null):function ge(){de.value!==c&&(de.value=c,de.needsUpdate=h>0),a.numPlanes=h,a.numIntersection=0}();else{const Ft=E?0:h,mt=4*Ft;let Ut=qe.clippingState||null;de.value=Ut,Ut=Me(it,Be,mt,Ge);for(let kn=0;kn!==mt;++kn)Ut[kn]=c[kn];qe.clippingState=Ut,this.numIntersection=bt?this.numPlanes:0,this.numPlanes+=Ft}}}class sl extends Nl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new lo,this.projectionMatrix=new lo,this.projectionMatrixInverse=new lo,this.coordinateSystem=pi}copy(a,c){return super.copy(a,c),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this.coordinateSystem=a.coordinateSystem,this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,c){super.updateWorldMatrix(a,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const ph=new Dn,Wm=new Si,_f=new Si;class yl extends sl{constructor(a=50,c=1,h=.1,p=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=h,this.far=p,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(a,c){return super.copy(a,c),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this}setFocalLength(a){const c=.5*this.getFilmHeight()/a;this.fov=2*Bu*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const a=Math.tan(.5*fu*this.fov);return.5*this.getFilmHeight()/a}getEffectiveFOV(){return 2*Bu*Math.atan(Math.tan(.5*fu*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,c,h){ph.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),c.set(ph.x,ph.y).multiplyScalar(-a/ph.z),ph.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),h.set(ph.x,ph.y).multiplyScalar(-a/ph.z)}getViewSize(a,c){return this.getViewBounds(a,Wm,_f),c.subVectors(_f,Wm)}setViewOffset(a,c,h,p,E,H){this.aspect=a/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=c,this.view.offsetX=h,this.view.offsetY=p,this.view.width=E,this.view.height=H,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const a=this.near;let c=a*Math.tan(.5*fu*this.fov)/this.zoom,h=2*c,p=this.aspect*h,E=-.5*p;const H=this.view;if(null!==this.view&&this.view.enabled){const de=H.fullWidth,ge=H.fullHeight;E+=H.offsetX*p/de,c-=H.offsetY*h/ge,p*=H.width/de,h*=H.height/ge}const K=this.filmOffset;0!==K&&(E+=a*K/this.getFilmWidth()),this.projectionMatrix.makePerspective(E,E+p,c,c-h,a,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){const c=super.toJSON(a);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}class yu extends Nl{constructor(a,c,h){super(),this.type="CubeCamera",this.renderTarget=h,this.coordinateSystem=null,this.activeMipmapLevel=0;const p=new yl(-90,1,a,c);p.layers=this.layers,this.add(p);const E=new yl(-90,1,a,c);E.layers=this.layers,this.add(E);const H=new yl(-90,1,a,c);H.layers=this.layers,this.add(H);const K=new yl(-90,1,a,c);K.layers=this.layers,this.add(K);const de=new yl(-90,1,a,c);de.layers=this.layers,this.add(de);const ge=new yl(-90,1,a,c);ge.layers=this.layers,this.add(ge)}updateCoordinateSystem(){const a=this.coordinateSystem,c=this.children.concat(),[h,p,E,H,K,de]=c;for(const ge of c)this.remove(ge);if(a===pi)h.up.set(0,1,0),h.lookAt(1,0,0),p.up.set(0,1,0),p.lookAt(-1,0,0),E.up.set(0,0,-1),E.lookAt(0,1,0),H.up.set(0,0,1),H.lookAt(0,-1,0),K.up.set(0,1,0),K.lookAt(0,0,1),de.up.set(0,1,0),de.lookAt(0,0,-1);else{if(2001!==a)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);h.up.set(0,-1,0),h.lookAt(-1,0,0),p.up.set(0,-1,0),p.lookAt(1,0,0),E.up.set(0,0,1),E.lookAt(0,1,0),H.up.set(0,0,-1),H.lookAt(0,-1,0),K.up.set(0,-1,0),K.lookAt(0,0,1),de.up.set(0,-1,0),de.lookAt(0,0,-1)}for(const ge of c)this.add(ge),ge.updateMatrixWorld()}update(a,c){null===this.parent&&this.updateMatrixWorld();const{renderTarget:h,activeMipmapLevel:p}=this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());const[E,H,K,de,ge,Me]=this.children,Le=a.getRenderTarget(),Be=a.getActiveCubeFace(),Ge=a.getActiveMipmapLevel(),it=a.xr.enabled;a.xr.enabled=!1;const bt=h.texture.generateMipmaps;h.texture.generateMipmaps=!1,a.setRenderTarget(h,0,p),a.render(c,E),a.setRenderTarget(h,1,p),a.render(c,H),a.setRenderTarget(h,2,p),a.render(c,K),a.setRenderTarget(h,3,p),a.render(c,de),a.setRenderTarget(h,4,p),a.render(c,ge),h.texture.generateMipmaps=bt,a.setRenderTarget(h,5,p),a.render(c,Me),a.setRenderTarget(Le,Be,Ge),a.xr.enabled=it,h.texture.needsPMREMUpdate=!0}}class s0 extends $d{constructor(a,c,h,p,E,H,K,de,ge,Me){super(a=void 0!==a?a:[],c=void 0!==c?c:Bn,h,p,E,H,K,de,ge,Me),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class o0 extends ku{constructor(a=1,c={}){super(a,a,c),this.isWebGLCubeRenderTarget=!0;const h={width:a,height:a,depth:1};this.texture=new s0([h,h,h,h,h,h],c.mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:wt}fromEquirectangularTexture(a,c){this.texture.type=c.type,this.texture.colorSpace=c.colorSpace,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const h_uniforms={tEquirect:{value:null}},h_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",h_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",p=new Eh(5,5,5),E=new Pc({name:"CubemapFromEquirect",uniforms:Xr(h_uniforms),vertexShader:h_vertexShader,fragmentShader:h_fragmentShader,side:1,blending:he});E.uniforms.tEquirect.value=c;const H=new gl(p,E),K=c.minFilter;return c.minFilter===me&&(c.minFilter=wt),new yu(1,10,this).update(a,H),c.minFilter=K,H.geometry.dispose(),H.material.dispose(),this}clear(a,c,h,p){const E=a.getRenderTarget();for(let H=0;H<6;H++)a.setRenderTarget(this,H),a.clear(c,h,p);a.setRenderTarget(E)}}function a0(M){let a=new WeakMap;function c(H,K){return 303===K?H.mapping=Bn:304===K&&(H.mapping=dn),H}function p(H){const K=H.target;K.removeEventListener("dispose",p);const de=a.get(K);void 0!==de&&(a.delete(K),de.dispose())}return{get:function h(H){if(H&&H.isTexture){const K=H.mapping;if(303===K||304===K){if(a.has(H))return c(a.get(H).texture,H.mapping);{const de=H.image;if(de&&de.height>0){const ge=new o0(de.height);return ge.fromEquirectangularTexture(M,H),a.set(H,ge),H.addEventListener("dispose",p),c(ge.texture,H.mapping)}return null}}}return H},dispose:function E(){a=new WeakMap}}}class x_ extends sl{constructor(a=-1,c=1,h=1,p=-1,E=.1,H=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=c,this.top=h,this.bottom=p,this.near=E,this.far=H,this.updateProjectionMatrix()}copy(a,c){return super.copy(a,c),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this}setViewOffset(a,c,h,p,E,H){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=c,this.view.offsetX=h,this.view.offsetY=p,this.view.width=E,this.view.height=H,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const a=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),h=(this.right+this.left)/2,p=(this.top+this.bottom)/2;let E=h-a,H=h+a,K=p+c,de=p-c;if(null!==this.view&&this.view.enabled){const ge=(this.right-this.left)/this.view.fullWidth/this.zoom,Me=(this.top-this.bottom)/this.view.fullHeight/this.zoom;E+=ge*this.view.offsetX,H=E+ge*this.view.width,K-=Me*this.view.offsetY,de=K-Me*this.view.height}this.projectionMatrix.makeOrthographic(E,H,K,de,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){const c=super.toJSON(a);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}const Mv=[.125,.215,.35,.446,.526,.582],l0=new x_,w_=new to;let hp=null,Ws=0,jA=0;const yf=(1+Math.sqrt(5))/2,Nh=1/yf,xs=[new Dn(1,1,1),new Dn(-1,1,1),new Dn(1,1,-1),new Dn(-1,1,-1),new Dn(0,yf,Nh),new Dn(0,yf,-Nh),new Dn(Nh,0,yf),new Dn(-Nh,0,yf),new Dn(yf,Nh,0),new Dn(-yf,Nh,0)];class C_{constructor(a){this._renderer=a,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(a,c=0,h=.1,p=100){hp=this._renderer.getRenderTarget(),Ws=this._renderer.getActiveCubeFace(),jA=this._renderer.getActiveMipmapLevel(),this._setSize(256);const E=this._allocateTargets();return E.depthBuffer=!0,this._sceneToCubeUV(a,h,p,E),c>0&&this._blur(E,0,0,c),this._applyPMREM(E),this._cleanup(E),E}fromEquirectangular(a,c=null){return this._fromTexture(a,c)}fromCubemap(a,c=null){return this._fromTexture(a,c)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ae(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=X(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(hp,Ws,jA),a.scissorTest=!1,nm(a,0,0,a.width,a.height)}_fromTexture(a,c){this._setSize(a.mapping===Bn||a.mapping===dn?0===a.image.length?16:a.image[0].width||a.image[0].image.width:a.image.width/4),hp=this._renderer.getRenderTarget(),Ws=this._renderer.getActiveCubeFace(),jA=this._renderer.getActiveMipmapLevel();const h=c||this._allocateTargets();return this._textureToCubeUV(a,h),this._applyPMREM(h),this._cleanup(h),h}_allocateTargets(){const a=3*Math.max(this._cubeSize,112),c=4*this._cubeSize,h={magFilter:wt,minFilter:wt,generateMipmaps:!1,type:ln,format:Fn,colorSpace:Yc,depthBuffer:!1},p=bf(a,c,h);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==c){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=bf(a,c,h);const{_lodMax:E}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function vf(M){const a=[],c=[],h=[];let p=M;const E=M-4+1+Mv.length;for(let H=0;H<E;H++){const K=Math.pow(2,p);c.push(K);let de=1/K;H>M-4?de=Mv[H-M+4-1]:0===H&&(de=0),h.push(de);const ge=1/(K-2),Me=-ge,Le=1+ge,Be=[Me,Me,Le,Me,Le,Le,Me,Me,Le,Le,Me,Le],Ge=6,it=6,bt=3,Ye=2,qe=1,Ft=new Float32Array(bt*it*Ge),mt=new Float32Array(Ye*it*Ge),Ut=new Float32Array(qe*it*Ge);for(let bn=0;bn<Ge;bn++){const wn=bn%3*2/3-1,$n=bn>2?0:-1;Ft.set([wn,$n,0,wn+2/3,$n,0,wn+2/3,$n+1,0,wn,$n,0,wn+2/3,$n+1,0,wn,$n+1,0],bt*it*bn),mt.set(Be,Ye*it*bn),Ut.set([bn,bn,bn,bn,bn,bn],qe*it*bn)}const kn=new us;kn.setAttribute("position",new pl(Ft,bt)),kn.setAttribute("uv",new pl(mt,Ye)),kn.setAttribute("faceIndex",new pl(Ut,qe)),a.push(kn),p>4&&p--}return{lodPlanes:a,sizeLods:c,sigmas:h}}(E)),this._blurMaterial=function ee(M,a,c){const h=new Float32Array(20),p=new Dn(0,1,0);return new Pc({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/a,CUBEUV_TEXEL_HEIGHT:1/c,CUBEUV_MAX_MIP:`${M}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:h},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:he,depthTest:!1,depthWrite:!1})}(E,a,c)}return p}_compileMaterial(a){const c=new gl(this._lodPlanes[0],a);this._renderer.compile(c,l0)}_sceneToCubeUV(a,c,h,p){const K=new yl(90,1,c,h),de=[1,-1,1,1,1,1],ge=[1,1,1,-1,-1,-1],Me=this._renderer,Le=Me.autoClear,Be=Me.toneMapping;Me.getClearColor(w_),Me.toneMapping=gt,Me.autoClear=!1;const Ge=new gu({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),it=new gl(new Eh,Ge);let bt=!1;const Ye=a.background;Ye?Ye.isColor&&(Ge.color.copy(Ye),a.background=null,bt=!0):(Ge.color.copy(w_),bt=!0);for(let qe=0;qe<6;qe++){const Ft=qe%3;0===Ft?(K.up.set(0,de[qe],0),K.lookAt(ge[qe],0,0)):1===Ft?(K.up.set(0,0,de[qe]),K.lookAt(0,ge[qe],0)):(K.up.set(0,de[qe],0),K.lookAt(0,0,ge[qe]));const mt=this._cubeSize;nm(p,Ft*mt,qe>2?mt:0,mt,mt),Me.setRenderTarget(p),bt&&Me.render(it,K),Me.render(a,K)}it.geometry.dispose(),it.material.dispose(),Me.toneMapping=Be,Me.autoClear=Le,a.background=Ye}_textureToCubeUV(a,c){const h=this._renderer,p=a.mapping===Bn||a.mapping===dn;p?(null===this._cubemapMaterial&&(this._cubemapMaterial=ae()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===a.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=X());const E=p?this._cubemapMaterial:this._equirectMaterial,H=new gl(this._lodPlanes[0],E);E.uniforms.envMap.value=a;const de=this._cubeSize;nm(c,0,0,3*de,2*de),h.setRenderTarget(c),h.render(H,l0)}_applyPMREM(a){const c=this._renderer,h=c.autoClear;c.autoClear=!1;for(let p=1;p<this._lodPlanes.length;p++){const E=Math.sqrt(this._sigmas[p]*this._sigmas[p]-this._sigmas[p-1]*this._sigmas[p-1]);this._blur(a,p-1,p,E,xs[(p-1)%xs.length])}c.autoClear=h}_blur(a,c,h,p,E){const H=this._pingPongRenderTarget;this._halfBlur(a,H,c,h,p,"latitudinal",E),this._halfBlur(H,a,h,h,p,"longitudinal",E)}_halfBlur(a,c,h,p,E,H,K){const de=this._renderer,ge=this._blurMaterial;"latitudinal"!==H&&"longitudinal"!==H&&console.error("blur direction must be either latitudinal or longitudinal!");const Le=new gl(this._lodPlanes[p],ge),Be=ge.uniforms,Ge=this._sizeLods[h]-1,it=isFinite(E)?Math.PI/(2*Ge):2*Math.PI/39,bt=E/it,Ye=isFinite(E)?1+Math.floor(3*bt):20;Ye>20&&console.warn(`sigmaRadians, ${E}, is too large and will clip, as it requested ${Ye} samples when the maximum is set to 20`);const qe=[];let Ft=0;for(let wn=0;wn<20;++wn){const $n=wn/bt,wi=Math.exp(-$n*$n/2);qe.push(wi),0===wn?Ft+=wi:wn<Ye&&(Ft+=2*wi)}for(let wn=0;wn<qe.length;wn++)qe[wn]=qe[wn]/Ft;Be.envMap.value=a.texture,Be.samples.value=Ye,Be.weights.value=qe,Be.latitudinal.value="latitudinal"===H,K&&(Be.poleAxis.value=K);const{_lodMax:mt}=this;Be.dTheta.value=it,Be.mipInt.value=mt-h;const Ut=this._sizeLods[p];nm(c,3*Ut*(p>mt-4?p-mt+4:0),4*(this._cubeSize-Ut),3*Ut,2*Ut),de.setRenderTarget(c),de.render(Le,l0)}}function bf(M,a,c){const h=new ku(M,a,c);return h.texture.mapping=Hn,h.texture.name="PMREM.cubeUv",h.scissorTest=!0,h}function nm(M,a,c,h,p){M.viewport.set(a,c,h,p),M.scissor.set(a,c,h,p)}function X(){return new Pc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:he,depthTest:!1,depthWrite:!1})}function ae(){return new Pc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:he,depthTest:!1,depthWrite:!1})}function Ve(M){let a=new WeakMap,c=null;function E(K){const de=K.target;de.removeEventListener("dispose",E);const ge=a.get(de);void 0!==ge&&(a.delete(de),ge.dispose())}return{get:function h(K){if(K&&K.isTexture){const de=K.mapping,ge=303===de||304===de,Me=de===Bn||de===dn;if(ge||Me){if(K.isRenderTargetTexture&&!0===K.needsPMREMUpdate){K.needsPMREMUpdate=!1;let Le=a.get(K);return null===c&&(c=new C_(M)),Le=ge?c.fromEquirectangular(K,Le):c.fromCubemap(K,Le),a.set(K,Le),Le.texture}if(a.has(K))return a.get(K).texture;{const Le=K.image;if(ge&&Le&&Le.height>0||Me&&Le&&function p(K){let de=0;for(let Me=0;Me<6;Me++)void 0!==K[Me]&&de++;return 6===de}(Le)){null===c&&(c=new C_(M));const Be=ge?c.fromEquirectangular(K):c.fromCubemap(K);return a.set(K,Be),K.addEventListener("dispose",E),Be.texture}return null}}}return K},dispose:function H(){a=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function ft(M){const a={};function c(h){if(void 0!==a[h])return a[h];let p;switch(h){case"WEBGL_depth_texture":p=M.getExtension("WEBGL_depth_texture")||M.getExtension("MOZ_WEBGL_depth_texture")||M.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":p=M.getExtension("EXT_texture_filter_anisotropic")||M.getExtension("MOZ_EXT_texture_filter_anisotropic")||M.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":p=M.getExtension("WEBGL_compressed_texture_s3tc")||M.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":p=M.getExtension("WEBGL_compressed_texture_pvrtc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:p=M.getExtension(h)}return a[h]=p,p}return{has:function(h){return null!==c(h)},init:function(h){h.isWebGL2?(c("EXT_color_buffer_float"),c("WEBGL_clip_cull_distance")):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float"),c("WEBGL_multisampled_render_to_texture")},get:function(h){const p=c(h);return null===p&&console.warn("THREE.WebGLRenderer: "+h+" extension not supported."),p}}}function kt(M,a,c,h){const p={},E=new WeakMap;function H(Le){const Be=Le.target;null!==Be.index&&a.remove(Be.index);for(const it in Be.attributes)a.remove(Be.attributes[it]);for(const it in Be.morphAttributes){const bt=Be.morphAttributes[it];for(let Ye=0,qe=bt.length;Ye<qe;Ye++)a.remove(bt[Ye])}Be.removeEventListener("dispose",H),delete p[Be.id];const Ge=E.get(Be);Ge&&(a.remove(Ge),E.delete(Be)),h.releaseStatesOfGeometry(Be),!0===Be.isInstancedBufferGeometry&&delete Be._maxInstanceCount,c.memory.geometries--}function ge(Le){const Be=[],Ge=Le.index,it=Le.attributes.position;let bt=0;if(null!==Ge){const Ft=Ge.array;bt=Ge.version;for(let mt=0,Ut=Ft.length;mt<Ut;mt+=3){const kn=Ft[mt+0],bn=Ft[mt+1],wn=Ft[mt+2];Be.push(kn,bn,bn,wn,wn,kn)}}else{if(void 0===it)return;bt=it.version;for(let mt=0,Ut=it.array.length/3-1;mt<Ut;mt+=3){const kn=mt+0,bn=mt+1,wn=mt+2;Be.push(kn,bn,bn,wn,wn,kn)}}const Ye=new(Ch(Be)?Im:D1)(Be,1);Ye.version=bt;const qe=E.get(Le);qe&&a.remove(qe),E.set(Le,Ye)}return{get:function K(Le,Be){return!0===p[Be.id]||(Be.addEventListener("dispose",H),p[Be.id]=!0,c.memory.geometries++),Be},update:function de(Le){const Be=Le.attributes;for(const it in Be)a.update(Be[it],M.ARRAY_BUFFER);const Ge=Le.morphAttributes;for(const it in Ge){const bt=Ge[it];for(let Ye=0,qe=bt.length;Ye<qe;Ye++)a.update(bt[Ye],M.ARRAY_BUFFER)}},getWireframeAttribute:function Me(Le){const Be=E.get(Le);if(Be){const Ge=Le.index;null!==Ge&&Be.version<Ge.version&&ge(Le)}else ge(Le);return E.get(Le)}}}function an(M,a,c,h){const p=h.isWebGL2;let E,K,de;this.setMode=function H(Ge){E=Ge},this.setIndex=function ge(Ge){K=Ge.type,de=Ge.bytesPerElement},this.render=function Me(Ge,it){M.drawElements(E,it,K,Ge*de),c.update(it,E,1)},this.renderInstances=function Le(Ge,it,bt){if(0===bt)return;let Ye,qe;if(p)Ye=M,qe="drawElementsInstanced";else if(Ye=a.get("ANGLE_instanced_arrays"),qe="drawElementsInstancedANGLE",null===Ye)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Ye[qe](E,it,K,Ge*de,bt),c.update(it,E,bt)},this.renderMultiDraw=function Be(Ge,it,bt){if(0===bt)return;const Ye=a.get("WEBGL_multi_draw");if(null===Ye)for(let qe=0;qe<bt;qe++)this.render(Ge[qe]/de,it[qe]);else{Ye.multiDrawElementsWEBGL(E,it,0,K,Ge,0,bt);let qe=0;for(let Ft=0;Ft<bt;Ft++)qe+=it[Ft];c.update(qe,E,1)}}}function sn(M){const c={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:c,programs:null,autoReset:!0,reset:function p(){c.calls=0,c.triangles=0,c.points=0,c.lines=0},update:function h(E,H,K){switch(c.calls++,H){case M.TRIANGLES:c.triangles+=K*(E/3);break;case M.LINES:c.lines+=K*(E/2);break;case M.LINE_STRIP:c.lines+=K*(E-1);break;case M.LINE_LOOP:c.lines+=K*E;break;case M.POINTS:c.points+=K*E;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",H)}}}}class Yn extends $d{constructor(a=null,c=1,h=1,p=1){super(null),this.isDataArrayTexture=!0,this.image={data:a,width:c,height:h,depth:p},this.magFilter=Xi,this.minFilter=Xi,this.wrapR=hi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function ni(M,a){return M[0]-a[0]}function ii(M,a){return Math.abs(a[1])-Math.abs(M[1])}function Gi(M,a,c){const h={},p=new Float32Array(8),E=new WeakMap,H=new Za,K=[];for(let ge=0;ge<8;ge++)K[ge]=[ge,0];return{update:function de(ge,Me,Le){const Be=ge.morphTargetInfluences;if(!0===a.isWebGL2){const Ge=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,it=void 0!==Ge?Ge.length:0;let bt=E.get(Me);if(void 0===bt||bt.count!==it){let dr=function(){Nt.dispose(),E.delete(Me),Me.removeEventListener("dispose",dr)};void 0!==bt&&bt.texture.dispose();const Ye=void 0!==Me.morphAttributes.position,qe=void 0!==Me.morphAttributes.normal,Ft=void 0!==Me.morphAttributes.color,mt=Me.morphAttributes.position||[],Ut=Me.morphAttributes.normal||[],kn=Me.morphAttributes.color||[];let bn=0;!0===Ye&&(bn=1),!0===qe&&(bn=2),!0===Ft&&(bn=3);let wn=Me.attributes.position.count*bn,$n=1;wn>a.maxTextureSize&&($n=Math.ceil(wn/a.maxTextureSize),wn=a.maxTextureSize);const wi=new Float32Array(wn*$n*4*it),Nt=new Yn(wi,wn,$n,it);Nt.type=Cn,Nt.needsUpdate=!0;const In=4*bn;for(let hr=0;hr<it;hr++){const ei=mt[hr],Yi=Ut[hr],Pi=kn[hr],or=wn*$n*4*hr;for(let rr=0;rr<ei.count;rr++){const nr=rr*In;!0===Ye&&(H.fromBufferAttribute(ei,rr),wi[or+nr+0]=H.x,wi[or+nr+1]=H.y,wi[or+nr+2]=H.z,wi[or+nr+3]=0),!0===qe&&(H.fromBufferAttribute(Yi,rr),wi[or+nr+4]=H.x,wi[or+nr+5]=H.y,wi[or+nr+6]=H.z,wi[or+nr+7]=0),!0===Ft&&(H.fromBufferAttribute(Pi,rr),wi[or+nr+8]=H.x,wi[or+nr+9]=H.y,wi[or+nr+10]=H.z,wi[or+nr+11]=4===Pi.itemSize?H.w:1)}}bt={count:it,texture:Nt,size:new Si(wn,$n)},E.set(Me,bt),Me.addEventListener("dispose",dr)}if(!0===ge.isInstancedMesh&&null!==ge.morphTexture)Le.getUniforms().setValue(M,"morphTexture",ge.morphTexture,c);else{let Ye=0;for(let Ft=0;Ft<Be.length;Ft++)Ye+=Be[Ft];const qe=Me.morphTargetsRelative?1:1-Ye;Le.getUniforms().setValue(M,"morphTargetBaseInfluence",qe),Le.getUniforms().setValue(M,"morphTargetInfluences",Be)}Le.getUniforms().setValue(M,"morphTargetsTexture",bt.texture,c),Le.getUniforms().setValue(M,"morphTargetsTextureSize",bt.size)}else{const Ge=void 0===Be?0:Be.length;let it=h[Me.id];if(void 0===it||it.length!==Ge){it=[];for(let mt=0;mt<Ge;mt++)it[mt]=[mt,0];h[Me.id]=it}for(let mt=0;mt<Ge;mt++){const Ut=it[mt];Ut[0]=mt,Ut[1]=Be[mt]}it.sort(ii);for(let mt=0;mt<8;mt++)mt<Ge&&it[mt][1]?(K[mt][0]=it[mt][0],K[mt][1]=it[mt][1]):(K[mt][0]=Number.MAX_SAFE_INTEGER,K[mt][1]=0);K.sort(ni);const bt=Me.morphAttributes.position,Ye=Me.morphAttributes.normal;let qe=0;for(let mt=0;mt<8;mt++){const Ut=K[mt],kn=Ut[0],bn=Ut[1];kn!==Number.MAX_SAFE_INTEGER&&bn?(bt&&Me.getAttribute("morphTarget"+mt)!==bt[kn]&&Me.setAttribute("morphTarget"+mt,bt[kn]),Ye&&Me.getAttribute("morphNormal"+mt)!==Ye[kn]&&Me.setAttribute("morphNormal"+mt,Ye[kn]),p[mt]=bn,qe+=bn):(bt&&!0===Me.hasAttribute("morphTarget"+mt)&&Me.deleteAttribute("morphTarget"+mt),Ye&&!0===Me.hasAttribute("morphNormal"+mt)&&Me.deleteAttribute("morphNormal"+mt),p[mt]=0)}const Ft=Me.morphTargetsRelative?1:1-qe;Le.getUniforms().setValue(M,"morphTargetBaseInfluence",Ft),Le.getUniforms().setValue(M,"morphTargetInfluences",p)}}}}function ms(M,a,c,h){let p=new WeakMap;function K(de){const ge=de.target;ge.removeEventListener("dispose",K),c.remove(ge.instanceMatrix),null!==ge.instanceColor&&c.remove(ge.instanceColor)}return{update:function E(de){const ge=h.render.frame,Le=a.get(de,de.geometry);if(p.get(Le)!==ge&&(a.update(Le),p.set(Le,ge)),de.isInstancedMesh&&(!1===de.hasEventListener("dispose",K)&&de.addEventListener("dispose",K),p.get(de)!==ge&&(c.update(de.instanceMatrix,M.ARRAY_BUFFER),null!==de.instanceColor&&c.update(de.instanceColor,M.ARRAY_BUFFER),p.set(de,ge))),de.isSkinnedMesh){const Be=de.skeleton;p.get(Be)!==ge&&(Be.update(),p.set(Be,ge))}return Le},dispose:function H(){p=new WeakMap}}}class Pr extends $d{constructor(a=null,c=1,h=1,p=1){super(null),this.isData3DTexture=!0,this.image={data:a,width:c,height:h,depth:p},this.magFilter=Xi,this.minFilter=Xi,this.wrapR=hi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Dr extends $d{constructor(a,c,h,p,E,H,K,de,ge,Me){if((Me=void 0!==Me?Me:Ne)!==Ne&&Me!==$)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===h&&Me===Ne&&(h=jt),void 0===h&&Me===$&&(h=Rn),super(null,p,E,H,K,de,Me,h,ge),this.isDepthTexture=!0,this.image={width:a,height:c},this.magFilter=void 0!==K?K:Xi,this.minFilter=void 0!==de?de:Xi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(a){return super.copy(a),this.compareFunction=a.compareFunction,this}toJSON(a){const c=super.toJSON(a);return null!==this.compareFunction&&(c.compareFunction=this.compareFunction),c}}const Do=new $d,Fs=new Dr(1,1);Fs.compareFunction=515;const Ms=new Yn,za=new Pr,qo=new s0,Co=[],hs=[],Ta=new Float32Array(16),ba=new Float32Array(9),So=new Float32Array(4);function Rl(M,a,c){const h=M[0];if(h<=0||h>0)return M;const p=a*c;let E=Co[p];if(void 0===E&&(E=new Float32Array(p),Co[p]=E),0!==a){h.toArray(E,0);for(let H=1,K=0;H!==a;++H)K+=c,M[H].toArray(E,K)}return E}function Xa(M,a){if(M.length!==a.length)return!1;for(let c=0,h=M.length;c<h;c++)if(M[c]!==a[c])return!1;return!0}function el(M,a){for(let c=0,h=a.length;c<h;c++)M[c]=a[c]}function Ya(M,a){let c=hs[a];void 0===c&&(c=new Int32Array(a),hs[a]=c);for(let h=0;h!==a;++h)c[h]=M.allocateTextureUnit();return c}function Qc(M,a){const c=this.cache;c[0]!==a&&(M.uniform1f(this.addr,a),c[0]=a)}function xf(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y)&&(M.uniform2f(this.addr,a.x,a.y),c[0]=a.x,c[1]=a.y);else{if(Xa(c,a))return;M.uniform2fv(this.addr,a),el(c,a)}}function nd(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z)&&(M.uniform3f(this.addr,a.x,a.y,a.z),c[0]=a.x,c[1]=a.y,c[2]=a.z);else if(void 0!==a.r)(c[0]!==a.r||c[1]!==a.g||c[2]!==a.b)&&(M.uniform3f(this.addr,a.r,a.g,a.b),c[0]=a.r,c[1]=a.g,c[2]=a.b);else{if(Xa(c,a))return;M.uniform3fv(this.addr,a),el(c,a)}}function kd(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z||c[3]!==a.w)&&(M.uniform4f(this.addr,a.x,a.y,a.z,a.w),c[0]=a.x,c[1]=a.y,c[2]=a.z,c[3]=a.w);else{if(Xa(c,a))return;M.uniform4fv(this.addr,a),el(c,a)}}function fp(M,a){const c=this.cache,h=a.elements;if(void 0===h){if(Xa(c,a))return;M.uniformMatrix2fv(this.addr,!1,a),el(c,a)}else{if(Xa(c,h))return;So.set(h),M.uniformMatrix2fv(this.addr,!1,So),el(c,h)}}function mh(M,a){const c=this.cache,h=a.elements;if(void 0===h){if(Xa(c,a))return;M.uniformMatrix3fv(this.addr,!1,a),el(c,a)}else{if(Xa(c,h))return;ba.set(h),M.uniformMatrix3fv(this.addr,!1,ba),el(c,h)}}function wf(M,a){const c=this.cache,h=a.elements;if(void 0===h){if(Xa(c,a))return;M.uniformMatrix4fv(this.addr,!1,a),el(c,a)}else{if(Xa(c,h))return;Ta.set(h),M.uniformMatrix4fv(this.addr,!1,Ta),el(c,h)}}function im(M,a){const c=this.cache;c[0]!==a&&(M.uniform1i(this.addr,a),c[0]=a)}function rm(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y)&&(M.uniform2i(this.addr,a.x,a.y),c[0]=a.x,c[1]=a.y);else{if(Xa(c,a))return;M.uniform2iv(this.addr,a),el(c,a)}}function Cf(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z)&&(M.uniform3i(this.addr,a.x,a.y,a.z),c[0]=a.x,c[1]=a.y,c[2]=a.z);else{if(Xa(c,a))return;M.uniform3iv(this.addr,a),el(c,a)}}function sm(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z||c[3]!==a.w)&&(M.uniform4i(this.addr,a.x,a.y,a.z,a.w),c[0]=a.x,c[1]=a.y,c[2]=a.z,c[3]=a.w);else{if(Xa(c,a))return;M.uniform4iv(this.addr,a),el(c,a)}}function Uh(M,a){const c=this.cache;c[0]!==a&&(M.uniform1ui(this.addr,a),c[0]=a)}function $A(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y)&&(M.uniform2ui(this.addr,a.x,a.y),c[0]=a.x,c[1]=a.y);else{if(Xa(c,a))return;M.uniform2uiv(this.addr,a),el(c,a)}}function $m(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z)&&(M.uniform3ui(this.addr,a.x,a.y,a.z),c[0]=a.x,c[1]=a.y,c[2]=a.z);else{if(Xa(c,a))return;M.uniform3uiv(this.addr,a),el(c,a)}}function aM(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z||c[3]!==a.w)&&(M.uniform4ui(this.addr,a.x,a.y,a.z,a.w),c[0]=a.x,c[1]=a.y,c[2]=a.z,c[3]=a.w);else{if(Xa(c,a))return;M.uniform4uiv(this.addr,a),el(c,a)}}function Wx(M,a,c){const h=this.cache,p=c.allocateTextureUnit();h[0]!==p&&(M.uniform1i(this.addr,p),h[0]=p),c.setTexture2D(a||(this.type===M.SAMPLER_2D_SHADOW?Fs:Do),p)}function bT(M,a,c){const h=this.cache,p=c.allocateTextureUnit();h[0]!==p&&(M.uniform1i(this.addr,p),h[0]=p),c.setTexture3D(a||za,p)}function lM(M,a,c){const h=this.cache,p=c.allocateTextureUnit();h[0]!==p&&(M.uniform1i(this.addr,p),h[0]=p),c.setTextureCube(a||qo,p)}function jx(M,a,c){const h=this.cache,p=c.allocateTextureUnit();h[0]!==p&&(M.uniform1i(this.addr,p),h[0]=p),c.setTexture2DArray(a||Ms,p)}function cM(M,a){M.uniform1fv(this.addr,a)}function Xm(M,a){const c=Rl(a,this.size,2);M.uniform2fv(this.addr,c)}function M_(M,a){const c=Rl(a,this.size,3);M.uniform3fv(this.addr,c)}function dM(M,a){const c=Rl(a,this.size,4);M.uniform4fv(this.addr,c)}function $x(M,a){const c=Rl(a,this.size,4);M.uniformMatrix2fv(this.addr,!1,c)}function om(M,a){const c=Rl(a,this.size,9);M.uniformMatrix3fv(this.addr,!1,c)}function xT(M,a){const c=Rl(a,this.size,16);M.uniformMatrix4fv(this.addr,!1,c)}function Fd(M,a){M.uniform1iv(this.addr,a)}function Ev(M,a){M.uniform2iv(this.addr,a)}function uM(M,a){M.uniform3iv(this.addr,a)}function hM(M,a){M.uniform4iv(this.addr,a)}function wT(M,a){M.uniform1uiv(this.addr,a)}function am(M,a){M.uniform2uiv(this.addr,a)}function Z1(M,a){M.uniform3uiv(this.addr,a)}function Xx(M,a){M.uniform4uiv(this.addr,a)}function Mf(M,a,c){const h=this.cache,p=a.length,E=Ya(c,p);Xa(h,E)||(M.uniform1iv(this.addr,E),el(h,E));for(let H=0;H!==p;++H)c.setTexture2D(a[H]||Do,E[H])}function Tv(M,a,c){const h=this.cache,p=a.length,E=Ya(c,p);Xa(h,E)||(M.uniform1iv(this.addr,E),el(h,E));for(let H=0;H!==p;++H)c.setTexture3D(a[H]||za,E[H])}function c0(M,a,c){const h=this.cache,p=a.length,E=Ya(c,p);Xa(h,E)||(M.uniform1iv(this.addr,E),el(h,E));for(let H=0;H!==p;++H)c.setTextureCube(a[H]||qo,E[H])}function Dv(M,a,c){const h=this.cache,p=a.length,E=Ya(c,p);Xa(h,E)||(M.uniform1iv(this.addr,E),el(h,E));for(let H=0;H!==p;++H)c.setTexture2DArray(a[H]||Ms,E[H])}class S_{constructor(a,c,h){this.id=a,this.addr=h,this.cache=[],this.type=c.type,this.setValue=function Sv(M){switch(M){case 5126:return Qc;case 35664:return xf;case 35665:return nd;case 35666:return kd;case 35674:return fp;case 35675:return mh;case 35676:return wf;case 5124:case 35670:return im;case 35667:case 35671:return rm;case 35668:case 35672:return Cf;case 35669:case 35673:return sm;case 5125:return Uh;case 36294:return $A;case 36295:return $m;case 36296:return aM;case 35678:case 36198:case 36298:case 36306:case 35682:return Wx;case 35679:case 36299:case 36307:return bT;case 35680:case 36300:case 36308:case 36293:return lM;case 36289:case 36303:case 36311:case 36292:return jx}}(c.type)}}class Bv{constructor(a,c,h){this.id=a,this.addr=h,this.cache=[],this.type=c.type,this.size=c.size,this.setValue=function Iv(M){switch(M){case 5126:return cM;case 35664:return Xm;case 35665:return M_;case 35666:return dM;case 35674:return $x;case 35675:return om;case 35676:return xT;case 5124:case 35670:return Fd;case 35667:case 35671:return Ev;case 35668:case 35672:return uM;case 35669:case 35673:return hM;case 5125:return wT;case 36294:return am;case 36295:return Z1;case 36296:return Xx;case 35678:case 36198:case 36298:case 36306:case 35682:return Mf;case 35679:case 36299:case 36307:return Tv;case 35680:case 36300:case 36308:case 36293:return c0;case 36289:case 36303:case 36311:case 36292:return Dv}}(c.type)}}class y{constructor(a){this.id=a,this.seq=[],this.map={}}setValue(a,c,h){const p=this.seq;for(let E=0,H=p.length;E!==H;++E){const K=p[E];K.setValue(a,c[K.id],h)}}}const G=/(\w+)(\])?(\[|\.)?/g;function ye(M,a){M.seq.push(a),M.map[a.id]=a}function we(M,a,c){const h=M.name,p=h.length;for(G.lastIndex=0;;){const E=G.exec(h);let K=E[1];const ge=E[3];if("]"===E[2]&&(K|=0),void 0===ge||"["===ge&&G.lastIndex+2===p){ye(c,void 0===ge?new S_(K,M,a):new Bv(K,M,a));break}{let Le=c.map[K];void 0===Le&&(Le=new y(K),ye(c,Le)),c=Le}}}class tt{constructor(a,c){this.seq=[],this.map={};const h=a.getProgramParameter(c,a.ACTIVE_UNIFORMS);for(let p=0;p<h;++p){const E=a.getActiveUniform(c,p);we(E,a.getUniformLocation(c,E.name),this)}}setValue(a,c,h,p){const E=this.map[c];void 0!==E&&E.setValue(a,h,p)}setOptional(a,c,h){const p=c[h];void 0!==p&&this.setValue(a,h,p)}static upload(a,c,h,p){for(let E=0,H=c.length;E!==H;++E){const K=c[E],de=h[K.id];!1!==de.needsUpdate&&K.setValue(a,de.value,p)}}static seqWithValue(a,c){const h=[];for(let p=0,E=a.length;p!==E;++p){const H=a[p];H.id in c&&h.push(H)}return h}}function pt(M,a,c){const h=M.createShader(a);return M.shaderSource(h,c),M.compileShader(h),h}const Ct=37297;let Pt=0;function hn(M,a,c){const h=M.getShaderParameter(a,M.COMPILE_STATUS),p=M.getShaderInfoLog(a).trim();if(h&&""===p)return"";const E=/ERROR: 0:(\d+)/.exec(p);if(E){const H=parseInt(E[1]);return c.toUpperCase()+"\n\n"+p+"\n\n"+function $t(M,a){const c=M.split("\n"),h=[],p=Math.max(a-6,0),E=Math.min(a+6,c.length);for(let H=p;H<E;H++){const K=H+1;h.push(`${K===a?">":" "} ${K}: ${c[H]}`)}return h.join("\n")}(M.getShaderSource(a),H)}return p}function Kn(M,a){const c=function Yt(M){const a=va.getPrimaries(va.workingColorSpace),c=va.getPrimaries(M);let h;switch(a===c?h="":a===qf&&c===Vo?h="LinearDisplayP3ToLinearSRGB":a===Vo&&c===qf&&(h="LinearSRGBToLinearDisplayP3"),M){case Yc:case Kc:return[h,"LinearTransferOETF"];case rl:case Iu:return[h,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",M),[h,"LinearTransferOETF"]}}(a);return`vec4 ${M}( vec4 value ) { return ${c[0]}( ${c[1]}( value ) ); }`}function Xn(M,a){let c;switch(a){case ht:c="Linear";break;case st:c="Reinhard";break;case yt:c="OptimizedCineon";break;case Kt:c="ACESFilmic";break;case It:c="AgX";break;case An:c="Neutral";break;case Ot:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",a),c="Linear"}return"vec3 "+M+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function ss(M){return""!==M}function Io(M,a){const c=a.numSpotLightShadows+a.numSpotLightMaps-a.numSpotLightShadowsWithMaps;return M.replace(/NUM_DIR_LIGHTS/g,a.numDirLights).replace(/NUM_SPOT_LIGHTS/g,a.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,a.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,c).replace(/NUM_RECT_AREA_LIGHTS/g,a.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,a.numPointLights).replace(/NUM_HEMI_LIGHTS/g,a.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,a.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,a.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,a.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,a.numPointLightShadows)}function Ir(M,a){return M.replace(/NUM_CLIPPING_PLANES/g,a.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,a.numClippingPlanes-a.numClipIntersection)}const Wi=/^[ \t]*#include +<([\w\d./]+)>/gm;function Os(M){return M.replace(Wi,Bo)}const ls=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Bo(M,a){let c=$o[a];if(void 0===c){const h=ls.get(a);if(void 0===h)throw new Error("Can not resolve #include <"+a+">");c=$o[h],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',a,h)}return Os(c)}const cl=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _c(M){return M.replace(cl,cc)}function cc(M,a,c,h){let p="";for(let E=parseInt(a);E<parseInt(c);E++)p+=h.replace(/\[\s*i\s*\]/g,"[ "+E+" ]").replace(/UNROLLED_LOOP_INDEX/g,E);return p}function js(M){let a=`precision ${M.precision} float;\n\tprecision ${M.precision} int;\n\tprecision ${M.precision} sampler2D;\n\tprecision ${M.precision} samplerCube;\n\t`;return M.isWebGL2&&(a+=`precision ${M.precision} sampler3D;\n\t\tprecision ${M.precision} sampler2DArray;\n\t\tprecision ${M.precision} sampler2DShadow;\n\t\tprecision ${M.precision} samplerCubeShadow;\n\t\tprecision ${M.precision} sampler2DArrayShadow;\n\t\tprecision ${M.precision} isampler2D;\n\t\tprecision ${M.precision} isampler3D;\n\t\tprecision ${M.precision} isamplerCube;\n\t\tprecision ${M.precision} isampler2DArray;\n\t\tprecision ${M.precision} usampler2D;\n\t\tprecision ${M.precision} usampler3D;\n\t\tprecision ${M.precision} usamplerCube;\n\t\tprecision ${M.precision} usampler2DArray;\n\t\t`),"highp"===M.precision?a+="\n#define HIGH_PRECISION":"mediump"===M.precision?a+="\n#define MEDIUM_PRECISION":"lowp"===M.precision&&(a+="\n#define LOW_PRECISION"),a}function id(M,a,c,h){const p=M.getContext(),E=c.defines;let H=c.vertexShader,K=c.fragmentShader;const de=function Ml(M){let a="SHADOWMAP_TYPE_BASIC";return M.shadowMapType===Re?a="SHADOWMAP_TYPE_PCF":M.shadowMapType===He?a="SHADOWMAP_TYPE_PCF_SOFT":M.shadowMapType===Ie&&(a="SHADOWMAP_TYPE_VSM"),a}(c),ge=function qs(M){let a="ENVMAP_TYPE_CUBE";if(M.envMap)switch(M.envMapMode){case Bn:case dn:a="ENVMAP_TYPE_CUBE";break;case Hn:a="ENVMAP_TYPE_CUBE_UV"}return a}(c),Me=function Qo(M){let a="ENVMAP_MODE_REFLECTION";return M.envMap&&M.envMapMode===dn&&(a="ENVMAP_MODE_REFRACTION"),a}(c),Le=function vu(M){let a="ENVMAP_BLENDING_NONE";if(M.envMap)switch(M.combine){case Ue:a="ENVMAP_BLENDING_MULTIPLY";break;case Oe:a="ENVMAP_BLENDING_MIX";break;case lt:a="ENVMAP_BLENDING_ADD"}return a}(c),Be=function Kd(M){const a=M.envMapCubeUVHeight;if(null===a)return null;const c=Math.log2(a)-2,h=1/a;return{texelWidth:1/(3*Math.max(Math.pow(2,c),112)),texelHeight:h,maxMip:c}}(c),Ge=c.isWebGL2?"":function xi(M){return[M.extensionDerivatives||M.envMapCubeUVHeight||M.bumpMap||M.normalMapTangentSpace||M.clearcoatNormalMap||M.flatShading||M.alphaToCoverage||"physical"===M.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(M.extensionFragDepth||M.logarithmicDepthBuffer)&&M.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",M.extensionDrawBuffers&&M.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(M.extensionShaderTextureLOD||M.envMap||M.transmission)&&M.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ss).join("\n")}(c),it=function wr(M){return[M.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",M.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ss).join("\n")}(c),bt=function ir(M){const a=[];for(const c in M){const h=M[c];!1!==h&&a.push("#define "+c+" "+h)}return a.join("\n")}(E),Ye=p.createProgram();let qe,Ft,mt=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(qe=["#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,bt].filter(ss).join("\n"),qe.length>0&&(qe+="\n"),Ft=[Ge,"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,bt].filter(ss).join("\n"),Ft.length>0&&(Ft+="\n")):(qe=[js(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,bt,c.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",c.batching?"#define USE_BATCHING":"",c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.instancingMorph?"#define USE_INSTANCING_MORPH":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+Me:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.displacementMap?"#define USE_DISPLACEMENTMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.mapUv?"#define MAP_UV "+c.mapUv:"",c.alphaMapUv?"#define ALPHAMAP_UV "+c.alphaMapUv:"",c.lightMapUv?"#define LIGHTMAP_UV "+c.lightMapUv:"",c.aoMapUv?"#define AOMAP_UV "+c.aoMapUv:"",c.emissiveMapUv?"#define EMISSIVEMAP_UV "+c.emissiveMapUv:"",c.bumpMapUv?"#define BUMPMAP_UV "+c.bumpMapUv:"",c.normalMapUv?"#define NORMALMAP_UV "+c.normalMapUv:"",c.displacementMapUv?"#define DISPLACEMENTMAP_UV "+c.displacementMapUv:"",c.metalnessMapUv?"#define METALNESSMAP_UV "+c.metalnessMapUv:"",c.roughnessMapUv?"#define ROUGHNESSMAP_UV "+c.roughnessMapUv:"",c.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+c.anisotropyMapUv:"",c.clearcoatMapUv?"#define CLEARCOATMAP_UV "+c.clearcoatMapUv:"",c.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+c.clearcoatNormalMapUv:"",c.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+c.clearcoatRoughnessMapUv:"",c.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+c.iridescenceMapUv:"",c.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+c.iridescenceThicknessMapUv:"",c.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+c.sheenColorMapUv:"",c.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+c.sheenRoughnessMapUv:"",c.specularMapUv?"#define SPECULARMAP_UV "+c.specularMapUv:"",c.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+c.specularColorMapUv:"",c.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+c.specularIntensityMapUv:"",c.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+c.transmissionMapUv:"",c.thicknessMapUv?"#define THICKNESSMAP_UV "+c.thicknessMapUv:"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.morphColors&&c.isWebGL2?"#define USE_MORPHCOLORS":"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+c.morphTextureStride:"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+de:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ss).join("\n"),Ft=[Ge,js(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,bt,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+ge:"",c.envMap?"#define "+Me:"",c.envMap?"#define "+Le:"",Be?"#define CUBEUV_TEXEL_WIDTH "+Be.texelWidth:"",Be?"#define CUBEUV_TEXEL_HEIGHT "+Be.texelHeight:"",Be?"#define CUBEUV_MAX_MIP "+Be.maxMip+".0":"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescence?"#define USE_IRIDESCENCE":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+de:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==gt?"#define TONE_MAPPING":"",c.toneMapping!==gt?$o.tonemapping_pars_fragment:"",c.toneMapping!==gt?Xn("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.opaque?"#define OPAQUE":"",$o.colorspace_pars_fragment,Kn("linearToOutputTexel",c.outputColorSpace),c.useDepthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(ss).join("\n")),H=Os(H),H=Io(H,c),H=Ir(H,c),K=Os(K),K=Io(K,c),K=Ir(K,c),H=_c(H),K=_c(K),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(mt="#version 300 es\n",qe=[it,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+qe,Ft=["precision mediump sampler2DArray;","#define varying in",c.glslVersion===xh?"":"layout(location = 0) out highp vec4 pc_fragColor;",c.glslVersion===xh?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Ft);const kn=mt+Ft+K,bn=pt(p,p.VERTEX_SHADER,mt+qe+H),wn=pt(p,p.FRAGMENT_SHADER,kn);function $n(dr){if(M.debug.checkShaderErrors){const hr=p.getProgramInfoLog(Ye).trim(),ei=p.getShaderInfoLog(bn).trim(),Yi=p.getShaderInfoLog(wn).trim();let Pi=!0,or=!0;if(!1===p.getProgramParameter(Ye,p.LINK_STATUS))if(Pi=!1,"function"==typeof M.debug.onShaderError)M.debug.onShaderError(p,Ye,bn,wn);else{const rr=hn(p,bn,"vertex"),nr=hn(p,wn,"fragment");console.error("THREE.WebGLProgram: Shader Error "+p.getError()+" - VALIDATE_STATUS "+p.getProgramParameter(Ye,p.VALIDATE_STATUS)+"\n\nMaterial Name: "+dr.name+"\nMaterial Type: "+dr.type+"\n\nProgram Info Log: "+hr+"\n"+rr+"\n"+nr)}else""!==hr?console.warn("THREE.WebGLProgram: Program Info Log:",hr):(""===ei||""===Yi)&&(or=!1);or&&(dr.diagnostics={runnable:Pi,programLog:hr,vertexShader:{log:ei,prefix:qe},fragmentShader:{log:Yi,prefix:Ft}})}p.deleteShader(bn),p.deleteShader(wn),wi=new tt(p,Ye),Nt=function ur(M,a){const c={},h=M.getProgramParameter(a,M.ACTIVE_ATTRIBUTES);for(let p=0;p<h;p++){const E=M.getActiveAttrib(a,p),H=E.name;let K=1;E.type===M.FLOAT_MAT2&&(K=2),E.type===M.FLOAT_MAT3&&(K=3),E.type===M.FLOAT_MAT4&&(K=4),c[H]={type:E.type,location:M.getAttribLocation(a,H),locationSize:K}}return c}(p,Ye)}let wi,Nt;p.attachShader(Ye,bn),p.attachShader(Ye,wn),void 0!==c.index0AttributeName?p.bindAttribLocation(Ye,0,c.index0AttributeName):!0===c.morphTargets&&p.bindAttribLocation(Ye,0,"position"),p.linkProgram(Ye),this.getUniforms=function(){return void 0===wi&&$n(this),wi},this.getAttributes=function(){return void 0===Nt&&$n(this),Nt};let In=!1===c.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===In&&(In=p.getProgramParameter(Ye,Ct)),In},this.destroy=function(){h.releaseStatesOfProgram(this),p.deleteProgram(Ye),this.program=void 0},this.type=c.shaderType,this.name=c.shaderName,this.id=Pt++,this.cacheKey=a,this.usedTimes=1,this.program=Ye,this.vertexShader=bn,this.fragmentShader=wn,this}let Od=0;class Jl{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(a){const h=a.fragmentShader,p=this._getShaderStage(a.vertexShader),E=this._getShaderStage(h),H=this._getShaderCacheForMaterial(a);return!1===H.has(p)&&(H.add(p),p.usedTimes++),!1===H.has(E)&&(H.add(E),E.usedTimes++),this}remove(a){const c=this.materialCache.get(a);for(const h of c)h.usedTimes--,0===h.usedTimes&&this.shaderCache.delete(h.code);return this.materialCache.delete(a),this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(a){const c=this.materialCache;let h=c.get(a);return void 0===h&&(h=new Set,c.set(a,h)),h}_getShaderStage(a){const c=this.shaderCache;let h=c.get(a);return void 0===h&&(h=new pp(a),c.set(a,h)),h}}class pp{constructor(a){this.id=Od++,this.code=a,this.usedTimes=0}}function d0(M,a,c,h,p,E,H){const K=new wl,de=new Jl,ge=new Set,Me=[],Le=p.isWebGL2,Be=p.logarithmicDepthBuffer,Ge=p.vertexTextures;let it=p.precision;const bt={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Ye(Nt){return ge.add(Nt),0===Nt?"uv":`uv${Nt}`}return{getParameters:function qe(Nt,In,dr,hr,ei){const Yi=hr.fog,Pi=ei.geometry,rr=(Nt.isMeshStandardMaterial?c:a).get(Nt.envMap||(Nt.isMeshStandardMaterial?hr.environment:null)),nr=rr&&rr.mapping===Hn?rr.image.height:null,Gr=bt[Nt.type];null!==Nt.precision&&(it=p.getMaxPrecision(Nt.precision),it!==Nt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Nt.precision,"not supported, using",it,"instead."));const zr=Pi.morphAttributes.position||Pi.morphAttributes.normal||Pi.morphAttributes.color,Ps=void 0!==zr?zr.length:0;let Li,Br,Rs,co,Jo=0;if(void 0!==Pi.morphAttributes.position&&(Jo=1),void 0!==Pi.morphAttributes.normal&&(Jo=2),void 0!==Pi.morphAttributes.color&&(Jo=3),Gr){const zl=fh[Gr];Li=zl.vertexShader,Br=zl.fragmentShader}else Li=Nt.vertexShader,Br=Nt.fragmentShader,de.update(Nt),Rs=de.getVertexShaderID(Nt),co=de.getFragmentShaderID(Nt);const no=M.getRenderTarget(),$s=!0===ei.isInstancedMesh,uo=!!Nt.map,Jr=!!rr,lr=!!Nt.aoMap,Yr=!!Nt.lightMap,_r=!!Nt.bumpMap,zs=!!Nt.normalMap,Ds=!!Nt.displacementMap,eo=!!Nt.emissiveMap,Va=!!Nt.metalnessMap,_n=!!Nt.roughnessMap,Gt=Nt.anisotropy>0,ji=Nt.clearcoat>0,Zi=Nt.iridescence>0,Fr=Nt.sheen>0,Cr=Nt.transmission>0,ea=Gt&&!!Nt.anisotropyMap,Oo=ji&&!!Nt.clearcoatMap,ts=ji&&!!Nt.clearcoatNormalMap,fs=ji&&!!Nt.clearcoatRoughnessMap,ta=Zi&&!!Nt.iridescenceMap,Wr=Zi&&!!Nt.iridescenceThicknessMap,md=Fr&&!!Nt.sheenColorMap,Ga=Fr&&!!Nt.sheenRoughnessMap,Eo=!!Nt.specularMap,so=!!Nt.specularColorMap,oo=!!Nt.specularIntensityMap,tl=Cr&&!!Nt.transmissionMap,la=Cr&&!!Nt.thicknessMap,oi=!!Nt.alphaMap,ns=!!Nt.extensions;let bs=gt;Nt.toneMapped&&(null===no||!0===no.isXRRenderTarget)&&(bs=M.toneMapping);const Fa={isWebGL2:Le,shaderID:Gr,shaderType:Nt.type,shaderName:Nt.name,vertexShader:Li,fragmentShader:Br,defines:Nt.defines,customVertexShaderID:Rs,customFragmentShaderID:co,isRawShaderMaterial:!0===Nt.isRawShaderMaterial,glslVersion:Nt.glslVersion,precision:it,batching:!0===ei.isBatchedMesh,instancing:$s,instancingColor:$s&&null!==ei.instanceColor,instancingMorph:$s&&null!==ei.morphTexture,supportsVertexTextures:Ge,outputColorSpace:null===no?M.outputColorSpace:!0===no.isXRRenderTarget?no.texture.colorSpace:Yc,alphaToCoverage:!!Nt.alphaToCoverage,map:uo,matcap:!!Nt.matcap,envMap:Jr,envMapMode:Jr&&rr.mapping,envMapCubeUVHeight:nr,aoMap:lr,lightMap:Yr,bumpMap:_r,normalMap:zs,displacementMap:Ge&&Ds,emissiveMap:eo,normalMapObjectSpace:zs&&1===Nt.normalMapType,normalMapTangentSpace:zs&&0===Nt.normalMapType,metalnessMap:Va,roughnessMap:_n,anisotropy:Gt,anisotropyMap:ea,clearcoat:ji,clearcoatMap:Oo,clearcoatNormalMap:ts,clearcoatRoughnessMap:fs,iridescence:Zi,iridescenceMap:ta,iridescenceThicknessMap:Wr,sheen:Fr,sheenColorMap:md,sheenRoughnessMap:Ga,specularMap:Eo,specularColorMap:so,specularIntensityMap:oo,transmission:Cr,transmissionMap:tl,thicknessMap:la,gradientMap:!!Nt.gradientMap,opaque:!1===Nt.transparent&&1===Nt.blending&&!1===Nt.alphaToCoverage,alphaMap:oi,alphaTest:Nt.alphaTest>0,alphaHash:!!Nt.alphaHash,combine:Nt.combine,mapUv:uo&&Ye(Nt.map.channel),aoMapUv:lr&&Ye(Nt.aoMap.channel),lightMapUv:Yr&&Ye(Nt.lightMap.channel),bumpMapUv:_r&&Ye(Nt.bumpMap.channel),normalMapUv:zs&&Ye(Nt.normalMap.channel),displacementMapUv:Ds&&Ye(Nt.displacementMap.channel),emissiveMapUv:eo&&Ye(Nt.emissiveMap.channel),metalnessMapUv:Va&&Ye(Nt.metalnessMap.channel),roughnessMapUv:_n&&Ye(Nt.roughnessMap.channel),anisotropyMapUv:ea&&Ye(Nt.anisotropyMap.channel),clearcoatMapUv:Oo&&Ye(Nt.clearcoatMap.channel),clearcoatNormalMapUv:ts&&Ye(Nt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:fs&&Ye(Nt.clearcoatRoughnessMap.channel),iridescenceMapUv:ta&&Ye(Nt.iridescenceMap.channel),iridescenceThicknessMapUv:Wr&&Ye(Nt.iridescenceThicknessMap.channel),sheenColorMapUv:md&&Ye(Nt.sheenColorMap.channel),sheenRoughnessMapUv:Ga&&Ye(Nt.sheenRoughnessMap.channel),specularMapUv:Eo&&Ye(Nt.specularMap.channel),specularColorMapUv:so&&Ye(Nt.specularColorMap.channel),specularIntensityMapUv:oo&&Ye(Nt.specularIntensityMap.channel),transmissionMapUv:tl&&Ye(Nt.transmissionMap.channel),thicknessMapUv:la&&Ye(Nt.thicknessMap.channel),alphaMapUv:oi&&Ye(Nt.alphaMap.channel),vertexTangents:!!Pi.attributes.tangent&&(zs||Gt),vertexColors:Nt.vertexColors,vertexAlphas:!0===Nt.vertexColors&&!!Pi.attributes.color&&4===Pi.attributes.color.itemSize,pointsUvs:!0===ei.isPoints&&!!Pi.attributes.uv&&(uo||oi),fog:!!Yi,useFog:!0===Nt.fog,fogExp2:!!Yi&&Yi.isFogExp2,flatShading:!0===Nt.flatShading,sizeAttenuation:!0===Nt.sizeAttenuation,logarithmicDepthBuffer:Be,skinning:!0===ei.isSkinnedMesh,morphTargets:void 0!==Pi.morphAttributes.position,morphNormals:void 0!==Pi.morphAttributes.normal,morphColors:void 0!==Pi.morphAttributes.color,morphTargetsCount:Ps,morphTextureStride:Jo,numDirLights:In.directional.length,numPointLights:In.point.length,numSpotLights:In.spot.length,numSpotLightMaps:In.spotLightMap.length,numRectAreaLights:In.rectArea.length,numHemiLights:In.hemi.length,numDirLightShadows:In.directionalShadowMap.length,numPointLightShadows:In.pointShadowMap.length,numSpotLightShadows:In.spotShadowMap.length,numSpotLightShadowsWithMaps:In.numSpotLightShadowsWithMaps,numLightProbes:In.numLightProbes,numClippingPlanes:H.numPlanes,numClipIntersection:H.numIntersection,dithering:Nt.dithering,shadowMapEnabled:M.shadowMap.enabled&&dr.length>0,shadowMapType:M.shadowMap.type,toneMapping:bs,useLegacyLights:M._useLegacyLights,decodeVideoTexture:uo&&!0===Nt.map.isVideoTexture&&va.getTransfer(Nt.map.colorSpace)===Ra,premultipliedAlpha:Nt.premultipliedAlpha,doubleSided:Nt.side===ie,flipSided:1===Nt.side,useDepthPacking:Nt.depthPacking>=0,depthPacking:Nt.depthPacking||0,index0AttributeName:Nt.index0AttributeName,extensionDerivatives:ns&&!0===Nt.extensions.derivatives,extensionFragDepth:ns&&!0===Nt.extensions.fragDepth,extensionDrawBuffers:ns&&!0===Nt.extensions.drawBuffers,extensionShaderTextureLOD:ns&&!0===Nt.extensions.shaderTextureLOD,extensionClipCullDistance:ns&&!0===Nt.extensions.clipCullDistance&&h.has("WEBGL_clip_cull_distance"),extensionMultiDraw:ns&&!0===Nt.extensions.multiDraw&&h.has("WEBGL_multi_draw"),rendererExtensionFragDepth:Le||h.has("EXT_frag_depth"),rendererExtensionDrawBuffers:Le||h.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:Le||h.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:h.has("KHR_parallel_shader_compile"),customProgramCacheKey:Nt.customProgramCacheKey()};return Fa.vertexUv1s=ge.has(1),Fa.vertexUv2s=ge.has(2),Fa.vertexUv3s=ge.has(3),ge.clear(),Fa},getProgramCacheKey:function Ft(Nt){const In=[];if(Nt.shaderID?In.push(Nt.shaderID):(In.push(Nt.customVertexShaderID),In.push(Nt.customFragmentShaderID)),void 0!==Nt.defines)for(const dr in Nt.defines)In.push(dr),In.push(Nt.defines[dr]);return!1===Nt.isRawShaderMaterial&&(function mt(Nt,In){Nt.push(In.precision),Nt.push(In.outputColorSpace),Nt.push(In.envMapMode),Nt.push(In.envMapCubeUVHeight),Nt.push(In.mapUv),Nt.push(In.alphaMapUv),Nt.push(In.lightMapUv),Nt.push(In.aoMapUv),Nt.push(In.bumpMapUv),Nt.push(In.normalMapUv),Nt.push(In.displacementMapUv),Nt.push(In.emissiveMapUv),Nt.push(In.metalnessMapUv),Nt.push(In.roughnessMapUv),Nt.push(In.anisotropyMapUv),Nt.push(In.clearcoatMapUv),Nt.push(In.clearcoatNormalMapUv),Nt.push(In.clearcoatRoughnessMapUv),Nt.push(In.iridescenceMapUv),Nt.push(In.iridescenceThicknessMapUv),Nt.push(In.sheenColorMapUv),Nt.push(In.sheenRoughnessMapUv),Nt.push(In.specularMapUv),Nt.push(In.specularColorMapUv),Nt.push(In.specularIntensityMapUv),Nt.push(In.transmissionMapUv),Nt.push(In.thicknessMapUv),Nt.push(In.combine),Nt.push(In.fogExp2),Nt.push(In.sizeAttenuation),Nt.push(In.morphTargetsCount),Nt.push(In.morphAttributeCount),Nt.push(In.numDirLights),Nt.push(In.numPointLights),Nt.push(In.numSpotLights),Nt.push(In.numSpotLightMaps),Nt.push(In.numHemiLights),Nt.push(In.numRectAreaLights),Nt.push(In.numDirLightShadows),Nt.push(In.numPointLightShadows),Nt.push(In.numSpotLightShadows),Nt.push(In.numSpotLightShadowsWithMaps),Nt.push(In.numLightProbes),Nt.push(In.shadowMapType),Nt.push(In.toneMapping),Nt.push(In.numClippingPlanes),Nt.push(In.numClipIntersection),Nt.push(In.depthPacking)}(In,Nt),function Ut(Nt,In){K.disableAll(),In.isWebGL2&&K.enable(0),In.supportsVertexTextures&&K.enable(1),In.instancing&&K.enable(2),In.instancingColor&&K.enable(3),In.instancingMorph&&K.enable(4),In.matcap&&K.enable(5),In.envMap&&K.enable(6),In.normalMapObjectSpace&&K.enable(7),In.normalMapTangentSpace&&K.enable(8),In.clearcoat&&K.enable(9),In.iridescence&&K.enable(10),In.alphaTest&&K.enable(11),In.vertexColors&&K.enable(12),In.vertexAlphas&&K.enable(13),In.vertexUv1s&&K.enable(14),In.vertexUv2s&&K.enable(15),In.vertexUv3s&&K.enable(16),In.vertexTangents&&K.enable(17),In.anisotropy&&K.enable(18),In.alphaHash&&K.enable(19),In.batching&&K.enable(20),Nt.push(K.mask),K.disableAll(),In.fog&&K.enable(0),In.useFog&&K.enable(1),In.flatShading&&K.enable(2),In.logarithmicDepthBuffer&&K.enable(3),In.skinning&&K.enable(4),In.morphTargets&&K.enable(5),In.morphNormals&&K.enable(6),In.morphColors&&K.enable(7),In.premultipliedAlpha&&K.enable(8),In.shadowMapEnabled&&K.enable(9),In.useLegacyLights&&K.enable(10),In.doubleSided&&K.enable(11),In.flipSided&&K.enable(12),In.useDepthPacking&&K.enable(13),In.dithering&&K.enable(14),In.transmission&&K.enable(15),In.sheen&&K.enable(16),In.opaque&&K.enable(17),In.pointsUvs&&K.enable(18),In.decodeVideoTexture&&K.enable(19),In.alphaToCoverage&&K.enable(20),Nt.push(K.mask)}(In,Nt),In.push(M.outputColorSpace)),In.push(Nt.customProgramCacheKey),In.join()},getUniforms:function kn(Nt){const In=bt[Nt.type];let dr;return dr=In?Al.clone(fh[In].uniforms):Nt.uniforms,dr},acquireProgram:function bn(Nt,In){let dr;for(let hr=0,ei=Me.length;hr<ei;hr++){const Yi=Me[hr];if(Yi.cacheKey===In){dr=Yi,++dr.usedTimes;break}}return void 0===dr&&(dr=new id(M,In,Nt,E),Me.push(dr)),dr},releaseProgram:function wn(Nt){if(0==--Nt.usedTimes){const In=Me.indexOf(Nt);Me[In]=Me[Me.length-1],Me.pop(),Nt.destroy()}},releaseShaderCache:function $n(Nt){de.remove(Nt)},programs:Me,dispose:function wi(){de.dispose()}}}function E_(){let M=new WeakMap;return{get:function a(E){let H=M.get(E);return void 0===H&&(H={},M.set(E,H)),H},remove:function c(E){M.delete(E)},update:function h(E,H,K){M.get(E)[H]=K},dispose:function p(){M=new WeakMap}}}function Ym(M,a){return M.groupOrder!==a.groupOrder?M.groupOrder-a.groupOrder:M.renderOrder!==a.renderOrder?M.renderOrder-a.renderOrder:M.material.id!==a.material.id?M.material.id-a.material.id:M.z!==a.z?M.z-a.z:M.id-a.id}function Km(M,a){return M.groupOrder!==a.groupOrder?M.groupOrder-a.groupOrder:M.renderOrder!==a.renderOrder?M.renderOrder-a.renderOrder:M.z!==a.z?a.z-M.z:M.id-a.id}function Ah(){const M=[];let a=0;const c=[],h=[],p=[];function H(Le,Be,Ge,it,bt,Ye){let qe=M[a];return void 0===qe?(qe={id:Le.id,object:Le,geometry:Be,material:Ge,groupOrder:it,renderOrder:Le.renderOrder,z:bt,group:Ye},M[a]=qe):(qe.id=Le.id,qe.object=Le,qe.geometry=Be,qe.material=Ge,qe.groupOrder=it,qe.renderOrder=Le.renderOrder,qe.z=bt,qe.group=Ye),a++,qe}return{opaque:c,transmissive:h,transparent:p,init:function E(){a=0,c.length=0,h.length=0,p.length=0},push:function K(Le,Be,Ge,it,bt,Ye){const qe=H(Le,Be,Ge,it,bt,Ye);Ge.transmission>0?h.push(qe):!0===Ge.transparent?p.push(qe):c.push(qe)},unshift:function de(Le,Be,Ge,it,bt,Ye){const qe=H(Le,Be,Ge,it,bt,Ye);Ge.transmission>0?h.unshift(qe):!0===Ge.transparent?p.unshift(qe):c.unshift(qe)},finish:function Me(){for(let Le=a,Be=M.length;Le<Be;Le++){const Ge=M[Le];if(null===Ge.id)break;Ge.id=null,Ge.object=null,Ge.geometry=null,Ge.material=null,Ge.group=null}},sort:function ge(Le,Be){c.length>1&&c.sort(Le||Ym),h.length>1&&h.sort(Be||Km),p.length>1&&p.sort(Be||Km)}}}function u0(){let M=new WeakMap;return{get:function a(h,p){const E=M.get(h);let H;return void 0===E?(H=new Ah,M.set(h,[H])):p>=E.length?(H=new Ah,E.push(H)):H=E[p],H},dispose:function c(){M=new WeakMap}}}function h0(){const M={};return{get:function(a){if(void 0!==M[a.id])return M[a.id];let c;switch(a.type){case"DirectionalLight":c={direction:new Dn,color:new to};break;case"SpotLight":c={position:new Dn,direction:new Dn,color:new to,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new Dn,color:new to,distance:0,decay:0};break;case"HemisphereLight":c={direction:new Dn,skyColor:new to,groundColor:new to};break;case"RectAreaLight":c={color:new to,position:new Dn,halfWidth:new Dn,halfHeight:new Dn}}return M[a.id]=c,c}}}let Bs=0;function ga(M,a){return(a.castShadow?2:0)-(M.castShadow?2:0)+(a.map?1:0)-(M.map?1:0)}function Ha(M,a){const c=new h0,h=function Sf(){const M={};return{get:function(a){if(void 0!==M[a.id])return M[a.id];let c;switch(a.type){case"DirectionalLight":case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Si};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Si,shadowCameraNear:1,shadowCameraFar:1e3}}return M[a.id]=c,c}}}(),p={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let Me=0;Me<9;Me++)p.probe.push(new Dn);const E=new Dn,H=new lo,K=new lo;return{setup:function de(Me,Le){let Be=0,Ge=0,it=0;for(let dr=0;dr<9;dr++)p.probe[dr].set(0,0,0);let bt=0,Ye=0,qe=0,Ft=0,mt=0,Ut=0,kn=0,bn=0,wn=0,$n=0,wi=0;Me.sort(ga);const Nt=!0===Le?Math.PI:1;for(let dr=0,hr=Me.length;dr<hr;dr++){const ei=Me[dr],Yi=ei.color,Pi=ei.intensity,or=ei.distance,rr=ei.shadow&&ei.shadow.map?ei.shadow.map.texture:null;if(ei.isAmbientLight)Be+=Yi.r*Pi*Nt,Ge+=Yi.g*Pi*Nt,it+=Yi.b*Pi*Nt;else if(ei.isLightProbe){for(let nr=0;nr<9;nr++)p.probe[nr].addScaledVector(ei.sh.coefficients[nr],Pi);wi++}else if(ei.isDirectionalLight){const nr=c.get(ei);if(nr.color.copy(ei.color).multiplyScalar(ei.intensity*Nt),ei.castShadow){const Gr=ei.shadow,zr=h.get(ei);zr.shadowBias=Gr.bias,zr.shadowNormalBias=Gr.normalBias,zr.shadowRadius=Gr.radius,zr.shadowMapSize=Gr.mapSize,p.directionalShadow[bt]=zr,p.directionalShadowMap[bt]=rr,p.directionalShadowMatrix[bt]=ei.shadow.matrix,Ut++}p.directional[bt]=nr,bt++}else if(ei.isSpotLight){const nr=c.get(ei);nr.position.setFromMatrixPosition(ei.matrixWorld),nr.color.copy(Yi).multiplyScalar(Pi*Nt),nr.distance=or,nr.coneCos=Math.cos(ei.angle),nr.penumbraCos=Math.cos(ei.angle*(1-ei.penumbra)),nr.decay=ei.decay,p.spot[qe]=nr;const Gr=ei.shadow;if(ei.map&&(p.spotLightMap[wn]=ei.map,wn++,Gr.updateMatrices(ei),ei.castShadow&&$n++),p.spotLightMatrix[qe]=Gr.matrix,ei.castShadow){const zr=h.get(ei);zr.shadowBias=Gr.bias,zr.shadowNormalBias=Gr.normalBias,zr.shadowRadius=Gr.radius,zr.shadowMapSize=Gr.mapSize,p.spotShadow[qe]=zr,p.spotShadowMap[qe]=rr,bn++}qe++}else if(ei.isRectAreaLight){const nr=c.get(ei);nr.color.copy(Yi).multiplyScalar(Pi),nr.halfWidth.set(.5*ei.width,0,0),nr.halfHeight.set(0,.5*ei.height,0),p.rectArea[Ft]=nr,Ft++}else if(ei.isPointLight){const nr=c.get(ei);if(nr.color.copy(ei.color).multiplyScalar(ei.intensity*Nt),nr.distance=ei.distance,nr.decay=ei.decay,ei.castShadow){const Gr=ei.shadow,zr=h.get(ei);zr.shadowBias=Gr.bias,zr.shadowNormalBias=Gr.normalBias,zr.shadowRadius=Gr.radius,zr.shadowMapSize=Gr.mapSize,zr.shadowCameraNear=Gr.camera.near,zr.shadowCameraFar=Gr.camera.far,p.pointShadow[Ye]=zr,p.pointShadowMap[Ye]=rr,p.pointShadowMatrix[Ye]=ei.shadow.matrix,kn++}p.point[Ye]=nr,Ye++}else if(ei.isHemisphereLight){const nr=c.get(ei);nr.skyColor.copy(ei.color).multiplyScalar(Pi*Nt),nr.groundColor.copy(ei.groundColor).multiplyScalar(Pi*Nt),p.hemi[mt]=nr,mt++}}Ft>0&&(a.isWebGL2?!0===M.has("OES_texture_float_linear")?(p.rectAreaLTC1=qr.LTC_FLOAT_1,p.rectAreaLTC2=qr.LTC_FLOAT_2):(p.rectAreaLTC1=qr.LTC_HALF_1,p.rectAreaLTC2=qr.LTC_HALF_2):!0===M.has("OES_texture_float_linear")?(p.rectAreaLTC1=qr.LTC_FLOAT_1,p.rectAreaLTC2=qr.LTC_FLOAT_2):!0===M.has("OES_texture_half_float_linear")?(p.rectAreaLTC1=qr.LTC_HALF_1,p.rectAreaLTC2=qr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),p.ambient[0]=Be,p.ambient[1]=Ge,p.ambient[2]=it;const In=p.hash;(In.directionalLength!==bt||In.pointLength!==Ye||In.spotLength!==qe||In.rectAreaLength!==Ft||In.hemiLength!==mt||In.numDirectionalShadows!==Ut||In.numPointShadows!==kn||In.numSpotShadows!==bn||In.numSpotMaps!==wn||In.numLightProbes!==wi)&&(p.directional.length=bt,p.spot.length=qe,p.rectArea.length=Ft,p.point.length=Ye,p.hemi.length=mt,p.directionalShadow.length=Ut,p.directionalShadowMap.length=Ut,p.pointShadow.length=kn,p.pointShadowMap.length=kn,p.spotShadow.length=bn,p.spotShadowMap.length=bn,p.directionalShadowMatrix.length=Ut,p.pointShadowMatrix.length=kn,p.spotLightMatrix.length=bn+wn-$n,p.spotLightMap.length=wn,p.numSpotLightShadowsWithMaps=$n,p.numLightProbes=wi,In.directionalLength=bt,In.pointLength=Ye,In.spotLength=qe,In.rectAreaLength=Ft,In.hemiLength=mt,In.numDirectionalShadows=Ut,In.numPointShadows=kn,In.numSpotShadows=bn,In.numSpotMaps=wn,In.numLightProbes=wi,p.version=Bs++)},setupView:function ge(Me,Le){let Be=0,Ge=0,it=0,bt=0,Ye=0;const qe=Le.matrixWorldInverse;for(let Ft=0,mt=Me.length;Ft<mt;Ft++){const Ut=Me[Ft];if(Ut.isDirectionalLight){const kn=p.directional[Be];kn.direction.setFromMatrixPosition(Ut.matrixWorld),E.setFromMatrixPosition(Ut.target.matrixWorld),kn.direction.sub(E),kn.direction.transformDirection(qe),Be++}else if(Ut.isSpotLight){const kn=p.spot[it];kn.position.setFromMatrixPosition(Ut.matrixWorld),kn.position.applyMatrix4(qe),kn.direction.setFromMatrixPosition(Ut.matrixWorld),E.setFromMatrixPosition(Ut.target.matrixWorld),kn.direction.sub(E),kn.direction.transformDirection(qe),it++}else if(Ut.isRectAreaLight){const kn=p.rectArea[bt];kn.position.setFromMatrixPosition(Ut.matrixWorld),kn.position.applyMatrix4(qe),K.identity(),H.copy(Ut.matrixWorld),H.premultiply(qe),K.extractRotation(H),kn.halfWidth.set(.5*Ut.width,0,0),kn.halfHeight.set(0,.5*Ut.height,0),kn.halfWidth.applyMatrix4(K),kn.halfHeight.applyMatrix4(K),bt++}else if(Ut.isPointLight){const kn=p.point[Ge];kn.position.setFromMatrixPosition(Ut.matrixWorld),kn.position.applyMatrix4(qe),Ge++}else if(Ut.isHemisphereLight){const kn=p.hemi[Ye];kn.direction.setFromMatrixPosition(Ut.matrixWorld),kn.direction.transformDirection(qe),Ye++}}},state:p}}function kr(M,a){const c=new Ha(M,a),h=[],p=[];return{init:function E(){h.length=0,p.length=0},state:{lightsArray:h,shadowsArray:p,lights:c},setupLights:function de(Le){c.setup(h,Le)},setupLightsView:function ge(Le){c.setupView(h,Le)},pushLight:function H(Le){h.push(Le)},pushShadow:function K(Le){p.push(Le)}}}function Uu(M,a){let c=new WeakMap;return{get:function h(E,H=0){const K=c.get(E);let de;return void 0===K?(de=new kr(M,a),c.set(E,[de])):H>=K.length?(de=new kr(M,a),K.push(de)):de=K[H],de},dispose:function p(){c=new WeakMap}}}class ha extends Ic{constructor(a){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(a)}copy(a){return super.copy(a),this.depthPacking=a.depthPacking,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this}}class dc extends Ic{constructor(a){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(a)}copy(a){return super.copy(a),this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this}}function Yx(M,a,c){let h=new BA;const p=new Si,E=new Si,H=new Za,K=new ha({depthPacking:3201}),de=new dc,ge={},Me=c.maxTextureSize,Le={[O]:1,1:O,[ie]:ie},Be=new Pc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Si},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),Ge=Be.clone();Ge.defines.HORIZONTAL_PASS=1;const it=new us;it.setAttribute("position",new pl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const bt=new gl(it,Be),Ye=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Re;let qe=this.type;function Ft(bn,wn){const $n=a.update(bt);Be.defines.VSM_SAMPLES!==bn.blurSamples&&(Be.defines.VSM_SAMPLES=bn.blurSamples,Ge.defines.VSM_SAMPLES=bn.blurSamples,Be.needsUpdate=!0,Ge.needsUpdate=!0),null===bn.mapPass&&(bn.mapPass=new ku(p.x,p.y)),Be.uniforms.shadow_pass.value=bn.map.texture,Be.uniforms.resolution.value=bn.mapSize,Be.uniforms.radius.value=bn.radius,M.setRenderTarget(bn.mapPass),M.clear(),M.renderBufferDirect(wn,null,$n,Be,bt,null),Ge.uniforms.shadow_pass.value=bn.mapPass.texture,Ge.uniforms.resolution.value=bn.mapSize,Ge.uniforms.radius.value=bn.radius,M.setRenderTarget(bn.map),M.clear(),M.renderBufferDirect(wn,null,$n,Ge,bt,null)}function mt(bn,wn,$n,wi){let Nt=null;const In=!0===$n.isPointLight?bn.customDistanceMaterial:bn.customDepthMaterial;if(void 0!==In)Nt=In;else if(Nt=!0===$n.isPointLight?de:K,M.localClippingEnabled&&!0===wn.clipShadows&&Array.isArray(wn.clippingPlanes)&&0!==wn.clippingPlanes.length||wn.displacementMap&&0!==wn.displacementScale||wn.alphaMap&&wn.alphaTest>0||wn.map&&wn.alphaTest>0){const dr=Nt.uuid,hr=wn.uuid;let ei=ge[dr];void 0===ei&&(ei={},ge[dr]=ei);let Yi=ei[hr];void 0===Yi&&(Yi=Nt.clone(),ei[hr]=Yi,wn.addEventListener("dispose",kn)),Nt=Yi}return Nt.visible=wn.visible,Nt.wireframe=wn.wireframe,Nt.side=wi===Ie?null!==wn.shadowSide?wn.shadowSide:wn.side:null!==wn.shadowSide?wn.shadowSide:Le[wn.side],Nt.alphaMap=wn.alphaMap,Nt.alphaTest=wn.alphaTest,Nt.map=wn.map,Nt.clipShadows=wn.clipShadows,Nt.clippingPlanes=wn.clippingPlanes,Nt.clipIntersection=wn.clipIntersection,Nt.displacementMap=wn.displacementMap,Nt.displacementScale=wn.displacementScale,Nt.displacementBias=wn.displacementBias,Nt.wireframeLinewidth=wn.wireframeLinewidth,Nt.linewidth=wn.linewidth,!0===$n.isPointLight&&!0===Nt.isMeshDistanceMaterial&&(M.properties.get(Nt).light=$n),Nt}function Ut(bn,wn,$n,wi,Nt){if(!1===bn.visible)return;if(bn.layers.test(wn.layers)&&(bn.isMesh||bn.isLine||bn.isPoints)&&(bn.castShadow||bn.receiveShadow&&Nt===Ie)&&(!bn.frustumCulled||h.intersectsObject(bn))){bn.modelViewMatrix.multiplyMatrices($n.matrixWorldInverse,bn.matrixWorld);const hr=a.update(bn),ei=bn.material;if(Array.isArray(ei)){const Yi=hr.groups;for(let Pi=0,or=Yi.length;Pi<or;Pi++){const rr=Yi[Pi],nr=ei[rr.materialIndex];if(nr&&nr.visible){const Gr=mt(bn,nr,wi,Nt);bn.onBeforeShadow(M,bn,wn,$n,hr,Gr,rr),M.renderBufferDirect($n,null,hr,Gr,bn,rr),bn.onAfterShadow(M,bn,wn,$n,hr,Gr,rr)}}}else if(ei.visible){const Yi=mt(bn,ei,wi,Nt);bn.onBeforeShadow(M,bn,wn,$n,hr,Yi,null),M.renderBufferDirect($n,null,hr,Yi,bn,null),bn.onAfterShadow(M,bn,wn,$n,hr,Yi,null)}}const dr=bn.children;for(let hr=0,ei=dr.length;hr<ei;hr++)Ut(dr[hr],wn,$n,wi,Nt)}function kn(bn){bn.target.removeEventListener("dispose",kn);for(const $n in ge){const wi=ge[$n],Nt=bn.target.uuid;Nt in wi&&(wi[Nt].dispose(),delete wi[Nt])}}this.render=function(bn,wn,$n){if(!1===Ye.enabled||!1===Ye.autoUpdate&&!1===Ye.needsUpdate||0===bn.length)return;const wi=M.getRenderTarget(),Nt=M.getActiveCubeFace(),In=M.getActiveMipmapLevel(),dr=M.state;dr.setBlending(he),dr.buffers.color.setClear(1,1,1,1),dr.buffers.depth.setTest(!0),dr.setScissorTest(!1);const hr=qe!==Ie&&this.type===Ie,ei=qe===Ie&&this.type!==Ie;for(let Yi=0,Pi=bn.length;Yi<Pi;Yi++){const or=bn[Yi],rr=or.shadow;if(void 0===rr){console.warn("THREE.WebGLShadowMap:",or,"has no shadow.");continue}if(!1===rr.autoUpdate&&!1===rr.needsUpdate)continue;p.copy(rr.mapSize);const nr=rr.getFrameExtents();if(p.multiply(nr),E.copy(rr.mapSize),(p.x>Me||p.y>Me)&&(p.x>Me&&(E.x=Math.floor(Me/nr.x),p.x=E.x*nr.x,rr.mapSize.x=E.x),p.y>Me&&(E.y=Math.floor(Me/nr.y),p.y=E.y*nr.y,rr.mapSize.y=E.y)),null===rr.map||!0===hr||!0===ei){const zr=this.type!==Ie?{minFilter:Xi,magFilter:Xi}:{};null!==rr.map&&rr.map.dispose(),rr.map=new ku(p.x,p.y,zr),rr.map.texture.name=or.name+".shadowMap",rr.camera.updateProjectionMatrix()}M.setRenderTarget(rr.map),M.clear();const Gr=rr.getViewportCount();for(let zr=0;zr<Gr;zr++){const Ps=rr.getViewport(zr);H.set(E.x*Ps.x,E.y*Ps.y,E.x*Ps.z,E.y*Ps.w),dr.viewport(H),rr.updateMatrices(or,zr),h=rr.getFrustum(),Ut(wn,$n,rr.camera,or,this.type)}!0!==rr.isPointLightShadow&&this.type===Ie&&Ft(rr,$n),rr.needsUpdate=!1}qe=this.type,Ye.needsUpdate=!1,M.setRenderTarget(wi,Nt,In)}}function NB(M,a,c){const h=c.isWebGL2,K=new function p(){let oi=!1;const gs=new Za;let Ri=null;const ns=new Za(0,0,0,0);return{setMask:function(bs){Ri!==bs&&!oi&&(M.colorMask(bs,bs,bs,bs),Ri=bs)},setLocked:function(bs){oi=bs},setClear:function(bs,Fa,zl,Jd,Df){!0===Df&&(bs*=Jd,Fa*=Jd,zl*=Jd),gs.set(bs,Fa,zl,Jd),!1===ns.equals(gs)&&(M.clearColor(bs,Fa,zl,Jd),ns.copy(gs))},reset:function(){oi=!1,Ri=null,ns.set(-1,0,0,0)}}},de=new function E(){let oi=!1,gs=null,Ri=null,ns=null;return{setTest:function(bs){bs?$s(M.DEPTH_TEST):_a(M.DEPTH_TEST)},setMask:function(bs){gs!==bs&&!oi&&(M.depthMask(bs),gs=bs)},setFunc:function(bs){if(Ri!==bs){switch(bs){case 0:M.depthFunc(M.NEVER);break;case 1:M.depthFunc(M.ALWAYS);break;case 2:M.depthFunc(M.LESS);break;case 3:default:M.depthFunc(M.LEQUAL);break;case 4:M.depthFunc(M.EQUAL);break;case 5:M.depthFunc(M.GEQUAL);break;case 6:M.depthFunc(M.GREATER);break;case 7:M.depthFunc(M.NOTEQUAL)}Ri=bs}},setLocked:function(bs){oi=bs},setClear:function(bs){ns!==bs&&(M.clearDepth(bs),ns=bs)},reset:function(){oi=!1,gs=null,Ri=null,ns=null}}},ge=new function H(){let oi=!1,gs=null,Ri=null,ns=null,bs=null,Fa=null,zl=null,Jd=null,Df=null;return{setTest:function(Ql){oi||(Ql?$s(M.STENCIL_TEST):_a(M.STENCIL_TEST))},setMask:function(Ql){gs!==Ql&&!oi&&(M.stencilMask(Ql),gs=Ql)},setFunc:function(Ql,yh,lm){(Ri!==Ql||ns!==yh||bs!==lm)&&(M.stencilFunc(Ql,yh,lm),Ri=Ql,ns=yh,bs=lm)},setOp:function(Ql,yh,lm){(Fa!==Ql||zl!==yh||Jd!==lm)&&(M.stencilOp(Ql,yh,lm),Fa=Ql,zl=yh,Jd=lm)},setLocked:function(Ql){oi=Ql},setClear:function(Ql){Df!==Ql&&(M.clearStencil(Ql),Df=Ql)},reset:function(){oi=!1,gs=null,Ri=null,ns=null,bs=null,Fa=null,zl=null,Jd=null,Df=null}}},Me=new WeakMap,Le=new WeakMap;let Be={},Ge={},it=new WeakMap,bt=[],Ye=null,qe=!1,Ft=null,mt=null,Ut=null,kn=null,bn=null,wn=null,$n=null,wi=new to(0,0,0),Nt=0,In=!1,dr=null,hr=null,ei=null,Yi=null,Pi=null;const or=M.getParameter(M.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let rr=!1,nr=0;const Gr=M.getParameter(M.VERSION);-1!==Gr.indexOf("WebGL")?(nr=parseFloat(/^WebGL (\d)/.exec(Gr)[1]),rr=nr>=1):-1!==Gr.indexOf("OpenGL ES")&&(nr=parseFloat(/^OpenGL ES (\d)/.exec(Gr)[1]),rr=nr>=2);let zr=null,Ps={};const Jo=M.getParameter(M.SCISSOR_BOX),Li=M.getParameter(M.VIEWPORT),Br=(new Za).fromArray(Jo),Rs=(new Za).fromArray(Li);function co(oi,gs,Ri,ns){const bs=new Uint8Array(4),Fa=M.createTexture();M.bindTexture(oi,Fa),M.texParameteri(oi,M.TEXTURE_MIN_FILTER,M.NEAREST),M.texParameteri(oi,M.TEXTURE_MAG_FILTER,M.NEAREST);for(let zl=0;zl<Ri;zl++)!h||oi!==M.TEXTURE_3D&&oi!==M.TEXTURE_2D_ARRAY?M.texImage2D(gs+zl,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,bs):M.texImage3D(gs,0,M.RGBA,1,1,ns,0,M.RGBA,M.UNSIGNED_BYTE,bs);return Fa}const no={};function $s(oi){!0!==Be[oi]&&(M.enable(oi),Be[oi]=!0)}function _a(oi){!1!==Be[oi]&&(M.disable(oi),Be[oi]=!1)}no[M.TEXTURE_2D]=co(M.TEXTURE_2D,M.TEXTURE_2D,1),no[M.TEXTURE_CUBE_MAP]=co(M.TEXTURE_CUBE_MAP,M.TEXTURE_CUBE_MAP_POSITIVE_X,6),h&&(no[M.TEXTURE_2D_ARRAY]=co(M.TEXTURE_2D_ARRAY,M.TEXTURE_2D_ARRAY,1,1),no[M.TEXTURE_3D]=co(M.TEXTURE_3D,M.TEXTURE_3D,1,1)),K.setClear(0,0,0,1),de.setClear(1),ge.setClear(0),$s(M.DEPTH_TEST),de.setFunc(3),Ds(!1),eo(1),$s(M.CULL_FACE),_r(he);const lr={[D]:M.FUNC_ADD,101:M.FUNC_SUBTRACT,102:M.FUNC_REVERSE_SUBTRACT};if(h)lr[103]=M.MIN,lr[104]=M.MAX;else{const oi=a.get("EXT_blend_minmax");null!==oi&&(lr[103]=oi.MIN_EXT,lr[104]=oi.MAX_EXT)}const Yr={200:M.ZERO,201:M.ONE,202:M.SRC_COLOR,204:M.SRC_ALPHA,210:M.SRC_ALPHA_SATURATE,208:M.DST_COLOR,206:M.DST_ALPHA,203:M.ONE_MINUS_SRC_COLOR,205:M.ONE_MINUS_SRC_ALPHA,209:M.ONE_MINUS_DST_COLOR,207:M.ONE_MINUS_DST_ALPHA,211:M.CONSTANT_COLOR,212:M.ONE_MINUS_CONSTANT_COLOR,213:M.CONSTANT_ALPHA,214:M.ONE_MINUS_CONSTANT_ALPHA};function _r(oi,gs,Ri,ns,bs,Fa,zl,Jd,Df,Ql){if(oi!==he){if(!1===qe&&($s(M.BLEND),qe=!0),5===oi)bs=bs||gs,Fa=Fa||Ri,zl=zl||ns,(gs!==mt||bs!==bn)&&(M.blendEquationSeparate(lr[gs],lr[bs]),mt=gs,bn=bs),(Ri!==Ut||ns!==kn||Fa!==wn||zl!==$n)&&(M.blendFuncSeparate(Yr[Ri],Yr[ns],Yr[Fa],Yr[zl]),Ut=Ri,kn=ns,wn=Fa,$n=zl),(!1===Jd.equals(wi)||Df!==Nt)&&(M.blendColor(Jd.r,Jd.g,Jd.b,Df),wi.copy(Jd),Nt=Df),Ft=oi,In=!1;else if(oi!==Ft||Ql!==In){if((mt!==D||bn!==D)&&(M.blendEquation(M.FUNC_ADD),mt=D,bn=D),Ql)switch(oi){case 1:M.blendFuncSeparate(M.ONE,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA);break;case fe:M.blendFunc(M.ONE,M.ONE);break;case 3:M.blendFuncSeparate(M.ZERO,M.ONE_MINUS_SRC_COLOR,M.ZERO,M.ONE);break;case 4:M.blendFuncSeparate(M.ZERO,M.SRC_COLOR,M.ZERO,M.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",oi)}else switch(oi){case 1:M.blendFuncSeparate(M.SRC_ALPHA,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA);break;case fe:M.blendFunc(M.SRC_ALPHA,M.ONE);break;case 3:M.blendFuncSeparate(M.ZERO,M.ONE_MINUS_SRC_COLOR,M.ZERO,M.ONE);break;case 4:M.blendFunc(M.ZERO,M.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",oi)}Ut=null,kn=null,wn=null,$n=null,wi.set(0,0,0),Nt=0,Ft=oi,In=Ql}}else!0===qe&&(_a(M.BLEND),qe=!1)}function Ds(oi){dr!==oi&&(M.frontFace(oi?M.CW:M.CCW),dr=oi)}function eo(oi){0!==oi?($s(M.CULL_FACE),oi!==hr&&M.cullFace(1===oi?M.BACK:2===oi?M.FRONT:M.FRONT_AND_BACK)):_a(M.CULL_FACE),hr=oi}function _n(oi,gs,Ri){oi?($s(M.POLYGON_OFFSET_FILL),(Yi!==gs||Pi!==Ri)&&(M.polygonOffset(gs,Ri),Yi=gs,Pi=Ri)):_a(M.POLYGON_OFFSET_FILL)}return{buffers:{color:K,depth:de,stencil:ge},enable:$s,disable:_a,bindFramebuffer:function uo(oi,gs){return Ge[oi]!==gs&&(M.bindFramebuffer(oi,gs),Ge[oi]=gs,h&&(oi===M.DRAW_FRAMEBUFFER&&(Ge[M.FRAMEBUFFER]=gs),oi===M.FRAMEBUFFER&&(Ge[M.DRAW_FRAMEBUFFER]=gs)),!0)},drawBuffers:function Nn(oi,gs){let Ri=bt,ns=!1;if(oi){Ri=it.get(gs),void 0===Ri&&(Ri=[],it.set(gs,Ri));const bs=oi.textures;if(Ri.length!==bs.length||Ri[0]!==M.COLOR_ATTACHMENT0){for(let Fa=0,zl=bs.length;Fa<zl;Fa++)Ri[Fa]=M.COLOR_ATTACHMENT0+Fa;Ri.length=bs.length,ns=!0}}else Ri[0]!==M.BACK&&(Ri[0]=M.BACK,ns=!0);if(ns)if(c.isWebGL2)M.drawBuffers(Ri);else{if(!0!==a.has("WEBGL_draw_buffers"))throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension");a.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ri)}},useProgram:function Jr(oi){return Ye!==oi&&(M.useProgram(oi),Ye=oi,!0)},setBlending:_r,setMaterial:function zs(oi,gs){oi.side===ie?_a(M.CULL_FACE):$s(M.CULL_FACE);let Ri=1===oi.side;gs&&(Ri=!Ri),Ds(Ri),1===oi.blending&&!1===oi.transparent?_r(he):_r(oi.blending,oi.blendEquation,oi.blendSrc,oi.blendDst,oi.blendEquationAlpha,oi.blendSrcAlpha,oi.blendDstAlpha,oi.blendColor,oi.blendAlpha,oi.premultipliedAlpha),de.setFunc(oi.depthFunc),de.setTest(oi.depthTest),de.setMask(oi.depthWrite),K.setMask(oi.colorWrite);const ns=oi.stencilWrite;ge.setTest(ns),ns&&(ge.setMask(oi.stencilWriteMask),ge.setFunc(oi.stencilFunc,oi.stencilRef,oi.stencilFuncMask),ge.setOp(oi.stencilFail,oi.stencilZFail,oi.stencilZPass)),_n(oi.polygonOffset,oi.polygonOffsetFactor,oi.polygonOffsetUnits),!0===oi.alphaToCoverage?$s(M.SAMPLE_ALPHA_TO_COVERAGE):_a(M.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ds,setCullFace:eo,setLineWidth:function Va(oi){oi!==ei&&(rr&&M.lineWidth(oi),ei=oi)},setPolygonOffset:_n,setScissorTest:function Gt(oi){oi?$s(M.SCISSOR_TEST):_a(M.SCISSOR_TEST)},activeTexture:function ji(oi){void 0===oi&&(oi=M.TEXTURE0+or-1),zr!==oi&&(M.activeTexture(oi),zr=oi)},bindTexture:function Zi(oi,gs,Ri){void 0===Ri&&(Ri=null===zr?M.TEXTURE0+or-1:zr);let ns=Ps[Ri];void 0===ns&&(ns={type:void 0,texture:void 0},Ps[Ri]=ns),(ns.type!==oi||ns.texture!==gs)&&(zr!==Ri&&(M.activeTexture(Ri),zr=Ri),M.bindTexture(oi,gs||no[oi]),ns.type=oi,ns.texture=gs)},unbindTexture:function Fr(){const oi=Ps[zr];void 0!==oi&&void 0!==oi.type&&(M.bindTexture(oi.type,null),oi.type=void 0,oi.texture=void 0)},compressedTexImage2D:function Cr(){try{M.compressedTexImage2D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},compressedTexImage3D:function ea(){try{M.compressedTexImage3D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},texImage2D:function Ga(){try{M.texImage2D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},texImage3D:function Eo(){try{M.texImage3D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},updateUBOMapping:function tl(oi,gs){let Ri=Le.get(gs);void 0===Ri&&(Ri=new WeakMap,Le.set(gs,Ri));let ns=Ri.get(oi);void 0===ns&&(ns=M.getUniformBlockIndex(gs,oi.name),Ri.set(oi,ns))},uniformBlockBinding:function la(oi,gs){const ns=Le.get(gs).get(oi);Me.get(gs)!==ns&&(M.uniformBlockBinding(gs,ns,oi.__bindingPointIndex),Me.set(gs,ns))},texStorage2D:function Wr(){try{M.texStorage2D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},texStorage3D:function md(){try{M.texStorage3D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},texSubImage2D:function Oo(){try{M.texSubImage2D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},texSubImage3D:function ts(){try{M.texSubImage3D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},compressedTexSubImage2D:function fs(){try{M.compressedTexSubImage2D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},compressedTexSubImage3D:function ta(){try{M.compressedTexSubImage3D.apply(M,arguments)}catch(oi){console.error("THREE.WebGLState:",oi)}},scissor:function so(oi){!1===Br.equals(oi)&&(M.scissor(oi.x,oi.y,oi.z,oi.w),Br.copy(oi))},viewport:function oo(oi){!1===Rs.equals(oi)&&(M.viewport(oi.x,oi.y,oi.z,oi.w),Rs.copy(oi))},reset:function ec(){M.disable(M.BLEND),M.disable(M.CULL_FACE),M.disable(M.DEPTH_TEST),M.disable(M.POLYGON_OFFSET_FILL),M.disable(M.SCISSOR_TEST),M.disable(M.STENCIL_TEST),M.disable(M.SAMPLE_ALPHA_TO_COVERAGE),M.blendEquation(M.FUNC_ADD),M.blendFunc(M.ONE,M.ZERO),M.blendFuncSeparate(M.ONE,M.ZERO,M.ONE,M.ZERO),M.blendColor(0,0,0,0),M.colorMask(!0,!0,!0,!0),M.clearColor(0,0,0,0),M.depthMask(!0),M.depthFunc(M.LESS),M.clearDepth(1),M.stencilMask(4294967295),M.stencilFunc(M.ALWAYS,0,4294967295),M.stencilOp(M.KEEP,M.KEEP,M.KEEP),M.clearStencil(0),M.cullFace(M.BACK),M.frontFace(M.CCW),M.polygonOffset(0,0),M.activeTexture(M.TEXTURE0),M.bindFramebuffer(M.FRAMEBUFFER,null),!0===h&&(M.bindFramebuffer(M.DRAW_FRAMEBUFFER,null),M.bindFramebuffer(M.READ_FRAMEBUFFER,null)),M.useProgram(null),M.lineWidth(1),M.scissor(0,0,M.canvas.width,M.canvas.height),M.viewport(0,0,M.canvas.width,M.canvas.height),Be={},zr=null,Ps={},Ge={},it=new WeakMap,bt=[],Ye=null,qe=!1,Ft=null,mt=null,Ut=null,kn=null,bn=null,wn=null,$n=null,wi=new to(0,0,0),Nt=0,In=!1,dr=null,hr=null,ei=null,Yi=null,Pi=null,Br.set(0,0,M.canvas.width,M.canvas.height),Rs.set(0,0,M.canvas.width,M.canvas.height),K.reset(),de.reset(),ge.reset()}}}function UB(M,a,c,h,p,E,H){const K=p.isWebGL2,de=a.has("WEBGL_multisampled_render_to_texture")?a.get("WEBGL_multisampled_render_to_texture"):null,ge=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),Me=new Si,Le=new WeakMap;let Be;const Ge=new WeakMap;let it=!1;try{it=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function bt(_n,Gt){return it?new OffscreenCanvas(_n,Gt):Ed("canvas")}function Ye(_n,Gt,ji,Zi){let Fr=1;const Cr=Va(_n);if((Cr.width>Zi||Cr.height>Zi)&&(Fr=Zi/Math.max(Cr.width,Cr.height)),Fr<1||!0===Gt){if(typeof HTMLImageElement<"u"&&_n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_n instanceof ImageBitmap||typeof VideoFrame<"u"&&_n instanceof VideoFrame){const ea=Gt?Ll:Math.floor,Oo=ea(Fr*Cr.width),ts=ea(Fr*Cr.height);void 0===Be&&(Be=bt(Oo,ts));const fs=ji?bt(Oo,ts):Be;return fs.width=Oo,fs.height=ts,fs.getContext("2d").drawImage(_n,0,0,Oo,ts),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Cr.width+"x"+Cr.height+") to ("+Oo+"x"+ts+")."),fs}return"data"in _n&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Cr.width+"x"+Cr.height+")."),_n}return _n}function qe(_n){const Gt=Va(_n);return Zu(Gt.width)&&Zu(Gt.height)}function mt(_n,Gt){return _n.generateMipmaps&&Gt&&_n.minFilter!==Xi&&_n.minFilter!==wt}function Ut(_n){M.generateMipmap(_n)}function kn(_n,Gt,ji,Zi,Fr=!1){if(!1===K)return Gt;if(null!==_n){if(void 0!==M[_n])return M[_n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+_n+"'")}let Cr=Gt;if(Gt===M.RED&&(ji===M.FLOAT&&(Cr=M.R32F),ji===M.HALF_FLOAT&&(Cr=M.R16F),ji===M.UNSIGNED_BYTE&&(Cr=M.R8)),Gt===M.RED_INTEGER&&(ji===M.UNSIGNED_BYTE&&(Cr=M.R8UI),ji===M.UNSIGNED_SHORT&&(Cr=M.R16UI),ji===M.UNSIGNED_INT&&(Cr=M.R32UI),ji===M.BYTE&&(Cr=M.R8I),ji===M.SHORT&&(Cr=M.R16I),ji===M.INT&&(Cr=M.R32I)),Gt===M.RG&&(ji===M.FLOAT&&(Cr=M.RG32F),ji===M.HALF_FLOAT&&(Cr=M.RG16F),ji===M.UNSIGNED_BYTE&&(Cr=M.RG8)),Gt===M.RG_INTEGER&&(ji===M.UNSIGNED_BYTE&&(Cr=M.RG8UI),ji===M.UNSIGNED_SHORT&&(Cr=M.RG16UI),ji===M.UNSIGNED_INT&&(Cr=M.RG32UI),ji===M.BYTE&&(Cr=M.RG8I),ji===M.SHORT&&(Cr=M.RG16I),ji===M.INT&&(Cr=M.RG32I)),Gt===M.RGBA){const ea=Fr?ef:va.getTransfer(Zi);ji===M.FLOAT&&(Cr=M.RGBA32F),ji===M.HALF_FLOAT&&(Cr=M.RGBA16F),ji===M.UNSIGNED_BYTE&&(Cr=ea===Ra?M.SRGB8_ALPHA8:M.RGBA8),ji===M.UNSIGNED_SHORT_4_4_4_4&&(Cr=M.RGBA4),ji===M.UNSIGNED_SHORT_5_5_5_1&&(Cr=M.RGB5_A1)}return(Cr===M.R16F||Cr===M.R32F||Cr===M.RG16F||Cr===M.RG32F||Cr===M.RGBA16F||Cr===M.RGBA32F)&&a.get("EXT_color_buffer_float"),Cr}function bn(_n,Gt,ji){return!0===mt(_n,ji)||_n.isFramebufferTexture&&_n.minFilter!==Xi&&_n.minFilter!==wt?Math.log2(Math.max(Gt.width,Gt.height))+1:void 0!==_n.mipmaps&&_n.mipmaps.length>0?_n.mipmaps.length:_n.isCompressedTexture&&Array.isArray(_n.image)?Gt.mipmaps.length:1}function wn(_n){return _n===Xi||1004===_n||_n===ys?M.NEAREST:M.LINEAR}function $n(_n){const Gt=_n.target;Gt.removeEventListener("dispose",$n),function Nt(_n){const Gt=h.get(_n);if(void 0===Gt.__webglInit)return;const ji=_n.source,Zi=Ge.get(ji);if(Zi){const Fr=Zi[Gt.__cacheKey];Fr.usedTimes--,0===Fr.usedTimes&&In(_n),0===Object.keys(Zi).length&&Ge.delete(ji)}h.remove(_n)}(Gt),Gt.isVideoTexture&&Le.delete(Gt)}function wi(_n){const Gt=_n.target;Gt.removeEventListener("dispose",wi),function dr(_n){const Gt=h.get(_n);if(_n.depthTexture&&_n.depthTexture.dispose(),_n.isWebGLCubeRenderTarget)for(let Zi=0;Zi<6;Zi++){if(Array.isArray(Gt.__webglFramebuffer[Zi]))for(let Fr=0;Fr<Gt.__webglFramebuffer[Zi].length;Fr++)M.deleteFramebuffer(Gt.__webglFramebuffer[Zi][Fr]);else M.deleteFramebuffer(Gt.__webglFramebuffer[Zi]);Gt.__webglDepthbuffer&&M.deleteRenderbuffer(Gt.__webglDepthbuffer[Zi])}else{if(Array.isArray(Gt.__webglFramebuffer))for(let Zi=0;Zi<Gt.__webglFramebuffer.length;Zi++)M.deleteFramebuffer(Gt.__webglFramebuffer[Zi]);else M.deleteFramebuffer(Gt.__webglFramebuffer);if(Gt.__webglDepthbuffer&&M.deleteRenderbuffer(Gt.__webglDepthbuffer),Gt.__webglMultisampledFramebuffer&&M.deleteFramebuffer(Gt.__webglMultisampledFramebuffer),Gt.__webglColorRenderbuffer)for(let Zi=0;Zi<Gt.__webglColorRenderbuffer.length;Zi++)Gt.__webglColorRenderbuffer[Zi]&&M.deleteRenderbuffer(Gt.__webglColorRenderbuffer[Zi]);Gt.__webglDepthRenderbuffer&&M.deleteRenderbuffer(Gt.__webglDepthRenderbuffer)}const ji=_n.textures;for(let Zi=0,Fr=ji.length;Zi<Fr;Zi++){const Cr=h.get(ji[Zi]);Cr.__webglTexture&&(M.deleteTexture(Cr.__webglTexture),H.memory.textures--),h.remove(ji[Zi])}h.remove(_n)}(Gt)}function In(_n){const Gt=h.get(_n);M.deleteTexture(Gt.__webglTexture),delete Ge.get(_n.source)[Gt.__cacheKey],H.memory.textures--}let hr=0;function or(_n,Gt){const ji=h.get(_n);if(_n.isVideoTexture&&function Ds(_n){const Gt=H.render.frame;Le.get(_n)!==Gt&&(Le.set(_n,Gt),_n.update())}(_n),!1===_n.isRenderTargetTexture&&_n.version>0&&ji.__version!==_n.version){const Zi=_n.image;if(null===Zi)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Zi.complete)return void Rs(ji,_n,Gt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.bindTexture(M.TEXTURE_2D,ji.__webglTexture,M.TEXTURE0+Gt)}const zr={1e3:M.REPEAT,[hi]:M.CLAMP_TO_EDGE,1002:M.MIRRORED_REPEAT},Ps={[Xi]:M.NEAREST,1004:M.NEAREST_MIPMAP_NEAREST,[ys]:M.NEAREST_MIPMAP_LINEAR,[wt]:M.LINEAR,[W]:M.LINEAR_MIPMAP_NEAREST,[me]:M.LINEAR_MIPMAP_LINEAR},Jo={512:M.NEVER,519:M.ALWAYS,513:M.LESS,515:M.LEQUAL,514:M.EQUAL,518:M.GEQUAL,516:M.GREATER,517:M.NOTEQUAL};function Li(_n,Gt,ji){if(Gt.type===Cn&&!1===a.has("OES_texture_float_linear")&&(Gt.magFilter===wt||Gt.magFilter===W||Gt.magFilter===ys||Gt.magFilter===me||Gt.minFilter===wt||Gt.minFilter===W||Gt.minFilter===ys||Gt.minFilter===me)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),ji?(M.texParameteri(_n,M.TEXTURE_WRAP_S,zr[Gt.wrapS]),M.texParameteri(_n,M.TEXTURE_WRAP_T,zr[Gt.wrapT]),(_n===M.TEXTURE_3D||_n===M.TEXTURE_2D_ARRAY)&&M.texParameteri(_n,M.TEXTURE_WRAP_R,zr[Gt.wrapR]),M.texParameteri(_n,M.TEXTURE_MAG_FILTER,Ps[Gt.magFilter]),M.texParameteri(_n,M.TEXTURE_MIN_FILTER,Ps[Gt.minFilter])):(M.texParameteri(_n,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(_n,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),(_n===M.TEXTURE_3D||_n===M.TEXTURE_2D_ARRAY)&&M.texParameteri(_n,M.TEXTURE_WRAP_R,M.CLAMP_TO_EDGE),(Gt.wrapS!==hi||Gt.wrapT!==hi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),M.texParameteri(_n,M.TEXTURE_MAG_FILTER,wn(Gt.magFilter)),M.texParameteri(_n,M.TEXTURE_MIN_FILTER,wn(Gt.minFilter)),Gt.minFilter!==Xi&&Gt.minFilter!==wt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Gt.compareFunction&&(M.texParameteri(_n,M.TEXTURE_COMPARE_MODE,M.COMPARE_REF_TO_TEXTURE),M.texParameteri(_n,M.TEXTURE_COMPARE_FUNC,Jo[Gt.compareFunction])),!0===a.has("EXT_texture_filter_anisotropic")){if(Gt.magFilter===Xi||Gt.minFilter!==ys&&Gt.minFilter!==me||Gt.type===Cn&&!1===a.has("OES_texture_float_linear")||!1===K&&Gt.type===ln&&!1===a.has("OES_texture_half_float_linear"))return;if(Gt.anisotropy>1||h.get(Gt).__currentAnisotropy){const Zi=a.get("EXT_texture_filter_anisotropic");M.texParameterf(_n,Zi.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Gt.anisotropy,p.getMaxAnisotropy())),h.get(Gt).__currentAnisotropy=Gt.anisotropy}}}function Br(_n,Gt){let ji=!1;void 0===_n.__webglInit&&(_n.__webglInit=!0,Gt.addEventListener("dispose",$n));const Zi=Gt.source;let Fr=Ge.get(Zi);void 0===Fr&&(Fr={},Ge.set(Zi,Fr));const Cr=function Pi(_n){const Gt=[];return Gt.push(_n.wrapS),Gt.push(_n.wrapT),Gt.push(_n.wrapR||0),Gt.push(_n.magFilter),Gt.push(_n.minFilter),Gt.push(_n.anisotropy),Gt.push(_n.internalFormat),Gt.push(_n.format),Gt.push(_n.type),Gt.push(_n.generateMipmaps),Gt.push(_n.premultiplyAlpha),Gt.push(_n.flipY),Gt.push(_n.unpackAlignment),Gt.push(_n.colorSpace),Gt.join()}(Gt);if(Cr!==_n.__cacheKey){void 0===Fr[Cr]&&(Fr[Cr]={texture:M.createTexture(),usedTimes:0},H.memory.textures++,ji=!0),Fr[Cr].usedTimes++;const ea=Fr[_n.__cacheKey];void 0!==ea&&(Fr[_n.__cacheKey].usedTimes--,0===ea.usedTimes&&In(Gt)),_n.__cacheKey=Cr,_n.__webglTexture=Fr[Cr].texture}return ji}function Rs(_n,Gt,ji){let Zi=M.TEXTURE_2D;(Gt.isDataArrayTexture||Gt.isCompressedArrayTexture)&&(Zi=M.TEXTURE_2D_ARRAY),Gt.isData3DTexture&&(Zi=M.TEXTURE_3D);const Fr=Br(_n,Gt),Cr=Gt.source;c.bindTexture(Zi,_n.__webglTexture,M.TEXTURE0+ji);const ea=h.get(Cr);if(Cr.version!==ea.__version||!0===Fr){c.activeTexture(M.TEXTURE0+ji);const Oo=va.getPrimaries(va.workingColorSpace),ts=""===Gt.colorSpace?null:va.getPrimaries(Gt.colorSpace),fs=""===Gt.colorSpace||Oo===ts?M.NONE:M.BROWSER_DEFAULT_WEBGL;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,Gt.flipY),M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Gt.premultiplyAlpha),M.pixelStorei(M.UNPACK_ALIGNMENT,Gt.unpackAlignment),M.pixelStorei(M.UNPACK_COLORSPACE_CONVERSION_WEBGL,fs);const ta=function Ft(_n){return!K&&(_n.wrapS!==hi||_n.wrapT!==hi||_n.minFilter!==Xi&&_n.minFilter!==wt)}(Gt)&&!1===qe(Gt.image);let Wr=Ye(Gt.image,ta,!1,p.maxTextureSize);Wr=eo(Gt,Wr);const md=qe(Wr)||K,Ga=E.convert(Gt.format,Gt.colorSpace);let oo,Eo=E.convert(Gt.type),so=kn(Gt.internalFormat,Ga,Eo,Gt.colorSpace,Gt.isVideoTexture);Li(Zi,Gt,md);const tl=Gt.mipmaps,la=K&&!0!==Gt.isVideoTexture&&36196!==so,ec=void 0===ea.__version||!0===Fr,oi=Cr.dataReady,gs=bn(Gt,Wr,md);if(Gt.isDepthTexture)so=M.DEPTH_COMPONENT,K?so=Gt.type===Cn?M.DEPTH_COMPONENT32F:Gt.type===jt?M.DEPTH_COMPONENT24:Gt.type===Rn?M.DEPTH24_STENCIL8:M.DEPTH_COMPONENT16:Gt.type===Cn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Gt.format===Ne&&so===M.DEPTH_COMPONENT&&1012!==Gt.type&&Gt.type!==jt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Gt.type=jt,Eo=E.convert(Gt.type)),Gt.format===$&&so===M.DEPTH_COMPONENT&&(so=M.DEPTH_STENCIL,Gt.type!==Rn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Gt.type=Rn,Eo=E.convert(Gt.type))),ec&&(la?c.texStorage2D(M.TEXTURE_2D,1,so,Wr.width,Wr.height):c.texImage2D(M.TEXTURE_2D,0,so,Wr.width,Wr.height,0,Ga,Eo,null));else if(Gt.isDataTexture)if(tl.length>0&&md){la&&ec&&c.texStorage2D(M.TEXTURE_2D,gs,so,tl[0].width,tl[0].height);for(let Ri=0,ns=tl.length;Ri<ns;Ri++)oo=tl[Ri],la?oi&&c.texSubImage2D(M.TEXTURE_2D,Ri,0,0,oo.width,oo.height,Ga,Eo,oo.data):c.texImage2D(M.TEXTURE_2D,Ri,so,oo.width,oo.height,0,Ga,Eo,oo.data);Gt.generateMipmaps=!1}else la?(ec&&c.texStorage2D(M.TEXTURE_2D,gs,so,Wr.width,Wr.height),oi&&c.texSubImage2D(M.TEXTURE_2D,0,0,0,Wr.width,Wr.height,Ga,Eo,Wr.data)):c.texImage2D(M.TEXTURE_2D,0,so,Wr.width,Wr.height,0,Ga,Eo,Wr.data);else if(Gt.isCompressedTexture)if(Gt.isCompressedArrayTexture){la&&ec&&c.texStorage3D(M.TEXTURE_2D_ARRAY,gs,so,tl[0].width,tl[0].height,Wr.depth);for(let Ri=0,ns=tl.length;Ri<ns;Ri++)oo=tl[Ri],Gt.format!==Fn?null!==Ga?la?oi&&c.compressedTexSubImage3D(M.TEXTURE_2D_ARRAY,Ri,0,0,0,oo.width,oo.height,Wr.depth,Ga,oo.data,0,0):c.compressedTexImage3D(M.TEXTURE_2D_ARRAY,Ri,so,oo.width,oo.height,Wr.depth,0,oo.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):la?oi&&c.texSubImage3D(M.TEXTURE_2D_ARRAY,Ri,0,0,0,oo.width,oo.height,Wr.depth,Ga,Eo,oo.data):c.texImage3D(M.TEXTURE_2D_ARRAY,Ri,so,oo.width,oo.height,Wr.depth,0,Ga,Eo,oo.data)}else{la&&ec&&c.texStorage2D(M.TEXTURE_2D,gs,so,tl[0].width,tl[0].height);for(let Ri=0,ns=tl.length;Ri<ns;Ri++)oo=tl[Ri],Gt.format!==Fn?null!==Ga?la?oi&&c.compressedTexSubImage2D(M.TEXTURE_2D,Ri,0,0,oo.width,oo.height,Ga,oo.data):c.compressedTexImage2D(M.TEXTURE_2D,Ri,so,oo.width,oo.height,0,oo.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):la?oi&&c.texSubImage2D(M.TEXTURE_2D,Ri,0,0,oo.width,oo.height,Ga,Eo,oo.data):c.texImage2D(M.TEXTURE_2D,Ri,so,oo.width,oo.height,0,Ga,Eo,oo.data)}else if(Gt.isDataArrayTexture)la?(ec&&c.texStorage3D(M.TEXTURE_2D_ARRAY,gs,so,Wr.width,Wr.height,Wr.depth),oi&&c.texSubImage3D(M.TEXTURE_2D_ARRAY,0,0,0,0,Wr.width,Wr.height,Wr.depth,Ga,Eo,Wr.data)):c.texImage3D(M.TEXTURE_2D_ARRAY,0,so,Wr.width,Wr.height,Wr.depth,0,Ga,Eo,Wr.data);else if(Gt.isData3DTexture)la?(ec&&c.texStorage3D(M.TEXTURE_3D,gs,so,Wr.width,Wr.height,Wr.depth),oi&&c.texSubImage3D(M.TEXTURE_3D,0,0,0,0,Wr.width,Wr.height,Wr.depth,Ga,Eo,Wr.data)):c.texImage3D(M.TEXTURE_3D,0,so,Wr.width,Wr.height,Wr.depth,0,Ga,Eo,Wr.data);else if(Gt.isFramebufferTexture){if(ec)if(la)c.texStorage2D(M.TEXTURE_2D,gs,so,Wr.width,Wr.height);else{let Ri=Wr.width,ns=Wr.height;for(let bs=0;bs<gs;bs++)c.texImage2D(M.TEXTURE_2D,bs,so,Ri,ns,0,Ga,Eo,null),Ri>>=1,ns>>=1}}else if(tl.length>0&&md){if(la&&ec){const Ri=Va(tl[0]);c.texStorage2D(M.TEXTURE_2D,gs,so,Ri.width,Ri.height)}for(let Ri=0,ns=tl.length;Ri<ns;Ri++)oo=tl[Ri],la?oi&&c.texSubImage2D(M.TEXTURE_2D,Ri,0,0,Ga,Eo,oo):c.texImage2D(M.TEXTURE_2D,Ri,so,Ga,Eo,oo);Gt.generateMipmaps=!1}else if(la){if(ec){const Ri=Va(Wr);c.texStorage2D(M.TEXTURE_2D,gs,so,Ri.width,Ri.height)}oi&&c.texSubImage2D(M.TEXTURE_2D,0,0,0,Ga,Eo,Wr)}else c.texImage2D(M.TEXTURE_2D,0,so,Ga,Eo,Wr);mt(Gt,md)&&Ut(Zi),ea.__version=Cr.version,Gt.onUpdate&&Gt.onUpdate(Gt)}_n.__version=Gt.version}function no(_n,Gt,ji,Zi,Fr,Cr){const ea=E.convert(ji.format,ji.colorSpace),Oo=E.convert(ji.type),ts=kn(ji.internalFormat,ea,Oo,ji.colorSpace);if(!h.get(Gt).__hasExternalTextures){const ta=Math.max(1,Gt.width>>Cr),Wr=Math.max(1,Gt.height>>Cr);Fr===M.TEXTURE_3D||Fr===M.TEXTURE_2D_ARRAY?c.texImage3D(Fr,Cr,ts,ta,Wr,Gt.depth,0,ea,Oo,null):c.texImage2D(Fr,Cr,ts,ta,Wr,0,ea,Oo,null)}c.bindFramebuffer(M.FRAMEBUFFER,_n),zs(Gt)?de.framebufferTexture2DMultisampleEXT(M.FRAMEBUFFER,Zi,Fr,h.get(ji).__webglTexture,0,_r(Gt)):(Fr===M.TEXTURE_2D||Fr>=M.TEXTURE_CUBE_MAP_POSITIVE_X&&Fr<=M.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&M.framebufferTexture2D(M.FRAMEBUFFER,Zi,Fr,h.get(ji).__webglTexture,Cr),c.bindFramebuffer(M.FRAMEBUFFER,null)}function $s(_n,Gt,ji){if(M.bindRenderbuffer(M.RENDERBUFFER,_n),Gt.depthBuffer&&!Gt.stencilBuffer){let Zi=!0===K?M.DEPTH_COMPONENT24:M.DEPTH_COMPONENT16;if(ji||zs(Gt)){const Fr=Gt.depthTexture;Fr&&Fr.isDepthTexture&&(Fr.type===Cn?Zi=M.DEPTH_COMPONENT32F:Fr.type===jt&&(Zi=M.DEPTH_COMPONENT24));const Cr=_r(Gt);zs(Gt)?de.renderbufferStorageMultisampleEXT(M.RENDERBUFFER,Cr,Zi,Gt.width,Gt.height):M.renderbufferStorageMultisample(M.RENDERBUFFER,Cr,Zi,Gt.width,Gt.height)}else M.renderbufferStorage(M.RENDERBUFFER,Zi,Gt.width,Gt.height);M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,_n)}else if(Gt.depthBuffer&&Gt.stencilBuffer){const Zi=_r(Gt);ji&&!1===zs(Gt)?M.renderbufferStorageMultisample(M.RENDERBUFFER,Zi,M.DEPTH24_STENCIL8,Gt.width,Gt.height):zs(Gt)?de.renderbufferStorageMultisampleEXT(M.RENDERBUFFER,Zi,M.DEPTH24_STENCIL8,Gt.width,Gt.height):M.renderbufferStorage(M.RENDERBUFFER,M.DEPTH_STENCIL,Gt.width,Gt.height),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_STENCIL_ATTACHMENT,M.RENDERBUFFER,_n)}else{const Zi=Gt.textures;for(let Fr=0;Fr<Zi.length;Fr++){const Cr=Zi[Fr],ea=E.convert(Cr.format,Cr.colorSpace),Oo=E.convert(Cr.type),ts=kn(Cr.internalFormat,ea,Oo,Cr.colorSpace),fs=_r(Gt);ji&&!1===zs(Gt)?M.renderbufferStorageMultisample(M.RENDERBUFFER,fs,ts,Gt.width,Gt.height):zs(Gt)?de.renderbufferStorageMultisampleEXT(M.RENDERBUFFER,fs,ts,Gt.width,Gt.height):M.renderbufferStorage(M.RENDERBUFFER,ts,Gt.width,Gt.height)}}M.bindRenderbuffer(M.RENDERBUFFER,null)}function uo(_n){const Gt=h.get(_n),ji=!0===_n.isWebGLCubeRenderTarget;if(_n.depthTexture&&!Gt.__autoAllocateDepthBuffer){if(ji)throw new Error("target.depthTexture not supported in Cube render targets");!function _a(_n,Gt){if(Gt&&Gt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(M.FRAMEBUFFER,_n),!Gt.depthTexture||!Gt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!h.get(Gt.depthTexture).__webglTexture||Gt.depthTexture.image.width!==Gt.width||Gt.depthTexture.image.height!==Gt.height)&&(Gt.depthTexture.image.width=Gt.width,Gt.depthTexture.image.height=Gt.height,Gt.depthTexture.needsUpdate=!0),or(Gt.depthTexture,0);const Zi=h.get(Gt.depthTexture).__webglTexture,Fr=_r(Gt);if(Gt.depthTexture.format===Ne)zs(Gt)?de.framebufferTexture2DMultisampleEXT(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.TEXTURE_2D,Zi,0,Fr):M.framebufferTexture2D(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.TEXTURE_2D,Zi,0);else{if(Gt.depthTexture.format!==$)throw new Error("Unknown depthTexture format");zs(Gt)?de.framebufferTexture2DMultisampleEXT(M.FRAMEBUFFER,M.DEPTH_STENCIL_ATTACHMENT,M.TEXTURE_2D,Zi,0,Fr):M.framebufferTexture2D(M.FRAMEBUFFER,M.DEPTH_STENCIL_ATTACHMENT,M.TEXTURE_2D,Zi,0)}}(Gt.__webglFramebuffer,_n)}else if(ji){Gt.__webglDepthbuffer=[];for(let Zi=0;Zi<6;Zi++)c.bindFramebuffer(M.FRAMEBUFFER,Gt.__webglFramebuffer[Zi]),Gt.__webglDepthbuffer[Zi]=M.createRenderbuffer(),$s(Gt.__webglDepthbuffer[Zi],_n,!1)}else c.bindFramebuffer(M.FRAMEBUFFER,Gt.__webglFramebuffer),Gt.__webglDepthbuffer=M.createRenderbuffer(),$s(Gt.__webglDepthbuffer,_n,!1);c.bindFramebuffer(M.FRAMEBUFFER,null)}function _r(_n){return Math.min(p.maxSamples,_n.samples)}function zs(_n){const Gt=h.get(_n);return K&&_n.samples>0&&!0===a.has("WEBGL_multisampled_render_to_texture")&&!1!==Gt.__useRenderToTexture}function eo(_n,Gt){const ji=_n.colorSpace,Zi=_n.format,Fr=_n.type;return!0===_n.isCompressedTexture||!0===_n.isVideoTexture||1035===_n.format||ji!==Yc&&""!==ji&&(va.getTransfer(ji)===Ra?!1===K?!0===a.has("EXT_sRGB")&&Zi===Fn?(_n.format=1035,_n.minFilter=wt,_n.generateMipmaps=!1):Gt=kg.sRGBToLinear(Gt):(Zi!==Fn||Fr!==At)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ji)),Gt}function Va(_n){return typeof HTMLImageElement<"u"&&_n instanceof HTMLImageElement?(Me.width=_n.naturalWidth||_n.width,Me.height=_n.naturalHeight||_n.height):typeof VideoFrame<"u"&&_n instanceof VideoFrame?(Me.width=_n.displayWidth,Me.height=_n.displayHeight):(Me.width=_n.width,Me.height=_n.height),Me}this.allocateTextureUnit=function Yi(){const _n=hr;return _n>=p.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+_n+" texture units while this GPU supports only "+p.maxTextures),hr+=1,_n},this.resetTextureUnits=function ei(){hr=0},this.setTexture2D=or,this.setTexture2DArray=function rr(_n,Gt){const ji=h.get(_n);_n.version>0&&ji.__version!==_n.version?Rs(ji,_n,Gt):c.bindTexture(M.TEXTURE_2D_ARRAY,ji.__webglTexture,M.TEXTURE0+Gt)},this.setTexture3D=function nr(_n,Gt){const ji=h.get(_n);_n.version>0&&ji.__version!==_n.version?Rs(ji,_n,Gt):c.bindTexture(M.TEXTURE_3D,ji.__webglTexture,M.TEXTURE0+Gt)},this.setTextureCube=function Gr(_n,Gt){const ji=h.get(_n);_n.version>0&&ji.__version!==_n.version?function co(_n,Gt,ji){if(6!==Gt.image.length)return;const Zi=Br(_n,Gt),Fr=Gt.source;c.bindTexture(M.TEXTURE_CUBE_MAP,_n.__webglTexture,M.TEXTURE0+ji);const Cr=h.get(Fr);if(Fr.version!==Cr.__version||!0===Zi){c.activeTexture(M.TEXTURE0+ji);const ea=va.getPrimaries(va.workingColorSpace),Oo=""===Gt.colorSpace?null:va.getPrimaries(Gt.colorSpace),ts=""===Gt.colorSpace||ea===Oo?M.NONE:M.BROWSER_DEFAULT_WEBGL;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,Gt.flipY),M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Gt.premultiplyAlpha),M.pixelStorei(M.UNPACK_ALIGNMENT,Gt.unpackAlignment),M.pixelStorei(M.UNPACK_COLORSPACE_CONVERSION_WEBGL,ts);const fs=Gt.isCompressedTexture||Gt.image[0].isCompressedTexture,ta=Gt.image[0]&&Gt.image[0].isDataTexture,Wr=[];for(let Ri=0;Ri<6;Ri++)Wr[Ri]=fs||ta?ta?Gt.image[Ri].image:Gt.image[Ri]:Ye(Gt.image[Ri],!1,!0,p.maxCubemapSize),Wr[Ri]=eo(Gt,Wr[Ri]);const md=Wr[0],Ga=qe(md)||K,Eo=E.convert(Gt.format,Gt.colorSpace),so=E.convert(Gt.type),oo=kn(Gt.internalFormat,Eo,so,Gt.colorSpace),tl=K&&!0!==Gt.isVideoTexture,la=void 0===Cr.__version||!0===Zi,ec=Fr.dataReady;let gs,oi=bn(Gt,md,Ga);if(Li(M.TEXTURE_CUBE_MAP,Gt,Ga),fs){tl&&la&&c.texStorage2D(M.TEXTURE_CUBE_MAP,oi,oo,md.width,md.height);for(let Ri=0;Ri<6;Ri++){gs=Wr[Ri].mipmaps;for(let ns=0;ns<gs.length;ns++){const bs=gs[ns];Gt.format!==Fn?null!==Eo?tl?ec&&c.compressedTexSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns,0,0,bs.width,bs.height,Eo,bs.data):c.compressedTexImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns,oo,bs.width,bs.height,0,bs.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tl?ec&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns,0,0,bs.width,bs.height,Eo,so,bs.data):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns,oo,bs.width,bs.height,0,Eo,so,bs.data)}}}else{if(gs=Gt.mipmaps,tl&&la){gs.length>0&&oi++;const Ri=Va(Wr[0]);c.texStorage2D(M.TEXTURE_CUBE_MAP,oi,oo,Ri.width,Ri.height)}for(let Ri=0;Ri<6;Ri++)if(ta){tl?ec&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,0,0,0,Wr[Ri].width,Wr[Ri].height,Eo,so,Wr[Ri].data):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,0,oo,Wr[Ri].width,Wr[Ri].height,0,Eo,so,Wr[Ri].data);for(let ns=0;ns<gs.length;ns++){const Fa=gs[ns].image[Ri].image;tl?ec&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns+1,0,0,Fa.width,Fa.height,Eo,so,Fa.data):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns+1,oo,Fa.width,Fa.height,0,Eo,so,Fa.data)}}else{tl?ec&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,0,0,0,Eo,so,Wr[Ri]):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,0,oo,Eo,so,Wr[Ri]);for(let ns=0;ns<gs.length;ns++){const bs=gs[ns];tl?ec&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns+1,0,0,Eo,so,bs.image[Ri]):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Ri,ns+1,oo,Eo,so,bs.image[Ri])}}}mt(Gt,Ga)&&Ut(M.TEXTURE_CUBE_MAP),Cr.__version=Fr.version,Gt.onUpdate&&Gt.onUpdate(Gt)}_n.__version=Gt.version}(ji,_n,Gt):c.bindTexture(M.TEXTURE_CUBE_MAP,ji.__webglTexture,M.TEXTURE0+Gt)},this.rebindTextures=function Nn(_n,Gt,ji){const Zi=h.get(_n);void 0!==Gt&&no(Zi.__webglFramebuffer,_n,_n.texture,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,0),void 0!==ji&&uo(_n)},this.setupRenderTarget=function Jr(_n){const Gt=_n.texture,ji=h.get(_n),Zi=h.get(Gt);_n.addEventListener("dispose",wi);const Fr=_n.textures,Cr=!0===_n.isWebGLCubeRenderTarget,ea=Fr.length>1,Oo=qe(_n)||K;if(ea||(void 0===Zi.__webglTexture&&(Zi.__webglTexture=M.createTexture()),Zi.__version=Gt.version,H.memory.textures++),Cr){ji.__webglFramebuffer=[];for(let ts=0;ts<6;ts++)if(K&&Gt.mipmaps&&Gt.mipmaps.length>0){ji.__webglFramebuffer[ts]=[];for(let fs=0;fs<Gt.mipmaps.length;fs++)ji.__webglFramebuffer[ts][fs]=M.createFramebuffer()}else ji.__webglFramebuffer[ts]=M.createFramebuffer()}else{if(K&&Gt.mipmaps&&Gt.mipmaps.length>0){ji.__webglFramebuffer=[];for(let ts=0;ts<Gt.mipmaps.length;ts++)ji.__webglFramebuffer[ts]=M.createFramebuffer()}else ji.__webglFramebuffer=M.createFramebuffer();if(ea)if(p.drawBuffers)for(let ts=0,fs=Fr.length;ts<fs;ts++){const ta=h.get(Fr[ts]);void 0===ta.__webglTexture&&(ta.__webglTexture=M.createTexture(),H.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(K&&_n.samples>0&&!1===zs(_n)){ji.__webglMultisampledFramebuffer=M.createFramebuffer(),ji.__webglColorRenderbuffer=[],c.bindFramebuffer(M.FRAMEBUFFER,ji.__webglMultisampledFramebuffer);for(let ts=0;ts<Fr.length;ts++){const fs=Fr[ts];ji.__webglColorRenderbuffer[ts]=M.createRenderbuffer(),M.bindRenderbuffer(M.RENDERBUFFER,ji.__webglColorRenderbuffer[ts]);const ta=E.convert(fs.format,fs.colorSpace),Wr=E.convert(fs.type),md=kn(fs.internalFormat,ta,Wr,fs.colorSpace,!0===_n.isXRRenderTarget),Ga=_r(_n);M.renderbufferStorageMultisample(M.RENDERBUFFER,Ga,md,_n.width,_n.height),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0+ts,M.RENDERBUFFER,ji.__webglColorRenderbuffer[ts])}M.bindRenderbuffer(M.RENDERBUFFER,null),_n.depthBuffer&&(ji.__webglDepthRenderbuffer=M.createRenderbuffer(),$s(ji.__webglDepthRenderbuffer,_n,!0)),c.bindFramebuffer(M.FRAMEBUFFER,null)}}if(Cr){c.bindTexture(M.TEXTURE_CUBE_MAP,Zi.__webglTexture),Li(M.TEXTURE_CUBE_MAP,Gt,Oo);for(let ts=0;ts<6;ts++)if(K&&Gt.mipmaps&&Gt.mipmaps.length>0)for(let fs=0;fs<Gt.mipmaps.length;fs++)no(ji.__webglFramebuffer[ts][fs],_n,Gt,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+ts,fs);else no(ji.__webglFramebuffer[ts],_n,Gt,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+ts,0);mt(Gt,Oo)&&Ut(M.TEXTURE_CUBE_MAP),c.unbindTexture()}else if(ea){for(let ts=0,fs=Fr.length;ts<fs;ts++){const ta=Fr[ts],Wr=h.get(ta);c.bindTexture(M.TEXTURE_2D,Wr.__webglTexture),Li(M.TEXTURE_2D,ta,Oo),no(ji.__webglFramebuffer,_n,ta,M.COLOR_ATTACHMENT0+ts,M.TEXTURE_2D,0),mt(ta,Oo)&&Ut(M.TEXTURE_2D)}c.unbindTexture()}else{let ts=M.TEXTURE_2D;if((_n.isWebGL3DRenderTarget||_n.isWebGLArrayRenderTarget)&&(K?ts=_n.isWebGL3DRenderTarget?M.TEXTURE_3D:M.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),c.bindTexture(ts,Zi.__webglTexture),Li(ts,Gt,Oo),K&&Gt.mipmaps&&Gt.mipmaps.length>0)for(let fs=0;fs<Gt.mipmaps.length;fs++)no(ji.__webglFramebuffer[fs],_n,Gt,M.COLOR_ATTACHMENT0,ts,fs);else no(ji.__webglFramebuffer,_n,Gt,M.COLOR_ATTACHMENT0,ts,0);mt(Gt,Oo)&&Ut(ts),c.unbindTexture()}_n.depthBuffer&&uo(_n)},this.updateRenderTargetMipmap=function lr(_n){const Gt=qe(_n)||K,ji=_n.textures;for(let Zi=0,Fr=ji.length;Zi<Fr;Zi++){const Cr=ji[Zi];if(mt(Cr,Gt)){const ea=_n.isWebGLCubeRenderTarget?M.TEXTURE_CUBE_MAP:M.TEXTURE_2D,Oo=h.get(Cr).__webglTexture;c.bindTexture(ea,Oo),Ut(ea),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function Yr(_n){if(K&&_n.samples>0&&!1===zs(_n)){const Gt=_n.textures,ji=_n.width,Zi=_n.height;let Fr=M.COLOR_BUFFER_BIT;const Cr=[],ea=_n.stencilBuffer?M.DEPTH_STENCIL_ATTACHMENT:M.DEPTH_ATTACHMENT,Oo=h.get(_n),ts=Gt.length>1;if(ts)for(let fs=0;fs<Gt.length;fs++)c.bindFramebuffer(M.FRAMEBUFFER,Oo.__webglMultisampledFramebuffer),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0+fs,M.RENDERBUFFER,null),c.bindFramebuffer(M.FRAMEBUFFER,Oo.__webglFramebuffer),M.framebufferTexture2D(M.DRAW_FRAMEBUFFER,M.COLOR_ATTACHMENT0+fs,M.TEXTURE_2D,null,0);c.bindFramebuffer(M.READ_FRAMEBUFFER,Oo.__webglMultisampledFramebuffer),c.bindFramebuffer(M.DRAW_FRAMEBUFFER,Oo.__webglFramebuffer);for(let fs=0;fs<Gt.length;fs++){Cr.push(M.COLOR_ATTACHMENT0+fs),_n.depthBuffer&&Cr.push(ea);const ta=void 0!==Oo.__ignoreDepthValues&&Oo.__ignoreDepthValues;if(!1===ta&&(_n.depthBuffer&&(Fr|=M.DEPTH_BUFFER_BIT),_n.stencilBuffer&&(Fr|=M.STENCIL_BUFFER_BIT)),ts&&M.framebufferRenderbuffer(M.READ_FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.RENDERBUFFER,Oo.__webglColorRenderbuffer[fs]),!0===ta&&(M.invalidateFramebuffer(M.READ_FRAMEBUFFER,[ea]),M.invalidateFramebuffer(M.DRAW_FRAMEBUFFER,[ea])),ts){const Wr=h.get(Gt[fs]).__webglTexture;M.framebufferTexture2D(M.DRAW_FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,Wr,0)}M.blitFramebuffer(0,0,ji,Zi,0,0,ji,Zi,Fr,M.NEAREST),ge&&M.invalidateFramebuffer(M.READ_FRAMEBUFFER,Cr)}if(c.bindFramebuffer(M.READ_FRAMEBUFFER,null),c.bindFramebuffer(M.DRAW_FRAMEBUFFER,null),ts)for(let fs=0;fs<Gt.length;fs++){c.bindFramebuffer(M.FRAMEBUFFER,Oo.__webglMultisampledFramebuffer),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0+fs,M.RENDERBUFFER,Oo.__webglColorRenderbuffer[fs]);const ta=h.get(Gt[fs]).__webglTexture;c.bindFramebuffer(M.FRAMEBUFFER,Oo.__webglFramebuffer),M.framebufferTexture2D(M.DRAW_FRAMEBUFFER,M.COLOR_ATTACHMENT0+fs,M.TEXTURE_2D,ta,0)}c.bindFramebuffer(M.DRAW_FRAMEBUFFER,Oo.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=uo,this.setupFrameBufferTexture=no,this.useMultisampledRTT=zs}function zB(M,a,c){const h=c.isWebGL2;return{convert:function p(E,H=""){let K;const de=va.getTransfer(H);if(E===At)return M.UNSIGNED_BYTE;if(1017===E)return M.UNSIGNED_SHORT_4_4_4_4;if(1018===E)return M.UNSIGNED_SHORT_5_5_5_1;if(1010===E)return M.BYTE;if(1011===E)return M.SHORT;if(1012===E)return M.UNSIGNED_SHORT;if(1013===E)return M.INT;if(E===jt)return M.UNSIGNED_INT;if(E===Cn)return M.FLOAT;if(E===ln)return h?M.HALF_FLOAT:(K=a.get("OES_texture_half_float"),null!==K?K.HALF_FLOAT_OES:null);if(1021===E)return M.ALPHA;if(E===Fn)return M.RGBA;if(1024===E)return M.LUMINANCE;if(1025===E)return M.LUMINANCE_ALPHA;if(E===Ne)return M.DEPTH_COMPONENT;if(E===$)return M.DEPTH_STENCIL;if(1035===E)return K=a.get("EXT_sRGB"),null!==K?K.SRGB_ALPHA_EXT:null;if(1028===E)return M.RED;if(1029===E)return M.RED_INTEGER;if(1030===E)return M.RG;if(1031===E)return M.RG_INTEGER;if(1033===E)return M.RGBA_INTEGER;if(33776===E||33777===E||33778===E||33779===E)if(de===Ra){if(K=a.get("WEBGL_compressed_texture_s3tc_srgb"),null===K)return null;if(33776===E)return K.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===E)return K.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===E)return K.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===E)return K.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(K=a.get("WEBGL_compressed_texture_s3tc"),null===K)return null;if(33776===E)return K.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===E)return K.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===E)return K.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===E)return K.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===E||35841===E||35842===E||35843===E){if(K=a.get("WEBGL_compressed_texture_pvrtc"),null===K)return null;if(35840===E)return K.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===E)return K.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===E)return K.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===E)return K.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===E)return K=a.get("WEBGL_compressed_texture_etc1"),null!==K?K.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===E||37496===E){if(K=a.get("WEBGL_compressed_texture_etc"),null===K)return null;if(37492===E)return de===Ra?K.COMPRESSED_SRGB8_ETC2:K.COMPRESSED_RGB8_ETC2;if(37496===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:K.COMPRESSED_RGBA8_ETC2_EAC}if(37808===E||37809===E||37810===E||37811===E||37812===E||37813===E||37814===E||37815===E||37816===E||37817===E||37818===E||37819===E||37820===E||37821===E){if(K=a.get("WEBGL_compressed_texture_astc"),null===K)return null;if(37808===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:K.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:K.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:K.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:K.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:K.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:K.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:K.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:K.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:K.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:K.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:K.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:K.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:K.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===E)return de===Ra?K.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:K.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===E||36494===E||36495===E){if(K=a.get("EXT_texture_compression_bptc"),null===K)return null;if(36492===E)return de===Ra?K.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:K.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===E)return K.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===E)return K.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===E||36284===E||36285===E||36286===E){if(K=a.get("EXT_texture_compression_rgtc"),null===K)return null;if(36492===E)return K.COMPRESSED_RED_RGTC1_EXT;if(36284===E)return K.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===E)return K.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===E)return K.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return E===Rn?h?M.UNSIGNED_INT_24_8:(K=a.get("WEBGL_depth_texture"),null!==K?K.UNSIGNED_INT_24_8_WEBGL:null):void 0!==M[E]?M[E]:null}}}class CT extends yl{constructor(a=[]){super(),this.isArrayCamera=!0,this.cameras=a}}class J1 extends Nl{constructor(){super(),this.isGroup=!0,this.type="Group"}}const HB={type:"move"};class fM{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new J1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new J1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Dn,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Dn),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new J1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Dn,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Dn),this._grip}dispatchEvent(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this}connect(a){if(a&&a.hand){const c=this._hand;if(c)for(const h of a.hand.values())this._getHandJoint(c,h)}return this.dispatchEvent({type:"connected",data:a}),this}disconnect(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(a,c,h){let p=null,E=null,H=null;const K=this._targetRay,de=this._grip,ge=this._hand;if(a&&"visible-blurred"!==c.session.visibilityState){if(ge&&a.hand){H=!0;for(const bt of a.hand.values()){const Ye=c.getJointPose(bt,h),qe=this._getHandJoint(ge,bt);null!==Ye&&(qe.matrix.fromArray(Ye.transform.matrix),qe.matrix.decompose(qe.position,qe.rotation,qe.scale),qe.matrixWorldNeedsUpdate=!0,qe.jointRadius=Ye.radius),qe.visible=null!==Ye}const Be=ge.joints["index-finger-tip"].position.distanceTo(ge.joints["thumb-tip"].position),Ge=.02,it=.005;ge.inputState.pinching&&Be>Ge+it?(ge.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!ge.inputState.pinching&&Be<=Ge-it&&(ge.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==de&&a.gripSpace&&(E=c.getPose(a.gripSpace,h),null!==E&&(de.matrix.fromArray(E.transform.matrix),de.matrix.decompose(de.position,de.rotation,de.scale),de.matrixWorldNeedsUpdate=!0,E.linearVelocity?(de.hasLinearVelocity=!0,de.linearVelocity.copy(E.linearVelocity)):de.hasLinearVelocity=!1,E.angularVelocity?(de.hasAngularVelocity=!0,de.angularVelocity.copy(E.angularVelocity)):de.hasAngularVelocity=!1));null!==K&&(p=c.getPose(a.targetRaySpace,h),null===p&&null!==E&&(p=E),null!==p&&(K.matrix.fromArray(p.transform.matrix),K.matrix.decompose(K.position,K.rotation,K.scale),K.matrixWorldNeedsUpdate=!0,p.linearVelocity?(K.hasLinearVelocity=!0,K.linearVelocity.copy(p.linearVelocity)):K.hasLinearVelocity=!1,p.angularVelocity?(K.hasAngularVelocity=!0,K.angularVelocity.copy(p.angularVelocity)):K.hasAngularVelocity=!1,this.dispatchEvent(HB)))}return null!==K&&(K.visible=null!==p),null!==de&&(de.visible=null!==E),null!==ge&&(ge.visible=null!==H),this}_getHandJoint(a,c){if(void 0===a.joints[c.jointName]){const h=new J1;h.matrixAutoUpdate=!1,h.visible=!1,a.joints[c.jointName]=h,a.add(h)}return a.joints[c.jointName]}}class YA{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(a,c,h){if(null===this.texture){const p=new $d;a.properties.get(p).__webglTexture=c.texture,(c.depthNear!=h.depthNear||c.depthFar!=h.depthFar)&&(this.depthNear=c.depthNear,this.depthFar=c.depthFar),this.texture=p}}render(a,c){if(null!==this.texture){if(null===this.mesh){const h=c.cameras[0].viewport,p=new Pc({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:h.z},depthHeight:{value:h.w}}});this.mesh=new gl(new Th(20,20),p)}a.render(this.mesh,c)}}reset(){this.texture=null,this.mesh=null}}class Pv extends li{constructor(a,c){super();const h=this;let p=null,E=1,H=null,K="local-floor",de=1,ge=null,Me=null,Le=null,Be=null,Ge=null,it=null;const bt=new YA,Ye=c.getContextAttributes();let qe=null,Ft=null;const mt=[],Ut=[],kn=new Si;let bn=null;const wn=new yl;wn.layers.enable(1),wn.viewport=new Za;const $n=new yl;$n.layers.enable(2),$n.viewport=new Za;const wi=[wn,$n],Nt=new CT;Nt.layers.enable(1),Nt.layers.enable(2);let In=null,dr=null;function hr(Li){const Br=Ut.indexOf(Li.inputSource);if(-1===Br)return;const Rs=mt[Br];void 0!==Rs&&(Rs.update(Li.inputSource,Li.frame,ge||H),Rs.dispatchEvent({type:Li.type,data:Li.inputSource}))}function ei(){p.removeEventListener("select",hr),p.removeEventListener("selectstart",hr),p.removeEventListener("selectend",hr),p.removeEventListener("squeeze",hr),p.removeEventListener("squeezestart",hr),p.removeEventListener("squeezeend",hr),p.removeEventListener("end",ei),p.removeEventListener("inputsourceschange",Yi);for(let Li=0;Li<mt.length;Li++){const Br=Ut[Li];null!==Br&&(Ut[Li]=null,mt[Li].disconnect(Br))}In=null,dr=null,bt.reset(),a.setRenderTarget(qe),Ge=null,Be=null,Le=null,p=null,Ft=null,Jo.stop(),h.isPresenting=!1,a.setPixelRatio(bn),a.setSize(kn.width,kn.height,!1),h.dispatchEvent({type:"sessionend"})}function Yi(Li){for(let Br=0;Br<Li.removed.length;Br++){const Rs=Li.removed[Br],co=Ut.indexOf(Rs);co>=0&&(Ut[co]=null,mt[co].disconnect(Rs))}for(let Br=0;Br<Li.added.length;Br++){const Rs=Li.added[Br];let co=Ut.indexOf(Rs);if(-1===co){for(let $s=0;$s<mt.length;$s++){if($s>=Ut.length){Ut.push(Rs),co=$s;break}if(null===Ut[$s]){Ut[$s]=Rs,co=$s;break}}if(-1===co)break}const no=mt[co];no&&no.connect(Rs)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Li){let Br=mt[Li];return void 0===Br&&(Br=new fM,mt[Li]=Br),Br.getTargetRaySpace()},this.getControllerGrip=function(Li){let Br=mt[Li];return void 0===Br&&(Br=new fM,mt[Li]=Br),Br.getGripSpace()},this.getHand=function(Li){let Br=mt[Li];return void 0===Br&&(Br=new fM,mt[Li]=Br),Br.getHandSpace()},this.setFramebufferScaleFactor=function(Li){E=Li,!0===h.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Li){K=Li,!0===h.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return ge||H},this.setReferenceSpace=function(Li){ge=Li},this.getBaseLayer=function(){return null!==Be?Be:Ge},this.getBinding=function(){return Le},this.getFrame=function(){return it},this.getSession=function(){return p},this.setSession=function(){var Li=(0,ve.A)(function*(Br){if(p=Br,null!==p){if(qe=a.getRenderTarget(),p.addEventListener("select",hr),p.addEventListener("selectstart",hr),p.addEventListener("selectend",hr),p.addEventListener("squeeze",hr),p.addEventListener("squeezestart",hr),p.addEventListener("squeezeend",hr),p.addEventListener("end",ei),p.addEventListener("inputsourceschange",Yi),!0!==Ye.xrCompatible&&(yield c.makeXRCompatible()),bn=a.getPixelRatio(),a.getSize(kn),void 0===p.renderState.layers||!1===a.capabilities.isWebGL2)Ge=new XRWebGLLayer(p,c,{antialias:void 0!==p.renderState.layers||Ye.antialias,alpha:!0,depth:Ye.depth,stencil:Ye.stencil,framebufferScaleFactor:E}),p.updateRenderState({baseLayer:Ge}),a.setPixelRatio(1),a.setSize(Ge.framebufferWidth,Ge.framebufferHeight,!1),Ft=new ku(Ge.framebufferWidth,Ge.framebufferHeight,{format:Fn,type:At,colorSpace:a.outputColorSpace,stencilBuffer:Ye.stencil});else{let Rs=null,co=null,no=null;Ye.depth&&(no=Ye.stencil?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT24,Rs=Ye.stencil?$:Ne,co=Ye.stencil?Rn:jt);const $s={colorFormat:c.RGBA8,depthFormat:no,scaleFactor:E};Le=new XRWebGLBinding(p,c),Be=Le.createProjectionLayer($s),p.updateRenderState({layers:[Be]}),a.setPixelRatio(1),a.setSize(Be.textureWidth,Be.textureHeight,!1),Ft=new ku(Be.textureWidth,Be.textureHeight,{format:Fn,type:At,depthTexture:new Dr(Be.textureWidth,Be.textureHeight,co,void 0,void 0,void 0,void 0,void 0,void 0,Rs),stencilBuffer:Ye.stencil,colorSpace:a.outputColorSpace,samples:Ye.antialias?4:0}),a.properties.get(Ft).__ignoreDepthValues=Be.ignoreDepthValues}Ft.isXRRenderTarget=!0,this.setFoveation(de),ge=null,H=yield p.requestReferenceSpace(K),Jo.setContext(p),Jo.start(),h.isPresenting=!0,h.dispatchEvent({type:"sessionstart"})}});return function(Br){return Li.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==p)return p.environmentBlendMode};const Pi=new Dn,or=new Dn;function nr(Li,Br){null===Br?Li.matrixWorld.copy(Li.matrix):Li.matrixWorld.multiplyMatrices(Br.matrixWorld,Li.matrix),Li.matrixWorldInverse.copy(Li.matrixWorld).invert()}this.updateCamera=function(Li){if(null===p)return;null!==bt.texture&&(Li.near=bt.depthNear,Li.far=bt.depthFar),Nt.near=$n.near=wn.near=Li.near,Nt.far=$n.far=wn.far=Li.far,(In!==Nt.near||dr!==Nt.far)&&(p.updateRenderState({depthNear:Nt.near,depthFar:Nt.far}),In=Nt.near,dr=Nt.far,wn.near=In,wn.far=dr,$n.near=In,$n.far=dr,wn.updateProjectionMatrix(),$n.updateProjectionMatrix(),Li.updateProjectionMatrix());const Br=Li.parent,Rs=Nt.cameras;nr(Nt,Br);for(let co=0;co<Rs.length;co++)nr(Rs[co],Br);2===Rs.length?function rr(Li,Br,Rs){Pi.setFromMatrixPosition(Br.matrixWorld),or.setFromMatrixPosition(Rs.matrixWorld);const co=Pi.distanceTo(or),no=Br.projectionMatrix.elements,$s=Rs.projectionMatrix.elements,_a=no[14]/(no[10]-1),uo=no[14]/(no[10]+1),Nn=(no[9]+1)/no[5],Jr=(no[9]-1)/no[5],lr=(no[8]-1)/no[0],Yr=($s[8]+1)/$s[0],_r=_a*lr,zs=_a*Yr,Ds=co/(-lr+Yr),eo=Ds*-lr;Br.matrixWorld.decompose(Li.position,Li.quaternion,Li.scale),Li.translateX(eo),Li.translateZ(Ds),Li.matrixWorld.compose(Li.position,Li.quaternion,Li.scale),Li.matrixWorldInverse.copy(Li.matrixWorld).invert();const Va=_a+Ds,_n=uo+Ds;Li.projectionMatrix.makePerspective(_r-eo,zs+(co-eo),Nn*uo/_n*Va,Jr*uo/_n*Va,Va,_n),Li.projectionMatrixInverse.copy(Li.projectionMatrix).invert()}(Nt,wn,$n):Nt.projectionMatrix.copy(wn.projectionMatrix),function Gr(Li,Br,Rs){null===Rs?Li.matrix.copy(Br.matrixWorld):(Li.matrix.copy(Rs.matrixWorld),Li.matrix.invert(),Li.matrix.multiply(Br.matrixWorld)),Li.matrix.decompose(Li.position,Li.quaternion,Li.scale),Li.updateMatrixWorld(!0),Li.projectionMatrix.copy(Br.projectionMatrix),Li.projectionMatrixInverse.copy(Br.projectionMatrixInverse),Li.isPerspectiveCamera&&(Li.fov=2*Bu*Math.atan(1/Li.projectionMatrix.elements[5]),Li.zoom=1)}(Li,Nt,Br)},this.getCamera=function(){return Nt},this.getFoveation=function(){if(null!==Be||null!==Ge)return de},this.setFoveation=function(Li){de=Li,null!==Be&&(Be.fixedFoveation=Li),null!==Ge&&void 0!==Ge.fixedFoveation&&(Ge.fixedFoveation=Li)},this.hasDepthSensing=function(){return null!==bt.texture};let zr=null;const Jo=new lf;Jo.setAnimationLoop(function Ps(Li,Br){if(Me=Br.getViewerPose(ge||H),it=Br,null!==Me){const Rs=Me.views;null!==Ge&&(a.setRenderTargetFramebuffer(Ft,Ge.framebuffer),a.setRenderTarget(Ft));let co=!1;Rs.length!==Nt.cameras.length&&(Nt.cameras.length=0,co=!0);for(let $s=0;$s<Rs.length;$s++){const _a=Rs[$s];let uo=null;if(null!==Ge)uo=Ge.getViewport(_a);else{const Jr=Le.getViewSubImage(Be,_a);uo=Jr.viewport,0===$s&&(a.setRenderTargetTextures(Ft,Jr.colorTexture,Be.ignoreDepthValues?void 0:Jr.depthStencilTexture),a.setRenderTarget(Ft))}let Nn=wi[$s];void 0===Nn&&(Nn=new yl,Nn.layers.enable($s),Nn.viewport=new Za,wi[$s]=Nn),Nn.matrix.fromArray(_a.transform.matrix),Nn.matrix.decompose(Nn.position,Nn.quaternion,Nn.scale),Nn.projectionMatrix.fromArray(_a.projectionMatrix),Nn.projectionMatrixInverse.copy(Nn.projectionMatrix).invert(),Nn.viewport.set(uo.x,uo.y,uo.width,uo.height),0===$s&&(Nt.matrix.copy(Nn.matrix),Nt.matrix.decompose(Nt.position,Nt.quaternion,Nt.scale)),!0===co&&Nt.cameras.push(Nn)}const no=p.enabledFeatures;if(no&&no.includes("depth-sensing")){const $s=Le.getDepthInformation(Rs[0]);$s&&$s.isValid&&$s.texture&&bt.init(a,$s,p.renderState)}}for(let Rs=0;Rs<mt.length;Rs++){const co=Ut[Rs],no=mt[Rs];null!==co&&void 0!==no&&no.update(co,Br,ge||H)}bt.render(a,Nt),zr&&zr(Li,Br),Br.detectedPlanes&&h.dispatchEvent({type:"planesdetected",data:Br}),it=null}),this.setAnimationLoop=function(Li){zr=Li},this.dispose=function(){}}}const f0=new Ec,MT=new lo;function ST(M,a){function c(Ye,qe){!0===Ye.matrixAutoUpdate&&Ye.updateMatrix(),qe.value.copy(Ye.matrix)}function E(Ye,qe){Ye.opacity.value=qe.opacity,qe.color&&Ye.diffuse.value.copy(qe.color),qe.emissive&&Ye.emissive.value.copy(qe.emissive).multiplyScalar(qe.emissiveIntensity),qe.map&&(Ye.map.value=qe.map,c(qe.map,Ye.mapTransform)),qe.alphaMap&&(Ye.alphaMap.value=qe.alphaMap,c(qe.alphaMap,Ye.alphaMapTransform)),qe.bumpMap&&(Ye.bumpMap.value=qe.bumpMap,c(qe.bumpMap,Ye.bumpMapTransform),Ye.bumpScale.value=qe.bumpScale,1===qe.side&&(Ye.bumpScale.value*=-1)),qe.normalMap&&(Ye.normalMap.value=qe.normalMap,c(qe.normalMap,Ye.normalMapTransform),Ye.normalScale.value.copy(qe.normalScale),1===qe.side&&Ye.normalScale.value.negate()),qe.displacementMap&&(Ye.displacementMap.value=qe.displacementMap,c(qe.displacementMap,Ye.displacementMapTransform),Ye.displacementScale.value=qe.displacementScale,Ye.displacementBias.value=qe.displacementBias),qe.emissiveMap&&(Ye.emissiveMap.value=qe.emissiveMap,c(qe.emissiveMap,Ye.emissiveMapTransform)),qe.specularMap&&(Ye.specularMap.value=qe.specularMap,c(qe.specularMap,Ye.specularMapTransform)),qe.alphaTest>0&&(Ye.alphaTest.value=qe.alphaTest);const Ft=a.get(qe),mt=Ft.envMap,Ut=Ft.envMapRotation;if(mt&&(Ye.envMap.value=mt,f0.copy(Ut),f0.x*=-1,f0.y*=-1,f0.z*=-1,mt.isCubeTexture&&!1===mt.isRenderTargetTexture&&(f0.y*=-1,f0.z*=-1),Ye.envMapRotation.value.setFromMatrix4(MT.makeRotationFromEuler(f0)),Ye.flipEnvMap.value=mt.isCubeTexture&&!1===mt.isRenderTargetTexture?-1:1,Ye.reflectivity.value=qe.reflectivity,Ye.ior.value=qe.ior,Ye.refractionRatio.value=qe.refractionRatio),qe.lightMap){Ye.lightMap.value=qe.lightMap;const kn=!0===M._useLegacyLights?Math.PI:1;Ye.lightMapIntensity.value=qe.lightMapIntensity*kn,c(qe.lightMap,Ye.lightMapTransform)}qe.aoMap&&(Ye.aoMap.value=qe.aoMap,Ye.aoMapIntensity.value=qe.aoMapIntensity,c(qe.aoMap,Ye.aoMapTransform))}return{refreshFogUniforms:function h(Ye,qe){qe.color.getRGB(Ye.fogColor.value,Bc(M)),qe.isFog?(Ye.fogNear.value=qe.near,Ye.fogFar.value=qe.far):qe.isFogExp2&&(Ye.fogDensity.value=qe.density)},refreshMaterialUniforms:function p(Ye,qe,Ft,mt,Ut){qe.isMeshBasicMaterial||qe.isMeshLambertMaterial?E(Ye,qe):qe.isMeshToonMaterial?(E(Ye,qe),function Le(Ye,qe){qe.gradientMap&&(Ye.gradientMap.value=qe.gradientMap)}(Ye,qe)):qe.isMeshPhongMaterial?(E(Ye,qe),function Me(Ye,qe){Ye.specular.value.copy(qe.specular),Ye.shininess.value=Math.max(qe.shininess,1e-4)}(Ye,qe)):qe.isMeshStandardMaterial?(E(Ye,qe),function Be(Ye,qe){Ye.metalness.value=qe.metalness,qe.metalnessMap&&(Ye.metalnessMap.value=qe.metalnessMap,c(qe.metalnessMap,Ye.metalnessMapTransform)),Ye.roughness.value=qe.roughness,qe.roughnessMap&&(Ye.roughnessMap.value=qe.roughnessMap,c(qe.roughnessMap,Ye.roughnessMapTransform)),a.get(qe).envMap&&(Ye.envMapIntensity.value=qe.envMapIntensity)}(Ye,qe),qe.isMeshPhysicalMaterial&&function Ge(Ye,qe,Ft){Ye.ior.value=qe.ior,qe.sheen>0&&(Ye.sheenColor.value.copy(qe.sheenColor).multiplyScalar(qe.sheen),Ye.sheenRoughness.value=qe.sheenRoughness,qe.sheenColorMap&&(Ye.sheenColorMap.value=qe.sheenColorMap,c(qe.sheenColorMap,Ye.sheenColorMapTransform)),qe.sheenRoughnessMap&&(Ye.sheenRoughnessMap.value=qe.sheenRoughnessMap,c(qe.sheenRoughnessMap,Ye.sheenRoughnessMapTransform))),qe.clearcoat>0&&(Ye.clearcoat.value=qe.clearcoat,Ye.clearcoatRoughness.value=qe.clearcoatRoughness,qe.clearcoatMap&&(Ye.clearcoatMap.value=qe.clearcoatMap,c(qe.clearcoatMap,Ye.clearcoatMapTransform)),qe.clearcoatRoughnessMap&&(Ye.clearcoatRoughnessMap.value=qe.clearcoatRoughnessMap,c(qe.clearcoatRoughnessMap,Ye.clearcoatRoughnessMapTransform)),qe.clearcoatNormalMap&&(Ye.clearcoatNormalMap.value=qe.clearcoatNormalMap,c(qe.clearcoatNormalMap,Ye.clearcoatNormalMapTransform),Ye.clearcoatNormalScale.value.copy(qe.clearcoatNormalScale),1===qe.side&&Ye.clearcoatNormalScale.value.negate())),qe.iridescence>0&&(Ye.iridescence.value=qe.iridescence,Ye.iridescenceIOR.value=qe.iridescenceIOR,Ye.iridescenceThicknessMinimum.value=qe.iridescenceThicknessRange[0],Ye.iridescenceThicknessMaximum.value=qe.iridescenceThicknessRange[1],qe.iridescenceMap&&(Ye.iridescenceMap.value=qe.iridescenceMap,c(qe.iridescenceMap,Ye.iridescenceMapTransform)),qe.iridescenceThicknessMap&&(Ye.iridescenceThicknessMap.value=qe.iridescenceThicknessMap,c(qe.iridescenceThicknessMap,Ye.iridescenceThicknessMapTransform))),qe.transmission>0&&(Ye.transmission.value=qe.transmission,Ye.transmissionSamplerMap.value=Ft.texture,Ye.transmissionSamplerSize.value.set(Ft.width,Ft.height),qe.transmissionMap&&(Ye.transmissionMap.value=qe.transmissionMap,c(qe.transmissionMap,Ye.transmissionMapTransform)),Ye.thickness.value=qe.thickness,qe.thicknessMap&&(Ye.thicknessMap.value=qe.thicknessMap,c(qe.thicknessMap,Ye.thicknessMapTransform)),Ye.attenuationDistance.value=qe.attenuationDistance,Ye.attenuationColor.value.copy(qe.attenuationColor)),qe.anisotropy>0&&(Ye.anisotropyVector.value.set(qe.anisotropy*Math.cos(qe.anisotropyRotation),qe.anisotropy*Math.sin(qe.anisotropyRotation)),qe.anisotropyMap&&(Ye.anisotropyMap.value=qe.anisotropyMap,c(qe.anisotropyMap,Ye.anisotropyMapTransform))),Ye.specularIntensity.value=qe.specularIntensity,Ye.specularColor.value.copy(qe.specularColor),qe.specularColorMap&&(Ye.specularColorMap.value=qe.specularColorMap,c(qe.specularColorMap,Ye.specularColorMapTransform)),qe.specularIntensityMap&&(Ye.specularIntensityMap.value=qe.specularIntensityMap,c(qe.specularIntensityMap,Ye.specularIntensityMapTransform))}(Ye,qe,Ut)):qe.isMeshMatcapMaterial?(E(Ye,qe),function it(Ye,qe){qe.matcap&&(Ye.matcap.value=qe.matcap)}(Ye,qe)):qe.isMeshDepthMaterial?E(Ye,qe):qe.isMeshDistanceMaterial?(E(Ye,qe),function bt(Ye,qe){const Ft=a.get(qe).light;Ye.referencePosition.value.setFromMatrixPosition(Ft.matrixWorld),Ye.nearDistance.value=Ft.shadow.camera.near,Ye.farDistance.value=Ft.shadow.camera.far}(Ye,qe)):qe.isMeshNormalMaterial?E(Ye,qe):qe.isLineBasicMaterial?(function H(Ye,qe){Ye.diffuse.value.copy(qe.color),Ye.opacity.value=qe.opacity,qe.map&&(Ye.map.value=qe.map,c(qe.map,Ye.mapTransform))}(Ye,qe),qe.isLineDashedMaterial&&function K(Ye,qe){Ye.dashSize.value=qe.dashSize,Ye.totalSize.value=qe.dashSize+qe.gapSize,Ye.scale.value=qe.scale}(Ye,qe)):qe.isPointsMaterial?function de(Ye,qe,Ft,mt){Ye.diffuse.value.copy(qe.color),Ye.opacity.value=qe.opacity,Ye.size.value=qe.size*Ft,Ye.scale.value=.5*mt,qe.map&&(Ye.map.value=qe.map,c(qe.map,Ye.uvTransform)),qe.alphaMap&&(Ye.alphaMap.value=qe.alphaMap,c(qe.alphaMap,Ye.alphaMapTransform)),qe.alphaTest>0&&(Ye.alphaTest.value=qe.alphaTest)}(Ye,qe,Ft,mt):qe.isSpriteMaterial?function ge(Ye,qe){Ye.diffuse.value.copy(qe.color),Ye.opacity.value=qe.opacity,Ye.rotation.value=qe.rotation,qe.map&&(Ye.map.value=qe.map,c(qe.map,Ye.mapTransform)),qe.alphaMap&&(Ye.alphaMap.value=qe.alphaMap,c(qe.alphaMap,Ye.alphaMapTransform)),qe.alphaTest>0&&(Ye.alphaTest.value=qe.alphaTest)}(Ye,qe):qe.isShadowMaterial?(Ye.color.value.copy(qe.color),Ye.opacity.value=qe.opacity):qe.isShaderMaterial&&(qe.uniformsNeedUpdate=!1)}}}function YL(M,a,c,h){let p={},E={},H=[];const K=c.isWebGL2?M.getParameter(M.MAX_UNIFORM_BUFFER_BINDINGS):0;function Ge(Ft,mt,Ut,kn){const bn=Ft.value,wn=mt+"_"+Ut;if(void 0===kn[wn])return kn[wn]="number"==typeof bn||"boolean"==typeof bn?bn:bn.clone(),!0;{const $n=kn[wn];if("number"==typeof bn||"boolean"==typeof bn){if($n!==bn)return kn[wn]=bn,!0}else if(!1===$n.equals(bn))return $n.copy(bn),!0}return!1}function bt(Ft){const mt={boundary:0,storage:0};return"number"==typeof Ft||"boolean"==typeof Ft?(mt.boundary=4,mt.storage=4):Ft.isVector2?(mt.boundary=8,mt.storage=8):Ft.isVector3||Ft.isColor?(mt.boundary=16,mt.storage=12):Ft.isVector4?(mt.boundary=16,mt.storage=16):Ft.isMatrix3?(mt.boundary=48,mt.storage=48):Ft.isMatrix4?(mt.boundary=64,mt.storage=64):Ft.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Ft),mt}function Ye(Ft){const mt=Ft.target;mt.removeEventListener("dispose",Ye);const Ut=H.indexOf(mt.__bindingPointIndex);H.splice(Ut,1),M.deleteBuffer(p[mt.id]),delete p[mt.id],delete E[mt.id]}return{bind:function de(Ft,mt){h.uniformBlockBinding(Ft,mt.program)},update:function ge(Ft,mt){let Ut=p[Ft.id];void 0===Ut&&(function it(Ft){const mt=Ft.uniforms;let Ut=0;for(let wn=0,$n=mt.length;wn<$n;wn++){const wi=Array.isArray(mt[wn])?mt[wn]:[mt[wn]];for(let Nt=0,In=wi.length;Nt<In;Nt++){const dr=wi[Nt],hr=Array.isArray(dr.value)?dr.value:[dr.value];for(let ei=0,Yi=hr.length;ei<Yi;ei++){const or=bt(hr[ei]),rr=Ut%16;0!==rr&&16-rr<or.boundary&&(Ut+=16-rr),dr.__data=new Float32Array(or.storage/Float32Array.BYTES_PER_ELEMENT),dr.__offset=Ut,Ut+=or.storage}}}const bn=Ut%16;bn>0&&(Ut+=16-bn),Ft.__size=Ut,Ft.__cache={}}(Ft),Ut=function Me(Ft){const mt=function Le(){for(let Ft=0;Ft<K;Ft++)if(-1===H.indexOf(Ft))return H.push(Ft),Ft;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();Ft.__bindingPointIndex=mt;const Ut=M.createBuffer(),kn=Ft.__size,bn=Ft.usage;return M.bindBuffer(M.UNIFORM_BUFFER,Ut),M.bufferData(M.UNIFORM_BUFFER,kn,bn),M.bindBuffer(M.UNIFORM_BUFFER,null),M.bindBufferBase(M.UNIFORM_BUFFER,mt,Ut),Ut}(Ft),p[Ft.id]=Ut,Ft.addEventListener("dispose",Ye)),h.updateUBOMapping(Ft,mt.program);const bn=a.render.frame;E[Ft.id]!==bn&&(function Be(Ft){const Ut=Ft.uniforms,kn=Ft.__cache;M.bindBuffer(M.UNIFORM_BUFFER,p[Ft.id]);for(let bn=0,wn=Ut.length;bn<wn;bn++){const $n=Array.isArray(Ut[bn])?Ut[bn]:[Ut[bn]];for(let wi=0,Nt=$n.length;wi<Nt;wi++){const In=$n[wi];if(!0===Ge(In,bn,wi,kn)){const dr=In.__offset,hr=Array.isArray(In.value)?In.value:[In.value];let ei=0;for(let Yi=0;Yi<hr.length;Yi++){const Pi=hr[Yi],or=bt(Pi);"number"==typeof Pi||"boolean"==typeof Pi?(In.__data[0]=Pi,M.bufferSubData(M.UNIFORM_BUFFER,dr+ei,In.__data)):Pi.isMatrix3?(In.__data[0]=Pi.elements[0],In.__data[1]=Pi.elements[1],In.__data[2]=Pi.elements[2],In.__data[3]=0,In.__data[4]=Pi.elements[3],In.__data[5]=Pi.elements[4],In.__data[6]=Pi.elements[5],In.__data[7]=0,In.__data[8]=Pi.elements[6],In.__data[9]=Pi.elements[7],In.__data[10]=Pi.elements[8],In.__data[11]=0):(Pi.toArray(In.__data,ei),ei+=or.storage/Float32Array.BYTES_PER_ELEMENT)}M.bufferSubData(M.UNIFORM_BUFFER,dr,In.__data)}}}M.bindBuffer(M.UNIFORM_BUFFER,null)}(Ft),E[Ft.id]=bn)},dispose:function qe(){for(const Ft in p)M.deleteBuffer(p[Ft]);H=[],p={},E={}}}}class KL{constructor(a={}){const{canvas:c=mi(),context:h=null,depth:p=!0,stencil:E=!0,alpha:H=!1,antialias:K=!1,premultipliedAlpha:de=!0,preserveDrawingBuffer:ge=!1,powerPreference:Me="default",failIfMajorPerformanceCaveat:Le=!1}=a;let Be;this.isWebGLRenderer=!0,Be=null!==h?h.getContextAttributes().alpha:H;const Ge=new Uint32Array(4),it=new Int32Array(4);let bt=null,Ye=null;const qe=[],Ft=[];this.domElement=c,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=rl,this._useLegacyLights=!1,this.toneMapping=gt,this.toneMappingExposure=1;const mt=this;let Ut=!1,kn=0,bn=0,wn=null,$n=-1,wi=null;const Nt=new Za,In=new Za;let dr=null;const hr=new to(0);let ei=0,Yi=c.width,Pi=c.height,or=1,rr=null,nr=null;const Gr=new Za(0,0,Yi,Pi),zr=new Za(0,0,Yi,Pi);let Ps=!1;const Jo=new BA;let Li=!1,Br=!1,Rs=null;const co=new lo,no=new Si,$s=new Dn,_a={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function uo(){return null===wn?or:1}let lr,Yr,_r,zs,Ds,eo,Va,_n,Gt,ji,Zi,Fr,Cr,ea,Oo,ts,fs,ta,Wr,md,Ga,Eo,so,oo,Nn=h;function Jr(un,fi){for(let ki=0;ki<un.length;ki++){const Ti=c.getContext(un[ki],fi);if(null!==Ti)return Ti}return null}try{const un={alpha:!0,depth:p,stencil:E,antialias:K,premultipliedAlpha:de,preserveDrawingBuffer:ge,powerPreference:Me,failIfMajorPerformanceCaveat:Le};if("setAttribute"in c&&c.setAttribute("data-engine",`three.js r${b}`),c.addEventListener("webglcontextlost",ec,!1),c.addEventListener("webglcontextrestored",oi,!1),c.addEventListener("webglcontextcreationerror",gs,!1),null===Nn){const fi=["webgl2","webgl","experimental-webgl"];if(!0===mt.isWebGL1Renderer&&fi.shift(),Nn=Jr(fi,un),null===Nn)throw Jr(fi)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Nn instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Nn.getShaderPrecisionFormat&&(Nn.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(un){throw console.error("THREE.WebGLRenderer: "+un.message),un}function tl(){lr=new ft(Nn),Yr=new td(Nn,lr,a),lr.init(Yr),Eo=new zB(Nn,lr,Yr),_r=new NB(Nn,lr,Yr),zs=new sn(Nn),Ds=new E_,eo=new UB(Nn,lr,_r,Ds,Yr,Eo,zs),Va=new a0(mt),_n=new Ve(mt),Gt=new Og(Nn,Yr),so=new Qm(Nn,lr,Gt,Yr),ji=new kt(Nn,Gt,zs,so),Zi=new ms(Nn,ji,Gt,zs),Wr=new Gi(Nn,Yr,eo),ts=new r0(Ds),Fr=new d0(mt,Va,_n,lr,Yr,so,ts),Cr=new ST(mt,Ds),ea=new u0,Oo=new Uu(lr,Yr),ta=new Cv(mt,Va,_n,_r,Zi,Be,de),fs=new Yx(mt,Zi,Yr),oo=new YL(Nn,zs,Yr,_r),md=new em(Nn,lr,zs,Yr),Ga=new an(Nn,lr,zs,Yr),zs.programs=Fr.programs,mt.capabilities=Yr,mt.extensions=lr,mt.properties=Ds,mt.renderLists=ea,mt.shadowMap=fs,mt.state=_r,mt.info=zs}tl();const la=new Pv(mt,Nn);function ec(un){un.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ut=!0}function oi(){console.log("THREE.WebGLRenderer: Context Restored."),Ut=!1;const un=zs.autoReset,fi=fs.enabled,ki=fs.autoUpdate,zi=fs.needsUpdate,Ti=fs.type;tl(),zs.autoReset=un,fs.enabled=fi,fs.autoUpdate=ki,fs.needsUpdate=zi,fs.type=Ti}function gs(un){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",un.statusMessage)}function Ri(un){const fi=un.target;fi.removeEventListener("dispose",Ri),function ns(un){(function bs(un){const fi=Ds.get(un).programs;void 0!==fi&&(fi.forEach(function(ki){Fr.releaseProgram(ki)}),un.isShaderMaterial&&Fr.releaseShaderCache(un))})(un),Ds.remove(un)}(fi)}function Fa(un,fi,ki){!0===un.transparent&&un.side===ie&&!1===un.forceSinglePass?(un.side=1,un.needsUpdate=!0,iS(un,fi,ki),un.side=O,un.needsUpdate=!0,iS(un,fi,ki),un.side=ie):iS(un,fi,ki)}this.xr=la,this.getContext=function(){return Nn},this.getContextAttributes=function(){return Nn.getContextAttributes()},this.forceContextLoss=function(){const un=lr.get("WEBGL_lose_context");un&&un.loseContext()},this.forceContextRestore=function(){const un=lr.get("WEBGL_lose_context");un&&un.restoreContext()},this.getPixelRatio=function(){return or},this.setPixelRatio=function(un){void 0!==un&&(or=un,this.setSize(Yi,Pi,!1))},this.getSize=function(un){return un.set(Yi,Pi)},this.setSize=function(un,fi,ki=!0){la.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Yi=un,Pi=fi,c.width=Math.floor(un*or),c.height=Math.floor(fi*or),!0===ki&&(c.style.width=un+"px",c.style.height=fi+"px"),this.setViewport(0,0,un,fi))},this.getDrawingBufferSize=function(un){return un.set(Yi*or,Pi*or).floor()},this.setDrawingBufferSize=function(un,fi,ki){Yi=un,Pi=fi,or=ki,c.width=Math.floor(un*ki),c.height=Math.floor(fi*ki),this.setViewport(0,0,un,fi)},this.getCurrentViewport=function(un){return un.copy(Nt)},this.getViewport=function(un){return un.copy(Gr)},this.setViewport=function(un,fi,ki,zi){un.isVector4?Gr.set(un.x,un.y,un.z,un.w):Gr.set(un,fi,ki,zi),_r.viewport(Nt.copy(Gr).multiplyScalar(or).round())},this.getScissor=function(un){return un.copy(zr)},this.setScissor=function(un,fi,ki,zi){un.isVector4?zr.set(un.x,un.y,un.z,un.w):zr.set(un,fi,ki,zi),_r.scissor(In.copy(zr).multiplyScalar(or).round())},this.getScissorTest=function(){return Ps},this.setScissorTest=function(un){_r.setScissorTest(Ps=un)},this.setOpaqueSort=function(un){rr=un},this.setTransparentSort=function(un){nr=un},this.getClearColor=function(un){return un.copy(ta.getClearColor())},this.setClearColor=function(){ta.setClearColor.apply(ta,arguments)},this.getClearAlpha=function(){return ta.getClearAlpha()},this.setClearAlpha=function(){ta.setClearAlpha.apply(ta,arguments)},this.clear=function(un=!0,fi=!0,ki=!0){let zi=0;if(un){let Ti=!1;if(null!==wn){const Ls=wn.texture.format;Ti=1033===Ls||1031===Ls||1029===Ls}if(Ti){const Ls=wn.texture.type,go=Ls===At||Ls===jt||1012===Ls||Ls===Rn||1017===Ls||1018===Ls,No=ta.getClearColor(),na=ta.getClearAlpha(),Oa=No.r,ya=No.g,xa=No.b;go?(Ge[0]=Oa,Ge[1]=ya,Ge[2]=xa,Ge[3]=na,Nn.clearBufferuiv(Nn.COLOR,0,Ge)):(it[0]=Oa,it[1]=ya,it[2]=xa,it[3]=na,Nn.clearBufferiv(Nn.COLOR,0,it))}else zi|=Nn.COLOR_BUFFER_BIT}fi&&(zi|=Nn.DEPTH_BUFFER_BIT),ki&&(zi|=Nn.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Nn.clear(zi)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){c.removeEventListener("webglcontextlost",ec,!1),c.removeEventListener("webglcontextrestored",oi,!1),c.removeEventListener("webglcontextcreationerror",gs,!1),ea.dispose(),Oo.dispose(),Ds.dispose(),Va.dispose(),_n.dispose(),Zi.dispose(),so.dispose(),oo.dispose(),Fr.dispose(),la.dispose(),la.removeEventListener("sessionstart",Df),la.removeEventListener("sessionend",Ql),Rs&&(Rs.dispose(),Rs=null),yh.stop()},this.renderBufferDirect=function(un,fi,ki,zi,Ti,Ls){null===fi&&(fi=_a);const go=Ti.isMesh&&Ti.matrixWorld.determinant()<0,No=function S3(un,fi,ki,zi,Ti){!0!==fi.isScene&&(fi=_a),eo.resetTextureUnits();const Ls=fi.fog,No=null===wn?mt.outputColorSpace:!0===wn.isXRRenderTarget?wn.texture.colorSpace:Yc,na=(zi.isMeshStandardMaterial?_n:Va).get(zi.envMap||(zi.isMeshStandardMaterial?fi.environment:null)),Oa=!0===zi.vertexColors&&!!ki.attributes.color&&4===ki.attributes.color.itemSize,ya=!!ki.attributes.tangent&&(!!zi.normalMap||zi.anisotropy>0),xa=!!ki.morphAttributes.position,Ad=!!ki.morphAttributes.normal,Vh=!!ki.morphAttributes.color;let Ud=gt;zi.toneMapped&&(null===wn||!0===wn.isXRRenderTarget)&&(Ud=mt.toneMapping);const w0=ki.morphAttributes.position||ki.morphAttributes.normal||ki.morphAttributes.color,Wc=void 0!==w0?w0.length:0,Da=Ds.get(zi),T3=Ye.state.lights;!0!==Li||!0!==Br&&un===wi||ts.setState(zi,un,un===wi&&zi.id===$n);let Lc=!1;zi.version===Da.__version?(Da.needsLights&&Da.lightsStateVersion!==T3.state.version||Da.outputColorSpace!==No||Ti.isBatchedMesh&&!1===Da.batching||!Ti.isBatchedMesh&&!0===Da.batching||Ti.isInstancedMesh&&!1===Da.instancing||!Ti.isInstancedMesh&&!0===Da.instancing||Ti.isSkinnedMesh&&!1===Da.skinning||!Ti.isSkinnedMesh&&!0===Da.skinning||Ti.isInstancedMesh&&!0===Da.instancingColor&&null===Ti.instanceColor||Ti.isInstancedMesh&&!1===Da.instancingColor&&null!==Ti.instanceColor||Ti.isInstancedMesh&&!0===Da.instancingMorph&&null===Ti.morphTexture||Ti.isInstancedMesh&&!1===Da.instancingMorph&&null!==Ti.morphTexture||Da.envMap!==na||!0===zi.fog&&Da.fog!==Ls||void 0!==Da.numClippingPlanes&&(Da.numClippingPlanes!==ts.numPlanes||Da.numIntersection!==ts.numIntersection)||Da.vertexAlphas!==Oa||Da.vertexTangents!==ya||Da.morphTargets!==xa||Da.morphNormals!==Ad||Da.morphColors!==Vh||Da.toneMapping!==Ud||!0===Yr.isWebGL2&&Da.morphTargetsCount!==Wc)&&(Lc=!0):(Lc=!0,Da.__version=zi.version);let yy=Da.currentProgram;!0===Lc&&(yy=iS(zi,fi,Ti));let xP=!1,Hw=!1,D3=!1;const Vu=yy.getUniforms(),gp=Da.uniforms;if(_r.useProgram(yy.program)&&(xP=!0,Hw=!0,D3=!0),zi.id!==$n&&($n=zi.id,Hw=!0),xP||wi!==un){Vu.setValue(Nn,"projectionMatrix",un.projectionMatrix),Vu.setValue(Nn,"viewMatrix",un.matrixWorldInverse);const _p=Vu.map.cameraPosition;void 0!==_p&&_p.setValue(Nn,$s.setFromMatrixPosition(un.matrixWorld)),Yr.logarithmicDepthBuffer&&Vu.setValue(Nn,"logDepthBufFC",2/(Math.log(un.far+1)/Math.LN2)),(zi.isMeshPhongMaterial||zi.isMeshToonMaterial||zi.isMeshLambertMaterial||zi.isMeshBasicMaterial||zi.isMeshStandardMaterial||zi.isShaderMaterial)&&Vu.setValue(Nn,"isOrthographic",!0===un.isOrthographicCamera),wi!==un&&(wi=un,Hw=!0,D3=!0)}if(Ti.isSkinnedMesh){Vu.setOptional(Nn,Ti,"bindMatrix"),Vu.setOptional(Nn,Ti,"bindMatrixInverse");const _p=Ti.skeleton;_p&&(Yr.floatVertexTextures?(null===_p.boneTexture&&_p.computeBoneTexture(),Vu.setValue(Nn,"boneTexture",_p.boneTexture,eo)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Ti.isBatchedMesh&&(Vu.setOptional(Nn,Ti,"batchingTexture"),Vu.setValue(Nn,"batchingTexture",Ti._matricesTexture,eo));const H_=ki.morphAttributes;if((void 0!==H_.position||void 0!==H_.normal||void 0!==H_.color&&!0===Yr.isWebGL2)&&Wr.update(Ti,ki,yy),(Hw||Da.receiveShadow!==Ti.receiveShadow)&&(Da.receiveShadow=Ti.receiveShadow,Vu.setValue(Nn,"receiveShadow",Ti.receiveShadow)),zi.isMeshGouraudMaterial&&null!==zi.envMap&&(gp.envMap.value=na,gp.flipEnvMap.value=na.isCubeTexture&&!1===na.isRenderTargetTexture?-1:1),Hw&&(Vu.setValue(Nn,"toneMappingExposure",mt.toneMappingExposure),Da.needsLights&&function E3(un,fi){un.ambientLightColor.needsUpdate=fi,un.lightProbe.needsUpdate=fi,un.directionalLights.needsUpdate=fi,un.directionalLightShadows.needsUpdate=fi,un.pointLights.needsUpdate=fi,un.pointLightShadows.needsUpdate=fi,un.spotLights.needsUpdate=fi,un.spotLightShadows.needsUpdate=fi,un.rectAreaLights.needsUpdate=fi,un.hemisphereLights.needsUpdate=fi}(gp,D3),Ls&&!0===zi.fog&&Cr.refreshFogUniforms(gp,Ls),Cr.refreshMaterialUniforms(gp,zi,or,Pi,Rs),tt.upload(Nn,bP(Da),gp,eo)),zi.isShaderMaterial&&!0===zi.uniformsNeedUpdate&&(tt.upload(Nn,bP(Da),gp,eo),zi.uniformsNeedUpdate=!1),zi.isSpriteMaterial&&Vu.setValue(Nn,"center",Ti.center),Vu.setValue(Nn,"modelViewMatrix",Ti.modelViewMatrix),Vu.setValue(Nn,"normalMatrix",Ti.normalMatrix),Vu.setValue(Nn,"modelMatrix",Ti.matrixWorld),zi.isShaderMaterial||zi.isRawShaderMaterial){const _p=zi.uniformsGroups;for(let I3=0,B3=_p.length;I3<B3;I3++)if(Yr.isWebGL2){const P3=_p[I3];oo.update(P3,yy),oo.bind(P3,yy)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return yy}(un,fi,ki,zi,Ti);_r.setMaterial(zi,go);let na=ki.index,Oa=1;if(!0===zi.wireframe){if(na=ji.getWireframeAttribute(ki),void 0===na)return;Oa=2}const ya=ki.drawRange,xa=ki.attributes.position;let Ad=ya.start*Oa,Vh=(ya.start+ya.count)*Oa;null!==Ls&&(Ad=Math.max(Ad,Ls.start*Oa),Vh=Math.min(Vh,(Ls.start+Ls.count)*Oa)),null!==na?(Ad=Math.max(Ad,0),Vh=Math.min(Vh,na.count)):null!=xa&&(Ad=Math.max(Ad,0),Vh=Math.min(Vh,xa.count));const Ud=Vh-Ad;if(Ud<0||Ud===1/0)return;so.setup(Ti,zi,No,ki,na);let w0,Wc=md;if(null!==na&&(w0=Gt.get(na),Wc=Ga,Wc.setIndex(w0)),Ti.isMesh)!0===zi.wireframe?(_r.setLineWidth(zi.wireframeLinewidth*uo()),Wc.setMode(Nn.LINES)):Wc.setMode(Nn.TRIANGLES);else if(Ti.isLine){let Da=zi.linewidth;void 0===Da&&(Da=1),_r.setLineWidth(Da*uo()),Wc.setMode(Ti.isLineSegments?Nn.LINES:Ti.isLineLoop?Nn.LINE_LOOP:Nn.LINE_STRIP)}else Ti.isPoints?Wc.setMode(Nn.POINTS):Ti.isSprite&&Wc.setMode(Nn.TRIANGLES);if(Ti.isBatchedMesh)Wc.renderMultiDraw(Ti._multiDrawStarts,Ti._multiDrawCounts,Ti._multiDrawCount);else if(Ti.isInstancedMesh)Wc.renderInstances(Ad,Ud,Ti.count);else if(ki.isInstancedBufferGeometry){const T3=Math.min(ki.instanceCount,void 0!==ki._maxInstanceCount?ki._maxInstanceCount:1/0);Wc.renderInstances(Ad,Ud,T3)}else Wc.render(Ad,Ud)},this.compile=function(un,fi,ki=null){null===ki&&(ki=un),Ye=Oo.get(ki),Ye.init(),Ft.push(Ye),ki.traverseVisible(function(Ti){Ti.isLight&&Ti.layers.test(fi.layers)&&(Ye.pushLight(Ti),Ti.castShadow&&Ye.pushShadow(Ti))}),un!==ki&&un.traverseVisible(function(Ti){Ti.isLight&&Ti.layers.test(fi.layers)&&(Ye.pushLight(Ti),Ti.castShadow&&Ye.pushShadow(Ti))}),Ye.setupLights(mt._useLegacyLights);const zi=new Set;return un.traverse(function(Ti){const Ls=Ti.material;if(Ls)if(Array.isArray(Ls))for(let go=0;go<Ls.length;go++){const No=Ls[go];Fa(No,ki,Ti),zi.add(No)}else Fa(Ls,ki,Ti),zi.add(Ls)}),Ft.pop(),Ye=null,zi},this.compileAsync=function(un,fi,ki=null){const zi=this.compile(un,fi,ki);return new Promise(Ti=>{function Ls(){zi.forEach(function(go){Ds.get(go).currentProgram.isReady()&&zi.delete(go)}),0!==zi.size?setTimeout(Ls,10):Ti(un)}null!==lr.get("KHR_parallel_shader_compile")?Ls():setTimeout(Ls,10)})};let zl=null;function Df(){yh.stop()}function Ql(){yh.start()}const yh=new lf;function lm(un,fi,ki,zi){if(!1===un.visible)return;if(un.layers.test(fi.layers))if(un.isGroup)ki=un.renderOrder;else if(un.isLOD)!0===un.autoUpdate&&un.update(fi);else if(un.isLight)Ye.pushLight(un),un.castShadow&&Ye.pushShadow(un);else if(un.isSprite){if(!un.frustumCulled||Jo.intersectsSprite(un)){zi&&$s.setFromMatrixPosition(un.matrixWorld).applyMatrix4(co);const go=Zi.update(un),No=un.material;No.visible&&bt.push(un,go,No,ki,$s.z,null)}}else if((un.isMesh||un.isLine||un.isPoints)&&(!un.frustumCulled||Jo.intersectsObject(un))){const go=Zi.update(un),No=un.material;if(zi&&(void 0!==un.boundingSphere?(null===un.boundingSphere&&un.computeBoundingSphere(),$s.copy(un.boundingSphere.center)):(null===go.boundingSphere&&go.computeBoundingSphere(),$s.copy(go.boundingSphere.center)),$s.applyMatrix4(un.matrixWorld).applyMatrix4(co)),Array.isArray(No)){const na=go.groups;for(let Oa=0,ya=na.length;Oa<ya;Oa++){const xa=na[Oa],Ad=No[xa.materialIndex];Ad&&Ad.visible&&bt.push(un,go,Ad,ki,$s.z,xa)}}else No.visible&&bt.push(un,go,No,ki,$s.z,null)}const Ls=un.children;for(let go=0,No=Ls.length;go<No;go++)lm(Ls[go],fi,ki,zi)}function M3(un,fi,ki,zi){const Ti=un.opaque,Ls=un.transmissive,go=un.transparent;Ye.setupLightsView(ki),!0===Li&&ts.setGlobalState(mt.clippingPlanes,ki),Ls.length>0&&function nS(un,fi,ki,zi){if(null!==(!0===ki.isScene?ki.overrideMaterial:null))return;const Ls=Yr.isWebGL2;null===Rs&&(Rs=new ku(1,1,{generateMipmaps:!0,type:lr.has("EXT_color_buffer_half_float")?ln:At,minFilter:me,samples:Ls?4:0})),mt.getDrawingBufferSize(no),Ls?Rs.setSize(no.x,no.y):Rs.setSize(Ll(no.x),Ll(no.y));const go=mt.getRenderTarget();mt.setRenderTarget(Rs),mt.getClearColor(hr),ei=mt.getClearAlpha(),ei<1&&mt.setClearColor(16777215,.5),mt.clear();const No=mt.toneMapping;mt.toneMapping=gt,nb(un,ki,zi),eo.updateMultisampleRenderTarget(Rs),eo.updateRenderTargetMipmap(Rs);let na=!1;for(let Oa=0,ya=fi.length;Oa<ya;Oa++){const xa=fi[Oa],Ad=xa.object,Vh=xa.geometry,Ud=xa.material,w0=xa.group;if(Ud.side===ie&&Ad.layers.test(zi.layers)){const Wc=Ud.side;Ud.side=1,Ud.needsUpdate=!0,ib(Ad,ki,zi,Vh,Ud,w0),Ud.side=Wc,Ud.needsUpdate=!0,na=!0}}!0===na&&(eo.updateMultisampleRenderTarget(Rs),eo.updateRenderTargetMipmap(Rs)),mt.setRenderTarget(go),mt.setClearColor(hr,ei),mt.toneMapping=No}(Ti,Ls,fi,ki),zi&&_r.viewport(Nt.copy(zi)),Ti.length>0&&nb(Ti,fi,ki),Ls.length>0&&nb(Ls,fi,ki),go.length>0&&nb(go,fi,ki),_r.buffers.depth.setTest(!0),_r.buffers.depth.setMask(!0),_r.buffers.color.setMask(!0),_r.setPolygonOffset(!1)}function nb(un,fi,ki){const zi=!0===fi.isScene?fi.overrideMaterial:null;for(let Ti=0,Ls=un.length;Ti<Ls;Ti++){const go=un[Ti],No=go.object,na=go.geometry,Oa=null===zi?go.material:zi,ya=go.group;No.layers.test(ki.layers)&&ib(No,fi,ki,na,Oa,ya)}}function ib(un,fi,ki,zi,Ti,Ls){un.onBeforeRender(mt,fi,ki,zi,Ti,Ls),un.modelViewMatrix.multiplyMatrices(ki.matrixWorldInverse,un.matrixWorld),un.normalMatrix.getNormalMatrix(un.modelViewMatrix),Ti.onBeforeRender(mt,fi,ki,zi,un,Ls),!0===Ti.transparent&&Ti.side===ie&&!1===Ti.forceSinglePass?(Ti.side=1,Ti.needsUpdate=!0,mt.renderBufferDirect(ki,fi,zi,Ti,un,Ls),Ti.side=O,Ti.needsUpdate=!0,mt.renderBufferDirect(ki,fi,zi,Ti,un,Ls),Ti.side=ie):mt.renderBufferDirect(ki,fi,zi,Ti,un,Ls),un.onAfterRender(mt,fi,ki,zi,Ti,Ls)}function iS(un,fi,ki){!0!==fi.isScene&&(fi=_a);const zi=Ds.get(un),Ti=Ye.state.lights,go=Ti.state.version,No=Fr.getParameters(un,Ti.state,Ye.state.shadowsArray,fi,ki),na=Fr.getProgramCacheKey(No);let Oa=zi.programs;zi.environment=un.isMeshStandardMaterial?fi.environment:null,zi.fog=fi.fog,zi.envMap=(un.isMeshStandardMaterial?_n:Va).get(un.envMap||zi.environment),zi.envMapRotation=null!==zi.environment&&null===un.envMap?fi.environmentRotation:un.envMapRotation,void 0===Oa&&(un.addEventListener("dispose",Ri),Oa=new Map,zi.programs=Oa);let ya=Oa.get(na);if(void 0!==ya){if(zi.currentProgram===ya&&zi.lightsStateVersion===go)return rS(un,No),ya}else No.uniforms=Fr.getUniforms(un),un.onBuild(ki,No,mt),un.onBeforeCompile(No,mt),ya=Fr.acquireProgram(No,na),Oa.set(na,ya),zi.uniforms=No.uniforms;const xa=zi.uniforms;return(!un.isShaderMaterial&&!un.isRawShaderMaterial||!0===un.clipping)&&(xa.clippingPlanes=ts.uniform),rS(un,No),zi.needsLights=function sS(un){return un.isMeshLambertMaterial||un.isMeshToonMaterial||un.isMeshPhongMaterial||un.isMeshStandardMaterial||un.isShadowMaterial||un.isShaderMaterial&&!0===un.lights}(un),zi.lightsStateVersion=go,zi.needsLights&&(xa.ambientLightColor.value=Ti.state.ambient,xa.lightProbe.value=Ti.state.probe,xa.directionalLights.value=Ti.state.directional,xa.directionalLightShadows.value=Ti.state.directionalShadow,xa.spotLights.value=Ti.state.spot,xa.spotLightShadows.value=Ti.state.spotShadow,xa.rectAreaLights.value=Ti.state.rectArea,xa.ltc_1.value=Ti.state.rectAreaLTC1,xa.ltc_2.value=Ti.state.rectAreaLTC2,xa.pointLights.value=Ti.state.point,xa.pointLightShadows.value=Ti.state.pointShadow,xa.hemisphereLights.value=Ti.state.hemi,xa.directionalShadowMap.value=Ti.state.directionalShadowMap,xa.directionalShadowMatrix.value=Ti.state.directionalShadowMatrix,xa.spotShadowMap.value=Ti.state.spotShadowMap,xa.spotLightMatrix.value=Ti.state.spotLightMatrix,xa.spotLightMap.value=Ti.state.spotLightMap,xa.pointShadowMap.value=Ti.state.pointShadowMap,xa.pointShadowMatrix.value=Ti.state.pointShadowMatrix),zi.currentProgram=ya,zi.uniformsList=null,ya}function bP(un){if(null===un.uniformsList){const fi=un.currentProgram.getUniforms();un.uniformsList=tt.seqWithValue(fi.seq,un.uniforms)}return un.uniformsList}function rS(un,fi){const ki=Ds.get(un);ki.outputColorSpace=fi.outputColorSpace,ki.batching=fi.batching,ki.instancing=fi.instancing,ki.instancingColor=fi.instancingColor,ki.instancingMorph=fi.instancingMorph,ki.skinning=fi.skinning,ki.morphTargets=fi.morphTargets,ki.morphNormals=fi.morphNormals,ki.morphColors=fi.morphColors,ki.morphTargetsCount=fi.morphTargetsCount,ki.numClippingPlanes=fi.numClippingPlanes,ki.numIntersection=fi.numClipIntersection,ki.vertexAlphas=fi.vertexAlphas,ki.vertexTangents=fi.vertexTangents,ki.toneMapping=fi.toneMapping}yh.setAnimationLoop(function Jd(un){zl&&zl(un)}),typeof self<"u"&&yh.setContext(self),this.setAnimationLoop=function(un){zl=un,la.setAnimationLoop(un),null===un?yh.stop():yh.start()},la.addEventListener("sessionstart",Df),la.addEventListener("sessionend",Ql),this.render=function(un,fi){if(void 0===fi||!0===fi.isCamera){if(!0!==Ut){if(!0===un.matrixWorldAutoUpdate&&un.updateMatrixWorld(),null===fi.parent&&!0===fi.matrixWorldAutoUpdate&&fi.updateMatrixWorld(),!0===la.enabled&&!0===la.isPresenting&&(!0===la.cameraAutoUpdate&&la.updateCamera(fi),fi=la.getCamera()),!0===un.isScene&&un.onBeforeRender(mt,un,fi,wn),Ye=Oo.get(un,Ft.length),Ye.init(),Ft.push(Ye),co.multiplyMatrices(fi.projectionMatrix,fi.matrixWorldInverse),Jo.setFromProjectionMatrix(co),Br=this.localClippingEnabled,Li=ts.init(this.clippingPlanes,Br),bt=ea.get(un,qe.length),bt.init(),qe.push(bt),lm(un,fi,0,mt.sortObjects),bt.finish(),!0===mt.sortObjects&&bt.sort(rr,nr),this.info.render.frame++,!0===Li&&ts.beginShadows(),fs.render(Ye.state.shadowsArray,un,fi),!0===Li&&ts.endShadows(),!0===this.info.autoReset&&this.info.reset(),(!1===la.enabled||!1===la.isPresenting||!1===la.hasDepthSensing())&&ta.render(bt,un),Ye.setupLights(mt._useLegacyLights),fi.isArrayCamera){const zi=fi.cameras;for(let Ti=0,Ls=zi.length;Ti<Ls;Ti++){const go=zi[Ti];M3(bt,un,go,go.viewport)}}else M3(bt,un,fi);null!==wn&&(eo.updateMultisampleRenderTarget(wn),eo.updateRenderTargetMipmap(wn)),!0===un.isScene&&un.onAfterRender(mt,un,fi),so.resetDefaultState(),$n=-1,wi=null,Ft.pop(),Ye=Ft.length>0?Ft[Ft.length-1]:null,qe.pop(),bt=qe.length>0?qe[qe.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return kn},this.getActiveMipmapLevel=function(){return bn},this.getRenderTarget=function(){return wn},this.setRenderTargetTextures=function(un,fi,ki){Ds.get(un.texture).__webglTexture=fi,Ds.get(un.depthTexture).__webglTexture=ki;const zi=Ds.get(un);zi.__hasExternalTextures=!0,zi.__autoAllocateDepthBuffer=void 0===ki,zi.__autoAllocateDepthBuffer||!0===lr.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),zi.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(un,fi){const ki=Ds.get(un);ki.__webglFramebuffer=fi,ki.__useDefaultFramebuffer=void 0===fi},this.setRenderTarget=function(un,fi=0,ki=0){wn=un,kn=fi,bn=ki;let zi=!0,Ti=null,Ls=!1,go=!1;if(un){const na=Ds.get(un);void 0!==na.__useDefaultFramebuffer?(_r.bindFramebuffer(Nn.FRAMEBUFFER,null),zi=!1):void 0===na.__webglFramebuffer?eo.setupRenderTarget(un):na.__hasExternalTextures&&eo.rebindTextures(un,Ds.get(un.texture).__webglTexture,Ds.get(un.depthTexture).__webglTexture);const Oa=un.texture;(Oa.isData3DTexture||Oa.isDataArrayTexture||Oa.isCompressedArrayTexture)&&(go=!0);const ya=Ds.get(un).__webglFramebuffer;un.isWebGLCubeRenderTarget?(Ti=Array.isArray(ya[fi])?ya[fi][ki]:ya[fi],Ls=!0):Ti=Yr.isWebGL2&&un.samples>0&&!1===eo.useMultisampledRTT(un)?Ds.get(un).__webglMultisampledFramebuffer:Array.isArray(ya)?ya[ki]:ya,Nt.copy(un.viewport),In.copy(un.scissor),dr=un.scissorTest}else Nt.copy(Gr).multiplyScalar(or).floor(),In.copy(zr).multiplyScalar(or).floor(),dr=Ps;if(_r.bindFramebuffer(Nn.FRAMEBUFFER,Ti)&&Yr.drawBuffers&&zi&&_r.drawBuffers(un,Ti),_r.viewport(Nt),_r.scissor(In),_r.setScissorTest(dr),Ls){const na=Ds.get(un.texture);Nn.framebufferTexture2D(Nn.FRAMEBUFFER,Nn.COLOR_ATTACHMENT0,Nn.TEXTURE_CUBE_MAP_POSITIVE_X+fi,na.__webglTexture,ki)}else if(go){const na=Ds.get(un.texture);Nn.framebufferTextureLayer(Nn.FRAMEBUFFER,Nn.COLOR_ATTACHMENT0,na.__webglTexture,ki||0,fi||0)}$n=-1},this.readRenderTargetPixels=function(un,fi,ki,zi,Ti,Ls,go){if(!un||!un.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let No=Ds.get(un).__webglFramebuffer;if(un.isWebGLCubeRenderTarget&&void 0!==go&&(No=No[go]),No){_r.bindFramebuffer(Nn.FRAMEBUFFER,No);try{const na=un.texture,Oa=na.format,ya=na.type;if(Oa!==Fn&&Eo.convert(Oa)!==Nn.getParameter(Nn.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const xa=ya===ln&&(lr.has("EXT_color_buffer_half_float")||Yr.isWebGL2&&lr.has("EXT_color_buffer_float"));if(!(ya===At||Eo.convert(ya)===Nn.getParameter(Nn.IMPLEMENTATION_COLOR_READ_TYPE)||ya===Cn&&(Yr.isWebGL2||lr.has("OES_texture_float")||lr.has("WEBGL_color_buffer_float"))||xa))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");fi>=0&&fi<=un.width-zi&&ki>=0&&ki<=un.height-Ti&&Nn.readPixels(fi,ki,zi,Ti,Eo.convert(Oa),Eo.convert(ya),Ls)}finally{const na=null!==wn?Ds.get(wn).__webglFramebuffer:null;_r.bindFramebuffer(Nn.FRAMEBUFFER,na)}}},this.copyFramebufferToTexture=function(un,fi,ki=0){const zi=Math.pow(2,-ki),Ti=Math.floor(fi.image.width*zi),Ls=Math.floor(fi.image.height*zi);eo.setTexture2D(fi,0),Nn.copyTexSubImage2D(Nn.TEXTURE_2D,ki,0,0,un.x,un.y,Ti,Ls),_r.unbindTexture()},this.copyTextureToTexture=function(un,fi,ki,zi=0){const Ti=fi.image.width,Ls=fi.image.height,go=Eo.convert(ki.format),No=Eo.convert(ki.type);eo.setTexture2D(ki,0),Nn.pixelStorei(Nn.UNPACK_FLIP_Y_WEBGL,ki.flipY),Nn.pixelStorei(Nn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ki.premultiplyAlpha),Nn.pixelStorei(Nn.UNPACK_ALIGNMENT,ki.unpackAlignment),fi.isDataTexture?Nn.texSubImage2D(Nn.TEXTURE_2D,zi,un.x,un.y,Ti,Ls,go,No,fi.image.data):fi.isCompressedTexture?Nn.compressedTexSubImage2D(Nn.TEXTURE_2D,zi,un.x,un.y,fi.mipmaps[0].width,fi.mipmaps[0].height,go,fi.mipmaps[0].data):Nn.texSubImage2D(Nn.TEXTURE_2D,zi,un.x,un.y,go,No,fi.image),0===zi&&ki.generateMipmaps&&Nn.generateMipmap(Nn.TEXTURE_2D),_r.unbindTexture()},this.copyTextureToTexture3D=function(un,fi,ki,zi,Ti=0){if(mt.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ls=Math.round(un.max.x-un.min.x),go=Math.round(un.max.y-un.min.y),No=un.max.z-un.min.z+1,na=Eo.convert(zi.format),Oa=Eo.convert(zi.type);let ya;if(zi.isData3DTexture)eo.setTexture3D(zi,0),ya=Nn.TEXTURE_3D;else{if(!zi.isDataArrayTexture&&!zi.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");eo.setTexture2DArray(zi,0),ya=Nn.TEXTURE_2D_ARRAY}Nn.pixelStorei(Nn.UNPACK_FLIP_Y_WEBGL,zi.flipY),Nn.pixelStorei(Nn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,zi.premultiplyAlpha),Nn.pixelStorei(Nn.UNPACK_ALIGNMENT,zi.unpackAlignment);const xa=Nn.getParameter(Nn.UNPACK_ROW_LENGTH),Ad=Nn.getParameter(Nn.UNPACK_IMAGE_HEIGHT),Vh=Nn.getParameter(Nn.UNPACK_SKIP_PIXELS),Ud=Nn.getParameter(Nn.UNPACK_SKIP_ROWS),w0=Nn.getParameter(Nn.UNPACK_SKIP_IMAGES),Wc=ki.isCompressedTexture?ki.mipmaps[Ti]:ki.image;Nn.pixelStorei(Nn.UNPACK_ROW_LENGTH,Wc.width),Nn.pixelStorei(Nn.UNPACK_IMAGE_HEIGHT,Wc.height),Nn.pixelStorei(Nn.UNPACK_SKIP_PIXELS,un.min.x),Nn.pixelStorei(Nn.UNPACK_SKIP_ROWS,un.min.y),Nn.pixelStorei(Nn.UNPACK_SKIP_IMAGES,un.min.z),ki.isDataTexture||ki.isData3DTexture?Nn.texSubImage3D(ya,Ti,fi.x,fi.y,fi.z,Ls,go,No,na,Oa,Wc.data):zi.isCompressedArrayTexture?Nn.compressedTexSubImage3D(ya,Ti,fi.x,fi.y,fi.z,Ls,go,No,na,Wc.data):Nn.texSubImage3D(ya,Ti,fi.x,fi.y,fi.z,Ls,go,No,na,Oa,Wc),Nn.pixelStorei(Nn.UNPACK_ROW_LENGTH,xa),Nn.pixelStorei(Nn.UNPACK_IMAGE_HEIGHT,Ad),Nn.pixelStorei(Nn.UNPACK_SKIP_PIXELS,Vh),Nn.pixelStorei(Nn.UNPACK_SKIP_ROWS,Ud),Nn.pixelStorei(Nn.UNPACK_SKIP_IMAGES,w0),0===Ti&&zi.generateMipmaps&&Nn.generateMipmap(ya),_r.unbindTexture()},this.initTexture=function(un){un.isCubeTexture?eo.setTextureCube(un,0):un.isData3DTexture?eo.setTexture3D(un,0):un.isDataArrayTexture||un.isCompressedArrayTexture?eo.setTexture2DArray(un,0):eo.setTexture2D(un,0),_r.unbindTexture()},this.resetState=function(){kn=0,bn=0,wn=null,_r.reset(),so.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return pi}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=a;const c=this.getContext();c.drawingBufferColorSpace=a===Iu?"display-p3":"srgb",c.unpackColorSpace=va.workingColorSpace===Kc?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(a){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=a}}class pM{constructor(a,c=1,h=1e3){this.isFog=!0,this.name="",this.color=new to(a),this.near=c,this.far=h}clone(){return new pM(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Zx extends Nl{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ec,this.environmentRotation=new Ec,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,c){return super.copy(a,c),null!==a.background&&(this.background=a.background.clone()),null!==a.environment&&(this.environment=a.environment.clone()),null!==a.fog&&(this.fog=a.fog.clone()),this.backgroundBlurriness=a.backgroundBlurriness,this.backgroundIntensity=a.backgroundIntensity,this.backgroundRotation.copy(a.backgroundRotation),this.environmentRotation.copy(a.environmentRotation),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.matrixAutoUpdate=a.matrixAutoUpdate,this}toJSON(a){const c=super.toJSON(a);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(c.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(c.object.backgroundIntensity=this.backgroundIntensity),c.object.backgroundRotation=this.backgroundRotation.toArray(),c.object.environmentRotation=this.environmentRotation.toArray(),c}}class T_ extends pl{constructor(a,c,h,p=1){super(a,c,h),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=p}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}toJSON(){const a=super.toJSON();return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}class ey extends $d{constructor(a=null,c=1,h=1,p,E,H,K,de,ge=Xi,Me=Xi,Le,Be){super(null,H,K,de,ge,Me,p,E,Le,Be),this.isDataTexture=!0,this.image={data:a,width:c,height:h},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Rv=new lo,mM=new lo,Jx=[],ET=new Ys,GB=new lo,kv=new gl,Fv=new sc;class AM extends gl{constructor(a,c,h){super(a,c),this.isInstancedMesh=!0,this.instanceMatrix=new T_(new Float32Array(16*h),16),this.instanceColor=null,this.morphTexture=null,this.count=h,this.boundingBox=null,this.boundingSphere=null;for(let p=0;p<h;p++)this.setMatrixAt(p,GB)}computeBoundingBox(){const a=this.geometry,c=this.count;null===this.boundingBox&&(this.boundingBox=new Ys),null===a.boundingBox&&a.computeBoundingBox(),this.boundingBox.makeEmpty();for(let h=0;h<c;h++)this.getMatrixAt(h,Rv),ET.copy(a.boundingBox).applyMatrix4(Rv),this.boundingBox.union(ET)}computeBoundingSphere(){const a=this.geometry,c=this.count;null===this.boundingSphere&&(this.boundingSphere=new sc),null===a.boundingSphere&&a.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let h=0;h<c;h++)this.getMatrixAt(h,Rv),Fv.copy(a.boundingSphere).applyMatrix4(Rv),this.boundingSphere.union(Fv)}copy(a,c){return super.copy(a,c),this.instanceMatrix.copy(a.instanceMatrix),null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),this}getColorAt(a,c){c.fromArray(this.instanceColor.array,3*a)}getMatrixAt(a,c){c.fromArray(this.instanceMatrix.array,16*a)}getMorphAt(a,c){const h=c.morphTargetInfluences,p=this.morphTexture.source.data.data,H=a*(h.length+1)+1;for(let K=0;K<h.length;K++)h[K]=p[H+K]}raycast(a,c){const h=this.matrixWorld,p=this.count;if(kv.geometry=this.geometry,kv.material=this.material,void 0!==kv.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Fv.copy(this.boundingSphere),Fv.applyMatrix4(h),!1!==a.ray.intersectsSphere(Fv)))for(let E=0;E<p;E++){this.getMatrixAt(E,Rv),mM.multiplyMatrices(h,Rv),kv.matrixWorld=mM,kv.raycast(a,Jx);for(let H=0,K=Jx.length;H<K;H++){const de=Jx[H];de.instanceId=E,de.object=this,c.push(de)}Jx.length=0}}setColorAt(a,c){null===this.instanceColor&&(this.instanceColor=new T_(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*a)}setMatrixAt(a,c){c.toArray(this.instanceMatrix.array,16*a)}setMorphAt(a,c){const h=c.morphTargetInfluences,p=h.length+1;null===this.morphTexture&&(this.morphTexture=new ey(new Float32Array(p*this.count),p,this.count,1028,Cn));const E=this.morphTexture.source.data.data;let H=0;for(let ge=0;ge<h.length;ge++)H+=h[ge];const de=p*a;E[de]=this.geometry.morphTargetsRelative?1:1-H,E.set(h,de+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ty extends Ic{constructor(a){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new to(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.fog=a.fog,this}}const TT=new Dn,DT=new Dn,gM=new lo,ny=new uf,Ov=new sc;class iy extends Nl{constructor(a=new us,c=new ty){super(),this.isLine=!0,this.type="Line",this.geometry=a,this.material=c,this.updateMorphTargets()}copy(a,c){return super.copy(a,c),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}computeLineDistances(){const a=this.geometry;if(null===a.index){const c=a.attributes.position,h=[0];for(let p=1,E=c.count;p<E;p++)TT.fromBufferAttribute(c,p-1),DT.fromBufferAttribute(c,p),h[p]=h[p-1],h[p]+=TT.distanceTo(DT);a.setAttribute("lineDistance",new xo(h,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,c){const h=this.geometry,p=this.matrixWorld,E=a.params.Line.threshold,H=h.drawRange;if(null===h.boundingSphere&&h.computeBoundingSphere(),Ov.copy(h.boundingSphere),Ov.applyMatrix4(p),Ov.radius+=E,!1===a.ray.intersectsSphere(Ov))return;gM.copy(p).invert(),ny.copy(a.ray).applyMatrix4(gM);const K=E/((this.scale.x+this.scale.y+this.scale.z)/3),de=K*K,ge=new Dn,Me=new Dn,Le=new Dn,Be=new Dn,Ge=this.isLineSegments?2:1,it=h.index,Ye=h.attributes.position;if(null!==it)for(let mt=Math.max(0,H.start),Ut=Math.min(it.count,H.start+H.count)-1;mt<Ut;mt+=Ge){const kn=it.getX(mt),bn=it.getX(mt+1);if(ge.fromBufferAttribute(Ye,kn),Me.fromBufferAttribute(Ye,bn),ny.distanceSqToSegment(ge,Me,Be,Le)>de)continue;Be.applyMatrix4(this.matrixWorld);const $n=a.ray.origin.distanceTo(Be);$n<a.near||$n>a.far||c.push({distance:$n,point:Le.clone().applyMatrix4(this.matrixWorld),index:mt,face:null,faceIndex:null,object:this})}else for(let mt=Math.max(0,H.start),Ut=Math.min(Ye.count,H.start+H.count)-1;mt<Ut;mt+=Ge){if(ge.fromBufferAttribute(Ye,mt),Me.fromBufferAttribute(Ye,mt+1),ny.distanceSqToSegment(ge,Me,Be,Le)>de)continue;Be.applyMatrix4(this.matrixWorld);const bn=a.ray.origin.distanceTo(Be);bn<a.near||bn>a.far||c.push({distance:bn,point:Le.clone().applyMatrix4(this.matrixWorld),index:mt,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const c=this.geometry.morphAttributes,h=Object.keys(c);if(h.length>0){const p=c[h[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,H=p.length;E<H;E++){const K=p[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[K]=E}}}}}const IT=new Dn,Zd=new Dn;class BT extends iy{constructor(a,c){super(a,c),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const a=this.geometry;if(null===a.index){const c=a.attributes.position,h=[];for(let p=0,E=c.count;p<E;p+=2)IT.fromBufferAttribute(c,p),Zd.fromBufferAttribute(c,p+1),h[p]=0===p?0:h[p-1],h[p+1]=h[p]+IT.distanceTo(Zd);a.setAttribute("lineDistance",new xo(h,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class ry extends Ic{constructor(a){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new to(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}const _M=new lo,yM=new uf,ew=new sc,tw=new Dn;class PT extends Nl{constructor(a=new us,c=new ry){super(),this.isPoints=!0,this.type="Points",this.geometry=a,this.material=c,this.updateMorphTargets()}copy(a,c){return super.copy(a,c),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}raycast(a,c){const h=this.geometry,p=this.matrixWorld,E=a.params.Points.threshold,H=h.drawRange;if(null===h.boundingSphere&&h.computeBoundingSphere(),ew.copy(h.boundingSphere),ew.applyMatrix4(p),ew.radius+=E,!1===a.ray.intersectsSphere(ew))return;_M.copy(p).invert(),yM.copy(a.ray).applyMatrix4(_M);const K=E/((this.scale.x+this.scale.y+this.scale.z)/3),de=K*K,ge=h.index,Le=h.attributes.position;if(null!==ge)for(let it=Math.max(0,H.start),bt=Math.min(ge.count,H.start+H.count);it<bt;it++){const Ye=ge.getX(it);tw.fromBufferAttribute(Le,Ye),vM(tw,Ye,de,p,a,c,this)}else for(let it=Math.max(0,H.start),bt=Math.min(Le.count,H.start+H.count);it<bt;it++)tw.fromBufferAttribute(Le,it),vM(tw,it,de,p,a,c,this)}updateMorphTargets(){const c=this.geometry.morphAttributes,h=Object.keys(c);if(h.length>0){const p=c[h[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,H=p.length;E<H;E++){const K=p[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[K]=E}}}}}function vM(M,a,c,h,p,E,H){const K=yM.distanceSqToPoint(M);if(K<c){const de=new Dn;yM.closestPointToPoint(M,de),de.applyMatrix4(h);const ge=p.ray.origin.distanceTo(de);if(ge<p.near||ge>p.far)return;E.push({distance:ge,distanceToRay:Math.sqrt(K),point:de,index:a,face:null,object:H})}}class ZL extends $d{constructor(a,c,h,p,E,H,K,de,ge){super(a,c,h,p,E,H,K,de,ge),this.isCanvasTexture=!0,this.needsUpdate=!0}}class KA{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(a,c){const h=this.getUtoTmapping(a);return this.getPoint(h,c)}getPoints(a=5){const c=[];for(let h=0;h<=a;h++)c.push(this.getPoint(h/a));return c}getSpacedPoints(a=5){const c=[];for(let h=0;h<=a;h++)c.push(this.getPointAt(h/a));return c}getLength(){const a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let h,p=this.getPoint(0),E=0;c.push(0);for(let H=1;H<=a;H++)h=this.getPoint(H/a),E+=h.distanceTo(p),c.push(E),p=h;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(a,c){const h=this.getLengths();let p=0;const E=h.length;let H;H=c||a*h[E-1];let ge,K=0,de=E-1;for(;K<=de;)if(p=Math.floor(K+(de-K)/2),ge=h[p]-H,ge<0)K=p+1;else{if(!(ge>0)){de=p;break}de=p-1}if(p=de,h[p]===H)return p/(E-1);const Me=h[p];return(p+(H-Me)/(h[p+1]-Me))/(E-1)}getTangent(a,c){let p=a-1e-4,E=a+1e-4;p<0&&(p=0),E>1&&(E=1);const H=this.getPoint(p),K=this.getPoint(E),de=c||(H.isVector2?new Si:new Dn);return de.copy(K).sub(H).normalize(),de}getTangentAt(a,c){const h=this.getUtoTmapping(a);return this.getTangent(h,c)}computeFrenetFrames(a,c){const h=new Dn,p=[],E=[],H=[],K=new Dn,de=new lo;for(let Ge=0;Ge<=a;Ge++)p[Ge]=this.getTangentAt(Ge/a,new Dn);E[0]=new Dn,H[0]=new Dn;let ge=Number.MAX_VALUE;const Me=Math.abs(p[0].x),Le=Math.abs(p[0].y),Be=Math.abs(p[0].z);Me<=ge&&(ge=Me,h.set(1,0,0)),Le<=ge&&(ge=Le,h.set(0,1,0)),Be<=ge&&h.set(0,0,1),K.crossVectors(p[0],h).normalize(),E[0].crossVectors(p[0],K),H[0].crossVectors(p[0],E[0]);for(let Ge=1;Ge<=a;Ge++){if(E[Ge]=E[Ge-1].clone(),H[Ge]=H[Ge-1].clone(),K.crossVectors(p[Ge-1],p[Ge]),K.length()>Number.EPSILON){K.normalize();const it=Math.acos(Gl(p[Ge-1].dot(p[Ge]),-1,1));E[Ge].applyMatrix4(de.makeRotationAxis(K,it))}H[Ge].crossVectors(p[Ge],E[Ge])}if(!0===c){let Ge=Math.acos(Gl(E[0].dot(E[a]),-1,1));Ge/=a,p[0].dot(K.crossVectors(E[0],E[a]))>0&&(Ge=-Ge);for(let it=1;it<=a;it++)E[it].applyMatrix4(de.makeRotationAxis(p[it],Ge*it)),H[it].crossVectors(p[it],E[it])}return{tangents:p,normals:E,binormals:H}}clone(){return(new this.constructor).copy(this)}copy(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}toJSON(){const a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a}fromJSON(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}class D_ extends KA{constructor(a=0,c=0,h=1,p=1,E=0,H=2*Math.PI,K=!1,de=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=a,this.aY=c,this.xRadius=h,this.yRadius=p,this.aStartAngle=E,this.aEndAngle=H,this.aClockwise=K,this.aRotation=de}getPoint(a,c=new Si){const h=c,p=2*Math.PI;let E=this.aEndAngle-this.aStartAngle;const H=Math.abs(E)<Number.EPSILON;for(;E<0;)E+=p;for(;E>p;)E-=p;E<Number.EPSILON&&(E=H?0:p),!0===this.aClockwise&&!H&&(E===p?E=-p:E-=p);const K=this.aStartAngle+a*E;let de=this.aX+this.xRadius*Math.cos(K),ge=this.aY+this.yRadius*Math.sin(K);if(0!==this.aRotation){const Me=Math.cos(this.aRotation),Le=Math.sin(this.aRotation),Be=de-this.aX,Ge=ge-this.aY;de=Be*Me-Ge*Le+this.aX,ge=Be*Le+Ge*Me+this.aY}return h.set(de,ge)}copy(a){return super.copy(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}toJSON(){const a=super.toJSON();return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a}fromJSON(a){return super.fromJSON(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}}function bM(){let M=0,a=0,c=0,h=0;function p(E,H,K,de){M=E,a=K,c=-3*E+3*H-2*K-de,h=2*E-2*H+K+de}return{initCatmullRom:function(E,H,K,de,ge){p(H,K,ge*(K-E),ge*(de-H))},initNonuniformCatmullRom:function(E,H,K,de,ge,Me,Le){let Be=(H-E)/ge-(K-E)/(ge+Me)+(K-H)/Me,Ge=(K-H)/Me-(de-H)/(Me+Le)+(de-K)/Le;Be*=Me,Ge*=Me,p(H,K,Be,Ge)},calc:function(E){const H=E*E;return M+a*E+c*H+h*(H*E)}}}const nw=new Dn,iw=new bM,xM=new bM,wM=new bM;function RT(M,a,c,h,p){const E=.5*(h-a),H=.5*(p-c),K=M*M;return(2*c-2*h+E+H)*(M*K)+(-3*c+3*h-2*E-H)*K+E*M+c}function rw(M,a,c,h){return function jB(M,a){const c=1-M;return c*c*a}(M,a)+function $B(M,a){return 2*(1-M)*M*a}(M,c)+function CM(M,a){return M*M*a}(M,h)}function sw(M,a,c,h,p){return function JL(M,a){const c=1-M;return c*c*c*a}(M,a)+function MM(M,a){const c=1-M;return 3*c*c*M*a}(M,c)+function eN(M,a){return 3*(1-M)*M*M*a}(M,h)+function tN(M,a){return M*M*M*a}(M,p)}class XB extends KA{constructor(a=new Si,c=new Si,h=new Si,p=new Si){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=a,this.v1=c,this.v2=h,this.v3=p}getPoint(a,c=new Si){const h=c,p=this.v0,E=this.v1,H=this.v2,K=this.v3;return h.set(sw(a,p.x,E.x,H.x,K.x),sw(a,p.y,E.y,H.y,K.y)),h}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class kT extends KA{constructor(a=new Si,c=new Si){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=a,this.v2=c}getPoint(a,c=new Si){const h=c;return 1===a?h.copy(this.v2):(h.copy(this.v2).sub(this.v1),h.multiplyScalar(a).add(this.v1)),h}getPointAt(a,c){return this.getPoint(a,c)}getTangent(a,c=new Si){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,c){return this.getTangent(a,c)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class Lv extends KA{constructor(a=new Si,c=new Si,h=new Si){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=a,this.v1=c,this.v2=h}getPoint(a,c=new Si){const h=c,p=this.v0,E=this.v1,H=this.v2;return h.set(rw(a,p.x,E.x,H.x),rw(a,p.y,E.y,H.y)),h}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class SM extends KA{constructor(a=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=a}getPoint(a,c=new Si){const h=c,p=this.points,E=(p.length-1)*a,H=Math.floor(E),K=E-H,de=p[0===H?H:H-1],ge=p[H],Me=p[H>p.length-2?p.length-1:H+1],Le=p[H>p.length-3?p.length-1:H+2];return h.set(RT(K,de.x,ge.x,Me.x,Le.x),RT(K,de.y,ge.y,Me.y,Le.y)),h}copy(a){super.copy(a),this.points=[];for(let c=0,h=a.points.length;c<h;c++)this.points.push(a.points[c].clone());return this}toJSON(){const a=super.toJSON();a.points=[];for(let c=0,h=this.points.length;c<h;c++)a.points.push(this.points[c].toArray());return a}fromJSON(a){super.fromJSON(a),this.points=[];for(let c=0,h=a.points.length;c<h;c++){const p=a.points[c];this.points.push((new Si).fromArray(p))}return this}}var Nv=Object.freeze({__proto__:null,ArcCurve:class QB extends D_{constructor(a,c,h,p,E,H){super(a,c,h,h,p,E,H),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class WB extends KA{constructor(a=[],c=!1,h="centripetal",p=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=a,this.closed=c,this.curveType=h,this.tension=p}getPoint(a,c=new Dn){const h=c,p=this.points,E=p.length,H=(E-(this.closed?0:1))*a;let ge,Me,K=Math.floor(H),de=H-K;this.closed?K+=K>0?0:(Math.floor(Math.abs(K)/E)+1)*E:0===de&&K===E-1&&(K=E-2,de=1),this.closed||K>0?ge=p[(K-1)%E]:(nw.subVectors(p[0],p[1]).add(p[0]),ge=nw);const Le=p[K%E],Be=p[(K+1)%E];if(this.closed||K+2<E?Me=p[(K+2)%E]:(nw.subVectors(p[E-1],p[E-2]).add(p[E-1]),Me=nw),"centripetal"===this.curveType||"chordal"===this.curveType){const Ge="chordal"===this.curveType?.5:.25;let it=Math.pow(ge.distanceToSquared(Le),Ge),bt=Math.pow(Le.distanceToSquared(Be),Ge),Ye=Math.pow(Be.distanceToSquared(Me),Ge);bt<1e-4&&(bt=1),it<1e-4&&(it=bt),Ye<1e-4&&(Ye=bt),iw.initNonuniformCatmullRom(ge.x,Le.x,Be.x,Me.x,it,bt,Ye),xM.initNonuniformCatmullRom(ge.y,Le.y,Be.y,Me.y,it,bt,Ye),wM.initNonuniformCatmullRom(ge.z,Le.z,Be.z,Me.z,it,bt,Ye)}else"catmullrom"===this.curveType&&(iw.initCatmullRom(ge.x,Le.x,Be.x,Me.x,this.tension),xM.initCatmullRom(ge.y,Le.y,Be.y,Me.y,this.tension),wM.initCatmullRom(ge.z,Le.z,Be.z,Me.z,this.tension));return h.set(iw.calc(de),xM.calc(de),wM.calc(de)),h}copy(a){super.copy(a),this.points=[];for(let c=0,h=a.points.length;c<h;c++)this.points.push(a.points[c].clone());return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}toJSON(){const a=super.toJSON();a.points=[];for(let c=0,h=this.points.length;c<h;c++)a.points.push(this.points[c].toArray());return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a}fromJSON(a){super.fromJSON(a),this.points=[];for(let c=0,h=a.points.length;c<h;c++){const p=a.points[c];this.points.push((new Dn).fromArray(p))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}},CubicBezierCurve:XB,CubicBezierCurve3:class nN extends KA{constructor(a=new Dn,c=new Dn,h=new Dn,p=new Dn){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=a,this.v1=c,this.v2=h,this.v3=p}getPoint(a,c=new Dn){const h=c,p=this.v0,E=this.v1,H=this.v2,K=this.v3;return h.set(sw(a,p.x,E.x,H.x,K.x),sw(a,p.y,E.y,H.y,K.y),sw(a,p.z,E.z,H.z,K.z)),h}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}},EllipseCurve:D_,LineCurve:kT,LineCurve3:class ow extends KA{constructor(a=new Dn,c=new Dn){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=a,this.v2=c}getPoint(a,c=new Dn){const h=c;return 1===a?h.copy(this.v2):(h.copy(this.v2).sub(this.v1),h.multiplyScalar(a).add(this.v1)),h}getPointAt(a,c){return this.getPoint(a,c)}getTangent(a,c=new Dn){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,c){return this.getTangent(a,c)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}},QuadraticBezierCurve:Lv,QuadraticBezierCurve3:class aw extends KA{constructor(a=new Dn,c=new Dn,h=new Dn){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=a,this.v1=c,this.v2=h}getPoint(a,c=new Dn){const h=c,p=this.v0,E=this.v1,H=this.v2;return h.set(rw(a,p.x,E.x,H.x),rw(a,p.y,E.y,H.y),rw(a,p.z,E.z,H.z)),h}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}},SplineCurve:SM});class YB extends KA{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(a){this.curves.push(a)}closePath(){const a=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);return a.equals(c)||this.curves.push(new Nv[!0===a.isVector2?"LineCurve":"LineCurve3"](c,a)),this}getPoint(a,c){const h=a*this.getLength(),p=this.getCurveLengths();let E=0;for(;E<p.length;){if(p[E]>=h){const H=p[E]-h,K=this.curves[E],de=K.getLength();return K.getPointAt(0===de?0:1-H/de,c)}E++}return null}getLength(){const a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let c=0;for(let h=0,p=this.curves.length;h<p;h++)c+=this.curves[h].getLength(),a.push(c);return this.cacheLengths=a,a}getSpacedPoints(a=40){const c=[];for(let h=0;h<=a;h++)c.push(this.getPoint(h/a));return this.autoClose&&c.push(c[0]),c}getPoints(a=12){const c=[];let h;for(let p=0,E=this.curves;p<E.length;p++){const H=E[p],de=H.getPoints(H.isEllipseCurve?2*a:H.isLineCurve||H.isLineCurve3?1:H.isSplineCurve?a*H.points.length:a);for(let ge=0;ge<de.length;ge++){const Me=de[ge];h&&h.equals(Me)||(c.push(Me),h=Me)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(a){super.copy(a),this.curves=[];for(let c=0,h=a.curves.length;c<h;c++)this.curves.push(a.curves[c].clone());return this.autoClose=a.autoClose,this}toJSON(){const a=super.toJSON();a.autoClose=this.autoClose,a.curves=[];for(let c=0,h=this.curves.length;c<h;c++)a.curves.push(this.curves[c].toJSON());return a}fromJSON(a){super.fromJSON(a),this.autoClose=a.autoClose,this.curves=[];for(let c=0,h=a.curves.length;c<h;c++){const p=a.curves[c];this.curves.push((new Nv[p.type]).fromJSON(p))}return this}}class lw extends YB{constructor(a){super(),this.type="Path",this.currentPoint=new Si,a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,a[0].y);for(let c=1,h=a.length;c<h;c++)this.lineTo(a[c].x,a[c].y);return this}moveTo(a,c){return this.currentPoint.set(a,c),this}lineTo(a,c){const h=new kT(this.currentPoint.clone(),new Si(a,c));return this.curves.push(h),this.currentPoint.set(a,c),this}quadraticCurveTo(a,c,h,p){const E=new Lv(this.currentPoint.clone(),new Si(a,c),new Si(h,p));return this.curves.push(E),this.currentPoint.set(h,p),this}bezierCurveTo(a,c,h,p,E,H){const K=new XB(this.currentPoint.clone(),new Si(a,c),new Si(h,p),new Si(E,H));return this.curves.push(K),this.currentPoint.set(E,H),this}splineThru(a){const c=[this.currentPoint.clone()].concat(a),h=new SM(c);return this.curves.push(h),this.currentPoint.copy(a[a.length-1]),this}arc(a,c,h,p,E,H){return this.absarc(a+this.currentPoint.x,c+this.currentPoint.y,h,p,E,H),this}absarc(a,c,h,p,E,H){return this.absellipse(a,c,h,h,p,E,H),this}ellipse(a,c,h,p,E,H,K,de){return this.absellipse(a+this.currentPoint.x,c+this.currentPoint.y,h,p,E,H,K,de),this}absellipse(a,c,h,p,E,H,K,de){const ge=new D_(a,c,h,p,E,H,K,de);if(this.curves.length>0){const Le=ge.getPoint(0);Le.equals(this.currentPoint)||this.lineTo(Le.x,Le.y)}this.curves.push(ge);const Me=ge.getPoint(1);return this.currentPoint.copy(Me),this}copy(a){return super.copy(a),this.currentPoint.copy(a.currentPoint),this}toJSON(){const a=super.toJSON();return a.currentPoint=this.currentPoint.toArray(),a}fromJSON(a){return super.fromJSON(a),this.currentPoint.fromArray(a.currentPoint),this}}class zu extends us{constructor(a=1,c=32,h=0,p=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:a,segments:c,thetaStart:h,thetaLength:p},c=Math.max(3,c);const E=[],H=[],K=[],de=[],ge=new Dn,Me=new Si;H.push(0,0,0),K.push(0,0,1),de.push(.5,.5);for(let Le=0,Be=3;Le<=c;Le++,Be+=3){const Ge=h+Le/c*p;ge.x=a*Math.cos(Ge),ge.y=a*Math.sin(Ge),H.push(ge.x,ge.y,ge.z),K.push(0,0,1),Me.x=(H[Be]/a+1)/2,Me.y=(H[Be+1]/a+1)/2,de.push(Me.x,Me.y)}for(let Le=1;Le<=c;Le++)E.push(Le,Le+1,0);this.setIndex(E),this.setAttribute("position",new xo(H,3)),this.setAttribute("normal",new xo(K,3)),this.setAttribute("uv",new xo(de,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new zu(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class Ef extends lw{constructor(a){super(a),this.uuid=Yl(),this.type="Shape",this.holes=[]}getPointsHoles(a){const c=[];for(let h=0,p=this.holes.length;h<p;h++)c[h]=this.holes[h].getPoints(a);return c}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a),this.holes=[];for(let c=0,h=a.holes.length;c<h;c++)this.holes.push(a.holes[c].clone());return this}toJSON(){const a=super.toJSON();a.uuid=this.uuid,a.holes=[];for(let c=0,h=this.holes.length;c<h;c++)a.holes.push(this.holes[c].toJSON());return a}fromJSON(a){super.fromJSON(a),this.uuid=a.uuid,this.holes=[];for(let c=0,h=a.holes.length;c<h;c++){const p=a.holes[c];this.holes.push((new lw).fromJSON(p))}return this}}function uw(M,a,c,h,p){let E,H;if(p===function zT(M,a,c,h){let p=0;for(let E=a,H=c-h;E<c;E+=h)p+=(M[H]-M[E])*(M[E+1]+M[H+1]),H=E;return p}(M,a,c,h)>0)for(E=a;E<c;E+=h)H=UT(E,M[E],M[E+1],H);else for(E=c-h;E>=a;E-=h)H=UT(E,M[E],M[E+1],H);return H&&oy(H,H.next)&&(ay(H),H=H.next),H}function I_(M,a){if(!M)return M;a||(a=M);let h,c=M;do{if(h=!1,c.steiner||!oy(c,c.next)&&0!==Oc(c.prev,c,c.next))c=c.next;else{if(ay(c),c=a=c.prev,c===c.next)break;h=!0}}while(h||c!==a);return a}function Zm(M,a,c,h,p,E,H){if(!M)return;!H&&E&&function tP(M,a,c,h){let p=M;do{0===p.z&&(p.z=B_(p.x,p.y,a,c,h)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==M);p.prevZ.nextZ=null,p.prevZ=null,function LT(M){let a,c,h,p,E,H,K,de,ge=1;do{for(c=M,M=null,E=null,H=0;c;){for(H++,h=c,K=0,a=0;a<ge&&(K++,h=h.nextZ,h);a++);for(de=ge;K>0||de>0&&h;)0!==K&&(0===de||!h||c.z<=h.z)?(p=c,c=c.nextZ,K--):(p=h,h=h.nextZ,de--),E?E.nextZ=p:M=p,p.prevZ=E,E=p;c=h}E.nextZ=null,ge*=2}while(H>1)}(p)}(M,h,p,E);let de,ge,K=M;for(;M.prev!==M.next;)if(de=M.prev,ge=M.next,E?FT(M,h,p,E):BM(M))a.push(de.i/c|0),a.push(M.i/c|0),a.push(ge.i/c|0),ay(M),M=ge.next,K=ge.next;else if((M=ge)===K){H?1===H?Zm(M=PM(I_(M),a,c),a,c,h,p,E,2):2===H&&hw(M,a,c,h,p,E):Zm(I_(M),a,c,h,p,E,1);break}}function BM(M){const a=M.prev,c=M,h=M.next;if(Oc(a,c,h)>=0)return!1;const p=a.x,E=c.x,H=h.x,K=a.y,de=c.y,ge=h.y,Me=p<E?p<H?p:H:E<H?E:H,Le=K<de?K<ge?K:ge:de<ge?de:ge,Be=p>E?p>H?p:H:E>H?E:H,Ge=K>de?K>ge?K:ge:de>ge?de:ge;let it=h.next;for(;it!==a;){if(it.x>=Me&&it.x<=Be&&it.y>=Le&&it.y<=Ge&&m0(p,K,E,de,H,ge,it.x,it.y)&&Oc(it.prev,it,it.next)>=0)return!1;it=it.next}return!0}function FT(M,a,c,h){const p=M.prev,E=M,H=M.next;if(Oc(p,E,H)>=0)return!1;const K=p.x,de=E.x,ge=H.x,Me=p.y,Le=E.y,Be=H.y,Ge=K<de?K<ge?K:ge:de<ge?de:ge,it=Me<Le?Me<Be?Me:Be:Le<Be?Le:Be,bt=K>de?K>ge?K:ge:de>ge?de:ge,Ye=Me>Le?Me>Be?Me:Be:Le>Be?Le:Be,qe=B_(Ge,it,a,c,h),Ft=B_(bt,Ye,a,c,h);let mt=M.prevZ,Ut=M.nextZ;for(;mt&&mt.z>=qe&&Ut&&Ut.z<=Ft;){if(mt.x>=Ge&&mt.x<=bt&&mt.y>=it&&mt.y<=Ye&&mt!==p&&mt!==H&&m0(K,Me,de,Le,ge,Be,mt.x,mt.y)&&Oc(mt.prev,mt,mt.next)>=0||(mt=mt.prevZ,Ut.x>=Ge&&Ut.x<=bt&&Ut.y>=it&&Ut.y<=Ye&&Ut!==p&&Ut!==H&&m0(K,Me,de,Le,ge,Be,Ut.x,Ut.y)&&Oc(Ut.prev,Ut,Ut.next)>=0))return!1;Ut=Ut.nextZ}for(;mt&&mt.z>=qe;){if(mt.x>=Ge&&mt.x<=bt&&mt.y>=it&&mt.y<=Ye&&mt!==p&&mt!==H&&m0(K,Me,de,Le,ge,Be,mt.x,mt.y)&&Oc(mt.prev,mt,mt.next)>=0)return!1;mt=mt.prevZ}for(;Ut&&Ut.z<=Ft;){if(Ut.x>=Ge&&Ut.x<=bt&&Ut.y>=it&&Ut.y<=Ye&&Ut!==p&&Ut!==H&&m0(K,Me,de,Le,ge,Be,Ut.x,Ut.y)&&Oc(Ut.prev,Ut,Ut.next)>=0)return!1;Ut=Ut.nextZ}return!0}function PM(M,a,c){let h=M;do{const p=h.prev,E=h.next.next;!oy(p,E)&&RM(p,h,h.next,E)&&Vv(p,E)&&Vv(E,p)&&(a.push(p.i/c|0),a.push(h.i/c|0),a.push(E.i/c|0),ay(h),ay(h.next),h=M=E),h=h.next}while(h!==M);return I_(h)}function hw(M,a,c,h,p,E){let H=M;do{let K=H.next.next;for(;K!==H.prev;){if(H.i!==K.i&&nP(H,K)){let de=Gv(H,K);return H=I_(H,H.next),de=I_(de,de.next),Zm(H,a,c,h,p,E,0),void Zm(de,a,c,h,p,E,0)}K=K.next}H=H.next}while(H!==M)}function ZB(M,a){return M.x-a.x}function OT(M,a){const c=function JB(M,a){let p,c=a,h=-1/0;const E=M.x,H=M.y;do{if(H<=c.y&&H>=c.next.y&&c.next.y!==c.y){const Be=c.x+(H-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(Be<=E&&Be>h&&(h=Be,p=c.x<c.next.x?c:c.next,Be===E))return p}c=c.next}while(c!==a);if(!p)return null;const K=p,de=p.x,ge=p.y;let Le,Me=1/0;c=p;do{E>=c.x&&c.x>=de&&E!==c.x&&m0(H<ge?E:h,H,de,ge,H<ge?h:E,H,c.x,c.y)&&(Le=Math.abs(H-c.y)/(E-c.x),Vv(c,M)&&(Le<Me||Le===Me&&(c.x>p.x||c.x===p.x&&eP(p,c)))&&(p=c,Me=Le)),c=c.next}while(c!==K);return p}(M,a);if(!c)return a;const h=Gv(c,M);return I_(h,h.next),I_(c,c.next)}function eP(M,a){return Oc(M.prev,M,a.prev)<0&&Oc(a.next,M,M.next)<0}function B_(M,a,c,h,p){return(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=(M-c)*p|0)|M<<8))|M<<4))|M<<2))|M<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-h)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function fw(M){let a=M,c=M;do{(a.x<c.x||a.x===c.x&&a.y<c.y)&&(c=a),a=a.next}while(a!==M);return c}function m0(M,a,c,h,p,E,H,K){return(p-H)*(a-K)>=(M-H)*(E-K)&&(M-H)*(h-K)>=(c-H)*(a-K)&&(c-H)*(E-K)>=(p-H)*(h-K)}function nP(M,a){return M.next.i!==a.i&&M.prev.i!==a.i&&!function NT(M,a){let c=M;do{if(c.i!==M.i&&c.next.i!==M.i&&c.i!==a.i&&c.next.i!==a.i&&RM(c,c.next,M,a))return!0;c=c.next}while(c!==M);return!1}(M,a)&&(Vv(M,a)&&Vv(a,M)&&function rN(M,a){let c=M,h=!1;const p=(M.x+a.x)/2,E=(M.y+a.y)/2;do{c.y>E!=c.next.y>E&&c.next.y!==c.y&&p<(c.next.x-c.x)*(E-c.y)/(c.next.y-c.y)+c.x&&(h=!h),c=c.next}while(c!==M);return h}(M,a)&&(Oc(M.prev,M,a.prev)||Oc(M,a.prev,a))||oy(M,a)&&Oc(M.prev,M,M.next)>0&&Oc(a.prev,a,a.next)>0)}function Oc(M,a,c){return(a.y-M.y)*(c.x-a.x)-(a.x-M.x)*(c.y-a.y)}function oy(M,a){return M.x===a.x&&M.y===a.y}function RM(M,a,c,h){const p=Hv(Oc(M,a,c)),E=Hv(Oc(M,a,h)),H=Hv(Oc(c,h,M)),K=Hv(Oc(c,h,a));return!!(p!==E&&H!==K||0===p&&Jm(M,c,a)||0===E&&Jm(M,h,a)||0===H&&Jm(c,M,h)||0===K&&Jm(c,a,h))}function Jm(M,a,c){return a.x<=Math.max(M.x,c.x)&&a.x>=Math.min(M.x,c.x)&&a.y<=Math.max(M.y,c.y)&&a.y>=Math.min(M.y,c.y)}function Hv(M){return M>0?1:M<0?-1:0}function Vv(M,a){return Oc(M.prev,M,M.next)<0?Oc(M,a,M.next)>=0&&Oc(M,M.prev,a)>=0:Oc(M,a,M.prev)<0||Oc(M,M.next,a)<0}function Gv(M,a){const c=new pw(M.i,M.x,M.y),h=new pw(a.i,a.x,a.y),p=M.next,E=a.prev;return M.next=a,a.prev=M,c.next=p,p.prev=c,h.next=c,c.prev=h,E.next=h,h.prev=E,h}function UT(M,a,c,h){const p=new pw(M,a,c);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function ay(M){M.next.prev=M.prev,M.prev.next=M.next,M.prevZ&&(M.prevZ.nextZ=M.nextZ),M.nextZ&&(M.nextZ.prevZ=M.prevZ)}function pw(M,a,c){this.i=M,this.x=a,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class mp{static area(a){const c=a.length;let h=0;for(let p=c-1,E=0;E<c;p=E++)h+=a[p].x*a[E].y-a[E].x*a[p].y;return.5*h}static isClockWise(a){return mp.area(a)<0}static triangulateShape(a,c){const h=[],p=[],E=[];kM(a),qv(h,a);let H=a.length;c.forEach(kM);for(let de=0;de<c.length;de++)p.push(H),H+=c[de].length,qv(h,c[de]);const K=function(M,a,c=2){const h=a&&a.length,p=h?a[0]*c:M.length;let E=uw(M,0,p,c,!0);const H=[];if(!E||E.next===E.prev)return H;let K,de,ge,Me,Le,Be,Ge;if(h&&(E=function KB(M,a,c,h){const p=[];let E,H,K,de,ge;for(E=0,H=a.length;E<H;E++)K=a[E]*h,de=E<H-1?a[E+1]*h:M.length,ge=uw(M,K,de,h,!1),ge===ge.next&&(ge.steiner=!0),p.push(fw(ge));for(p.sort(ZB),E=0;E<p.length;E++)c=OT(p[E],c);return c}(M,a,E,c)),M.length>80*c){K=ge=M[0],de=Me=M[1];for(let it=c;it<p;it+=c)Le=M[it],Be=M[it+1],Le<K&&(K=Le),Be<de&&(de=Be),Le>ge&&(ge=Le),Be>Me&&(Me=Be);Ge=Math.max(ge-K,Me-de),Ge=0!==Ge?32767/Ge:0}return Zm(E,H,c,K,de,Ge,0),H}(h,p);for(let de=0;de<K.length;de+=3)E.push(K.slice(de,de+3));return E}}function kM(M){const a=M.length;a>2&&M[a-1].equals(M[0])&&M.pop()}function qv(M,a){for(let c=0;c<a.length;c++)M.push(a[c].x),M.push(a[c].y)}class A0 extends us{constructor(a=new Ef([new Si(.5,.5),new Si(-.5,.5),new Si(-.5,-.5),new Si(.5,-.5)]),c={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:a,options:c},a=Array.isArray(a)?a:[a];const h=this,p=[],E=[];for(let K=0,de=a.length;K<de;K++)H(a[K]);function H(K){const de=[],ge=void 0!==c.curveSegments?c.curveSegments:12,Me=void 0!==c.steps?c.steps:1,Le=void 0!==c.depth?c.depth:1;let Be=void 0===c.bevelEnabled||c.bevelEnabled,Ge=void 0!==c.bevelThickness?c.bevelThickness:.2,it=void 0!==c.bevelSize?c.bevelSize:Ge-.1,bt=void 0!==c.bevelOffset?c.bevelOffset:0,Ye=void 0!==c.bevelSegments?c.bevelSegments:3;const qe=c.extrudePath,Ft=void 0!==c.UVGenerator?c.UVGenerator:HT;let mt,kn,bn,wn,$n,Ut=!1;qe&&(mt=qe.getSpacedPoints(Me),Ut=!0,Be=!1,kn=qe.computeFrenetFrames(Me,!1),bn=new Dn,wn=new Dn,$n=new Dn),Be||(Ye=0,Ge=0,it=0,bt=0);const wi=K.extractPoints(ge);let Nt=wi.shape;const In=wi.holes;if(!mp.isClockWise(Nt)){Nt=Nt.reverse();for(let Nn=0,Jr=In.length;Nn<Jr;Nn++){const lr=In[Nn];mp.isClockWise(lr)&&(In[Nn]=lr.reverse())}}const hr=mp.triangulateShape(Nt,In),ei=Nt;for(let Nn=0,Jr=In.length;Nn<Jr;Nn++)Nt=Nt.concat(In[Nn]);function Yi(Nn,Jr,lr){return Jr||console.error("THREE.ExtrudeGeometry: vec does not exist"),Nn.clone().addScaledVector(Jr,lr)}const Pi=Nt.length,or=hr.length;function rr(Nn,Jr,lr){let Yr,_r,zs;const Ds=Nn.x-Jr.x,eo=Nn.y-Jr.y,Va=lr.x-Nn.x,_n=lr.y-Nn.y,Gt=Ds*Ds+eo*eo;if(Math.abs(Ds*_n-eo*Va)>Number.EPSILON){const Zi=Math.sqrt(Gt),Fr=Math.sqrt(Va*Va+_n*_n),Cr=Jr.x-eo/Zi,ea=Jr.y+Ds/Zi,fs=((lr.x-_n/Fr-Cr)*_n-(lr.y+Va/Fr-ea)*Va)/(Ds*_n-eo*Va);Yr=Cr+Ds*fs-Nn.x,_r=ea+eo*fs-Nn.y;const ta=Yr*Yr+_r*_r;if(ta<=2)return new Si(Yr,_r);zs=Math.sqrt(ta/2)}else{let Zi=!1;Ds>Number.EPSILON?Va>Number.EPSILON&&(Zi=!0):Ds<-Number.EPSILON?Va<-Number.EPSILON&&(Zi=!0):Math.sign(eo)===Math.sign(_n)&&(Zi=!0),Zi?(Yr=-eo,_r=Ds,zs=Math.sqrt(Gt)):(Yr=Ds,_r=eo,zs=Math.sqrt(Gt/2))}return new Si(Yr/zs,_r/zs)}const nr=[];for(let Nn=0,Jr=ei.length,lr=Jr-1,Yr=Nn+1;Nn<Jr;Nn++,lr++,Yr++)lr===Jr&&(lr=0),Yr===Jr&&(Yr=0),nr[Nn]=rr(ei[Nn],ei[lr],ei[Yr]);const Gr=[];let zr,Ps=nr.concat();for(let Nn=0,Jr=In.length;Nn<Jr;Nn++){const lr=In[Nn];zr=[];for(let Yr=0,_r=lr.length,zs=_r-1,Ds=Yr+1;Yr<_r;Yr++,zs++,Ds++)zs===_r&&(zs=0),Ds===_r&&(Ds=0),zr[Yr]=rr(lr[Yr],lr[zs],lr[Ds]);Gr.push(zr),Ps=Ps.concat(zr)}for(let Nn=0;Nn<Ye;Nn++){const Jr=Nn/Ye,lr=Ge*Math.cos(Jr*Math.PI/2),Yr=it*Math.sin(Jr*Math.PI/2)+bt;for(let _r=0,zs=ei.length;_r<zs;_r++){const Ds=Yi(ei[_r],nr[_r],Yr);co(Ds.x,Ds.y,-lr)}for(let _r=0,zs=In.length;_r<zs;_r++){const Ds=In[_r];zr=Gr[_r];for(let eo=0,Va=Ds.length;eo<Va;eo++){const _n=Yi(Ds[eo],zr[eo],Yr);co(_n.x,_n.y,-lr)}}}const Jo=it+bt;for(let Nn=0;Nn<Pi;Nn++){const Jr=Be?Yi(Nt[Nn],Ps[Nn],Jo):Nt[Nn];Ut?(wn.copy(kn.normals[0]).multiplyScalar(Jr.x),bn.copy(kn.binormals[0]).multiplyScalar(Jr.y),$n.copy(mt[0]).add(wn).add(bn),co($n.x,$n.y,$n.z)):co(Jr.x,Jr.y,0)}for(let Nn=1;Nn<=Me;Nn++)for(let Jr=0;Jr<Pi;Jr++){const lr=Be?Yi(Nt[Jr],Ps[Jr],Jo):Nt[Jr];Ut?(wn.copy(kn.normals[Nn]).multiplyScalar(lr.x),bn.copy(kn.binormals[Nn]).multiplyScalar(lr.y),$n.copy(mt[Nn]).add(wn).add(bn),co($n.x,$n.y,$n.z)):co(lr.x,lr.y,Le/Me*Nn)}for(let Nn=Ye-1;Nn>=0;Nn--){const Jr=Nn/Ye,lr=Ge*Math.cos(Jr*Math.PI/2),Yr=it*Math.sin(Jr*Math.PI/2)+bt;for(let _r=0,zs=ei.length;_r<zs;_r++){const Ds=Yi(ei[_r],nr[_r],Yr);co(Ds.x,Ds.y,Le+lr)}for(let _r=0,zs=In.length;_r<zs;_r++){const Ds=In[_r];zr=Gr[_r];for(let eo=0,Va=Ds.length;eo<Va;eo++){const _n=Yi(Ds[eo],zr[eo],Yr);Ut?co(_n.x,_n.y+mt[Me-1].y,mt[Me-1].x+lr):co(_n.x,_n.y,Le+lr)}}}function Rs(Nn,Jr){let lr=Nn.length;for(;--lr>=0;){const Yr=lr;let _r=lr-1;_r<0&&(_r=Nn.length-1);for(let zs=0,Ds=Me+2*Ye;zs<Ds;zs++){const eo=Pi*zs,Va=Pi*(zs+1);$s(Jr+Yr+eo,Jr+_r+eo,Jr+_r+Va,Jr+Yr+Va)}}}function co(Nn,Jr,lr){de.push(Nn),de.push(Jr),de.push(lr)}function no(Nn,Jr,lr){_a(Nn),_a(Jr),_a(lr);const Yr=p.length/3,_r=Ft.generateTopUV(h,p,Yr-3,Yr-2,Yr-1);uo(_r[0]),uo(_r[1]),uo(_r[2])}function $s(Nn,Jr,lr,Yr){_a(Nn),_a(Jr),_a(Yr),_a(Jr),_a(lr),_a(Yr);const _r=p.length/3,zs=Ft.generateSideWallUV(h,p,_r-6,_r-3,_r-2,_r-1);uo(zs[0]),uo(zs[1]),uo(zs[3]),uo(zs[1]),uo(zs[2]),uo(zs[3])}function _a(Nn){p.push(de[3*Nn+0]),p.push(de[3*Nn+1]),p.push(de[3*Nn+2])}function uo(Nn){E.push(Nn.x),E.push(Nn.y)}(function Li(){const Nn=p.length/3;if(Be){let Jr=0,lr=Pi*Jr;for(let Yr=0;Yr<or;Yr++){const _r=hr[Yr];no(_r[2]+lr,_r[1]+lr,_r[0]+lr)}Jr=Me+2*Ye,lr=Pi*Jr;for(let Yr=0;Yr<or;Yr++){const _r=hr[Yr];no(_r[0]+lr,_r[1]+lr,_r[2]+lr)}}else{for(let Jr=0;Jr<or;Jr++){const lr=hr[Jr];no(lr[2],lr[1],lr[0])}for(let Jr=0;Jr<or;Jr++){const lr=hr[Jr];no(lr[0]+Pi*Me,lr[1]+Pi*Me,lr[2]+Pi*Me)}}h.addGroup(Nn,p.length/3-Nn,0)})(),function Br(){const Nn=p.length/3;let Jr=0;Rs(ei,Jr),Jr+=ei.length;for(let lr=0,Yr=In.length;lr<Yr;lr++){const _r=In[lr];Rs(_r,Jr),Jr+=_r.length}h.addGroup(Nn,p.length/3-Nn,1)}()}this.setAttribute("position",new xo(p,3)),this.setAttribute("uv",new xo(E,2)),this.computeVertexNormals()}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){const a=super.toJSON();return function FM(M,a,c){if(c.shapes=[],Array.isArray(M))for(let h=0,p=M.length;h<p;h++)c.shapes.push(M[h].uuid);else c.shapes.push(M.uuid);return c.options=Object.assign({},a),void 0!==a.extrudePath&&(c.options.extrudePath=a.extrudePath.toJSON()),c}(this.parameters.shapes,this.parameters.options,a)}static fromJSON(a,c){const h=[];for(let E=0,H=a.shapes.length;E<H;E++)h.push(c[a.shapes[E]]);const p=a.options.extrudePath;return void 0!==p&&(a.options.extrudePath=(new Nv[p.type]).fromJSON(p)),new A0(h,a.options)}}const HT={generateTopUV:function(M,a,c,h,p){const K=a[3*h],de=a[3*h+1],ge=a[3*p],Me=a[3*p+1];return[new Si(a[3*c],a[3*c+1]),new Si(K,de),new Si(ge,Me)]},generateSideWallUV:function(M,a,c,h,p,E){const H=a[3*c],K=a[3*c+1],de=a[3*c+2],ge=a[3*h],Me=a[3*h+1],Le=a[3*h+2],Be=a[3*p],Ge=a[3*p+1],it=a[3*p+2],bt=a[3*E],Ye=a[3*E+1],qe=a[3*E+2];return Math.abs(K-Me)<Math.abs(H-ge)?[new Si(H,1-de),new Si(ge,1-Le),new Si(Be,1-it),new Si(bt,1-qe)]:[new Si(K,1-de),new Si(Me,1-Le),new Si(Ge,1-it),new Si(Ye,1-qe)]}};class Wv extends us{constructor(a=1,c=32,h=16,p=0,E=2*Math.PI,H=0,K=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:c,heightSegments:h,phiStart:p,phiLength:E,thetaStart:H,thetaLength:K},c=Math.max(3,Math.floor(c)),h=Math.max(2,Math.floor(h));const de=Math.min(H+K,Math.PI);let ge=0;const Me=[],Le=new Dn,Be=new Dn,Ge=[],it=[],bt=[],Ye=[];for(let qe=0;qe<=h;qe++){const Ft=[],mt=qe/h;let Ut=0;0===qe&&0===H?Ut=.5/c:qe===h&&de===Math.PI&&(Ut=-.5/c);for(let kn=0;kn<=c;kn++){const bn=kn/c;Le.x=-a*Math.cos(p+bn*E)*Math.sin(H+mt*K),Le.y=a*Math.cos(H+mt*K),Le.z=a*Math.sin(p+bn*E)*Math.sin(H+mt*K),it.push(Le.x,Le.y,Le.z),Be.copy(Le).normalize(),bt.push(Be.x,Be.y,Be.z),Ye.push(bn+Ut,1-mt),Ft.push(ge++)}Me.push(Ft)}for(let qe=0;qe<h;qe++)for(let Ft=0;Ft<c;Ft++){const Ut=Me[qe][Ft],kn=Me[qe+1][Ft],bn=Me[qe+1][Ft+1];(0!==qe||H>0)&&Ge.push(Me[qe][Ft+1],Ut,bn),(qe!==h-1||de<Math.PI)&&Ge.push(Ut,kn,bn)}this.setIndex(Ge),this.setAttribute("position",new xo(it,3)),this.setAttribute("normal",new xo(bt,3)),this.setAttribute("uv",new xo(Ye,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Wv(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class gw extends Ic{constructor(a){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new to(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new to(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ec,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.envMapIntensity=a.envMapIntensity,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class qT extends gw{constructor(a){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Si(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gl(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new to(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new to(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new to(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){this._anisotropy>0!=a>0&&this.version++,this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){this._clearcoat>0!=a>0&&this.version++,this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){this._iridescence>0!=a>0&&this.version++,this._iridescence=a}get sheen(){return this._sheen}set sheen(a){this._sheen>0!=a>0&&this.version++,this._sheen=a}get transmission(){return this._transmission}set transmission(a){this._transmission>0!=a>0&&this.version++,this._transmission=a}copy(a){return super.copy(a),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=a.anisotropy,this.anisotropyRotation=a.anisotropyRotation,this.anisotropyMap=a.anisotropyMap,this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.ior=a.ior,this.iridescence=a.iridescence,this.iridescenceMap=a.iridescenceMap,this.iridescenceIOR=a.iridescenceIOR,this.iridescenceThicknessRange=[...a.iridescenceThicknessRange],this.iridescenceThicknessMap=a.iridescenceThicknessMap,this.sheen=a.sheen,this.sheenColor.copy(a.sheenColor),this.sheenColorMap=a.sheenColorMap,this.sheenRoughness=a.sheenRoughness,this.sheenRoughnessMap=a.sheenRoughnessMap,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this.thickness=a.thickness,this.thicknessMap=a.thicknessMap,this.attenuationDistance=a.attenuationDistance,this.attenuationColor.copy(a.attenuationColor),this.specularIntensity=a.specularIntensity,this.specularIntensityMap=a.specularIntensityMap,this.specularColor.copy(a.specularColor),this.specularColorMap=a.specularColorMap,this}}class jv extends Ic{constructor(a){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new to(16777215),this.specular=new to(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new to(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ec,this.combine=Ue,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class R_ extends Ic{constructor(a){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new to(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new to(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}class _w extends Ic{constructor(a){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(a)}copy(a){return super.copy(a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.flatShading=a.flatShading,this}}class cy extends Ic{constructor(a){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new to(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new to(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ec,this.combine=Ue,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class zM extends Ic{constructor(a){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new to(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.flatShading=a.flatShading,this.fog=a.fog,this}}class yw extends ty{constructor(a){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}copy(a){return super.copy(a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this}}const eA={enabled:!1,files:{},add:function(M,a){!1!==this.enabled&&(this.files[M]=a)},get:function(M){if(!1!==this.enabled)return this.files[M]},remove:function(M){delete this.files[M]},clear:function(){this.files={}}};class vw{constructor(a,c,h){const p=this;let de,E=!1,H=0,K=0;const ge=[];this.onStart=void 0,this.onLoad=a,this.onProgress=c,this.onError=h,this.itemStart=function(Me){K++,!1===E&&void 0!==p.onStart&&p.onStart(Me,H,K),E=!0},this.itemEnd=function(Me){H++,void 0!==p.onProgress&&p.onProgress(Me,H,K),H===K&&(E=!1,void 0!==p.onLoad&&p.onLoad())},this.itemError=function(Me){void 0!==p.onError&&p.onError(Me)},this.resolveURL=function(Me){return de?de(Me):Me},this.setURLModifier=function(Me){return de=Me,this},this.addHandler=function(Me,Le){return ge.push(Me,Le),this},this.removeHandler=function(Me){const Le=ge.indexOf(Me);return-1!==Le&&ge.splice(Le,2),this},this.getHandler=function(Me){for(let Le=0,Be=ge.length;Le<Be;Le+=2){const Ge=ge[Le],it=ge[Le+1];if(Ge.global&&(Ge.lastIndex=0),Ge.test(Me))return it}return null}}}const QT=new vw;let Tf=(()=>{class M{constructor(c){this.manager=void 0!==c?c:QT,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(c,h){const p=this;return new Promise(function(E,H){p.load(c,E,h,H)})}parse(){}setCrossOrigin(c){return this.crossOrigin=c,this}setWithCredentials(c){return this.withCredentials=c,this}setPath(c){return this.path=c,this}setResourcePath(c){return this.resourcePath=c,this}setRequestHeader(c){return this.requestHeader=c,this}}return M.DEFAULT_MATERIAL_NAME="__DEFAULT",M})();Error;class bw extends Tf{constructor(a){super(a)}load(a,c,h,p){void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);const E=this,H=eA.get(a);if(void 0!==H)return E.manager.itemStart(a),setTimeout(function(){c&&c(H),E.manager.itemEnd(a)},0),H;const K=Ed("img");function de(){Me(),eA.add(a,this),c&&c(this),E.manager.itemEnd(a)}function ge(Le){Me(),p&&p(Le),E.manager.itemError(a),E.manager.itemEnd(a)}function Me(){K.removeEventListener("load",de,!1),K.removeEventListener("error",ge,!1)}return K.addEventListener("load",de,!1),K.addEventListener("error",ge,!1),"data:"!==a.slice(0,5)&&void 0!==this.crossOrigin&&(K.crossOrigin=this.crossOrigin),E.manager.itemStart(a),K.src=a,K}}class jT extends Tf{constructor(a){super(a)}load(a,c,h,p){const E=new $d,H=new bw(this.manager);return H.setCrossOrigin(this.crossOrigin),H.setPath(this.path),H.load(a,function(K){E.image=K,E.needsUpdate=!0,void 0!==c&&c(E)},h,p),E}}class tA extends Nl{constructor(a,c=1){super(),this.isLight=!0,this.type="Light",this.color=new to(a),this.intensity=c}dispose(){}copy(a,c){return super.copy(a,c),this.color.copy(a.color),this.intensity=a.intensity,this}toJSON(a){const c=super.toJSON(a);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}class n3 extends tA{constructor(a,c,h){super(a,h),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Nl.DEFAULT_UP),this.updateMatrix(),this.groundColor=new to(c)}copy(a,c){return super.copy(a,c),this.groundColor.copy(a.groundColor),this}}const r3=new lo,s3=new Dn,o3=new Dn;class Pw{constructor(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Si(512,512),this.map=null,this.mapPass=null,this.matrix=new lo,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new BA,this._frameExtents=new Si(1,1),this._viewportCount=1,this._viewports=[new Za(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){const c=this.camera,h=this.matrix;s3.setFromMatrixPosition(a.matrixWorld),c.position.copy(s3),o3.setFromMatrixPosition(a.target.matrixWorld),c.lookAt(o3),c.updateMatrixWorld(),r3.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r3),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(r3)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const a={};return 0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}class Nd extends Pw{constructor(){super(new x_(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class a3 extends tA{constructor(a,c){super(a,c),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Nl.DEFAULT_UP),this.updateMatrix(),this.target=new Nl,this.shadow=new Nd}dispose(){this.shadow.dispose()}copy(a){return super.copy(a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}class l3 extends tA{constructor(a,c){super(a,c),this.isAmbientLight=!0,this.type="AmbientLight"}}function Fw(M,a,c){return!M||!c&&M.constructor===a?M:"number"==typeof a.BYTES_PER_ELEMENT?new a(M):Array.prototype.slice.call(M)}class YM{constructor(a,c,h,p){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==p?p:new c.constructor(h),this.sampleValues=c,this.valueSize=h,this.settings=null,this.DefaultSettings_={}}evaluate(a){const c=this.parameterPositions;let h=this._cachedIndex,p=c[h],E=c[h-1];e:{t:{let H;n:{i:if(!(a<p)){for(let K=h+2;;){if(void 0===p){if(a<E)break i;return h=c.length,this._cachedIndex=h,this.copySampleValue_(h-1)}if(h===K)break;if(E=p,p=c[++h],a<p)break t}H=c.length;break n}if(a>=E)break e;{const K=c[1];a<K&&(h=2,E=K);for(let de=h-2;;){if(void 0===E)return this._cachedIndex=0,this.copySampleValue_(0);if(h===de)break;if(p=E,E=c[--h-1],a>=E)break t}H=h,h=0}}for(;h<H;){const K=h+H>>>1;a<c[K]?H=K:h=K+1}if(p=c[h],E=c[h-1],void 0===E)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===p)return h=c.length,this._cachedIndex=h,this.copySampleValue_(h-1)}this._cachedIndex=h,this.intervalChanged_(h,E,p)}return this.interpolate_(h,E,a,p)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){const c=this.resultBuffer,h=this.sampleValues,p=this.valueSize,E=a*p;for(let H=0;H!==p;++H)c[H]=h[E+H];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class fP extends YM{constructor(a,c,h,p){super(a,c,h,p),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(a,c,h){const p=this.parameterPositions;let E=a-2,H=a+1,K=p[E],de=p[H];if(void 0===K)switch(this.getSettings_().endingStart){case 2401:E=a,K=2*c-h;break;case 2402:E=p.length-2,K=c+p[E]-p[E+1];break;default:E=a,K=h}if(void 0===de)switch(this.getSettings_().endingEnd){case 2401:H=a,de=2*h-c;break;case 2402:H=1,de=h+p[1]-p[0];break;default:H=a-1,de=c}const ge=.5*(h-c),Me=this.valueSize;this._weightPrev=ge/(c-K),this._weightNext=ge/(de-h),this._offsetPrev=E*Me,this._offsetNext=H*Me}interpolate_(a,c,h,p){const E=this.resultBuffer,H=this.sampleValues,K=this.valueSize,de=a*K,ge=de-K,Me=this._offsetPrev,Le=this._offsetNext,Be=this._weightPrev,Ge=this._weightNext,it=(h-c)/(p-c),bt=it*it,Ye=bt*it,qe=-Be*Ye+2*Be*bt-Be*it,Ft=(1+Be)*Ye+(-1.5-2*Be)*bt+(-.5+Be)*it+1,mt=(-1-Ge)*Ye+(1.5+Ge)*bt+.5*it,Ut=Ge*Ye-Ge*bt;for(let kn=0;kn!==K;++kn)E[kn]=qe*H[Me+kn]+Ft*H[ge+kn]+mt*H[de+kn]+Ut*H[Le+kn];return E}}class uN extends YM{constructor(a,c,h,p){super(a,c,h,p)}interpolate_(a,c,h,p){const E=this.resultBuffer,H=this.sampleValues,K=this.valueSize,de=a*K,ge=de-K,Me=(h-c)/(p-c),Le=1-Me;for(let Be=0;Be!==K;++Be)E[Be]=H[ge+Be]*Le+H[de+Be]*Me;return E}}class pP extends YM{constructor(a,c,h,p){super(a,c,h,p)}interpolate_(a){return this.copySampleValue_(a-1)}}class nA{constructor(a,c,h,p){if(void 0===a)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=Fw(c,this.TimeBufferType),this.values=Fw(h,this.ValueBufferType),this.setInterpolation(p||this.DefaultInterpolation)}static toJSON(a){const c=a.constructor;let h;if(c.toJSON!==this.toJSON)h=c.toJSON(a);else{h={name:a.name,times:Fw(a.times,Array),values:Fw(a.values,Array)};const p=a.getInterpolation();p!==a.DefaultInterpolation&&(h.interpolation=p)}return h.type=a.ValueTypeName,h}InterpolantFactoryMethodDiscrete(a){return new pP(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new uN(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new fP(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){let c;switch(a){case 2300:c=this.InterpolantFactoryMethodDiscrete;break;case 2301:c=this.InterpolantFactoryMethodLinear;break;case 2302:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const h="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(a===this.DefaultInterpolation)throw new Error(h);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",h),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==a){const c=this.times;for(let h=0,p=c.length;h!==p;++h)c[h]+=a}return this}scale(a){if(1!==a){const c=this.times;for(let h=0,p=c.length;h!==p;++h)c[h]*=a}return this}trim(a,c){const h=this.times,p=h.length;let E=0,H=p-1;for(;E!==p&&h[E]<a;)++E;for(;-1!==H&&h[H]>c;)--H;if(++H,0!==E||H!==p){E>=H&&(H=Math.max(H,1),E=H-1);const K=this.getValueSize();this.times=h.slice(E,H),this.values=this.values.slice(E*K,H*K)}return this}validate(){let a=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);const h=this.times,p=this.values,E=h.length;0===E&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let H=null;for(let K=0;K!==E;K++){const de=h[K];if("number"==typeof de&&isNaN(de)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,K,de),a=!1;break}if(null!==H&&H>de){console.error("THREE.KeyframeTrack: Out of order keys.",this,K,de,H),a=!1;break}H=de}if(void 0!==p&&function cN(M){return ArrayBuffer.isView(M)&&!(M instanceof DataView)}(p))for(let K=0,de=p.length;K!==de;++K){const ge=p[K];if(isNaN(ge)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,K,ge),a=!1;break}}return a}optimize(){const a=this.times.slice(),c=this.values.slice(),h=this.getValueSize(),p=2302===this.getInterpolation(),E=a.length-1;let H=1;for(let K=1;K<E;++K){let de=!1;const ge=a[K];if(ge!==a[K+1]&&(1!==K||ge!==a[0]))if(p)de=!0;else{const Le=K*h,Be=Le-h,Ge=Le+h;for(let it=0;it!==h;++it){const bt=c[Le+it];if(bt!==c[Be+it]||bt!==c[Ge+it]){de=!0;break}}}if(de){if(K!==H){a[H]=a[K];const Le=K*h,Be=H*h;for(let Ge=0;Ge!==h;++Ge)c[Be+Ge]=c[Le+Ge]}++H}}if(E>0){a[H]=a[E];for(let K=E*h,de=H*h,ge=0;ge!==h;++ge)c[de+ge]=c[K+ge];++H}return H!==a.length?(this.times=a.slice(0,H),this.values=c.slice(0,H*h)):(this.times=a,this.values=c),this}clone(){const a=this.times.slice(),c=this.values.slice(),p=new(0,this.constructor)(this.name,a,c);return p.createInterpolant=this.createInterpolant,p}}nA.prototype.TimeBufferType=Float32Array,nA.prototype.ValueBufferType=Float32Array,nA.prototype.DefaultInterpolation=2301;class _y extends nA{}_y.prototype.ValueTypeName="bool",_y.prototype.ValueBufferType=Array,_y.prototype.DefaultInterpolation=2300,_y.prototype.InterpolantFactoryMethodLinear=void 0,_y.prototype.InterpolantFactoryMethodSmooth=void 0;(class Ow extends nA{}).prototype.ValueTypeName="color";(class v0 extends nA{}).prototype.ValueTypeName="number";class KM extends YM{constructor(a,c,h,p){super(a,c,h,p)}interpolate_(a,c,h,p){const E=this.resultBuffer,H=this.sampleValues,K=this.valueSize,de=(h-c)/(p-c);let ge=a*K;for(let Me=ge+K;ge!==Me;ge+=4)Lo.slerpFlat(E,0,H,ge-K,H,ge,de);return E}}class b0 extends nA{InterpolantFactoryMethodLinear(a){return new KM(this.times,this.values,this.getValueSize(),a)}}b0.prototype.ValueTypeName="quaternion",b0.prototype.DefaultInterpolation=2301,b0.prototype.InterpolantFactoryMethodSmooth=void 0;class z_ extends nA{}z_.prototype.ValueTypeName="string",z_.prototype.ValueBufferType=Array,z_.prototype.DefaultInterpolation=2300,z_.prototype.InterpolantFactoryMethodLinear=void 0,z_.prototype.InterpolantFactoryMethodSmooth=void 0;(class x0 extends nA{}).prototype.ValueTypeName="vector";const y3=new lo;class v3{constructor(a,c,h=0,p=1/0){this.ray=new uf(a,c),this.near=h,this.far=p,this.camera=null,this.layers=new wl,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,c){this.ray.set(a,c)}setFromCamera(a,c){c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}setFromXRController(a){return y3.identity().extractRotation(a.matrixWorld),this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(y3),this}intersectObject(a,c=!0,h=[]){return eS(a,this,h,c),h.sort(b3),h}intersectObjects(a,c=!0,h=[]){for(let p=0,E=a.length;p<E;p++)eS(a[p],this,h,c);return h.sort(b3),h}}function b3(M,a){return M.distance-a.distance}function eS(M,a,c,h){if(M.layers.test(a.layers)&&M.raycast(a,c),!0===h){const p=M.children;for(let E=0,H=p.length;E<H;E++)eS(p[E],a,c,!0)}}class x3{constructor(a=!0){this.autoStart=a,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=w3(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=w3();a=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=a}return a}}function w3(){return(typeof performance>"u"?Date:performance).now()}class _P{constructor(a=1,c=0,h=0){return this.radius=a,this.phi=c,this.theta=h,this}set(a,c,h){return this.radius=a,this.phi=c,this.theta=h,this}copy(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,c,h){return this.radius=Math.sqrt(a*a+c*c+h*h),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,h),this.phi=Math.acos(Gl(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const tb=new Si;class yP{constructor(a=new Si(1/0,1/0),c=new Si(-1/0,-1/0)){this.isBox2=!0,this.min=a,this.max=c}set(a,c){return this.min.copy(a),this.max.copy(c),this}setFromPoints(a){this.makeEmpty();for(let c=0,h=a.length;c<h;c++)this.expandByPoint(a[c]);return this}setFromCenterAndSize(a,c){const h=tb.copy(c).multiplyScalar(.5);return this.min.copy(a).sub(h),this.max.copy(a).add(h),this}clone(){return(new this.constructor).copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}containsPoint(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,c){return c.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)}clampPoint(a,c){return c.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,tb).distanceTo(a)}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const tS=new Dn,zw=new Dn;class C3{constructor(a=new Dn,c=new Dn){this.start=a,this.end=c}set(a,c){return this.start.copy(a),this.end.copy(c),this}copy(a){return this.start.copy(a.start),this.end.copy(a.end),this}getCenter(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,c){return this.delta(c).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,c){tS.subVectors(a,this.start),zw.subVectors(this.end,this.start);const h=zw.dot(zw);let E=zw.dot(tS)/h;return c&&(E=Gl(E,0,1)),E}closestPointToPoint(a,c,h){const p=this.closestPointToPointParameter(a,c);return this.delta(h).multiplyScalar(p).add(this.start)}applyMatrix4(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class pN extends iy{constructor(a,c=1,h=16776960){const p=h,H=new us;H.setAttribute("position",new xo([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),H.computeBoundingSphere(),super(H,new ty({color:p,toneMapped:!1})),this.type="PlaneHelper",this.plane=a,this.size=c;const de=new us;de.setAttribute("position",new xo([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),de.computeBoundingSphere(),this.add(new gl(de,new gu({color:p,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(a)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}class vP{constructor(){this.type="ShapePath",this.color=new to,this.subPaths=[],this.currentPath=null}moveTo(a,c){return this.currentPath=new lw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,c),this}lineTo(a,c){return this.currentPath.lineTo(a,c),this}quadraticCurveTo(a,c,h,p){return this.currentPath.quadraticCurveTo(a,c,h,p),this}bezierCurveTo(a,c,h,p,E,H){return this.currentPath.bezierCurveTo(a,c,h,p,E,H),this}splineThru(a){return this.currentPath.splineThru(a),this}toShapes(a){function h(qe,Ft){const mt=Ft.length;let Ut=!1;for(let kn=mt-1,bn=0;bn<mt;kn=bn++){let wn=Ft[kn],$n=Ft[bn],wi=$n.x-wn.x,Nt=$n.y-wn.y;if(Math.abs(Nt)>Number.EPSILON){if(Nt<0&&(wn=Ft[bn],wi=-wi,$n=Ft[kn],Nt=-Nt),qe.y<wn.y||qe.y>$n.y)continue;if(qe.y===wn.y){if(qe.x===wn.x)return!0}else{const In=Nt*(qe.x-wn.x)-wi*(qe.y-wn.y);if(0===In)return!0;if(In<0)continue;Ut=!Ut}}else{if(qe.y!==wn.y)continue;if($n.x<=qe.x&&qe.x<=wn.x||wn.x<=qe.x&&qe.x<=$n.x)return!0}}return Ut}const p=mp.isClockWise,E=this.subPaths;if(0===E.length)return[];let H,K,de;const ge=[];if(1===E.length)return K=E[0],de=new Ef,de.curves=K.curves,ge.push(de),ge;let Me=!p(E[0].getPoints());Me=a?!Me:Me;const Le=[],Be=[];let bt,Ye,Ge=[],it=0;Be[it]=void 0,Ge[it]=[];for(let qe=0,Ft=E.length;qe<Ft;qe++)K=E[qe],bt=K.getPoints(),H=p(bt),H=a?!H:H,H?(!Me&&Be[it]&&it++,Be[it]={s:new Ef,p:bt},Be[it].s.curves=K.curves,Me&&it++,Ge[it]=[]):Ge[it].push({h:K,p:bt[0]});if(!Be[0])return function c(qe){const Ft=[];for(let mt=0,Ut=qe.length;mt<Ut;mt++){const kn=qe[mt],bn=new Ef;bn.curves=kn.curves,Ft.push(bn)}return Ft}(E);if(Be.length>1){let qe=!1,Ft=0;for(let mt=0,Ut=Be.length;mt<Ut;mt++)Le[mt]=[];for(let mt=0,Ut=Be.length;mt<Ut;mt++){const kn=Ge[mt];for(let bn=0;bn<kn.length;bn++){const wn=kn[bn];let $n=!0;for(let wi=0;wi<Be.length;wi++)h(wn.p,Be[wi].p)&&(mt!==wi&&Ft++,$n?($n=!1,Le[wi].push(wn)):qe=!0);$n&&Le[mt].push(wn)}}Ft>0&&!1===qe&&(Ge=Le)}for(let qe=0,Ft=Be.length;qe<Ft;qe++){de=Be[qe].s,ge.push(de),Ye=Ge[qe];for(let mt=0,Ut=Ye.length;mt<Ut;mt++)de.holes.push(Ye[mt].h)}return ge}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:b}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=b)},5193:(Ur,vt,Ee)=>{"use strict";Ee.d(vt,{AH:()=>w,Cg:()=>v,KQ:()=>z,NU:()=>Ie,_l:()=>b,s0:()=>D,w4:()=>te});var ve=Ee(357);class b extends ve.QCA{constructor(m,I={}){const A=I.font;if(void 0===A)super();else{const R=A.generateShapes(m,I.size);I.depth=void 0!==I.height?I.height:50,void 0===I.bevelThickness&&(I.bevelThickness=10),void 0===I.bevelSize&&(I.bevelSize=8),void 0===I.bevelEnabled&&(I.bevelEnabled=!1),super(R,I)}this.type="TextGeometry"}}class z{constructor(m){this.isFont=!0,this.type="Font",this.data=m}generateShapes(m,I=100){const A=[],R=function ke(N,m,I){const A=Array.from(N),R=m/I.resolution,k=(I.boundingBox.yMax-I.boundingBox.yMin+I.underlineThickness)*R,J=[];let _e=0,be=0;for(let Te=0;Te<A.length;Te++){const Pe=A[Te];if("\n"===Pe)_e=0,be-=k;else{const We=xe(Pe,R,_e,be,I);_e+=We.offsetX,J.push(We.path)}}return J}(m,I,this.data);for(let k=0,J=R.length;k<J;k++)A.push(...R[k].toShapes());return A}}function xe(N,m,I,A,R){const k=R.glyphs[N]||R.glyphs["?"];if(!k)return void console.error('THREE.Font: character "'+N+'" does not exists in font family '+R.familyName+".");const J=new ve.Ld9;let _e,be,Te,Pe,We,dt,Q,Ke;if(k.o){const Ze=k._cachedOutline||(k._cachedOutline=k.o.split(" "));for(let Ue=0,Oe=Ze.length;Ue<Oe;)switch(Ze[Ue++]){case"m":_e=Ze[Ue++]*m+I,be=Ze[Ue++]*m+A,J.moveTo(_e,be);break;case"l":_e=Ze[Ue++]*m+I,be=Ze[Ue++]*m+A,J.lineTo(_e,be);break;case"q":Te=Ze[Ue++]*m+I,Pe=Ze[Ue++]*m+A,We=Ze[Ue++]*m+I,dt=Ze[Ue++]*m+A,J.quadraticCurveTo(We,dt,Te,Pe);break;case"b":Te=Ze[Ue++]*m+I,Pe=Ze[Ue++]*m+A,We=Ze[Ue++]*m+I,dt=Ze[Ue++]*m+A,Q=Ze[Ue++]*m+I,Ke=Ze[Ue++]*m+A,J.bezierCurveTo(We,dt,Q,Ke,Te,Pe)}}return{offsetX:k.ha*m,path:J}}const et={type:"change"},Je={type:"start"},Xe={type:"end"},ot=new ve.RlV,Re=new ve.Zcv,He=Math.cos(70*ve.cj9.DEG2RAD);class Ie extends ve.Qev{constructor(m,I){super(),this.object=m,this.domElement=I,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new ve.Pq0,this.cursor=new ve.Pq0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ve.kBv.ROTATE,MIDDLE:ve.kBv.DOLLY,RIGHT:ve.kBv.PAN},this.touches={ONE:ve.wtR.ROTATE,TWO:ve.wtR.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return _e.phi},this.getAzimuthalAngle=function(){return _e.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(at){at.addEventListener("keydown",$),this._domElementKeyEvents=at},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",$),this._domElementKeyEvents=null},this.saveState=function(){A.target0.copy(A.target),A.position0.copy(A.object.position),A.zoom0=A.object.zoom},this.reset=function(){A.target.copy(A.target0),A.object.position.copy(A.position0),A.object.zoom=A.zoom0,A.object.updateProjectionMatrix(),A.dispatchEvent(et),A.update(),k=R.NONE},this.resetOrthoPanZoom=function(){Pe.set(0,0,0),A.object.zoom=1,A.object.updateProjectionMatrix()},this.update=function(){const at=new ve.Pq0,nn=(new ve.PTz).setFromUnitVectors(m.up,new ve.Pq0(0,1,0)),Wt=nn.clone().invert(),gn=new ve.Pq0,ze=new ve.PTz,Qe=new ve.Pq0,ut=2*Math.PI;return function(Lt=null){const xn=A.object.position;at.copy(xn).sub(A.target),at.applyQuaternion(nn),_e.setFromVector3(at),A.autoRotate&&k===R.NONE&&pn(function An(at){return null!==at?2*Math.PI/60*A.autoRotateSpeed*at:2*Math.PI/60/60*A.autoRotateSpeed}(Lt)),A.enableDamping?(_e.theta+=be.theta*A.dampingFactor,_e.phi+=be.phi*A.dampingFactor):(_e.theta+=be.theta,_e.phi+=be.phi);let rn=A.minAzimuthAngle,Xt=A.maxAzimuthAngle;isFinite(rn)&&isFinite(Xt)&&(rn<-Math.PI?rn+=ut:rn>Math.PI&&(rn-=ut),Xt<-Math.PI?Xt+=ut:Xt>Math.PI&&(Xt-=ut),_e.theta=rn<=Xt?Math.max(rn,Math.min(Xt,_e.theta)):_e.theta>(rn+Xt)/2?Math.max(rn,_e.theta):Math.min(Xt,_e.theta)),_e.phi=Math.max(A.minPolarAngle,Math.min(A.maxPolarAngle,_e.phi)),_e.makeSafe(),!0===A.enableDamping?A.target.addScaledVector(Pe,A.dampingFactor):A.target.add(Pe),A.target.sub(A.cursor),A.target.clampLength(A.minTargetRadius,A.maxTargetRadius),A.target.add(A.cursor);let cn=!1;if(A.zoomToCursor&&yt||A.object.isOrthographicCamera)_e.radius=hi(_e.radius);else{const Pn=_e.radius;_e.radius=hi(_e.radius*Te),cn=Pn!=_e.radius}if(at.setFromSpherical(_e),at.applyQuaternion(Wt),xn.copy(A.target).add(at),A.object.lookAt(A.target),!0===A.enableDamping?(be.theta*=1-A.dampingFactor,be.phi*=1-A.dampingFactor,Pe.multiplyScalar(1-A.dampingFactor)):(be.set(0,0,0),Pe.set(0,0,0)),A.zoomToCursor&&yt){let Pn=null;if(A.object.isPerspectiveCamera){const Zn=at.length();Pn=hi(Zn*Te);const Ui=Zn-Pn;A.object.position.addScaledVector(ht,Ui),A.object.updateMatrixWorld(),cn=!!Ui}else if(A.object.isOrthographicCamera){const Zn=new ve.Pq0(st.x,st.y,0);Zn.unproject(A.object);const Ui=A.object.zoom;A.object.zoom=Math.max(A.minZoom,Math.min(A.maxZoom,A.object.zoom/Te)),A.object.updateProjectionMatrix(),cn=Ui!==A.object.zoom;const Ki=new ve.Pq0(st.x,st.y,0);Ki.unproject(A.object),A.object.position.sub(Ki).add(Zn),A.object.updateMatrixWorld(),Pn=at.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),A.zoomToCursor=!1;null!==Pn&&(this.screenSpacePanning?A.target.set(0,0,-1).transformDirection(A.object.matrix).multiplyScalar(Pn).add(A.object.position):(ot.origin.copy(A.object.position),ot.direction.set(0,0,-1).transformDirection(A.object.matrix),Math.abs(A.object.up.dot(ot.direction))<He?m.lookAt(A.target):(Re.setFromNormalAndCoplanarPoint(A.object.up,A.target),ot.intersectPlane(Re,A.target))))}else if(A.object.isOrthographicCamera){const Pn=A.object.zoom;A.object.zoom=Math.max(A.minZoom,Math.min(A.maxZoom,A.object.zoom/Te)),Pn!==A.object.zoom&&(A.object.updateProjectionMatrix(),cn=!0)}return Te=1,yt=!1,!!(cn||gn.distanceToSquared(A.object.position)>J||8*(1-ze.dot(A.object.quaternion))>J||Qe.distanceToSquared(A.target)>J)&&(A.dispatchEvent(et),gn.copy(A.object.position),ze.copy(A.object.quaternion),Qe.copy(A.target),!0)}}(),this.dispose=function(){A.domElement.removeEventListener("contextmenu",Ae),A.domElement.removeEventListener("pointerdown",ln),A.domElement.removeEventListener("pointercancel",Ci),A.domElement.removeEventListener("wheel",Fn),A.domElement.removeEventListener("pointermove",Un),A.domElement.removeEventListener("pointerup",Ci),A.domElement.getRootNode().removeEventListener("keydown",tr,{capture:!0}),null!==A._domElementKeyEvents&&(A._domElementKeyEvents.removeEventListener("keydown",$),A._domElementKeyEvents=null)};const A=this,R={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let k=R.NONE;const J=1e-6,_e=new ve.YHV,be=new ve.YHV;let Te=1;const Pe=new ve.Pq0,We=new ve.I9Y,dt=new ve.I9Y,Q=new ve.I9Y,Ke=new ve.I9Y,Ze=new ve.I9Y,Ue=new ve.I9Y,Oe=new ve.I9Y,lt=new ve.I9Y,gt=new ve.I9Y,ht=new ve.Pq0,st=new ve.I9Y;let yt=!1;const Kt=[],Ot={};let It=!1;function on(at){const nn=Math.abs(.01*at);return Math.pow(.95,A.zoomSpeed*nn)}function pn(at){be.theta-=at}function Qt(at){be.phi-=at}const Bn=function(){const at=new ve.Pq0;return function(Wt,gn){at.setFromMatrixColumn(gn,0),at.multiplyScalar(-Wt),Pe.add(at)}}(),dn=function(){const at=new ve.Pq0;return function(Wt,gn){!0===A.screenSpacePanning?at.setFromMatrixColumn(gn,1):(at.setFromMatrixColumn(gn,0),at.crossVectors(A.object.up,at)),at.multiplyScalar(Wt),Pe.add(at)}}(),yn=function(){const at=new ve.Pq0;return function(Wt,gn){const ze=A.domElement;if(A.object.isPerspectiveCamera){at.copy(A.object.position).sub(A.target);let ut=at.length();ut*=Math.tan(A.object.fov/2*Math.PI/180),Bn(2*Wt*ut/ze.clientHeight,A.object.matrix),dn(2*gn*ut/ze.clientHeight,A.object.matrix)}else A.object.isOrthographicCamera?(Bn(Wt*(A.object.right-A.object.left)/A.object.zoom/ze.clientWidth,A.object.matrix),dn(gn*(A.object.top-A.object.bottom)/A.object.zoom/ze.clientHeight,A.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),A.enablePan=!1)}}();function Tn(at){A.object.isPerspectiveCamera||A.object.isOrthographicCamera?Te/=at:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),A.enableZoom=!1)}function Hn(at){A.object.isPerspectiveCamera||A.object.isOrthographicCamera?Te*=at:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),A.enableZoom=!1)}function ti(at,nn){if(!A.zoomToCursor)return;yt=!0;const Wt=A.domElement.getBoundingClientRect(),ze=nn-Wt.top,ut=Wt.height;st.x=(at-Wt.left)/Wt.width*2-1,st.y=-ze/ut*2+1,ht.set(st.x,st.y,1).unproject(A.object).sub(A.object.position).normalize()}function hi(at){return Math.max(A.minDistance,Math.min(A.maxDistance,at))}function ai(at){We.set(at.clientX,at.clientY)}function Or(at){Ke.set(at.clientX,at.clientY)}function pe(at){if(1===Kt.length)We.set(at.pageX,at.pageY);else{const nn=ct(at);We.set(.5*(at.pageX+nn.x),.5*(at.pageY+nn.y))}}function me(at){if(1===Kt.length)Ke.set(at.pageX,at.pageY);else{const nn=ct(at);Ke.set(.5*(at.pageX+nn.x),.5*(at.pageY+nn.y))}}function Fe(at){const nn=ct(at),Wt=at.pageX-nn.x,gn=at.pageY-nn.y,ze=Math.sqrt(Wt*Wt+gn*gn);Oe.set(0,ze)}function St(at){if(1==Kt.length)dt.set(at.pageX,at.pageY);else{const Wt=ct(at);dt.set(.5*(at.pageX+Wt.x),.5*(at.pageY+Wt.y))}Q.subVectors(dt,We).multiplyScalar(A.rotateSpeed);const nn=A.domElement;pn(2*Math.PI*Q.x/nn.clientHeight),Qt(2*Math.PI*Q.y/nn.clientHeight),We.copy(dt)}function xt(at){if(1===Kt.length)Ze.set(at.pageX,at.pageY);else{const nn=ct(at);Ze.set(.5*(at.pageX+nn.x),.5*(at.pageY+nn.y))}Ue.subVectors(Ze,Ke).multiplyScalar(A.panSpeed),yn(Ue.x,Ue.y),Ke.copy(Ze)}function En(at){const nn=ct(at),Wt=at.pageX-nn.x,gn=at.pageY-nn.y,ze=Math.sqrt(Wt*Wt+gn*gn);lt.set(0,ze),gt.set(0,Math.pow(lt.y/Oe.y,A.zoomSpeed)),Tn(gt.y),Oe.copy(lt),ti(.5*(at.pageX+nn.x),.5*(at.pageY+nn.y))}function ln(at){!1!==A.enabled&&(0===Kt.length&&(A.domElement.setPointerCapture(at.pointerId),A.domElement.addEventListener("pointermove",Un),A.domElement.addEventListener("pointerup",Ci)),!function nt(at){for(let nn=0;nn<Kt.length;nn++)if(Kt[nn]==at.pointerId)return!0;return!1}(at)&&(function Ce(at){Kt.push(at.pointerId)}(at),"touch"===at.pointerType?S(at):function Rn(at){let nn;switch(at.button){case 0:nn=A.mouseButtons.LEFT;break;case 1:nn=A.mouseButtons.MIDDLE;break;case 2:nn=A.mouseButtons.RIGHT;break;default:nn=-1}switch(nn){case ve.kBv.DOLLY:if(!1===A.enableZoom)return;(function Xi(at){ti(at.clientX,at.clientX),Oe.set(at.clientX,at.clientY)})(at),k=R.DOLLY;break;case ve.kBv.ROTATE:if(at.ctrlKey||at.metaKey||at.shiftKey){if(!1===A.enablePan)return;Or(at),k=R.PAN}else{if(!1===A.enableRotate)return;ai(at),k=R.ROTATE}break;case ve.kBv.PAN:if(at.ctrlKey||at.metaKey||at.shiftKey){if(!1===A.enableRotate)return;ai(at),k=R.ROTATE}else{if(!1===A.enablePan)return;Or(at),k=R.PAN}break;default:k=R.NONE}k!==R.NONE&&A.dispatchEvent(Je)}(at)))}function Un(at){!1!==A.enabled&&("touch"===at.pointerType?function Z(at){switch(rt(at),k){case R.TOUCH_ROTATE:if(!1===A.enableRotate)return;St(at),A.update();break;case R.TOUCH_PAN:if(!1===A.enablePan)return;xt(at),A.update();break;case R.TOUCH_DOLLY_PAN:if(!1===A.enableZoom&&!1===A.enablePan)return;(function jt(at){A.enableZoom&&En(at),A.enablePan&&xt(at)})(at),A.update();break;case R.TOUCH_DOLLY_ROTATE:if(!1===A.enableZoom&&!1===A.enableRotate)return;(function Cn(at){A.enableZoom&&En(at),A.enableRotate&&St(at)})(at),A.update();break;default:k=R.NONE}}(at):function si(at){switch(k){case R.ROTATE:if(!1===A.enableRotate)return;!function Tr(at){dt.set(at.clientX,at.clientY),Q.subVectors(dt,We).multiplyScalar(A.rotateSpeed);const nn=A.domElement;pn(2*Math.PI*Q.x/nn.clientHeight),Qt(2*Math.PI*Q.y/nn.clientHeight),We.copy(dt),A.update()}(at);break;case R.DOLLY:if(!1===A.enableZoom)return;!function ys(at){lt.set(at.clientX,at.clientY),gt.subVectors(lt,Oe),gt.y>0?Tn(on(gt.y)):gt.y<0&&Hn(on(gt.y)),Oe.copy(lt),A.update()}(at);break;case R.PAN:if(!1===A.enablePan)return;!function ds(at){Ze.set(at.clientX,at.clientY),Ue.subVectors(Ze,Ke).multiplyScalar(A.panSpeed),yn(Ue.x,Ue.y),Ke.copy(Ze),A.update()}(at)}}(at))}function Ci(at){switch(function $e(at){delete Ot[at.pointerId];for(let nn=0;nn<Kt.length;nn++)if(Kt[nn]==at.pointerId)return void Kt.splice(nn,1)}(at),Kt.length){case 0:A.domElement.releasePointerCapture(at.pointerId),A.domElement.removeEventListener("pointermove",Un),A.domElement.removeEventListener("pointerup",Ci),A.dispatchEvent(Xe),k=R.NONE;break;case 1:const nn=Kt[0],Wt=Ot[nn];S({pointerId:nn,pageX:Wt.x,pageY:Wt.y})}}function Fn(at){!1===A.enabled||!1===A.enableZoom||k!==R.NONE||(at.preventDefault(),A.dispatchEvent(Je),function wt(at){ti(at.clientX,at.clientY),at.deltaY<0?Hn(on(at.deltaY)):at.deltaY>0&&Tn(on(at.deltaY)),A.update()}(function Zt(at){const Wt={clientX:at.clientX,clientY:at.clientY,deltaY:at.deltaY};switch(at.deltaMode){case 1:Wt.deltaY*=16;break;case 2:Wt.deltaY*=100}return at.ctrlKey&&!It&&(Wt.deltaY*=10),Wt}(at)),A.dispatchEvent(Xe))}function tr(at){"Control"===at.key&&(It=!0,A.domElement.getRootNode().addEventListener("keyup",Ne,{passive:!0,capture:!0}))}function Ne(at){"Control"===at.key&&(It=!1,A.domElement.getRootNode().removeEventListener("keyup",Ne,{passive:!0,capture:!0}))}function $(at){!1===A.enabled||!1===A.enablePan||function W(at){let nn=!1;switch(at.code){case A.keys.UP:at.ctrlKey||at.metaKey||at.shiftKey?Qt(2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):yn(0,A.keyPanSpeed),nn=!0;break;case A.keys.BOTTOM:at.ctrlKey||at.metaKey||at.shiftKey?Qt(-2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):yn(0,-A.keyPanSpeed),nn=!0;break;case A.keys.LEFT:at.ctrlKey||at.metaKey||at.shiftKey?pn(2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):yn(A.keyPanSpeed,0),nn=!0;break;case A.keys.RIGHT:at.ctrlKey||at.metaKey||at.shiftKey?pn(-2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):yn(-A.keyPanSpeed,0),nn=!0}nn&&(at.preventDefault(),A.update())}(at)}function S(at){switch(rt(at),Kt.length){case 1:switch(A.touches.ONE){case ve.wtR.ROTATE:if(!1===A.enableRotate)return;pe(at),k=R.TOUCH_ROTATE;break;case ve.wtR.PAN:if(!1===A.enablePan)return;me(at),k=R.TOUCH_PAN;break;default:k=R.NONE}break;case 2:switch(A.touches.TWO){case ve.wtR.DOLLY_PAN:if(!1===A.enableZoom&&!1===A.enablePan)return;(function At(at){A.enableZoom&&Fe(at),A.enablePan&&me(at)})(at),k=R.TOUCH_DOLLY_PAN;break;case ve.wtR.DOLLY_ROTATE:if(!1===A.enableZoom&&!1===A.enableRotate)return;(function Et(at){A.enableZoom&&Fe(at),A.enableRotate&&pe(at)})(at),k=R.TOUCH_DOLLY_ROTATE;break;default:k=R.NONE}break;default:k=R.NONE}k!==R.NONE&&A.dispatchEvent(Je)}function Ae(at){!1!==A.enabled&&at.preventDefault()}function rt(at){let nn=Ot[at.pointerId];void 0===nn&&(nn=new ve.I9Y,Ot[at.pointerId]=nn),nn.set(at.pageX,at.pageY)}function ct(at){return Ot[at.pointerId===Kt[0]?Kt[1]:Kt[0]]}A.domElement.addEventListener("contextmenu",Ae),A.domElement.addEventListener("pointerdown",ln),A.domElement.addEventListener("pointercancel",Ci),A.domElement.addEventListener("wheel",Fn,{passive:!1}),A.domElement.getRootNode().addEventListener("keydown",tr,{passive:!0,capture:!0}),this.update()}}const O={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class ce{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const ie=new ve.qUd(-1,1,1,-1,0,1),ue=new class he extends ve.LoY{constructor(){super(),this.setAttribute("position",new ve.qtW([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ve.qtW([0,2,0,0,2,0],2))}};class fe{constructor(m){this._mesh=new ve.eaF(ue,m)}dispose(){this._mesh.geometry.dispose()}render(m){m.render(this._mesh,ie)}get material(){return this._mesh.material}set material(m){this._mesh.material=m}}class le extends ce{constructor(m,I){super(),this.textureID=void 0!==I?I:"tDiffuse",m instanceof ve.BKk?(this.uniforms=m.uniforms,this.material=m):m&&(this.uniforms=ve.LlO.clone(m.uniforms),this.material=new ve.BKk({name:void 0!==m.name?m.name:"unspecified",defines:Object.assign({},m.defines),uniforms:this.uniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader})),this.fsQuad=new fe(this.material)}render(m,I,A){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=A.texture),this.fsQuad.material=this.material,this.renderToScreen?(m.setRenderTarget(null),this.fsQuad.render(m)):(m.setRenderTarget(I),this.clear&&m.clear(m.autoClearColor,m.autoClearDepth,m.autoClearStencil),this.fsQuad.render(m))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Y extends ce{constructor(m,I){super(),this.scene=m,this.camera=I,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(m,I,A){const R=m.getContext(),k=m.state;let J,_e;k.buffers.color.setMask(!1),k.buffers.depth.setMask(!1),k.buffers.color.setLocked(!0),k.buffers.depth.setLocked(!0),this.inverse?(J=0,_e=1):(J=1,_e=0),k.buffers.stencil.setTest(!0),k.buffers.stencil.setOp(R.REPLACE,R.REPLACE,R.REPLACE),k.buffers.stencil.setFunc(R.ALWAYS,J,4294967295),k.buffers.stencil.setClear(_e),k.buffers.stencil.setLocked(!0),m.setRenderTarget(A),this.clear&&m.clear(),m.render(this.scene,this.camera),m.setRenderTarget(I),this.clear&&m.clear(),m.render(this.scene,this.camera),k.buffers.color.setLocked(!1),k.buffers.depth.setLocked(!1),k.buffers.color.setMask(!0),k.buffers.depth.setMask(!0),k.buffers.stencil.setLocked(!1),k.buffers.stencil.setFunc(R.EQUAL,1,4294967295),k.buffers.stencil.setOp(R.KEEP,R.KEEP,R.KEEP),k.buffers.stencil.setLocked(!0)}}class V extends ce{constructor(){super(),this.needsSwap=!1}render(m){m.state.buffers.stencil.setLocked(!1),m.state.buffers.stencil.setTest(!1)}}class D{constructor(m,I){if(this.renderer=m,this._pixelRatio=m.getPixelRatio(),void 0===I){const A=m.getSize(new ve.I9Y);this._width=A.width,this._height=A.height,(I=new ve.nWS(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:ve.ix0})).texture.name="EffectComposer.rt1"}else this._width=I.width,this._height=I.height;this.renderTarget1=I,this.renderTarget2=I.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new le(O),this.copyPass.material.blending=ve.XIg,this.clock=new ve.zD7}swapBuffers(){const m=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=m}addPass(m){this.passes.push(m),m.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(m,I){this.passes.splice(I,0,m),m.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(m){const I=this.passes.indexOf(m);-1!==I&&this.passes.splice(I,1)}isLastEnabledPass(m){for(let I=m+1;I<this.passes.length;I++)if(this.passes[I].enabled)return!1;return!0}render(m){void 0===m&&(m=this.clock.getDelta());const I=this.renderer.getRenderTarget();let A=!1;for(let R=0,k=this.passes.length;R<k;R++){const J=this.passes[R];if(!1!==J.enabled){if(J.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(R),J.render(this.renderer,this.writeBuffer,this.readBuffer,m,A),J.needsSwap){if(A){const _e=this.renderer.getContext(),be=this.renderer.state.buffers.stencil;be.setFunc(_e.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,m),be.setFunc(_e.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Y&&(J instanceof Y?A=!0:J instanceof V&&(A=!1))}}this.renderer.setRenderTarget(I)}reset(m){if(void 0===m){const I=this.renderer.getSize(new ve.I9Y);this._pixelRatio=this.renderer.getPixelRatio(),this._width=I.width,this._height=I.height,(m=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=m,this.renderTarget2=m.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(m,I){this._width=m,this._height=I;const A=this._width*this._pixelRatio,R=this._height*this._pixelRatio;this.renderTarget1.setSize(A,R),this.renderTarget2.setSize(A,R);for(let k=0;k<this.passes.length;k++)this.passes[k].setSize(A,R)}setPixelRatio(m){this._pixelRatio=m,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class w extends ce{constructor(m,I,A=null,R=null,k=null){super(),this.scene=m,this.camera=I,this.overrideMaterial=A,this.clearColor=R,this.clearAlpha=k,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new ve.Q1f}render(m,I,A){const R=m.autoClear;let k,J;m.autoClear=!1,null!==this.overrideMaterial&&(J=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(m.getClearColor(this._oldClearColor),m.setClearColor(this.clearColor)),null!==this.clearAlpha&&(k=m.getClearAlpha(),m.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&m.clearDepth(),m.setRenderTarget(this.renderToScreen?null:A),!0===this.clear&&m.clear(m.autoClearColor,m.autoClearDepth,m.autoClearStencil),m.render(this.scene,this.camera),null!==this.clearColor&&m.setClearColor(this._oldClearColor),null!==this.clearAlpha&&m.setClearAlpha(k),null!==this.overrideMaterial&&(this.scene.overrideMaterial=J),m.autoClear=R}}const x={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new ve.Q1f(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class v extends ce{constructor(m,I,A,R){super(),this.strength=void 0!==I?I:1,this.radius=A,this.threshold=R,this.resolution=void 0!==m?new ve.I9Y(m.x,m.y):new ve.I9Y(256,256),this.clearColor=new ve.Q1f(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let k=Math.round(this.resolution.x/2),J=Math.round(this.resolution.y/2);this.renderTargetBright=new ve.nWS(k,J,{type:ve.ix0}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let We=0;We<this.nMips;We++){const dt=new ve.nWS(k,J,{type:ve.ix0});dt.texture.name="UnrealBloomPass.h"+We,dt.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(dt);const Q=new ve.nWS(k,J,{type:ve.ix0});Q.texture.name="UnrealBloomPass.v"+We,Q.texture.generateMipmaps=!1,this.renderTargetsVertical.push(Q),k=Math.round(k/2),J=Math.round(J/2)}const _e=x;this.highPassUniforms=ve.LlO.clone(_e.uniforms),this.highPassUniforms.luminosityThreshold.value=R,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ve.BKk({uniforms:this.highPassUniforms,vertexShader:_e.vertexShader,fragmentShader:_e.fragmentShader}),this.separableBlurMaterials=[];const be=[3,5,7,9,11];k=Math.round(this.resolution.x/2),J=Math.round(this.resolution.y/2);for(let We=0;We<this.nMips;We++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(be[We])),this.separableBlurMaterials[We].uniforms.invSize.value=new ve.I9Y(1/k,1/J),k=Math.round(k/2),J=Math.round(J/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=I,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new ve.Pq0(1,1,1),new ve.Pq0(1,1,1),new ve.Pq0(1,1,1),new ve.Pq0(1,1,1),new ve.Pq0(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const Pe=O;this.copyUniforms=ve.LlO.clone(Pe.uniforms),this.blendMaterial=new ve.BKk({uniforms:this.copyUniforms,vertexShader:Pe.vertexShader,fragmentShader:Pe.fragmentShader,blending:ve.EZo,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new ve.Q1f,this.oldClearAlpha=1,this.basic=new ve.V9B,this.fsQuad=new fe(null)}dispose(){for(let m=0;m<this.renderTargetsHorizontal.length;m++)this.renderTargetsHorizontal[m].dispose();for(let m=0;m<this.renderTargetsVertical.length;m++)this.renderTargetsVertical[m].dispose();this.renderTargetBright.dispose();for(let m=0;m<this.separableBlurMaterials.length;m++)this.separableBlurMaterials[m].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(m,I){let A=Math.round(m/2),R=Math.round(I/2);this.renderTargetBright.setSize(A,R);for(let k=0;k<this.nMips;k++)this.renderTargetsHorizontal[k].setSize(A,R),this.renderTargetsVertical[k].setSize(A,R),this.separableBlurMaterials[k].uniforms.invSize.value=new ve.I9Y(1/A,1/R),A=Math.round(A/2),R=Math.round(R/2)}render(m,I,A,R,k){m.getClearColor(this._oldClearColor),this.oldClearAlpha=m.getClearAlpha();const J=m.autoClear;m.autoClear=!1,m.setClearColor(this.clearColor,0),k&&m.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=A.texture,m.setRenderTarget(null),m.clear(),this.fsQuad.render(m)),this.highPassUniforms.tDiffuse.value=A.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,m.setRenderTarget(this.renderTargetBright),m.clear(),this.fsQuad.render(m);let _e=this.renderTargetBright;for(let be=0;be<this.nMips;be++)this.fsQuad.material=this.separableBlurMaterials[be],this.separableBlurMaterials[be].uniforms.colorTexture.value=_e.texture,this.separableBlurMaterials[be].uniforms.direction.value=v.BlurDirectionX,m.setRenderTarget(this.renderTargetsHorizontal[be]),m.clear(),this.fsQuad.render(m),this.separableBlurMaterials[be].uniforms.colorTexture.value=this.renderTargetsHorizontal[be].texture,this.separableBlurMaterials[be].uniforms.direction.value=v.BlurDirectionY,m.setRenderTarget(this.renderTargetsVertical[be]),m.clear(),this.fsQuad.render(m),_e=this.renderTargetsVertical[be];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,m.setRenderTarget(this.renderTargetsHorizontal[0]),m.clear(),this.fsQuad.render(m),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,k&&m.state.buffers.stencil.setTest(!0),this.renderToScreen?(m.setRenderTarget(null),this.fsQuad.render(m)):(m.setRenderTarget(A),this.fsQuad.render(m)),m.setClearColor(this._oldClearColor,this.oldClearAlpha),m.autoClear=J}getSeperableBlurMaterial(m){const I=[];for(let A=0;A<m;A++)I.push(.39894*Math.exp(-.5*A*A/(m*m))/m);return new ve.BKk({defines:{KERNEL_RADIUS:m},uniforms:{colorTexture:{value:null},invSize:{value:new ve.I9Y(.5,.5)},direction:{value:new ve.I9Y(.5,.5)},gaussianCoefficients:{value:I}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(m){return new ve.BKk({defines:{NUM_MIPS:m},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}v.BlurDirectionX=new ve.I9Y(1,0),v.BlurDirectionY=new ve.I9Y(0,1);class _{constructor(){this.id=0,this.object=null,this.z=0,this.renderOrder=0}}class C{constructor(){this.id=0,this.v1=new L,this.v2=new L,this.v3=new L,this.normalModel=new ve.Pq0,this.vertexNormalsModel=[new ve.Pq0,new ve.Pq0,new ve.Pq0],this.vertexNormalsLength=0,this.color=new ve.Q1f,this.material=null,this.uvs=[new ve.I9Y,new ve.I9Y,new ve.I9Y],this.z=0,this.renderOrder=0}}class L{constructor(){this.position=new ve.Pq0,this.positionWorld=new ve.Pq0,this.positionScreen=new ve.IUQ,this.visible=!0}copy(m){this.positionWorld.copy(m.positionWorld),this.positionScreen.copy(m.positionScreen)}}class F{constructor(){this.id=0,this.v1=new L,this.v2=new L,this.vertexColors=[new ve.Q1f,new ve.Q1f],this.material=null,this.z=0,this.renderOrder=0}}class U{constructor(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new ve.I9Y,this.material=null,this.renderOrder=0}}class j{constructor(){let m,I,R,k,_e,be,Pe,We,Q,Ke,Ue,A=0,J=0,Te=0,dt=0,Ze=0;const Oe={objects:[],lights:[],elements:[]},lt=new ve.Pq0,gt=new ve.IUQ,ht=new ve.NRn(new ve.Pq0(-1,-1,-1),new ve.Pq0(1,1,1)),st=new ve.NRn,yt=new Array(3),Kt=new ve.kn4,Ot=new ve.kn4,It=new ve.kn4,An=new ve.PPD,on=[],pn=[],Qt=[],Bn=[],dn=[],Tn=new function yn(){const W=[],pe=[],me=[];let Fe=null;const At=new ve.dwI;function St(si){const Zt=si.positionWorld,tr=si.positionScreen;Zt.copy(si.position).applyMatrix4(Ue),tr.copy(Zt).applyMatrix4(Ot);const Ne=1/tr.w;tr.x*=Ne,tr.y*=Ne,tr.z*=Ne,si.visible=tr.x>=-1&&tr.x<=1&&tr.y>=-1&&tr.y<=1&&tr.z>=-1&&tr.z<=1}function ln(si,Fn,Zt){return!0===si.visible||!0===Fn.visible||!0===Zt.visible||(yt[0]=si.positionScreen,yt[1]=Fn.positionScreen,yt[2]=Zt.positionScreen,ht.intersectsBox(st.setFromPoints(yt)))}function Un(si,Fn,Zt){return(Zt.positionScreen.x-si.positionScreen.x)*(Fn.positionScreen.y-si.positionScreen.y)-(Zt.positionScreen.y-si.positionScreen.y)*(Fn.positionScreen.x-si.positionScreen.x)<0}return{setObject:function Et(si){Fe=si,At.getNormalMatrix(Fe.matrixWorld),W.length=0,pe.length=0,me.length=0},projectVertex:St,checkTriangleVisibility:ln,checkBackfaceCulling:Un,pushVertex:function xt(si,Fn,Zt){R=function Xi(){if(k===J){const W=new L;return pn.push(W),J++,k++,W}return pn[k++]}(),R.position.set(si,Fn,Zt),St(R)},pushNormal:function En(si,Fn,Zt){W.push(si,Fn,Zt)},pushColor:function jt(si,Fn,Zt){pe.push(si,Fn,Zt)},pushUv:function Cn(si,Fn){me.push(si,Fn)},pushLine:function Ci(si,Fn){const Zt=pn[si],tr=pn[Fn];Zt.positionScreen.copy(Zt.position).applyMatrix4(It),tr.positionScreen.copy(tr.position).applyMatrix4(It),!0===function wt(W,pe){let me=0,Fe=1;const At=W.z+W.w,Et=pe.z+pe.w,St=-W.z+W.w,xt=-pe.z+pe.w;return At>=0&&Et>=0&&St>=0&&xt>=0||!(At<0&&Et<0||St<0&&xt<0)&&(At<0?me=Math.max(me,At/(At-Et)):Et<0&&(Fe=Math.min(Fe,At/(At-Et))),St<0?me=Math.max(me,St/(St-xt)):xt<0&&(Fe=Math.min(Fe,St/(St-xt))),!(Fe<me||(W.lerp(pe,me),pe.lerp(W,1-Fe),0)))}(Zt.positionScreen,tr.positionScreen)&&(Zt.positionScreen.multiplyScalar(1/Zt.positionScreen.w),tr.positionScreen.multiplyScalar(1/tr.positionScreen.w),Pe=function Tr(){if(We===dt){const W=new F;return Bn.push(W),dt++,We++,W}return Bn[We++]}(),Pe.id=Fe.id,Pe.v1.copy(Zt),Pe.v2.copy(tr),Pe.z=Math.max(Zt.positionScreen.z,tr.positionScreen.z),Pe.renderOrder=Fe.renderOrder,Pe.material=Fe.material,Fe.material.vertexColors&&(Pe.vertexColors[0].fromArray(pe,3*si),Pe.vertexColors[1].fromArray(pe,3*Fn)),Oe.elements.push(Pe))},pushTriangle:function Rn(si,Fn,Zt,tr){const Ne=pn[si],$=pn[Fn],S=pn[Zt];if(!1!==ln(Ne,$,S)&&(tr.side===ve.$EB||!0===Un(Ne,$,S))){_e=function Or(){if(be===Te){const W=new C;return Qt.push(W),Te++,be++,W}return Qt[be++]}(),_e.id=Fe.id,_e.v1.copy(Ne),_e.v2.copy($),_e.v3.copy(S),_e.z=(Ne.positionScreen.z+$.positionScreen.z+S.positionScreen.z)/3,_e.renderOrder=Fe.renderOrder,lt.subVectors(S.position,$.position),gt.subVectors(Ne.position,$.position),lt.cross(gt),_e.normalModel.copy(lt),_e.normalModel.applyMatrix3(At).normalize();for(let Z=0;Z<3;Z++){const Ae=_e.vertexNormalsModel[Z];Ae.fromArray(W,3*arguments[Z]),Ae.applyMatrix3(At).normalize(),_e.uvs[Z].fromArray(me,2*arguments[Z])}_e.vertexNormalsLength=3,_e.material=tr,tr.vertexColors&&_e.color.fromArray(pe,3*si),Oe.elements.push(_e)}}}};function Hn(W){if(!1===W.visible)return;if(W.isLight)Oe.lights.push(W);else if(W.isMesh||W.isLine||W.isPoints){if(!1===W.material.visible||!0===W.frustumCulled&&!1===An.intersectsObject(W))return;ti(W)}else if(W.isSprite){if(!1===W.material.visible||!0===W.frustumCulled&&!1===An.intersectsSprite(W))return;ti(W)}const pe=W.children;for(let me=0,Fe=pe.length;me<Fe;me++)Hn(pe[me])}function ti(W){m=function ai(){if(I===A){const W=new _;return on.push(W),A++,I++,W}return on[I++]}(),m.id=W.id,m.object=W,lt.setFromMatrixPosition(W.matrixWorld),lt.applyMatrix4(Ot),m.z=lt.z,m.renderOrder=W.renderOrder,Oe.objects.push(m)}function hi(W,pe,me){const Fe=1/W.w;W.z*=Fe,W.z>=-1&&W.z<=1&&(Q=function ys(){if(Ke===Ze){const W=new U;return dn.push(W),Ze++,Ke++,W}return dn[Ke++]}(),Q.id=pe.id,Q.x=W.x*Fe,Q.y=W.y*Fe,Q.z=W.z,Q.renderOrder=pe.renderOrder,Q.object=pe,Q.rotation=pe.rotation,Q.scale.x=pe.scale.x*Math.abs(Q.x-(W.x+me.projectionMatrix.elements[0])/(W.w+me.projectionMatrix.elements[12])),Q.scale.y=pe.scale.y*Math.abs(Q.y-(W.y+me.projectionMatrix.elements[5])/(W.w+me.projectionMatrix.elements[13])),Q.material=pe.material,Oe.elements.push(Q))}function ds(W,pe){return W.renderOrder!==pe.renderOrder?W.renderOrder-pe.renderOrder:W.z!==pe.z?pe.z-W.z:W.id!==pe.id?W.id-pe.id:0}this.projectScene=function(W,pe,me,Fe){be=0,We=0,Ke=0,Oe.elements.length=0,!0===W.matrixWorldAutoUpdate&&W.updateMatrixWorld(),null===pe.parent&&!0===pe.matrixWorldAutoUpdate&&pe.updateMatrixWorld(),Kt.copy(pe.matrixWorldInverse),Ot.multiplyMatrices(pe.projectionMatrix,Kt),An.setFromProjectionMatrix(Ot),I=0,Oe.objects.length=0,Oe.lights.length=0,Hn(W),!0===me&&Oe.objects.sort(ds);const At=Oe.objects;for(let Et=0,St=At.length;Et<St;Et++){const xt=At[Et].object,En=xt.geometry;if(Tn.setObject(xt),Ue=xt.matrixWorld,k=0,xt.isMesh){let jt=xt.material;const Cn=Array.isArray(jt),ln=En.attributes,Un=En.groups;if(void 0===ln.position)continue;const Ci=ln.position.array;for(let Rn=0,si=Ci.length;Rn<si;Rn+=3){let Fn=Ci[Rn],Zt=Ci[Rn+1],tr=Ci[Rn+2];const Ne=En.morphAttributes.position;if(void 0!==Ne){const $=En.morphTargetsRelative,S=xt.morphTargetInfluences;for(let Z=0,Ae=Ne.length;Z<Ae;Z++){const Ce=S[Z];if(0===Ce)continue;const $e=Ne[Z];$?(Fn+=$e.getX(Rn/3)*Ce,Zt+=$e.getY(Rn/3)*Ce,tr+=$e.getZ(Rn/3)*Ce):(Fn+=($e.getX(Rn/3)-Ci[Rn])*Ce,Zt+=($e.getY(Rn/3)-Ci[Rn+1])*Ce,tr+=($e.getZ(Rn/3)-Ci[Rn+2])*Ce)}}Tn.pushVertex(Fn,Zt,tr)}if(void 0!==ln.normal){const Rn=ln.normal.array;for(let si=0,Fn=Rn.length;si<Fn;si+=3)Tn.pushNormal(Rn[si],Rn[si+1],Rn[si+2])}if(void 0!==ln.color){const Rn=ln.color.array;for(let si=0,Fn=Rn.length;si<Fn;si+=3)Tn.pushColor(Rn[si],Rn[si+1],Rn[si+2])}if(void 0!==ln.uv){const Rn=ln.uv.array;for(let si=0,Fn=Rn.length;si<Fn;si+=2)Tn.pushUv(Rn[si],Rn[si+1])}if(null!==En.index){const Rn=En.index.array;if(Un.length>0)for(let si=0;si<Un.length;si++){const Fn=Un[si];if(jt=!0===Cn?xt.material[Fn.materialIndex]:xt.material,void 0!==jt)for(let Zt=Fn.start,tr=Fn.start+Fn.count;Zt<tr;Zt+=3)Tn.pushTriangle(Rn[Zt],Rn[Zt+1],Rn[Zt+2],jt)}else for(let si=0,Fn=Rn.length;si<Fn;si+=3)Tn.pushTriangle(Rn[si],Rn[si+1],Rn[si+2],jt)}else if(Un.length>0)for(let Rn=0;Rn<Un.length;Rn++){const si=Un[Rn];if(jt=!0===Cn?xt.material[si.materialIndex]:xt.material,void 0!==jt)for(let Fn=si.start,Zt=si.start+si.count;Fn<Zt;Fn+=3)Tn.pushTriangle(Fn,Fn+1,Fn+2,jt)}else for(let Rn=0,si=Ci.length/3;Rn<si;Rn+=3)Tn.pushTriangle(Rn,Rn+1,Rn+2,jt)}else if(xt.isLine){It.multiplyMatrices(Ot,Ue);const jt=En.attributes;if(void 0!==jt.position){const Cn=jt.position.array;for(let ln=0,Un=Cn.length;ln<Un;ln+=3)Tn.pushVertex(Cn[ln],Cn[ln+1],Cn[ln+2]);if(void 0!==jt.color){const ln=jt.color.array;for(let Un=0,Ci=ln.length;Un<Ci;Un+=3)Tn.pushColor(ln[Un],ln[Un+1],ln[Un+2])}if(null!==En.index){const ln=En.index.array;for(let Un=0,Ci=ln.length;Un<Ci;Un+=2)Tn.pushLine(ln[Un],ln[Un+1])}else{const ln=xt.isLineSegments?2:1;for(let Un=0,Ci=Cn.length/3-1;Un<Ci;Un+=ln)Tn.pushLine(Un,Un+1)}}}else if(xt.isPoints){It.multiplyMatrices(Ot,Ue);const jt=En.attributes;if(void 0!==jt.position){const Cn=jt.position.array;for(let ln=0,Un=Cn.length;ln<Un;ln+=3)gt.set(Cn[ln],Cn[ln+1],Cn[ln+2],1),gt.applyMatrix4(It),hi(gt,xt,pe)}}else xt.isSprite&&(xt.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,xt.matrixWorld),gt.set(Ue.elements[12],Ue.elements[13],Ue.elements[14],1),gt.applyMatrix4(Ot),hi(gt,xt,pe))}return!0===Fe&&Oe.elements.sort(ds),Oe}}}class te{constructor(){let m,I,A,R,k,J,_e,be,Te,Pe,We,Ze,Ue,dt=0,Q=null,Ke=1;const Oe=this,lt=new ve.UtB,gt=new ve.UtB,ht=new ve.Q1f,st=new ve.Q1f,yt=new ve.Q1f,Kt=new ve.Q1f,Ot=new ve.Q1f,It=new ve.Q1f,An=new ve.Pq0,on=new ve.Pq0,pn=new ve.Pq0,Qt=new ve.dwI,Bn=new ve.kn4,dn=new ve.kn4,yn=[],Tn=new j,Hn=document.createElementNS("http://www.w3.org/2000/svg","svg");function ti(){for(dt=0;Hn.childNodes.length>0;)Hn.removeChild(Hn.childNodes[0])}function hi(me){return null!==Q?me.toFixed(Q):me}function Or(me,Fe,At){let Et=Fe.scale.x*J,St=Fe.scale.y*_e;At.isPointsMaterial&&(Et*=At.size,St*=At.size);const xt="M"+hi(me.x-.5*Et)+","+hi(me.y-.5*St)+"h"+hi(Et)+"v"+hi(St)+"h"+hi(-Et)+"z";let En="";(At.isSpriteMaterial||At.isPointsMaterial)&&(En="fill:"+At.color.getStyle(Oe.outputColorSpace)+";fill-opacity:"+At.opacity),wt(En,xt)}function Tr(me,Fe,At){const Et="M"+hi(me.positionScreen.x)+","+hi(me.positionScreen.y)+"L"+hi(Fe.positionScreen.x)+","+hi(Fe.positionScreen.y);if(At.isLineBasicMaterial){let St="fill:none;stroke:"+At.color.getStyle(Oe.outputColorSpace)+";stroke-opacity:"+At.opacity+";stroke-width:"+At.linewidth+";stroke-linecap:"+At.linecap;At.isLineDashedMaterial&&(St=St+";stroke-dasharray:"+At.dashSize+","+At.gapSize),wt(St,Et)}}function ys(me,Fe,At,Et,St){Oe.info.render.vertices+=3,Oe.info.render.faces++;const xt="M"+hi(me.positionScreen.x)+","+hi(me.positionScreen.y)+"L"+hi(Fe.positionScreen.x)+","+hi(Fe.positionScreen.y)+"L"+hi(At.positionScreen.x)+","+hi(At.positionScreen.y)+"z";let En="";St.isMeshBasicMaterial?(ht.copy(St.color),St.vertexColors&&ht.multiply(Et.color)):St.isMeshLambertMaterial||St.isMeshPhongMaterial||St.isMeshStandardMaterial?(st.copy(St.color),St.vertexColors&&st.multiply(Et.color),ht.copy(yt),on.copy(me.positionWorld).add(Fe.positionWorld).add(At.positionWorld).divideScalar(3),function Xi(me,Fe,At,Et){for(let St=0,xt=me.length;St<xt;St++){const En=me[St],jt=En.color;if(En.isDirectionalLight){const Cn=An.setFromMatrixPosition(En.matrixWorld).normalize();let ln=At.dot(Cn);if(ln<=0)continue;ln*=En.intensity,Et.r+=jt.r*ln,Et.g+=jt.g*ln,Et.b+=jt.b*ln}else if(En.isPointLight){const Cn=An.setFromMatrixPosition(En.matrixWorld);let ln=At.dot(An.subVectors(Cn,Fe).normalize());if(ln<=0||(ln*=0==En.distance?1:1-Math.min(Fe.distanceTo(Cn)/En.distance,1),0==ln))continue;ln*=En.intensity,Et.r+=jt.r*ln,Et.g+=jt.g*ln,Et.b+=jt.b*ln}}}(A,on,Et.normalModel,ht),ht.multiply(st).add(St.emissive)):St.isMeshNormalMaterial&&(pn.copy(Et.normalModel).applyMatrix3(Qt).normalize(),ht.setRGB(pn.x,pn.y,pn.z).multiplyScalar(.5).addScalar(.5)),En=St.wireframe?"fill:none;stroke:"+ht.getStyle(Oe.outputColorSpace)+";stroke-opacity:"+St.opacity+";stroke-width:"+St.wireframeLinewidth+";stroke-linecap:"+St.wireframeLinecap+";stroke-linejoin:"+St.wireframeLinejoin:"fill:"+ht.getStyle(Oe.outputColorSpace)+";fill-opacity:"+St.opacity,wt(En,xt)}function ds(me,Fe,At){let Et=Fe.x-me.x,St=Fe.y-me.y;const xt=Et*Et+St*St;if(0===xt)return;const En=At/Math.sqrt(xt);Et*=En,St*=En,Fe.x+=Et,Fe.y+=St,me.x-=Et,me.y-=St}function wt(me,Fe){Ue===me?Ze+=Fe:(W(),Ue=me,Ze=Fe)}function W(){Ze&&(We=function pe(me){return null==yn[me]&&(yn[me]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==Ke&&yn[me].setAttribute("shape-rendering","crispEdges")),yn[me]}(dt++),We.setAttribute("d",Ze),We.setAttribute("style",Ue),Hn.appendChild(We)),Ze="",Ue=""}this.domElement=Hn,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.outputColorSpace=ve.er$,this.info={render:{vertices:0,faces:0}},this.setQuality=function(me){switch(me){case"high":Ke=1;break;case"low":Ke=0}},this.setClearColor=function(me){It.set(me)},this.setPixelRatio=function(){},this.setSize=function(me,Fe){R=me,k=Fe,J=R/2,_e=k/2,Hn.setAttribute("viewBox",-J+" "+-_e+" "+R+" "+k),Hn.setAttribute("width",R),Hn.setAttribute("height",k),lt.min.set(-J,-_e),lt.max.set(J,_e)},this.getSize=function(){return{width:R,height:k}},this.setPrecision=function(me){Q=me},this.clear=function(){ti(),Hn.style.backgroundColor=It.getStyle(Oe.outputColorSpace)},this.render=function(me,Fe){if(!(Fe instanceof ve.i7d))return void console.error("THREE.SVGRenderer.render: camera is not an instance of Camera.");const At=me.background;At&&At.isColor?(ti(),Hn.style.backgroundColor=At.getStyle(Oe.outputColorSpace)):!0===this.autoClear&&this.clear(),Oe.info.render.vertices=0,Oe.info.render.faces=0,Bn.copy(Fe.matrixWorldInverse),dn.multiplyMatrices(Fe.projectionMatrix,Bn),m=Tn.projectScene(me,Fe,this.sortObjects,this.sortElements),I=m.elements,A=m.lights,Qt.getNormalMatrix(Fe.matrixWorldInverse),function ai(me){yt.setRGB(0,0,0),Kt.setRGB(0,0,0),Ot.setRGB(0,0,0);for(let Fe=0,At=me.length;Fe<At;Fe++){const Et=me[Fe],St=Et.color;Et.isAmbientLight?(yt.r+=St.r,yt.g+=St.g,yt.b+=St.b):Et.isDirectionalLight?(Kt.r+=St.r,Kt.g+=St.g,Kt.b+=St.b):Et.isPointLight&&(Ot.r+=St.r,Ot.g+=St.g,Ot.b+=St.b)}}(A),Ze="",Ue="";for(let Et=0,St=I.length;Et<St;Et++){const xt=I[Et],En=xt.material;if(void 0!==En&&0!==En.opacity)if(gt.makeEmpty(),xt instanceof U)be=xt,be.x*=J,be.y*=-_e,Or(be,xt,En);else if(xt instanceof F)be=xt.v1,Te=xt.v2,be.positionScreen.x*=J,be.positionScreen.y*=-_e,Te.positionScreen.x*=J,Te.positionScreen.y*=-_e,gt.setFromPoints([be.positionScreen,Te.positionScreen]),!0===lt.intersectsBox(gt)&&Tr(be,Te,En);else if(xt instanceof C){if(be=xt.v1,Te=xt.v2,Pe=xt.v3,be.positionScreen.z<-1||be.positionScreen.z>1||Te.positionScreen.z<-1||Te.positionScreen.z>1||Pe.positionScreen.z<-1||Pe.positionScreen.z>1)continue;be.positionScreen.x*=J,be.positionScreen.y*=-_e,Te.positionScreen.x*=J,Te.positionScreen.y*=-_e,Pe.positionScreen.x*=J,Pe.positionScreen.y*=-_e,this.overdraw>0&&(ds(be.positionScreen,Te.positionScreen,this.overdraw),ds(Te.positionScreen,Pe.positionScreen,this.overdraw),ds(Pe.positionScreen,be.positionScreen,this.overdraw)),gt.setFromPoints([be.positionScreen,Te.positionScreen,Pe.positionScreen]),!0===lt.intersectsBox(gt)&&ys(be,Te,Pe,xt,En)}}W(),me.traverseVisible(function(Et){if(Et.isSVGObject){if(An.setFromMatrixPosition(Et.matrixWorld),An.applyMatrix4(dn),An.z<-1||An.z>1)return;const En=Et.node;En.setAttribute("transform","translate("+An.x*J+","+-An.y*_e+")"),Hn.appendChild(En)}})}}}},4779:(Ur,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{TDrawSelector:()=>w,TDrawVariable:()=>D,TSelector:()=>ie,clTBranchFunc:()=>ce,kClonesNode:()=>Xe,kSTLNode:()=>ot,treeDraw:()=>F,treeHierarchy:()=>te,treeIOTest:()=>j,treeProcess:()=>C});var ve=Ee(467),b=Ee(6998),z=Ee(471),ke=Ee(8977);const xe=0,et=1,Je=2,Xe=3,ot=4,Re=31,He=41,Ie=(0,b.BIT)(22),O="TBranchElement",ce="TBranchFunc";class ie{constructor(){this._branches=[],this._names=[],this._directs=[],this._break=0,this.tgtobj={}}addBranch(m,I,A){return I||(I=(0,b.isStr)(m)?m:`br${this._branches.length}`),this._branches.push(m),this._names.push(I),this._directs.push(A),this._branches.length-1}numBranches(){return this._branches.length}getBranch(m){return this._branches[m]}indexOfBranch(m){return this._branches.indexOf(m)}nameOfBranch(m){return this._names[m]}ShowProgress(){}Abort(){this._break=-1111}Begin(){}Process(){}Terminate(){}}function he(N,m){if(!(0,b.isObject)(N))return 0;const I=(0,b.isArrayProto)(Object.prototype.toString.apply(N));if(!m||1!==I)return I;let A,R=!0;for(let k=0;k<N.length;++k){const J=typeof N[k];if(A||(A=J),J!==A){R=!1;break}if((0,b.isObject)(J)&&he(N[k])){R=!1;break}}return R?2:1}class ue{constructor(m,I,A){this.object=m,this.value=0,this.arr=[],this.indx=[],this.cnt=-1,this.tgtobj=A,this.select=(0,b.isObject)(I)?I:[]}next(){let m,I,A=this.cnt;if(A>=0){if(++this.fastindx<this.fastlimit)return this.value=this.fastarr[this.fastindx],!0;for(;--A>=0&&!(void 0===this.select[A]&&++this.indx[A]<this.arr[A].length););if(A<0)return!1}for(;;){if(m=A<0?this.object:this.arr[A][this.indx[A]],I=m?typeof m:"any","object"===I&&(void 0!==m._typename?(0,b.isRootCollection)(m)?(m=m.arr,I="array"):I="any":I=Number.isInteger(m.length)&&he(m)>0?"array":"any"),"$self$"===this.select[A+1])return this.value=m,this.fastindx=this.fastlimit=0,this.cnt=A+1,!0;if("any"===I&&(0,b.isStr)(this.select[A+1]))this.arr[++A]=m,this.indx[A]=this.select[A];else{if("array"!==I||!(m.length>0||"$size$"===this.select[A+1]))return!(A<0||(this.value=m,void 0===this.select[A]?(this.fastarr=this.arr[A],this.fastindx=this.indx[A],this.fastlimit=this.fastarr.length):this.fastindx=this.fastlimit=0,this.cnt=A,0));switch(this.arr[++A]=m,this.select[A]){case void 0:this.indx[A]=0;break;case"$last$":this.indx[A]=m.length-1;break;case"$size$":return this.value=m.length,this.fastindx=this.fastlimit=0,this.cnt=A,!0;default:Number.isInteger(this.select[A])?(this.indx[A]=this.select[A],this.indx[A]<0&&(this.indx[A]=m.length-1)):(this.select[A].produce(this.tgtobj),this.indx[A]=Math.round(this.select[A].get(0)))}}}}reset(){this.arr=[],this.indx=[],delete this.fastarr,this.cnt=-1,this.value=0}}function fe(N,m,I=!1,A=!1){if(!N||N._typename!==O)return"";if(N.fType===xe&&-2===N.fID&&-1===N.fStreamerType)return N.fClassName;if(I&&N.fClonesName&&(N.fType===Xe||N.fType===ot))return N.fClonesName;const R=P(N,m.$file);if(N.fType===et&&R&&"BASE"===R.fTypeName)return R.fName;if(N.fType===Je)return!R||R.fType!==z.Ph&&R.fType!==z.w1?b.clTObject:R.fTypeName;if(N.fType===xe&&R&&A){if(R.fType===z.Ph||R.fType===z.w1)return R.fTypeName;if(R.fType===z.FF)return R.fTypeName.slice(0,R.fTypeName.length-1)}return""}function Y(N,m,I=void 0,A=!1){let R=!1,k=m,J=null;if(!I){R=!0,I=N.fBranches;const _e=k.indexOf("[");_e>0&&(k=k.slice(0,_e))}if(!I||0===I.arr.length)return null;for(let _e=0;_e<I.arr.length;++_e){let be=I.arr[_e].fName;if("]"===be[be.length-1]&&(be=be.slice(0,be.indexOf("["))),0!==k.indexOf(be)&&be.indexOf("<")>0){const Pe=be.indexOf("<"),We=be.lastIndexOf(">");be=be.slice(0,Pe)+be.slice(We+1)}if(be===k){J={branch:I.arr[_e],rest:""};break}if(0!==k.indexOf(be))continue;let Te=be.length;if("."===be[Te-1]&&Te--,"."===k[Te]){J=Y(N,k,I.arr[_e].fBranches),J||(J=Y(N,k.slice(Te+1),I.arr[_e].fBranches)),J||(J={branch:I.arr[_e],rest:k.slice(Te)});break}}if(R&&!A&&!J&&0===k.indexOf("br_")){let _e=3;for(;_e<k.length&&k[_e]>="0"&&k[_e]<="9";)++_e;const be=_e>3?function le(N,m){if(!Number.isInteger(m))return;let I,A=0;return function R(k){k?.fBranches?.arr.forEach(J=>{A++===m&&(I=J),I||R(J)})}(N),I}(N,parseInt(k.slice(3,_e))):null;be&&(J={branch:be,rest:k.slice(_e)})}return!R||!J||m.length>k.length&&(J.rest+=m.slice(k.length)),J}function V(N,m){const I=Y(N,m,N.fBranches,!0);return!I||I.rest?null:I.branch}class D{constructor(m){this.globals=m,this.code="",this.brindex=[],this.branches=[],this.brarray=[],this.func=null,this.kind=void 0,this.buf=[]}parse(m,I,A,R,k){const J=We=>We>="A"&&We<="Z"||We>="a"&&We<="z"||"_"===We,_e=We=>!!(J(We)||We>="0"&&We<="9");A||(A=""),this.code=(R?.fName??"")+A;let be=0,Te=0,Pe=null;for(;be<A.length||R;){let We=[];if(R)Pe=R,R=void 0;else{for(Te=be;Te<A.length&&(_e(A[Te])||"."===A[Te]);)Te++;if("$"===A[Te]){let Ke="";switch(A.slice(be,Te)){case"LocalEntry":case"Entry":Ke="arg.$globals.entry";break;case"Entries":Ke="arg.$globals.entries"}if(Ke){A=A.slice(0,be)+Ke+A.slice(Te+1),be+=Ke.length;continue}}if(Pe=Y(m,A.slice(be,Te)),!Pe){be=Te+1;continue}Pe.branch&&void 0!==Pe.rest&&(Te-=Pe.rest.length,k=void 0,Pe=Pe.branch),Te>=A.length-1&&"."===A[A.length-1]&&(We.push("$self$"),Te=A.length)}for(;Te<A.length;){if("@"===A[Te]&&"@size"===A.slice(Te,Te+5)&&0===We.length){Te+=5,k=!0;break}if("."===A[Te]){const Oe=++Te;if("@"===A[Oe]&&"@size"===A.slice(Oe,Oe+5)){We.push("$size$"),Te+=5;break}if(!J(A[Oe])){We.push("$self$");break}for(;Te<A.length&&_e(A[Te]);)Te++;if("("===A[Te]){Te=Oe-1;break}if(0===We.length)if(Pe.fType===Xe||Pe.fType===ot)We.push(void 0);else{const lt=fe(Pe,m,!1,!0);lt&&(0,b.isRootCollection)(null,lt)&&We.push(void 0)}We.push(A.slice(Oe,Te));continue}if("["!==A[Te])break;if("]"===A[Te+1]){We.push(void 0),Te+=2;continue}const Ke=Te++;let Ze=0;for(;Te<A.length&&("]"!==A[Te]||Ze>0);)"["===A[Te]?Ze++:"]"===A[Te]&&Ze--,Te++;const Ue=A.slice(Ke+1,Te);switch(Ue){case"":case"$all$":We.push(void 0);break;case"$last$":We.push("$last$");break;case"$size$":We.push("$size$");break;case"$first$":We.push(0);break;default:if(Number.isInteger(parseInt(Ue)))We.push(parseInt(Ue));else{const Oe=new D(this.globals);if(!Oe.parse(m,I,Ue))return!1;We.push(Oe)}}Te++}0===We.length?We=void 0:1===We.length&&void 0===We[0]&&(We=!0);let dt=I.indexOfBranch(Pe);if(dt<0&&(dt=I.addBranch(Pe,void 0,k)),k=void 0,this.brindex.push(dt),this.branches.push(I.nameOfBranch(dt)),this.brarray.push(We),0===be&&Te===A.length&&1===this.branches.length)return this.direct_branch=!0,!0;const Q="arg.var"+(this.branches.length-1);A=A.slice(0,be)+Q+A.slice(Te),be+=Q.length}return A=A.replace(/TMath::Exp\(/g,"Math.exp(").replace(/TMath::Abs\(/g,"Math.abs(").replace(/TMath::Prob\(/g,"arg.$math.Prob(").replace(/TMath::Gaus\(/g,"arg.$math.Gaus("),this.func=new Function("arg",`return (${A})`),!0}is_dummy(){return 0===this.branches.length&&!this.func}produce(m){if(this.length=1,this.isarray=!1,this.is_dummy())return this.value=1,void(this.kind="number");const I={$globals:this.globals,$math:ke},A=[];let R=-1;for(let k=0;k<this.branches.length;++k){const J=`var${k}`;if(I[J]=m[this.branches[k]],void 0===this.brarray[k]&&(this.brarray[k]=he(I[J])>0||(0,b.isRootCollection)(I[J])),!1!==this.brarray[k]){if(!0===this.brarray[k]&&2===he(I[J],!0))A[k]=I[J];else{const _e=new ue(I[J],this.brarray[k],m);for(A[k]=[];_e.next();)A[k].push(_e.value)}(R<0||R<A[k].length)&&(R=A[k].length)}}if(R<0)return this.value=this.direct_branch?I.var0:this.func(I),void(this.kind||(this.kind=typeof this.value));if(0===R)return this.length=0,void(this.value=0);if(this.length=R,this.isarray=!0,this.direct_branch)this.value=A[0];else{this.value=new Array(R);for(let k=0;k<R;++k){for(let J=0;J<this.branches.length;++J)A[J]&&(I[`var${J}`]=A[J][k]);this.value[k]=this.func(I)}}this.kind||(this.kind=typeof this.value[0])}get(m){return this.isarray?this.value[m]:this.value}appendArray(m){this.buf=this.buf.concat(m[this.branches[0]])}}class w extends ie{constructor(){super(),this.ndim=0,this.vars=[],this.cut=null,this.hist=null,this.histo_drawopt="",this.hist_name="$htemp",this.hist_title="Result of TTree::Draw",this.graph=!1,this.hist_args=[],this.arr_limit=1e3,this.htype="F",this.monitoring=0,this.globals={},this.last_progress=0,this.aver_diff=0}setCallback(m,I){this.result_callback=m,this.progress_callback=I}parseParameters(m,I,A){if(!A||!(0,b.isStr)(A))return"";let R=A.lastIndexOf(";");for(;R>=0;){let J,k=A.slice(R+1);R=(A=A.slice(0,R)).lastIndexOf(";");const _e=k.indexOf(":");_e>0&&(J=k.slice(_e+1),k=k.slice(0,_e));let be=parseInt(J);switch((!J||!Number.isInteger(be))&&(be=void 0),k){case"num":case"entries":case"numentries":"all"===J?I.numentries=m.fEntries:"half"===J?I.numentries=Math.round(m.fEntries/2):void 0!==be&&(I.numentries=be);break;case"first":void 0!==be&&(I.firstentry=be);break;case"mon":case"monitor":I.monitoring=void 0!==be?be:5e3;break;case"player":I.player=!0;break;case"dump":I.dump=!0;break;case"maxseg":case"maxrange":be&&(m.$file.fMaxRanges=be);break;case"accum":be&&(this.arr_limit=be);break;case"htype":J&&1===J.length&&(this.htype=J.toUpperCase(),["C","S","I","F","L","D"].indexOf(this.htype)<0&&(this.htype="F"));break;case"hbins":this.hist_nbins=parseInt(J),!Number.isInteger(this.hist_nbins)||this.hist_nbins<=3?delete this.hist_nbins:this.want_hist=!0;break;case"drawopt":I.drawopt=J;break;case"graph":I.graph=be||!0}}if(R=A.lastIndexOf(">>"),R>=0){let k=A.slice(R+2).trim();if(A=A.slice(0,R).trim(),R=k.indexOf("("),R>0&&(this.hist_name=k.slice(0,R),k=k.slice(R)),"dump"===k)I.dump=!0;else if(0===k.indexOf("Graph"))I.graph=!0;else if(R<0)this.want_hist=!0,this.hist_name=k;else if("("===k[0]&&")"===k[k.length-1]){this.want_hist=!0,k=k.slice(1,k.length-1).split(",");let J=!0;for(let _e=0;_e<k.length;++_e)k[_e]=_e%3==0?parseInt(k[_e]):parseFloat(k[_e]),Number.isFinite(k[_e])||(J=!1);J&&(this.hist_args=k)}}return I.dump&&(this.dump_values=!0,I.reallocate_objects=!0,void 0===I.numentries&&(I.numentries=10)),A}parseDrawExpression(m,I){let A=this.parseParameters(m,I,I.expr),R="";this.hist_title=`drawing '${A}' from ${m.fName}`;let k=0;I.cut?R=I.cut:(k=A.replace(/TMath::/g,"TMath__").lastIndexOf("::"),k>0&&(R=A.slice(k+2).trim(),A=A.slice(0,k).trim())),I.parse_expr=A,I.parse_cut=R;const J=[];let _e=0,be=0,Te=0;for(k=0;k<A.length;++k)switch(A[k]){case"(":_e++;break;case")":_e--;break;case"[":be++;break;case"]":be--;break;case":":if(":"===A[k+1]){k++;continue}!_e&&!be&&k>Te&&J.push(A.slice(Te,k)),Te=k+1}if(!_e&&!be&&k>Te&&J.push(A.slice(Te,k)),J.length<1||J.length>3)return!1;this.ndim=J.length;let Pe=!R;for(let We=0;We<this.ndim;++We){if(this.vars[We]=new D(this.globals),!this.vars[We].parse(m,this,J[We]))return!1;this.vars[We].direct_branch||(Pe=!1)}return this.cut=new D(this.globals),!(R&&!this.cut.parse(m,this,R)||(this.numBranches()?(Pe&&(this.ProcessArrays=this.ProcessArraysFunc),this.monitoring=I.monitoring,3===this.ndim&&!this.want_hist&&!I.dump&&(I.graph=!0),this.graph=I.graph,this.histo_drawopt=void 0!==I.drawopt?I.drawopt:2===this.ndim?"col":"",0):(console.warn("no any branch is selected"),1)))}drawOnlyBranch(m,I,A,R){return this.ndim=1,0===A.indexOf("dump")&&(A=";"+A),A=this.parseParameters(m,R,A),this.monitoring=R.monitoring,R.dump&&(this.dump_values=!0,R.reallocate_objects=!0),this.dump_values?(this.hist=[],this.leaf=R.leaf,this.copy_fields=(R.branch.fLeaves&&R.branch.fLeaves.arr.length>1||R.branch.fBranches&&R.branch.fBranches.arr.length>0)&&!R.leaf,this.addBranch(I,"br0",R.direct_branch),this.Process=this.ProcessDump,!0):(this.vars[0]=new D(this.globals),!!this.vars[0].parse(m,this,A,I,R.direct_branch)&&(this.hist_title=`drawing branch ${I.fName} ${A?" expr:"+A:""} from ${m.fName}`,this.cut=new D(this.globals),this.vars[0].direct_branch&&(this.ProcessArrays=this.ProcessArraysFunc),!0))}Begin(m){this.globals.entries=m.fEntries,this.monitoring&&(this.lasttm=(new Date).getTime())}ShowProgress(){}getBitsBins(m,I){I.nbins=I.max=m,I.fLabels=(0,b.create)(b.clTHashList);for(let A=0;A<m;++A){const R=(0,b.create)(b.clTObjString);R.fString=A.toString(),R.fUniqueID=A+1,I.fLabels.Add(R)}return I}getMinMaxBins(m,I){const A={min:0,max:0,nbins:I,k:1,fLabels:null,title:""};if(m>=this.ndim)return A;const R=this.vars[m].buf;if(A.title=this.vars[m].code||"","object"===this.vars[m].kind){let k,J=!0,_e=8;for(let be=0;be<R.length;++be)R[be]&&(k||(k=R[be]._typename),k!==R[be]._typename&&(J=!1),R[be].fNbits&&(_e=Math.max(_e,R[be].fNbits+1)));if(k&&J&&"TBits"===k&&0===m)return this.fill1DHistogram=this.fillTBitsHistogram,_e%8&&(_e=8+(65520&_e)),"bits"===this.hist_name&&1===this.hist_args.length&&this.hist_args[0]&&(_e=this.hist_args[0]),this.getBitsBins(_e,A)}if("string"===this.vars[m].kind){A.lbls=[];for(let k=0;k<R.length;++k)A.lbls.indexOf(R[k])<0&&A.lbls.push(R[k]);A.lbls.sort(),A.max=A.nbins=A.lbls.length,A.fLabels=(0,b.create)(b.clTHashList);for(let k=0;k<A.lbls.length;++k){const J=(0,b.create)(b.clTObjString);J.fString=A.lbls[k],J.fUniqueID=k+1,""===J.fString&&(J.fString="<empty>"),A.fLabels.Add(J)}}else{if(0===m&&"bits"===this.hist_name&&this.hist_args.length<=1)return this.fill1DHistogram=this.FillBitsHistogram,this.getBitsBins(this.hist_args[0]||32,A);if(3*m+2<this.hist_args.length)A.nbins=this.hist_args[3*m],A.min=this.hist_args[3*m+1],A.max=this.hist_args[3*m+2];else{let k=!1;for(let J=1;J<R.length;++J){const _e=R[J];Number.isFinite(_e)&&(k?(A.min=Math.min(A.min,_e),A.max=Math.max(A.max,_e)):(A.min=A.max=_e,k=!0))}if(k||(A.min=0,A.max=1),this.hist_nbins&&(I=A.nbins=this.hist_nbins),A.isinteger=Math.round(A.min)===A.min&&Math.round(A.max)===A.max,A.isinteger)for(let J=0;J<R.length;++J)if(R[J]!==Math.round(R[J])){A.isinteger=!1;break}if(A.isinteger)if(A.min=Math.round(A.min),A.max=Math.round(A.max),A.max-A.min<5*I)A.min-=1,A.max+=2,A.nbins=Math.round(A.max-A.min);else{const J=A.max-A.min+2;let _e=Math.floor(J/I);for(;_e*I<J;)_e++;A.max=A.min+I*_e}else A.min>=A.max?(A.max=A.min,Math.abs(A.min)<100?(A.min-=1,A.max+=1):A.min>0?(A.min*=.9,A.max*=1.1):(A.min*=1.1,A.max*=.9)):A.max+=(A.max-A.min)/A.nbins}}return A.k=A.nbins/(A.max-A.min),A.GetBin=function(k){const J=this.lbls?.indexOf(k)??Number.isFinite(k)?Math.floor((k-this.min)*this.k):this.nbins+1;return J<0?0:J>this.nbins?this.nbins+1:J+1},A}createHistogram(m,I=!1){m||(m=20);const A=this.getMinMaxBins(0,m),R=this.getMinMaxBins(1,m),k=this.getMinMaxBins(2,m);let J=null;switch(this.ndim){case 1:J=(0,b.createHistogram)(b.clTH1+this.htype,A.nbins);break;case 2:J=(0,b.createHistogram)(b.clTH2+this.htype,A.nbins,R.nbins);break;case 3:J=(0,b.createHistogram)(b.clTH3+this.htype,A.nbins,R.nbins,k.nbins)}return J.fXaxis.fTitle=A.title,J.fXaxis.fXmin=A.min,J.fXaxis.fXmax=A.max,J.fXaxis.fLabels=A.fLabels,this.ndim>1&&(J.fYaxis.fTitle=R.title),J.fYaxis.fXmin=R.min,J.fYaxis.fXmax=R.max,J.fYaxis.fLabels=R.fLabels,this.ndim>2&&(J.fZaxis.fTitle=k.title),J.fZaxis.fXmin=k.min,J.fZaxis.fXmax=k.max,J.fZaxis.fLabels=k.fLabels,J.fName=this.hist_name,J.fTitle=this.hist_title,J.fOption=this.histo_drawopt,J.$custom_stat="$htemp"===this.hist_name?111110:111111,I?(this.hist=J,this.x=A,this.y=R,this.z=k):J.fBits=J.fBits|b.kNoStats,J}createOutputObject(){if(this.hist||!this.vars[0].buf)return;if(this.dump_values)this.hist=[],this.fill1DHistogram=this.fill2DHistogram=this.fill3DHistogram=this.dumpValues;else if(this.graph){const R=this.vars[0].buf.length;let k=null;if(1===this.ndim)k=(0,b.createTGraph)(R,Array.from(Array(R).keys()),this.vars[0].buf),k.fName="Graph",k.fTitle=this.hist_title;else if(2===this.ndim)k=(0,b.createTGraph)(R,this.vars[0].buf,this.vars[1].buf),k.fName="Graph",k.fTitle=this.hist_title,delete this.vars[1].buf;else if(3===this.ndim){k=(0,b.create)(b.clTPolyMarker3D),k.fN=R,k.fLastPoint=R-1;const J=new Array(3*R);for(let _e=0;_e<R;++_e)J[3*_e]=this.vars[0].buf[_e],J[3*_e+1]=this.vars[1].buf[_e],J[3*_e+2]=this.vars[2].buf[_e];k.fP=J,k.$hist=this.createHistogram(10),delete this.vars[1].buf,delete this.vars[2].buf,k.fName="Points"}this.hist=k}else this.createHistogram([200,50,20][this.ndim],!0);const m=this.vars[0].buf,I=this.cut.buf,A=m.length;if(!this.graph)switch(this.ndim){case 1:for(let R=0;R<A;++R)this.fill1DHistogram(m[R],I?I[R]:1);break;case 2:{const R=this.vars[1].buf;for(let k=0;k<A;++k)this.fill2DHistogram(m[k],R[k],I?I[k]:1);delete this.vars[1].buf;break}case 3:{const R=this.vars[1].buf,k=this.vars[2].buf;for(let J=0;J<A;++J)this.fill3DHistogram(m[J],R[J],k[J],I?I[J]:1);delete this.vars[1].buf,delete this.vars[2].buf;break}}delete this.vars[0].buf,delete this.cut.buf}fillTBitsHistogram(m,I){if(!(I&&m&&m.fNbits&&m.fAllBits))return;const A=Math.min(m.fNbits+1,8*m.fNbytes);for(let R=0,k=1,J=0;R<A;++R)m.fAllBits[J]&&k&&(R<=this.x.nbins?this.hist.fArray[R+1]+=I:this.hist.fArray[this.x.nbins+1]+=I),k*=2,k>=256&&(k=1,++J)}FillBitsHistogram(m,I){if(I)for(let A=0,R=1;A<this.x.nbins;++A)m&R&&(this.hist.fArray[A+1]+=I),R*=2}fill1DHistogram(m,I){const A=this.x.GetBin(m);this.hist.fArray[A]+=I,!this.x.lbls&&Number.isFinite(m)&&(this.hist.fTsumw+=I,this.hist.fTsumwx+=I*m,this.hist.fTsumwx2+=I*m*m)}fill2DHistogram(m,I,A){const R=this.x.GetBin(m),k=this.y.GetBin(I);this.hist.fArray[R+(this.x.nbins+2)*k]+=A,!this.x.lbls&&!this.y.lbls&&Number.isFinite(m)&&Number.isFinite(I)&&(this.hist.fTsumw+=A,this.hist.fTsumwx+=A*m,this.hist.fTsumwy+=A*I,this.hist.fTsumwx2+=A*m*m,this.hist.fTsumwxy+=A*m*I,this.hist.fTsumwy2+=A*I*I)}fill3DHistogram(m,I,A,R){const k=this.x.GetBin(m),J=this.y.GetBin(I),_e=this.z.GetBin(A);this.hist.fArray[k+(this.x.nbins+2)*(J+(this.y.nbins+2)*_e)]+=R,!this.x.lbls&&!this.y.lbls&&!this.z.lbls&&Number.isFinite(m)&&Number.isFinite(I)&&Number.isFinite(A)&&(this.hist.fTsumw+=R,this.hist.fTsumwx+=R*m,this.hist.fTsumwy+=R*I,this.hist.fTsumwz+=R*A,this.hist.fTsumwx2+=R*m*m,this.hist.fTsumwy2+=R*I*I,this.hist.fTsumwz2+=R*A*A,this.hist.fTsumwxy+=R*m*I,this.hist.fTsumwxz+=R*m*A,this.hist.fTsumwyz+=R*I*A)}dumpValues(m,I,A,R){let k;switch(this.ndim){case 1:k={x:m,weight:I};break;case 2:k={x:m,y:I,weight:A};break;case 3:k={x:m,y:I,z:A,weight:R}}this.cut.is_dummy()&&(1===this.ndim?k=m:delete k.weight),this.hist.push(k)}ProcessArraysFunc(){if(this.arr_limit||this.graph){const m=this.vars[0],I=this.vars[1],A=this.vars[2],R=this.tgtarr.br0.length;if(0===m.buf.length&&R>=this.arr_limit&&!this.graph)m.buf=this.tgtarr.br0,I&&(I.buf=this.tgtarr.br1),A&&(A.buf=this.tgtarr.br2);else for(let k=0;k<R;++k)m.buf.push(this.tgtarr.br0[k]),I&&I.buf.push(this.tgtarr.br1[k]),A&&A.buf.push(this.tgtarr.br2[k]);m.kind="number",I&&(I.kind="number"),A&&(A.kind="number"),this.cut.buf=null,!this.graph&&m.buf.length>=this.arr_limit&&(this.createOutputObject(),this.arr_limit=0)}else{const m=this.tgtarr.br0,I=m.length;switch(this.ndim){case 1:for(let A=0;A<I;++A)this.fill1DHistogram(m[A],1);break;case 2:{const A=this.tgtarr.br1;for(let R=0;R<I;++R)this.fill2DHistogram(m[R],A[R],1);break}case 3:{const A=this.tgtarr.br1,R=this.tgtarr.br2;for(let k=0;k<I;++k)this.fill3DHistogram(m[k],A[k],R[k],1);break}}}}ProcessDump(){const m=this.leaf?this.tgtobj.br0[this.leaf]:this.tgtobj.br0;m&&this.copy_fields&&0===he(m)?this.hist.push(Object.assign({},m)):this.hist.push(m)}Process(m){if(this.globals.entry=m,this.cut.produce(this.tgtobj),!this.dump_values&&!this.cut.value)return;for(let J=0;J<this.ndim;++J)this.vars[J].produce(this.tgtobj);const I=this.vars[0],A=this.vars[1],R=this.vars[2],k=this.cut;if(this.graph||this.arr_limit){switch(this.ndim){case 1:for(let J=0;J<I.length;++J)I.buf.push(I.get(J)),k.buf?.push(k.value);break;case 2:for(let J=0;J<I.length;++J)for(let _e=0;_e<A.length;++_e)I.buf.push(I.get(J)),A.buf.push(A.get(_e)),k.buf?.push(k.value);break;case 3:for(let J=0;J<I.length;++J)for(let _e=0;_e<A.length;++_e)for(let be=0;be<R.length;++be)I.buf.push(I.get(J)),A.buf.push(A.get(_e)),R.buf.push(R.get(be)),k.buf?.push(k.value)}!this.graph&&I.buf.length>=this.arr_limit&&(this.createOutputObject(),this.arr_limit=0)}else if(this.hist)switch(this.ndim){case 1:for(let J=0;J<I.length;++J)this.fill1DHistogram(I.get(J),k.value);break;case 2:for(let J=0;J<I.length;++J)for(let _e=0;_e<A.length;++_e)this.fill2DHistogram(I.get(J),A.get(_e),k.value);break;case 3:for(let J=0;J<I.length;++J)for(let _e=0;_e<A.length;++_e)for(let be=0;be<R.length;++be)this.fill3DHistogram(I.get(J),A.get(_e),R.get(be),k.value)}if(this.monitoring&&this.hist&&!this.dump_values){const J=(new Date).getTime();J-this.lasttm>this.monitoring&&(this.lasttm=J,(0,b.isFunc)(this.progress_callback)&&this.progress_callback(this.hist))}}Terminate(m){m&&!this.hist&&this.createOutputObject(),this.ShowProgress(),(0,b.isFunc)(this.result_callback)&&this.result_callback(this.hist)}}function P(N,m){if(!N||!m||N._typename!==O||N.fID<0||N.fStreamerType<0)return null;const I=m.findStreamerInfo(N.fClassName,N.fClassVersion,N.fCheckSum),A=I&&I.fElements?I.fElements.arr:null;if(!A)return null;let R=N.fName,k=R.indexOf("[");function J(_e){return!(!_e||_e.fName!==R||_e.fType!==N.fStreamerType&&(_e.fType!==z.Qu||N.fStreamerType!==z.h0)&&(N.fStreamerType!==z.$o&&N.fStreamerType!==z.$o+z.bm&&N.fStreamerType!==z.v5&&N.fStreamerType!==z.v5+z.bm||_e.fType!==z.N8)&&(console.warn(`Should match element ${_e.fType} with branch ${N.fStreamerType}`),1))}if(k>0&&(R=R.slice(0,k)),k=R.lastIndexOf("."),k>0&&(R=R.slice(k+1)),J(A[N.fID]))return A[N.fID];for(let _e=0;_e<A.length;++_e)if(_e!==N.fID&&J(A[_e]))return A[_e];return console.error(`Did not found/match element for branch ${N.fName} class ${N.fClassName}`),null}function x(N,m,I){const A=N.findStreamerInfo(m),R=A?.fElements?.arr;if(!R)return"";let k=null;for(let _e=0;_e<R.length;++_e)if("BASE"===R[_e].fTypeName){const be=x(N,R[_e].fName,I);if(be)return be}else if(R[_e].fName===I){k=R[_e];break}if(!k)return"";let J=k.fTypeName;return"*"===J[J.length-1]&&(J=J.slice(0,J.length-1)),J}function v(N){const m=(0,b.getMethods)(N),I={names:[],values:[],Create(){const A={};for(let R=0;R<this.names.length;++R)A[this.names[R]]=this.values[R];return A}};I.names.push("_typename"),I.values.push(N);for(const A in m)I.names.push(A),I.values.push(m[A]);return I}function _(N,m,I){let A="";for(let R=I||0;R<N.arr.length;++R)0===N.arr[R].fName.indexOf(m)&&N.arr[R].fClassName&&(A=N.arr[R].fClassName);return A}function C(N,m,I){return L.apply(this,arguments)}function L(){return(L=(0,ve.A)(function*(N,m,I){if(I||(I={}),!m||!N.$file||!m.numBranches())return m?.Terminate(!1),Promise.reject(Error("required parameter missing for TTree::Process"));const A={tree:N,file:N.$file,selector:m,arr:[],curr:-1,current_entry:-1,simple_read:!0,process_arrays:!0},R=(Q,Ke)=>{let Ze=0;switch(Q._typename){case"TLeafF":Ze=z.k1;break;case"TLeafD":Ze=z.Hg;break;case"TLeafO":Ze=z.Qu;break;case"TLeafB":Ze=Q.fIsUnsigned?z.h0:z.yd;break;case"TLeafS":Ze=Q.fIsUnsigned?z.bP:z.aM;break;case"TLeafI":Ze=Q.fIsUnsigned?z.c4:z.nc;break;case"TLeafL":Ze=Q.fIsUnsigned?z.NE:z.s4;break;case"TLeafC":Ze=z.V$;break;default:return null}const Ue=(0,z._T)(Ke||Q.fName,Ze);return Q.fLen>1&&(Ue.fType+=z.bm,Ue.fArrayLength=Q.fLen),Ue},k=Q=>{for(let Ke=0;Ke<A.arr.length;++Ke)if(A.arr[Ke].branch===Q)return A.arr[Ke];return null};let be,Te,J=0;function _e(Q,Ke,Ze,Ue){if((0,b.isStr)(Q)&&(Q=V(A.tree,Q)),!Q)return console.error("Did not found branch"),null;let Oe=k(Q);if(Oe)return console.error(`Branch ${Q.fName} already configured for reading`),Oe.tgt!==Ke&&console.error("Target object differs"),null;if(!Q.fEntries)return console.warn(`Branch ${Q.fName} does not have entries`),null;for(Oe={branch:Q,tgt:Ke,name:Ze,index:-1,member:null,type:0,curr_entry:-1,raw:null,basket:null,curr_basket:0,read_entry:-1,staged_entry:-1,first_readentry:-1,staged_basket:0,numentries:Q.fEntries,numbaskets:Q.fWriteBasket,counters:null,ascounter:[],baskets:[],staged_prev:0,staged_now:0,progress_showtm:0,getBasketEntry(pn){if(!this.branch||pn>this.branch.fMaxBaskets)return 0;const Qt=pn<this.branch.fMaxBaskets?this.branch.fBasketEntry[pn]:0;if(Qt)return Qt;const Bn=pn>0?this.branch.fBaskets.arr[pn-1]:null;return Bn?this.branch.fBasketEntry[pn-1]+Bn.fNevBuf:0},getTarget(pn){if(!this.tgt)return pn;for(let Qt=0;Qt<this.tgt.length;++Qt){const Bn=this.tgt[Qt];pn[Bn.name]||(pn[Bn.name]=Bn.lst.Create()),pn=pn[Bn.name]}return pn},getEntry(pn){const Qt=pn-this.first_entry;let Bn;this.branch.TestBit(Ie)||this.raw.clearObjectMap(),this.basket.fEntryOffset?(Bn=this.basket.fEntryOffset[Qt],this.basket.fDisplacement&&(this.raw.fDisplacement=this.basket.fDisplacement[Qt])):Bn=this.basket.fKeylen+this.basket.fNevBufSize*Qt,this.raw.locate(Bn-this.raw.raw_shift)}};Oe.getBasketEntry(Oe.numbaskets+1);)Oe.numbaskets++;const lt=Q.fLeaves?.arr?.length??0,gt=lt>0?Q.fLeaves.arr[0]:null,ht=Q._typename===O;let st=null,yt=null,Kt=0,Ot=null,It=null,An="";if(Q.fBranchCount){if(Ot=k(Q.fBranchCount),Ot||(Ot=_e(Q.fBranchCount,Ke,"$counter"+J++,!0)),!Ot)return console.error(`Cannot add counter branch ${Q.fBranchCount.fName}`),null;let pn=Q.fBranchCount2;if(!pn&&Q.fBranchCount.fStreamerType===z.$o&&(Q.fStreamerType===z.mU||Q.fStreamerType===z.bm+z.mU)){const Qt=P(Q,A.file),Bn=Q.fBranchCount.fBranches.arr;if(Qt?.fCountName&&Bn)for(let dn=0;dn<Bn.length;++dn)if(Bn[dn].fName===Q.fBranchCount.fName+"."+Qt.fCountName){pn=Bn[dn];break}pn||console.error("Did not found branch for second counter of kStreamLoop element")}if(pn&&(It=k(pn),It||(It=_e(pn,Ke,"$counter"+J++,!0)),!It))return console.error(`Cannot add counter branch2 ${pn.fName}`),null}else if(1===lt&&gt&&gt.fLeafCount){const pn=V(A.tree,gt.fLeafCount.fName);if(pn&&(Ot=k(pn),Ot||(Ot=_e(pn,Ke,"$counter"+J++,!0)),!Ot))return console.error(`Cannot add counter branch ${pn.fName}`),null}function on(pn,Qt,Bn){if(!pn||!pn.arr.length)return!0;let dn=Q.fName;"."===dn[dn.length-1]&&(dn=dn.slice(0,dn.length-1)),(0,b.isStr)(Ue)&&"."===Ue[0]&&(dn+=Ue),dn+=".";for(let yn=0;yn<pn.arr.length;++yn){const Tn=pn.arr[yn];if(Bn>0&&Tn.fType!==Bn)continue;if(Tn.fType===et){if(!on(Tn.fBranches,Qt,Bn))return!1;continue}if("BASE"===P(Tn,A.file)?.fTypeName){if(Tn.fTotBytes&&!_e(Tn,Ke,Ze,Ue)||!on(Tn.fBranches,Qt,Bn))return!1;continue}let ti=Tn.fName,hi=1;if(0===Tn.fName.indexOf(dn))ti=ti.slice(dn.length);else if(Bn>0)continue;let ai=ti.indexOf("[");if(ai>0&&(ti=ti.slice(0,ai)),ai=ti.indexOf("<"),ai>0&&(ti=ti.slice(0,ai)),Bn>0){hi="$child$";const Xi=ti.indexOf(".");Xi>0&&(hi=_(pn,Q.fName+"."+ti.slice(0,Xi+1),yn)||b.clTObject)}if(!_e(Tn,Qt,ti,hi))return!1}return!0}if("TBranchObject"===Q._typename)yt={name:Ze,typename:Q.fClassName,virtual:gt.fVirtual,func(pn,Qt){let Bn=this.typename;this.virtual&&(Bn=pn.readFastString(pn.ntou1()+1)),Qt[this.name]=pn.classStreamer({},Bn)}};else if(Q.fType===Xe||Q.fType===ot){if(st=(0,z._T)(Ze,z.nc),!Ue||(0,b.isStr)(Ue)&&"."===Ue[0]||1===Ue){if(A.process_arrays=!1,yt={name:Ze,conttype:Q.fClonesName||b.clTObject,reallocate:I.reallocate_objects,func(pn,Qt){const Bn=pn.ntoi4();let dn=0,yn=Qt[this.name];for(!yn||this.reallocate?yn=Qt[this.name]=new Array(Bn):(dn=yn.length,yn.length=Bn);dn<Bn;)yn[dn++]=this.methods.Create()}},(0,b.isStr)(Ue)&&"."===Ue[0]&&(yt.conttype=_(Q.fBranches,Q.fName+Ue),!yt.conttype))return console.error(`Cannot select object ${Ue} in the branch ${Q.fName}`),null;yt.methods=v(yt.conttype),Kt=Q.fType===Xe?Re:He}}else{if(An=fe(Q,A.tree)){if(!0===Ue)return console.warn(`Object branch ${An} can not have data to be read directly`),null;A.process_arrays=!1;const pn=new Array(Ke?Ke.length+1:1);for(let Qt=0;Qt<pn.length-1;++Qt)pn[Qt]=Ke[Qt];return pn[pn.length-1]={name:Ze,lst:v(An)},on(Q.fBranches,pn,0)?Oe:null}if(ht&&1===lt&&gt.fName===Q.fName&&-1===Q.fID){if(st=(0,z._T)(Ze,Q.fClassName),st.fType===z.w1){const pn=A.file.getStreamer(Q.fClassName,{val:Q.fClassVersion,checksum:Q.fCheckSum});pn?yt={name:Ze,typename:Q.fClassName,streamer:pn,func(Qt,Bn){const dn={_typename:this.typename};for(let yn=0;yn<this.streamer.length;++yn)this.streamer[yn].func(Qt,dn);Bn[this.name]=dn}}:(st=null,console.warn("not found streamer!"))}}else if(ht&&lt<=1)st=P(Q,A.file),!st&&Q.fStreamerType&&Q.fStreamerType<20&&(st=(0,z._T)(Ze,Q.fStreamerType));else if(1===lt)st=R(gt,Ze);else if("TBranch"===Q._typename&&lt>1){const pn=new Array(lt);let Qt=!0;for(let Bn=0;Bn<lt;++Bn)pn[Bn]=(0,z.Mx)(R(Q.fLeaves.arr[Bn]),A.file),pn[Bn]||(Qt=!1);Qt&&(yt={name:Ze,leaves:pn,func(Bn,dn){let yn=dn[this.name],Tn=0;for(yn||(dn[this.name]=yn={});Tn<this.leaves.length;)this.leaves[Tn++].func(Bn,yn)}})}}if(!st&&!yt)return console.warn(`Not supported branch ${Q.fName} type ${Q._typename}`),null;if(yt||(yt=(0,z.Mx)(st,A.file),void 0!==yt.base&&yt.basename&&(yt.func=function(pn,Qt){Qt[this.name]||(Qt[this.name]={_typename:this.basename}),pn.classStreamer(Qt[this.name],this.basename)})),Ot&&(0,b.isStr)(Ue)){yt.name0=Ot.name;const pn=Ze.split(".");if(1===pn.length)yt.get=(Qt,Bn)=>Qt[Bn];else{if("$child$"===Ue)return console.error(`target name ${Ze} contains point, but suppose to be direct child`),null;if(2===pn.length)Ze=yt.name=pn[1],yt.name1=pn[0],yt.subtype1=Ue,yt.methods1=v(yt.subtype1),yt.get=function(Qt,Bn){let dn=Qt[Bn][this.name1];return dn||(dn=Qt[Bn][this.name1]=this.methods1.Create()),dn};else{if(!Q.fParentName)return console.error(`Not possible to provide more than 2 parts in the target name ${Ze}`),null;Ze=yt.name=pn.pop(),yt.snames=pn,yt.smethods=[];let Qt=Q.fParentName;for(let Bn=0;Bn<pn.length;++Bn){const dn=x(A.file,Qt,pn[Bn]);yt.smethods[Bn]=v(dn||"AbstractClass"),Qt=dn}yt.get=function(Bn,dn){let yn=Bn[dn][this.snames[0]];yn||(yn=Bn[dn][this.snames[0]]=this.smethods[0].Create());for(let Tn=1;Tn<this.snames.length;++Tn){let Hn=yn[this.snames[Tn]];Hn||(Hn=yn[this.snames[Tn]]=this.smethods[Tn].Create()),yn=Hn}return yn}}}yt.objs_branch_func?yt.func=yt.objs_branch_func:(yt.func0=yt.func,yt.func=function(Qt,Bn){const dn=Bn[this.name0];let yn=0;for(;yn<dn.length;)this.func0(Qt,this.get(dn,yn++))})}else if(Ot)if(A.process_arrays=!1,st.fType===z.Q_||st.fType===z.PI)yt.stl_size=Ot.name,yt.func=function(pn,Qt){Qt[this.name]=this.readarr(pn,Qt[this.stl_size])};else if(st.fType!==z.Pk+z.Q_&&st.fType!==z.Pk+z.PI||!Q.fBranchCount2)if(st.fType>0&&st.fType<z.bm||st.fType===z.V$||st.fType>z.Pk&&st.fType<z.Pk+z.bm&&Q.fBranchCount2)yt={name:Ze,stl_size:Ot.name,type:st.fType,func(pn,Qt){Qt[this.name]=pn.readFastArray(Qt[this.stl_size],this.type)}},Q.fBranchCount2&&(yt.type-=z.Pk,yt.arr_size=It.name,yt.func=function(pn,Qt){const Bn=Qt[this.stl_size],dn=Qt[this.arr_size],yn=new Array(Bn);for(let Tn=0;Tn<Bn;++Tn)yn[Tn]=1===pn.ntou1()?pn.readFastArray(dn[Tn],this.type):[];Qt[this.name]=yn});else if(st.fType>z.Pk&&st.fType<z.Pk+z.bm&&yt.cntname)yt.cntname=Ot.name;else if(st.fType===z.N8){if(It)throw new Error("Second branch counter not supported yet with kStreamer");yt.func=yt.branch_func,yt.stl_size=Ot.name}else if(st.fType===z.mU||st.fType===z.bm+z.mU)It?(yt.stl_size=Ot.name,yt.cntname=It.name,yt.func=yt.branch_func):yt.cntname=Ot.name;else{let pn;if(yt.name="$stl_member",It){if(!yt.cntname)throw new Error("Second branch counter not used - very BAD");pn=It.name,yt.cntname="$loop_size"}yt={name:Ze,stl_size:Ot.name,loop_size:pn,member0:yt,func(Bn,dn){const yn=dn[this.stl_size],Tn=new Array(yn);for(let Hn=0;Hn<yn;++Hn)this.loop_size&&(dn.$loop_size=dn[this.loop_size][Hn]),this.member0.func(Bn,dn),Tn[Hn]=dn.$stl_member;delete dn.$stl_member,delete dn.$loop_size,dn[this.name]=Tn}}}else yt.stl_size=Ot.name,yt.arr_size=It.name,yt.func=function(pn,Qt){const Bn=Qt[this.stl_size],dn=Qt[this.arr_size],yn=new Array(Bn);for(let Tn=0;Tn<Bn;++Tn)yn[Tn]=1===pn.ntou1()?this.readarr(pn,dn[Tn]):[];Qt[this.name]=yn};return yt.name=Ze,Oe.member=yt,st&&(Oe.type=st.fType),Oe.index=A.arr.length,Ot&&(Oe.counters=[Ot.index],Ot.ascounter.push(Oe.index),It&&(Oe.counters.push(It.index),It.ascounter.push(Oe.index))),A.arr.push(Oe),Kt&&!on(Q.fBranches,Ke,Kt)?null:Oe}for(let Q=0;Q<m.numBranches();++Q)if(!_e(m.getBranch(Q),void 0,m.nameOfBranch(Q),m._directs[Q]))return m.Terminate(!1),Promise.reject(Error(`Fail to add branch ${m.nameOfBranch(Q)}`));for(let Q=1;Q<A.arr.length&&A.simple_read;++Q){const Ke=A.arr[Q],Ze=A.arr[0];(Ke.numentries!==Ze.numentries||Ke.numbaskets!==Ze.numbaskets)&&(A.simple_read=!1);for(let Ue=0;Ue<Ke.numbaskets;++Ue)Ke.getBasketEntry(Ue)!==Ze.getBasketEntry(Ue)&&(A.simple_read=!1)}A.firstentry=A.lastentry=0;for(let Q=0;Q<A.arr.length;++Q){const Ke=A.arr[Q].branch,Ze=Ke.fFirstEntry??(Ke.fBasketBytes[0]?Ke.fBasketEntry[0]:0);A.firstentry=Math.max(A.firstentry,Ze),A.lastentry=0===Q?Ze+Ke.fEntries:Math.min(A.lastentry,Ze+Ke.fEntries)}if(A.firstentry>=A.lastentry)return m.Terminate(!1),Promise.reject(Error("No any common events for selected branches"));if(A.process_min=A.firstentry,A.process_max=A.lastentry,Number.isInteger(I.firstentry)&&I.firstentry>A.firstentry&&I.firstentry<A.lastentry&&(A.process_min=I.firstentry),A.current_entry=A.staged_now=A.process_min,Number.isInteger(I.numentries)&&I.numentries>0){const Q=A.process_min+I.numentries;Q<A.process_max&&(A.process_max=Q)}if((0,b.isFunc)(m.ProcessArrays)&&A.simple_read){for(let Q=0;Q<A.arr.length;++Q){const Ke=A.arr[Q];(Ke.type<=0||Ke.type>=z.bm||Ke.type===z.k)&&(A.process_arrays=!1)}if(A.process_arrays){m.tgtarr={};for(let Q=0;Q<A.arr.length;++Q){const Ke=A.arr[Q],Ze=(0,z._T)(Ke.name,Ke.type);Ze.fType=Ke.type+z.bm,Ze.fArrayLength=10,Ze.fArrayDim=1,Ze.fMaxIndex[0]=10,Ke.arrmember=(0,z.Mx)(Ze,A.file)}}}else A.process_arrays=!1;function Pe(Q){function Ke(){const lt=[];let gt="";for(let ht=0;ht<Q.length;++ht){if(Q[ht].done)continue;const st=Q[ht].branch;if(0===lt.length)gt=st.fFileName;else if(gt!==st.fFileName)continue;Q[ht].selected=!0,lt.push(st.fBasketSeek[Q[ht].basket],st.fBasketBytes[Q[ht].basket])}return lt.length>0?{places:lt,filename:gt}:null}function Ze(lt){if(A.staged_prev===A.staged_now||A.process_max<=A.process_min)return;const gt=(new Date).getTime();return gt-A.progress_showtm<500?void 0:(A.progress_showtm=gt,A.selector.ShowProgress((A.staged_prev+lt*(A.staged_now-A.staged_prev))/(A.process_max-A.process_min)))}function Ue(lt,gt){return!lt||gt.length>2&&2*lt.length!==gt.length?Promise.resolve(null):(2===gt.length&&(lt=[lt]),function ht(st){for(;st<Q.length;++st){if(!Q[st].selected)continue;Q[st].selected=!1,Q[st].done=!0;const Kt=lt.shift();let Ot=new z.lW(Kt,0,A.file);const It=Ot.classStreamer({},z.ym);if(It.fNbytes!==Q[st].branch.fBasketBytes[Q[st].basket]&&console.error(`mismatch in read basket sizes ${It.fNbytes} != ${Q[st].branch.fBasketBytes[Q[st].basket]}`),Q[st].bskt_obj=It,It.fKeylen+It.fObjlen!==It.fNbytes)return(0,z.ry)(Kt,It.fObjlen,!1,Ot.o).then(An=>{if(!An)throw new Error("FAIL TO UNPACK");return Ot=new z.lW(An,0,A.file),Ot.raw_shift=It.fKeylen,Ot.fTagOffset=It.fKeylen,Q[st].raw=Ot,Q[st].branch.fEntryOffsetLen>0&&Ot.readBasketEntryOffset(It,Ot.raw_shift),ht(st+1)});Ot.raw_shift=0,Q[st].raw=Ot,Q[st].branch.fEntryOffsetLen>0&&Ot.readBasketEntryOffset(It,Ot.raw_shift)}const yt=Ke();return yt?A.file.readBuffer(yt.places,yt.filename,Ze).then(Kt=>Ue(Kt)).catch(()=>null):Promise.resolve(Q)}(0))}const Oe=Ke();return Oe?A.file.readBuffer(Oe.places,Oe.filename,Ze).then(lt=>Ue(lt,Oe.places)).catch(()=>null):Promise.resolve(null)}function We(){const Q=[];let Ke=0,Ze=!0,Ue=!1,Oe=A.process_max;for(;Ke<1e6&&Ze;){Ze=!1;for(let gt=A.arr.length-1;gt>=0;--gt){const ht=A.arr[gt];for(;ht.staged_basket<ht.numbaskets;){const st=ht.staged_basket++;if(ht.getBasketEntry(st)>=A.process_max)break;if(ht.first_readentry<0){if(ht.getBasketEntry(st+1)<=A.process_min)continue;ht.curr_basket=st,ht.first_readentry=ht.getBasketEntry(st)}const yt={id:gt,branch:ht.branch,basket:st,raw:null},Kt=ht.branch.fBaskets.arr[st];Kt?(yt.raw=Kt.fBufferRef,yt.raw?yt.raw.locate(0):yt.raw=new z.lW(null,0,A.file),yt.raw.raw_shift=Kt.fKeylen,Kt.fBufferRef&&ht.branch.fEntryOffsetLen>0&&yt.raw.readBasketEntryOffset(Kt,yt.raw.raw_shift),yt.bskt_obj=Kt,Ue=!0,ht.baskets[st]=yt):(Q.push(yt),Ke+=ht.branch.fBasketBytes[st],Ze=!0),ht.staged_entry=ht.getBasketEntry(st+1),Oe=Math.min(Oe,ht.staged_entry);break}}}if(0===Ke&&!Ue)return A.selector.Terminate(!0),be(A.selector);A.staged_prev=A.staged_now,A.staged_now=Oe;let lt=0;if(A.process_max>A.process_min&&(lt=(A.staged_prev-A.process_min)/(A.process_max-A.process_min)),"break"===A.selector.ShowProgress(lt))return A.selector.Terminate(!0),be(A.selector);if(A.progress_showtm=(new Date).getTime(),Ke>0)return Pe(Q).then(dt);if(Ue)return dt([]);throw new Error("No any data is requested - never come here")}function dt(Q){if(0!==A.selector._break||null===Q)return A.selector.Terminate(!1),be(A.selector);for(let Ze=0;Ze<Q.length;++Ze)A.arr[Q[Ze].id].baskets[Q[Ze].basket]=Q[Ze];let Ke=!1;for(;;){let Ue,Oe,Ze=1e8;for(Ue=0;Ue<A.arr.length;++Ue){if(Oe=A.arr[Ue],!Oe.raw||!Oe.basket||Oe.first_entry+Oe.basket.fNevBuf<=A.current_entry){if(delete Oe.raw,delete Oe.basket,Oe.curr_basket>=Oe.numbaskets){if(0===Ue)return A.selector.Terminate(!0),be(A.selector);continue}const lt=Oe.baskets[Oe.curr_basket];if(!lt)return Ke?We():(A.selector.Terminate(!1),Te(Error(`no data for ${Oe.branch.fName} basket ${Oe.curr_basket}`)));Oe.raw=lt.raw,Oe.basket=lt.bskt_obj,Oe.first_entry=Oe.getBasketEntry(lt.basket),lt.raw=null,lt.branch=null,lt.bskt_obj=null,Oe.baskets[Oe.curr_basket++]=void 0}Ze=Math.min(Ze,Oe.first_entry+Oe.basket.fNevBuf-A.current_entry)}if(A.current_entry+Ze>A.process_max&&(Ze=A.process_max-A.current_entry),A.process_arrays&&Ze>1){for(Ue=0;Ue<A.arr.length;++Ue)Oe=A.arr[Ue],Oe.getEntry(A.current_entry),Oe.arrmember.arrlength=Ze,Oe.arrmember.func(Oe.raw,A.selector.tgtarr),Oe.raw=null;A.selector.ProcessArrays(A.current_entry),A.current_entry+=Ze,Ke=!0}else for(;Ze--;){for(Ue=0;Ue<A.arr.length;++Ue)Oe=A.arr[Ue],Oe.getEntry(A.current_entry),Oe.member.func(Oe.raw,Oe.getTarget(A.selector.tgtobj));A.selector.Process(A.current_entry),A.current_entry++,Ke=!0}if(A.current_entry>=A.process_max)return A.selector.Terminate(!0),be(A.selector)}}return new Promise((Q,Ke)=>{be=Q,Te=Ke,A.selector.Begin(N),We()})})).apply(this,arguments)}function F(N,m){return U.apply(this,arguments)}function U(){return(U=(0,ve.A)(function*(N,m){(0,b.isStr)(m)&&(m={expr:m}),(0,b.isStr)(m.expr)||(m.expr="");const I=new w;if(m.branch){if(!I.drawOnlyBranch(N,m.branch,m.expr,m))return Promise.reject(Error(`Fail to create draw expression ${m.expr} for branch ${m.branch.fName}`))}else if(!I.parseDrawExpression(N,m))return Promise.reject(Error(`Fail to create draw expression ${m.expr}`));return I.setCallback(null,m.progress),C(N,I,m).then(()=>I.hist)})).apply(this,arguments)}function j(N,m){const I=[],A=[],R=[],J=function k(Te,Pe=""){if(!Te?.fBranches)return 0;let We=0;for(let dt=0;dt<Te.fBranches.arr.length;++dt){const Q=Te.fBranches.arr[dt],Ke=(Pe?Pe+"/":"")+Q.fName;I.push(Q),A.push(Ke),R.push(0);const Ze=R.length-1;We+=Q.fLeaves?.arr?.length??0;const Ue=k(Q,Ke);We+=Ue,R[Ze]=Ue}return We}(N);let _e;return A.push(`Total are ${I.length} branches with ${J} leaves`),function be(Te){if(Te>=I.length||_e?._break||m._break)return Promise.resolve(!0);_e=new ie,_e.addBranch(I[Te],"br0"),_e.Process=function(){void 0===this.tgtobj.br0&&(this.fail=!0)},_e.Terminate=function(Oe){(0,b.isStr)(Oe)||(Oe=!Oe||this.fails?"FAIL":"ok"),A[Te]=Oe+" "+A[Te]};const Pe=I[Te],We=fe(Pe,N),dt=Pe.fEntries;if((We?R[Te]>100:!Pe.fLeaves?.arr?.length)||dt<=0)return be(Te+1);const Ke={numentries:10},Ze=Pe.fFirstEntry||0,Ue=Pe.fEntryNumber||Ze+dt;return dt<Ke.numentries?Ke.numentries=dt:Ke.firstentry=Ze+Math.round((Ue-Ze-Ke.numentries)*Math.random()),console.log(`test branch ${Pe.fName} first ${Ke.firstentry||0} num ${Ke.numentries}`),(0,b.isFunc)(m.showProgress)&&m.showProgress(`br ${Te}/${I.length} ${Pe.fName}`),C(N,_e,Ke).then(()=>be(Te+1))}(0).then(()=>((0,b.isFunc)(m.showProgress)&&m.showProgress(),A))}function te(N,m){function I(A,R,k,J){if(!A||!R)return!1;const _e=R.fBranches?.arr?.length??0,be=R.fLeaves?.arr?.length??0;function Te(We){const dt=We.indexOf("[");return dt>0&&(We=We.slice(0,dt)),J&&0===We.indexOf(J.fName)&&"."===(We=We.slice(J.fName.length))[0]&&(We=We.slice(1)),We}R.$tree=k;const Pe={_name:Te(R.fName),_kind:b.prROOT+R._typename,_title:R.fTitle,_obj:R};if(A._childs||(A._childs=[]),A._childs.push(Pe),R._typename===O&&(Pe._title+=` from ${R.fClassName};${R.fClassVersion}`),_e>0)return Pe._more=!0,Pe._expand=function(We,dt){if(!dt)return!1;We._childs||(We._childs=[]),1===dt.fLeaves?.arr?.length&&(dt.fType===Xe||dt.fType===ot)&&(dt.fLeaves.arr[0].$branch=dt,We._childs.push({_name:"@size",_title:"container size",_kind:b.prROOT+"TLeafElement",_icon:"img_leaf",_obj:dt.fLeaves.arr[0],_more:!1}));for(let Ze=0;Ze<dt.fBranches.arr.length;++Ze)I(We,dt.fBranches.arr[Ze],dt.$tree,dt);const Q=fe(dt,dt.$tree,!0),Ke=Q?(0,b.getMethods)(Q):null;if(Ke&&dt.fBranches.arr.length>0)for(const Ze in Ke){if(!(0,b.isFunc)(Ke[Ze]))continue;const Ue=Ke[Ze].toString();Ue.indexOf("return")>0&&0===Ue.indexOf("function ()")&&We._childs.push({_name:Ze+"()",_title:`function ${Ze} of class ${Q}`,_kind:b.prROOT+ce,_obj:{_typename:ce,branch:dt,func:Ze},_more:!1})}return!0},!0;if(1===be)Pe._icon="img_leaf",Pe._more=!1;else if(be>1){Pe._childs=[];for(let We=0;We<be;++We){R.fLeaves.arr[We].$branch=R;const dt={_name:Te(R.fLeaves.arr[We].fName),_kind:b.prROOT+R.fLeaves.arr[We]._typename,_obj:R.fLeaves.arr[We]};Pe._childs.push(dt)}}return!0}if(void 0===m.fBranches)return!1;N._childs=[],N._tree=m;for(let A=0;A<m.fBranches.arr?.length;++A)I(N,m.fBranches.arr[A],m);return!0}},467:(Ur,vt,Ee)=>{"use strict";function ve(z,ke,xe,et,Je,Xe,ot){try{var Re=z[Xe](ot),He=Re.value}catch(Ie){return void xe(Ie)}Re.done?ke(He):Promise.resolve(He).then(et,Je)}function b(z){return function(){var ke=this,xe=arguments;return new Promise(function(et,Je){var Xe=z.apply(ke,xe);function ot(He){ve(Xe,et,Je,ot,Re,"next",He)}function Re(He){ve(Xe,et,Je,ot,Re,"throw",He)}ot(void 0)})}}Ee.d(vt,{A:()=>b})}},Ur=>{Ur(Ur.s=2869)}]);